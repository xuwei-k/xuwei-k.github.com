<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/form/Row.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> form

<span class="keyword">import</span> org.specs2.internal.scalaz.<span class="delimiter">{</span> NonEmptyList, Scalaz <span class="delimiter">}</span>
<span class="keyword">import</span> <span title="object org.specs2.internal.scalaz.Scalaz">Scalaz</span>.nel
<span class="keyword">import</span> execute._
<span class="keyword">import</span> <a href="../execute/StandardResults.scala.html#10216" title="object org.specs2.execute.StandardResults">StandardResults</a>._
<span class="keyword">import</span> <a href="../execute/ResultLogicalCombinators.scala.html#10204" title="object org.specs2.execute.ResultLogicalCombinators">ResultLogicalCombinators</a>._
<span class="comment">/**
 * A Row is a non-empty list of Cells
 * 
 * A Row can be executed by executing each Cell and collecting the results.
 */</span>
case <span class="keyword">class</span> <a title="class Row extends java.lang.Object with org.specs2.execute.Executable with ScalaObject with Product with Serializable" id="127932">Row</a><a href="#127932" title="ScalaObject" class="delimiter">(</a><span class="keyword">private</span> <span class="keyword">val</span> <a title="org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]" id="135492">cellList</a>: <span title="org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">NonEmptyList</span><span class="delimiter">[</span>Cell<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../execute/Executable.scala.html#10097" title="org.specs2.execute.Executable">Executable</a> <span class="delimiter">{</span>
  <span class="comment">/** @return all the cells */</span>
  <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Seq[org.specs2.form.Cell]" id="126904">cells</a> = <a href="#135492" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a>.<span title="=&gt; List[org.specs2.form.Cell]">list</span>.<span title="=&gt; scala.collection.immutable.Seq[org.specs2.form.Cell]">toSeq</span>
  
  <span class="comment">/** @return a Row where every cell is executed with a Success */</span>
  <span class="keyword">def</span> <a title="=&gt; org.specs2.form.Row" id="126905">setSuccess</a> = <span title="org.specs2.form.Row" class="keyword">new</span> <a href="#127932" title="org.specs2.form.Row">Row</a><span class="delimiter">(</span><a href="#135492" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a>.<span title="(f: org.specs2.form.Cell =&gt; org.specs2.form.Cell)org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">map</span><span class="delimiter">(</span><a href="#135693" title="org.specs2.form.Cell">_</a>.<a href="Cells.scala.html#126917" title="=&gt; org.specs2.form.Cell">setSuccess</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="comment">/** @return a Row where every cell is executed with a Failure */</span>
  <span class="keyword">def</span> <a title="=&gt; org.specs2.form.Row" id="126906">setFailure</a> = <span title="org.specs2.form.Row" class="keyword">new</span> <a href="#127932" title="org.specs2.form.Row">Row</a><span class="delimiter">(</span><a href="#135492" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a>.<span title="(f: org.specs2.form.Cell =&gt; org.specs2.form.Cell)org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">map</span><span class="delimiter">(</span><a href="#135743" title="org.specs2.form.Cell">_</a>.<a href="Cells.scala.html#126918" title="=&gt; org.specs2.form.Cell">setFailure</a><span class="delimiter">)</span><span class="delimiter">)</span>
  
  <span class="comment">/** 
   * execute all cells
   * @return a logical `and` on all results
   */</span>
  <span class="keyword">def</span> <a title="=&gt; org.specs2.execute.Result" id="126907">execute</a> = <a href="#135492" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a>.<span title="=&gt; List[org.specs2.form.Cell]">list</span>.<span title="(z: org.specs2.execute.Result)(f: (org.specs2.execute.Result, org.specs2.form.Cell) =&gt; org.specs2.execute.Result)org.specs2.execute.Result">foldLeft</span><span class="delimiter">(</span><a href="../execute/StandardResults.scala.html#52757" title="=&gt; org.specs2.execute.Success">success</a>: <a href="../execute/Result.scala.html#10121" title="org.specs2.execute.Result">Result</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="org.specs2.execute.Result" id="135572">res</a>, <a title="org.specs2.form.Cell" id="135573">cur</a><span class="delimiter">)</span> =&gt;  <a href="../execute/ResultLogicalCombinators.scala.html#15404" title="implicit org.specs2.execute.ResultLogicalCombinators.combineResult : (r: =&gt; org.specs2.execute.Result)org.specs2.execute.ResultLogicalCombinators.ResultLogicalCombinator">res</a> <a href="../execute/ResultLogicalCombinators.scala.html#45671" title="(other: =&gt; org.specs2.execute.Result)org.specs2.execute.Result">and</a> <a href="#135573" title="org.specs2.form.Cell">cur</a>.<a href="../execute/Executable.scala.html#36524" title="=&gt; org.specs2.execute.Result">execute</a> <span class="delimiter">}</span>
  <span class="comment">/**
   * execute the row
   * @return a new Row with executed cells
   */</span>
  <span class="keyword">def</span> <a title="=&gt; org.specs2.form.Row" id="126908">executeRow</a> = <a href="#127932" title="(cellList: org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell])org.specs2.form.Row">Row</a><span class="delimiter">(</span><a href="#135492" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a>.<span title="(f: org.specs2.form.Cell =&gt; org.specs2.form.Cell)org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">map</span><span class="delimiter">(</span><a href="#135498" title="org.specs2.form.Cell">_</a>.<a href="Cells.scala.html#126919" title="=&gt; org.specs2.form.Cell">executeCell</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/** @return print the row with a padding space size to use for each cell, given cell by cell */</span>
  <span class="keyword">def</span> <a title="(maxSizes: Seq[Int])String" id="126909">text</a><span class="delimiter">(</span><a title="Seq[Int]" id="140083">maxSizes</a>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(cells: Seq[org.specs2.form.Cell], sizes: Seq[Int], result: Seq[String])Seq[String]" id="140086">pad</a><span class="delimiter">(</span><a title="Seq[org.specs2.form.Cell]" id="140087">cells</a>: <span title="Seq[org.specs2.form.Cell]">Seq</span><span class="delimiter">[</span>Cell<span class="delimiter">]</span>, <a title="Seq[Int]" id="140088">sizes</a>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <a title="Seq[String]" id="140089">result</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#140087" title="Seq[org.specs2.form.Cell]">cells</a>.<span title="=&gt; List[org.specs2.form.Cell]">toList</span> <span title="Seq[String]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Seq[String]">Nil</span> =&gt; <a href="#140089" title="Seq[String]">result</a>
        <span class="keyword">case</span> <a title="List[String]" id="140095">c</a> :: <span title="object Nil">Nil</span> =&gt; <span class="delimiter">(</span><a href="#140089" title="Seq[String]">result</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],String,Seq[String]])Seq[String]">:+</span> <a href="#140095" title="org.specs2.form.Cell">c</a>.<a href="Cells.scala.html#126888" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">text</a>.<span title="(len: Int, elem: Char)(implicit bf: scala.collection.generic.CanBuildFrom[String,Char,String])String">padTo</span><span title="=&gt; scala.collection.generic.CanBuildFrom[String,Char,String]" class="delimiter">(</span><a href="#140088" title="Seq[Int]">sizes</a>.<span title="(implicit num: Numeric[Int])Int">sum</span> <span title="(x: Int)Int">+</span> <span class="delimiter">(</span><a href="#140088" title="Seq[Int]">sizes</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span title="(x: Int)Int">*</span><span title="Int(3)" class="int">3</span>, <span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; List[String]">toList</span>
        <span class="keyword">case</span> <a title="Seq[String]" id="140301">c</a> :: <a title="List[org.specs2.form.Cell]" id="140302">rest</a> =&gt; <a href="#140088" title="Seq[Int]">sizes</a> <span title="Seq[String]" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="List[String]">Nil</span> =&gt; <span class="delimiter">(</span><a href="#140089" title="Seq[String]">result</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],String,Seq[String]])Seq[String]">:+</span> <a href="#140301" title="org.specs2.form.Cell">c</a>.<a href="Cells.scala.html#126888" title="=&gt; String">text</a><span class="delimiter">)</span>.<span title="=&gt; List[String]">toList</span>
          <span class="keyword">case</span> <a title="Seq[String]" id="140334">s</a> :: <span title="object Nil">Nil</span> =&gt; <a href="#140086" title="(cells: Seq[org.specs2.form.Cell], sizes: Seq[Int], result: Seq[String])Seq[String]">pad</a><span class="delimiter">(</span><a href="#140302" title="List[org.specs2.form.Cell]">rest</a>, <span title="object Nil">Nil</span>, <span class="delimiter">(</span><a href="#140089" title="Seq[String]">result</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],String,Seq[String]])Seq[String]">:+</span> <a href="#140301" title="org.specs2.form.Cell">c</a>.<a href="Cells.scala.html#126888" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">text</a>.<span title="(len: Int, elem: Char)(implicit bf: scala.collection.generic.CanBuildFrom[String,Char,String])String">padTo</span><span title="=&gt; scala.collection.generic.CanBuildFrom[String,Char,String]" class="delimiter">(</span><a href="#140334" title="Int">s</a>, <span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; List[String]">toList</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a title="Seq[String]" id="140504">s</a> :: <a title="List[Int]" id="140505">ss</a> =&gt; <a href="#140086" title="(cells: Seq[org.specs2.form.Cell], sizes: Seq[Int], result: Seq[String])Seq[String]">pad</a><span class="delimiter">(</span><a href="#140302" title="List[org.specs2.form.Cell]">rest</a>, <a href="#140505" title="List[Int]">ss</a>, <span class="delimiter">(</span><a href="#140089" title="Seq[String]">result</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],String,Seq[String]])Seq[String]">:+</span> <a href="#140301" title="org.specs2.form.Cell">c</a>.<a href="Cells.scala.html#126888" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">text</a>.<span title="(len: Int, elem: Char)(implicit bf: scala.collection.generic.CanBuildFrom[String,Char,String])String">padTo</span><span title="=&gt; scala.collection.generic.CanBuildFrom[String,Char,String]" class="delimiter">(</span><a href="#140504" title="Int">s</a>, <span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; List[String]">toList</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#140086" title="(cells: Seq[org.specs2.form.Cell], sizes: Seq[Int], result: Seq[String])Seq[String]">pad</a><span class="delimiter">(</span><a href="#126904" title="=&gt; scala.collection.immutable.Seq[org.specs2.form.Cell]">cells</a>, <a href="#140083" title="Seq[Int]">maxSizes</a>, <span title="object Nil">Nil</span><span class="delimiter">)</span>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;| &quot;)" class="string">&quot;| &quot;</span>, <span title="java.lang.String(&quot; | &quot;)" class="string">&quot; | &quot;</span>, <span title="java.lang.String(&quot; |&quot;)" class="string">&quot; |&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** append a new Cell */</span>
  <span class="keyword">def</span> <a title="(cell: org.specs2.form.Cell)org.specs2.form.Row" id="126910">add</a><span class="delimiter">(</span><a title="org.specs2.form.Cell" id="141968">cell</a>: <a href="Cells.scala.html#10242" title="org.specs2.form.Cell">Cell</a><span class="delimiter">)</span> = <a href="#127932" title="(cellList: org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell])org.specs2.form.Row">copy</a><span class="delimiter">(</span>cellList = <a href="#135492" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a> <span title="(bs: List[org.specs2.form.Cell])org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">:::&gt;</span> <span title="(xs: org.specs2.form.Cell*)List[org.specs2.form.Cell]">List</span><span class="delimiter">(</span><a href="#141968" title="org.specs2.form.Cell">cell</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(a: Any)Boolean" id="126911">equals</a><span class="delimiter">(</span><a title="Any" id="145581">a</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <a href="#145581" title="Any">a</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Boolean">Row</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]" id="145601">c</a><span class="delimiter">)</span> =&gt; <a href="#126904" title="=&gt; scala.collection.immutable.Seq[org.specs2.form.Cell]">cells</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#145601" title="org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">c</a>.<span title="=&gt; List[org.specs2.form.Cell]">list</span>
    <span class="keyword">case</span> <a title="Boolean(false)" id="145607">other</a> =&gt; <span title="Boolean(false)" class="keyword">false</span>
  <span class="delimiter">}</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Int" id="126912">hashCode</a> = <a href="#126904" title="=&gt; scala.collection.immutable.Seq[org.specs2.form.Cell]">cells</a>.<span title="(f: org.specs2.form.Cell =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Seq[org.specs2.form.Cell],Int,scala.collection.immutable.Seq[Int]])scala.collection.immutable.Seq[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Seq.Coll,Int,scala.collection.immutable.Seq[Int]]" class="delimiter">(</span><a href="#145630" title="org.specs2.form.Cell">_</a>.<span title="()Int">hashCode</span><span class="delimiter">)</span>.<span title="(implicit num: Numeric[Int])Int">sum</span>
<span class="delimiter">}</span>
<span class="comment">/**
 * Companion object of a Row to create a Row with at least one cell
 */</span>
case <span class="keyword">object</span> <a href="#145690" title="object org.specs2.form.Row" id="145695">Row</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/**
   * create a row from cells
   */</span>
  <span class="keyword">def</span> <a title="(c1: org.specs2.form.Cell, cs: org.specs2.form.Cell*)org.specs2.form.Row" id="127931">tr</a><span class="delimiter">(</span><a title="org.specs2.form.Cell" id="139326">c1</a>: <a href="Cells.scala.html#10242" title="org.specs2.form.Cell">Cell</a>, <a title="org.specs2.form.Cell*" id="139327">cs</a>: <span title="org.specs2.form.Cell*">Cell</span>*<span class="delimiter">)</span> = <a href="#127932" title="(cellList: org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell])org.specs2.form.Row">Row</a><span class="delimiter">(</span><span title="(h: org.specs2.form.Cell, t: org.specs2.form.Cell*)org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">nel</span><span class="delimiter">(</span><a href="#139326" title="org.specs2.form.Cell">c1</a>, <a href="#139327" title="org.specs2.form.Cell*">cs</a>:_*<span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
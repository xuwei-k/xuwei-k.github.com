<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/data/Trees.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> data
<span class="keyword">import</span> org.specs2.internal.scalaz.<span class="delimiter">{</span>Tree, TreeLoc, Scalaz<span class="delimiter">}</span>
<span class="keyword">import</span> <span title="object org.specs2.internal.scalaz.Scalaz">Scalaz</span>._

<span class="comment">/**
 * Utility methods for scalaz Trees
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">trait</span> <a title="trait Trees extends java.lang.Object with ScalaObject" id="10058">Trees</a> <span title="ScalaObject" class="delimiter">{</span> outer =&gt;

  <span class="comment">/**
   * Implicit definition to add more functionalities to the Tree trait
   */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](t: org.specs2.internal.scalaz.Tree[A])Trees.this.Treex[A]" id="103849">extendedTree</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103851">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[A]" id="103903">t</a>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#103908" title="(t: org.specs2.internal.scalaz.Tree[A])Trees.this.Treex[A]">Treex</a><span class="delimiter">(</span><a href="#103903" title="org.specs2.internal.scalaz.Tree[A]">t</a><span class="delimiter">)</span>
  case <span class="keyword">class</span> <a title="class Treex[A] extends java.lang.Object with ScalaObject with Product with Serializable" id="103908">Treex</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103910">A</a><span class="delimiter">]</span><a href="#103908" title="ScalaObject" class="delimiter">(</a><a title="org.specs2.internal.scalaz.Tree[A]" id="103930">t</a>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[B](f: (A, Stream[B]) =&gt; B)org.specs2.internal.scalaz.Tree[B]" id="103915">bottomUp</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103917">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, Stream[B]) =&gt; B" id="103940">f</a>: <span class="delimiter">(</span><span class="delimiter">(</span>A, Stream<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; B<span class="delimiter">)</span><span class="delimiter">)</span> = <a href="#10058" title="Trees.this.type">outer</a>.<a href="#103863" title="(t: org.specs2.internal.scalaz.Tree[A], f: (A, Stream[B]) =&gt; B)org.specs2.internal.scalaz.Tree[B]">bottomUp</a><span class="delimiter">(</span><a href="#103930" title="=&gt; org.specs2.internal.scalaz.Tree[A]">t</a>, <a href="#103940" title="(A, Stream[B]) =&gt; B">f</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[B](f: A =&gt; Option[B])Option[org.specs2.internal.scalaz.Tree[B]]" id="103918">prune</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103920">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; Option[B]" id="103955">f</a>: A =&gt; Option<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[org.specs2.internal.scalaz.Tree[B]]">Option</span><span class="delimiter">[</span>Tree<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#10058" title="Trees.this.type">outer</a>.<a href="#103871" title="(t: org.specs2.internal.scalaz.Tree[A], f: A =&gt; Option[B])Option[org.specs2.internal.scalaz.Tree[B]]">prune</a><span class="delimiter">(</span><a href="#103930" title="=&gt; org.specs2.internal.scalaz.Tree[A]">t</a>, <a href="#103955" title="A =&gt; Option[B]">f</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(f: org.specs2.internal.scalaz.Tree[A] =&gt; Option[A])(implicit initial: A)org.specs2.internal.scalaz.Tree[A]" id="103921">prune</a><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[A] =&gt; Option[A]" id="104037">f</a>: Tree<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="A" id="104038">initial</a>: <a href="#103910" title="A">A</a><span class="delimiter">)</span>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#10058" title="Trees.this.type">outer</a>.<a href="#103876" title="(t: org.specs2.internal.scalaz.Tree[A], f: org.specs2.internal.scalaz.Tree[A] =&gt; Option[A])(implicit initial: A)org.specs2.internal.scalaz.Tree[A]">prune</a><span class="delimiter">(</span><a href="#103930" title="=&gt; org.specs2.internal.scalaz.Tree[A]">t</a>, <a href="#104037" title="org.specs2.internal.scalaz.Tree[A] =&gt; Option[A]">f</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#104038" title="A">initial</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; org.specs2.internal.scalaz.Tree[A]" id="103922">flattenSubForests</a> = <a href="#10058" title="Trees.this.type">outer</a>.<a href="#103879" title="(tree: org.specs2.internal.scalaz.Tree[A])org.specs2.internal.scalaz.Tree[A]">flattenSubForests</a><span class="delimiter">(</span><a href="#103930" title="=&gt; org.specs2.internal.scalaz.Tree[A]">t</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; Stream[A]" id="103923">flattenLeft</a>       = <a href="#10058" title="Trees.this.type">outer</a>.<a href="#103882" title="(tree: org.specs2.internal.scalaz.Tree[A])Stream[A]">flattenLeft</a><span class="delimiter">(</span><a href="#103930" title="=&gt; org.specs2.internal.scalaz.Tree[A]">t</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * This implicit can be used to remove None nodes in a Tree
   */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](t: org.specs2.internal.scalaz.Tree[Option[A]])Trees.this.CleanedTree[A]" id="103856">cleanedTree</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103858">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[Option[A]]" id="104155">t</a>: <span title="org.specs2.internal.scalaz.Tree[Option[A]]">Tree</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#104160" title="(t: org.specs2.internal.scalaz.Tree[Option[A]])Trees.this.CleanedTree[A]">CleanedTree</a><span class="delimiter">(</span><a href="#104155" title="org.specs2.internal.scalaz.Tree[Option[A]]">t</a><span class="delimiter">)</span>
  case <span class="keyword">class</span> <a title="class CleanedTree[A] extends java.lang.Object with ScalaObject with Product with Serializable" id="104160">CleanedTree</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="104162">A</a><span class="delimiter">]</span><a href="#104160" title="ScalaObject" class="delimiter">(</a><a title="org.specs2.internal.scalaz.Tree[Option[A]]" id="104174">t</a>: <span title="org.specs2.internal.scalaz.Tree[Option[A]]">Tree</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(implicit initial: A)org.specs2.internal.scalaz.Tree[A]" id="104167">clean</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="A" id="104184">initial</a>: <a href="#104162" title="A">A</a><span class="delimiter">)</span>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#10058" title="Trees.this.type">outer</a>.<a href="#103868" title="(t: org.specs2.internal.scalaz.Tree[Option[A]])(implicit initial: A)org.specs2.internal.scalaz.Tree[A]">clean</a><span class="delimiter">(</span><a href="#104174" title="=&gt; org.specs2.internal.scalaz.Tree[Option[A]]">t</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#104184" title="A">initial</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * map a Tree from leaves to root by replacing each node with the result of a function taking
   * that node and the mapping of all its children.
   *
   * This is used in JUnit to map a Tree[Description] where no Description objects are related to a Tree[Description]
   * where each node returns the children nodes on the &quot;getChildren&quot; method
   */</span>
  <span class="keyword">def</span> <a title="[A, B](t: org.specs2.internal.scalaz.Tree[A], f: (A, Stream[B]) =&gt; B)org.specs2.internal.scalaz.Tree[B]" id="103863">bottomUp</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103866">A</a>, <a title="&gt;: Nothing &lt;: Any" id="103867">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[A]" id="103943">t</a>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="(A, Stream[B]) =&gt; B" id="103944">f</a>: <span class="delimiter">(</span><span class="delimiter">(</span>A, Stream<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; B<span class="delimiter">)</span><span class="delimiter">)</span>: <span title="org.specs2.internal.scalaz.Tree[B]">Tree</span><span class="delimiter">[</span>B<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]" id="104244">tbs</a> = <a href="#103943" title="org.specs2.internal.scalaz.Tree[A]">t</a>.<span title="=&gt; Stream[org.specs2.internal.scalaz.Tree[A]]">subForest</span>.<span title="(f: org.specs2.internal.scalaz.Tree[A] =&gt; org.specs2.internal.scalaz.Tree[B])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[A]],org.specs2.internal.scalaz.Tree[B],scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]])scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream.Coll,org.specs2.internal.scalaz.Tree[B],scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]]" class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[A]" id="104292">t</a> =&gt; <a href="#103863" title="(t: org.specs2.internal.scalaz.Tree[A], f: (A, Stream[B]) =&gt; B)org.specs2.internal.scalaz.Tree[B]">bottomUp</a><span class="delimiter">(</span><a href="#104292" title="org.specs2.internal.scalaz.Tree[A]">t</a>, <a href="#103944" title="(A, Stream[B]) =&gt; B">f</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="(root: =&gt; B, forest: =&gt; Stream[org.specs2.internal.scalaz.Tree[B]])org.specs2.internal.scalaz.Tree[B]">node</span><span class="delimiter">(</span><a href="#103944" title="(v1: A, v2: Stream[B])B">f</a><span class="delimiter">(</span><a href="#103943" title="org.specs2.internal.scalaz.Tree[A]">t</a>.<span title="=&gt; A">rootLabel</span>, <a href="#104244" title="scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]">tbs</a>.<span title="(f: org.specs2.internal.scalaz.Tree[B] =&gt; B)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]],B,Stream[B]])Stream[B]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream.Coll,B,scala.collection.immutable.Stream[B]]" class="delimiter">(</span><a href="#104455" title="org.specs2.internal.scalaz.Tree[B]">_</a>.<span title="=&gt; B">rootLabel</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#104244" title="scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]">tbs</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * remove None nodes from a tree
   */</span>
  <span class="keyword">def</span> <a title="[A](t: org.specs2.internal.scalaz.Tree[Option[A]])(implicit initial: A)org.specs2.internal.scalaz.Tree[A]" id="103868">clean</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103870">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[Option[A]]" id="104186">t</a>: <span title="org.specs2.internal.scalaz.Tree[Option[A]]">Tree</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="A" id="104187">initial</a>: <a href="#103870" title="A">A</a><span class="delimiter">)</span>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#103871" title="(t: org.specs2.internal.scalaz.Tree[Option[A]], f: Option[A] =&gt; Option[A])Option[org.specs2.internal.scalaz.Tree[A]]">prune</a><span class="delimiter">(</span><a href="#104186" title="org.specs2.internal.scalaz.Tree[Option[A]]">t</a>, <span class="delimiter">(</span>a: <span title="Option[A]">Option</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <a href="#104518" title="Option[A]">a</a><span class="delimiter">)</span>.<span title="(default: =&gt; org.specs2.internal.scalaz.Tree[A])org.specs2.internal.scalaz.Tree[A]">getOrElse</span><span class="delimiter">(</span><span title="(root: =&gt; A)org.specs2.internal.scalaz.Tree[A]">leaf</span><span class="delimiter">(</span><a href="#104187" title="A">initial</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="comment">/**
   * remove nodes from a tree if they are None according to a function f
   */</span>
  <span class="keyword">def</span> <a title="[A, B](t: org.specs2.internal.scalaz.Tree[A], f: A =&gt; Option[B])Option[org.specs2.internal.scalaz.Tree[B]]" id="103871">prune</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103874">A</a>, <a title="&gt;: Nothing &lt;: Any" id="103875">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[A]" id="104022">t</a>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="A =&gt; Option[B]" id="104023">f</a>: A =&gt; Option<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[org.specs2.internal.scalaz.Tree[B]]">Option</span><span class="delimiter">[</span>Tree<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]" id="104542">tbs</a> = <a href="#104022" title="org.specs2.internal.scalaz.Tree[A]">t</a>.<span title="=&gt; Stream[org.specs2.internal.scalaz.Tree[A]]">subForest</span>.<span title="(f: org.specs2.internal.scalaz.Tree[A] =&gt; scala.collection.GenTraversableOnce[org.specs2.internal.scalaz.Tree[B]])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[A]],org.specs2.internal.scalaz.Tree[B],scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]])scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream.Coll,org.specs2.internal.scalaz.Tree[B],scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]]" class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[A]" id="104584">t</a> =&gt; <a href="#103871" title="(t: org.specs2.internal.scalaz.Tree[A], f: A =&gt; Option[B])Option[org.specs2.internal.scalaz.Tree[B]]">prune</a><span title="(xo: Option[org.specs2.internal.scalaz.Tree[B]])Iterable[org.specs2.internal.scalaz.Tree[B]]" class="delimiter">(</span><a href="#104584" title="org.specs2.internal.scalaz.Tree[A]">t</a>, <a href="#104023" title="A =&gt; Option[B]">f</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#104023" title="(v1: A)Option[B]">f</a><span class="delimiter">(</span><a href="#104022" title="org.specs2.internal.scalaz.Tree[A]">t</a>.<span title="=&gt; A">rootLabel</span><span class="delimiter">)</span>.<span title="(f: B =&gt; org.specs2.internal.scalaz.Tree[B])Option[org.specs2.internal.scalaz.Tree[B]]">map</span> <span class="delimiter">{</span> <a title="B" id="104871">root</a> =&gt;
      <span title="(root: =&gt; B, forest: =&gt; Stream[org.specs2.internal.scalaz.Tree[B]])org.specs2.internal.scalaz.Tree[B]">node</span><span class="delimiter">(</span><a href="#104871" title="B">root</a>, <a href="#104542" title="scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[B]]">tbs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * remove nodes from a tree if they are None according to a function f
   */</span>
  <span class="keyword">def</span> <a title="[A](t: org.specs2.internal.scalaz.Tree[A], f: org.specs2.internal.scalaz.Tree[A] =&gt; Option[A])(implicit initial: A)org.specs2.internal.scalaz.Tree[A]" id="103876">prune</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103878">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[A]" id="103960">t</a>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="org.specs2.internal.scalaz.Tree[A] =&gt; Option[A]" id="103961">f</a>: Tree<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="A" id="103962">initial</a>: <a href="#103878" title="A">A</a><span class="delimiter">)</span>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#103960" title="org.specs2.internal.scalaz.Tree[A]">t</a>.<span title="(f: org.specs2.internal.scalaz.Tree[A] =&gt; Option[A])org.specs2.internal.scalaz.Tree[Option[A]]">cobind</span><a href="#103856" title="(t: org.specs2.internal.scalaz.Tree[Option[A]])Trees.this.CleanedTree[A]" class="delimiter">(</a><a href="#103961" title="org.specs2.internal.scalaz.Tree[A] =&gt; Option[A]">f</a><span class="delimiter">)</span>.<a href="#104167" title="(implicit initial: A)org.specs2.internal.scalaz.Tree[A]">clean</a>

  <span class="keyword">def</span> <a title="[A](tree: org.specs2.internal.scalaz.Tree[A])org.specs2.internal.scalaz.Tree[A]" id="103879">flattenSubForests</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103881">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[A]" id="104094">tree</a>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span title="(root: =&gt; A, forest: =&gt; Stream[org.specs2.internal.scalaz.Tree[A]])org.specs2.internal.scalaz.Tree[A]">node</span><span class="delimiter">(</span><a href="#104094" title="org.specs2.internal.scalaz.Tree[A]">tree</a>.<span title="=&gt; A">rootLabel</span>, <a href="#103849" title="(t: org.specs2.internal.scalaz.Tree[A])Trees.this.Treex[A]">tree</a>.<a href="#103923" title="=&gt; Stream[A]">flattenLeft</a>.<span title="(n: Int)scala.collection.immutable.Stream[A]">drop</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="(f: A =&gt; org.specs2.internal.scalaz.Tree[A])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[A],org.specs2.internal.scalaz.Tree[A],Stream[org.specs2.internal.scalaz.Tree[A]]])Stream[org.specs2.internal.scalaz.Tree[A]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream.Coll,org.specs2.internal.scalaz.Tree[A],scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[A]]]" class="delimiter">(</span><span title="(root: =&gt; A)org.specs2.internal.scalaz.Tree[A]">leaf</span><span class="delimiter">(</span><a href="#105056" title="A">_</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * flatten the tree using a foldLeft to avoid SOF
   */</span>
  <span class="keyword">def</span> <a title="[A](tree: org.specs2.internal.scalaz.Tree[A])Stream[A]" id="103882">flattenLeft</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103884">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[A]" id="104103">tree</a>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Stream[A]">Stream</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#103885" title="(tree: org.specs2.internal.scalaz.Tree[A], xs: Stream[A])Stream[A]">squishLeft</a><span class="delimiter">(</span><a href="#104103" title="org.specs2.internal.scalaz.Tree[A]">tree</a>, <span title="=&gt; collection.immutable.Stream.type">Stream</span>.<span title="object Stream.Empty">Empty</span><span class="delimiter">)</span>

  <span class="comment">/** reimplementation of squish from scalaz, using a foldLeft */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[A](tree: org.specs2.internal.scalaz.Tree[A], xs: Stream[A])Stream[A]" id="103885">squishLeft</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103887">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.Tree[A]" id="105097">tree</a>: <span title="org.specs2.internal.scalaz.Tree[A]">Tree</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Stream[A]" id="105098">xs</a>: <span title="Stream[A]">Stream</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Stream[A]">Stream</span><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <span title="=&gt; collection.immutable.Stream.type">Stream</span>.<span title="(hd: A, tl: =&gt; scala.collection.immutable.Stream[A])Stream.Cons[A]">cons</span><span class="delimiter">(</span><a href="#105097" title="org.specs2.internal.scalaz.Tree[A]">tree</a>.<span title="=&gt; A">rootLabel</span>, <a href="#105097" title="org.specs2.internal.scalaz.Tree[A]">tree</a>.<span title="=&gt; Stream[org.specs2.internal.scalaz.Tree[A]]">subForest</span>.<span title="(l: scala.collection.immutable.Stream[org.specs2.internal.scalaz.Tree[A]])org.specs2.internal.scalaz.MA[scala.collection.immutable.Stream,org.specs2.internal.scalaz.Tree[A]]">reverse</span>.<span title="(b: Stream[A])(f: (Stream[A], org.specs2.internal.scalaz.Tree[A]) =&gt; Stream[A])(implicit r: org.specs2.internal.scalaz.Foldable[scala.collection.immutable.Stream])Stream[A]">foldl</span><span class="delimiter">(</span><a href="#105098" title="Stream[A]">xs</a><span class="delimiter">)</span><span title="org.specs2.internal.scalaz.Foldable[Stream]" class="delimiter">(</span><span class="delimiter">(</span><a title="Stream[A]" id="108873">s</a>, <a title="org.specs2.internal.scalaz.Tree[A]" id="108874">t</a><span class="delimiter">)</span> =&gt; <a href="#103885" title="(tree: org.specs2.internal.scalaz.Tree[A], xs: Stream[A])Stream[A]">squishLeft</a><span class="delimiter">(</span><a href="#108874" title="org.specs2.internal.scalaz.Tree[A]">t</a>, <a href="#108873" title="Stream[A]">s</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Implicit definition to add more functionalities to the TreeLoc class
   */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](t: org.specs2.internal.scalaz.TreeLoc[T])Trees.this.TreeLocx[T]" id="103888">extendTreeLoc</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103890">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.TreeLoc[T]" id="108943">t</a>: <span title="org.specs2.internal.scalaz.TreeLoc[T]">TreeLoc</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="Trees.this.TreeLocx[T]" class="keyword">new</span> <a href="#109439" title="Trees.this.TreeLocx[T]">TreeLocx</a><span class="delimiter">(</span><a href="#108943" title="org.specs2.internal.scalaz.TreeLoc[T]">t</a><span class="delimiter">)</span>
  case <span class="keyword">class</span> <a title="class TreeLocx[T] extends java.lang.Object with ScalaObject with Product with Serializable" id="109439">TreeLocx</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="109441">T</a><span class="delimiter">]</span><a href="#109439" title="ScalaObject" class="delimiter">(</a><a title="org.specs2.internal.scalaz.TreeLoc[T]" id="109545">t</a>: <span title="org.specs2.internal.scalaz.TreeLoc[T]">TreeLoc</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Seq[org.specs2.internal.scalaz.TreeLoc[T]]" id="108950">parentLocs</a> = <a href="#10058" title="Trees.this.type">outer</a>.<a href="#103898" title="(t: org.specs2.internal.scalaz.TreeLoc[T], ps: Seq[org.specs2.internal.scalaz.TreeLoc[T]])Seq[org.specs2.internal.scalaz.TreeLoc[T]]">parentLocs</a><span class="delimiter">(</span><a href="#109545" title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]">t</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; Int" id="108951">size</a> = <a href="#10058" title="Trees.this.type">outer</a>.<a href="#103895" title="(t: org.specs2.internal.scalaz.TreeLoc[T])Int">size</a><span class="delimiter">(</span><a href="#109545" title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]">t</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]" id="108952">getParent</a> = <a href="#109545" title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]">t</a>.<span title="=&gt; Option[org.specs2.internal.scalaz.TreeLoc[T]]">parent</span>.<span title="(default: =&gt; org.specs2.internal.scalaz.TreeLoc[T])org.specs2.internal.scalaz.TreeLoc[T]">getOrElse</span><span class="delimiter">(</span><a href="#109545" title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]">t</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(f: T =&gt; T)org.specs2.internal.scalaz.TreeLoc[T]" id="108953">updateLabel</a><span class="delimiter">(</span><a title="T =&gt; T" id="109311">f</a>: T =&gt; T<span class="delimiter">)</span> = <a href="#109545" title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]">t</a>.<span title="(a: T)org.specs2.internal.scalaz.TreeLoc[T]">setLabel</span><span class="delimiter">(</span><a href="#109311" title="(v1: T)T">f</a><span class="delimiter">(</span><a href="#109545" title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]">t</a>.<span title="=&gt; T">getLabel</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(c: T)org.specs2.internal.scalaz.TreeLoc[T]" id="108954">addChild</a><span class="delimiter">(</span><a title="T" id="109320">c</a>: <a href="#109441" title="T">T</a><span class="delimiter">)</span> = <a href="#109545" title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]">t</a>.<span title="(t: org.specs2.internal.scalaz.Tree[T])org.specs2.internal.scalaz.TreeLoc[T]">insertDownLast</span><a href="#103888" title="(t: org.specs2.internal.scalaz.TreeLoc[T])Trees.this.TreeLocx[T]" class="delimiter">(</a><span title="(root: =&gt; T)org.specs2.internal.scalaz.Tree[T]">leaf</span><span class="delimiter">(</span><a href="#109320" title="T">c</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="#108952" title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]">getParent</a>
    <span class="keyword">def</span> <a title="(c: T)org.specs2.internal.scalaz.TreeLoc[T]" id="108955">addFirstChild</a><span class="delimiter">(</span><a title="T" id="109374">c</a>: <a href="#109441" title="T">T</a><span class="delimiter">)</span> = <a href="#109545" title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]">t</a>.<span title="(t: org.specs2.internal.scalaz.Tree[T])org.specs2.internal.scalaz.TreeLoc[T]">insertDownFirst</span><a href="#103888" title="(t: org.specs2.internal.scalaz.TreeLoc[T])Trees.this.TreeLocx[T]" class="delimiter">(</a><span title="(root: =&gt; T)org.specs2.internal.scalaz.Tree[T]">leaf</span><span class="delimiter">(</span><a href="#109374" title="T">c</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="#108952" title="=&gt; org.specs2.internal.scalaz.TreeLoc[T]">getParent</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * @return the number of nodes in a TreeLoc
   */</span>
  <span class="keyword">def</span> <a title="[A](t: org.specs2.internal.scalaz.TreeLoc[A])Int" id="103895">size</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="103897">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.TreeLoc[A]" id="109274">t</a>: <span title="org.specs2.internal.scalaz.TreeLoc[A]">TreeLoc</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#109274" title="org.specs2.internal.scalaz.TreeLoc[A]">t</a>.<span title="=&gt; org.specs2.internal.scalaz.TreeLoc[A]">root</span>.<span title="=&gt; org.specs2.internal.scalaz.Tree[A]">toTree</span>.<span title="=&gt; Stream[A]">flatten</span>.<span title="=&gt; Int">size</span>

  <span class="comment">/**
   * @return the list of all parent locs from a given TreeLoc
   */</span>
  <span class="keyword">def</span> <a title="[T](t: org.specs2.internal.scalaz.TreeLoc[T], ps: Seq[org.specs2.internal.scalaz.TreeLoc[T]])Seq[org.specs2.internal.scalaz.TreeLoc[T]]" id="103898">parentLocs</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="108974">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.TreeLoc[T]" id="108969">t</a>: <span title="org.specs2.internal.scalaz.TreeLoc[T]">TreeLoc</span><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="Seq[org.specs2.internal.scalaz.TreeLoc[T]]" id="108972">ps</a>: <span title="Seq[org.specs2.internal.scalaz.TreeLoc[T]]">Seq</span><span class="delimiter">[</span>TreeLoc<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="(elems: Nothing*)scala.collection.immutable.Vector[Nothing]">Vector</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>: <span title="Seq[org.specs2.internal.scalaz.TreeLoc[T]]">Seq</span><span class="delimiter">[</span>TreeLoc<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#108969" title="org.specs2.internal.scalaz.TreeLoc[T]">t</a>.<span title="=&gt; Option[org.specs2.internal.scalaz.TreeLoc[T]]">parent</span> <span title="Seq[org.specs2.internal.scalaz.TreeLoc[T]]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Seq[org.specs2.internal.scalaz.TreeLoc[T]]">Some</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.TreeLoc[T]" id="109481">p</a><span class="delimiter">)</span> =&gt; <a href="#103898" title="(t: org.specs2.internal.scalaz.TreeLoc[T], ps: Seq[org.specs2.internal.scalaz.TreeLoc[T]])Seq[org.specs2.internal.scalaz.TreeLoc[T]]">parentLocs</a><span class="delimiter">(</span><a href="#109481" title="org.specs2.internal.scalaz.TreeLoc[T]">p</a>, <a href="#109481" title="org.specs2.internal.scalaz.TreeLoc[T]">p</a> <a href="#109485" title="(elem: org.specs2.internal.scalaz.TreeLoc[T])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[org.specs2.internal.scalaz.TreeLoc[T]],org.specs2.internal.scalaz.TreeLoc[T],Seq[org.specs2.internal.scalaz.TreeLoc[T]]])Seq[org.specs2.internal.scalaz.TreeLoc[T]]">+:</a> <a href="#108972" title="Seq[org.specs2.internal.scalaz.TreeLoc[T]]">ps</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Seq[org.specs2.internal.scalaz.TreeLoc[T]]">None</span>    =&gt; <a href="#108972" title="Seq[org.specs2.internal.scalaz.TreeLoc[T]]">ps</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>
<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">object</span> <a title="object org.specs2.data.Trees" id="10059">Trees</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#10058" title="org.specs2.data.Trees">Trees</a>

        </pre>
    </body>
</html>
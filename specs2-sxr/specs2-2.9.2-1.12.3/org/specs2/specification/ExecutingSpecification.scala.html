<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/specification/ExecutingSpecification.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> specification

<span class="keyword">import</span> collection.<a href="../collection/Iterablex.scala.html#9887" title="object org.specs2.collection.Iterablex">Iterablex</a>._
<span class="keyword">import</span> java.util.concurrent.<span class="delimiter">{</span>Executors, ExecutorService<span class="delimiter">}</span>
<span class="keyword">import</span> control.NamedThreadFactory
<span class="keyword">import</span> <a href="#350838" title="object org.specs2.specification.ExecutingSpecification">ExecutingSpecification</a>._
<span class="keyword">import</span> main.Arguments

<span class="comment">/**
 * a specification with a name and a sequence of fragments being executed
 */</span>
case <span class="keyword">class</span> <a title="class ExecutingSpecification extends java.lang.Object with ScalaObject with Product with Serializable" id="294733">ExecutingSpecification</a><a href="#294733" title="ScalaObject" class="delimiter">(</a><a title="org.specs2.specification.SpecName" id="298210">name</a>: <a href="SpecName.scala.html#13075" title="org.specs2.specification.SpecName">SpecName</a>, <a title="org.specs2.main.Arguments" id="298211">arguments</a>: <a href="../main/Arguments.scala.html#10577" title="org.specs2.main.Arguments">Arguments</a>, <a title="Seq[org.specs2.specification.ExecutingFragment]" id="298212">fs</a>: <span title="Seq[org.specs2.specification.ExecutingFragment]">Seq</span><span class="delimiter">[</span>ExecutingFragment<span class="delimiter">]</span>, <a title="java.util.concurrent.ExecutorService" id="298213">executor</a>: <span title="java.util.concurrent.ExecutorService">ExecutorService</span> = <a href="#294732" title="=&gt; java.util.concurrent.ExecutorService">newExecutor</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="comment">/** @return the executed fragments, but as a lazy list */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="org.specs2.specification.ExecutedSpecification" id="294695">execute</a> = <a href="ExecutedSpecification.scala.html#298303" title="(name: org.specs2.specification.SpecName, fs: Seq[org.specs2.specification.ExecutedFragment])org.specs2.specification.ExecutedSpecification">ExecutedSpecification</a><span class="delimiter">(</span><a href="#298210" title="=&gt; org.specs2.specification.SpecName">name</a>, <a href="#294697" title="(f: (org.specs2.specification.SpecName, Seq[org.specs2.specification.ExecutedFragment]) =&gt; Seq[org.specs2.specification.ExecutedFragment])Seq[org.specs2.specification.ExecutedFragment]">foreach</a> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="org.specs2.specification.SpecName" id="298409">n</a>, <a title="Seq[org.specs2.specification.ExecutedFragment]" id="298410">fs</a><span class="delimiter">)</span> =&gt; <a href="#298410" title="Seq[org.specs2.specification.ExecutedFragment]">fs</a>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[org.specs2.specification.ExecutedFragment,Seq[org.specs2.specification.ExecutedFragment]]">view</span>.<span title="(f: org.specs2.specification.ExecutedFragment =&gt; org.specs2.specification.ExecutedFragment)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[org.specs2.specification.ExecutedFragment,Seq[org.specs2.specification.ExecutedFragment]],org.specs2.specification.ExecutedFragment,Seq[org.specs2.specification.ExecutedFragment]])Seq[org.specs2.specification.ExecutedFragment]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,org.specs2.specification.ExecutedFragment,scala.collection.SeqView[org.specs2.specification.ExecutedFragment,Seq[_]]]" class="delimiter">(</span><a href="#298460" title="org.specs2.specification.ExecutedFragment">_</a>.<a href="ExecutedFragment.scala.html#295938" title="=&gt; org.specs2.specification.ExecutedFragment">get</a><span class="delimiter">)</span> <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/** @return the executed fragments */</span>
  <span class="keyword">def</span> <a title="=&gt; org.specs2.specification.ExecutedSpecification" id="294696">executed</a> = <a href="#294694" title="=&gt; org.specs2.specification.ExecutedSpecification">execute</a>

  <span class="comment">/** @return a lazy list where each fragment will be executed on access */</span>
  <span class="keyword">def</span> <a title="[T](f: (org.specs2.specification.SpecName, Seq[org.specs2.specification.ExecutedFragment]) =&gt; T)T" id="294697">foreach</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="294699">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(org.specs2.specification.SpecName, Seq[org.specs2.specification.ExecutedFragment]) =&gt; T" id="298312">f</a>: <span class="delimiter">(</span>SpecName, Seq<span class="delimiter">[</span>ExecutedFragment<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span> =
    <span class="keyword">try</span> <span class="delimiter">{</span> <a href="#298312" title="(v1: org.specs2.specification.SpecName, v2: Seq[org.specs2.specification.ExecutedFragment])T">f</a><span class="delimiter">(</span><a href="#298210" title="=&gt; org.specs2.specification.SpecName">name</a>, <a href="#298212" title="=&gt; Seq[org.specs2.specification.ExecutingFragment]">fs</a>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[org.specs2.specification.ExecutingFragment,Seq[org.specs2.specification.ExecutingFragment]]">view</span>.<span title="(f: org.specs2.specification.ExecutingFragment =&gt; org.specs2.specification.ExecutedFragment)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[org.specs2.specification.ExecutingFragment,Seq[org.specs2.specification.ExecutingFragment]],org.specs2.specification.ExecutedFragment,Seq[org.specs2.specification.ExecutedFragment]])Seq[org.specs2.specification.ExecutedFragment]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,org.specs2.specification.ExecutedFragment,scala.collection.SeqView[org.specs2.specification.ExecutedFragment,Seq[_]]]" class="delimiter">(</span><a href="#298366" title="org.specs2.specification.ExecutingFragment">_</a>.<a href="ExecutedFragment.scala.html#297938" title="=&gt; org.specs2.specification.ExecutedFragment">get</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span> <a href="#294702" title="=&gt; Unit">terminate</a> <span class="delimiter">}</span>

  <span class="comment">/** @return an ExecutingSpecification where each executed fragment is mapped to another one */</span>
  <span class="keyword">def</span> <a title="(f: org.specs2.specification.ExecutedFragment =&gt; org.specs2.specification.ExecutedFragment)org.specs2.specification.ExecutingSpecification" id="294700">map</a><span class="delimiter">(</span><a title="org.specs2.specification.ExecutedFragment =&gt; org.specs2.specification.ExecutedFragment" id="350558">f</a>: ExecutedFragment =&gt; ExecutedFragment<span class="delimiter">)</span> =  <a href="#298210" title="org.specs2.specification.SpecName" id="350618">copy</a><span class="delimiter">(</span>fs = <a href="#298212" title="=&gt; Seq[org.specs2.specification.ExecutingFragment]">fs</a>.<span title="(f: org.specs2.specification.ExecutingFragment =&gt; org.specs2.specification.ExecutingFragment)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[org.specs2.specification.ExecutingFragment],org.specs2.specification.ExecutingFragment,Seq[org.specs2.specification.ExecutingFragment]])Seq[org.specs2.specification.ExecutingFragment]">map</span><a title="Seq[org.specs2.specification.ExecutingFragment]" id="350615" class="delimiter">(</a><a href="#350595" title="org.specs2.specification.ExecutingFragment">_</a>.<a href="ExecutedFragment.scala.html#297939" title="(f: org.specs2.specification.ExecutedFragment =&gt; org.specs2.specification.ExecutedFragment)org.specs2.specification.ExecutingFragment">map</a><span class="delimiter">(</span><a href="#350558" title="org.specs2.specification.ExecutedFragment =&gt; org.specs2.specification.ExecutedFragment">f</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="294701">toString</a> = <a href="#298212" title="=&gt; Seq[org.specs2.specification.ExecutingFragment]">fs</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; Unit" id="294702">terminate</a> = <a href="#298213" title="=&gt; java.util.concurrent.ExecutorService">executor</a>.<span title="()Unit">shutdown</span><span class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * for testing only
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">object</span> <a title="object org.specs2.specification.ExecutingSpecification" id="350838">ExecutingSpecification</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="comment">/**
   * @return an ExecutedSpecification from a sequence of already executed fragments
   * this method is only for testing as it returns incorrect finished executing fragments (with a wrong &quot;original&quot; value)
   */</span>
  <span class="keyword">def</span> <a title="(fs: Seq[org.specs2.specification.ExecutedFragment], args: org.specs2.main.Arguments)org.specs2.specification.ExecutingSpecification" id="294729">create</a><span class="delimiter">(</span><a title="Seq[org.specs2.specification.ExecutedFragment]" id="328517">fs</a>: <span title="Seq[org.specs2.specification.ExecutedFragment]">Seq</span><span class="delimiter">[</span>ExecutedFragment<span class="delimiter">]</span>, <a title="org.specs2.main.Arguments" id="328518">args</a>: <a href="../main/Arguments.scala.html#10577" title="org.specs2.main.Arguments">Arguments</a><span class="delimiter">)</span>: <a href="#294733" title="org.specs2.specification.ExecutingSpecification">ExecutingSpecification</a> =
    <a href="#294731" title="(fs: Seq[org.specs2.specification.ExecutingFragment], args: org.specs2.main.Arguments)org.specs2.specification.ExecutingSpecification">apply</a><span class="delimiter">(</span><a href="#328517" title="Seq[org.specs2.specification.ExecutedFragment]">fs</a>.<span title="(f: org.specs2.specification.ExecutedFragment =&gt; org.specs2.specification.FinishedExecutingFragment)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[org.specs2.specification.ExecutedFragment],org.specs2.specification.FinishedExecutingFragment,Seq[org.specs2.specification.ExecutingFragment]])Seq[org.specs2.specification.ExecutingFragment]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,org.specs2.specification.FinishedExecutingFragment,Seq[org.specs2.specification.FinishedExecutingFragment]]" class="delimiter">(</span><a title="org.specs2.specification.ExecutedFragment" id="350708">f</a> =&gt; <a href="ExecutedFragment.scala.html#298163" title="(f: org.specs2.specification.ExecutedFragment, original: org.specs2.specification.Fragment)org.specs2.specification.FinishedExecutingFragment">FinishedExecutingFragment</a><span class="delimiter">(</span><a href="#350708" title="org.specs2.specification.ExecutedFragment">f</a>, <a href="Fragment.scala.html#286702" title="(t: String)org.specs2.specification.Text">Text</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#328518" title="org.specs2.main.Arguments">args</a><span class="delimiter">)</span>
  <span class="comment">/**
   * @return an ExecutedSpecification from a sequence of already executed fragments
   */</span>
  <span class="keyword">def</span> <a title="(name: org.specs2.specification.SpecName, fs: Seq[org.specs2.specification.ExecutedFragment], args: org.specs2.main.Arguments)org.specs2.specification.ExecutingSpecification" id="294730">create</a><span class="delimiter">(</span><a title="org.specs2.specification.SpecName" id="328512">name</a>: <a href="SpecName.scala.html#13075" title="org.specs2.specification.SpecName">SpecName</a>, <a title="Seq[org.specs2.specification.ExecutedFragment]" id="328513">fs</a>: <span title="Seq[org.specs2.specification.ExecutedFragment]">Seq</span><span class="delimiter">[</span>ExecutedFragment<span class="delimiter">]</span>, <a title="org.specs2.main.Arguments" id="328516">args</a>: <a href="../main/Arguments.scala.html#10577" title="org.specs2.main.Arguments">Arguments</a> = <a href="../main/Arguments.scala.html#119528" title="(implicit arguments: String*)org.specs2.main.Arguments">Arguments</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>: <a href="#294733" title="org.specs2.specification.ExecutingSpecification">ExecutingSpecification</a> =
    <a href="#294733" title="(name: org.specs2.specification.SpecName, arguments: org.specs2.main.Arguments, fs: Seq[org.specs2.specification.ExecutingFragment], executor: java.util.concurrent.ExecutorService)org.specs2.specification.ExecutingSpecification">ExecutingSpecification</a><span class="delimiter">(</span><a href="#328512" title="org.specs2.specification.SpecName">name</a>, <a href="#328516" title="org.specs2.main.Arguments">args</a>, <a href="#328513" title="Seq[org.specs2.specification.ExecutedFragment]">fs</a>.<span title="(f: org.specs2.specification.ExecutedFragment =&gt; org.specs2.specification.FinishedExecutingFragment)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[org.specs2.specification.ExecutedFragment],org.specs2.specification.FinishedExecutingFragment,Seq[org.specs2.specification.ExecutingFragment]])Seq[org.specs2.specification.ExecutingFragment]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,org.specs2.specification.FinishedExecutingFragment,Seq[org.specs2.specification.FinishedExecutingFragment]]" class="delimiter">(</span><a title="org.specs2.specification.ExecutedFragment" id="350764">f</a> =&gt; <a href="ExecutedFragment.scala.html#298163" title="(f: org.specs2.specification.ExecutedFragment, original: org.specs2.specification.Fragment)org.specs2.specification.FinishedExecutingFragment">FinishedExecutingFragment</a><span class="delimiter">(</span><a href="#350764" title="org.specs2.specification.ExecutedFragment">f</a>, <a href="Fragment.scala.html#286702" title="(t: String)org.specs2.specification.Text">Text</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * @return an ExecutedSpecification from a sequence of fragments being executed
   */</span>
  <span class="keyword">def</span> <a title="(fs: Seq[org.specs2.specification.ExecutingFragment], args: org.specs2.main.Arguments)org.specs2.specification.ExecutingSpecification" id="294731">apply</a><span class="delimiter">(</span><a title="Seq[org.specs2.specification.ExecutingFragment]" id="298216">fs</a>: <span title="Seq[org.specs2.specification.ExecutingFragment]">Seq</span><span class="delimiter">[</span>ExecutingFragment<span class="delimiter">]</span>, <a title="org.specs2.main.Arguments" id="298217">args</a>: <a href="../main/Arguments.scala.html#10577" title="org.specs2.main.Arguments">Arguments</a><span class="delimiter">)</span>: <a href="#294733" title="org.specs2.specification.ExecutingSpecification">ExecutingSpecification</a> = <span class="delimiter">{</span>
    <a href="#298216" title="Seq[org.specs2.specification.ExecutingFragment]">fs</a> <span title="org.specs2.specification.ExecutingSpecification" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="org.specs2.specification.ExecutingSpecification" class="delimiter">(</span>FinishedExecutingFragment<span class="delimiter">(</span><a title="org.specs2.specification.ExecutedSpecStart" id="350805">s</a> @ ExecutedSpecStart<span class="delimiter">(</span>_,_,_<span class="delimiter">)</span>,_<span class="delimiter">)</span><span class="delimiter">)</span> <a href="../collection/Iterablex.scala.html#50830" title="(seq: Seq[org.specs2.specification.ExecutingFragment] with scala.collection.SeqLike[org.specs2.specification.ExecutingFragment,Seq[org.specs2.specification.ExecutingFragment]])Option[(org.specs2.specification.ExecutingFragment, Seq[org.specs2.specification.ExecutingFragment])]">+:</a> <a title="Seq[org.specs2.specification.ExecutingFragment]" id="350806">rest</a> =&gt; <a href="#294733" title="(name: org.specs2.specification.SpecName, arguments: org.specs2.main.Arguments, fs: Seq[org.specs2.specification.ExecutingFragment], executor: java.util.concurrent.ExecutorService)org.specs2.specification.ExecutingSpecification">ExecutingSpecification</a><span class="delimiter">(</span><a href="#350805" title="org.specs2.specification.ExecutedSpecStart">s</a>.<a href="ExecutedFragment.scala.html#297265" title="=&gt; org.specs2.specification.SpecName">specName</a>, <a href="#298217" title="org.specs2.main.Arguments">args</a>, <a href="#298216" title="Seq[org.specs2.specification.ExecutingFragment]">fs</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="org.specs2.specification.ExecutingSpecification" id="350813">other</a>                                                               =&gt; <a href="#294733" title="(name: org.specs2.specification.SpecName, arguments: org.specs2.main.Arguments, fs: Seq[org.specs2.specification.ExecutingFragment], executor: java.util.concurrent.ExecutorService)org.specs2.specification.ExecutingSpecification">ExecutingSpecification</a><span class="delimiter">(</span><a href="SpecName.scala.html#51209" title="(s: String)org.specs2.specification.SpecificationTitle">SpecName</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <a href="#298217" title="org.specs2.main.Arguments">args</a>, <a href="#298216" title="Seq[org.specs2.specification.ExecutingFragment]">fs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; java.util.concurrent.ExecutorService" id="294732">newExecutor</a> = <span class="delimiter">{</span>
    <span title="object java.util.concurrent.Executors">Executors</span>.<span title="(x$1: Int, x$2: java.util.concurrent.ThreadFactory)java.util.concurrent.ExecutorService">newFixedThreadPool</span><span class="delimiter">(</span><span title="object java.lang.Runtime">Runtime</span>.<span title="()java.lang.Runtime">getRuntime</span>.<span title="()Int">availableProcessors</span>, <a href="../control/NamedThreadFactory.scala.html#95861" title="org.specs2.control.NamedThreadFactory" class="keyword">new</a> <a href="../control/NamedThreadFactory.scala.html#9964" title="org.specs2.control.NamedThreadFactory">NamedThreadFactory</a><span class="delimiter">(</span><span title="java.lang.String(&quot;specs2.DefaultExecutionStrategy&quot;)" class="string">&quot;specs2.DefaultExecutionStrategy&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>
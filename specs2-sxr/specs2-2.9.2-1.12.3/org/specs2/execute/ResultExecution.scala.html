<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/execute/ResultExecution.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> execute

<span class="keyword">import</span> control.<a href="../control/Exceptions.scala.html#9922" title="object org.specs2.control.Exceptions">Exceptions</a>._
<span class="keyword">import</span> control.Property
<span class="keyword">import</span> reflect.<a href="../reflect/ClassName.scala.html#11858" title="object org.specs2.reflect.ClassName">ClassName</a>._
<span class="keyword">import</span> text.<a href="../text/NullString.scala.html#13264" title="object org.specs2.text.NotNullStrings">NotNullStrings</a>._
<span class="keyword">import</span> java.util.regex.Pattern

<span class="comment">/**
* This trait executes a Result and returns an appropriate value when a specs2 exception is thrown
*/</span>
<span class="keyword">trait</span> <a title="trait ResultExecution extends java.lang.Object with ScalaObject" id="10180">ResultExecution</a> <span title="ScalaObject" class="delimiter">{</span> outer =&gt;
  <span class="comment">/** this implicit allows the execution of a Result with an `execute` method */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit org.specs2.execute.ResultExecution.resultIsExecutable : (r: =&gt; org.specs2.execute.Result)ResultExecution.this.ExecutableResult" id="63878">resultIsExecutable</a><span class="delimiter">(</span><a title="=&gt; org.specs2.execute.Result" id="65510">r</a>: =&gt;Result<span class="delimiter">)</span> = <span title="ResultExecution.this.ExecutableResult" class="keyword">new</span> <a href="#63879" title="ResultExecution.this.ExecutableResult">ExecutableResult</a><span class="delimiter">(</span><a href="#65510" title="=&gt; org.specs2.execute.Result">r</a><span class="delimiter">)</span>
  <span class="keyword">class</span> <a title="class ExecutableResult extends java.lang.Object with ScalaObject" id="63879">ExecutableResult</a><a href="#63879" title="ScalaObject" class="delimiter">(</a><a title="=&gt; org.specs2.execute.Result" id="65517">r</a>: =&gt;Result<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; org.specs2.execute.Result" id="65516">execute</a> = <a href="#10180" title="ResultExecution.this.type">outer</a>.<a href="#63880" title="(result: =&gt; org.specs2.execute.Result)org.specs2.execute.Result">execute</a><span class="delimiter">(</span><a href="#65517" title="=&gt; org.specs2.execute.Result">r</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="comment">/** execute a Result and return a Result even if there are specs2 exceptions */</span>
  <span class="keyword">def</span> <a title="(result: =&gt; org.specs2.execute.Result)org.specs2.execute.Result" id="63880">execute</a><span class="delimiter">(</span><a title="=&gt; org.specs2.execute.Result" id="63917">result</a>: =&gt;Result<span class="delimiter">)</span> =
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#63917" title="=&gt; org.specs2.execute.Result">result</a>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Failure">FailureException</span><span class="delimiter">(</span><a title="org.specs2.execute.Failure" id="63992">f</a><span class="delimiter">)</span>                                               =&gt; <a href="#63992" title="org.specs2.execute.Failure">f</a>
      <span class="keyword">case</span> <span title="org.specs2.execute.Skipped">SkipException</span><span class="delimiter">(</span><a title="org.specs2.execute.Skipped" id="64034">f</a><span class="delimiter">)</span>                                                  =&gt; <a href="#64034" title="org.specs2.execute.Skipped">f</a>
      <span class="keyword">case</span> <span title="org.specs2.execute.Pending">PendingException</span><span class="delimiter">(</span><a title="org.specs2.execute.Pending" id="64071">f</a><span class="delimiter">)</span>                                               =&gt; <a href="#64071" title="org.specs2.execute.Pending">f</a>
      <span class="keyword">case</span> <span title="org.specs2.execute.DecoratedResult[Any]">DecoratedResultException</span><span class="delimiter">(</span><a title="org.specs2.execute.DecoratedResult[Any]" id="64107">f</a><span class="delimiter">)</span>                                       =&gt; <a href="#64107" title="org.specs2.execute.DecoratedResult[Any]">f</a>
      <span class="keyword">case</span> <a title="org.specs2.execute.Error" id="64114">e</a>: <span title="Exception">Exception</span>                                                      =&gt; <a href="Result.scala.html#64116" title="(e: Exception)org.specs2.execute.Error">Error</a><span class="delimiter">(</span><a href="#64114" title="Exception">e</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="org.specs2.execute.Failure" id="65456">e</a>: <span title="java.lang.AssertionError">AssertionError</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="#63894" title="(e: java.lang.AssertionError)Boolean">fromJUnit</a><span class="delimiter">(</span><a href="#65456" title="java.lang.AssertionError">e</a><span class="delimiter">)</span><span class="delimiter">)</span>                               =&gt; <a href="Result.scala.html#66178" title="(m: String, e: String, stackTrace: List[java.lang.StackTraceElement], details: org.specs2.execute.Details)org.specs2.execute.Failure">Failure</a><span class="delimiter">(</span><a href="#65456" title="java.lang.AssertionError">e</a>.<a href="../text/NullString.scala.html#39777" title="implicit org.specs2.text.NotNullStrings.anyToNotNull : (a: Any)org.specs2.text.NotNullStrings.NotNullAny">getMessage</a>.<a href="../text/NullString.scala.html#63326" title="=&gt; String">notNull</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <a href="#65456" title="java.lang.AssertionError">e</a>.<span title="(xs: Array[java.lang.StackTraceElement])scala.collection.mutable.ArrayOps[java.lang.StackTraceElement]">getStackTrace</span>.<span title="=&gt; List[java.lang.StackTraceElement]">toList</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="org.specs2.execute.Failure" id="66306">e</a>: java.lang.<span title="java.lang.Error">Error</span> <span class="keyword">if</span> <a href="../reflect/ClassName.scala.html#51212" title="(any: AnyRef)String">simpleClassName</a><span class="delimiter">(</span><a href="#66306" title="java.lang.Error">e</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;NotImplementedError&quot;)" class="string">&quot;NotImplementedError&quot;</span> =&gt; <a href="Result.scala.html#66178" title="(m: String, e: String, stackTrace: List[java.lang.StackTraceElement], details: org.specs2.execute.Details)org.specs2.execute.Failure">Failure</a><span class="delimiter">(</span><a href="#66306" title="java.lang.Error">e</a>.<a href="../text/NullString.scala.html#39777" title="implicit org.specs2.text.NotNullStrings.anyToNotNull : (a: Any)org.specs2.text.NotNullStrings.NotNullAny">getMessage</a>.<a href="../text/NullString.scala.html#63326" title="=&gt; String">notNull</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <a href="#66306" title="java.lang.Error">e</a>.<span title="(xs: Array[java.lang.StackTraceElement])scala.collection.mutable.ArrayOps[java.lang.StackTraceElement]">getStackTrace</span>.<span title="=&gt; List[java.lang.StackTraceElement]">toList</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="org.specs2.execute.Error" id="66423">e</a>: <span title="Throwable">Throwable</span>                                                      =&gt; <a href="Result.scala.html#64117" title="(t: Throwable)org.specs2.execute.Error">Error</a><span class="delimiter">(</span><a href="#66423" title="java.lang.Throwable">e</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="comment">/**
   * execute a piece of code and return a result:
   *
   *  - if the code already returns a result, just keep it
   *  - if the code throws an Exception return an Error
   *  - if the code returns a value of type T, convert it to a result
   */</span>
  <span class="keyword">def</span> <a title="[T, R](code: =&gt; T)(convert: T =&gt; R)(implicit evidence$1: org.specs2.execute.AsResult[R])org.specs2.execute.Result" id="63902">execute</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="63884">T</a>, <a title="&gt;: Nothing &lt;: Any" id="63885">R</a> : AsResult<span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; T" id="63900">code</a>: =&gt;T<span class="delimiter">)</span><span class="delimiter">(</span><a title="T =&gt; R" id="63901">convert</a>: T =&gt; R<span class="delimiter">)</span>: <a href="Result.scala.html#10121" title="org.specs2.execute.Result">Result</a> = <a href="#63886" title="(code: =&gt; T)(implicit convert: T =&gt; R)Either[org.specs2.execute.Result,R]">executeEither</a><span class="delimiter">(</span><a href="#63900" title="=&gt; T">code</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#63901" title="T =&gt; R">convert</a><span class="delimiter">)</span> <span title="org.specs2.execute.Result" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="org.specs2.execute.Result">Left</span><span class="delimiter">(</span><a title="org.specs2.execute.Result" id="124989">r</a><span class="delimiter">)</span>  =&gt; <a href="Result.scala.html#45824" title="(r: =&gt; org.specs2.execute.Result)(implicit evidence$1: org.specs2.execute.AsResult[org.specs2.execute.Result])org.specs2.execute.Result">AsResult</a><a href="Result.scala.html#45820" title="org.specs2.execute.AsResult[org.specs2.execute.Result]" class="delimiter">(</a><a href="#124989" title="org.specs2.execute.Result">r</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="org.specs2.execute.Result">Right</span><span class="delimiter">(</span><a title="R" id="125002">r</a><span class="delimiter">)</span> =&gt; <a href="Result.scala.html#45824" title="(r: =&gt; R)(implicit evidence$1: org.specs2.execute.AsResult[R])org.specs2.execute.Result">AsResult</a><a href="#63902" title="org.specs2.execute.AsResult[R]" class="delimiter">(</a><a href="#125002" title="R">r</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * execute a piece of code and return a result, either as a Left(failure) or a Right(value)
   */</span>
  <span class="keyword">def</span> <a title="[T, R](code: =&gt; T)(implicit convert: T =&gt; R)Either[org.specs2.execute.Result,R]" id="63886">executeEither</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="63889">T</a>, <a title="&gt;: Nothing &lt;: Any" id="63890">R</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; T" id="124973">code</a>: =&gt;T<span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="T =&gt; R" id="124974">convert</a>: T =&gt; R<span class="delimiter">)</span>: <span title="Either[org.specs2.execute.Result,R]">Either</span><span class="delimiter">[</span>Result, R<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Either[Exception,T]" id="125010">executed</a> = <a href="../control/Exceptions.scala.html#15383" title="(a: =&gt; T)(implicit f: Exception =&gt; Exception)Either[Exception,T]">trye</a><span class="delimiter">(</span><a href="#124973" title="=&gt; T">code</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#125021" title="(x: Exception)Exception">identity</a><span class="delimiter">)</span>
    <a href="#125010" title="Either[Exception,T]">executed</a> <span title="Either[org.specs2.execute.Result,R]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Left[org.specs2.execute.Failure,Nothing]">Left</span><span class="delimiter">(</span>FailureException<span class="delimiter">(</span><a title="org.specs2.execute.Failure" id="125027">f</a><span class="delimiter">)</span><span class="delimiter">)</span>                         =&gt; <span title="(a: org.specs2.execute.Failure)Left[org.specs2.execute.Failure,Nothing]">Left</span><span class="delimiter">(</span><a href="#125027" title="org.specs2.execute.Failure">f</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Left[org.specs2.execute.Skipped,Nothing]">Left</span><span class="delimiter">(</span>SkipException<span class="delimiter">(</span><a title="org.specs2.execute.Skipped" id="125034">f</a><span class="delimiter">)</span><span class="delimiter">)</span>                            =&gt; <span title="(a: org.specs2.execute.Skipped)Left[org.specs2.execute.Skipped,Nothing]">Left</span><span class="delimiter">(</span><a href="#125034" title="org.specs2.execute.Skipped">f</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Left[org.specs2.execute.Pending,Nothing]">Left</span><span class="delimiter">(</span>PendingException<span class="delimiter">(</span><a title="org.specs2.execute.Pending" id="125040">f</a><span class="delimiter">)</span><span class="delimiter">)</span>                         =&gt; <span title="(a: org.specs2.execute.Pending)Left[org.specs2.execute.Pending,Nothing]">Left</span><span class="delimiter">(</span><a href="#125040" title="org.specs2.execute.Pending">f</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Left[org.specs2.execute.Error,Nothing]">Left</span><span class="delimiter">(</span><a title="Exception" id="125046">e</a><span class="delimiter">)</span>                                           =&gt; <span title="(a: org.specs2.execute.Error)Left[org.specs2.execute.Error,Nothing]">Left</span><span class="delimiter">(</span><a href="Result.scala.html#64116" title="(e: Exception)org.specs2.execute.Error">Error</a><span class="delimiter">(</span><a href="#125046" title="Exception">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Left[org.specs2.execute.Result,Nothing]">Right</span><span class="delimiter">(</span><a title="org.specs2.execute.ResultLike" id="125060">m</a>: <a href="ResultLike.scala.html#10197" title="org.specs2.execute.ResultLike">ResultLike</a><span class="delimiter">)</span>     <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#125060" title="org.specs2.execute.ResultLike">m</a>.<a href="ResultLike.scala.html#39718" title="=&gt; org.specs2.execute.Result">toResult</a>.<a href="Result.scala.html#34852" title="=&gt; Boolean">isSuccess</a> =&gt; <span title="(a: org.specs2.execute.Result)Left[org.specs2.execute.Result,Nothing]">Left</span><span class="delimiter">(</span><a href="#125060" title="org.specs2.execute.ResultLike">m</a>.<a href="ResultLike.scala.html#39718" title="=&gt; org.specs2.execute.Result">toResult</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Left[org.specs2.execute.Result,Nothing]">Right</span><span class="delimiter">(</span><a title="org.specs2.execute.Result" id="125066">r</a>: <a href="Result.scala.html#10121" title="org.specs2.execute.Result">Result</a><span class="delimiter">)</span>         <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#125066" title="org.specs2.execute.Result">r</a>.<a href="Result.scala.html#34852" title="=&gt; Boolean">isSuccess</a>          =&gt; <span title="(a: org.specs2.execute.Result)Left[org.specs2.execute.Result,Nothing]">Left</span><span class="delimiter">(</span><a href="#125066" title="org.specs2.execute.Result">r</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Right[Nothing,R]">Right</span><span class="delimiter">(</span><a title="T" id="125072">other</a><span class="delimiter">)</span>                                      =&gt; <span title="(b: R)Right[Nothing,R]">Right</span><span class="delimiter">(</span><a href="#124974" title="(v1: T)R">convert</a><span class="delimiter">(</span><a href="#125072" title="T">other</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * execute a Property returning the value if it exists and a Success result otherwise
   */</span>
  <span class="keyword">def</span> <a title="[T](prop: org.specs2.control.Property[T], default: org.specs2.execute.Result)Product with Serializable with Either[org.specs2.execute.Result,T]" id="63891">executeProperty</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="125084">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.control.Property[T]" id="125078">prop</a>: <a href="../control/Property.scala.html#9970" title="org.specs2.control.Property[T]">Property</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="org.specs2.execute.Result" id="125082">default</a>: <a href="Result.scala.html#10121" title="org.specs2.execute.Result">Result</a> = <a href="Result.scala.html#119277" title="(m: String, exp: String)org.specs2.execute.Success">Success</a><span class="delimiter">(</span><span title="java.lang.String(&quot;no value&quot;)" class="string">&quot;no value&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="#63886" title="(code: =&gt; Option[T])(implicit convert: Option[T] =&gt; Option[T])Either[org.specs2.execute.Result,Option[T]]">executeEither</a><span title="&lt;:&lt;[Option[T],Option[T]]" class="delimiter">(</span><a href="#125078" title="org.specs2.control.Property[T]">prop</a>.<a href="../control/Property.scala.html#96023" title="=&gt; Option[T]">optionalValue</a><span class="delimiter">)</span> <span title="&lt;none&gt; extends Product with Serializable with Either[org.specs2.execute.Result,T]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Right[Nothing,T]">Right</span><span class="delimiter">(</span>Some<span class="delimiter">(</span><a title="T" id="125156">v</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <span title="(b: T)Right[Nothing,T]">Right</span><span class="delimiter">(</span><a href="#125156" title="T">v</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Left[org.specs2.execute.Result,Nothing]">Right</span><span class="delimiter">(</span><span title="object None">None</span><span class="delimiter">)</span>    =&gt; <span title="(a: org.specs2.execute.Result)Left[org.specs2.execute.Result,Nothing]">Left</span><span class="delimiter">(</span><a href="#125082" title="org.specs2.execute.Result">default</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Left[org.specs2.execute.Result,Nothing]">Left</span><span class="delimiter">(</span><a title="org.specs2.execute.Result" id="125167">r</a><span class="delimiter">)</span>        =&gt; <span title="(a: org.specs2.execute.Result)Left[org.specs2.execute.Result,Nothing]">Left</span><span class="delimiter">(</span><a href="#125167" title="org.specs2.execute.Result">r</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** determine if an AssertionError has been thrown from JUnit or not */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(e: java.lang.AssertionError)Boolean" id="63894">fromJUnit</a><span class="delimiter">(</span><a title="java.lang.AssertionError" id="65489">e</a>: <span title="java.lang.AssertionError">AssertionError</span><span class="delimiter">)</span> = <a href="#65489" title="java.lang.AssertionError">e</a>.<span title="(xs: Array[java.lang.StackTraceElement])scala.collection.mutable.ArrayOps[java.lang.StackTraceElement]">getStackTrace</span>.<span title="(p: java.lang.StackTraceElement =&gt; Boolean)Boolean">exists</span><span class="delimiter">(</span><span class="delimiter">(</span>st: <span title="java.lang.StackTraceElement">StackTraceElement</span><span class="delimiter">)</span> =&gt; <a href="#63895" title="=&gt; java.util.regex.Pattern">JUNIT_ASSERT</a>.<span title="(x$1: java.lang.CharSequence)java.util.regex.Matcher">matcher</span><span class="delimiter">(</span><a href="#65832" title="java.lang.StackTraceElement">st</a>.<span title="()java.lang.String">getClassName</span><span class="delimiter">)</span>.<span title="()Boolean">matches</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.util.regex.Pattern" id="63896">JUNIT_ASSERT</a> = <span title="object java.util.regex.Pattern">Pattern</span>.<span title="(x$1: java.lang.String)java.util.regex.Pattern">compile</span><span class="delimiter">(</span><span title="java.lang.String(&quot;.*junit.*Assert.*&quot;)" class="string">&quot;.*junit.*Assert.*&quot;</span><span class="delimiter">)</span>
<span class="delimiter">}</span>
<span class="keyword">object</span> <a title="object org.specs2.execute.ResultExecution" id="10181">ResultExecution</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#10180" title="org.specs2.execute.ResultExecution">ResultExecutio</a>n
        </pre>
    </body>
</html>
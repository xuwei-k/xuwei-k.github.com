<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/matcher/TerminationMatchers.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> matcher

<span class="keyword">import</span> time._
<span class="keyword">import</span> <a href="../time/Time.scala.html#13339" title="object org.specs2.time.TimeConversions">TimeConversions</a>._
<span class="keyword">import</span> internal.scalaz._
<span class="keyword">import</span> <span title="object org.specs2.internal.scalaz.Scalaz">Scalaz</span>._
<span class="keyword">import</span> concurrent.Promise

<span class="comment">/**
 * This trait provides matchers to check if a block of code is terminating or not
 */</span>
<span class="keyword">trait</span> <a title="trait TerminationMatchers extends java.lang.Object with org.specs2.matcher.TerminationBaseMatchers with org.specs2.matcher.TerminationNotMatchers" id="11161">TerminationMatchers</a> <span class="keyword">extends</span> <a href="#11162" title="org.specs2.matcher.TerminationBaseMatchers">TerminationBaseMatchers</a> <span class="keyword">with</span> <a href="#11167" title="org.specs2.matcher.TerminationNotMatchers">TerminationNotMatchers</a>

<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">trait</span> <a title="trait TerminationBaseMatchers extends java.lang.Object with ScalaObject" id="11162">TerminationBaseMatchers</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="comment">/**
   * this matchers will check if a block of code terminates within a given duration, after just one try
   */</span>
  <span class="keyword">def</span> <a title="[T]=&gt; org.specs2.matcher.TerminationMatcher[T]" id="251755">terminate</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="251757">T</a><span class="delimiter">]</span>: <a href="#11165" title="org.specs2.matcher.TerminationMatcher[T]">TerminationMatcher</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <a href="#251758" title="(retries: Int, sleep: org.specs2.time.Duration)org.specs2.matcher.TerminationMatcher[T]">terminate</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">/**
   * this matchers will check if a block of code terminates within a given duration, and a given number of retries
   */</span>
  <span class="keyword">def</span> <a title="[T](retries: Int, sleep: org.specs2.time.Duration)org.specs2.matcher.TerminationMatcher[T]" id="251758">terminate</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="251816">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="251814">retries</a>: <span title="Int">Int</span> = <span title="Int(1)" class="int">1</span>, <a title="org.specs2.time.Duration" id="251817">sleep</a>: <a href="../time/Time.scala.html#13341" title="org.specs2.time.Duration">Duration</a> = <a href="../time/Time.scala.html#52381" title="implicit org.specs2.time.TimeConversions.intToRichLong : (v: Int)org.specs2.time.TimeConversions.RichLong" class="int">100</a>.<a href="../time/Time.scala.html#53738" title="=&gt; org.specs2.time.Duration">millis</a><span class="delimiter">)</span> = <a href="#251826" title="org.specs2.matcher.TerminationMatcher[T]" class="keyword">new</a> <a href="#11165" title="org.specs2.matcher.TerminationMatcher[T]">TerminationMatcher</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#251814" title="Int">retries</a>, <a href="#251817" title="org.specs2.time.Duration">sleep</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class TerminationMatcher[-T] extends java.lang.Object with org.specs2.matcher.Matcher[T] with ScalaObject" id="11165">TerminationMatcher</a><span class="delimiter">[</span>-<a title="&gt;: Nothing &lt;: Any" id="251828">T</a><span class="delimiter">]</span><a href="#11165" title="ScalaObject" class="delimiter">(</a><a title="Int" id="251820">retries</a>: <span title="Int">Int</span>, <a title="org.specs2.time.Duration" id="251821">sleep</a>: <a href="../time/Time.scala.html#13341" title="org.specs2.time.Duration">Duration</a>, <a title="Option[() =&gt; Any]" id="251826">whenAction</a>: <span title="Option[() =&gt; Any]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Any<span class="delimiter">]</span> = <span title="object None">None</span>, <a title="Option[String]" id="251829">whenDesc</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="object None">None</span>, <a title="Boolean" id="251832">onlyWhen</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="Matcher.scala.html#10945" title="org.specs2.matcher.Matcher[T]">Matcher</a><span class="delimiter">[</span>T<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S &lt;: T](a: org.specs2.matcher.Expectable[S])org.specs2.matcher.MatchResult[S]" id="251785">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: T" id="251787">S</a> &lt;: T<span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.matcher.Expectable[S]" id="251843">a</a>: <a href="Expectable.scala.html#10773" title="org.specs2.matcher.Expectable[S]">Expectable</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#251788" title="(originalRetries: Int, retries: Int, sleep: org.specs2.time.Duration, a: org.specs2.matcher.Expectable[S], promise: org.specs2.internal.scalaz.concurrent.Promise[S], whenActionExecuted: Boolean)org.specs2.matcher.MatchResult[S]">retry</a><span class="delimiter">(</span><a href="#251820" title="Int">retries</a>, <a href="#251820" title="Int">retries</a>, <a href="#251821" title="org.specs2.time.Duration">sleep</a>, <a href="#251843" title="org.specs2.matcher.Expectable[S]">a</a>, <span title="(a: =&gt; S)(implicit s: org.specs2.internal.scalaz.concurrent.Strategy)org.specs2.internal.scalaz.concurrent.Promise[S]">promise</span><span title="=&gt; org.specs2.internal.scalaz.concurrent.Strategy" class="delimiter">(</span><a href="#251843" title="org.specs2.matcher.Expectable[S]">a</a>.<a href="Expectable.scala.html#53755" title="=&gt; S">value</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[S &lt;: T](originalRetries: Int, retries: Int, sleep: org.specs2.time.Duration, a: org.specs2.matcher.Expectable[S], promise: org.specs2.internal.scalaz.concurrent.Promise[S], whenActionExecuted: Boolean)org.specs2.matcher.MatchResult[S]" id="251788">retry</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: T" id="251862">S</a> &lt;: T<span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="251853">originalRetries</a>: <span title="Int">Int</span>, <a title="Int" id="251854">retries</a>: <span title="Int">Int</span>, <a title="org.specs2.time.Duration" id="251855">sleep</a>: <a href="../time/Time.scala.html#13341" title="org.specs2.time.Duration">Duration</a>, <a title="org.specs2.matcher.Expectable[S]" id="251856">a</a>: <a href="Expectable.scala.html#10773" title="org.specs2.matcher.Expectable[S]">Expectable</a><span class="delimiter">[</span>S<span class="delimiter">]</span>, <a title="org.specs2.internal.scalaz.concurrent.Promise[S]" id="251857">promise</a>: <span title="org.specs2.internal.scalaz.concurrent.Promise[S]">Promise</span><span class="delimiter">[</span>S<span class="delimiter">]</span>, <a title="Boolean" id="251860">whenActionExecuted</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>: <a href="MatchResult.scala.html#10872" title="org.specs2.matcher.MatchResult[S]">MatchResult</a><span class="delimiter">[</span>S<span class="delimiter">]</span> = <span class="delimiter">{</span>

    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Boolean" id="252045">fulfilled</a> = <a href="#251857" title="org.specs2.internal.scalaz.concurrent.Promise[S]">promise</a>.<span title="=&gt; Boolean">fulfilled</span>
    <span class="keyword">val</span> <a title="java.lang.String" id="252046">parameters</a> = <span title="java.lang.String(&quot;with retries=&quot;)" class="string">&quot;with retries=&quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#251853" title="Int">originalRetries</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot; and sleep=&quot;)" class="string">&quot; and sleep=&quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#251855" title="org.specs2.time.Duration">sleep</a>.<a href="../time/Time.scala.html#119052" title="=&gt; Long">inMillis</a>
    <span class="keyword">val</span> <a title="java.lang.String" id="252047">evenWhenAction</a> = <a href="#251829" title="Option[String]">whenDesc</a>.<span title="(f: String =&gt; java.lang.String)Option[java.lang.String]">map</span><span class="delimiter">(</span><a title="String" id="252055">w</a> =&gt; <span title="java.lang.String(&quot; even when &quot;)" class="string">&quot; even when &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#252055" title="String">w</a><span class="delimiter">)</span>.<span title="(default: =&gt; java.lang.String)java.lang.String">getOrElse</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="String" id="252048">onlyWhenAction</a> = <a href="#251829" title="Option[String]">whenDesc</a>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><span title="java.lang.String(&quot;the second action&quot;)" class="string">&quot;the second action&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; org.specs2.matcher.MatchResult[S]" id="252049">terminates</a> = <a href="Matcher.scala.html#39595" title="(test: =&gt; Boolean, okMessage: =&gt; String, koMessage: =&gt; String, value: org.specs2.matcher.Expectable[S])org.specs2.matcher.MatchResult[S]">result</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="java.lang.String(&quot;the action terminates&quot;)" class="string">&quot;the action terminates&quot;</span>, <span title="java.lang.String(&quot;the action is blocking &quot;)" class="string">&quot;the action is blocking &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#252046" title="java.lang.String">parameters</a><span title="(x$1: Any)java.lang.String">+</span><a href="#252047" title="java.lang.String">evenWhenAction</a>, <a href="#251856" title="org.specs2.matcher.Expectable[S]">a</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; org.specs2.matcher.MatchResult[S]" id="252050">blocks</a>     = <span class="delimiter">{</span> <a href="#251857" title="org.specs2.internal.scalaz.concurrent.Promise[S]">promise</a>.<span title="=&gt; Unit">break</span>; <a href="Matcher.scala.html#39595" title="(test: =&gt; Boolean, okMessage: =&gt; String, koMessage: =&gt; String, value: org.specs2.matcher.Expectable[S])org.specs2.matcher.MatchResult[S]">result</a><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <span title="java.lang.String(&quot;the action terminates&quot;)" class="string">&quot;the action terminates&quot;</span>, <span title="java.lang.String(&quot;the action is blocking &quot;)" class="string">&quot;the action is blocking &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#252046" title="java.lang.String">parameters</a><span title="(x$1: Any)java.lang.String">+</span><a href="#252047" title="java.lang.String">evenWhenAction</a>, <a href="#251856" title="org.specs2.matcher.Expectable[S]">a</a><span class="delimiter">)</span> <span class="delimiter">}</span>

    <span title="org.specs2.matcher.MatchResult[S]" class="keyword">if</span> <span class="delimiter">(</span><a href="#251826" title="Option[() =&gt; Any]">whenAction</a>.<span title="=&gt; Boolean">isDefined</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="org.specs2.matcher.MatchResult[S]" class="keyword">if</span> <span class="delimiter">(</span><a href="#252044" title="=&gt; Boolean">fulfilled</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="org.specs2.matcher.MatchResult[S]" class="keyword">if</span> <span class="delimiter">(</span><a href="#251832" title="Boolean">onlyWhen</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="Matcher.scala.html#39595" title="(test: =&gt; Boolean, okMessage: =&gt; String, koMessage: =&gt; String, value: org.specs2.matcher.Expectable[S])org.specs2.matcher.MatchResult[S]">result</a><span class="delimiter">(</span><a href="#251860" title="Boolean">whenActionExecuted</a>,
                 <span title="java.lang.String(&quot;the action terminates only when &quot;)" class="string">&quot;the action terminates only when &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#252048" title="String">onlyWhenAction</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot; terminates&quot;)" class="string">&quot; terminates&quot;</span>,
                 <span title="java.lang.String(&quot;the action terminated before &quot;)" class="string">&quot;the action terminated before &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#252048" title="String">onlyWhenAction</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot; (&quot;)" class="string">&quot; (&quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#252046" title="java.lang.String">parameters</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>, <a href="#251856" title="org.specs2.matcher.Expectable[S]">a</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#252049" title="=&gt; org.specs2.matcher.MatchResult[S]">terminates</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="org.specs2.matcher.MatchResult[S]" class="keyword">if</span> <span class="delimiter">(</span><a href="#251854" title="Int">retries</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#252050" title="=&gt; org.specs2.matcher.MatchResult[S]">blocks</a>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="comment">// leave the action a chance to finish</span>
          <span title="object java.lang.Thread">Thread</span>.<span title="(x$1: Long)Unit">sleep</span><span class="delimiter">(</span><a href="#251855" title="org.specs2.time.Duration">sleep</a>.<a href="../time/Time.scala.html#119052" title="=&gt; Long">inMillis</a><span class="delimiter">)</span>
          <span class="comment">// if still not finished, try to execute the when action</span>
          <span title="org.specs2.matcher.MatchResult[S]" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#251857" title="org.specs2.internal.scalaz.concurrent.Promise[S]">promise</a>.<span title="=&gt; Boolean">fulfilled</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#251860" title="Boolean">whenActionExecuted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#251826" title="Option[() =&gt; Any]">whenAction</a>.<span title="(f: (() =&gt; Any) =&gt; Any)Option[Any]">map</span><span class="delimiter">(</span><a href="#252214" title="()Any">_</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="comment">// leave again the action a chance to finish</span>
            <span title="object java.lang.Thread">Thread</span>.<span title="(x$1: Long)Unit">sleep</span><span class="delimiter">(</span><a href="#251855" title="org.specs2.time.Duration">sleep</a>.<a href="../time/Time.scala.html#119052" title="=&gt; Long">inMillis</a><span class="delimiter">)</span>
            <a href="#251788" title="(originalRetries: Int, retries: Int, sleep: org.specs2.time.Duration, a: org.specs2.matcher.Expectable[S], promise: org.specs2.internal.scalaz.concurrent.Promise[S], whenActionExecuted: Boolean)org.specs2.matcher.MatchResult[S]">retry</a><span class="delimiter">(</span><a href="#251853" title="Int">originalRetries</a>, <a href="#251854" title="Int">retries</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#251855" title="org.specs2.time.Duration">sleep</a>, <a href="#251856" title="org.specs2.matcher.Expectable[S]">a</a>, <a href="#251857" title="org.specs2.internal.scalaz.concurrent.Promise[S]">promise</a>, whenActionExecuted = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span>
            <a href="#251788" title="(originalRetries: Int, retries: Int, sleep: org.specs2.time.Duration, a: org.specs2.matcher.Expectable[S], promise: org.specs2.internal.scalaz.concurrent.Promise[S], whenActionExecuted: Boolean)org.specs2.matcher.MatchResult[S]">retry</a><span class="delimiter">(</span><a href="#251853" title="Int">originalRetries</a>, <a href="#251854" title="Int">retries</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#251855" title="org.specs2.time.Duration">sleep</a>, <a href="#251856" title="org.specs2.matcher.Expectable[S]">a</a>, <a href="#251857" title="org.specs2.internal.scalaz.concurrent.Promise[S]">promise</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span title="org.specs2.matcher.MatchResult[S]" class="keyword">if</span> <span class="delimiter">(</span><a href="#252044" title="=&gt; Boolean">fulfilled</a><span class="delimiter">)</span> <a href="#252049" title="=&gt; org.specs2.matcher.MatchResult[S]">terminates</a>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="org.specs2.matcher.MatchResult[S]" class="keyword">if</span> <span class="delimiter">(</span><a href="#251854" title="Int">retries</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#252050" title="=&gt; org.specs2.matcher.MatchResult[S]">blocks</a>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <span title="object java.lang.Thread">Thread</span>.<span title="(x$1: Long)Unit">sleep</span><span class="delimiter">(</span><a href="#251855" title="org.specs2.time.Duration">sleep</a>.<a href="../time/Time.scala.html#119052" title="=&gt; Long">inMillis</a><span class="delimiter">)</span>
          <a href="#251788" title="(originalRetries: Int, retries: Int, sleep: org.specs2.time.Duration, a: org.specs2.matcher.Expectable[S], promise: org.specs2.internal.scalaz.concurrent.Promise[S], whenActionExecuted: Boolean)org.specs2.matcher.MatchResult[S]">retry</a><span class="delimiter">(</span><a href="#251853" title="Int">originalRetries</a>, <a href="#251854" title="Int">retries</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#251855" title="org.specs2.time.Duration">sleep</a>, <a href="#251856" title="org.specs2.matcher.Expectable[S]">a</a>, <a href="#251857" title="org.specs2.internal.scalaz.concurrent.Promise[S]">promise</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[S](whenAction: Option[() =&gt; S], whenDesc: =&gt; Option[String], onlyWhen: Boolean)org.specs2.matcher.TerminationMatcher[Any]" id="251791">withAWhenAction</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="251793">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[() =&gt; S]" id="252691">whenAction</a>: <span title="Option[() =&gt; S]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; S<span class="delimiter">]</span>, <a title="=&gt; Option[String]" id="252692">whenDesc</a>: =&gt;Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="Boolean" id="252693">onlyWhen</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> =
    <span title="org.specs2.matcher.TerminationMatcher[Any]" class="keyword">new</span> <a href="#11165" title="org.specs2.matcher.TerminationMatcher[Any]">TerminationMatcher</a><span class="delimiter">(</span><a href="#251820" title="Int">retries</a>, <a href="#251821" title="org.specs2.time.Duration">sleep</a>, <a href="#252691" title="Option[() =&gt; S]">whenAction</a>, <a href="#252692" title="=&gt; Option[String]">whenDesc</a>, <a href="#252693" title="Boolean">onlyWhen</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[S](actionDescription: String, action: =&gt; S)org.specs2.matcher.TerminationMatcher[T]" id="251794">when</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="251796">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="252700">actionDescription</a>: <span title="String">String</span>, <a title="=&gt; S" id="252701">action</a>: =&gt;S<span class="delimiter">)</span>: <a href="#11165" title="org.specs2.matcher.TerminationMatcher[T]">TerminationMatcher</a><span class="delimiter">[</span>T<span class="delimiter">]</span> =
    <a href="#251791" title="(whenAction: Option[() =&gt; S], whenDesc: =&gt; Option[String], onlyWhen: Boolean)org.specs2.matcher.TerminationMatcher[Any]">withAWhenAction</a><span class="delimiter">(</span><span title="(x: () =&gt; S)Some[() =&gt; S]">Some</span><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#252701" title="=&gt; S">action</a><span class="delimiter">)</span>, <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#252700" title="String">actionDescription</a><span class="delimiter">)</span>, onlyWhen=<span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[S](actionDescription: String, action: =&gt; S)org.specs2.matcher.TerminationMatcher[T]" id="251797">onlyWhen</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="251799">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="252164">actionDescription</a>: <span title="String">String</span>, <a title="=&gt; S" id="252165">action</a>: =&gt;S<span class="delimiter">)</span>: <a href="#11165" title="org.specs2.matcher.TerminationMatcher[T]">TerminationMatcher</a><span class="delimiter">[</span>T<span class="delimiter">]</span> =
    <a href="#251791" title="(whenAction: Option[() =&gt; S], whenDesc: =&gt; Option[String], onlyWhen: Boolean)org.specs2.matcher.TerminationMatcher[Any]">withAWhenAction</a><span class="delimiter">(</span><span title="(x: () =&gt; S)Some[() =&gt; S]">Some</span><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#252165" title="=&gt; S">action</a><span class="delimiter">)</span>, <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#252164" title="String">actionDescription</a><span class="delimiter">)</span>, onlyWhen=<span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[S](action: =&gt; S)org.specs2.matcher.TerminationMatcher[T]" id="251800">when</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="251802">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; S" id="252753">action</a>: =&gt;S<span class="delimiter">)</span>: <a href="#11165" title="org.specs2.matcher.TerminationMatcher[T]">TerminationMatcher</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <a href="#251791" title="(whenAction: Option[() =&gt; S], whenDesc: =&gt; Option[String], onlyWhen: Boolean)org.specs2.matcher.TerminationMatcher[Any]">withAWhenAction</a><span class="delimiter">(</span><span title="(x: () =&gt; S)Some[() =&gt; S]">Some</span><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#252753" title="=&gt; S">action</a><span class="delimiter">)</span>, <span title="object None">None</span>, onlyWhen=<span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[S](action: =&gt; S)org.specs2.matcher.TerminationMatcher[T]" id="251803">onlyWhen</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="251805">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; S" id="252161">action</a>: =&gt;S<span class="delimiter">)</span>: <a href="#11165" title="org.specs2.matcher.TerminationMatcher[T]">TerminationMatcher</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <a href="#251791" title="(whenAction: Option[() =&gt; S], whenDesc: =&gt; Option[String], onlyWhen: Boolean)org.specs2.matcher.TerminationMatcher[Any]">withAWhenAction</a><span class="delimiter">(</span><span title="(x: () =&gt; S)Some[() =&gt; S]">Some</span><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#252161" title="=&gt; S">action</a><span class="delimiter">)</span>, <span title="object None">None</span>, onlyWhen=<span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * This trait adds the necessary implicit to write 'action must not terminate'
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">trait</span> <a title="trait TerminationNotMatchers extends java.lang.Object with ScalaObject" id="11167">TerminationNotMatchers</a> <span title="ScalaObject" class="delimiter">{</span> outer: TerminationBaseMatchers =&gt;

   <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](result: org.specs2.matcher.MatchResult[T])TerminationNotMatchers.this.TerminationResultMatcher[T]" id="251764">toTerminationResultMatcher</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="251766">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.matcher.MatchResult[T]" id="252803">result</a>: <a href="MatchResult.scala.html#10872" title="org.specs2.matcher.MatchResult[T]">MatchResult</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="TerminationNotMatchers.this.TerminationResultMatcher[T]" class="keyword">new</span> <a href="#251767" title="TerminationNotMatchers.this.TerminationResultMatcher[T]">TerminationResultMatcher</a><span class="delimiter">(</span><a href="#252803" title="org.specs2.matcher.MatchResult[T]">result</a><span class="delimiter">)</span>

   <span class="keyword">class</span> <a title="class TerminationResultMatcher[T] extends java.lang.Object with ScalaObject" id="251767">TerminationResultMatcher</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="251768">T</a><span class="delimiter">]</span><a href="#251767" title="ScalaObject" class="delimiter">(</a><a title="org.specs2.matcher.MatchResult[T]" id="252812">result</a>: <a href="MatchResult.scala.html#10872" title="org.specs2.matcher.MatchResult[T]">MatchResult</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
     <span class="keyword">def</span> <a title="=&gt; org.specs2.matcher.MatchResult[T]" id="252809">terminate</a> = <a href="MatchResult.scala.html#39721" title="(m: org.specs2.matcher.Matcher[T])org.specs2.matcher.MatchResult[T]">result</a><span class="delimiter">(</span><a href="#11167" title="TerminationNotMatchers.this.type">outer</a>.<a href="#251755" title="org.specs2.matcher.TerminationMatcher[Any]">terminate</a><span class="delimiter">)</span>
     <span class="keyword">def</span> <a title="(retries: Int, sleep: org.specs2.time.Duration)org.specs2.matcher.MatchResult[T]" id="252810">terminate</a><span class="delimiter">(</span><a title="Int" id="252831">retries</a>: <span title="Int">Int</span> = <span title="Int(0)" class="int">0</span>, <a title="org.specs2.time.Duration" id="252832">sleep</a>: <a href="../time/Time.scala.html#13341" title="org.specs2.time.Duration">Duration</a> = <a href="../time/Time.scala.html#52381" title="implicit org.specs2.time.TimeConversions.intToRichLong : (v: Int)org.specs2.time.TimeConversions.RichLong" class="int">100</a>.<a href="../time/Time.scala.html#53738" title="=&gt; org.specs2.time.Duration">millis</a><span class="delimiter">)</span> = <a href="MatchResult.scala.html#39721" title="(m: org.specs2.matcher.Matcher[T])org.specs2.matcher.MatchResult[T]">result</a><span class="delimiter">(</span><a href="#11167" title="TerminationNotMatchers.this.type">outer</a>.<a href="#251758" title="(retries: Int, sleep: org.specs2.time.Duration)org.specs2.matcher.TerminationMatcher[T]">terminate</a><span class="delimiter">(</span><a href="#252831" title="Int">retries</a>, <a href="#252832" title="org.specs2.time.Duration">sleep</a><span class="delimiter">)</span><span class="delimiter">)</span>
   <span class="delimiter">}</span>
<span class="delimiter">}</span>
        </pre>
    </body>
</html>
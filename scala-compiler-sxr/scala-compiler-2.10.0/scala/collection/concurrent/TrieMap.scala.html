<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/collection/concurrent/TrieMap.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2013, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

<span class="keyword">package</span> scala.collection
<span class="keyword">package</span> concurrent

<span class="keyword">import</span> java.util.concurrent.atomic._
<span class="keyword">import</span> scala.collection.immutable.<span class="delimiter">{</span> ListMap =&gt; ImmutableListMap <span class="delimiter">}</span>
<span class="keyword">import</span> scala.collection.parallel.mutable.ParTrieMap
<span class="keyword">import</span> scala.util.hashing.Hashing
<span class="keyword">import</span> scala.util.control.ControlThrowable
<span class="keyword">import</span> generic._
<span class="keyword">import</span> scala.annotation.tailrec
<span class="keyword">import</span> scala.annotation.switch

<span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">class</span> <a title="class INode[K, V] extends scala.collection.concurrent.INodeBase[K,V]" id="10007">INode</a><span class="delimiter">[</span><a title="" id="10084">K</a>, <a title="" id="10085">V</a><span class="delimiter">]</span><a href="#10007" title="scala.collection.concurrent.INode[K,V]" class="delimiter">(</a><a title="scala.collection.concurrent.MainNode[K,V]" id="181415">bn</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.Gen" id="181416">g</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="INodeBase.java.html#10010" title="scala.collection.concurrent.INodeBase[K,V]">INodeBase</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="#181416" title="scala.collection.concurrent.Gen">g</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="INodeBase.java.html#10011" title="scala.collection.concurrent.INodeBase.type">INodeBase</a>._

  <a href="#181387" title="(nval: scala.collection.concurrent.MainNode[K,V])Unit">WRITE</a><span class="delimiter">(</span><a href="#181415" title="scala.collection.concurrent.MainNode[K,V]">bn</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(g: scala.collection.concurrent.Gen)scala.collection.concurrent.INode[K,V]" id="181386" class="keyword">this</a><span class="delimiter">(</span><a title="scala.collection.concurrent.Gen" id="181486">g</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a><span class="delimiter">)</span> = <a href="#10007" title="INode.this.type" class="keyword">this</a><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <a href="#181486" title="scala.collection.concurrent.Gen">g</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(nval: scala.collection.concurrent.MainNode[K,V])Unit" id="181387">WRITE</a><span class="delimiter">(</span><a title="scala.collection.concurrent.MainNode[K,V]" id="181424">nval</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="INodeBase.java.html#10011" title="scala.collection.concurrent.INodeBase.type">INodeBase</a>.<a href="INodeBase.java.html#181421" title="java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.INodeBase[_, _],scala.collection.concurrent.MainNode[_, _]]">updater</a>.<span title="(x$1: scala.collection.concurrent.INodeBase[_, _], x$2: scala.collection.concurrent.MainNode[_, _])Unit">set</span><span class="delimiter">(</span><a href="#10007" title="scala.collection.concurrent.INode[K,V]" class="keyword">this</a>, <a href="#181424" title="scala.collection.concurrent.MainNode[K,V]">nval</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V])Boolean" id="181388">CAS</a><span class="delimiter">(</span><a title="scala.collection.concurrent.MainNode[K,V]" id="181495">old</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.MainNode[K,V]" id="181496">n</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="INodeBase.java.html#10011" title="scala.collection.concurrent.INodeBase.type">INodeBase</a>.<a href="INodeBase.java.html#181421" title="java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.INodeBase[_, _],scala.collection.concurrent.MainNode[_, _]]">updater</a>.<span title="(x$1: scala.collection.concurrent.INodeBase[_, _], x$2: scala.collection.concurrent.MainNode[_, _], x$3: scala.collection.concurrent.MainNode[_, _])Boolean">compareAndSet</span><span class="delimiter">(</span><a href="#10007" title="scala.collection.concurrent.INode[K,V]" class="keyword">this</a>, <a href="#181495" title="scala.collection.concurrent.MainNode[K,V]">old</a>, <a href="#181496" title="scala.collection.concurrent.MainNode[K,V]">n</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]" id="181389">gcasRead</a><span class="delimiter">(</span><a title="scala.collection.concurrent.TrieMap[K,V]" id="181506">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#181506" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]" id="181390">GCAS_READ</a><span class="delimiter">(</span><a title="scala.collection.concurrent.TrieMap[K,V]" id="181569">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="181570">m</a> = /*READ*/<a href="INodeBase.java.html#181376" title="scala.collection.concurrent.MainNode[K,V]">mainnode</a>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="181571">prevval</a> = /*READ*/<a href="#181570" title="scala.collection.concurrent.MainNode[K,V]">m</a>.<a href="MainNode.java.html#181409" title="scala.collection.concurrent.MainNode[K,V]">prev</a>
    <span title="scala.collection.concurrent.MainNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181571" title="scala.collection.concurrent.MainNode[K,V]">prevval</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#181570" title="scala.collection.concurrent.MainNode[K,V]">m</a>
    <span class="keyword">else</span> <a href="#181391" title="(m: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_Complete</a><span class="delimiter">(</span><a href="#181570" title="scala.collection.concurrent.MainNode[K,V]">m</a>, <a href="#181569" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  @tailrec <span class="keyword">private</span> <span class="keyword">def</span> <a title="(m: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]" id="181391">GCAS_Complete</a><span class="delimiter">(</span><a title="scala.collection.concurrent.MainNode[K,V]" id="181574">m</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="181575">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <span title="scala.collection.concurrent.MainNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181574" title="scala.collection.concurrent.MainNode[K,V]">m</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="Null(null)" class="keyword">null</span> <span class="keyword">else</span> <span class="delimiter">{</span>
    // complete the GCAS
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="181576">prev</a> = /*READ*/<a href="#181574" title="scala.collection.concurrent.MainNode[K,V]">m</a>.<a href="MainNode.java.html#181409" title="scala.collection.concurrent.MainNode[K,V]">prev</a>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="181577">ctr</a> = <a href="#181575" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>.<a href="#181535" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">readRoot</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

    <a href="#181576" title="scala.collection.concurrent.MainNode[K,V]">prev</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3267483" title="scala.collection.concurrent.MainNode[K,V]" id="3267488" class="keyword">null</a> =&gt;
        <a href="#3267492" title="(x: scala.collection.concurrent.MainNode[K,V])scala.collection.concurrent.MainNode[K,V]">m</a>
      <span class="keyword">case</span> <a href="#3267483" title="scala.collection.concurrent.MainNode[K,V]" id="3267489">fn</a>: FailedNode<span class="delimiter">[</span>_, _<span class="delimiter">]</span> =&gt; // try to commit to previous value
        <a href="#3267492" title="(x: scala.collection.concurrent.MainNode[K,V])scala.collection.concurrent.MainNode[K,V]" class="keyword">if</a> <span class="delimiter">(</span><a href="#181388" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V])Boolean">CAS</a><span class="delimiter">(</span><a href="#181574" title="scala.collection.concurrent.MainNode[K,V]">m</a>, fn.<a href="MainNode.java.html#181409" title="scala.collection.concurrent.MainNode[_2321,_2322]">prev</a><span class="delimiter">)</span><span class="delimiter">)</span> fn.<a href="MainNode.java.html#181409" title="scala.collection.concurrent.MainNode[_2321,_2322]">prev</a>
        <span class="keyword">else</span> <a href="#181391" title="(m: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_Complete</a><span class="delimiter">(</span>/*READ*/<a href="INodeBase.java.html#181376" title="scala.collection.concurrent.MainNode[K,V]">mainnode</a>, <a href="#181575" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="#3267483" title="scala.collection.concurrent.MainNode[K,V]" id="3267490">vn</a>: MainNode<span class="delimiter">[</span>_, _<span class="delimiter">]</span> =&gt;
        // Assume that you've read the root from the generation G.
        // Assume that the snapshot algorithm is correct.
        // ==&gt; you can only reach nodes in generations &lt;= G.
        // ==&gt; `gen` is &lt;= G.
        // We know that `ctr.gen` is &gt;= G.
        // ==&gt; if `ctr.gen` = `gen` then they are both equal to G.
        // ==&gt; otherwise, we know that either `ctr.gen` &gt; G, `gen` &lt; G,
        //     or both
        <a href="#3267492" title="(x: scala.collection.concurrent.MainNode[K,V])scala.collection.concurrent.MainNode[K,V]" class="keyword">if</a> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#181577" title="scala.collection.concurrent.INode[K,V]">ctr</a>.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#181575" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>.<a href="#181548" title="=&gt; Boolean">nonReadOnly</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          // try to commit
          <span title="scala.collection.concurrent.MainNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181574" title="scala.collection.concurrent.MainNode[K,V]">m</a>.<a href="MainNode.java.html#181411" title="(oldval: scala.collection.concurrent.MainNode[K,V], nval: scala.collection.concurrent.MainNode[K,V])Boolean">CAS_PREV</a><span class="delimiter">(</span><a href="#181576" title="scala.collection.concurrent.MainNode[K,V]">prev</a>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#181574" title="scala.collection.concurrent.MainNode[K,V]">m</a>
          <span class="keyword">else</span> <a href="#181391" title="(m: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_Complete</a><span class="delimiter">(</span><a href="#181574" title="scala.collection.concurrent.MainNode[K,V]">m</a>, <a href="#181575" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          // try to abort
          <a href="#181574" title="scala.collection.concurrent.MainNode[K,V]">m</a>.<a href="MainNode.java.html#181411" title="(oldval: scala.collection.concurrent.MainNode[K,V], nval: scala.collection.concurrent.MainNode[K,V])Boolean">CAS_PREV</a><span class="delimiter">(</span><a href="#181576" title="scala.collection.concurrent.MainNode[K,V]">prev</a>, <span title="scala.collection.concurrent.FailedNode[K,V]" class="keyword">new</span> <a href="#9986" title="scala.collection.concurrent.FailedNode[K,V]">FailedNode</a><span class="delimiter">(</span><a href="#181576" title="scala.collection.concurrent.MainNode[K,V]">prev</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#181391" title="(m: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_Complete</a><span class="delimiter">(</span>/*READ*/<a href="INodeBase.java.html#181376" title="scala.collection.concurrent.MainNode[K,V]">mainnode</a>, <a href="#181575" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean" id="181392">GCAS</a><span class="delimiter">(</span><a title="scala.collection.concurrent.MainNode[K,V]" id="181631">old</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.MainNode[K,V]" id="181632">n</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="181633">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
    <a href="#181632" title="scala.collection.concurrent.MainNode[K,V]">n</a>.<a href="MainNode.java.html#181412" title="(nval: scala.collection.concurrent.MainNode[K,V])Unit">WRITE_PREV</a><span class="delimiter">(</span><a href="#181631" title="scala.collection.concurrent.MainNode[K,V]">old</a><span class="delimiter">)</span>
    <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#181388" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V])Boolean">CAS</a><span class="delimiter">(</span><a href="#181631" title="scala.collection.concurrent.MainNode[K,V]">old</a>, <a href="#181632" title="scala.collection.concurrent.MainNode[K,V]">n</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#181391" title="(m: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_Complete</a><span class="delimiter">(</span><a href="#181632" title="scala.collection.concurrent.MainNode[K,V]">n</a>, <a href="#181633" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
      /*READ*/<a href="#181632" title="scala.collection.concurrent.MainNode[K,V]">n</a>.<a href="MainNode.java.html#181409" title="scala.collection.concurrent.MainNode[K,V]">prev</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(k1: K, k2: K, ct: scala.collection.concurrent.TrieMap[K,V])Boolean" id="181393">equal</a><span class="delimiter">(</span><a title="K" id="181636">k1</a>: <a href="#10084" title="K">K</a>, <a title="K" id="181637">k2</a>: <a href="#10084" title="K">K</a>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="181638">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#181638" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>.<a href="#181526" title="=&gt; Equiv[K]">equality</a>.<a href="../../math/Equiv.scala.html#82147" title="(x: K, y: K)Boolean">equiv</a><span class="delimiter">(</span><a href="#181636" title="K">k1</a>, <a href="#181637" title="K">k2</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(cn: scala.collection.concurrent.MainNode[K,V])scala.collection.concurrent.INode[K,V]" id="181394">inode</a><span class="delimiter">(</span><a title="scala.collection.concurrent.MainNode[K,V]" id="181647">cn</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="181648">nin</a> = <a href="#181386" title="(g: scala.collection.concurrent.Gen)scala.collection.concurrent.INode[K,V]" class="keyword">new</a> <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
    <a href="#181648" title="scala.collection.concurrent.INode[K,V]">nin</a>.<a href="#181387" title="(nval: scala.collection.concurrent.MainNode[K,V])Unit">WRITE</a><span class="delimiter">(</span><a href="#181647" title="scala.collection.concurrent.MainNode[K,V]">cn</a><span class="delimiter">)</span>
    <a href="#181648" title="scala.collection.concurrent.INode[K,V]">nin</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.INode[K,V]" id="181395">copyToGen</a><span class="delimiter">(</span><a title="scala.collection.concurrent.Gen" id="181651">ngen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="181652">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="181653">nin</a> = <a href="#181386" title="(g: scala.collection.concurrent.Gen)scala.collection.concurrent.INode[K,V]" class="keyword">new</a> <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="#181651" title="scala.collection.concurrent.Gen">ngen</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="181654">main</a> = <a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#181652" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
    <a href="#181653" title="scala.collection.concurrent.INode[K,V]">nin</a>.<a href="#181387" title="(nval: scala.collection.concurrent.MainNode[K,V])Unit">WRITE</a><span class="delimiter">(</span><a href="#181654" title="scala.collection.concurrent.MainNode[K,V]">main</a><span class="delimiter">)</span>
    <a href="#181653" title="scala.collection.concurrent.INode[K,V]">nin</a>
  <span class="delimiter">}</span>

  /** Inserts a key value pair, overwriting the old pair if the keys match.
   *
   *  @return        true if successful, false otherwise
   */
  @tailrec <span class="keyword">def</span> <a title="(k: K, v: V, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Boolean" id="181396">rec_insert</a><span class="delimiter">(</span><a title="K" id="181657">k</a>: <a href="#10084" title="K">K</a>, <a title="V" id="181658">v</a>: <a href="#10085" title="V">V</a>, <a title="Int" id="181659">hc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="181660">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.INode[K,V]" id="181661">parent</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.Gen" id="181662">startgen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="181663">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="181664">m</a> = <a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span> // use -Yinline!

    <a href="#181664" title="scala.collection.concurrent.MainNode[K,V]">m</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3267510" title="Boolean" id="3267511">cn</a>: CNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; // 1) a multiway node
        <span class="keyword">val</span> <a title="Int" id="181697">idx</a> = <span class="delimiter">(</span><a href="#181659" title="Int">hc</a> <a href="../../Int.scala.html#57090" title="(x: Int)Int">&gt;&gt;&gt;</a> <a href="#181660" title="Int">lev</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span title="Int(31)" class="int">0x1f</span>
        <span class="keyword">val</span> <a title="Int" id="181698">flag</a> = <span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#57088" title="(x: Int)Int">&lt;&lt;</a> <a href="#181697" title="Int">idx</a>
        <span class="keyword">val</span> <a title="Int" id="181699">bmp</a> = cn.<a href="#181765" title="=&gt; Int">bitmap</a>
        <span class="keyword">val</span> <a title="Int" id="181700">mask</a> = <a href="#181698" title="Int">flag</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
        <span class="keyword">val</span> <a title="Int" id="181701">pos</a> = <span title="Integer.type">Integer</span>.<span title="(x$1: Int)Int">bitCount</span><span class="delimiter">(</span><a href="#181699" title="Int">bmp</a> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <a href="#181700" title="Int">mask</a><span class="delimiter">)</span>
        <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#181699" title="Int">bmp</a> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <a href="#181698" title="Int">flag</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57104" title="(x: Int)Boolean">!=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          // 1a) insert below
          cn.<a href="../../Array.scala.html#56639" title="(i: Int)scala.collection.concurrent.BasicNode">array</a><a href="#3267502" title="scala.collection.concurrent.INode[K,V]" class="delimiter">(</a><a href="#181701" title="Int">pos</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#3267501" title="Boolean" id="3267502">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
              <a href="#3267505" title="(x: Boolean)Boolean" class="keyword">if</a> <span class="delimiter">(</span><a href="#181662" title="scala.collection.concurrent.Gen">startgen</a> <span title="(x$1: AnyRef)Boolean">eq</span> in.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span> in.<a href="#181396" title="(k: K, v: V, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Boolean">rec_insert</a><span class="delimiter">(</span><a href="#181657" title="K">k</a>, <a href="#181658" title="V">v</a>, <a href="#181659" title="Int">hc</a>, <a href="#181660" title="Int">lev</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(5)" class="int">5</span>, <a href="#10007" title="scala.collection.concurrent.INode[K,V]" class="keyword">this</a>, <a href="#181662" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
              <span class="keyword">else</span> <span class="delimiter">{</span>
                <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, cn.<a href="#181687" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.CNode[K,V]">renewed</a><span class="delimiter">(</span><a href="#181662" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#181396" title="(k: K, v: V, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Boolean">rec_insert</a><span class="delimiter">(</span><a href="#181657" title="K">k</a>, <a href="#181658" title="V">v</a>, <a href="#181659" title="Int">hc</a>, <a href="#181660" title="Int">lev</a>, <a href="#181661" title="scala.collection.concurrent.INode[K,V]">parent</a>, <a href="#181662" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
                <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
              <span class="delimiter">}</span>
            <span class="keyword">case</span> <a href="#3267501" title="Boolean" id="3267503">sn</a>: SNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
              <a href="#3267505" title="(x: Boolean)Boolean" class="keyword">if</a> <span class="delimiter">(</span>sn.<a href="#181806" title="=&gt; Int">hc</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#181659" title="Int">hc</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#181393" title="(k1: K, k2: K, ct: scala.collection.concurrent.TrieMap[K,V])Boolean">equal</a><span class="delimiter">(</span>sn.<a href="#181804" title="=&gt; K">k</a>, <a href="#181657" title="K">k</a>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, cn.<a href="#181684" title="(pos: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">updatedAt</a><span class="delimiter">(</span><a href="#181701" title="Int">pos</a>, <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#181657" title="K">k</a>, <a href="#181658" title="V">v</a>, <a href="#181659" title="Int">hc</a><span class="delimiter">)</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
              <span class="keyword">else</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="181813">rn</a> = <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span>cn.<a href="#181767" title="=&gt; scala.collection.concurrent.Gen">gen</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span> cn <span class="keyword">else</span> cn.<a href="#181687" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.CNode[K,V]">renewed</a><span class="delimiter">(</span><a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
                <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="181814">nn</a> = <a href="#181813" title="scala.collection.concurrent.CNode[K,V]">rn</a>.<a href="#181684" title="(pos: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">updatedAt</a><span class="delimiter">(</span><a href="#181701" title="Int">pos</a>, <a href="#181394" title="(cn: scala.collection.concurrent.MainNode[K,V])scala.collection.concurrent.INode[K,V]">inode</a><span class="delimiter">(</span><a href="#10014" title="scala.collection.concurrent.CNode.type">CNode</a>.<a href="#181816" title="(x: scala.collection.concurrent.SNode[K,V], xhc: Int, y: scala.collection.concurrent.SNode[K,V], yhc: Int, lev: Int, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.MainNode[K,V]">dual</a><span class="delimiter">(</span>sn, sn.<a href="#181806" title="=&gt; Int">hc</a>, <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#181657" title="K">k</a>, <a href="#181658" title="V">v</a>, <a href="#181659" title="Int">hc</a><span class="delimiter">)</span>, <a href="#181659" title="Int">hc</a>, <a href="#181660" title="Int">lev</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(5)" class="int">5</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
                <a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, <a href="#181814" title="scala.collection.concurrent.CNode[K,V]">nn</a>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="181859">rn</a> = <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span>cn.<a href="#181767" title="=&gt; scala.collection.concurrent.Gen">gen</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span> cn <span class="keyword">else</span> cn.<a href="#181687" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.CNode[K,V]">renewed</a><span class="delimiter">(</span><a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="181860">ncnode</a> = <a href="#181859" title="scala.collection.concurrent.CNode[K,V]">rn</a>.<a href="#181686" title="(pos: Int, flag: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">insertedAt</a><span class="delimiter">(</span><a href="#181701" title="Int">pos</a>, <a href="#181698" title="Int">flag</a>, <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#181657" title="K">k</a>, <a href="#181658" title="V">v</a>, <a href="#181659" title="Int">hc</a><span class="delimiter">)</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
          <a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, <a href="#181860" title="scala.collection.concurrent.CNode[K,V]">ncnode</a>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#3267510" title="Boolean" id="3267512">tn</a>: TNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
        <a href="#181400" title="(nd: scala.collection.concurrent.INode[K,V], ct: scala.collection.concurrent.TrieMap[K,V], lev: Int)Unit">clean</a><span class="delimiter">(</span><a href="#181661" title="scala.collection.concurrent.INode[K,V]">parent</a>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>, <a href="#181660" title="Int">lev</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(5)" class="int">5</span><span class="delimiter">)</span>
        <span title="Boolean(false)" class="keyword">false</span>
      <span class="keyword">case</span> <a href="#3267510" title="Boolean" id="3267513">ln</a>: LNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; // 3) an l-node
        <span class="keyword">val</span> <a title="scala.collection.concurrent.LNode[K,V]" id="181934">nn</a> = ln.<a href="#181927" title="(k: K, v: V)scala.collection.concurrent.LNode[K,V]">inserted</a><span class="delimiter">(</span><a href="#181657" title="K">k</a>, <a href="#181658" title="V">v</a><span class="delimiter">)</span>
        <a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>ln, <a href="#181934" title="scala.collection.concurrent.LNode[K,V]">nn</a>, <a href="#181663" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Inserts a new key value pair, given that a specific condition is met.
   *
   *  @param cond        null - don't care if the key was there; KEY_ABSENT - key wasn't there; KEY_PRESENT - key was there; other value `v` - key must be bound to `v`
   *  @return            null if unsuccessful, Option[V] otherwise (indicating previous value bound to the key)
   */
  @tailrec <span class="keyword">def</span> <a title="(k: K, v: V, hc: Int, cond: AnyRef, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Option[V]" id="181397">rec_insertif</a><span class="delimiter">(</span><a title="K" id="182397">k</a>: <a href="#10084" title="K">K</a>, <a title="V" id="182398">v</a>: <a href="#10085" title="V">V</a>, <a title="Int" id="182399">hc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="AnyRef" id="182400">cond</a>: <span title="AnyRef">AnyRef</span>, <a title="Int" id="182401">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.INode[K,V]" id="182402">parent</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.Gen" id="182403">startgen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="182404">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Option.scala.html#978" title="Option[V]">Option</a><span class="delimiter">[</span>V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182405">m</a> = <a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>  // use -Yinline!

    <a href="#182405" title="scala.collection.concurrent.MainNode[K,V]">m</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3267654" title="Option[V]" id="3267655">cn</a>: CNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; // 1) a multiway node
        <span class="keyword">val</span> <a title="Int" id="182409">idx</a> = <span class="delimiter">(</span><a href="#182399" title="Int">hc</a> <a href="../../Int.scala.html#57090" title="(x: Int)Int">&gt;&gt;&gt;</a> <a href="#182401" title="Int">lev</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span title="Int(31)" class="int">0x1f</span>
        <span class="keyword">val</span> <a title="Int" id="182410">flag</a> = <span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#57088" title="(x: Int)Int">&lt;&lt;</a> <a href="#182409" title="Int">idx</a>
        <span class="keyword">val</span> <a title="Int" id="182411">bmp</a> = cn.<a href="#181765" title="=&gt; Int">bitmap</a>
        <span class="keyword">val</span> <a title="Int" id="182412">mask</a> = <a href="#182410" title="Int">flag</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
        <span class="keyword">val</span> <a title="Int" id="182413">pos</a> = <span title="Integer.type">Integer</span>.<span title="(x$1: Int)Int">bitCount</span><span class="delimiter">(</span><a href="#182411" title="Int">bmp</a> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <a href="#182412" title="Int">mask</a><span class="delimiter">)</span>
        <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#182411" title="Int">bmp</a> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <a href="#182410" title="Int">flag</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57104" title="(x: Int)Boolean">!=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          // 1a) insert below
          cn.<a href="../../Array.scala.html#56639" title="(i: Int)scala.collection.concurrent.BasicNode">array</a><a href="#3267551" title="scala.collection.concurrent.INode[K,V]" class="delimiter">(</a><a href="#182413" title="Int">pos</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#3267550" title="Option[V]" id="3267551">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
              <a href="#3267554" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span><a href="#182403" title="scala.collection.concurrent.Gen">startgen</a> <span title="(x$1: AnyRef)Boolean">eq</span> in.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span> in.<a href="#181397" title="(k: K, v: V, hc: Int, cond: AnyRef, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Option[V]">rec_insertif</a><span class="delimiter">(</span><a href="#182397" title="K">k</a>, <a href="#182398" title="V">v</a>, <a href="#182399" title="Int">hc</a>, <a href="#182400" title="AnyRef">cond</a>, <a href="#182401" title="Int">lev</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(5)" class="int">5</span>, <a href="#10007" title="scala.collection.concurrent.INode[K,V]" class="keyword">this</a>, <a href="#182403" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
              <span class="keyword">else</span> <span class="delimiter">{</span>
                <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, cn.<a href="#181687" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.CNode[K,V]">renewed</a><span class="delimiter">(</span><a href="#182403" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#181397" title="(k: K, v: V, hc: Int, cond: AnyRef, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Option[V]">rec_insertif</a><span class="delimiter">(</span><a href="#182397" title="K">k</a>, <a href="#182398" title="V">v</a>, <a href="#182399" title="Int">hc</a>, <a href="#182400" title="AnyRef">cond</a>, <a href="#182401" title="Int">lev</a>, <a href="#182402" title="scala.collection.concurrent.INode[K,V]">parent</a>, <a href="#182403" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
                <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
              <span class="delimiter">}</span>
            <span class="keyword">case</span> <a href="#3267550" title="Option[V]" id="3267552">sn</a>: SNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="#3267554" title="(x: Option[V])Option[V]">cond</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="#3267521" title="Option[V]" id="3267528" class="keyword">null</a> =&gt;
                <a href="#3267534" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span>sn.<a href="#181806" title="=&gt; Int">hc</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#182399" title="Int">hc</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#181393" title="(k1: K, k2: K, ct: scala.collection.concurrent.TrieMap[K,V])Boolean">equal</a><span class="delimiter">(</span>sn.<a href="#181804" title="=&gt; K">k</a>, <a href="#182397" title="K">k</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, cn.<a href="#181684" title="(pos: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">updatedAt</a><span class="delimiter">(</span><a href="#182413" title="Int">pos</a>, <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#182397" title="K">k</a>, <a href="#182398" title="V">v</a>, <a href="#182399" title="Int">hc</a><span class="delimiter">)</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#63128" title="(x: V)Some[V]">Some</a><span class="delimiter">(</span>sn.<a href="#181805" title="=&gt; V">v</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                  <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="182472">rn</a> = <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span>cn.<a href="#181767" title="=&gt; scala.collection.concurrent.Gen">gen</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span> cn <span class="keyword">else</span> cn.<a href="#181687" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.CNode[K,V]">renewed</a><span class="delimiter">(</span><a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
                  <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="182473">nn</a> = <a href="#182472" title="scala.collection.concurrent.CNode[K,V]">rn</a>.<a href="#181684" title="(pos: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">updatedAt</a><span class="delimiter">(</span><a href="#182413" title="Int">pos</a>, <a href="#181394" title="(cn: scala.collection.concurrent.MainNode[K,V])scala.collection.concurrent.INode[K,V]">inode</a><span class="delimiter">(</span><a href="#10014" title="scala.collection.concurrent.CNode.type">CNode</a>.<a href="#181816" title="(x: scala.collection.concurrent.SNode[K,V], xhc: Int, y: scala.collection.concurrent.SNode[K,V], yhc: Int, lev: Int, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.MainNode[K,V]">dual</a><span class="delimiter">(</span>sn, sn.<a href="#181806" title="=&gt; Int">hc</a>, <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#182397" title="K">k</a>, <a href="#182398" title="V">v</a>, <a href="#182399" title="Int">hc</a><span class="delimiter">)</span>, <a href="#182399" title="Int">hc</a>, <a href="#182401" title="Int">lev</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(5)" class="int">5</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
                  <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, <a href="#182473" title="scala.collection.concurrent.CNode[K,V]">nn</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#1585" title="None.type">None</a>
                  <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
                <span class="delimiter">}</span>
              <span class="keyword">case</span> <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182503" title="Option[V]" id="3267529">KEY_ABSENT</a> =&gt;
                <a href="#3267534" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span>sn.<a href="#181806" title="=&gt; Int">hc</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#182399" title="Int">hc</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#181393" title="(k1: K, k2: K, ct: scala.collection.concurrent.TrieMap[K,V])Boolean">equal</a><span class="delimiter">(</span>sn.<a href="#181804" title="=&gt; K">k</a>, <a href="#182397" title="K">k</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#63128" title="(x: V)Some[V]">Some</a><span class="delimiter">(</span>sn.<a href="#181805" title="=&gt; V">v</a><span class="delimiter">)</span>
                <span class="keyword">else</span> <span class="delimiter">{</span>
                  <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="182517">rn</a> = <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span>cn.<a href="#181767" title="=&gt; scala.collection.concurrent.Gen">gen</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span> cn <span class="keyword">else</span> cn.<a href="#181687" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.CNode[K,V]">renewed</a><span class="delimiter">(</span><a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
                  <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="182518">nn</a> = <a href="#182517" title="scala.collection.concurrent.CNode[K,V]">rn</a>.<a href="#181684" title="(pos: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">updatedAt</a><span class="delimiter">(</span><a href="#182413" title="Int">pos</a>, <a href="#181394" title="(cn: scala.collection.concurrent.MainNode[K,V])scala.collection.concurrent.INode[K,V]">inode</a><span class="delimiter">(</span><a href="#10014" title="scala.collection.concurrent.CNode.type">CNode</a>.<a href="#181816" title="(x: scala.collection.concurrent.SNode[K,V], xhc: Int, y: scala.collection.concurrent.SNode[K,V], yhc: Int, lev: Int, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.MainNode[K,V]">dual</a><span class="delimiter">(</span>sn, sn.<a href="#181806" title="=&gt; Int">hc</a>, <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#182397" title="K">k</a>, <a href="#182398" title="V">v</a>, <a href="#182399" title="Int">hc</a><span class="delimiter">)</span>, <a href="#182399" title="Int">hc</a>, <a href="#182401" title="Int">lev</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(5)" class="int">5</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
                  <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, <a href="#182518" title="scala.collection.concurrent.CNode[K,V]">nn</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#1585" title="None.type">None</a>
                  <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
                <span class="delimiter">}</span>
              <span class="keyword">case</span> <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182501" title="Option[V]" id="3267530">KEY_PRESENT</a> =&gt;
                <a href="#3267534" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span>sn.<a href="#181806" title="=&gt; Int">hc</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#182399" title="Int">hc</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#181393" title="(k1: K, k2: K, ct: scala.collection.concurrent.TrieMap[K,V])Boolean">equal</a><span class="delimiter">(</span>sn.<a href="#181804" title="=&gt; K">k</a>, <a href="#182397" title="K">k</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, cn.<a href="#181684" title="(pos: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">updatedAt</a><span class="delimiter">(</span><a href="#182413" title="Int">pos</a>, <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#182397" title="K">k</a>, <a href="#182398" title="V">v</a>, <a href="#182399" title="Int">hc</a><span class="delimiter">)</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#63128" title="(x: V)Some[V]">Some</a><span class="delimiter">(</span>sn.<a href="#181805" title="=&gt; V">v</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <a href="../../Option.scala.html#1585" title="None.type">None</a>
              <span class="keyword">case</span> otherv =&gt;
                <a href="#3267534" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span>sn.<a href="#181806" title="=&gt; Int">hc</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#182399" title="Int">hc</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#181393" title="(k1: K, k2: K, ct: scala.collection.concurrent.TrieMap[K,V])Boolean">equal</a><span class="delimiter">(</span>sn.<a href="#181804" title="=&gt; K">k</a>, <a href="#182397" title="K">k</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> sn.<a href="#181805" title="=&gt; V">v</a> <span title="(x$1: Any)Boolean">==</span> otherv<span class="delimiter">)</span> <span class="delimiter">{</span>
                  <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, cn.<a href="#181684" title="(pos: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">updatedAt</a><span class="delimiter">(</span><a href="#182413" title="Int">pos</a>, <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#182397" title="K">k</a>, <a href="#182398" title="V">v</a>, <a href="#182399" title="Int">hc</a><span class="delimiter">)</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#63128" title="(x: V)Some[V]">Some</a><span class="delimiter">(</span>sn.<a href="#181805" title="=&gt; V">v</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <a href="../../Option.scala.html#1585" title="None.type">None</a>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#182400" title="AnyRef">cond</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#3267559" title="Option[V]" id="3267566" class="keyword">null</a> | <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182503" title="Boolean" id="3267567">KEY_ABSENT</a> =&gt;
            <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="182576">rn</a> = <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span>cn.<a href="#181767" title="=&gt; scala.collection.concurrent.Gen">gen</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span> cn <span class="keyword">else</span> cn.<a href="#181687" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.CNode[K,V]">renewed</a><span class="delimiter">(</span><a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="182577">ncnode</a> = <a href="#182576" title="scala.collection.concurrent.CNode[K,V]">rn</a>.<a href="#181686" title="(pos: Int, flag: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">insertedAt</a><span class="delimiter">(</span><a href="#182413" title="Int">pos</a>, <a href="#182410" title="Int">flag</a>, <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#182397" title="K">k</a>, <a href="#182398" title="V">v</a>, <a href="#182399" title="Int">hc</a><span class="delimiter">)</span>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
            <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, <a href="#182577" title="scala.collection.concurrent.CNode[K,V]">ncnode</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#1585" title="None.type">None</a> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">case</span> <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182501" title="Option[V]" id="3267568">KEY_PRESENT</a> =&gt; <a href="#3267572" title="(x: Option[V])Option[V]">None</a>
          <span class="keyword">case</span> otherv =&gt; <a href="#3267572" title="(x: Option[V])Option[V]">None</a>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#3267654" title="Option[V]" id="3267656">sn</a>: TNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
        <a href="#181400" title="(nd: scala.collection.concurrent.INode[K,V], ct: scala.collection.concurrent.TrieMap[K,V], lev: Int)Unit">clean</a><span class="delimiter">(</span><a href="#182402" title="scala.collection.concurrent.INode[K,V]">parent</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>, <a href="#182401" title="Int">lev</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(5)" class="int">5</span><span class="delimiter">)</span>
        <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">case</span> <a href="#3267654" title="Option[V]" id="3267657">ln</a>: LNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; // 3) an l-node
        <span class="keyword">def</span> <a title="()Boolean" id="182597">insertln</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="scala.collection.concurrent.LNode[K,V]" id="182598">nn</a> = ln.<a href="#181927" title="(k: K, v: V)scala.collection.concurrent.LNode[K,V]">inserted</a><span class="delimiter">(</span><a href="#182397" title="K">k</a>, <a href="#182398" title="V">v</a><span class="delimiter">)</span>
          <a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>ln, <a href="#182598" title="scala.collection.concurrent.LNode[K,V]">nn</a>, <a href="#182404" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#182400" title="AnyRef">cond</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#3267625" title="Option[V]" id="3267632" class="keyword">null</a> =&gt;
            <span class="keyword">val</span> <a title="Option[V]" id="182601">optv</a> = ln.<a href="#181929" title="(k: K)Option[V]">get</a><span class="delimiter">(</span><a href="#182397" title="K">k</a><span class="delimiter">)</span>
            <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#182597" title="()Boolean">insertln</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#182601" title="Option[V]">optv</a> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">case</span> <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182503" title="Option[V]" id="3267633">KEY_ABSENT</a> =&gt;
            ln.<a href="#181929" title="(k: K)Option[V]">get</a><a href="#3267638" title="(x: Option[V])Option[V]" class="delimiter">(</a><a href="#182397" title="K">k</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../../Option.scala.html#1585" title="Option[V]" id="3267594">None</a> =&gt; <a href="#3267596" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span><a href="#182597" title="()Boolean">insertln</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#1585" title="None.type">None</a> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
              <span class="keyword">case</span> optv =&gt; <a href="#3267596" title="(x: Option[V])Option[V]">optv</a>
            <span class="delimiter">}</span>
          <span class="keyword">case</span> <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182501" title="Option[V]" id="3267634">KEY_PRESENT</a> =&gt;
            ln.<a href="#181929" title="(k: K)Option[V]">get</a><a href="#3267638" title="(x: Option[V])Option[V]" class="delimiter">(</a><a href="#182397" title="K">k</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#3267604" title="Option[V]" id="3267605" class="delimiter">(</a><a href="../../Option.scala.html#63132" title="V" id="182614">v0</a><span class="delimiter">)</span> =&gt; <a href="#3267609" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span><a href="#182597" title="()Boolean">insertln</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#63128" title="(x: V)Some[V]">Some</a><span class="delimiter">(</span><a href="#182614" title="V">v0</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
              <span class="keyword">case</span> <a href="../../Option.scala.html#1585" title="Option[V]" id="3267607">None</a> =&gt; <a href="#3267609" title="(x: Option[V])Option[V]">None</a>
            <span class="delimiter">}</span>
          <span class="keyword">case</span> otherv =&gt;
            ln.<a href="#181929" title="(k: K)Option[V]">get</a><a href="#3267638" title="(x: Option[V])Option[V]" class="delimiter">(</a><a href="#182397" title="K">k</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#3267617" title="Option[V]" id="3267618" class="delimiter">(</a><a href="../../Option.scala.html#63132" title="V" id="182620">v0</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#182620" title="V">v0</a> <span title="(x$1: Any)Boolean">==</span> otherv =&gt; <a href="#3267620" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span><a href="#182597" title="()Boolean">insertln</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#63128" title="(x: V)Some[V]">Some</a><span class="delimiter">(</span>otherv.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="V" class="delimiter">[</span><a href="#10085" title="V">V</a><span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
              <span class="keyword">case</span> _ =&gt; <a href="#3267620" title="(x: Option[V])Option[V]">None</a>
            <span class="delimiter">}</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Looks up the value associated with the key.
   *
   *  @return          null if no value has been found, RESTART if the operation wasn't successful, or any other value otherwise
   */
  @tailrec <span class="keyword">def</span> <a title="(k: K, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])AnyRef" id="181398">rec_lookup</a><span class="delimiter">(</span><a title="K" id="182624">k</a>: <a href="#10084" title="K">K</a>, <a title="Int" id="182625">hc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="182626">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.INode[K,V]" id="182627">parent</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.Gen" id="182628">startgen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="182629">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182630">m</a> = <a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#182629" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span> // use -Yinline!

    <a href="#182630" title="scala.collection.concurrent.MainNode[K,V]">m</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3267674" title="AnyRef" id="3267675">cn</a>: CNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; // 1) a multinode
        <span class="keyword">val</span> <a title="Int" id="182634">idx</a> = <span class="delimiter">(</span><a href="#182625" title="Int">hc</a> <a href="../../Int.scala.html#57090" title="(x: Int)Int">&gt;&gt;&gt;</a> <a href="#182626" title="Int">lev</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span title="Int(31)" class="int">0x1f</span>
        <span class="keyword">val</span> <a title="Int" id="182635">flag</a> = <span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#57088" title="(x: Int)Int">&lt;&lt;</a> <a href="#182634" title="Int">idx</a>
        <span class="keyword">val</span> <a title="Int" id="182636">bmp</a> = cn.<a href="#181765" title="=&gt; Int">bitmap</a>
        <span title="AnyRef" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#182636" title="Int">bmp</a> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <a href="#182635" title="Int">flag</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="Null(null)" class="keyword">null</span> // 1a) bitmap shows no binding
        <span class="keyword">else</span> <span class="delimiter">{</span> // 1b) bitmap contains a value - descend
          <span class="keyword">val</span> <a title="Int" id="182658">pos</a> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#182636" title="Int">bmp</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(-1)" class="int">0xffffffff</span><span class="delimiter">)</span> <a href="#182634" title="Int">idx</a> <span class="keyword">else</span> <span title="Integer.type">Integer</span>.<span title="(x$1: Int)Int">bitCount</span><span class="delimiter">(</span><a href="#182636" title="Int">bmp</a> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span class="delimiter">(</span><a href="#182635" title="Int">flag</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="scala.collection.concurrent.BasicNode" id="182659">sub</a> = cn.<a href="../../Array.scala.html#56639" title="(i: Int)scala.collection.concurrent.BasicNode">array</a><span class="delimiter">(</span><a href="#182658" title="Int">pos</a><span class="delimiter">)</span>
          <a href="#182659" title="scala.collection.concurrent.BasicNode">sub</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#3267665" title="AnyRef" id="3267666">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
              <a href="#3267669" title="(x: AnyRef)AnyRef" class="keyword">if</a> <span class="delimiter">(</span><a href="#182629" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>.<a href="#181547" title="=&gt; Boolean">isReadOnly</a> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#182628" title="scala.collection.concurrent.Gen">startgen</a> <span title="(x$1: AnyRef)Boolean">eq</span> in.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span><span class="delimiter">)</span> in.<a href="#181398" title="(k: K, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])AnyRef">rec_lookup</a><span class="delimiter">(</span><a href="#182624" title="K">k</a>, <a href="#182625" title="Int">hc</a>, <a href="#182626" title="Int">lev</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(5)" class="int">5</span>, <a href="#10007" title="scala.collection.concurrent.INode[K,V]" class="keyword">this</a>, <a href="#182628" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#182629" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
              <span class="keyword">else</span> <span class="delimiter">{</span>
                <span title="AnyRef" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, cn.<a href="#181687" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.CNode[K,V]">renewed</a><span class="delimiter">(</span><a href="#182628" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#182629" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>, <a href="#182629" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#181398" title="(k: K, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])AnyRef">rec_lookup</a><span class="delimiter">(</span><a href="#182624" title="K">k</a>, <a href="#182625" title="Int">hc</a>, <a href="#182626" title="Int">lev</a>, <a href="#182627" title="scala.collection.concurrent.INode[K,V]">parent</a>, <a href="#182628" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#182629" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
                <span class="keyword">else</span> <span title="Nothing" class="keyword">return</span> <a href="INodeBase.java.html#181422" title="Object">RESTART</a> // used to be throw RestartException
              <span class="delimiter">}</span>
            <span class="keyword">case</span> <a href="#3267665" title="AnyRef" id="3267667">sn</a>: SNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; // 2) singleton node
              <a href="#3267669" title="(x: AnyRef)AnyRef" class="keyword">if</a> <span class="delimiter">(</span>sn.<a href="#181806" title="=&gt; Int">hc</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#182625" title="Int">hc</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#181393" title="(k1: K, k2: K, ct: scala.collection.concurrent.TrieMap[K,V])Boolean">equal</a><span class="delimiter">(</span>sn.<a href="#181804" title="=&gt; K">k</a>, <a href="#182624" title="K">k</a>, <a href="#182629" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> sn.<a href="#181805" title="=&gt; V">v</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
              <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#3267674" title="AnyRef" id="3267676">tn</a>: TNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; // 3) non-live node
        <span class="keyword">def</span> <a title="(tn: scala.collection.concurrent.TNode[K,V])Object" id="182696">cleanReadOnly</a><span class="delimiter">(</span><a title="scala.collection.concurrent.TNode[K,V]" id="182697">tn</a>: <a href="#10031" title="scala.collection.concurrent.TNode[K,V]">TNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="Object" class="keyword">if</span> <span class="delimiter">(</span><a href="#182629" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>.<a href="#181548" title="=&gt; Boolean">nonReadOnly</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#181400" title="(nd: scala.collection.concurrent.INode[K,V], ct: scala.collection.concurrent.TrieMap[K,V], lev: Int)Unit">clean</a><span class="delimiter">(</span><a href="#182627" title="scala.collection.concurrent.INode[K,V]">parent</a>, <a href="#182629" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>, <a href="#182626" title="Int">lev</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(5)" class="int">5</span><span class="delimiter">)</span>
          <a href="INodeBase.java.html#181422" title="Object">RESTART</a> // used to be throw RestartException
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span title="AnyRef" class="keyword">if</span> <span class="delimiter">(</span><a href="#182697" title="scala.collection.concurrent.TNode[K,V]">tn</a>.<a href="#183075" title="=&gt; Int">hc</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#182625" title="Int">hc</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#182697" title="scala.collection.concurrent.TNode[K,V]">tn</a>.<a href="#183073" title="=&gt; K">k</a> <span title="(x$1: Any)Boolean">==</span> <a href="#182624" title="K">k</a><span class="delimiter">)</span> <a href="#182697" title="scala.collection.concurrent.TNode[K,V]">tn</a>.<a href="#183074" title="=&gt; V">v</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
          <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
        <span class="delimiter">}</span>
        <a href="#182696" title="(tn: scala.collection.concurrent.TNode[K,V])Object">cleanReadOnly</a><span class="delimiter">(</span>tn<span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="#3267674" title="AnyRef" id="3267677">ln</a>: LNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; // 5) an l-node
        ln.<a href="#181929" title="(k: K)Option[V]">get</a><span class="delimiter">(</span><a href="#182624" title="K">k</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Option[AnyRef]" class="delimiter">[</span><a href="../../Option.scala.html#978" title="Option[AnyRef]">Option</a><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">]</span>.<a href="#3267679" title="(x: AnyRef)AnyRef">orNull</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Removes the key associated with the given value.
   *
   *  @param v         if null, will remove the key irregardless of the value; otherwise removes only if binding contains that exact key and value
   *  @return          null if not successful, an Option[V] indicating the previous value otherwise
   */
  <span class="keyword">def</span> <a title="(k: K, v: V, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Option[V]" id="181399">rec_remove</a><span class="delimiter">(</span><a title="K" id="182717">k</a>: <a href="#10084" title="K">K</a>, <a title="V" id="182718">v</a>: <a href="#10085" title="V">V</a>, <a title="Int" id="182719">hc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="182720">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.INode[K,V]" id="182721">parent</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.Gen" id="182722">startgen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="182723">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Option.scala.html#978" title="Option[V]">Option</a><span class="delimiter">[</span>V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182724">m</a> = <a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span> // use -Yinline!

    <a href="#182724" title="scala.collection.concurrent.MainNode[K,V]">m</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3267717" title="Option[V]" id="3267718">cn</a>: CNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
        <span class="keyword">val</span> <a title="Int" id="182728">idx</a> = <span class="delimiter">(</span><a href="#182719" title="Int">hc</a> <a href="../../Int.scala.html#57090" title="(x: Int)Int">&gt;&gt;&gt;</a> <a href="#182720" title="Int">lev</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span title="Int(31)" class="int">0x1f</span>
        <span class="keyword">val</span> <a title="Int" id="182729">bmp</a> = cn.<a href="#181765" title="=&gt; Int">bitmap</a>
        <span class="keyword">val</span> <a title="Int" id="182730">flag</a> = <span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#57088" title="(x: Int)Int">&lt;&lt;</a> <a href="#182728" title="Int">idx</a>
        <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#182729" title="Int">bmp</a> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <a href="#182730" title="Int">flag</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="../../Option.scala.html#1585" title="None.type">None</a>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Int" id="182752">pos</a> = <span title="Integer.type">Integer</span>.<span title="(x$1: Int)Int">bitCount</span><span class="delimiter">(</span><a href="#182729" title="Int">bmp</a> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span class="delimiter">(</span><a href="#182730" title="Int">flag</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="scala.collection.concurrent.BasicNode" id="182753">sub</a> = cn.<a href="../../Array.scala.html#56639" title="(i: Int)scala.collection.concurrent.BasicNode">array</a><span class="delimiter">(</span><a href="#182752" title="Int">pos</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Option[V]" id="182754">res</a> = <a href="#182753" title="scala.collection.concurrent.BasicNode">sub</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#3267685" title="Option[V]" id="3267686">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
              <a href="#3267689" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span><a href="#182722" title="scala.collection.concurrent.Gen">startgen</a> <span title="(x$1: AnyRef)Boolean">eq</span> in.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span> in.<a href="#181399" title="(k: K, v: V, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Option[V]">rec_remove</a><span class="delimiter">(</span><a href="#182717" title="K">k</a>, <a href="#182718" title="V">v</a>, <a href="#182719" title="Int">hc</a>, <a href="#182720" title="Int">lev</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(5)" class="int">5</span>, <a href="#10007" title="scala.collection.concurrent.INode[K,V]" class="keyword">this</a>, <a href="#182722" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
              <span class="keyword">else</span> <span class="delimiter">{</span>
                <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, cn.<a href="#181687" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.CNode[K,V]">renewed</a><span class="delimiter">(</span><a href="#182722" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#181399" title="(k: K, v: V, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Option[V]">rec_remove</a><span class="delimiter">(</span><a href="#182717" title="K">k</a>, <a href="#182718" title="V">v</a>, <a href="#182719" title="Int">hc</a>, <a href="#182720" title="Int">lev</a>, <a href="#182721" title="scala.collection.concurrent.INode[K,V]">parent</a>, <a href="#182722" title="scala.collection.concurrent.Gen">startgen</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
                <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
              <span class="delimiter">}</span>
            <span class="keyword">case</span> <a href="#3267685" title="Option[V]" id="3267687">sn</a>: SNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
              <a href="#3267689" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span>sn.<a href="#181806" title="=&gt; Int">hc</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#182719" title="Int">hc</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#181393" title="(k1: K, k2: K, ct: scala.collection.concurrent.TrieMap[K,V])Boolean">equal</a><span class="delimiter">(</span>sn.<a href="#181804" title="=&gt; K">k</a>, <a href="#182717" title="K">k</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#182718" title="V">v</a> <span title="(x$1: Any)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> sn.<a href="#181805" title="=&gt; V">v</a> <span title="(x$1: Any)Boolean">==</span> <a href="#182718" title="V">v</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182781">ncn</a> = cn.<a href="#181685" title="(pos: Int, flag: Int, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">removedAt</a><span class="delimiter">(</span><a href="#182752" title="Int">pos</a>, <a href="#182730" title="Int">flag</a>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>.<a href="#181689" title="(lev: Int)scala.collection.concurrent.MainNode[K,V]">toContracted</a><span class="delimiter">(</span><a href="#182720" title="Int">lev</a><span class="delimiter">)</span>
                <span title="Some[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, <a href="#182781" title="scala.collection.concurrent.MainNode[K,V]">ncn</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#63128" title="(x: V)Some[V]">Some</a><span class="delimiter">(</span>sn.<a href="#181805" title="=&gt; V">v</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
              <span class="delimiter">}</span> <span class="keyword">else</span> <a href="../../Option.scala.html#1585" title="None.type">None</a>
          <span class="delimiter">}</span>

          <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#182754" title="Option[V]">res</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../Option.scala.html#1585" title="None.type">None</a> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#182754" title="Option[V]">res</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#182754" title="Option[V]">res</a>
          <span class="keyword">else</span> <span class="delimiter">{</span>
            @tailrec <span class="keyword">def</span> <a title="(nonlive: AnyRef)Unit" id="182826">cleanParent</a><span class="delimiter">(</span><a title="AnyRef" id="182827">nonlive</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182828">pm</a> = <a href="#182721" title="scala.collection.concurrent.INode[K,V]">parent</a>.<a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
              <a href="#182828" title="scala.collection.concurrent.MainNode[K,V]">pm</a> <span class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <a href="#3267701" title="Unit" id="3267702">cn</a>: CNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
                  <span class="keyword">val</span> <a title="Int" id="182832">idx</a> = <span class="delimiter">(</span><a href="#182719" title="Int">hc</a> <a href="../../Int.scala.html#57090" title="(x: Int)Int">&gt;&gt;&gt;</a> <span class="delimiter">(</span><a href="#182720" title="Int">lev</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(5)" class="int">5</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span title="Int(31)" class="int">0x1f</span>
                  <span class="keyword">val</span> <a title="Int" id="182833">bmp</a> = cn.<a href="#181765" title="=&gt; Int">bitmap</a>
                  <span class="keyword">val</span> <a title="Int" id="182834">flag</a> = <span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#57088" title="(x: Int)Int">&lt;&lt;</a> <a href="#182832" title="Int">idx</a>
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#182833" title="Int">bmp</a> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <a href="#182834" title="Int">flag</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span> // somebody already removed this i-node, we're done
                  <span class="keyword">else</span> <span class="delimiter">{</span>
                    <span class="keyword">val</span> <a title="Int" id="182860">pos</a> = <span title="Integer.type">Integer</span>.<span title="(x$1: Int)Int">bitCount</span><span class="delimiter">(</span><a href="#182833" title="Int">bmp</a> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span class="delimiter">(</span><a href="#182834" title="Int">flag</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
                    <span class="keyword">val</span> <a title="scala.collection.concurrent.BasicNode" id="182861">sub</a> = cn.<a href="../../Array.scala.html#56639" title="(i: Int)scala.collection.concurrent.BasicNode">array</a><span class="delimiter">(</span><a href="#182860" title="Int">pos</a><span class="delimiter">)</span>
                    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#182861" title="scala.collection.concurrent.BasicNode">sub</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#10007" title="scala.collection.concurrent.INode[K,V]" class="keyword">this</a><span class="delimiter">)</span> <a href="#182827" title="AnyRef">nonlive</a> <span class="keyword">match</span> <span class="delimiter">{</span>
                      <span class="keyword">case</span> <a href="#3267694" title="Unit" id="3267695">tn</a>: TNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
                        <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182875">ncn</a> = cn.<a href="#181684" title="(pos: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]">updatedAt</a><span class="delimiter">(</span><a href="#182860" title="Int">pos</a>, tn.<a href="#181907" title="=&gt; scala.collection.concurrent.SNode[K,V]">copyUntombed</a>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>.<a href="#181689" title="(lev: Int)scala.collection.concurrent.MainNode[K,V]">toContracted</a><span class="delimiter">(</span><a href="#182720" title="Int">lev</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(5)" class="int">5</span><span class="delimiter">)</span>
                        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#182721" title="scala.collection.concurrent.INode[K,V]">parent</a>.<a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>cn, <a href="#182875" title="scala.collection.concurrent.MainNode[K,V]">ncn</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span>
                          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>.<a href="#181535" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">readRoot</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#182722" title="scala.collection.concurrent.Gen">startgen</a><span class="delimiter">)</span> <a href="#182826" title="(nonlive: AnyRef)Unit">cleanParent</a><span class="delimiter">(</span><a href="#182827" title="AnyRef">nonlive</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span>
                  <span class="delimiter">}</span>
                <span class="keyword">case</span> _ =&gt; // parent is no longer a cnode, we're done
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>

            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#182721" title="scala.collection.concurrent.INode[K,V]">parent</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span> // never tomb at root
              <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182898">n</a> = <a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#182898" title="scala.collection.concurrent.MainNode[K,V]">n</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="#10031" title="scala.collection.concurrent.TNode[_, _]">TNode</a><span class="delimiter">[</span>_, _<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
                <a href="#182826" title="(nonlive: AnyRef)Unit">cleanParent</a><span class="delimiter">(</span><a href="#182898" title="scala.collection.concurrent.MainNode[K,V]">n</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

            <a href="#182754" title="Option[V]">res</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#3267717" title="Option[V]" id="3267719">tn</a>: TNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
        <a href="#181400" title="(nd: scala.collection.concurrent.INode[K,V], ct: scala.collection.concurrent.TrieMap[K,V], lev: Int)Unit">clean</a><span class="delimiter">(</span><a href="#182721" title="scala.collection.concurrent.INode[K,V]">parent</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>, <a href="#182720" title="Int">lev</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(5)" class="int">5</span><span class="delimiter">)</span>
        <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">case</span> <a href="#3267717" title="Option[V]" id="3267720">ln</a>: LNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
        <a href="#3267722" title="(x: Option[V])Option[V]" class="keyword">if</a> <span class="delimiter">(</span><a href="#182718" title="V">v</a> <span title="(x$1: Any)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Option[V]" id="182919">optv</a> = ln.<a href="#181929" title="(k: K)Option[V]">get</a><span class="delimiter">(</span><a href="#182717" title="K">k</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182920">nn</a> = ln.<a href="#181928" title="(k: K, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">removed</a><span class="delimiter">(</span><a href="#182717" title="K">k</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
          <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>ln, <a href="#182920" title="scala.collection.concurrent.MainNode[K,V]">nn</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#182919" title="Option[V]">optv</a> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> ln.<a href="#181929" title="(k: K)Option[V]">get</a><a href="#3267710" title="Some[V]" class="delimiter">(</a><a href="#182717" title="K">k</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> optv @ Some<a href="#3267709" title="Option[V]" id="3267710" class="delimiter">(</a><a href="../../Option.scala.html#63132" title="V" id="182928">v0</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#182928" title="V">v0</a> <span title="(x$1: Any)Boolean">==</span> <a href="#182718" title="V">v</a> =&gt;
            <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182929">nn</a> = ln.<a href="#181928" title="(k: K, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">removed</a><span class="delimiter">(</span><a href="#182717" title="K">k</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
            <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><span class="delimiter">(</span>ln, <a href="#182929" title="scala.collection.concurrent.MainNode[K,V]">nn</a>, <a href="#182723" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span><span class="delimiter">)</span> optv <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">case</span> _ =&gt; <a href="#3267712" title="(x: Option[V])Option[V]">None</a>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(nd: scala.collection.concurrent.INode[K,V], ct: scala.collection.concurrent.TrieMap[K,V], lev: Int)Unit" id="181400">clean</a><span class="delimiter">(</span><a title="scala.collection.concurrent.INode[K,V]" id="181913">nd</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="181914">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="Int" id="181915">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182930">m</a> = <a href="#181913" title="scala.collection.concurrent.INode[K,V]">nd</a>.<a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#181914" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
    <a href="#182930" title="scala.collection.concurrent.MainNode[K,V]">m</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3267728" title="Unit" id="3267729">cn</a>: CNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="#181913" title="scala.collection.concurrent.INode[K,V]">nd</a>.<a href="#181392" title="(old: scala.collection.concurrent.MainNode[K,V], n: scala.collection.concurrent.MainNode[K,V], ct: scala.collection.concurrent.TrieMap[K,V])Boolean">GCAS</a><a href="#3267731" title="(x: Unit)Unit" class="delimiter">(</a>cn, cn.<a href="#181690" title="(ct: scala.collection.concurrent.TrieMap[K,V], lev: Int, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.MainNode[K,V]">toCompressed</a><span class="delimiter">(</span><a href="#181914" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>, <a href="#181915" title="Int">lev</a>, <a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>, <a href="#181914" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
      <span class="keyword">case</span> _ =&gt;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ct: scala.collection.concurrent.TrieMap[K,V])Boolean" id="181401">isNullInode</a><span class="delimiter">(</span><a title="scala.collection.concurrent.TrieMap[K,V]" id="182974">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#182974" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">def</span> <a title="(ct: scala.collection.concurrent.TrieMap[K,V])Int" id="181402">cachedSize</a><span class="delimiter">(</span><a title="scala.collection.concurrent.TrieMap[K,V]" id="182975">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Int.scala.html#321" title="Int">Int</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182976">m</a> = <a href="#181390" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">GCAS_READ</a><span class="delimiter">(</span><a href="#182975" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
    <a href="#182976" title="scala.collection.concurrent.MainNode[K,V]">m</a>.<a href="MainNode.java.html#181410" title="(ct: Any)Int">cachedSize</a><span class="delimiter">(</span><a href="#182975" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /* this is a quiescent method! */
  <span class="keyword">def</span> <a title="(lev: Int)String" id="181403">string</a><span class="delimiter">(</span><a title="Int" id="182978">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> = <a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%sINode -&gt; %s&quot;</a>.<a href="../immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;  &quot;</a> <a href="../immutable/StringLike.scala.html#59852" title="(n: Int)String">*</a> <a href="#182978" title="Int">lev</a>, <a href="INodeBase.java.html#181376" title="scala.collection.concurrent.MainNode[K,V]">mainnode</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#3267736" title="Any" id="3267745" class="keyword">null</a> =&gt; <a href="#3267750" title="(x: Any)Any" class="string">&quot;&lt;null&gt;&quot;</a>
    <span class="keyword">case</span> <a href="#3267736" title="Any" id="3267746">tn</a>: TNode<span class="delimiter">[</span>_, _<span class="delimiter">]</span> =&gt; <a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;TNode(%s, %s, %d, !)&quot;</a>.<a href="../immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><a href="#3267750" title="(x: Any)Any" class="delimiter">(</a>tn.<a href="#183073" title="=&gt; _">k</a>, tn.<a href="#183074" title="=&gt; _">v</a>, tn.<a href="#183075" title="=&gt; Int">hc</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="#3267736" title="Any" id="3267747">cn</a>: CNode<span class="delimiter">[</span>_, _<span class="delimiter">]</span> =&gt; cn.<a href="#181691" title="(lev: Int)String">string</a><a href="#3267750" title="(x: Any)Any" class="delimiter">(</a><a href="#182978" title="Int">lev</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="#3267736" title="Any" id="3267748">ln</a>: LNode<span class="delimiter">[</span>_, _<span class="delimiter">]</span> =&gt; ln.<a href="#181931" title="(lev: Int)String">string</a><a href="#3267750" title="(x: Any)Any" class="delimiter">(</a><a href="#182978" title="Int">lev</a><span class="delimiter">)</span>
    <span class="keyword">case</span> x =&gt; <a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&lt;elem: %s&gt;&quot;</a>.<a href="../immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><a href="#3267750" title="(x: Any)Any" class="delimiter">(</a>x<span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>

<span class="delimiter">}</span>


<span class="keyword">private</span><span class="delimiter">[</span>concurrent<span class="delimiter">]</span> <span class="keyword">object</span> <a title="scala.collection.concurrent.INode.type" id="10008">INode</a> <a href="#10009" title="scala.collection.concurrent.INode.type" class="delimiter">{</a>
  <span class="keyword">val</span> <a title="Object" id="182501">KEY_PRESENT</a> = <span title="Object" class="keyword">new</span> <span title="Object">AnyRef</span>
  <span class="keyword">val</span> <a title="Object" id="182503">KEY_ABSENT</a> = <span title="Object" class="keyword">new</span> <span title="Object">AnyRef</span>

  <span class="keyword">def</span> <a title="[K, V]=&gt; scala.collection.concurrent.INode[K,V]" id="182505">newRootNode</a><span class="delimiter">[</span><a title="" id="182508">K</a>, <a title="" id="182509">V</a><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.Gen" id="183030">gen</a> = <span title="scala.collection.concurrent.Gen" class="keyword">new</span> <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.CNode[K,V]" id="183031">cn</a> = <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">new</span> <a href="#10013" title="scala.collection.concurrent.CNode[K,V]">CNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Array[scala.collection.concurrent.BasicNode]" class="keyword">new</span> <a href="../../Array.scala.html#174" title="Array[scala.collection.concurrent.BasicNode]">Array</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#183030" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
    <span title="scala.collection.concurrent.INode[K,V]" class="keyword">new</span> <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="#183031" title="scala.collection.concurrent.CNode[K,V]">cn</a>, <a href="#183030" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span title="Object" class="keyword">private</span><span class="delimiter">[</span>concurrent<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">class</span> <a title="class FailedNode[K, V] extends scala.collection.concurrent.MainNode[K,V]" id="9986">FailedNode</a><span class="delimiter">[</span><a title="" id="10086">K</a>, <a title="" id="10087">V</a><span class="delimiter">]</span><a href="#9986" title="scala.collection.concurrent.FailedNode[K,V]" class="delimiter">(</a><a title="scala.collection.concurrent.MainNode[K,V]" id="181628">p</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> <span class="delimiter">{</span>
  <a href="MainNode.java.html#181412" title="(nval: scala.collection.concurrent.MainNode[K,V])Unit">WRITE_PREV</a><span class="delimiter">(</span><a href="#181628" title="scala.collection.concurrent.MainNode[K,V]">p</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(lev: Int)Nothing" id="181605">string</a><span class="delimiter">(</span><a title="Int" id="183040">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> = <span title="Nothing" class="keyword">throw</span> <span title="UnsupportedOperationException" class="keyword">new</span> <a href="../../package.scala.html#55508" title="UnsupportedOperationException">UnsupportedOperationException</a>

  <span class="keyword">def</span> <a title="(ct: AnyRef)Int" id="181606">cachedSize</a><span class="delimiter">(</span><a title="AnyRef" id="183043">ct</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <a href="../../Int.scala.html#321" title="Int">Int</a> = <span title="Nothing" class="keyword">throw</span> <span title="UnsupportedOperationException" class="keyword">new</span> <a href="../../package.scala.html#55508" title="UnsupportedOperationException">UnsupportedOperationException</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="181607">toString</a> = <a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;FailedNode(%s)&quot;</a>.<a href="../immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#181628" title="scala.collection.concurrent.MainNode[K,V]">p</a><span class="delimiter">)</span>
<span class="delimiter">}</span>


<span class="keyword">private</span><span class="delimiter">[</span>concurrent<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait KVNode[K, V] extends Object" id="10022">KVNode</a><span class="delimiter">[</span><a title="" id="10088">K</a>, <a title="" id="10089">V</a><span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; (K, V)" id="181786">kvPair</a>: <a href="../../Tuple2.scala.html#783" title="(K, V)" class="delimiter">(</a>K, V<span class="delimiter">)</span>
<span class="delimiter">}</span>


<span title="Object" class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">class</span> <a title="class SNode[K, V] extends scala.collection.concurrent.BasicNode with scala.collection.concurrent.KVNode[K,V]" id="9995">SNode</a><span class="delimiter">[</span><a title="" id="10090">K</a>, <a title="" id="10091">V</a><span class="delimiter">]</span><a href="#9995" title="scala.collection.concurrent.SNode[K,V]" class="delimiter">(</a><span class="keyword">final</span> <span class="keyword">val</span> <a title="K" id="181804">k</a>: <a href="#10090" title="K">K</a>, <span class="keyword">final</span> <span class="keyword">val</span> <a title="V" id="181805">v</a>: <a href="#10091" title="V">V</a>, <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int" id="181806">hc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>
<span class="keyword">extends</span> <a href="BasicNode.java.html#10046" title="scala.collection.concurrent.BasicNode">BasicNode</a> <span class="keyword">with</span> <a href="#10022" title="scala.collection.concurrent.KVNode[K,V]">KVNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.concurrent.SNode[K,V]" id="181781">copy</a> = <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#181804" title="=&gt; K">k</a>, <a href="#181805" title="=&gt; V">v</a>, <a href="#181806" title="=&gt; Int">hc</a><span class="delimiter">)</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.concurrent.TNode[K,V]" id="181782">copyTombed</a> = <span title="scala.collection.concurrent.TNode[K,V]" class="keyword">new</span> <a href="#10031" title="scala.collection.concurrent.TNode[K,V]">TNode</a><span class="delimiter">(</span><a href="#181804" title="=&gt; K">k</a>, <a href="#181805" title="=&gt; V">v</a>, <a href="#181806" title="=&gt; Int">hc</a><span class="delimiter">)</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.concurrent.SNode[K,V]" id="181783">copyUntombed</a> = <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#181804" title="=&gt; K">k</a>, <a href="#181805" title="=&gt; V">v</a>, <a href="#181806" title="=&gt; Int">hc</a><span class="delimiter">)</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; (K, V)" id="181784">kvPair</a> = <a href="../../Tuple2.scala.html#62849" title="(_1: K, _2: V)(K, V)" class="delimiter">(</a><a href="#181804" title="=&gt; K">k</a>, <a href="#181805" title="=&gt; V">v</a><span class="delimiter">)</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(lev: Int)String" id="181785">string</a><span class="delimiter">(</span><a title="Int" id="183102">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;  &quot;</a> <a href="../immutable/StringLike.scala.html#59852" title="(n: Int)String">*</a> <a href="#183102" title="Int">lev</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;SNode(%s, %s, %x)&quot;</a>.<a href="../immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#181804" title="=&gt; K">k</a>, <a href="#181805" title="=&gt; V">v</a>, <a href="#181806" title="=&gt; Int">hc</a><span class="delimiter">)</span>
<span class="delimiter">}</span>


<span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">class</span> <a title="class TNode[K, V] extends scala.collection.concurrent.MainNode[K,V] with scala.collection.concurrent.KVNode[K,V]" id="10031">TNode</a><span class="delimiter">[</span><a title="" id="10092">K</a>, <a title="" id="10093">V</a><span class="delimiter">]</span><a href="#10031" title="scala.collection.concurrent.TNode[K,V]" class="delimiter">(</a><span class="keyword">final</span> <span class="keyword">val</span> <a title="K" id="183073">k</a>: <a href="#10092" title="K">K</a>, <span class="keyword">final</span> <span class="keyword">val</span> <a title="V" id="183074">v</a>: <a href="#10093" title="V">V</a>, <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int" id="183075">hc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>
<span class="keyword">extends</span> <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> <span class="keyword">with</span> <a href="#10022" title="scala.collection.concurrent.KVNode[K,V]">KVNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.concurrent.TNode[K,V]" id="181905">copy</a> = <span title="scala.collection.concurrent.TNode[K,V]" class="keyword">new</span> <a href="#10031" title="scala.collection.concurrent.TNode[K,V]">TNode</a><span class="delimiter">(</span><a href="#183073" title="=&gt; K">k</a>, <a href="#183074" title="=&gt; V">v</a>, <a href="#183075" title="=&gt; Int">hc</a><span class="delimiter">)</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.concurrent.TNode[K,V]" id="181906">copyTombed</a> = <span title="scala.collection.concurrent.TNode[K,V]" class="keyword">new</span> <a href="#10031" title="scala.collection.concurrent.TNode[K,V]">TNode</a><span class="delimiter">(</span><a href="#183073" title="=&gt; K">k</a>, <a href="#183074" title="=&gt; V">v</a>, <a href="#183075" title="=&gt; Int">hc</a><span class="delimiter">)</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.concurrent.SNode[K,V]" id="181907">copyUntombed</a> = <span title="scala.collection.concurrent.SNode[K,V]" class="keyword">new</span> <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">(</span><a href="#183073" title="=&gt; K">k</a>, <a href="#183074" title="=&gt; V">v</a>, <a href="#183075" title="=&gt; Int">hc</a><span class="delimiter">)</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; (K, V)" id="181908">kvPair</a> = <a href="../../Tuple2.scala.html#62849" title="(_1: K, _2: V)(K, V)" class="delimiter">(</a><a href="#183073" title="=&gt; K">k</a>, <a href="#183074" title="=&gt; V">v</a><span class="delimiter">)</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(ct: AnyRef)Int" id="181909">cachedSize</a><span class="delimiter">(</span><a title="AnyRef" id="183146">ct</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <a href="../../Int.scala.html#321" title="Int">Int</a> = <span title="Int(1)" class="int">1</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(lev: Int)String" id="181910">string</a><span class="delimiter">(</span><a title="Int" id="183148">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;  &quot;</a> <a href="../immutable/StringLike.scala.html#59852" title="(n: Int)String">*</a> <a href="#183148" title="Int">lev</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;TNode(%s, %s, %x, !)&quot;</a>.<a href="../immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#183073" title="=&gt; K">k</a>, <a href="#183074" title="=&gt; V">v</a>, <a href="#183075" title="=&gt; Int">hc</a><span class="delimiter">)</span>
<span class="delimiter">}</span>


<span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">class</span> <a title="class LNode[K, V] extends scala.collection.concurrent.MainNode[K,V]" id="9968">LNode</a><span class="delimiter">[</span><a title="" id="10094">K</a>, <a title="" id="10095">V</a><span class="delimiter">]</span><a href="#9968" title="scala.collection.concurrent.LNode[K,V]" class="delimiter">(</a><span class="keyword">final</span> <span class="keyword">val</span> <a title="scala.collection.immutable.ListMap[K,V]" id="181953">listmap</a>: <a href="../immutable/ListMap.scala.html#11712" title="scala.collection.immutable.ListMap[K,V]">ImmutableListMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>
<span class="keyword">extends</span> <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(k: K, v: V)scala.collection.concurrent.LNode[K,V]" id="181925" class="keyword">this</a><span class="delimiter">(</span><a title="K" id="181949">k</a>: <a href="#10094" title="K">K</a>, <a title="V" id="181950">v</a>: <a href="#10095" title="V">V</a><span class="delimiter">)</span> = <a href="#9968" title="LNode.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="../generic/GenMapFactory.scala.html#60744" title="(elems: (K, V)*)scala.collection.immutable.ListMap[K,V]">ImmutableListMap</a><span class="delimiter">(</span><a href="../../Predef.scala.html#7509" title="(x: K)ArrowAssoc[K]">k</a> <a href="../../Predef.scala.html#62634" title="(y: V)(K, V)">-&gt;</a> <a href="#181950" title="V">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(k1: K, v1: V, k2: K, v2: V)scala.collection.concurrent.LNode[K,V]" id="181926" class="keyword">this</a><span class="delimiter">(</span><a title="K" id="181941">k1</a>: <a href="#10094" title="K">K</a>, <a title="V" id="181942">v1</a>: <a href="#10095" title="V">V</a>, <a title="K" id="181943">k2</a>: <a href="#10094" title="K">K</a>, <a title="V" id="181944">v2</a>: <a href="#10095" title="V">V</a><span class="delimiter">)</span> = <a href="#9968" title="LNode.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="../generic/GenMapFactory.scala.html#60744" title="(elems: (K, V)*)scala.collection.immutable.ListMap[K,V]">ImmutableListMap</a><span class="delimiter">(</span><a href="../../Predef.scala.html#7509" title="(x: K)ArrowAssoc[K]">k1</a> <a href="../../Predef.scala.html#62634" title="(y: V)(K, V)">-&gt;</a> <a href="#181942" title="V">v1</a>, <a href="../../Predef.scala.html#7509" title="(x: K)ArrowAssoc[K]">k2</a> <a href="../../Predef.scala.html#62634" title="(y: V)(K, V)">-&gt;</a> <a href="#181944" title="V">v2</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(k: K, v: V)scala.collection.concurrent.LNode[K,V]" id="181927">inserted</a><span class="delimiter">(</span><a title="K" id="181935">k</a>: <a href="#10094" title="K">K</a>, <a title="V" id="181936">v</a>: <a href="#10095" title="V">V</a><span class="delimiter">)</span> = <span title="scala.collection.concurrent.LNode[K,V]" class="keyword">new</span> <a href="#9968" title="scala.collection.concurrent.LNode[K,V]">LNode</a><span class="delimiter">(</span><a href="#181953" title="=&gt; scala.collection.immutable.ListMap[K,V]">listmap</a> <a href="../immutable/ListMap.scala.html#181963" title="(kv: (K, V))scala.collection.immutable.ListMap[K,V]">+</a> <span class="delimiter">(</span><a href="../../Tuple2.scala.html#62849" title="(_1: K, _2: V)(K, V)" class="delimiter">(</a><a href="#181935" title="K">k</a>, <a href="#181936" title="V">v</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(k: K, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]" id="181928">removed</a><span class="delimiter">(</span><a title="K" id="182922">k</a>: <a href="#10094" title="K">K</a>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="182923">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.ListMap[K,V]" id="183245">updmap</a> = <a href="#181953" title="=&gt; scala.collection.immutable.ListMap[K,V]">listmap</a> <a href="../immutable/ListMap.scala.html#181972" title="(key: K)scala.collection.immutable.ListMap[K,V]">-</a> <a href="#182922" title="K">k</a>
    <span title="scala.collection.concurrent.MainNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#183245" title="scala.collection.immutable.ListMap[K,V]">updmap</a>.<a href="../immutable/ListMap.scala.html#181958" title="=&gt; Int">size</a> <a href="../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="scala.collection.concurrent.LNode[K,V]" class="keyword">new</span> <a href="#9968" title="scala.collection.concurrent.LNode[K,V]">LNode</a><span class="delimiter">(</span><a href="#183245" title="scala.collection.immutable.ListMap[K,V]">updmap</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a href="#3267763" title="(x: (K, V))(K, V)" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="K" id="183295">k</a>, <a href="../../Tuple2.scala.html#60637" title="V" id="183296">v</a><span class="delimiter">)</span> = <a href="#183245" title="scala.collection.immutable.ListMap[K,V]">updmap</a>.<a href="../immutable/ListMap.scala.html#181973" title="=&gt; Iterator[(K, V)]">iterator</a>.<a href="../Iterator.scala.html#66748" title="()(K, V)">next</a>
      <span title="scala.collection.concurrent.TNode[K,V]" class="keyword">new</span> <a href="#10031" title="scala.collection.concurrent.TNode[K,V]">TNode</a><span class="delimiter">(</span><a href="#183295" title="K">k</a>, <a href="#183296" title="V">v</a>, <a href="#182923" title="scala.collection.concurrent.TrieMap[K,V]">ct</a>.<a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#183295" title="K">k</a><span class="delimiter">)</span><span class="delimiter">)</span> // create it tombed so that it gets compressed on subsequent accesses
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(k: K)Option[V]" id="181929">get</a><span class="delimiter">(</span><a title="K" id="182602">k</a>: <a href="#10094" title="K">K</a><span class="delimiter">)</span> = <a href="#181953" title="=&gt; scala.collection.immutable.ListMap[K,V]">listmap</a>.<a href="../immutable/ListMap.scala.html#181959" title="(key: K)Option[V]">get</a><span class="delimiter">(</span><a href="#182602" title="K">k</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(ct: AnyRef)Int" id="181930">cachedSize</a><span class="delimiter">(</span><a title="AnyRef" id="183359">ct</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <a href="../../Int.scala.html#321" title="Int">Int</a> = <a href="#181953" title="=&gt; scala.collection.immutable.ListMap[K,V]">listmap</a>.<a href="../immutable/ListMap.scala.html#181958" title="=&gt; Int">size</a>
  <span class="keyword">def</span> <a title="(lev: Int)String" id="181931">string</a><span class="delimiter">(</span><a title="Int" id="183015">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot; &quot;</a> <a href="../immutable/StringLike.scala.html#59852" title="(n: Int)String">*</a> <a href="#183015" title="Int">lev</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;LNode(%s)&quot;</a>.<a href="../immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#181953" title="=&gt; scala.collection.immutable.ListMap[K,V]">listmap</a>.<a href="../TraversableOnce.scala.html#58283" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>


<span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">class</span> <a title="class CNode[K, V] extends scala.collection.concurrent.CNodeBase[K,V]" id="10013">CNode</a><span class="delimiter">[</span><a title="" id="10096">K</a>, <a title="" id="10097">V</a><span class="delimiter">]</span><a href="#10013" title="scala.collection.concurrent.CNode[K,V]" class="delimiter">(</a><span class="keyword">val</span> <a title="Int" id="181765">bitmap</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <span class="keyword">val</span> <a title="Array[scala.collection.concurrent.BasicNode]" id="181766">array</a>: <a href="../../Array.scala.html#174" title="Array[scala.collection.concurrent.BasicNode]">Array</a><span class="delimiter">[</span>BasicNode<span class="delimiter">]</span>, <span class="keyword">val</span> <a title="scala.collection.concurrent.Gen" id="181767">gen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="CNodeBase.java.html#10019" title="scala.collection.concurrent.CNodeBase[K,V]">CNodeBase</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> <span class="delimiter">{</span>
  // this should only be called from within read-only snapshots
  <span class="keyword">def</span> <a title="(ct: AnyRef)Int" id="181682">cachedSize</a><span class="delimiter">(</span><a title="AnyRef" id="183364">ct</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="183365">currsz</a> = <a href="CNodeBase.java.html#181671" title="()Int">READ_SIZE</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#183365" title="Int">currsz</a> <a href="../../Int.scala.html#57104" title="(x: Int)Boolean">!=</a> -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span> <a href="#183365" title="Int">currsz</a>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="183370">sz</a> = <a href="#181683" title="(ct: scala.collection.concurrent.TrieMap[K,V])Int">computeSize</a><span class="delimiter">(</span><a href="#183364" title="AnyRef">ct</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.concurrent.TrieMap[K,V]" class="delimiter">[</span><a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="CNodeBase.java.html#181671" title="()Int">READ_SIZE</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span> <a href="CNodeBase.java.html#181669" title="(oldval: Int, nval: Int)Boolean">CAS_SIZE</a><a href="#183371" title="()Unit" class="delimiter">(</a>-<span title="Int(-1)" class="int">1</span>, <a href="#183370" title="Int">sz</a><span class="delimiter">)</span>
      <a href="CNodeBase.java.html#181671" title="()Int">READ_SIZE</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  // lends itself towards being parallelizable by choosing
  // a random starting offset in the array
  // =&gt; if there are concurrent size computations, they start
  //    at different positions, so they are more likely to
  //    to be independent
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ct: scala.collection.concurrent.TrieMap[K,V])Int" id="181683">computeSize</a><span class="delimiter">(</span><a title="scala.collection.concurrent.TrieMap[K,V]" id="183372">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Int.scala.html#321" title="Int">Int</a> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="183380">i</a> = <span title="Int(0)" class="int">0</span>
    <span class="keyword">var</span> <a title="Int" id="183381">sz</a> = <span title="Int(0)" class="int">0</span>
    <span class="keyword">val</span> <a title="Int" id="183382">offset</a> =
      <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        //util.Random.nextInt(array.length) /* &lt;-- benchmarks show that this causes observable contention */
        scala.concurrent.forkjoin.<span title="scala.concurrent.forkjoin.ThreadLocalRandom.type">ThreadLocalRandom</span>.<span title="()scala.concurrent.forkjoin.ThreadLocalRandom">current</span>.<span title="(x$1: Int, x$2: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#183380" title="Int">i</a> <a href="../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span> <a href="#183383" title="()Unit" class="delimiter">{</a>
      <span class="keyword">val</span> <a title="Int" id="183416">pos</a> = <span class="delimiter">(</span><a href="#183380" title="Int">i</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <a href="#183382" title="Int">offset</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57182" title="(x: Int)Int">%</a> <a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a>
      <a href="../../Array.scala.html#56639" title="(i: Int)scala.collection.concurrent.BasicNode">array</a><a href="#3267769" title="scala.collection.concurrent.INode[K,V]" class="delimiter">(</a><a href="#183416" title="Int">pos</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#3267767" title="Unit" id="3267768">sn</a>: SNode<span class="delimiter">[</span>_, _<span class="delimiter">]</span> =&gt; <a href="#183381" title="Int">sz</a> <a href="#3267771" title="(x: Unit)Unit">+=</a> <span title="Int(1)" class="int">1</span>
        <span class="keyword">case</span> <a href="#3267767" title="Unit" id="3267769">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="#183381" title="Int">sz</a> <a href="#3267771" title="(x: Unit)Unit">+=</a> in.<a href="#181402" title="(ct: scala.collection.concurrent.TrieMap[K,V])Int">cachedSize</a><span class="delimiter">(</span><a href="#183372" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#183380" title="Int">i</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#183381" title="Int">sz</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pos: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]" id="181684">updatedAt</a><span class="delimiter">(</span><a title="Int" id="181795">pos</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.BasicNode" id="181796">nn</a>: <a href="BasicNode.java.html#10046" title="scala.collection.concurrent.BasicNode">BasicNode</a>, <a title="scala.collection.concurrent.Gen" id="181797">gen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="181798">len</a> = <a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a>
    <span class="keyword">val</span> <a title="Array[scala.collection.concurrent.BasicNode]" id="181799">narr</a> = <span title="Array[scala.collection.concurrent.BasicNode]" class="keyword">new</span> <a href="../../Array.scala.html#174" title="Array[scala.collection.concurrent.BasicNode]">Array</a><span class="delimiter">[</span>BasicNode<span class="delimiter">]</span><span class="delimiter">(</span><a href="#181798" title="Int">len</a><span class="delimiter">)</span>
    <a href="../../Array.scala.html#175" title="Array.type">Array</a>.<a href="../../Array.scala.html#72256" title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</a><span class="delimiter">(</span><a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>, <span title="Int(0)" class="int">0</span>, <a href="#181799" title="Array[scala.collection.concurrent.BasicNode]">narr</a>, <span title="Int(0)" class="int">0</span>, <a href="#181798" title="Int">len</a><span class="delimiter">)</span>
    <a href="../../Array.scala.html#56640" title="(i: Int, x: scala.collection.concurrent.BasicNode)Unit">narr</a><span class="delimiter">(</span><a href="#181795" title="Int">pos</a><span class="delimiter">)</span> = <a href="#181796" title="scala.collection.concurrent.BasicNode">nn</a>
    <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">new</span> <a href="#10013" title="scala.collection.concurrent.CNode[K,V]">CNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="#181765" title="=&gt; Int">bitmap</a>, <a href="#181799" title="Array[scala.collection.concurrent.BasicNode]">narr</a>, <a href="#181797" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pos: Int, flag: Int, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]" id="181685">removedAt</a><span class="delimiter">(</span><a title="Int" id="182782">pos</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="182783">flag</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.Gen" id="182784">gen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[scala.collection.concurrent.BasicNode]" id="182785">arr</a> = <a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>
    <span class="keyword">val</span> <a title="Int" id="182786">len</a> = <a href="#182785" title="Array[scala.collection.concurrent.BasicNode]">arr</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a>
    <span class="keyword">val</span> <a title="Array[scala.collection.concurrent.BasicNode]" id="182787">narr</a> = <span title="Array[scala.collection.concurrent.BasicNode]" class="keyword">new</span> <a href="../../Array.scala.html#174" title="Array[scala.collection.concurrent.BasicNode]">Array</a><span class="delimiter">[</span>BasicNode<span class="delimiter">]</span><span class="delimiter">(</span><a href="#182786" title="Int">len</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <a href="../../Array.scala.html#175" title="Array.type">Array</a>.<a href="../../Array.scala.html#72256" title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</a><span class="delimiter">(</span><a href="#182785" title="Array[scala.collection.concurrent.BasicNode]">arr</a>, <span title="Int(0)" class="int">0</span>, <a href="#182787" title="Array[scala.collection.concurrent.BasicNode]">narr</a>, <span title="Int(0)" class="int">0</span>, <a href="#182782" title="Int">pos</a><span class="delimiter">)</span>
    <a href="../../Array.scala.html#175" title="Array.type">Array</a>.<a href="../../Array.scala.html#72256" title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</a><span class="delimiter">(</span><a href="#182785" title="Array[scala.collection.concurrent.BasicNode]">arr</a>, <a href="#182782" title="Int">pos</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>, <a href="#182787" title="Array[scala.collection.concurrent.BasicNode]">narr</a>, <a href="#182782" title="Int">pos</a>, <a href="#182786" title="Int">len</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <a href="#182782" title="Int">pos</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">new</span> <a href="#10013" title="scala.collection.concurrent.CNode[K,V]">CNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="#181765" title="=&gt; Int">bitmap</a> <a href="../../Int.scala.html#57149" title="(x: Int)Int">^</a> <a href="#182783" title="Int">flag</a>, <a href="#182787" title="Array[scala.collection.concurrent.BasicNode]">narr</a>, <a href="#182784" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pos: Int, flag: Int, nn: scala.collection.concurrent.BasicNode, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.CNode[K,V]" id="181686">insertedAt</a><span class="delimiter">(</span><a title="Int" id="181861">pos</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="181862">flag</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.BasicNode" id="181863">nn</a>: <a href="BasicNode.java.html#10046" title="scala.collection.concurrent.BasicNode">BasicNode</a>, <a title="scala.collection.concurrent.Gen" id="181864">gen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="181865">len</a> = <a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a>
    <span class="keyword">val</span> <a title="Int" id="181866">bmp</a> = <a href="#181765" title="=&gt; Int">bitmap</a>
    <span class="keyword">val</span> <a title="Array[scala.collection.concurrent.BasicNode]" id="181867">narr</a> = <span title="Array[scala.collection.concurrent.BasicNode]" class="keyword">new</span> <a href="../../Array.scala.html#174" title="Array[scala.collection.concurrent.BasicNode]">Array</a><span class="delimiter">[</span>BasicNode<span class="delimiter">]</span><span class="delimiter">(</span><a href="#181865" title="Int">len</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <a href="../../Array.scala.html#175" title="Array.type">Array</a>.<a href="../../Array.scala.html#72256" title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</a><span class="delimiter">(</span><a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>, <span title="Int(0)" class="int">0</span>, <a href="#181867" title="Array[scala.collection.concurrent.BasicNode]">narr</a>, <span title="Int(0)" class="int">0</span>, <a href="#181861" title="Int">pos</a><span class="delimiter">)</span>
    <a href="../../Array.scala.html#56640" title="(i: Int, x: scala.collection.concurrent.BasicNode)Unit">narr</a><span class="delimiter">(</span><a href="#181861" title="Int">pos</a><span class="delimiter">)</span> = <a href="#181863" title="scala.collection.concurrent.BasicNode">nn</a>
    <a href="../../Array.scala.html#175" title="Array.type">Array</a>.<a href="../../Array.scala.html#72256" title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</a><span class="delimiter">(</span><a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>, <a href="#181861" title="Int">pos</a>, <a href="#181867" title="Array[scala.collection.concurrent.BasicNode]">narr</a>, <a href="#181861" title="Int">pos</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>, <a href="#181865" title="Int">len</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <a href="#181861" title="Int">pos</a><span class="delimiter">)</span>
    <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">new</span> <a href="#10013" title="scala.collection.concurrent.CNode[K,V]">CNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="#181866" title="Int">bmp</a> <a href="../../Int.scala.html#57139" title="(x: Int)Int">|</a> <a href="#181862" title="Int">flag</a>, <a href="#181867" title="Array[scala.collection.concurrent.BasicNode]">narr</a>, <a href="#181864" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Returns a copy of this cnode such that all the i-nodes below it are copied
   *  to the specified generation `ngen`.
   */
  <span class="keyword">def</span> <a title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.CNode[K,V]" id="181687">renewed</a><span class="delimiter">(</span><a title="scala.collection.concurrent.Gen" id="181738">ngen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="181739">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="181740">i</a> = <span title="Int(0)" class="int">0</span>
    <span class="keyword">val</span> <a title="Array[scala.collection.concurrent.BasicNode]" id="181741">arr</a> = <a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>
    <span class="keyword">val</span> <a title="Int" id="181742">len</a> = <a href="#181741" title="Array[scala.collection.concurrent.BasicNode]">arr</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a>
    <span class="keyword">val</span> <a title="Array[scala.collection.concurrent.BasicNode]" id="181743">narr</a> = <span title="Array[scala.collection.concurrent.BasicNode]" class="keyword">new</span> <a href="../../Array.scala.html#174" title="Array[scala.collection.concurrent.BasicNode]">Array</a><span class="delimiter">[</span>BasicNode<span class="delimiter">]</span><span class="delimiter">(</span><a href="#181742" title="Int">len</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#181740" title="Int">i</a> <a href="../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="#181742" title="Int">len</a><span class="delimiter">)</span> <a href="#181744" title="()Unit" class="delimiter">{</a>
      <a href="../../Array.scala.html#56639" title="(i: Int)scala.collection.concurrent.BasicNode">arr</a><a href="#3267777" title="scala.collection.concurrent.INode[K,V]" class="delimiter">(</a><a href="#181740" title="Int">i</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#3267776" title="Unit" id="3267777">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="../../Array.scala.html#56640" title="(i: Int, x: scala.collection.concurrent.BasicNode)Unit">narr</a><span class="delimiter">(</span><a href="#181740" title="Int">i</a><span class="delimiter">)</span> = in.<a href="#181395" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.INode[K,V]">copyToGen</a><span class="delimiter">(</span><a href="#181738" title="scala.collection.concurrent.Gen">ngen</a>, <a href="#181739" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="#3267776" title="Unit" id="3267778">bn</a>: BasicNode =&gt; <a href="../../Array.scala.html#56640" title="(i: Int, x: scala.collection.concurrent.BasicNode)Unit">narr</a><span class="delimiter">(</span><a href="#181740" title="Int">i</a><span class="delimiter">)</span> = bn
      <span class="delimiter">}</span>
      <a href="#181740" title="Int">i</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">new</span> <a href="#10013" title="scala.collection.concurrent.CNode[K,V]">CNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="#181765" title="=&gt; Int">bitmap</a>, <a href="#181743" title="Array[scala.collection.concurrent.BasicNode]">narr</a>, <a href="#181738" title="scala.collection.concurrent.Gen">ngen</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(inode: scala.collection.concurrent.INode[K,V], inodemain: AnyRef)scala.collection.concurrent.BasicNode" id="181688">resurrect</a><span class="delimiter">(</span><a title="scala.collection.concurrent.INode[K,V]" id="182958">inode</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="AnyRef" id="182959">inodemain</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <a href="BasicNode.java.html#10046" title="scala.collection.concurrent.BasicNode">BasicNode</a> = <a href="#182959" title="AnyRef">inodemain</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#3267785" title="scala.collection.concurrent.BasicNode" id="3267786">tn</a>: TNode<span class="delimiter">[</span>_, _<span class="delimiter">]</span> =&gt; tn.<a href="#3267788" title="(x: scala.collection.concurrent.BasicNode)scala.collection.concurrent.BasicNode">copyUntombed</a>
    <span class="keyword">case</span> _ =&gt; <a href="#3267788" title="(x: scala.collection.concurrent.BasicNode)scala.collection.concurrent.BasicNode">inode</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(lev: Int)scala.collection.concurrent.MainNode[K,V]" id="181689">toContracted</a><span class="delimiter">(</span><a title="Int" id="182808">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <span title="scala.collection.concurrent.MainNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#182808" title="Int">lev</a> <a href="../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="../../Array.scala.html#56639" title="(i: Int)scala.collection.concurrent.BasicNode">array</a><a href="#3267794" title="scala.collection.concurrent.SNode[K,V]" class="delimiter">(</a><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#3267793" title="scala.collection.concurrent.MainNode[K,V]" id="3267794">sn</a>: SNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; sn.<a href="#3267796" title="(x: scala.collection.concurrent.MainNode[K,V])scala.collection.concurrent.MainNode[K,V]">copyTombed</a>
    <span class="keyword">case</span> _ =&gt; <a href="#3267796" title="(x: scala.collection.concurrent.MainNode[K,V])scala.collection.concurrent.MainNode[K,V]" class="keyword">this</a>
  <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#10013" title="scala.collection.concurrent.CNode[K,V]" class="keyword">this</a>

  // - if the branching factor is 1 for this CNode, and the child
  //   is a tombed SNode, returns its tombed version
  // - otherwise, if there is at least one non-null node below,
  //   returns the version of this node with at least some null-inodes
  //   removed (those existing when the op began)
  // - if there are only null-i-nodes below, returns null
  <span class="keyword">def</span> <a title="(ct: scala.collection.concurrent.TrieMap[K,V], lev: Int, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.MainNode[K,V]" id="181690">toCompressed</a><span class="delimiter">(</span><a title="scala.collection.concurrent.TrieMap[K,V]" id="182934">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="Int" id="182935">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.Gen" id="182936">gen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="182937">bmp</a> = <a href="#181765" title="=&gt; Int">bitmap</a>
    <span class="keyword">var</span> <a title="Int" id="182938">i</a> = <span title="Int(0)" class="int">0</span>
    <span class="keyword">val</span> <a title="Array[scala.collection.concurrent.BasicNode]" id="182939">arr</a> = <a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>
    <span class="keyword">val</span> <a title="Array[scala.collection.concurrent.BasicNode]" id="182940">tmparray</a> = <span title="Array[scala.collection.concurrent.BasicNode]" class="keyword">new</span> <a href="../../Array.scala.html#174" title="Array[scala.collection.concurrent.BasicNode]">Array</a><span class="delimiter">[</span>BasicNode<span class="delimiter">]</span><span class="delimiter">(</span><a href="#182939" title="Array[scala.collection.concurrent.BasicNode]">arr</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#182938" title="Int">i</a> <a href="../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="#182939" title="Array[scala.collection.concurrent.BasicNode]">arr</a>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span> <a href="#182941" title="()Unit" class="delimiter">{</a> // construct new bitmap
      <span class="keyword">val</span> <a title="scala.collection.concurrent.BasicNode" id="182946">sub</a> = <a href="../../Array.scala.html#56639" title="(i: Int)scala.collection.concurrent.BasicNode">arr</a><span class="delimiter">(</span><a href="#182938" title="Int">i</a><span class="delimiter">)</span>
      <a href="#182946" title="scala.collection.concurrent.BasicNode">sub</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#3267801" title="Unit" id="3267802">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
          <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="182952">inodemain</a> = in.<a href="#181389" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">gcasRead</a><span class="delimiter">(</span><a href="#182934" title="scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span>
          <a href="../../Predef.scala.html#7484" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#182952" title="scala.collection.concurrent.MainNode[K,V]">inodemain</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
          <a href="../../Array.scala.html#56640" title="(i: Int, x: scala.collection.concurrent.BasicNode)Unit">tmparray</a><span class="delimiter">(</span><a href="#182938" title="Int">i</a><span class="delimiter">)</span> = <a href="#181688" title="(inode: scala.collection.concurrent.INode[K,V], inodemain: AnyRef)scala.collection.concurrent.BasicNode">resurrect</a><span class="delimiter">(</span>in, <a href="#182952" title="scala.collection.concurrent.MainNode[K,V]">inodemain</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="#3267801" title="Unit" id="3267803">sn</a>: SNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
          <a href="../../Array.scala.html#56640" title="(i: Int, x: scala.collection.concurrent.BasicNode)Unit">tmparray</a><span class="delimiter">(</span><a href="#182938" title="Int">i</a><span class="delimiter">)</span> = sn
      <span class="delimiter">}</span>
      <a href="#182938" title="Int">i</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>

    <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">new</span> <a href="#10013" title="scala.collection.concurrent.CNode[K,V]">CNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="#182937" title="Int">bmp</a>, <a href="#182940" title="Array[scala.collection.concurrent.BasicNode]">tmparray</a>, <a href="#182936" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>.<a href="#181689" title="(lev: Int)scala.collection.concurrent.MainNode[K,V]">toContracted</a><span class="delimiter">(</span><a href="#182935" title="Int">lev</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>concurrent<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(lev: Int)String" id="181691">string</a><span class="delimiter">(</span><a title="Int" id="183007">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <span title="String">String</span> = <a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;CNode %x\n%s&quot;</a>.<a href="../immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#181765" title="=&gt; Int">bitmap</a>, <a href="../../Predef.scala.html#7555" title="(xs: Array[scala.collection.concurrent.BasicNode])scala.collection.mutable.ArrayOps[scala.collection.concurrent.BasicNode]">array</a>.<a href="../TraversableLike.scala.html#58063" title="(f: scala.collection.concurrent.BasicNode =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Array[scala.collection.concurrent.BasicNode],String,Array[String]])Array[String]">map</a><a href="../../Predef.scala.html#7555" title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</a><a href="#183863" title="scala.collection.concurrent.BasicNode">_</a>.<a href="BasicNode.java.html#181374" title="(lev: Int)String">string</a><span class="delimiter">(</span><a href="#183007" title="Int">lev</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../TraversableOnce.scala.html#58283" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

  /* quiescently consistent - don't call concurrently to anything involving a GCAS!! */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Seq[(K, V)]" id="181692">collectElems</a>: <a href="../Seq.scala.html#4340" title="Seq[(K, V)]">Seq</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span> = <a href="../../Predef.scala.html#7555" title="(xs: Array[scala.collection.concurrent.BasicNode])scala.collection.mutable.ArrayOps[scala.collection.concurrent.BasicNode]">array</a> <a href="../TraversableLike.scala.html#58068" title="(f: scala.collection.concurrent.BasicNode =&gt; scala.collection.GenTraversableOnce[(K, V)])(implicit bf: scala.collection.generic.CanBuildFrom[Array[scala.collection.concurrent.BasicNode],(K, V),Seq[(K, V)]])Seq[(K, V)]">flatMap</a> <a href="#184367" title="scala.collection.concurrent.BasicNode" class="delimiter">{</a>
    <span class="keyword">case</span> <a href="#3267821" title="Iterable[(K, V)]" id="3267822">sn</a>: SNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="../../Option.scala.html#63128" title="(x: (K, V))Some[(K, V)]">Some</a><a href="#3267825" title="(x: Iterable[(K, V)])Iterable[(K, V)]" class="delimiter">(</a>sn.<a href="#181784" title="=&gt; (K, V)">kvPair</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="#3267821" title="Iterable[(K, V)]" id="3267823">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; in.<a href="#3267825" title="(x: Iterable[(K, V)])Iterable[(K, V)]">mainnode</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3267810" title="Iterable[(K, V)]" id="3267811">tn</a>: TNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="../../Option.scala.html#63128" title="(x: (K, V))Some[(K, V)]">Some</a><a href="#3267815" title="(x: Iterable[(K, V)])Iterable[(K, V)]" class="delimiter">(</a>tn.<a href="#181908" title="=&gt; (K, V)">kvPair</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="#3267810" title="Iterable[(K, V)]" id="3267812">ln</a>: LNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; ln.<a href="#181953" title="=&gt; scala.collection.immutable.ListMap[K,V]">listmap</a>.<a href="#3267815" title="(x: Iterable[(K, V)])Iterable[(K, V)]">toList</a>
      <span class="keyword">case</span> <a href="#3267810" title="Iterable[(K, V)]" id="3267813">cn</a>: CNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; cn.<a href="#3267815" title="(x: Iterable[(K, V)])Iterable[(K, V)]">collectElems</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Seq[String]" id="181693">collectLocalElems</a>: <a href="../Seq.scala.html#4340" title="Seq[String]">Seq</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../Predef.scala.html#7555" title="(xs: Array[scala.collection.concurrent.BasicNode])scala.collection.mutable.ArrayOps[scala.collection.concurrent.BasicNode]">array</a> <a href="../TraversableLike.scala.html#58068" title="(f: scala.collection.concurrent.BasicNode =&gt; scala.collection.GenTraversableOnce[String])(implicit bf: scala.collection.generic.CanBuildFrom[Array[scala.collection.concurrent.BasicNode],String,Seq[String]])Seq[String]">flatMap</a> <a href="#184823" title="scala.collection.concurrent.BasicNode" class="delimiter">{</a>
    <span class="keyword">case</span> <a href="#3267830" title="Iterable[String]" id="3267831">sn</a>: SNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="../../Option.scala.html#63128" title="(x: String)Some[String]">Some</a><a href="#3267834" title="(x: Iterable[String])Iterable[String]" class="delimiter">(</a>sn.<a href="#181784" title="=&gt; (K, V)">kvPair</a>.<a href="../../Tuple2.scala.html#60637" title="=&gt; V">_2</a>.<span title="()String">toString</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="#3267830" title="Iterable[String]" id="3267832">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="../../Option.scala.html#63128" title="(x: String)Some[String]">Some</a><a href="#3267834" title="(x: Iterable[String])Iterable[String]" class="delimiter">(</a>in.<a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">toString</a>.<a href="../IndexedSeqOptimized.scala.html#59163" title="(n: Int)String">drop</a><span class="delimiter">(</span><span title="Int(14)" class="int">14</span><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)String">+</span> in.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="181694">toString</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Seq[String]" id="184895">elems</a> = <a href="#181693" title="=&gt; Seq[String]">collectLocalElems</a>
    <a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;CNode(sz: %d; %s)&quot;</a>.<a href="../immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#184895" title="Seq[String]">elems</a>.<a href="../SeqLike.scala.html#58788" title="=&gt; Int">size</a>, <a href="#184895" title="Seq[String]">elems</a>.<a href="../SeqLike.scala.html#58872" title="(implicit ord: scala.math.Ordering[String])Seq[String]">sorted</a>.<a href="../TraversableOnce.scala.html#58283" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span class="keyword">private</span><span class="delimiter">[</span>concurrent<span class="delimiter">]</span> <span class="keyword">object</span> <a title="scala.collection.concurrent.CNode.type" id="10014">CNode</a> <a href="#10015" title="scala.collection.concurrent.CNode.type" class="delimiter">{</a>

  <span class="keyword">def</span> <a title="[K, V](x: scala.collection.concurrent.SNode[K,V], xhc: Int, y: scala.collection.concurrent.SNode[K,V], yhc: Int, lev: Int, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.MainNode[K,V]" id="181816">dual</a><span class="delimiter">[</span><a title="" id="181819">K</a>, <a title="" id="181820">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.concurrent.SNode[K,V]" id="181821">x</a>: <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="Int" id="181822">xhc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.SNode[K,V]" id="181823">y</a>: <a href="#9995" title="scala.collection.concurrent.SNode[K,V]">SNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="Int" id="181824">yhc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="181825">lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.Gen" id="181826">gen</a>: <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a><span class="delimiter">)</span>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <span title="scala.collection.concurrent.MainNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181825" title="Int">lev</a> <a href="../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <span title="Int(35)" class="int">35</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="184965">xidx</a> = <span class="delimiter">(</span><a href="#181822" title="Int">xhc</a> <a href="../../Int.scala.html#57090" title="(x: Int)Int">&gt;&gt;&gt;</a> <a href="#181825" title="Int">lev</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span title="Int(31)" class="int">0x1f</span>
    <span class="keyword">val</span> <a title="Int" id="184966">yidx</a> = <span class="delimiter">(</span><a href="#181824" title="Int">yhc</a> <a href="../../Int.scala.html#57090" title="(x: Int)Int">&gt;&gt;&gt;</a> <a href="#181825" title="Int">lev</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span title="Int(31)" class="int">0x1f</span>
    <span class="keyword">val</span> <a title="Int" id="184967">bmp</a> = <span class="delimiter">(</span><span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#57088" title="(x: Int)Int">&lt;&lt;</a> <a href="#184965" title="Int">xidx</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57139" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#57088" title="(x: Int)Int">&lt;&lt;</a> <a href="#184966" title="Int">yidx</a><span class="delimiter">)</span>
    <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#184965" title="Int">xidx</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#184966" title="Int">yidx</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="185000">subinode</a> = <a href="#181386" title="(g: scala.collection.concurrent.Gen)scala.collection.concurrent.INode[K,V]" class="keyword">new</a> <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="#181826" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>//(TrieMap.inodeupdater)
      <a href="#185000" title="scala.collection.concurrent.INode[K,V]">subinode</a>.<a href="INodeBase.java.html#181376" title="scala.collection.concurrent.MainNode[K,V]">mainnode</a> = <a href="#181816" title="(x: scala.collection.concurrent.SNode[K,V], xhc: Int, y: scala.collection.concurrent.SNode[K,V], yhc: Int, lev: Int, gen: scala.collection.concurrent.Gen)scala.collection.concurrent.MainNode[K,V]">dual</a><span class="delimiter">(</span><a href="#181821" title="scala.collection.concurrent.SNode[K,V]">x</a>, <a href="#181822" title="Int">xhc</a>, <a href="#181823" title="scala.collection.concurrent.SNode[K,V]">y</a>, <a href="#181824" title="Int">yhc</a>, <a href="#181825" title="Int">lev</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(5)" class="int">5</span>, <a href="#181826" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
      <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">new</span> <a href="#10013" title="scala.collection.concurrent.CNode[K,V]">CNode</a><span class="delimiter">(</span><a href="#184967" title="Int">bmp</a>, <a href="../../Array.scala.html#72260" title="(xs: scala.collection.concurrent.BasicNode*)(implicit evidence$2: scala.reflect.ClassTag[scala.collection.concurrent.BasicNode])Array[scala.collection.concurrent.BasicNode]">Array</a><a href="../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[scala.collection.concurrent.BasicNode]" class="delimiter">(</a><a href="#185000" title="scala.collection.concurrent.INode[K,V]">subinode</a><span class="delimiter">)</span>, <a href="#181826" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#184965" title="Int">xidx</a> <a href="../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="#184966" title="Int">yidx</a><span class="delimiter">)</span> <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">new</span> <a href="#10013" title="scala.collection.concurrent.CNode[K,V]">CNode</a><span class="delimiter">(</span><a href="#184967" title="Int">bmp</a>, <a href="../../Array.scala.html#72260" title="(xs: scala.collection.concurrent.BasicNode*)(implicit evidence$2: scala.reflect.ClassTag[scala.collection.concurrent.BasicNode])Array[scala.collection.concurrent.BasicNode]">Array</a><a href="../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[scala.collection.concurrent.BasicNode]" class="delimiter">(</a><a href="#181821" title="scala.collection.concurrent.SNode[K,V]">x</a>, <a href="#181823" title="scala.collection.concurrent.SNode[K,V]">y</a><span class="delimiter">)</span>, <a href="#181826" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="scala.collection.concurrent.CNode[K,V]" class="keyword">new</span> <a href="#10013" title="scala.collection.concurrent.CNode[K,V]">CNode</a><span class="delimiter">(</span><a href="#184967" title="Int">bmp</a>, <a href="../../Array.scala.html#72260" title="(xs: scala.collection.concurrent.BasicNode*)(implicit evidence$2: scala.reflect.ClassTag[scala.collection.concurrent.BasicNode])Array[scala.collection.concurrent.BasicNode]">Array</a><a href="../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[scala.collection.concurrent.BasicNode]" class="delimiter">(</a><a href="#181823" title="scala.collection.concurrent.SNode[K,V]">y</a>, <a href="#181821" title="scala.collection.concurrent.SNode[K,V]">x</a><span class="delimiter">)</span>, <a href="#181826" title="scala.collection.concurrent.Gen">gen</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
    <a href="#181926" title="(k1: K, v1: V, k2: K, v2: V)scala.collection.concurrent.LNode[K,V]" class="keyword">new</a> <a href="#9968" title="scala.collection.concurrent.LNode[K,V]">LNode</a><span class="delimiter">(</span><a href="#181821" title="scala.collection.concurrent.SNode[K,V]">x</a>.<a href="#181804" title="=&gt; K">k</a>, <a href="#181821" title="scala.collection.concurrent.SNode[K,V]">x</a>.<a href="#181805" title="=&gt; V">v</a>, <a href="#181823" title="scala.collection.concurrent.SNode[K,V]">y</a>.<a href="#181804" title="=&gt; K">k</a>, <a href="#181823" title="scala.collection.concurrent.SNode[K,V]">y</a>.<a href="#181805" title="=&gt; V">v</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>


<span title="Object" class="keyword">private</span><span class="delimiter">[</span>concurrent<span class="delimiter">]</span> case <span class="keyword">class</span> <a href="#185356" title="class RDCSS_Descriptor[K, V] extends AnyRef with Product with Serializable" id="186768">RDCSS_Descriptor</a><span class="delimiter">[</span><a title="" id="185573">K</a>, <a title="" id="185574">V</a><span class="delimiter">]</span><a href="../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="scala.collection.concurrent.INode[K,V]" id="185621">old</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.MainNode[K,V]" id="185622">expectedmain</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.INode[K,V]" id="185623">nv</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  @volatile <span class="keyword">var</span> <a title="Boolean" id="185302">committed</a> = <span title="Boolean(false)" class="keyword">false</span>
<span class="delimiter">}</span>


/** A concurrent hash-trie or TrieMap is a concurrent thread-safe lock-free
 *  implementation of a hash array mapped trie. It is used to implement the
 *  concurrent map abstraction. It has particularly scalable concurrent insert
 *  and remove operations and is memory-efficient. It supports O(1), atomic,
 *  lock-free snapshots which are used to implement linearizable lock-free size,
 *  iterator and clear operations. The cost of evaluating the (lazy) snapshot is
 *  distributed across subsequent updates, thus making snapshot evaluation horizontally scalable.
 *
 *  For details, see: http://lampwww.epfl.ch/~prokopec/ctries-snapshot.pdf
 *
 *  @author Aleksandar Prokopec
 *  @since 2.10
 */
@SerialVersionUID<span class="delimiter">(</span><span class="long">0L</span> - <span class="long">6402774413839597105L</span><span class="delimiter">)</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class TrieMap[K, V] extends AnyRef with scala.collection.concurrent.Map[K,V] with scala.collection.mutable.MapLike[K,V,scala.collection.concurrent.TrieMap[K,V]] with scala.collection.CustomParallelizable[(K, V),scala.collection.parallel.mutable.ParTrieMap[K,V]] with Serializable" id="10001">TrieMap</a><span class="delimiter">[</span><a title="" id="10100">K</a>, <a title="" id="10101">V</a><span class="delimiter">]</span> <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">private</a> <span class="delimiter">(</span><a title="AnyRef" id="185432">r</a>: <span title="AnyRef">AnyRef</span>, <a title="java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef]" id="185433">rtupd</a>: <span title="java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef]">AtomicReferenceFieldUpdater</span><span class="delimiter">[</span>TrieMap<span class="delimiter">[</span>K, V<span class="delimiter">]</span>, AnyRef<span class="delimiter">]</span>, <a title="scala.util.hashing.Hashing[K]" id="185434">hashf</a>: <a href="../../util/hashing/Hashing.scala.html#52409" title="scala.util.hashing.Hashing[K]">Hashing</a><span class="delimiter">[</span>K<span class="delimiter">]</span>, <a title="Equiv[K]" id="185435">ef</a>: <a href="../../math/Equiv.scala.html#17554" title="Equiv[K]">Equiv</a><span class="delimiter">[</span>K<span class="delimiter">]</span><span class="delimiter">)</span>
<span class="keyword">extends</span> scala.collection.concurrent.<a href="Map.scala.html#9974" title="scala.collection.concurrent.Map[K,V]">Map</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>
   <span class="keyword">with</span> scala.collection.mutable.<a href="../mutable/MapLike.scala.html#13329" title="scala.collection.mutable.MapLike[K,V,scala.collection.concurrent.TrieMap[K,V]]">MapLike</a><span class="delimiter">[</span>K, V, TrieMap<span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">]</span>
   <span class="keyword">with</span> <a href="../CustomParallelizable.scala.html#3551" title="scala.collection.CustomParallelizable[(K, V),scala.collection.parallel.mutable.ParTrieMap[K,V]]">CustomParallelizable</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span>, ParTrieMap<span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">]</span>
   <span class="keyword">with</span> <a href="../../Serializable.scala.html#891" title="Serializable">Serializable</a>
<span class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="scala.util.hashing.Hashing[K]" id="181517">hashingobj</a> = <span title="scala.util.hashing.Hashing[K]" class="keyword">if</span> <span class="delimiter">(</span><a href="#185434" title="scala.util.hashing.Hashing[K]">hashf</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span>Hashing.<a href="../../util/hashing/Hashing.scala.html#183321" title="scala.util.hashing.Hashing.Default[_]">Default</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span title="scala.collection.concurrent.TrieMap.MangledHashing[K]" class="keyword">new</span> TrieMap.<a href="#183348" title="scala.collection.concurrent.TrieMap.MangledHashing[K]">MangledHashing</a><span class="delimiter">[</span>K<span class="delimiter">]</span> <span class="keyword">else</span> <a href="#185434" title="scala.util.hashing.Hashing[K]">hashf</a>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Equiv[K]" id="181520">equalityobj</a> = <a href="#185435" title="Equiv[K]">ef</a>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef]" id="181523">rootupdater</a> = <a href="#185433" title="java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef]">rtupd</a>
  <span class="keyword">def</span> <a title="=&gt; scala.util.hashing.Hashing[K]" id="181525">hashing</a> = <a href="#181517" title="=&gt; scala.util.hashing.Hashing[K]">hashingobj</a>
  <span class="keyword">def</span> <a title="=&gt; Equiv[K]" id="181526">equality</a> = <a href="#181520" title="=&gt; Equiv[K]">equalityobj</a>
  @volatile <span class="keyword">var</span> <a title="AnyRef" id="181528">root</a> = <a href="#185432" title="AnyRef">r</a>

  <span class="keyword">def</span> <a title="(hashf: scala.util.hashing.Hashing[K], ef: Equiv[K])scala.collection.concurrent.TrieMap[K,V]" id="181530" class="keyword">this</a><span class="delimiter">(</span><a title="scala.util.hashing.Hashing[K]" id="185442">hashf</a>: <a href="../../util/hashing/Hashing.scala.html#52409" title="scala.util.hashing.Hashing[K]">Hashing</a><span class="delimiter">[</span>K<span class="delimiter">]</span>, <a title="Equiv[K]" id="185443">ef</a>: <a href="../../math/Equiv.scala.html#17554" title="Equiv[K]">Equiv</a><span class="delimiter">[</span>K<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#10001" title="TrieMap.this.type" class="keyword">this</a><span class="delimiter">(</span>
    <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182505" title="scala.collection.concurrent.INode[Nothing,Nothing]">newRootNode</a>,
    <span title="java.util.concurrent.atomic.AtomicReferenceFieldUpdater.type">AtomicReferenceFieldUpdater</span>.<span title="(x$1: Class[scala.collection.concurrent.TrieMap[K,V]], x$2: Class[AnyRef], x$3: String)java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef]">newUpdater</span><span class="delimiter">(</span>classOf<span title="Class[scala.collection.concurrent.TrieMap[K,V]](classOf[scala.collection.concurrent.TrieMap])" class="delimiter">[</span>TrieMap<span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">]</span>, classOf<span title="Class[AnyRef](classOf[java.lang.Object])" class="delimiter">[</span>AnyRef<span class="delimiter">]</span>, <span title="String(&quot;root&quot;)" class="string">&quot;root&quot;</span><span class="delimiter">)</span>,
    <a href="#185442" title="scala.util.hashing.Hashing[K]">hashf</a>,
    <a href="#185443" title="Equiv[K]">ef</a>
  <span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="()scala.collection.concurrent.TrieMap[K,V]" id="181531" class="keyword">this</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#181530" title="(hashf: scala.util.hashing.Hashing[K], ef: Equiv[K])scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">(</span><a href="../../util/hashing/Hashing.scala.html#52410" title="scala.util.hashing.Hashing.type">Hashing</a>.<a href="../../util/hashing/Hashing.scala.html#183323" title="scala.util.hashing.Hashing.Default[K]">default</a>, <a href="../../package.scala.html#55580" title="=&gt; math.Equiv.type">Equiv</a>.<a href="../../math/Equiv.scala.html#82371" title="scala.math.Equiv[K]">universal</a><span class="delimiter">)</span>

  /* internal methods */

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(out: java.io.ObjectOutputStream)Unit" id="181532">writeObject</a><span class="delimiter">(</span><a title="java.io.ObjectOutputStream" id="185472">out</a>: java.io.<span title="java.io.ObjectOutputStream">ObjectOutputStream</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#185472" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Any)Unit">writeObject</span><span class="delimiter">(</span><a href="#185434" title="scala.util.hashing.Hashing[K]">hashf</a><span class="delimiter">)</span>
    <a href="#185472" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Any)Unit">writeObject</span><span class="delimiter">(</span><a href="#185435" title="Equiv[K]">ef</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Iterator[(K, V)]" id="185474">it</a> = <a href="#181565" title="=&gt; Iterator[(K, V)]">iterator</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#185474" title="Iterator[(K, V)]">it</a>.<a href="../Iterator.scala.html#66747" title="=&gt; Boolean">hasNext</a><span class="delimiter">)</span> <a href="#185475" title="()Unit" class="delimiter">{</a>
      <span class="keyword">val</span> <a href="#3267863" title="(x: (K, V))(K, V)" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="K" id="185479">k</a>, <a href="../../Tuple2.scala.html#60637" title="V" id="185480">v</a><span class="delimiter">)</span> = <a href="#185474" title="Iterator[(K, V)]">it</a>.<a href="../Iterator.scala.html#66748" title="()(K, V)">next</a><a href="../../Tuple2.scala.html#783" title="(K, V) @unchecked" class="delimiter">(</a><span class="delimiter">)</span>
      <a href="#185472" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Any)Unit">writeObject</span><span class="delimiter">(</span><a href="#185479" title="K">k</a><span class="delimiter">)</span>
      <a href="#185472" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Any)Unit">writeObject</span><span class="delimiter">(</span><a href="#185480" title="V">v</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#185472" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Any)Unit">writeObject</span><span class="delimiter">(</span><a href="#186646" title="scala.collection.concurrent.TrieMapSerializationEnd.type">TrieMapSerializationEnd</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(in: java.io.ObjectInputStream)Unit" id="181533">readObject</a><span class="delimiter">(</span><a title="java.io.ObjectInputStream" id="185493">in</a>: java.io.<span title="java.io.ObjectInputStream">ObjectInputStream</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#181528" title="(x$1: AnyRef)Unit">root</a> = <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182505" title="scala.collection.concurrent.INode[Nothing,Nothing]">newRootNode</a>
    <a href="#181523" title="(x$1: java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef])Unit">rootupdater</a> = <span title="java.util.concurrent.atomic.AtomicReferenceFieldUpdater.type">AtomicReferenceFieldUpdater</span>.<span title="(x$1: Class[scala.collection.concurrent.TrieMap[K,V]], x$2: Class[AnyRef], x$3: String)java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef]">newUpdater</span><span class="delimiter">(</span>classOf<span title="Class[scala.collection.concurrent.TrieMap[K,V]](classOf[scala.collection.concurrent.TrieMap])" class="delimiter">[</span>TrieMap<span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">]</span>, classOf<span title="Class[AnyRef](classOf[java.lang.Object])" class="delimiter">[</span>AnyRef<span class="delimiter">]</span>, <span title="String(&quot;root&quot;)" class="string">&quot;root&quot;</span><span class="delimiter">)</span>

    <a href="#181517" title="(x$1: scala.util.hashing.Hashing[K])Unit">hashingobj</a> = <a href="#185493" title="java.io.ObjectInputStream">in</a>.<span title="()Object">readObject</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.util.hashing.Hashing[K]" class="delimiter">[</span><a href="../../util/hashing/Hashing.scala.html#52409" title="scala.util.hashing.Hashing[K]">Hashing</a><span class="delimiter">[</span>K<span class="delimiter">]</span><span class="delimiter">]</span>
    <a href="#181520" title="(x$1: Equiv[K])Unit">equalityobj</a> = <a href="#185493" title="java.io.ObjectInputStream">in</a>.<span title="()Object">readObject</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Equiv[K]" class="delimiter">[</span><a href="../../math/Equiv.scala.html#17554" title="Equiv[K]">Equiv</a><span class="delimiter">[</span>K<span class="delimiter">]</span><span class="delimiter">]</span>

    <span class="keyword">var</span> <a title="AnyRef" id="185495">obj</a>: <span title="AnyRef">AnyRef</span> = <span title="Null(null)" class="keyword">null</span>
    <a href="#185506" title="Unit" class="keyword">do</a> <span class="delimiter">{</span>
      <a href="#185495" title="AnyRef">obj</a> = <a href="#185493" title="java.io.ObjectInputStream">in</a>.<span title="()Object">readObject</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#185495" title="AnyRef">obj</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#186646" title="scala.collection.concurrent.TrieMapSerializationEnd.type">TrieMapSerializationEnd</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="K" id="185512">k</a> = <a href="#185495" title="AnyRef">obj</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="K" class="delimiter">[</span><a href="#10100" title="K">K</a><span class="delimiter">]</span>
        <span class="keyword">val</span> <a title="V" id="185513">v</a> = <a href="#185493" title="java.io.ObjectInputStream">in</a>.<span title="()Object">readObject</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="V" class="delimiter">[</span><a href="#10101" title="V">V</a><span class="delimiter">]</span>
        <a href="#181557" title="(k: K, v: V)Unit">update</a><span class="delimiter">(</span><a href="#185512" title="K">k</a>, <a href="#185513" title="V">v</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">while</span> <span class="delimiter">(</span><a href="#185495" title="AnyRef">obj</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#186646" title="scala.collection.concurrent.TrieMapSerializationEnd.type">TrieMapSerializationEnd</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ov: AnyRef, nv: AnyRef)Boolean" id="181534">CAS_ROOT</a><span class="delimiter">(</span><a title="AnyRef" id="185524">ov</a>: <span title="AnyRef">AnyRef</span>, <a title="AnyRef" id="185525">nv</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span> = <a href="#181523" title="=&gt; java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef]">rootupdater</a>.<span title="(x$1: scala.collection.concurrent.TrieMap[K,V], x$2: AnyRef, x$3: AnyRef)Boolean">compareAndSet</span><span class="delimiter">(</span><a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a>, <a href="#185524" title="AnyRef">ov</a>, <a href="#185525" title="AnyRef">nv</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(abort: Boolean)scala.collection.concurrent.INode[K,V]" id="181535">readRoot</a><span class="delimiter">(</span><a title="Boolean" id="181580">abort</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <a href="#181536" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_READ_ROOT</a><span class="delimiter">(</span><a href="#181580" title="Boolean">abort</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(abort: Boolean)scala.collection.concurrent.INode[K,V]" id="181536">RDCSS_READ_ROOT</a><span class="delimiter">(</span><a title="Boolean" id="185533">abort</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="AnyRef" id="185534">r</a> = /*READ*/<a href="#181528" title="=&gt; AnyRef">root</a>
    <a href="#185534" title="AnyRef">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3267867" title="scala.collection.concurrent.INode[K,V]" id="3267868">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="#3267871" title="(x: scala.collection.concurrent.INode[K,V])scala.collection.concurrent.INode[K,V]">in</a>
      <span class="keyword">case</span> <a href="#3267867" title="scala.collection.concurrent.INode[K,V]" id="3267869">desc</a>: RDCSS_Descriptor<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="#181537" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_Complete</a><a href="#3267871" title="(x: scala.collection.concurrent.INode[K,V])scala.collection.concurrent.INode[K,V]" class="delimiter">(</a><a href="#185533" title="Boolean">abort</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  @tailrec <span class="keyword">private</span> <span class="keyword">def</span> <a title="(abort: Boolean)scala.collection.concurrent.INode[K,V]" id="181537">RDCSS_Complete</a><span class="delimiter">(</span><a title="Boolean" id="185545">abort</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="AnyRef" id="185547">v</a> = /*READ*/<a href="#181528" title="=&gt; AnyRef">root</a>
    <a href="#185547" title="AnyRef">v</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3267882" title="scala.collection.concurrent.INode[K,V]" id="3267883">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt; <a href="#3267886" title="(x: scala.collection.concurrent.INode[K,V])scala.collection.concurrent.INode[K,V]">in</a>
      <span class="keyword">case</span> <a href="#3267882" title="scala.collection.concurrent.INode[K,V]" id="3267884">desc</a>: RDCSS_Descriptor<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
        <span class="keyword">val</span> RDCSS_Descriptor<a href="#3267878" title="(x: (scala.collection.concurrent.INode[K,V], scala.collection.concurrent.MainNode[K,V], scala.collection.concurrent.INode[K,V]))(scala.collection.concurrent.INode[K,V], scala.collection.concurrent.MainNode[K,V], scala.collection.concurrent.INode[K,V])" class="delimiter">(</a><a href="#185621" title="scala.collection.concurrent.INode[K,V]" id="185559">ov</a>, <a href="#185622" title="scala.collection.concurrent.MainNode[K,V]" id="185560">exp</a>, <a href="#185623" title="scala.collection.concurrent.INode[K,V]" id="185561">nv</a><span class="delimiter">)</span> = <a href="#186768" title="scala.collection.concurrent.RDCSS_Descriptor[K,V] @unchecked">desc</a>
        <span title="scala.collection.concurrent.INode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#185545" title="Boolean">abort</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="scala.collection.concurrent.INode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181534" title="(ov: AnyRef, nv: AnyRef)Boolean">CAS_ROOT</a><span class="delimiter">(</span>desc, <a href="#185559" title="scala.collection.concurrent.INode[K,V]">ov</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#185559" title="scala.collection.concurrent.INode[K,V]">ov</a>
          <span class="keyword">else</span> <a href="#181537" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_Complete</a><span class="delimiter">(</span><a href="#185545" title="Boolean">abort</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="185614">oldmain</a> = <a href="#185559" title="scala.collection.concurrent.INode[K,V]">ov</a>.<a href="#181389" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">gcasRead</a><span class="delimiter">(</span><a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>
          <span title="scala.collection.concurrent.INode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#185614" title="scala.collection.concurrent.MainNode[K,V]">oldmain</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#185560" title="scala.collection.concurrent.MainNode[K,V]">exp</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="scala.collection.concurrent.INode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181534" title="(ov: AnyRef, nv: AnyRef)Boolean">CAS_ROOT</a><span class="delimiter">(</span>desc, <a href="#185561" title="scala.collection.concurrent.INode[K,V]">nv</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              desc.<a href="#185302" title="(x$1: Boolean)Unit">committed</a> = <span title="Boolean(true)" class="keyword">true</span>
              <a href="#185561" title="scala.collection.concurrent.INode[K,V]">nv</a>
            <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#181537" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_Complete</a><span class="delimiter">(</span><a href="#185545" title="Boolean">abort</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <span title="scala.collection.concurrent.INode[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181534" title="(ov: AnyRef, nv: AnyRef)Boolean">CAS_ROOT</a><span class="delimiter">(</span>desc, <a href="#185559" title="scala.collection.concurrent.INode[K,V]">ov</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#185559" title="scala.collection.concurrent.INode[K,V]">ov</a>
            <span class="keyword">else</span> <a href="#181537" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_Complete</a><span class="delimiter">(</span><a href="#185545" title="Boolean">abort</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ov: scala.collection.concurrent.INode[K,V], expectedmain: scala.collection.concurrent.MainNode[K,V], nv: scala.collection.concurrent.INode[K,V])Boolean" id="181538">RDCSS_ROOT</a><span class="delimiter">(</span><a title="scala.collection.concurrent.INode[K,V]" id="185616">ov</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.MainNode[K,V]" id="185617">expectedmain</a>: <a href="MainNode.java.html#9998" title="scala.collection.concurrent.MainNode[K,V]">MainNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="scala.collection.concurrent.INode[K,V]" id="185618">nv</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.RDCSS_Descriptor[K,V]" id="185620">desc</a> = <a href="#186768" title="(old: scala.collection.concurrent.INode[K,V], expectedmain: scala.collection.concurrent.MainNode[K,V], nv: scala.collection.concurrent.INode[K,V])scala.collection.concurrent.RDCSS_Descriptor[K,V]">RDCSS_Descriptor</a><span class="delimiter">(</span><a href="#185616" title="scala.collection.concurrent.INode[K,V]">ov</a>, <a href="#185617" title="scala.collection.concurrent.MainNode[K,V]">expectedmain</a>, <a href="#185618" title="scala.collection.concurrent.INode[K,V]">nv</a><span class="delimiter">)</span>
    <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#181534" title="(ov: AnyRef, nv: AnyRef)Boolean">CAS_ROOT</a><span class="delimiter">(</span><a href="#185616" title="scala.collection.concurrent.INode[K,V]">ov</a>, <a href="#185620" title="scala.collection.concurrent.RDCSS_Descriptor[K,V]">desc</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#181537" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_Complete</a><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
      /*READ*/<a href="#185620" title="scala.collection.concurrent.RDCSS_Descriptor[K,V]">desc</a>.<a href="#185302" title="=&gt; Boolean">committed</a>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
  <span class="delimiter">}</span>

  @tailrec <span class="keyword">private</span> <span class="keyword">def</span> <a title="(k: K, hc: Int, v: V)Unit" id="181539">inserthc</a><span class="delimiter">(</span><a title="K" id="185635">k</a>: <a href="#10100" title="K">K</a>, <a title="Int" id="185636">hc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="V" id="185637">v</a>: <a href="#10101" title="V">V</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="185639">r</a> = <a href="#181536" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_READ_ROOT</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#185639" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181396" title="(k: K, v: V, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Boolean">rec_insert</a><span class="delimiter">(</span><a href="#185635" title="K">k</a>, <a href="#185637" title="V">v</a>, <a href="#185636" title="Int">hc</a>, <span title="Int(0)" class="int">0</span>, <span title="Null(null)" class="keyword">null</span>, <a href="#185639" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a>, <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#181539" title="(k: K, hc: Int, v: V)Unit">inserthc</a><span class="delimiter">(</span><a href="#185635" title="K">k</a>, <a href="#185636" title="Int">hc</a>, <a href="#185637" title="V">v</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  @tailrec <span class="keyword">private</span> <span class="keyword">def</span> <a title="(k: K, hc: Int, v: V, cond: AnyRef)Option[V]" id="181540">insertifhc</a><span class="delimiter">(</span><a title="K" id="185649">k</a>: <a href="#10100" title="K">K</a>, <a title="Int" id="185650">hc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="V" id="185651">v</a>: <a href="#10101" title="V">V</a>, <a title="AnyRef" id="185652">cond</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <a href="../../Option.scala.html#978" title="Option[V]">Option</a><span class="delimiter">[</span>V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="185654">r</a> = <a href="#181536" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_READ_ROOT</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Option[V]" id="185655">ret</a> = <a href="#185654" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181397" title="(k: K, v: V, hc: Int, cond: AnyRef, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Option[V]">rec_insertif</a><span class="delimiter">(</span><a href="#185649" title="K">k</a>, <a href="#185651" title="V">v</a>, <a href="#185650" title="Int">hc</a>, <a href="#185652" title="AnyRef">cond</a>, <span title="Int(0)" class="int">0</span>, <span title="Null(null)" class="keyword">null</span>, <a href="#185654" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a>, <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>
    <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#185655" title="Option[V]">ret</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#181540" title="(k: K, hc: Int, v: V, cond: AnyRef)Option[V]">insertifhc</a><span class="delimiter">(</span><a href="#185649" title="K">k</a>, <a href="#185650" title="Int">hc</a>, <a href="#185651" title="V">v</a>, <a href="#185652" title="AnyRef">cond</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#185655" title="Option[V]">ret</a>
  <span class="delimiter">}</span>

  @tailrec <span class="keyword">private</span> <span class="keyword">def</span> <a title="(k: K, hc: Int)AnyRef" id="181541">lookuphc</a><span class="delimiter">(</span><a title="K" id="185664">k</a>: <a href="#10100" title="K">K</a>, <a title="Int" id="185665">hc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="185667">r</a> = <a href="#181536" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_READ_ROOT</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="AnyRef" id="185668">res</a> = <a href="#185667" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181398" title="(k: K, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])AnyRef">rec_lookup</a><span class="delimiter">(</span><a href="#185664" title="K">k</a>, <a href="#185665" title="Int">hc</a>, <span title="Int(0)" class="int">0</span>, <span title="Null(null)" class="keyword">null</span>, <a href="#185667" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a>, <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>
    <span title="AnyRef" class="keyword">if</span> <span class="delimiter">(</span><a href="#185668" title="AnyRef">res</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="INodeBase.java.html#10011" title="scala.collection.concurrent.INodeBase.type">INodeBase</a>.<a href="INodeBase.java.html#181422" title="Object">RESTART</a><span class="delimiter">)</span> <a href="#181541" title="(k: K, hc: Int)AnyRef">lookuphc</a><span class="delimiter">(</span><a href="#185664" title="K">k</a>, <a href="#185665" title="Int">hc</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#185668" title="AnyRef">res</a>
  <span class="delimiter">}</span>

  /* slower:
  //@tailrec
  private def lookuphc(k: K, hc: Int): AnyRef = {
    val r = RDCSS_READ_ROOT()
    try {
      r.rec_lookup(k, hc, 0, null, r.gen, this)
    } catch {
      case RestartException =&gt;
        lookuphc(k, hc)
    }
  }
  */

  @tailrec <span class="keyword">private</span> <span class="keyword">def</span> <a title="(k: K, v: V, hc: Int)Option[V]" id="181542">removehc</a><span class="delimiter">(</span><a title="K" id="185675">k</a>: <a href="#10100" title="K">K</a>, <a title="V" id="185676">v</a>: <a href="#10101" title="V">V</a>, <a title="Int" id="185677">hc</a>: <a href="../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <a href="../../Option.scala.html#978" title="Option[V]">Option</a><span class="delimiter">[</span>V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="185679">r</a> = <a href="#181536" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_READ_ROOT</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Option[V]" id="185680">res</a> = <a href="#185679" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181399" title="(k: K, v: V, hc: Int, lev: Int, parent: scala.collection.concurrent.INode[K,V], startgen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])Option[V]">rec_remove</a><span class="delimiter">(</span><a href="#185675" title="K">k</a>, <a href="#185676" title="V">v</a>, <a href="#185677" title="Int">hc</a>, <span title="Int(0)" class="int">0</span>, <span title="Null(null)" class="keyword">null</span>, <a href="#185679" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="INodeBase.java.html#181377" title="scala.collection.concurrent.Gen">gen</a>, <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>
    <span title="Option[V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#185680" title="Option[V]">res</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#185680" title="Option[V]">res</a>
    <span class="keyword">else</span> <a href="#181542" title="(k: K, v: V, hc: Int)Option[V]">removehc</a><span class="delimiter">(</span><a href="#185675" title="K">k</a>, <a href="#185676" title="V">v</a>, <a href="#185677" title="Int">hc</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; String" id="181543">string</a> = <a href="#181536" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_READ_ROOT</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="#181403" title="(lev: Int)String">string</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

  /* public methods */

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.concurrent.TrieMap[K,V]" id="181544">seq</a> = <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.parallel.mutable.ParTrieMap[K,V]" id="181545">par</a> = <span title="scala.collection.parallel.mutable.ParTrieMap[K,V]" class="keyword">new</span> <a href="../parallel/mutable/ParTrieMap.scala.html#15754" title="scala.collection.parallel.mutable.ParTrieMap[K,V]">ParTrieMap</a><span class="delimiter">(</span><a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.concurrent.TrieMap[K,V]" id="181546">empty</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <a href="#181531" title="()scala.collection.concurrent.TrieMap[K,V]" class="keyword">new</a> <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="181547">isReadOnly</a> = <a href="#181523" title="=&gt; java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef]">rootupdater</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="181548">nonReadOnly</a> = <a href="#181523" title="=&gt; java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef]">rootupdater</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span>

  /** Returns a snapshot of this TrieMap.
   *  This operation is lock-free and linearizable.
   *
   *  The snapshot is lazily updated - the first time some branch
   *  in the snapshot or this TrieMap are accessed, they are rewritten.
   *  This means that the work of rebuilding both the snapshot and this
   *  TrieMap is distributed across all the threads doing updates or accesses
   *  subsequent to the snapshot creation.
   */
  @tailrec <span class="keyword">def</span> <a title="()scala.collection.concurrent.TrieMap[K,V]" id="181549">snapshot</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="185804">r</a> = <a href="#181536" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_READ_ROOT</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="185805">expmain</a> = <a href="#185804" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181389" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">gcasRead</a><span class="delimiter">(</span><a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>
    <span title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181538" title="(ov: scala.collection.concurrent.INode[K,V], expectedmain: scala.collection.concurrent.MainNode[K,V], nv: scala.collection.concurrent.INode[K,V])Boolean">RDCSS_ROOT</a><span class="delimiter">(</span><a href="#185804" title="scala.collection.concurrent.INode[K,V]">r</a>, <a href="#185805" title="scala.collection.concurrent.MainNode[K,V]">expmain</a>, <a href="#185804" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181395" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.INode[K,V]">copyToGen</a><span class="delimiter">(</span><span title="scala.collection.concurrent.Gen" class="keyword">new</span> <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a>, <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">new</span> <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">(</span><a href="#185804" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181395" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.INode[K,V]">copyToGen</a><span class="delimiter">(</span><span title="scala.collection.concurrent.Gen" class="keyword">new</span> <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a>, <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>, <a href="#181523" title="=&gt; java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.TrieMap[K,V],AnyRef]">rootupdater</a>, <a href="#181525" title="=&gt; scala.util.hashing.Hashing[K]">hashing</a>, <a href="#181526" title="=&gt; Equiv[K]">equality</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#181549" title="()scala.collection.concurrent.TrieMap[K,V]">snapshot</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Returns a read-only snapshot of this TrieMap.
   *  This operation is lock-free and linearizable.
   *
   *  The snapshot is lazily updated - the first time some branch
   *  of this TrieMap are accessed, it is rewritten. The work of creating
   *  the snapshot is thus distributed across subsequent updates
   *  and accesses on this TrieMap by all threads.
   *  Note that the snapshot itself is never rewritten unlike when calling
   *  the `snapshot` method, but the obtained snapshot cannot be modified.
   *
   *  This method is used by other methods such as `size` and `iterator`.
   */
  @tailrec <span class="keyword">def</span> <a title="()scala.collection.Map[K,V]" id="181550">readOnlySnapshot</a><span class="delimiter">(</span><span class="delimiter">)</span>: scala.collection.<a href="../Map.scala.html#3509" title="scala.collection.Map[K,V]">Map</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="185824">r</a> = <a href="#181536" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_READ_ROOT</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.MainNode[K,V]" id="185825">expmain</a> = <a href="#185824" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181389" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">gcasRead</a><span class="delimiter">(</span><a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>
    <span title="scala.collection.Map[K,V]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181538" title="(ov: scala.collection.concurrent.INode[K,V], expectedmain: scala.collection.concurrent.MainNode[K,V], nv: scala.collection.concurrent.INode[K,V])Boolean">RDCSS_ROOT</a><span class="delimiter">(</span><a href="#185824" title="scala.collection.concurrent.INode[K,V]">r</a>, <a href="#185825" title="scala.collection.concurrent.MainNode[K,V]">expmain</a>, <a href="#185824" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181395" title="(ngen: scala.collection.concurrent.Gen, ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.INode[K,V]">copyToGen</a><span class="delimiter">(</span><span title="scala.collection.concurrent.Gen" class="keyword">new</span> <a href="Gen.java.html#10052" title="scala.collection.concurrent.Gen">Gen</a>, <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="scala.collection.concurrent.TrieMap[K,Nothing]" class="keyword">new</span> <a href="#10001" title="scala.collection.concurrent.TrieMap[K,Nothing]">TrieMap</a><span class="delimiter">(</span><a href="#185824" title="scala.collection.concurrent.INode[K,V]">r</a>, <span title="Null(null)" class="keyword">null</span>, <a href="#181525" title="=&gt; scala.util.hashing.Hashing[K]">hashing</a>, <a href="#181526" title="=&gt; Equiv[K]">equality</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#181550" title="()scala.collection.Map[K,V]">readOnlySnapshot</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  @tailrec <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="181551">clear</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="185862">r</a> = <a href="#181536" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_READ_ROOT</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#181538" title="(ov: scala.collection.concurrent.INode[K,V], expectedmain: scala.collection.concurrent.MainNode[K,V], nv: scala.collection.concurrent.INode[K,V])Boolean">RDCSS_ROOT</a><span class="delimiter">(</span><a href="#185862" title="scala.collection.concurrent.INode[K,V]">r</a>, <a href="#185862" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181389" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">gcasRead</a><span class="delimiter">(</span><a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>, <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182505" title="[K, V]=&gt; scala.collection.concurrent.INode[K,V]">newRootNode</a><span title="scala.collection.concurrent.INode[K,V]" class="delimiter">[</span><a href="#10100" title="K">K</a>, <a href="#10101" title="V">V</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#181551" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>


  <span class="keyword">def</span> <a title="(k: K)Int" id="181552">computeHash</a><span class="delimiter">(</span><a title="K" id="183315">k</a>: <a href="#10100" title="K">K</a><span class="delimiter">)</span> = <a href="#181517" title="=&gt; scala.util.hashing.Hashing[K]">hashingobj</a>.<a href="../../util/hashing/Hashing.scala.html#183318" title="(x: K)Int">hash</a><span class="delimiter">(</span><a href="#183315" title="K">k</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(k: K)V" id="181553">lookup</a><span class="delimiter">(</span><a title="K" id="185864">k</a>: <a href="#10100" title="K">K</a><span class="delimiter">)</span>: <a href="#10101" title="V">V</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="185866">hc</a> = <a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#185864" title="K">k</a><span class="delimiter">)</span>
    <a href="#181541" title="(k: K, hc: Int)AnyRef">lookuphc</a><span class="delimiter">(</span><a href="#185864" title="K">k</a>, <a href="#185866" title="Int">hc</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="V" class="delimiter">[</span><a href="#10101" title="V">V</a><span class="delimiter">]</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(k: K)V" id="181554">apply</a><span class="delimiter">(</span><a title="K" id="185867">k</a>: <a href="#10100" title="K">K</a><span class="delimiter">)</span>: <a href="#10101" title="V">V</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="185873">hc</a> = <a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#185867" title="K">k</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="AnyRef" id="185874">res</a> = <a href="#181541" title="(k: K, hc: Int)AnyRef">lookuphc</a><span class="delimiter">(</span><a href="#185867" title="K">k</a>, <a href="#185873" title="Int">hc</a><span class="delimiter">)</span>
    <span title="V" class="keyword">if</span> <span class="delimiter">(</span><a href="#185874" title="AnyRef">res</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <span title="java.util.NoSuchElementException" class="keyword">new</span> <a href="../../package.scala.html#55510" title="java.util.NoSuchElementException">NoSuchElementException</a>
    <span class="keyword">else</span> <a href="#185874" title="AnyRef">res</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="V" class="delimiter">[</span><a href="#10101" title="V">V</a><span class="delimiter">]</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(k: K)Option[V]" id="181555">get</a><span class="delimiter">(</span><a title="K" id="185877">k</a>: <a href="#10100" title="K">K</a><span class="delimiter">)</span>: <a href="../../Option.scala.html#978" title="Option[V]">Option</a><span class="delimiter">[</span>V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="185882">hc</a> = <a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#185877" title="K">k</a><span class="delimiter">)</span>
    <a href="../../Option.scala.html#97399" title="(x: AnyRef)Option[AnyRef]">Option</a><span class="delimiter">(</span><a href="#181541" title="(k: K, hc: Int)AnyRef">lookuphc</a><span class="delimiter">(</span><a href="#185877" title="K">k</a>, <a href="#185882" title="Int">hc</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Option[V]" class="delimiter">[</span><a href="../../Option.scala.html#978" title="Option[V]">Option</a><span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(key: K, value: V)Option[V]" id="181556">put</a><span class="delimiter">(</span><a title="K" id="185886">key</a>: <a href="#10100" title="K">K</a>, <a title="V" id="185887">value</a>: <a href="#10101" title="V">V</a><span class="delimiter">)</span>: <a href="../../Option.scala.html#978" title="Option[V]">Option</a><span class="delimiter">[</span>V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="185894">hc</a> = <a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#185886" title="K">key</a><span class="delimiter">)</span>
    <a href="#181540" title="(k: K, hc: Int, v: V, cond: AnyRef)Option[V]">insertifhc</a><span class="delimiter">(</span><a href="#185886" title="K">key</a>, <a href="#185894" title="Int">hc</a>, <a href="#185887" title="V">value</a>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(k: K, v: V)Unit" id="181557">update</a><span class="delimiter">(</span><a title="K" id="185514">k</a>: <a href="#10100" title="K">K</a>, <a title="V" id="185515">v</a>: <a href="#10101" title="V">V</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="185895">hc</a> = <a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#185514" title="K">k</a><span class="delimiter">)</span>
    <a href="#181539" title="(k: K, hc: Int, v: V)Unit">inserthc</a><span class="delimiter">(</span><a href="#185514" title="K">k</a>, <a href="#185895" title="Int">hc</a>, <a href="#185515" title="V">v</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(kv: (K, V))TrieMap.this.type" id="181558">+=</a><span class="delimiter">(</span><a title="(K, V)" id="185896">kv</a>: <a href="../../Tuple2.scala.html#783" title="(K, V)" class="delimiter">(</a>K, V<span class="delimiter">)</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#181557" title="(k: K, v: V)Unit">update</a><span class="delimiter">(</span><a href="#185896" title="(K, V)">kv</a>.<a href="../../Tuple2.scala.html#60635" title="=&gt; K">_1</a>, <a href="#185896" title="(K, V)">kv</a>.<a href="../../Tuple2.scala.html#60637" title="=&gt; V">_2</a><span class="delimiter">)</span>
    <a href="#10001" title="TrieMap.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(k: K)Option[V]" id="181559">remove</a><span class="delimiter">(</span><a title="K" id="185921">k</a>: <a href="#10100" title="K">K</a><span class="delimiter">)</span>: <a href="../../Option.scala.html#978" title="Option[V]">Option</a><span class="delimiter">[</span>V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="185930">hc</a> = <a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#185921" title="K">k</a><span class="delimiter">)</span>
    <a href="#181542" title="(k: K, v: V, hc: Int)Option[V]">removehc</a><span class="delimiter">(</span><a href="#185921" title="K">k</a>, <span title="Null(null)" class="keyword">null</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="V" class="delimiter">[</span><a href="#10101" title="V">V</a><span class="delimiter">]</span>, <a href="#185930" title="Int">hc</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(k: K)TrieMap.this.type" id="181560">-=</a><span class="delimiter">(</span><a title="K" id="185931">k</a>: <a href="#10100" title="K">K</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#181559" title="(k: K)Option[V]">remove</a><span class="delimiter">(</span><a href="#185931" title="K">k</a><span class="delimiter">)</span>
    <a href="#10001" title="TrieMap.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(k: K, v: V)Option[V]" id="181561">putIfAbsent</a><span class="delimiter">(</span><a title="K" id="185968">k</a>: <a href="#10100" title="K">K</a>, <a title="V" id="185969">v</a>: <a href="#10101" title="V">V</a><span class="delimiter">)</span>: <a href="../../Option.scala.html#978" title="Option[V]">Option</a><span class="delimiter">[</span>V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="185973">hc</a> = <a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#185968" title="K">k</a><span class="delimiter">)</span>
    <a href="#181540" title="(k: K, hc: Int, v: V, cond: AnyRef)Option[V]">insertifhc</a><span class="delimiter">(</span><a href="#185968" title="K">k</a>, <a href="#185973" title="Int">hc</a>, <a href="#185969" title="V">v</a>, <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182503" title="=&gt; Object">KEY_ABSENT</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(k: K, v: V)Boolean" id="181562">remove</a><span class="delimiter">(</span><a title="K" id="185954">k</a>: <a href="#10100" title="K">K</a>, <a title="V" id="185955">v</a>: <a href="#10101" title="V">V</a><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="185974">hc</a> = <a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#185954" title="K">k</a><span class="delimiter">)</span>
    <a href="#181542" title="(k: K, v: V, hc: Int)Option[V]">removehc</a><span class="delimiter">(</span><a href="#185954" title="K">k</a>, <a href="#185955" title="V">v</a>, <a href="#185974" title="Int">hc</a><span class="delimiter">)</span>.<a href="../../Option.scala.html#62879" title="=&gt; Boolean">nonEmpty</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(k: K, oldvalue: V, newvalue: V)Boolean" id="181563">replace</a><span class="delimiter">(</span><a title="K" id="185975">k</a>: <a href="#10100" title="K">K</a>, <a title="V" id="185976">oldvalue</a>: <a href="#10101" title="V">V</a>, <a title="V" id="185977">newvalue</a>: <a href="#10101" title="V">V</a><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="185985">hc</a> = <a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#185975" title="K">k</a><span class="delimiter">)</span>
    <a href="#181540" title="(k: K, hc: Int, v: V, cond: AnyRef)Option[V]">insertifhc</a><span class="delimiter">(</span><a href="#185975" title="K">k</a>, <a href="#185985" title="Int">hc</a>, <a href="#185977" title="V">newvalue</a>, <a href="#185976" title="V">oldvalue</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span class="delimiter">)</span>.<a href="../../Option.scala.html#62879" title="=&gt; Boolean">nonEmpty</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(k: K, v: V)Option[V]" id="181564">replace</a><span class="delimiter">(</span><a title="K" id="185986">k</a>: <a href="#10100" title="K">K</a>, <a title="V" id="185987">v</a>: <a href="#10101" title="V">V</a><span class="delimiter">)</span>: <a href="../../Option.scala.html#978" title="Option[V]">Option</a><span class="delimiter">[</span>V<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="185990">hc</a> = <a href="#181552" title="(k: K)Int">computeHash</a><span class="delimiter">(</span><a href="#185986" title="K">k</a><span class="delimiter">)</span>
    <a href="#181540" title="(k: K, hc: Int, v: V, cond: AnyRef)Option[V]">insertifhc</a><span class="delimiter">(</span><a href="#185986" title="K">k</a>, <a href="#185990" title="Int">hc</a>, <a href="#185987" title="V">v</a>, <a href="#10008" title="scala.collection.concurrent.INode.type">INode</a>.<a href="#182501" title="=&gt; Object">KEY_PRESENT</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Iterator[(K, V)]" id="181565">iterator</a>: <a href="../Iterator.scala.html#4100" title="Iterator[(K, V)]">Iterator</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span> =
    <span title="Iterator[(K, V)]" class="keyword">if</span> <span class="delimiter">(</span><a href="#181548" title="=&gt; Boolean">nonReadOnly</a><span class="delimiter">)</span> <a href="#181550" title="()scala.collection.Map[K,V]">readOnlySnapshot</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="../MapLike.scala.html#87526" title="=&gt; Iterator[(K, V)]">iterator</a>
    <span class="keyword">else</span> <a href="#186039" title="scala.collection.concurrent.TrieMapIterator[K,V]" class="keyword">new</a> <a href="#10017" title="scala.collection.concurrent.TrieMapIterator[K,V]">TrieMapIterator</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Int" id="181566">cachedSize</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="186062">r</a> = <a href="#181536" title="(abort: Boolean)scala.collection.concurrent.INode[K,V]">RDCSS_READ_ROOT</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#186062" title="scala.collection.concurrent.INode[K,V]">r</a>.<a href="#181402" title="(ct: scala.collection.concurrent.TrieMap[K,V])Int">cachedSize</a><span class="delimiter">(</span><a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="181567">size</a>: <a href="../../Int.scala.html#321" title="Int">Int</a> =
    <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#181548" title="=&gt; Boolean">nonReadOnly</a><span class="delimiter">)</span> <a href="#181550" title="()scala.collection.Map[K,V]">readOnlySnapshot</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="../TraversableOnce.scala.html#58190" title="=&gt; Int">size</a>
    <span class="keyword">else</span> <a href="#181566" title="()Int">cachedSize</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="181568">stringPrefix</a> = <span title="String(&quot;TrieMap&quot;)" class="string">&quot;TrieMap&quot;</span>

<span class="delimiter">}</span>


<span class="keyword">object</span> <a title="scala.collection.concurrent.TrieMap.type" id="186128">TrieMap</a> <a href="#10003" title="scala.collection.concurrent.TrieMap.type" class="keyword">extends</a> <a href="../generic/MutableMapFactory.scala.html#10633" title="scala.collection.generic.MutableMapFactory[scala.collection.concurrent.TrieMap]">MutableMapFactory</a><span class="delimiter">[</span>TrieMap<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.INodeBase[_, _],scala.collection.concurrent.MainNode[_, _]]" id="183336">inodeupdater</a> = <span title="java.util.concurrent.atomic.AtomicReferenceFieldUpdater.type">AtomicReferenceFieldUpdater</span>.<span title="(x$1: Class[scala.collection.concurrent.INodeBase[_, _]], x$2: Class[scala.collection.concurrent.MainNode[_, _]], x$3: String)java.util.concurrent.atomic.AtomicReferenceFieldUpdater[scala.collection.concurrent.INodeBase[_, _],scala.collection.concurrent.MainNode[_, _]]">newUpdater</span><span class="delimiter">(</span>classOf<span title="Class[scala.collection.concurrent.INodeBase[_, _]](classOf[scala.collection.concurrent.INodeBase])" class="delimiter">[</span>INodeBase<span class="delimiter">[</span>_, _<span class="delimiter">]</span><span class="delimiter">]</span>, classOf<span title="Class[scala.collection.concurrent.MainNode[_, _]](classOf[scala.collection.concurrent.MainNode])" class="delimiter">[</span>MainNode<span class="delimiter">[</span>_, _<span class="delimiter">]</span><span class="delimiter">]</span>, <span title="String(&quot;mainnode&quot;)" class="string">&quot;mainnode&quot;</span><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[K, V]=&gt; scala.collection.generic.CanBuildFrom[scala.collection.concurrent.TrieMap.Coll,(K, V),scala.collection.concurrent.TrieMap[K,V]]" id="183338">canBuildFrom</a><span class="delimiter">[</span><a title="" id="183341">K</a>, <a title="" id="183342">V</a><span class="delimiter">]</span>: <a href="../generic/CanBuildFrom.scala.html#10687" title="scala.collection.generic.CanBuildFrom[scala.collection.concurrent.TrieMap.Coll,(K, V),scala.collection.concurrent.TrieMap[K,V]]">CanBuildFrom</a><span class="delimiter">[</span>Coll, <span class="delimiter">(</span>K, V<span class="delimiter">)</span>, TrieMap<span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="scala.collection.concurrent.TrieMap.MapCanBuildFrom[K,V]" class="keyword">new</span> <a href="../generic/GenMapFactory.scala.html#60754" title="scala.collection.concurrent.TrieMap.MapCanBuildFrom[K,V]">MapCanBuildFrom</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="[K, V]=&gt; scala.collection.concurrent.TrieMap[K,V]" id="183343">empty</a><span class="delimiter">[</span><a title="" id="183346">K</a>, <a title="" id="183347">V</a><span class="delimiter">]</span>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <a href="#181531" title="()scala.collection.concurrent.TrieMap[K,V]" class="keyword">new</a> <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>

  <span class="keyword">class</span> <a title="class MangledHashing[K] extends AnyRef with scala.util.hashing.Hashing[K]" id="183348">MangledHashing</a><span class="delimiter">[</span><a title="" id="183349">K</a><span class="delimiter">]</span> <a href="#183348" title="scala.collection.concurrent.TrieMap.MangledHashing[K]" class="keyword">extends</a> <a href="../../util/hashing/Hashing.scala.html#52409" title="scala.util.hashing.Hashing[K]">Hashing</a><span class="delimiter">[</span>K<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(k: K)Int" id="183351">hash</a><span class="delimiter">(</span><a title="K" id="186123">k</a>: <a href="#183349" title="K">K</a><span class="delimiter">)</span>= scala.util.hashing.<a href="../../util/hashing/package.scala.html#55998" title="(v: Int)Int">byteswap32</a><span class="delimiter">(</span><a href="#186123" title="K">k</a>.<span title="()Int">##</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>


<span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class TrieMapIterator[K, V] extends AnyRef with Iterator[(K, V)]" id="10017">TrieMapIterator</a><span class="delimiter">[</span><a title="" id="186042">K</a>, <a title="" id="186043">V</a><span class="delimiter">]</span><a href="#10017" title="scala.collection.concurrent.TrieMapIterator[K,V]" class="delimiter">(</a><span class="keyword">var</span> <a title="Int" id="186035">level</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <span class="keyword">private</span> <span class="keyword">var</span> <a title="scala.collection.concurrent.TrieMap[K,V]" id="186036">ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="Boolean" id="186039">mustInit</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../Iterator.scala.html#4100" title="Iterator[(K, V)]">Iterator</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Array[Array[scala.collection.concurrent.BasicNode]]" id="186009">stack</a> = <span title="Array[Array[scala.collection.concurrent.BasicNode]]" class="keyword">new</span> <a href="../../Array.scala.html#174" title="Array[Array[scala.collection.concurrent.BasicNode]]">Array</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>BasicNode<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(7)" class="int">7</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Array[Int]" id="186012">stackpos</a> = <span title="Array[Int]" class="keyword">new</span> <a href="../../Array.scala.html#174" title="Array[Int]">Array</a><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(7)" class="int">7</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="186015">depth</a> = -<span title="Int(-1)" class="int">1</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Iterator[(K, V)]" id="186018">subiter</a>: <a href="../Iterator.scala.html#4100" title="Iterator[(K, V)]">Iterator</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="scala.collection.concurrent.KVNode[K,V]" id="186021">current</a>: <a href="#10022" title="scala.collection.concurrent.KVNode[K,V]">KVNode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>

  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#186039" title="Boolean">mustInit</a><span class="delimiter">)</span> <a href="#186027" title="()Unit">initialize</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="186023">hasNext</a> = <span class="delimiter">(</span><a href="#186021" title="=&gt; scala.collection.concurrent.KVNode[K,V]">current</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#186018" title="=&gt; Iterator[(K, V)]">subiter</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="()(K, V)" id="186024">next</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span title="(K, V)" class="keyword">if</span> <span class="delimiter">(</span><a href="#186023" title="=&gt; Boolean">hasNext</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="(K, V)" id="186146">r</a>: <a href="../../Tuple2.scala.html#783" title="(K, V)" class="delimiter">(</a>K, V<span class="delimiter">)</span> = <span title="Null(null)" class="keyword">null</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#186018" title="=&gt; Iterator[(K, V)]">subiter</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#186146" title="(K, V)">r</a> = <a href="#186018" title="=&gt; Iterator[(K, V)]">subiter</a>.<a href="../Iterator.scala.html#66748" title="()(K, V)">next</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#186026" title="()Unit">checkSubiter</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#186146" title="(K, V)">r</a> = <a href="#186021" title="=&gt; scala.collection.concurrent.KVNode[K,V]">current</a>.<a href="#181786" title="=&gt; (K, V)">kvPair</a>
      <a href="#186028" title="()Unit">advance</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#186146" title="(K, V)">r</a>
  <span class="delimiter">}</span> <span class="keyword">else</span> <a href="../Iterator.scala.html#4101" title="scala.collection.Iterator.type">Iterator</a>.<a href="../Iterator.scala.html#97533" title="=&gt; Iterator[Nothing]">empty</a>.<a href="../Iterator.scala.html#66748" title="()Nothing">next</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(in: scala.collection.concurrent.INode[K,V])Unit" id="186025">readin</a><span class="delimiter">(</span><a title="scala.collection.concurrent.INode[K,V]" id="186150">in</a>: <a href="#10007" title="scala.collection.concurrent.INode[K,V]">INode</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#186150" title="scala.collection.concurrent.INode[K,V]">in</a>.<a href="#181389" title="(ct: scala.collection.concurrent.TrieMap[K,V])scala.collection.concurrent.MainNode[K,V]">gcasRead</a><a href="#3267894" title="scala.collection.concurrent.CNode[K,V]" class="delimiter">(</a><a href="#186036" title="=&gt; scala.collection.concurrent.TrieMap[K,V]">ct</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#3267891" title="Unit" id="3267894">cn</a>: CNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
      <a href="#186015" title="(x$1: Int)Unit">depth</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
      <a href="../../Array.scala.html#56640" title="(i: Int, x: Array[scala.collection.concurrent.BasicNode])Unit">stack</a><span class="delimiter">(</span><a href="#186015" title="=&gt; Int">depth</a><span class="delimiter">)</span> = cn.<a href="#181766" title="=&gt; Array[scala.collection.concurrent.BasicNode]">array</a>
      <a href="../../Array.scala.html#56640" title="(i: Int, x: Int)Unit">stackpos</a><span class="delimiter">(</span><a href="#186015" title="=&gt; Int">depth</a><span class="delimiter">)</span> = -<span title="Int(-1)" class="int">1</span>
      <a href="#186028" title="()Unit">advance</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="#3267891" title="Unit" id="3267895">tn</a>: TNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
      <a href="#186021" title="(x$1: scala.collection.concurrent.KVNode[K,V])Unit">current</a> = tn
    <span class="keyword">case</span> <a href="#3267891" title="Unit" id="3267896">ln</a>: LNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
      <a href="#186018" title="(x$1: Iterator[(K, V)])Unit">subiter</a> = ln.<a href="#181953" title="=&gt; scala.collection.immutable.ListMap[K,V]">listmap</a>.<a href="../immutable/ListMap.scala.html#181973" title="=&gt; Iterator[(K, V)]">iterator</a>
      <a href="#186026" title="()Unit">checkSubiter</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="#3267891" title="Unit" id="3267897" class="keyword">null</a> =&gt;
      <a href="#186021" title="(x$1: scala.collection.concurrent.KVNode[K,V])Unit">current</a> = <span title="Null(null)" class="keyword">null</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="186026">checkSubiter</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#186018" title="=&gt; Iterator[(K, V)]">subiter</a>.<a href="../Iterator.scala.html#66747" title="=&gt; Boolean">hasNext</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#186018" title="(x$1: Iterator[(K, V)])Unit">subiter</a> = <span title="Null(null)" class="keyword">null</span>
    <a href="#186028" title="()Unit">advance</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="186027">initialize</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="../../Predef.scala.html#7484" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#186036" title="=&gt; scala.collection.concurrent.TrieMap[K,V]">ct</a>.<a href="#181547" title="=&gt; Boolean">isReadOnly</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scala.collection.concurrent.INode[K,V]" id="186173">r</a> = <a href="#186036" title="scala.collection.concurrent.TrieMap[K,V]" id="186176">ct</a>.<a href="#185533" title="Boolean" id="186177">RDCSS_READ_ROOT</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#186025" title="(in: scala.collection.concurrent.INode[K,V])Unit">readin</a><span class="delimiter">(</span><a href="#186173" title="scala.collection.concurrent.INode[K,V]">r</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="186028">advance</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#1515" title="Unit">Unit</a> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#186015" title="=&gt; Int">depth</a> <a href="../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="186182">npos</a> = <a href="../../Array.scala.html#56639" title="(i: Int)Int">stackpos</a><span class="delimiter">(</span><a href="#186015" title="=&gt; Int">depth</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#186182" title="Int">npos</a> <a href="../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="../../Array.scala.html#56639" title="(i: Int)Array[scala.collection.concurrent.BasicNode]">stack</a><span class="delimiter">(</span><a href="#186015" title="=&gt; Int">depth</a><span class="delimiter">)</span>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Array.scala.html#56640" title="(i: Int, x: Int)Unit">stackpos</a><span class="delimiter">(</span><a href="#186015" title="=&gt; Int">depth</a><span class="delimiter">)</span> = <a href="#186182" title="Int">npos</a>
      <a href="../../Array.scala.html#56639" title="(i: Int)Array[scala.collection.concurrent.BasicNode]">stack</a><a href="../../Array.scala.html#56639" title="(i: Int)scala.collection.concurrent.BasicNode" class="delimiter">(</a><a href="#186015" title="=&gt; Int">depth</a><span class="delimiter">)</span><a href="#3267910" title="scala.collection.concurrent.SNode[K,V]" class="delimiter">(</a><a href="#186182" title="Int">npos</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#3267909" title="Unit" id="3267910">sn</a>: SNode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
          <a href="#186021" title="(x$1: scala.collection.concurrent.KVNode[K,V])Unit">current</a> = sn
        <span class="keyword">case</span> <a href="#3267909" title="Unit" id="3267911">in</a>: INode<span class="delimiter">[</span>K, V<span class="delimiter">]</span> =&gt;
          <a href="#186025" title="(in: scala.collection.concurrent.INode[K,V])Unit">readin</a><a href="#3267913" title="(x: Unit)Unit" class="delimiter">(</a>in<span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#186015" title="(x$1: Int)Unit">depth</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-=</a> <span title="Int(1)" class="int">1</span>
      <a href="#186028" title="()Unit">advance</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#186021" title="(x$1: scala.collection.concurrent.KVNode[K,V])Unit">current</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(_lev: Int, _ct: scala.collection.concurrent.TrieMap[K,V], _mustInit: Boolean)scala.collection.concurrent.TrieMapIterator[K,V]" id="186029">newIterator</a><span class="delimiter">(</span><a title="Int" id="186207">_lev</a>: <a href="../../Int.scala.html#321" title="Int">Int</a>, <a title="scala.collection.concurrent.TrieMap[K,V]" id="186208">_ct</a>: <a href="#10001" title="scala.collection.concurrent.TrieMap[K,V]">TrieMap</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span>, <a title="Boolean" id="186209">_mustInit</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> = <span title="scala.collection.concurrent.TrieMapIterator[K,V]" class="keyword">new</span> <a href="#10017" title="scala.collection.concurrent.TrieMapIterator[K,V]">TrieMapIterator</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">(</span><a href="#186207" title="Int">_lev</a>, <a href="#186208" title="scala.collection.concurrent.TrieMap[K,V]">_ct</a>, <a href="#186209" title="Boolean">_mustInit</a><span class="delimiter">)</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(it: scala.collection.concurrent.TrieMapIterator[K,V])Unit" id="186030">dupTo</a><span class="delimiter">(</span><a title="scala.collection.concurrent.TrieMapIterator[K,V]" id="186212">it</a>: <a href="#10017" title="scala.collection.concurrent.TrieMapIterator[K,V]">TrieMapIterator</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#186212" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="#186035" title="(x$1: Int)Unit">level</a> = <a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186035" title="=&gt; Int">level</a>
    <a href="#186212" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="#186036" title="(x$1: scala.collection.concurrent.TrieMap[K,V])Unit">ct</a> = <a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186036" title="=&gt; scala.collection.concurrent.TrieMap[K,V]">ct</a>
    <a href="#186212" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="#186015" title="(x$1: Int)Unit">depth</a> = <a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186015" title="=&gt; Int">depth</a>
    <a href="#186212" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="#186021" title="(x$1: scala.collection.concurrent.KVNode[K,V])Unit">current</a> = <a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186021" title="=&gt; scala.collection.concurrent.KVNode[K,V]">current</a>

    // these need a deep copy
    <a href="../../Array.scala.html#175" title="Array.type">Array</a>.<a href="../../Array.scala.html#72256" title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</a><span class="delimiter">(</span><a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186009" title="=&gt; Array[Array[scala.collection.concurrent.BasicNode]]">stack</a>, <span title="Int(0)" class="int">0</span>, <a href="#186212" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="#186009" title="=&gt; Array[Array[scala.collection.concurrent.BasicNode]]">stack</a>, <span title="Int(0)" class="int">0</span>, <span title="Int(7)" class="int">7</span><span class="delimiter">)</span>
    <a href="../../Array.scala.html#175" title="Array.type">Array</a>.<a href="../../Array.scala.html#72256" title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</a><span class="delimiter">(</span><a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186012" title="=&gt; Array[Int]">stackpos</a>, <span title="Int(0)" class="int">0</span>, <a href="#186212" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="#186012" title="=&gt; Array[Int]">stackpos</a>, <span title="Int(0)" class="int">0</span>, <span title="Int(7)" class="int">7</span><span class="delimiter">)</span>

    // this one needs to be evaluated
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186018" title="=&gt; Iterator[(K, V)]">subiter</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#186212" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="#186018" title="(x$1: Iterator[(K, V)])Unit">subiter</a> = <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[(K, V)]" id="186220">lst</a> = <a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186018" title="=&gt; Iterator[(K, V)]">subiter</a>.<a href="../TraversableOnce.scala.html#58263" title="=&gt; List[(K, V)]">toList</a>
      <a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186018" title="(x$1: Iterator[(K, V)])Unit">subiter</a> = <a href="#186220" title="List[(K, V)]">lst</a>.<a href="../LinearSeqLike.scala.html#86318" title="=&gt; Iterator[(K, V)]">iterator</a>
      <a href="#186212" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="#186018" title="(x$1: Iterator[(K, V)])Unit">subiter</a> = <a href="#186220" title="List[(K, V)]">lst</a>.<a href="../LinearSeqLike.scala.html#86318" title="=&gt; Iterator[(K, V)]">iterator</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Returns a sequence of iterators over subsets of this iterator.
   *  It's used to ease the implementation of splitters for a parallel version of the TrieMap.
   */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Seq[Iterator[(K, V)]]" id="186031">subdivide</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../Seq.scala.html#4340" title="Seq[Iterator[(K, V)]]">Seq</a><span class="delimiter">[</span>Iterator<span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">]</span> = <span title="Seq[Iterator[(K, V)]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#186018" title="=&gt; Iterator[(K, V)]">subiter</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    // the case where an LNode is being iterated
    <span class="keyword">val</span> <a title="Iterator[(K, V)]" id="186223">it</a> = <a href="#186018" title="=&gt; Iterator[(K, V)]">subiter</a>
    <a href="#186018" title="(x$1: Iterator[(K, V)])Unit">subiter</a> = <span title="Null(null)" class="keyword">null</span>
    <a href="#186028" title="()Unit">advance</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186035" title="(x$1: Int)Unit">level</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <a href="../generic/GenericCompanion.scala.html#59933" title="(elems: Iterator[(K, V)]*)Seq[Iterator[(K, V)]]">Seq</a><span class="delimiter">(</span><a href="#186223" title="Iterator[(K, V)]">it</a>, <a href="#10017" title="scala.collection.concurrent.TrieMapIterator[K,V]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Seq[scala.collection.concurrent.TrieMapIterator[K,V]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#186015" title="=&gt; Int">depth</a> <a href="../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186035" title="(x$1: Int)Unit">level</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <a href="../generic/GenericCompanion.scala.html#59933" title="(elems: scala.collection.concurrent.TrieMapIterator[K,V]*)Seq[scala.collection.concurrent.TrieMapIterator[K,V]]">Seq</a><span class="delimiter">(</span><a href="#10017" title="scala.collection.concurrent.TrieMapIterator[K,V]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="186247">d</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#186247" title="Int">d</a> <a href="../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <a href="#186015" title="=&gt; Int">depth</a><span class="delimiter">)</span> <a href="#186248" title="()Unit" class="delimiter">{</a>
      <span class="keyword">val</span> <a title="Int" id="186253">rem</a> = <a href="../../Array.scala.html#56639" title="(i: Int)Array[scala.collection.concurrent.BasicNode]">stack</a><span class="delimiter">(</span><a href="#186247" title="Int">d</a><span class="delimiter">)</span>.<a href="../../Array.scala.html#56638" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <a href="../../Array.scala.html#56639" title="(i: Int)Int">stackpos</a><span class="delimiter">(</span><a href="#186247" title="Int">d</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#186253" title="Int">rem</a> <a href="../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a href="#3267920" title="(x: (Array[scala.collection.concurrent.BasicNode], Array[scala.collection.concurrent.BasicNode]))(Array[scala.collection.concurrent.BasicNode], Array[scala.collection.concurrent.BasicNode])" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="Array[scala.collection.concurrent.BasicNode]" id="186267">arr1</a>, <a href="../../Tuple2.scala.html#60637" title="Array[scala.collection.concurrent.BasicNode]" id="186268">arr2</a><span class="delimiter">)</span> = <a href="../../Array.scala.html#56639" title="(i: Int)Array[scala.collection.concurrent.BasicNode]">stack</a><a href="../../Predef.scala.html#7555" title="(xs: Array[scala.collection.concurrent.BasicNode])scala.collection.mutable.ArrayOps[scala.collection.concurrent.BasicNode]" class="delimiter">(</a><a href="#186247" title="Int">d</a><span class="delimiter">)</span>.<a href="../IndexedSeqOptimized.scala.html#59163" title="(n: Int)Array[scala.collection.concurrent.BasicNode]">drop</a><a href="../../Predef.scala.html#7555" title="(xs: Array[scala.collection.concurrent.BasicNode])scala.collection.mutable.ArrayOps[scala.collection.concurrent.BasicNode]" class="delimiter">(</a><a href="../../Array.scala.html#56639" title="(i: Int)Int">stackpos</a><span class="delimiter">(</span><a href="#186247" title="Int">d</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<a href="../IndexedSeqOptimized.scala.html#59166" title="(n: Int)(Array[scala.collection.concurrent.BasicNode], Array[scala.collection.concurrent.BasicNode])">splitAt</a><a href="../../Tuple2.scala.html#783" title="(Array[scala.collection.concurrent.BasicNode], Array[scala.collection.concurrent.BasicNode]) @unchecked" class="delimiter">(</a><a href="#186253" title="Int">rem</a> <a href="../../Int.scala.html#57175" title="(x: Int)Int">/</a> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
        <a href="../../Array.scala.html#56640" title="(i: Int, x: Array[scala.collection.concurrent.BasicNode])Unit">stack</a><span class="delimiter">(</span><a href="#186247" title="Int">d</a><span class="delimiter">)</span> = <a href="#186267" title="Array[scala.collection.concurrent.BasicNode]">arr1</a>
        <a href="../../Array.scala.html#56640" title="(i: Int, x: Int)Unit">stackpos</a><span class="delimiter">(</span><a href="#186247" title="Int">d</a><span class="delimiter">)</span> = -<span title="Int(-1)" class="int">1</span>
        <span class="keyword">val</span> <a title="scala.collection.concurrent.TrieMapIterator[K,V]" id="186269">it</a> = <a href="#186029" title="(_lev: Int, _ct: scala.collection.concurrent.TrieMap[K,V], _mustInit: Boolean)scala.collection.concurrent.TrieMapIterator[K,V]">newIterator</a><span class="delimiter">(</span><a href="#186035" title="=&gt; Int">level</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>, <a href="#186036" title="=&gt; scala.collection.concurrent.TrieMap[K,V]">ct</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
        <a href="#186269" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="../../Array.scala.html#56640" title="(i: Int, x: Array[scala.collection.concurrent.BasicNode])Unit">stack</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <a href="#186268" title="Array[scala.collection.concurrent.BasicNode]">arr2</a>
        <a href="#186269" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="../../Array.scala.html#56640" title="(i: Int, x: Int)Unit">stackpos</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = -<span title="Int(-1)" class="int">1</span>
        <a href="#186269" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="#186015" title="(x$1: Int)Unit">depth</a> = <span title="Int(0)" class="int">0</span>
        <a href="#186269" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a>.<a href="#186028" title="()Unit">advance</a><span class="delimiter">(</span><span class="delimiter">)</span> // &lt;-- fix it
        <a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186035" title="(x$1: Int)Unit">level</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
        <span title="Nothing" class="keyword">return</span> <a href="../generic/GenericCompanion.scala.html#59933" title="(elems: scala.collection.concurrent.TrieMapIterator[K,V]*)Seq[scala.collection.concurrent.TrieMapIterator[K,V]]">Seq</a><span class="delimiter">(</span><a href="#10017" title="scala.collection.concurrent.TrieMapIterator[K,V]" class="keyword">this</a>, <a href="#186269" title="scala.collection.concurrent.TrieMapIterator[K,V]">it</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#186247" title="Int">d</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#10017" title="TrieMapIterator.this.type" class="keyword">this</a>.<a href="#186035" title="(x$1: Int)Unit">level</a> <a href="../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <a href="../generic/GenericCompanion.scala.html#59933" title="(elems: scala.collection.concurrent.TrieMapIterator[K,V]*)Seq[scala.collection.concurrent.TrieMapIterator[K,V]]">Seq</a><span class="delimiter">(</span><a href="#10017" title="scala.collection.concurrent.TrieMapIterator[K,V]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="186032">printDebug</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;ctrie iterator&quot;)" class="string">&quot;ctrie iterator&quot;</span><span class="delimiter">)</span>
    <a href="../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../Predef.scala.html#7553" title="implicit scala.Predef.intArrayOps : (xs: Array[Int])scala.collection.mutable.ArrayOps[Int]">stackpos</a>.<a href="../TraversableOnce.scala.html#58283" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;depth: &quot;)" class="string">&quot;depth: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#186015" title="=&gt; Int">depth</a><span class="delimiter">)</span>
    <a href="../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;curr.: &quot;)" class="string">&quot;curr.: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#186021" title="=&gt; scala.collection.concurrent.KVNode[K,V]">current</a><span class="delimiter">)</span>
    <a href="../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../Predef.scala.html#7555" title="(xs: Array[Array[scala.collection.concurrent.BasicNode]])scala.collection.mutable.ArrayOps[Array[scala.collection.concurrent.BasicNode]]">stack</a>.<a href="../TraversableOnce.scala.html#58283" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>


<span class="keyword">private</span><span class="delimiter">[</span>concurrent<span class="delimiter">]</span> <span class="keyword">object</span> <a title="scala.collection.concurrent.RestartException.type" id="186633">RestartException</a> <a href="#9979" title="scala.collection.concurrent.RestartException.type" class="keyword">extends</a> <a href="../../util/control/ControlThrowable.scala.html#52278" title="scala.util.control.ControlThrowable">ControlThrowable</a>


/** Only used for ctrie serialization. */
@SerialVersionUID<span class="delimiter">(</span><span class="long">0L</span> - <span class="long">7237891413820527142L</span><span class="delimiter">)</span>
<span class="keyword">private</span><span class="delimiter">[</span>concurrent<span class="delimiter">]</span> case <span class="keyword">object</span> <a href="#186638" title="scala.collection.concurrent.TrieMapSerializationEnd.type" id="186646">TrieMapSerializationEnd</a>


<a href="#9982" title="scala.collection.concurrent.TrieMapSerializationEnd.type" class="keyword">private</a><span class="delimiter">[</span>concurrent<span class="delimiter">]</span> <span class="keyword">object</span> <a title="scala.collection.concurrent.Debug.type" id="9963">Debug</a> <a href="#9964" title="scala.collection.concurrent.Debug.type" class="delimiter">{</a>
  <span class="keyword">import</span> scala.collection._

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.util.concurrent.ConcurrentLinkedQueue[AnyRef]" id="186650">logbuffer</a> = <span title="java.util.concurrent.ConcurrentLinkedQueue[AnyRef]" class="keyword">new</span> java.util.concurrent.<span title="java.util.concurrent.ConcurrentLinkedQueue[AnyRef]">ConcurrentLinkedQueue</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(s: AnyRef)Boolean" id="186651">log</a><span class="delimiter">(</span><a title="AnyRef" id="186733">s</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span> = <a href="#186649" title="=&gt; java.util.concurrent.ConcurrentLinkedQueue[AnyRef]">logbuffer</a>.<span title="(x$1: AnyRef)Boolean">add</span><span class="delimiter">(</span><a href="#186733" title="AnyRef">s</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="()Unit" id="186652">flush</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="AnyRef" id="186755">s</a> &lt;- <a href="../JavaConversions.scala.html#3429" title="scala.collection.JavaConversions.type">JavaConversions</a>.<a href="../convert/WrapAsScala.scala.html#148664" title="(it: java.util.Iterator[AnyRef])Iterator[AnyRef]">asScalaIterator</a><a href="../Iterator.scala.html#66797" title="(f: AnyRef =&gt; Unit)Unit" class="delimiter">(</a><a href="#186649" title="=&gt; java.util.concurrent.ConcurrentLinkedQueue[AnyRef]">logbuffer</a>.<span title="()java.util.Iterator[AnyRef]">iterator</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Console.scala.html#136" title="Console.type">Console</a>.<a href="../../Console.scala.html#63284" title="=&gt; java.io.PrintStream">out</a>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><a href="#186755" title="AnyRef">s</a>.<span title="()String">toString</span><span class="delimiter">)</span>
    <a href="#186649" title="=&gt; java.util.concurrent.ConcurrentLinkedQueue[AnyRef]">logbuffer</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="186653">clear</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#186649" title="=&gt; java.util.concurrent.ConcurrentLinkedQueue[AnyRef]">logbuffer</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>
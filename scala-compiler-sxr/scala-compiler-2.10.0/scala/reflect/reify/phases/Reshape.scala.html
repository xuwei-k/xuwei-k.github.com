<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/reflect/reify/phases/Reshape.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.reflect.reify
<span class="keyword">package</span> phases

<span class="keyword">import</span> scala.tools.nsc.symtab.<a href="../../../tools/nsc/symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>._

<span class="keyword">trait</span> <a title="trait Reshape extends Object" id="24099">Reshape</a> <a href="../../../Unit.scala.html#1515" title="Unit" class="delimiter">{</a>
  self: Reifier =&gt;

  <span class="keyword">import</span> <a href="../Reifier.scala.html#541941" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="../../internal/Definitions.scala.html#407777" title="Reshape.this.global.definitions.type">definitions</a>._

  /**
   *  Rolls back certain changes that were introduced during typechecking of the reifee.
   *
   *  These include:
   *    * Undoing macro expansions
   *    * Replacing type trees with TypeTree(tpe)
   *    * Reassembling CompoundTypeTrees into reifiable form
   *    * Transforming Modifiers.annotations into Symbol.annotations
   *    * Transforming Annotated annotations into AnnotatedType annotations
   *    * Transforming Annotated(annot, expr) into Typed(expr, TypeTree(Annotated(annot, _))
   *    * Non-idempotencies of the typechecker: https://issues.scala-lang.org/browse/SI-5464
   */
  <span class="keyword">val</span> <a title="reshape extends Reshape.this.global.Transformer" id="541957">reshape</a> = <a href="#542652" title="Reshape.this.global.Transformer{def currentSymbol: Reshape.this.global.Symbol; def currentSymbol_=(x$1: Reshape.this.global.Symbol): Unit}" class="keyword">new</a> <a href="../../../tools/nsc/ast/Trees.scala.html#537817" title="anonymous class $anon extends Reshape.this.global.Transformer" id="542652">Transformer</a> <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Reshape.this.global.Symbol" id="542658">currentSymbol</a>: <a href="../../internal/Symbols.scala.html#407146" title="Reshape.this.global.Symbol">Symbol</a> = <a href="../../internal/Symbols.scala.html#407184" title="=&gt; Reshape.this.global.NoSymbol">NoSymbol</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree0: Reshape.this.global.Tree)Reshape.this.global.Tree" id="542660">transform</a><span class="delimiter">(</span><a title="Reshape.this.global.Tree" id="542673">tree0</a>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Reshape.this.global.Tree" id="542675">tree</a> = <a href="#542661" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree">undoMacroExpansion</a><span class="delimiter">(</span><a href="#542673" title="Reshape.this.global.Tree">tree0</a><span class="delimiter">)</span>
      <a href="#542658" title="(x$1: Reshape.this.global.Symbol)Unit">currentSymbol</a> = <a href="#542675" title="Reshape.this.global.Tree">tree</a>.<a href="../../internal/Trees.scala.html#408577" title="=&gt; Reshape.this.global.Symbol">symbol</a>

      <span class="keyword">val</span> <a title="Reshape.this.global.Tree" id="542676">preTyper</a> = <a href="#542675" title="Reshape.this.global.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> tree <span class="keyword">if</span> tree.<a href="../../internal/Trees.scala.html#408559" title="=&gt; Boolean">isErroneous</a> =&gt;
          <a href="#3294726" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree">tree</a>
        <span class="keyword">case</span> tt @ TypeTree<a href="#3294698" title="Reshape.this.global.Tree" id="3294700" class="delimiter">(</a><span class="delimiter">)</span> =&gt;
          <a href="#542665" title="(tt: Reshape.this.global.TypeTree)Reshape.this.global.Tree">toPreTyperTypeTree</a><a href="#3294726" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a>tt<span class="delimiter">)</span>
        <span class="keyword">case</span> ctt @ CompoundTypeTree<a href="#3294698" title="Reshape.this.global.Tree" id="3294703" class="delimiter">(</a><a href="../../internal/Trees.scala.html#409932" title="Reshape.this.global.Template" id="3294701">_</a><span class="delimiter">)</span> =&gt;
          <a href="#542666" title="(ctt: Reshape.this.global.CompoundTypeTree)Reshape.this.global.Tree">toPreTyperCompoundTypeTree</a><a href="#3294726" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a>ctt<span class="delimiter">)</span>
        <span class="keyword">case</span> toa @ <a href="../codegen/GenUtils.scala.html#542690" title="Option[Reshape.this.global.Tree]" id="3294733">TypedOrAnnotated</a><span class="delimiter">(</span><a title="Reshape.this.global.Tree" id="3294704">_</a><span class="delimiter">)</span> =&gt;
          <a href="#542667" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree">toPreTyperTypedOrAnnotated</a><a href="#3294726" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a>toa<span class="delimiter">)</span>
        <span class="keyword">case</span> ta @ TypeApply<a href="#3294698" title="Boolean" id="3294709" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410043" title="Reshape.this.global.Tree" id="3294706">_</a>, <a href="../../internal/Trees.scala.html#410045" title="List[Reshape.this.global.Tree]" id="3294707">_</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../codegen/GenUtils.scala.html#542081" title="(tree: Reshape.this.global.Tree)Boolean">isCrossStageTypeBearer</a><span class="delimiter">(</span>ta<span class="delimiter">)</span> =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;cross-stage type bearer, retaining: &quot;)" class="string">&quot;cross-stage type bearer, retaining: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#542675" title="Reshape.this.global.Tree">tree</a><span class="delimiter">)</span>
          ta
        <span class="keyword">case</span> ta @ TypeApply<span class="delimiter">(</span><a href="../../internal/Trees.scala.html#410043" title="Reshape.this.global.Tree" id="542706">hk</a>, <a href="../../internal/Trees.scala.html#410045" title="List[Reshape.this.global.Tree]" id="542707">ts</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="Boolean" id="542708">discard</a> = <a href="#542707" title="List[Reshape.this.global.Tree]">ts</a> <a href="../../../collection/TraversableLike.scala.html#58075" title="(pf: PartialFunction[Reshape.this.global.Tree,Reshape.this.global.TypeTree])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.Tree],Reshape.this.global.TypeTree,List[Reshape.this.global.TypeTree]])List[Reshape.this.global.TypeTree]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.global.Tree,Reshape.this.global.TypeTree] with Serializable" id="542728" class="delimiter">{</a> <span class="keyword">case</span> <a href="#3294491" title="B1" id="3294561">tt</a>: TypeTree =&gt; <a href="#3294497" title="(x: B1)B1">tt</a> <span class="delimiter">}</span> <a href="../../../collection/LinearSeqOptimized.scala.html#86379" title="(p: Reshape.this.global.TypeTree =&gt; Boolean)Boolean">exists</a> <a href="#542664" title="(tt: Reshape.this.global.TypeTree)Boolean">isDiscarded</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#542708" title="Boolean">discard</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;discarding TypeApply: &quot;)" class="string">&quot;discarding TypeApply: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#542675" title="Reshape.this.global.Tree">tree</a><span class="delimiter">)</span>
          <span title="Reshape.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#542708" title="Boolean">discard</a><span class="delimiter">)</span> <a href="#542706" title="Reshape.this.global.Tree">hk</a> <span class="keyword">else</span> ta
        <span class="keyword">case</span> classDef @ ClassDef<a href="#3294698" title="Reshape.this.global.Tree" id="3294713" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410330" title="Reshape.this.global.Modifiers" id="542846">mods</a>, <a href="../../internal/Trees.scala.html#410332" title="Reshape.this.global.TypeName" id="542847">name</a>, <a href="../../internal/Trees.scala.html#410334" title="List[Reshape.this.global.TypeDef]" id="542848">params</a>, <a href="../../internal/Trees.scala.html#410336" title="Reshape.this.global.Template" id="542849">impl</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> Template<a href="#3294569" title="(x: (List[Reshape.this.global.Tree], Reshape.this.global.ValDef, List[Reshape.this.global.Tree]))(List[Reshape.this.global.Tree], Reshape.this.global.ValDef, List[Reshape.this.global.Tree])" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410203" title="List[Reshape.this.global.Tree]" id="542851">parents</a>, <a href="../../internal/Trees.scala.html#410205" title="Reshape.this.global.ValDef" id="542852">self</a>, <a href="../../internal/Trees.scala.html#410207" title="List[Reshape.this.global.Tree]" id="542853">body</a><span class="delimiter">)</span> = <a href="#542849" title="Reshape.this.global.Template">impl</a>
          <span class="keyword">var</span> <a title="List[Reshape.this.global.Tree]" id="542854">body1</a> = <a href="#542669" title="(deff: Reshape.this.global.Tree, stats: List[Reshape.this.global.Tree])List[Reshape.this.global.Tree]">trimAccessors</a><span class="delimiter">(</span>classDef, <a href="#542853" title="List[Reshape.this.global.Tree]">body</a><span class="delimiter">)</span>
          <a href="#542854" title="List[Reshape.this.global.Tree]">body1</a> = <a href="#542670" title="(deff: Reshape.this.global.Tree, stats: List[Reshape.this.global.Tree])List[Reshape.this.global.Tree]">trimSyntheticCaseClassMembers</a><span class="delimiter">(</span>classDef, <a href="#542854" title="List[Reshape.this.global.Tree]">body1</a><span class="delimiter">)</span>
          <span class="keyword">var</span> <a title="Reshape.this.global.Template" id="542855">impl1</a> = <a href="../../internal/Trees.scala.html#452941" title="(parents: List[Reshape.this.global.Tree], self: Reshape.this.global.ValDef, body: List[Reshape.this.global.Tree])Reshape.this.global.Template">Template</a><span class="delimiter">(</span><a href="#542851" title="List[Reshape.this.global.Tree]">parents</a>, <a href="#542852" title="Reshape.this.global.ValDef">self</a>, <a href="#542854" title="List[Reshape.this.global.Tree]">body1</a><span class="delimiter">)</span>.<a href="../../internal/Trees.scala.html#408585" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Template">copyAttrs</a><span class="delimiter">(</span><a href="#542849" title="Reshape.this.global.Template">impl</a><span class="delimiter">)</span>
          <a href="../../internal/Trees.scala.html#452078" title="(mods: Reshape.this.global.Modifiers, name: Reshape.this.global.TypeName, tparams: List[Reshape.this.global.TypeDef], impl: Reshape.this.global.Template)Reshape.this.global.ClassDef">ClassDef</a><span class="delimiter">(</span><a href="#542846" title="Reshape.this.global.Modifiers">mods</a>, <a href="#542847" title="Reshape.this.global.TypeName">name</a>, <a href="#542848" title="List[Reshape.this.global.TypeDef]">params</a>, <a href="#542855" title="Reshape.this.global.Template">impl1</a><span class="delimiter">)</span>.<a href="../../internal/Trees.scala.html#408585" title="(tree: Reshape.this.global.Tree)Reshape.this.global.ClassDef">copyAttrs</a><span class="delimiter">(</span>classDef<span class="delimiter">)</span>
        <span class="keyword">case</span> moduledef @ ModuleDef<a href="#3294698" title="Reshape.this.global.Tree" id="3294715" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410316" title="Reshape.this.global.Modifiers" id="542945">mods</a>, <a href="../../internal/Trees.scala.html#410318" title="Reshape.this.global.TermName" id="542946">name</a>, <a href="../../internal/Trees.scala.html#410320" title="Reshape.this.global.Template" id="542947">impl</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> Template<a href="#3294575" title="(x: (List[Reshape.this.global.Tree], Reshape.this.global.ValDef, List[Reshape.this.global.Tree]))(List[Reshape.this.global.Tree], Reshape.this.global.ValDef, List[Reshape.this.global.Tree])" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410203" title="List[Reshape.this.global.Tree]" id="542949">parents</a>, <a href="../../internal/Trees.scala.html#410205" title="Reshape.this.global.ValDef" id="542950">self</a>, <a href="../../internal/Trees.scala.html#410207" title="List[Reshape.this.global.Tree]" id="542951">body</a><span class="delimiter">)</span> = <a href="#542947" title="Reshape.this.global.Template">impl</a>
          <span class="keyword">var</span> <a title="List[Reshape.this.global.Tree]" id="542952">body1</a> = <a href="#542669" title="(deff: Reshape.this.global.Tree, stats: List[Reshape.this.global.Tree])List[Reshape.this.global.Tree]">trimAccessors</a><span class="delimiter">(</span>moduledef, <a href="#542951" title="List[Reshape.this.global.Tree]">body</a><span class="delimiter">)</span>
          <a href="#542952" title="List[Reshape.this.global.Tree]">body1</a> = <a href="#542670" title="(deff: Reshape.this.global.Tree, stats: List[Reshape.this.global.Tree])List[Reshape.this.global.Tree]">trimSyntheticCaseClassMembers</a><span class="delimiter">(</span>moduledef, <a href="#542952" title="List[Reshape.this.global.Tree]">body1</a><span class="delimiter">)</span>
          <span class="keyword">var</span> <a title="Reshape.this.global.Template" id="542953">impl1</a> = <a href="../../internal/Trees.scala.html#452941" title="(parents: List[Reshape.this.global.Tree], self: Reshape.this.global.ValDef, body: List[Reshape.this.global.Tree])Reshape.this.global.Template">Template</a><span class="delimiter">(</span><a href="#542949" title="List[Reshape.this.global.Tree]">parents</a>, <a href="#542950" title="Reshape.this.global.ValDef">self</a>, <a href="#542952" title="List[Reshape.this.global.Tree]">body1</a><span class="delimiter">)</span>.<a href="../../internal/Trees.scala.html#408585" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Template">copyAttrs</a><span class="delimiter">(</span><a href="#542947" title="Reshape.this.global.Template">impl</a><span class="delimiter">)</span>
          <a href="../../internal/Trees.scala.html#452260" title="(mods: Reshape.this.global.Modifiers, name: Reshape.this.global.TermName, impl: Reshape.this.global.Template)Reshape.this.global.ModuleDef">ModuleDef</a><span class="delimiter">(</span><a href="#542945" title="Reshape.this.global.Modifiers">mods</a>, <a href="#542946" title="Reshape.this.global.TermName">name</a>, <a href="#542953" title="Reshape.this.global.Template">impl1</a><span class="delimiter">)</span>.<a href="../../internal/Trees.scala.html#408585" title="(tree: Reshape.this.global.Tree)Reshape.this.global.ModuleDef">copyAttrs</a><span class="delimiter">(</span>moduledef<span class="delimiter">)</span>
        <span class="keyword">case</span> template @ Template<a href="#3294698" title="Reshape.this.global.Tree" id="3294717" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410203" title="List[Reshape.this.global.Tree]" id="543006">parents</a>, <a href="../../internal/Trees.scala.html#410205" title="Reshape.this.global.ValDef" id="543007">self</a>, <a href="../../internal/Trees.scala.html#410207" title="List[Reshape.this.global.Tree]" id="543008">body</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="List[Reshape.this.global.TypeTree]" id="543009">discardedParents</a> = <a href="#543006" title="List[Reshape.this.global.Tree]">parents</a> <a href="../../../collection/TraversableLike.scala.html#58075" title="(pf: PartialFunction[Reshape.this.global.Tree,Reshape.this.global.TypeTree])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.Tree],Reshape.this.global.TypeTree,List[Reshape.this.global.TypeTree]])List[Reshape.this.global.TypeTree]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.global.Tree,Reshape.this.global.TypeTree] with Serializable" id="543031" class="delimiter">{</a> <span class="keyword">case</span> <a href="#3294579" title="B1" id="3294649">tt</a>: TypeTree =&gt; <a href="#3294585" title="(x: B1)B1">tt</a> <span class="delimiter">}</span> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: Reshape.this.global.TypeTree =&gt; Boolean)List[Reshape.this.global.TypeTree]">filter</a> <a href="#542664" title="(tt: Reshape.this.global.TypeTree)Boolean">isDiscarded</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#543009" title="List[Reshape.this.global.TypeTree]">discardedParents</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;discarding parents in Template: &quot;)" class="string">&quot;discarding parents in Template: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#543009" title="List[Reshape.this.global.TypeTree]">discardedParents</a>.<a href="../../../collection/TraversableOnce.scala.html#58283" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="List[Reshape.this.global.Tree]" id="543010">parents1</a> = <a href="#543006" title="List[Reshape.this.global.Tree]">parents</a> <a href="../../../collection/SeqLike.scala.html#58830" title="(that: scala.collection.GenSeq[Reshape.this.global.Tree])List[Reshape.this.global.Tree]">diff</a> <a href="#543009" title="List[Reshape.this.global.TypeTree]">discardedParents</a>
          <span class="keyword">val</span> <a title="List[Reshape.this.global.Tree]" id="543011">body1</a> = <a href="#542671" title="(stats: List[Reshape.this.global.Tree])List[Reshape.this.global.Tree]">trimSyntheticCaseClassCompanions</a><span class="delimiter">(</span><a href="#543008" title="List[Reshape.this.global.Tree]">body</a><span class="delimiter">)</span>
          <a href="../../internal/Trees.scala.html#452941" title="(parents: List[Reshape.this.global.Tree], self: Reshape.this.global.ValDef, body: List[Reshape.this.global.Tree])Reshape.this.global.Template">Template</a><span class="delimiter">(</span><a href="#543010" title="List[Reshape.this.global.Tree]">parents1</a>, <a href="#543007" title="Reshape.this.global.ValDef">self</a>, <a href="#543011" title="List[Reshape.this.global.Tree]">body1</a><span class="delimiter">)</span>.<a href="../../internal/Trees.scala.html#408585" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Template">copyAttrs</a><span class="delimiter">(</span>template<span class="delimiter">)</span>
        <span class="keyword">case</span> block @ Block<a href="#3294698" title="Reshape.this.global.Tree" id="3294719" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410192" title="List[Reshape.this.global.Tree]" id="543127">stats</a>, <a href="../../internal/Trees.scala.html#410194" title="Reshape.this.global.Tree" id="543128">expr</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="List[Reshape.this.global.Tree]" id="543129">stats1</a> = <a href="#542671" title="(stats: List[Reshape.this.global.Tree])List[Reshape.this.global.Tree]">trimSyntheticCaseClassCompanions</a><span class="delimiter">(</span><a href="#543127" title="List[Reshape.this.global.Tree]">stats</a><span class="delimiter">)</span>
          <a href="../../internal/Trees.scala.html#453067" title="(stats: List[Reshape.this.global.Tree], expr: Reshape.this.global.Tree)Reshape.this.global.Block">Block</a><span class="delimiter">(</span><a href="#543129" title="List[Reshape.this.global.Tree]">stats1</a>, <a href="#543128" title="Reshape.this.global.Tree">expr</a><span class="delimiter">)</span>.<a href="../../internal/Trees.scala.html#408585" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Block">copyAttrs</a><span class="delimiter">(</span>block<span class="delimiter">)</span>
        <span class="keyword">case</span> valdef @ ValDef<a href="#3294698" title="Reshape.this.global.Tree" id="3294721" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410298" title="Reshape.this.global.Modifiers" id="543166">mods</a>, <a href="../../internal/Trees.scala.html#410300" title="Reshape.this.global.TermName" id="543167">name</a>, <a href="../../internal/Trees.scala.html#410302" title="Reshape.this.global.Tree" id="543168">tpt</a>, <a href="../../internal/Trees.scala.html#410304" title="Reshape.this.global.Tree" id="543169">rhs</a><span class="delimiter">)</span> <span class="keyword">if</span> valdef.<a href="../../internal/Trees.scala.html#409939" title="=&gt; Reshape.this.global.Symbol">symbol</a>.<a href="../../internal/HasFlags.scala.html#409857" title="=&gt; Boolean">isLazy</a> =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;dropping $lzy in lazy val\'s name: &quot;)" class="string">&quot;dropping $lzy in lazy val's name: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#542675" title="Reshape.this.global.Tree">tree</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Reshape.this.global.TermName" id="543170">name1</a> = <span title="Reshape.this.global.TermName" class="keyword">if</span> <span class="delimiter">(</span><a href="#543167" title="Reshape.this.global.TermName">name</a> <a href="../../internal/Names.scala.html#410402" title="(suffix: Reshape.this.global.Name)Boolean">endsWith</a> <a href="../../internal/StdNames.scala.html#407871" title="Reshape.this.global.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#413990" title="=&gt; Reshape.this.global.nme.NameType">LAZY_LOCAL</a><span class="delimiter">)</span> <a href="../../internal/Names.scala.html#406869" title="implicit scala.reflect.internal.Names.TermNameOps : (name: Reshape.this.global.TermName)Reshape.this.global.NameOps[Reshape.this.global.TermName]">name</a> <a href="../../internal/Names.scala.html#413223" title="(n: Int)Reshape.this.global.TermName">dropRight</a> <a href="../../internal/StdNames.scala.html#407871" title="Reshape.this.global.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#413990" title="=&gt; Reshape.this.global.nme.NameType">LAZY_LOCAL</a>.<a href="../../internal/Names.scala.html#410373" title="=&gt; Int">length</a> <span class="keyword">else</span> <a href="#543167" title="Reshape.this.global.TermName">name</a>
          <a href="../../internal/Trees.scala.html#452311" title="(mods: Reshape.this.global.Modifiers, name: Reshape.this.global.TermName, tpt: Reshape.this.global.Tree, rhs: Reshape.this.global.Tree)Reshape.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#543166" title="Reshape.this.global.Modifiers">mods</a>, <a href="#543170" title="Reshape.this.global.TermName">name1</a>, <a href="#543168" title="Reshape.this.global.Tree">tpt</a>, <a href="#543169" title="Reshape.this.global.Tree">rhs</a><span class="delimiter">)</span>.<a href="../../internal/Trees.scala.html#408585" title="(tree: Reshape.this.global.Tree)Reshape.this.global.ValDef">copyAttrs</a><span class="delimiter">(</span>valdef<span class="delimiter">)</span>
        <span class="keyword">case</span> unapply @ UnApply<a href="#3294698" title="Reshape.this.global.Tree" id="3294723" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410145" title="Reshape.this.global.Tree" id="543207">fun</a>, <a href="../../internal/Trees.scala.html#410147" title="List[Reshape.this.global.Tree]" id="543208">args</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">def</span> <a title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree" id="543209">extractExtractor</a><span class="delimiter">(</span><a title="Reshape.this.global.Tree" id="543211">tree</a>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
            <span class="keyword">val</span> Apply<a href="#3294655" title="(Reshape.this.global.Tree, List[Reshape.this.global.Tree])" id="3294657" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410031" title="Reshape.this.global.Tree" id="543213">fun</a>, <a href="../../internal/Trees.scala.html#410033" title="List[Reshape.this.global.Tree]" id="543214">args</a><span class="delimiter">)</span> = <a href="#543211" title="Reshape.this.global.Tree">tree</a>
            <a href="#543214" title="List[Reshape.this.global.Tree]">args</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[Reshape.this.global.Tree]]" id="3294683">List</a><span class="delimiter">(</span>Ident<a title="Reshape.this.global.Tree" id="3294677" class="delimiter">(</a><a href="../../internal/Trees.scala.html#409987" title="Reshape.this.global.Name" id="543249">special</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#543249" title="Reshape.this.global.Name">special</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../internal/StdNames.scala.html#407871" title="Reshape.this.global.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#414030" title="=&gt; Reshape.this.global.nme.NameType">SELECTOR_DUMMY</a> =&gt;
                <span class="keyword">val</span> Select<a href="#3294663" title="(Reshape.this.global.Tree, Reshape.this.global.Name)" id="3294665" class="delimiter">(</a><a href="../../internal/Trees.scala.html#409999" title="Reshape.this.global.Tree" id="543255">extractor</a>, <a href="../../internal/Trees.scala.html#410001" title="Reshape.this.global.Name" id="543256">flavor</a><span class="delimiter">)</span> = <a href="#543213" title="Reshape.this.global.Tree">fun</a>
                <a href="../../../tools/nsc/Global.scala.html#537498" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#543256" title="Reshape.this.global.Name">flavor</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../internal/StdNames.scala.html#407871" title="Reshape.this.global.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#414575" title="=&gt; Reshape.this.global.nme.NameType">unapply</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#543256" title="Reshape.this.global.Name">flavor</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../internal/StdNames.scala.html#407871" title="Reshape.this.global.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#414577" title="=&gt; Reshape.this.global.nme.NameType">unapplySeq</a><span class="delimiter">)</span>
                <a href="#543255" title="Reshape.this.global.Tree">extractor</a>
              <span class="keyword">case</span> _ =&gt;
                <a href="#543209" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree">extractExtractor</a><a href="#3294679" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a><a href="#543213" title="Reshape.this.global.Tree">fun</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>

          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;unapplying unapply: &quot;)" class="string">&quot;unapplying unapply: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#542675" title="Reshape.this.global.Tree">tree</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Reshape.this.global.Tree" id="543210">fun1</a> = <a href="#543209" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree">extractExtractor</a><span class="delimiter">(</span><a href="#543207" title="Reshape.this.global.Tree">fun</a><span class="delimiter">)</span>
          <a href="../../internal/Trees.scala.html#413581" title="(fun: Reshape.this.global.Tree, args: List[Reshape.this.global.Tree])Reshape.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="#543210" title="Reshape.this.global.Tree">fun1</a>, <a href="#543208" title="List[Reshape.this.global.Tree]">args</a><span class="delimiter">)</span>.<a href="../../internal/Trees.scala.html#408585" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Apply">copyAttrs</a><span class="delimiter">(</span>unapply<span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt;
          <a href="#3294726" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree">tree</a>
      <span class="delimiter">}</span>

      <a href="#542652" title="Reshape.this.global.Transformer{def currentSymbol: Reshape.this.global.Symbol; def currentSymbol_=(x$1: Reshape.this.global.Symbol): Unit}" class="keyword">super</a>.<a href="../../api/Trees.scala.html#405652" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#542676" title="Reshape.this.global.Tree">preTyper</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree" id="542661">undoMacroExpansion</a><span class="delimiter">(</span><a title="Reshape.this.global.Tree" id="542677">tree</a>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a> =
      <a href="#542677" title="Reshape.this.global.Tree">tree</a>.<a href="../../internal/StdAttachments.scala.html#409595" title="=&gt; scala.reflect.macros.Attachments{type Pos = Reshape.this.global.Position}">attachments</a>.<a href="../../macros/Attachments.scala.html#402528" title="[T](implicit evidence$2: scala.reflect.ClassTag[T])Option[T]">get</a><a href="../../ClassTag.scala.html#81051" title="(implicit evidence$2: scala.reflect.ClassTag[Reshape.this.global.MacroExpansionAttachment])Option[Reshape.this.global.MacroExpansionAttachment]" class="delimiter">[</a><a href="../../internal/StdAttachments.scala.html#408351" title="Reshape.this.global.MacroExpansionAttachment">MacroExpansionAttachment</a><span class="delimiter">]</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#3294852" title="Reshape.this.global.Tree" id="3294854" class="delimiter">(</a>MacroExpansionAttachment<a href="../../../Option.scala.html#63132" title="Reshape.this.global.MacroExpansionAttachment" id="3294853" class="delimiter">(</a><a href="../../internal/StdAttachments.scala.html#464789" title="Reshape.this.global.Tree" id="543428">original</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#3294856" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree">original</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            // this hack is necessary until I fix implicit macros
            // so far tag materialization is implemented by sneaky macros hidden in scala-compiler.jar
            // hence we cannot reify references to them, because noone will be able to see them later
            // when implicit macros are fixed, these sneaky macros will move to corresponding companion objects
            // of, say, ClassTag or TypeTag
            <span class="keyword">case</span> Apply<a href="#3294743" title="Boolean" id="3294747" class="delimiter">(</a>TypeApply<a href="../../internal/Trees.scala.html#410031" title="Reshape.this.global.Tree" id="3294751" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410043" title="Reshape.this.global.Tree" id="3294748">_</a>, <a href="../../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[Reshape.this.global.Tree]]" id="3294789">List</a><a href="../../internal/Trees.scala.html#410045" title="List[Reshape.this.global.Tree]" id="3294749" class="delimiter">(</a><a title="Reshape.this.global.Tree" id="543447">tt</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="../../internal/Trees.scala.html#410033" title="List[Reshape.this.global.Tree]" id="3294745">_</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#543428" title="Reshape.this.global.Tree">original</a>.<a href="../../internal/Trees.scala.html#408577" title="=&gt; Reshape.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../internal/Definitions.scala.html#408926" title="=&gt; Reshape.this.global.TermSymbol">materializeClassTag</a> =&gt;
              <a href="../../../tools/nsc/Global.scala.html#537460" title="Reshape.this.global.gen.type">gen</a>.<a href="../../internal/TreeGen.scala.html#470984" title="(method: Reshape.this.global.gen.global.Symbol, targs: List[Reshape.this.global.gen.global.Type])Reshape.this.global.gen.global.Tree">mkNullaryCall</a><a href="#3294785" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a><a href="../../internal/Definitions.scala.html#408747" title="=&gt; Reshape.this.global.TermSymbol">Predef_implicitly</a>, <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: Reshape.this.global.Type*)List[Reshape.this.global.Type]">List</a><span class="delimiter">(</span><a href="../../internal/Types.scala.html#407409" title="(tyconSym: Reshape.this.global.Symbol, args: Reshape.this.global.Type*)Reshape.this.global.Type">appliedType</a><span class="delimiter">(</span><a href="../../internal/Definitions.scala.html#408914" title="=&gt; Reshape.this.global.ClassSymbol">ClassTagClass</a>, <a href="#543447" title="Reshape.this.global.Tree">tt</a>.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> Apply<span class="delimiter">(</span>TypeApply<a href="../../internal/Trees.scala.html#410031" title="Reshape.this.global.Tree" id="3294762" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410043" title="Reshape.this.global.Tree" id="3294759">_</a>, <a href="../../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[Reshape.this.global.Tree]]" id="3294792">List</a><a href="../../internal/Trees.scala.html#410045" title="List[Reshape.this.global.Tree]" id="3294760" class="delimiter">(</a><a title="Reshape.this.global.Tree" id="543543">tt</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="../../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[Reshape.this.global.Tree]]" id="3294791">List</a><a href="../../internal/Trees.scala.html#410033" title="List[Reshape.this.global.Tree]" id="3294756" class="delimiter">(</a><a title="Reshape.this.global.Tree" id="543556">pre</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#543428" title="Reshape.this.global.Tree">original</a>.<a href="../../internal/Trees.scala.html#408577" title="=&gt; Reshape.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../internal/Definitions.scala.html#408927" title="=&gt; Reshape.this.global.Symbol{def name: Reshape.this.global.TermName; def rawname: Reshape.this.global.TermName; type TypeOfClonedSymbol &gt;: Reshape.this.global.TermSymbol with Reshape.this.global.NoSymbol &lt;: Reshape.this.global.Symbol{def name: Reshape.this.global.TermName; def rawname: Reshape.this.global.TermName; type TypeOfClonedSymbol &gt;: Reshape.this.global.TermSymbol with Reshape.this.global.NoSymbol &lt;: Reshape.this.global.Symbol; type NameType &lt;: Reshape.this.global.TermName}; type NameType &lt;: Reshape.this.global.TermName}">materializeWeakTypeTag</a> =&gt;
              <a href="../../../tools/nsc/Global.scala.html#537460" title="Reshape.this.global.gen.type">gen</a>.<a href="../../internal/TreeGen.scala.html#470984" title="(method: Reshape.this.global.gen.global.Symbol, targs: List[Reshape.this.global.gen.global.Type])Reshape.this.global.gen.global.Tree">mkNullaryCall</a><a href="#3294785" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a><a href="../../internal/Definitions.scala.html#408747" title="=&gt; Reshape.this.global.TermSymbol">Predef_implicitly</a>, <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: Reshape.this.global.Type*)List[Reshape.this.global.Type]">List</a><span class="delimiter">(</span><a href="../../internal/Types.scala.html#407402" title="(pre: Reshape.this.global.Type, sym: Reshape.this.global.Symbol, args: List[Reshape.this.global.Type])Reshape.this.global.Type">typeRef</a><span class="delimiter">(</span><a href="#543556" title="Reshape.this.global.Tree">pre</a>.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a>, <a href="../../internal/Definitions.scala.html#408918" title="=&gt; Reshape.this.global.Symbol{def name: Reshape.this.global.Name{type ThisNameType &gt;: Reshape.this.global.TypeName with Reshape.this.global.TermName &lt;: Reshape.this.global.Name}; def rawname: Reshape.this.global.Name{type ThisNameType &gt;: Reshape.this.global.TypeName with Reshape.this.global.TermName &lt;: Reshape.this.global.Name}; type TypeOfClonedSymbol &gt;: Reshape.this.global.ClassSymbol with Reshape.this.global.NoSymbol &lt;: Reshape.this.global.Symbol{type TypeOfClonedSymbol &gt;: Reshape.this.global.ClassSymbol with Reshape.this.global.NoSymbol &lt;: Reshape.this.global.Symbol; type NameType &gt;: Reshape.this.global.TypeName with Reshape.this.global.TermName &lt;: Reshape.this.global.Name}; type NameType &gt;: Reshape.this.global.TypeName with Reshape.this.global.TermName &lt;: Reshape.this.global.Name{type ThisNameType &gt;: Reshape.this.global.TypeName with Reshape.this.global.TermName &lt;: Reshape.this.global.Name}}">WeakTypeTagClass</a>, <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: Reshape.this.global.Type*)List[Reshape.this.global.Type]">List</a><span class="delimiter">(</span><a href="#543543" title="Reshape.this.global.Tree">tt</a>.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> Apply<span class="delimiter">(</span>TypeApply<a href="../../internal/Trees.scala.html#410031" title="Reshape.this.global.Tree" id="3294776" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410043" title="Reshape.this.global.Tree" id="3294773">_</a>, <a href="../../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[Reshape.this.global.Tree]]" id="3294795">List</a><a href="../../internal/Trees.scala.html#410045" title="List[Reshape.this.global.Tree]" id="3294774" class="delimiter">(</a><a title="Reshape.this.global.Tree" id="543659">tt</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="../../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[Reshape.this.global.Tree]]" id="3294794">List</a><a href="../../internal/Trees.scala.html#410033" title="List[Reshape.this.global.Tree]" id="3294770" class="delimiter">(</a><a title="Reshape.this.global.Tree" id="543672">pre</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#543428" title="Reshape.this.global.Tree">original</a>.<a href="../../internal/Trees.scala.html#408577" title="=&gt; Reshape.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../internal/Definitions.scala.html#408928" title="=&gt; Reshape.this.global.Symbol{def name: Reshape.this.global.TermName; def rawname: Reshape.this.global.TermName; type TypeOfClonedSymbol &gt;: Reshape.this.global.TermSymbol with Reshape.this.global.NoSymbol &lt;: Reshape.this.global.Symbol{def name: Reshape.this.global.TermName; def rawname: Reshape.this.global.TermName; type TypeOfClonedSymbol &gt;: Reshape.this.global.TermSymbol with Reshape.this.global.NoSymbol &lt;: Reshape.this.global.Symbol; type NameType &lt;: Reshape.this.global.TermName}; type NameType &lt;: Reshape.this.global.TermName}">materializeTypeTag</a> =&gt;
              <a href="../../../tools/nsc/Global.scala.html#537460" title="Reshape.this.global.gen.type">gen</a>.<a href="../../internal/TreeGen.scala.html#470984" title="(method: Reshape.this.global.gen.global.Symbol, targs: List[Reshape.this.global.gen.global.Type])Reshape.this.global.gen.global.Tree">mkNullaryCall</a><a href="#3294785" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a><a href="../../internal/Definitions.scala.html#408747" title="=&gt; Reshape.this.global.TermSymbol">Predef_implicitly</a>, <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: Reshape.this.global.Type*)List[Reshape.this.global.Type]">List</a><span class="delimiter">(</span><a href="../../internal/Types.scala.html#407402" title="(pre: Reshape.this.global.Type, sym: Reshape.this.global.Symbol, args: List[Reshape.this.global.Type])Reshape.this.global.Type">typeRef</a><span class="delimiter">(</span><a href="#543672" title="Reshape.this.global.Tree">pre</a>.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a>, <a href="../../internal/Definitions.scala.html#408922" title="=&gt; Reshape.this.global.Symbol{def name: Reshape.this.global.Name{type ThisNameType &gt;: Reshape.this.global.TypeName with Reshape.this.global.TermName &lt;: Reshape.this.global.Name}; def rawname: Reshape.this.global.Name{type ThisNameType &gt;: Reshape.this.global.TypeName with Reshape.this.global.TermName &lt;: Reshape.this.global.Name}; type TypeOfClonedSymbol &gt;: Reshape.this.global.ClassSymbol with Reshape.this.global.NoSymbol &lt;: Reshape.this.global.Symbol{type TypeOfClonedSymbol &gt;: Reshape.this.global.ClassSymbol with Reshape.this.global.NoSymbol &lt;: Reshape.this.global.Symbol; type NameType &gt;: Reshape.this.global.TypeName with Reshape.this.global.TermName &lt;: Reshape.this.global.Name}; type NameType &gt;: Reshape.this.global.TypeName with Reshape.this.global.TermName &lt;: Reshape.this.global.Name{type ThisNameType &gt;: Reshape.this.global.TypeName with Reshape.this.global.TermName &lt;: Reshape.this.global.Name}}">TypeTagClass</a>, <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: Reshape.this.global.Type*)List[Reshape.this.global.Type]">List</a><span class="delimiter">(</span><a href="#543659" title="Reshape.this.global.Tree">tt</a>.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> _ =&gt;
              <a href="#3294785" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree">original</a>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> _ =&gt; <a href="#3294856" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree">tree</a>
      <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(mods: Reshape.this.global.Modifiers)Reshape.this.global.Modifiers" id="542662">transformModifiers</a><span class="delimiter">(</span><a title="Reshape.this.global.Modifiers" id="543316">mods</a>: <a href="../../internal/Trees.scala.html#408095" title="Reshape.this.global.Modifiers">Modifiers</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Reshape.this.global.Modifiers" id="543318">mods1</a> = <a href="#542663" title="(mods: Reshape.this.global.Modifiers, sym: Reshape.this.global.Symbol)Reshape.this.global.Modifiers">toPreTyperModifiers</a><span class="delimiter">(</span><a href="#543316" title="Reshape.this.global.Modifiers">mods</a>, <a href="#542658" title="=&gt; Reshape.this.global.Symbol">currentSymbol</a><span class="delimiter">)</span>
      <a href="#542652" title="Reshape.this.global.Transformer{def currentSymbol: Reshape.this.global.Symbol; def currentSymbol_=(x$1: Reshape.this.global.Symbol): Unit}" class="keyword">super</a>.<a href="../../api/Trees.scala.html#405662" title="(mods: Reshape.this.global.Modifiers)Reshape.this.global.Modifiers">transformModifiers</a><span class="delimiter">(</span><a href="#543318" title="Reshape.this.global.Modifiers">mods1</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(mods: Reshape.this.global.Modifiers, sym: Reshape.this.global.Symbol)Reshape.this.global.Modifiers" id="542663">toPreTyperModifiers</a><span class="delimiter">(</span><a title="Reshape.this.global.Modifiers" id="543319">mods</a>: <a href="../../internal/Trees.scala.html#408095" title="Reshape.this.global.Modifiers">Modifiers</a>, <a title="Reshape.this.global.Symbol" id="543320">sym</a>: <a href="../../internal/Symbols.scala.html#407146" title="Reshape.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="Reshape.this.global.Modifiers" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#543320" title="Reshape.this.global.Symbol">sym</a>.<a href="../../internal/Symbols.scala.html#411400" title="=&gt; List[Reshape.this.global.AnnotationInfo]">annotations</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> Modifiers<a href="#3294863" title="(x: (Long, Reshape.this.global.Name, List[Reshape.this.global.Tree]))(Long, Reshape.this.global.Name, List[Reshape.this.global.Tree])" class="delimiter">(</a><a href="../../internal/Trees.scala.html#409800" title="Long" id="543323">flags</a>, <a href="../../internal/Trees.scala.html#409802" title="Reshape.this.global.Name" id="543324">privateWithin</a>, <a href="../../internal/Trees.scala.html#409804" title="List[Reshape.this.global.Tree]" id="543325">annotations</a><span class="delimiter">)</span> = <a href="#543319" title="Reshape.this.global.Modifiers">mods</a>
        <span class="keyword">val</span> <a title="List[Reshape.this.global.AnnotationInfo]" id="543326">postTyper</a> = <a href="#543320" title="Reshape.this.global.Symbol">sym</a>.<a href="../../internal/Symbols.scala.html#411400" title="=&gt; List[Reshape.this.global.AnnotationInfo]">annotations</a> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: Reshape.this.global.AnnotationInfo =&gt; Boolean)List[Reshape.this.global.AnnotationInfo]">filter</a> <span class="delimiter">(</span><a href="#543358" title="Reshape.this.global.AnnotationInfo">_</a>.<a href="../../internal/AnnotationInfos.scala.html#409733" title="=&gt; Reshape.this.global.Tree">original</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../internal/Trees.scala.html#407946" title="Reshape.this.global.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#543326" title="List[Reshape.this.global.AnnotationInfo]">postTyper</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;reify symbol annotations for: &quot;)" class="string">&quot;reify symbol annotations for: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#543320" title="Reshape.this.global.Symbol">sym</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#543326" title="List[Reshape.this.global.AnnotationInfo]">postTyper</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;originals are: &quot;)" class="string">&quot;originals are: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#543320" title="Reshape.this.global.Symbol">sym</a>.<a href="../../internal/Symbols.scala.html#411400" title="=&gt; List[Reshape.this.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="List[Reshape.this.global.Tree]" id="543327">preTyper</a> = <a href="#543326" title="List[Reshape.this.global.AnnotationInfo]">postTyper</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: Reshape.this.global.AnnotationInfo =&gt; Reshape.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.AnnotationInfo],Reshape.this.global.Tree,List[Reshape.this.global.Tree]])List[Reshape.this.global.Tree]">map</a> <a href="#542668" title="(ann: Reshape.this.global.AnnotationInfo)Reshape.this.global.Tree">toPreTyperAnnotation</a>
        <a href="#543319" title="Reshape.this.global.Modifiers">mods</a>.<a href="../../internal/Trees.scala.html#409820" title="(annots: List[Reshape.this.global.Tree])Reshape.this.global.Modifiers">withAnnotations</a><span class="delimiter">(</span><a href="#543327" title="List[Reshape.this.global.Tree]">preTyper</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#543319" title="Reshape.this.global.Modifiers">mods</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /** Restore pre-typer representation of a type.
     *
     *  NB: This is the trickiest part of reification!
     *
     *  In most cases, we're perfectly fine to reify a Type itself (see ``reifyType'').
     *  However if the type involves a symbol declared inside the quasiquote (i.e. registered in ``boundSyms''),
     *  then we cannot reify it, or otherwise subsequent reflective compilation will fail.
     *
     *  Why will it fail? Because reified deftrees (e.g. ClassDef(...)) will generate fresh symbols during that compilation,
     *  so naively reified symbols will become out of sync, which brings really funny compilation errors and/or crashes, e.g.:
     *  https://issues.scala-lang.org/browse/SI-5230
     *
     *  To deal with this unpleasant fact, we need to fall back from types to equivalent trees (after all, parser trees don't contain any types, just trees, so it should be possible).
     *  Luckily, these original trees get preserved for us in the ``original'' field when Trees get transformed into TypeTrees.
     *  And if an original of a type tree is empty, we can safely assume that this type is non-essential (e.g. was inferred/generated by the compiler).
     *  In that case the type can be omitted (e.g. reified as an empty TypeTree), since it will be inferred again later on.
     *
     *  An important property of the original is that it isn't just a pre-typer tree.
     *  It's actually kind of a post-typer tree with symbols assigned to its Idents (e.g. Ident(&quot;List&quot;) will contain a symbol that points to immutable.this.List).
     *  This is very important, since subsequent reflective compilation won't have to resolve these symbols.
     *  In general case, such resolution cannot be performed, since reification doesn't preserve lexical context,
     *  which means that reflective compilation won't be aware of, say, imports that were provided when the reifee has been compiled.
     *
     *  This workaround worked surprisingly well and allowed me to fix several important reification bugs, until the abstraction has leaked.
     *  Suddenly I found out that in certain contexts original trees do not contain symbols, but are just parser trees.
     *  To the moment I know only one such situation: typedAnnotations does not typecheck the annotation in-place, but rather creates new trees and typechecks them, so the original remains symless.
     *  Thus we apply a workaround for that in typedAnnotated. I hope this will be the only workaround in this department.
     *  upd. There are also problems with CompoundTypeTrees. I had to use attachments to retain necessary information.
     *
     *  upd. Recently I went ahead and started using original for all TypeTrees, regardless of whether they refer to local symbols or not.
     *  As a result, ``reifyType'' is never called directly by tree reification (and, wow, it seems to work great!).
     *  The only usage of ``reifyType'' now is for servicing typetags, however, I have some ideas how to get rid of that as well.
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tt: Reshape.this.global.TypeTree)Boolean" id="542664">isDiscarded</a><span class="delimiter">(</span><a title="Reshape.this.global.TypeTree" id="542803">tt</a>: <a href="../../internal/Trees.scala.html#408084" title="Reshape.this.global.TypeTree">TypeTree</a><span class="delimiter">)</span> = <a href="#542803" title="Reshape.this.global.TypeTree">tt</a>.<a href="../../internal/Trees.scala.html#409893" title="=&gt; Reshape.this.global.Tree">original</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tt: Reshape.this.global.TypeTree)Reshape.this.global.Tree" id="542665">toPreTyperTypeTree</a><span class="delimiter">(</span><a title="Reshape.this.global.TypeTree" id="542684">tt</a>: <a href="../../internal/Trees.scala.html#408084" title="Reshape.this.global.TypeTree">TypeTree</a><span class="delimiter">)</span>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      <span title="Reshape.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#542664" title="(tt: Reshape.this.global.TypeTree)Boolean">isDiscarded</a><span class="delimiter">(</span><a href="#542684" title="Reshape.this.global.TypeTree">tt</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        // here we rely on the fact that the originals that reach this point
        // have all necessary symbols attached to them (i.e. that they can be recompiled in any lexical context)
        // if this assumption fails, please, don't be quick to add postprocessing here (like I did before)
        // but rather try to fix this in Typer, so that it produces quality originals (like it's done for typedAnnotated)
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;TypeTree, essential: %s (%s)&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#542684" title="Reshape.this.global.TypeTree">tt</a>.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a>, <a href="#542684" title="Reshape.this.global.TypeTree">tt</a>.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a>.<a href="../../internal/Types.scala.html#408517" title="=&gt; String">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;verdict: rolled back to original %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#542684" title="Reshape.this.global.TypeTree">tt</a>.<a href="../../internal/Trees.scala.html#409893" title="=&gt; Reshape.this.global.Tree">original</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#542660" title="(tree0: Reshape.this.global.Tree)Reshape.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#542684" title="Reshape.this.global.TypeTree">tt</a>.<a href="../../internal/Trees.scala.html#409893" title="=&gt; Reshape.this.global.Tree">original</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        // type is deemed to be non-essential
        // erase it and hope that subsequent reflective compilation will be able to recreate it again
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;TypeTree, non-essential: %s (%s)&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#542684" title="Reshape.this.global.TypeTree">tt</a>.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a>, <a href="#542684" title="Reshape.this.global.TypeTree">tt</a>.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a>.<a href="../../internal/Types.scala.html#408517" title="=&gt; String">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;verdict: discarded&quot;)" class="string">&quot;verdict: discarded&quot;</span><span class="delimiter">)</span>
        <a href="../../internal/Trees.scala.html#418149" title="()Reshape.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ctt: Reshape.this.global.CompoundTypeTree)Reshape.this.global.Tree" id="542666">toPreTyperCompoundTypeTree</a><span class="delimiter">(</span><a title="Reshape.this.global.CompoundTypeTree" id="542687">ctt</a>: <a href="../../internal/Trees.scala.html#408072" title="Reshape.this.global.CompoundTypeTree">CompoundTypeTree</a><span class="delimiter">)</span>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> CompoundTypeTree<a href="#3294869" title="(x: (Reshape.this.global.Template, List[Reshape.this.global.Tree], Reshape.this.global.ValDef, List[Reshape.this.global.Tree]))(Reshape.this.global.Template, List[Reshape.this.global.Tree], Reshape.this.global.ValDef, List[Reshape.this.global.Tree])" class="delimiter">(</a><a href="../../internal/Trees.scala.html#409932" title="Reshape.this.global.Template" id="543771">tmpl</a> @ Template<span class="delimiter">(</span><a href="../../internal/Trees.scala.html#410203" title="List[Reshape.this.global.Tree]" id="543772">parents</a>, <a href="../../internal/Trees.scala.html#410205" title="Reshape.this.global.ValDef" id="543773">self</a>, <a href="../../internal/Trees.scala.html#410207" title="List[Reshape.this.global.Tree]" id="543774">stats</a><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="#542687" title="Reshape.this.global.CompoundTypeTree">ctt</a>
      <a href="../../../tools/nsc/Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#543773" title="Reshape.this.global.ValDef">self</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../internal/Trees.scala.html#408104" title="Reshape.this.global.emptyValDef.type">emptyValDef</a>, <a href="#543773" title="Reshape.this.global.ValDef">self</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Option[Reshape.this.global.CompoundTypeTreeOriginalAttachment]" id="543775">att</a> = <a href="#543771" title="Reshape.this.global.Template">tmpl</a>.<a href="../../internal/StdAttachments.scala.html#409595" title="=&gt; scala.reflect.macros.Attachments{type Pos = Reshape.this.global.Position}">attachments</a>.<a href="../../macros/Attachments.scala.html#402528" title="[T](implicit evidence$2: scala.reflect.ClassTag[T])Option[T]">get</a><a href="../../ClassTag.scala.html#81051" title="(implicit evidence$2: scala.reflect.ClassTag[Reshape.this.global.CompoundTypeTreeOriginalAttachment])Option[Reshape.this.global.CompoundTypeTreeOriginalAttachment]" class="delimiter">[</a><a href="../../internal/StdAttachments.scala.html#408348" title="Reshape.this.global.CompoundTypeTreeOriginalAttachment">CompoundTypeTreeOriginalAttachment</a><span class="delimiter">]</span>
      <span class="keyword">val</span> CompoundTypeTreeOriginalAttachment<a href="#3294875" title="(x: (List[Reshape.this.global.Tree], List[Reshape.this.global.Tree]))(List[Reshape.this.global.Tree], List[Reshape.this.global.Tree])" class="delimiter">(</a><a href="../../internal/StdAttachments.scala.html#464740" title="List[Reshape.this.global.Tree]" id="543777">parents1</a>, <a href="../../internal/StdAttachments.scala.html#464742" title="List[Reshape.this.global.Tree]" id="543778">stats1</a><span class="delimiter">)</span> = <a href="#543775" title="Option[Reshape.this.global.CompoundTypeTreeOriginalAttachment]">att</a>.<a href="../../../Option.scala.html#62859" title="(default: =&gt; Reshape.this.global.CompoundTypeTreeOriginalAttachment)Reshape.this.global.CompoundTypeTreeOriginalAttachment">getOrElse</a><a href="../../internal/StdAttachments.scala.html#408348" title="Reshape.this.global.CompoundTypeTreeOriginalAttachment @unchecked" class="delimiter">(</a><a href="../../internal/StdAttachments.scala.html#464825" title="(parents: List[Reshape.this.global.Tree], stats: List[Reshape.this.global.Tree])Reshape.this.global.CompoundTypeTreeOriginalAttachment">CompoundTypeTreeOriginalAttachment</a><span class="delimiter">(</span><a href="#543772" title="List[Reshape.this.global.Tree]">parents</a>, <a href="#543774" title="List[Reshape.this.global.Tree]">stats</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../internal/Trees.scala.html#454350" title="(templ: Reshape.this.global.Template)Reshape.this.global.CompoundTypeTree">CompoundTypeTree</a><span class="delimiter">(</span><a href="../../internal/Trees.scala.html#452941" title="(parents: List[Reshape.this.global.Tree], self: Reshape.this.global.ValDef, body: List[Reshape.this.global.Tree])Reshape.this.global.Template">Template</a><span class="delimiter">(</span><a href="#543777" title="List[Reshape.this.global.Tree]">parents1</a>, <a href="#543773" title="Reshape.this.global.ValDef">self</a>, <a href="#543778" title="List[Reshape.this.global.Tree]">stats1</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree" id="542667">toPreTyperTypedOrAnnotated</a><span class="delimiter">(</span><a title="Reshape.this.global.Tree" id="542695">tree</a>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a> = <a href="#542695" title="Reshape.this.global.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> ty @ Typed<a href="#3294896" title="Reshape.this.global.Tree" id="3294898" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410055" title="Reshape.this.global.Tree" id="543846">expr1</a>, <a href="../../internal/Trees.scala.html#410057" title="Reshape.this.global.Tree" id="543847">tt</a> @ TypeTree<a href="#543847" title="Reshape.this.global.Tree" id="3294900" class="delimiter">(</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;reify typed: &quot;)" class="string">&quot;reify typed: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#542695" title="Reshape.this.global.Tree">tree</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Reshape.this.global.Tree" id="543850">annotatedArg</a> = <span class="delimiter">{</span>
          <span class="keyword">def</span> <a title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree" id="543853">loop</a><span class="delimiter">(</span><a title="Reshape.this.global.Tree" id="543854">tree</a>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a> = <a href="#543854" title="Reshape.this.global.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> annotated1 @ Annotated<a href="#3294879" title="Boolean" id="3294881" class="delimiter">(</a><a href="../../internal/Trees.scala.html#409965" title="Reshape.this.global.Tree" id="543858">ann</a>, <a href="../../internal/Trees.scala.html#409967" title="Reshape.this.global.Tree" id="543859">annotated2</a> @ Annotated<a href="#543859" title="Reshape.this.global.Tree" id="3294885" class="delimiter">(</a><a href="../../internal/Trees.scala.html#409965" title="Reshape.this.global.Tree" id="3294882">_</a>, <a href="../../internal/Trees.scala.html#409967" title="Reshape.this.global.Tree" id="3294883">_</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#543853" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree">loop</a><a href="#3294890" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a>annotated2<span class="delimiter">)</span>
            <span class="keyword">case</span> annotated1 @ Annotated<span class="delimiter">(</span><a href="../../internal/Trees.scala.html#409965" title="Reshape.this.global.Tree" id="543865">ann</a>, <a href="../../internal/Trees.scala.html#409967" title="Reshape.this.global.Tree" id="543866">arg</a><span class="delimiter">)</span> =&gt; <a href="#3294890" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree">arg</a>
            <span class="keyword">case</span> _ =&gt; <a href="#3294890" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree">EmptyTree</a>
          <span class="delimiter">}</span>

          <a href="#543853" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree">loop</a><span class="delimiter">(</span>tt.<a href="../../internal/Trees.scala.html#409893" title="=&gt; Reshape.this.global.Tree">original</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span title="Reshape.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#543850" title="Reshape.this.global.Tree">annotatedArg</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../internal/Trees.scala.html#407946" title="Reshape.this.global.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Reshape.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#543850" title="Reshape.this.global.Tree">annotatedArg</a>.<a href="../../internal/Trees.scala.html#408584" title="=&gt; Boolean">isType</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;verdict: was an annotated type, reify as usual&quot;)" class="string">&quot;verdict: was an annotated type, reify as usual&quot;</span><span class="delimiter">)</span>
            ty
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;verdict: was an annotated value, equivalent is &quot;)" class="string">&quot;verdict: was an annotated value, equivalent is &quot;</span> <span title="(x$1: Any)String">+</span> tt.<a href="../../internal/Trees.scala.html#409893" title="=&gt; Reshape.this.global.Tree">original</a><span class="delimiter">)</span>
            <a href="#542667" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Tree">toPreTyperTypedOrAnnotated</a><span class="delimiter">(</span>tt.<a href="../../internal/Trees.scala.html#409893" title="=&gt; Reshape.this.global.Tree">original</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;verdict: wasn\'t annotated, reify as usual&quot;)" class="string">&quot;verdict: wasn't annotated, reify as usual&quot;</span><span class="delimiter">)</span>
          ty
        <span class="delimiter">}</span>
      <span class="keyword">case</span> at @ Annotated<a href="#3294896" title="Reshape.this.global.Tree" id="3294902" class="delimiter">(</a><a href="../../internal/Trees.scala.html#409965" title="Reshape.this.global.Tree" id="543880">annot</a>, <a href="../../internal/Trees.scala.html#409967" title="Reshape.this.global.Tree" id="543881">arg</a><span class="delimiter">)</span> =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;reify type annotations for: &quot;)" class="string">&quot;reify type annotations for: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#542695" title="Reshape.this.global.Tree">tree</a><span class="delimiter">)</span>
        <a href="../../../tools/nsc/Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span>at.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../internal/Types.scala.html#407375" title="Reshape.this.global.AnnotatedType">AnnotatedType</a><span class="delimiter">]</span>, <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s (%s)&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span>at.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a>, at.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a>.<a href="../../internal/Types.scala.html#408517" title="=&gt; String">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Reshape.this.global.Tree" id="543882">annot1</a> = <a href="#542668" title="(ann: Reshape.this.global.AnnotationInfo)Reshape.this.global.Tree">toPreTyperAnnotation</a><span class="delimiter">(</span>at.<a href="../../internal/Trees.scala.html#408573" title="=&gt; Reshape.this.global.Type">tpe</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Reshape.this.global.AnnotatedType" class="delimiter">[</span><a href="../../internal/Types.scala.html#407375" title="Reshape.this.global.AnnotatedType">AnnotatedType</a><span class="delimiter">]</span>.<a href="../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)Reshape.this.global.AnnotationInfo">annotations</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;originals are: &quot;)" class="string">&quot;originals are: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#543882" title="Reshape.this.global.Tree">annot1</a><span class="delimiter">)</span>
        <a href="../../internal/Trees.scala.html#454290" title="(annot: Reshape.this.global.Tree, arg: Reshape.this.global.Tree)Reshape.this.global.Annotated">Annotated</a><span class="delimiter">(</span><a href="#543882" title="Reshape.this.global.Tree">annot1</a>, <a href="#543881" title="Reshape.this.global.Tree">arg</a><span class="delimiter">)</span>.<a href="../../internal/Trees.scala.html#408585" title="(tree: Reshape.this.global.Tree)Reshape.this.global.Annotated">copyAttrs</a><span class="delimiter">(</span>at<span class="delimiter">)</span>
    <span class="delimiter">}</span>

    /** Restore pre-typer representation of an annotation.
     *  The trick here is to retain the symbols that have been populated during typechecking of the annotation.
     *  If we do not do that, subsequent reflective compilation will fail.
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ann: Reshape.this.global.AnnotationInfo)Reshape.this.global.Tree" id="542668">toPreTyperAnnotation</a><span class="delimiter">(</span><a title="Reshape.this.global.AnnotationInfo" id="543383">ann</a>: <a href="../../internal/AnnotationInfos.scala.html#407923" title="Reshape.this.global.AnnotationInfo">AnnotationInfo</a><span class="delimiter">)</span>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[Reshape.this.global.Tree]" id="543909">args</a> = <span title="List[Reshape.this.global.Tree]" class="keyword">if</span> <span class="delimiter">(</span><a href="#543383" title="Reshape.this.global.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#409729" title="=&gt; List[(Reshape.this.global.Name, Reshape.this.global.ClassfileAnnotArg)]">assocs</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#543383" title="Reshape.this.global.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#409728" title="=&gt; List[Reshape.this.global.Tree]">args</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="(jann: Reshape.this.global.ClassfileAnnotArg)Reshape.this.global.Tree" id="543912">toScalaAnnotation</a><span class="delimiter">(</span><a title="Reshape.this.global.ClassfileAnnotArg" id="543913">jann</a>: <a href="../../internal/AnnotationInfos.scala.html#407885" title="Reshape.this.global.ClassfileAnnotArg">ClassfileAnnotArg</a><span class="delimiter">)</span>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a> = <a href="#543913" title="Reshape.this.global.ClassfileAnnotArg">jann</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> LiteralAnnotArg<a href="#3294909" title="Reshape.this.global.Tree" id="3294911" class="delimiter">(</a><a href="../../internal/AnnotationInfos.scala.html#409718" title="Reshape.this.global.Constant" id="543915">const</a><span class="delimiter">)</span> =&gt;
            <a href="../../internal/Trees.scala.html#413609" title="(value: Reshape.this.global.Constant)Reshape.this.global.Literal">Literal</a><a href="#3294917" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a><a href="#543915" title="Reshape.this.global.Constant">const</a><span class="delimiter">)</span>
          <span class="keyword">case</span> ArrayAnnotArg<a href="#3294909" title="Reshape.this.global.Tree" id="3294913" class="delimiter">(</a><a href="../../internal/AnnotationInfos.scala.html#409711" title="Array[Reshape.this.global.ClassfileAnnotArg]" id="543919">arr</a><span class="delimiter">)</span> =&gt;
            <a href="../../internal/Trees.scala.html#413581" title="(fun: Reshape.this.global.Tree, args: List[Reshape.this.global.Tree])Reshape.this.global.Apply">Apply</a><a href="#3294917" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a><a href="../../internal/Trees.scala.html#408127" title="(sym: Reshape.this.global.Symbol)Reshape.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="../../internal/Definitions.scala.html#407777" title="Reshape.this.global.definitions.type">definitions</a>.<a href="../../internal/Definitions.scala.html#408857" title="=&gt; Reshape.this.global.ModuleSymbol">ArrayModule</a><span class="delimiter">)</span>, <a href="../../../Predef.scala.html#7555" title="(xs: Array[Reshape.this.global.ClassfileAnnotArg])scala.collection.mutable.ArrayOps[Reshape.this.global.ClassfileAnnotArg]">arr</a>.<a href="../../../collection/TraversableOnce.scala.html#58263" title="=&gt; List[Reshape.this.global.ClassfileAnnotArg]">toList</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: Reshape.this.global.ClassfileAnnotArg =&gt; Reshape.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.ClassfileAnnotArg],Reshape.this.global.Tree,List[Reshape.this.global.Tree]])List[Reshape.this.global.Tree]">map</a> <a href="#543912" title="(jann: Reshape.this.global.ClassfileAnnotArg)Reshape.this.global.Tree">toScalaAnnotation</a><span class="delimiter">)</span>
          <span class="keyword">case</span> NestedAnnotArg<a href="#3294909" title="Reshape.this.global.Tree" id="3294915" class="delimiter">(</a><a href="../../internal/AnnotationInfos.scala.html#409703" title="Reshape.this.global.AnnotationInfo" id="544061">ann</a><span class="delimiter">)</span> =&gt;
            <a href="#542668" title="(ann: Reshape.this.global.AnnotationInfo)Reshape.this.global.Tree">toPreTyperAnnotation</a><a href="#3294917" title="(x: Reshape.this.global.Tree)Reshape.this.global.Tree" class="delimiter">(</a><a href="#544061" title="Reshape.this.global.AnnotationInfo">ann</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <a href="#543383" title="Reshape.this.global.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#409729" title="=&gt; List[(Reshape.this.global.Name, Reshape.this.global.ClassfileAnnotArg)]">assocs</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: ((Reshape.this.global.Name, Reshape.this.global.ClassfileAnnotArg)) =&gt; Reshape.this.global.AssignOrNamedArg)(implicit bf: scala.collection.generic.CanBuildFrom[List[(Reshape.this.global.Name, Reshape.this.global.ClassfileAnnotArg)],Reshape.this.global.AssignOrNamedArg,List[Reshape.this.global.AssignOrNamedArg]])List[Reshape.this.global.AssignOrNamedArg]">map</a> <a href="#544085" title="(Reshape.this.global.Name, Reshape.this.global.ClassfileAnnotArg)" class="delimiter">{</a> <span class="keyword">case</span> <span class="delimiter">(</span><a href="../../../Tuple2.scala.html#60635" title="Reshape.this.global.Name" id="544088">nme</a>, <a href="../../../Tuple2.scala.html#60637" title="Reshape.this.global.ClassfileAnnotArg" id="544089">arg</a><span class="delimiter">)</span> =&gt; <a href="../../internal/Trees.scala.html#453539" title="(lhs: Reshape.this.global.Tree, rhs: Reshape.this.global.Tree)Reshape.this.global.AssignOrNamedArg">AssignOrNamedArg</a><a href="#3294925" title="(x: Reshape.this.global.AssignOrNamedArg)Reshape.this.global.AssignOrNamedArg" class="delimiter">(</a><a href="../../internal/Trees.scala.html#418125" title="(name: Reshape.this.global.Name)Reshape.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#544088" title="Reshape.this.global.Name">nme</a><span class="delimiter">)</span>, <a href="#543912" title="(jann: Reshape.this.global.ClassfileAnnotArg)Reshape.this.global.Tree">toScalaAnnotation</a><span class="delimiter">(</span><a href="#544089" title="Reshape.this.global.ClassfileAnnotArg">arg</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="=&gt; PartialFunction[Reshape.this.global.Tree,Reshape.this.global.Tree]" id="543910">extractOriginal</a>: <a href="../../../PartialFunction.scala.html#129" title="PartialFunction[Reshape.this.global.Tree,Reshape.this.global.Tree]">PartialFunction</a><span class="delimiter">[</span>Tree, Tree<span class="delimiter">]</span> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.global.Tree,Reshape.this.global.Tree] with Serializable" id="544167" class="delimiter">{</a> <span class="keyword">case</span> Apply<a href="#3294929" title="B1" id="3294950" class="delimiter">(</a>Select<a href="../../internal/Trees.scala.html#410031" title="Reshape.this.global.Tree" id="3294954" class="delimiter">(</a>New<a href="../../internal/Trees.scala.html#409999" title="Reshape.this.global.Tree" id="3294956" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410063" title="Reshape.this.global.Tree" id="544181">tpt</a><span class="delimiter">)</span>, <a href="../../internal/Trees.scala.html#410001" title="Reshape.this.global.Name" id="3294952">_</a><span class="delimiter">)</span>, <a href="../../internal/Trees.scala.html#410033" title="List[Reshape.this.global.Tree]" id="3294948">_</a><span class="delimiter">)</span> =&gt; <a href="#3294941" title="(x: B1)B1">tpt</a> <span class="delimiter">}</span>
      <a href="../../../tools/nsc/Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#543910" title="=&gt; PartialFunction[Reshape.this.global.Tree,Reshape.this.global.Tree]">extractOriginal</a>.<a href="../../../PartialFunction.scala.html#58653" title="(x: Reshape.this.global.Tree)Boolean">isDefinedAt</a><span class="delimiter">(</span><a href="#543383" title="Reshape.this.global.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#409733" title="=&gt; Reshape.this.global.Tree">original</a><span class="delimiter">)</span>, <a href="../../api/Printers.scala.html#56608" title="(any: Any, printTypes: Reshape.this.global.BooleanFlag, printIds: Reshape.this.global.BooleanFlag, printKinds: Reshape.this.global.BooleanFlag, printMirrors: Reshape.this.global.BooleanFlag)String">showRaw</a><span class="delimiter">(</span><a href="#543383" title="Reshape.this.global.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#409733" title="=&gt; Reshape.this.global.Tree">original</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../internal/Trees.scala.html#408119" title="(tpt: Reshape.this.global.Tree, argss: List[List[Reshape.this.global.Tree]])Reshape.this.global.Tree">New</a><span class="delimiter">(</span><a href="../../internal/Trees.scala.html#408087" title="(tp: Reshape.this.global.Type)Reshape.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="#543383" title="Reshape.this.global.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#409727" title="=&gt; Reshape.this.global.Type">atp</a><span class="delimiter">)</span> <a href="../../internal/Trees.scala.html#409894" title="(tree: Reshape.this.global.Tree)Reshape.this.global.TypeTree">setOriginal</a> <a href="../../../Function1.scala.html#58642" title="(v1: Reshape.this.global.Tree)Reshape.this.global.Tree">extractOriginal</a><span class="delimiter">(</span><a href="#543383" title="Reshape.this.global.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#409733" title="=&gt; Reshape.this.global.Tree">original</a><span class="delimiter">)</span>, <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: List[Reshape.this.global.Tree]*)List[List[Reshape.this.global.Tree]]">List</a><span class="delimiter">(</span><a href="#543909" title="List[Reshape.this.global.Tree]">args</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(deff: Reshape.this.global.Tree, stats: List[Reshape.this.global.Tree])List[Reshape.this.global.Tree]" id="542669">trimAccessors</a><span class="delimiter">(</span><a title="Reshape.this.global.Tree" id="542893">deff</a>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a>, <a title="List[Reshape.this.global.Tree]" id="542894">stats</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Reshape.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Reshape.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.Map[Reshape.this.global.Symbol,Reshape.this.global.ValOrDefDef]" id="544242">symdefs</a> = <span class="delimiter">(</span><a href="#542894" title="List[Reshape.this.global.Tree]">stats</a> <a href="../../../collection/TraversableLike.scala.html#58075" title="(pf: PartialFunction[Reshape.this.global.Tree,Reshape.this.global.ValOrDefDef])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.Tree],Reshape.this.global.ValOrDefDef,List[Reshape.this.global.ValOrDefDef]])List[Reshape.this.global.ValOrDefDef]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.global.Tree,Reshape.this.global.ValOrDefDef] with Serializable" id="544264" class="delimiter">{</a> <span class="keyword">case</span> <a href="#3294962" title="B1" id="3294978">vodef</a>: ValOrDefDef =&gt; <a href="#3294968" title="(x: B1)B1">vodef</a> <span class="delimiter">}</span> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: Reshape.this.global.ValOrDefDef =&gt; (Reshape.this.global.Symbol, Reshape.this.global.ValOrDefDef))(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.ValOrDefDef],(Reshape.this.global.Symbol, Reshape.this.global.ValOrDefDef),List[(Reshape.this.global.Symbol, Reshape.this.global.ValOrDefDef)]])List[(Reshape.this.global.Symbol, Reshape.this.global.ValOrDefDef)]">map</a> <span class="delimiter">(</span><a title="Reshape.this.global.ValOrDefDef" id="544341">vodeff</a> =&gt; <a href="#544341" title="Reshape.this.global.ValOrDefDef">vodeff</a>.<a href="../../../Predef.scala.html#7509" title="(x: Reshape.this.global.Symbol)ArrowAssoc[Reshape.this.global.Symbol]">symbol</a> <a href="../../../Predef.scala.html#62634" title="(y: Reshape.this.global.ValOrDefDef)(Reshape.this.global.Symbol, Reshape.this.global.ValOrDefDef)">-&gt;</a> <a href="#544341" title="Reshape.this.global.ValOrDefDef">vodeff</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../collection/TraversableOnce.scala.html#58277" title="(implicit ev: &lt;:&lt;[(Reshape.this.global.Symbol, Reshape.this.global.ValOrDefDef),(Reshape.this.global.Symbol, Reshape.this.global.ValOrDefDef)])scala.collection.immutable.Map[Reshape.this.global.Symbol,Reshape.this.global.ValOrDefDef]">toMap</a>
      <span class="keyword">val</span> <a title="scala.collection.mutable.Map[Reshape.this.global.ValDef,List[Reshape.this.global.DefDef]]" id="544243">accessors</a> = scala.collection.mutable.<a href="../../../collection/generic/GenMapFactory.scala.html#60744" title="[A, B](elems: (A, B)*)scala.collection.mutable.Map[A,B]">Map</a><span title="(elems: (Reshape.this.global.ValDef, List[Reshape.this.global.DefDef])*)scala.collection.mutable.Map[Reshape.this.global.ValDef,List[Reshape.this.global.DefDef]]" class="delimiter">[</span><a href="../../internal/Trees.scala.html#407960" title="Reshape.this.global.ValDef">ValDef</a>, <a href="../../../collection/immutable/List.scala.html#11952" title="List[Reshape.this.global.DefDef]">List</a><span class="delimiter">[</span>DefDef<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#542894" title="List[Reshape.this.global.Tree]">stats</a> <a href="../../../collection/TraversableLike.scala.html#58075" title="(pf: PartialFunction[Reshape.this.global.Tree,Reshape.this.global.DefDef])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.Tree],Reshape.this.global.DefDef,List[Reshape.this.global.DefDef]])List[Reshape.this.global.DefDef]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.global.Tree,Reshape.this.global.DefDef] with Serializable" id="544417" class="delimiter">{</a> <span class="keyword">case</span> <a href="#3294984" title="B1" id="3295056">ddef</a>: DefDef =&gt; <a href="#3294990" title="(x: B1)B1">ddef</a> <span class="delimiter">}</span> <a href="../../../collection/immutable/List.scala.html#62719" title="(f: Reshape.this.global.DefDef =&gt; Unit)Unit">foreach</a> <span class="delimiter">(</span><a title="Reshape.this.global.DefDef" id="544498">defdef</a> =&gt; <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Reshape.this.global.ValDef" id="544499">valdef</a> = <a href="#544242" title="scala.collection.immutable.Map[Reshape.this.global.Symbol,Reshape.this.global.ValOrDefDef]">symdefs</a> <a href="../../../collection/MapLike.scala.html#87525" title="(key: Reshape.this.global.Symbol)Option[Reshape.this.global.ValOrDefDef]">get</a> <a href="#544498" title="Reshape.this.global.DefDef">defdef</a>.<a href="../../internal/Trees.scala.html#409939" title="=&gt; Reshape.this.global.Symbol">symbol</a>.<a href="../../internal/Symbols.scala.html#411438" title="=&gt; Reshape.this.global.Symbol">accessedOrSelf</a> <a href="../../../Option.scala.html#62887" title="(pf: PartialFunction[Reshape.this.global.ValOrDefDef,Reshape.this.global.ValDef])Option[Reshape.this.global.ValDef]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.global.ValOrDefDef,Reshape.this.global.ValDef] with Serializable" id="544514" class="delimiter">{</a> <span class="keyword">case</span> <a href="#3295062" title="B1" id="3295134">vdef</a>: ValDef =&gt; <a href="#3295068" title="(x: B1)B1">vdef</a> <span class="delimiter">}</span> <a href="../../../Option.scala.html#62859" title="(default: =&gt; Reshape.this.global.ValDef)Reshape.this.global.ValDef">getOrElse</a> <span title="Null(null)" class="keyword">null</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#544499" title="Reshape.this.global.ValDef">valdef</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../collection/mutable/MapLike.scala.html#87611" title="(key: Reshape.this.global.ValDef, value: List[Reshape.this.global.DefDef])Unit">accessors</a><span class="delimiter">(</span><a href="#544499" title="Reshape.this.global.ValDef">valdef</a><span class="delimiter">)</span> = <a href="#544243" title="scala.collection.mutable.Map[Reshape.this.global.ValDef,List[Reshape.this.global.DefDef]]">accessors</a>.<a href="../../../collection/MapLike.scala.html#87532" title="(key: Reshape.this.global.ValDef, default: =&gt; List[Reshape.this.global.DefDef])List[Reshape.this.global.DefDef]">getOrElse</a><span class="delimiter">(</span><a href="#544499" title="Reshape.this.global.ValDef">valdef</a>, <a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span> <a href="../../../collection/SeqLike.scala.html#58855" title="(elem: Reshape.this.global.DefDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.DefDef],Reshape.this.global.DefDef,List[Reshape.this.global.DefDef]])List[Reshape.this.global.DefDef]">:+</a> <a href="#544498" title="Reshape.this.global.DefDef">defdef</a>

        <span class="keyword">def</span> <a title="(prefix: String)Unit" id="544500">detectBeanAccessors</a><span class="delimiter">(</span><a title="String" id="544621">prefix</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> = <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#544498" title="Reshape.this.global.DefDef">defdef</a>.<a href="../../internal/Trees.scala.html#410280" title="=&gt; Reshape.this.global.Name">name</a>.<a href="../../internal/Names.scala.html#410410" title="(name: String)Boolean">startsWith</a><span class="delimiter">(</span><a href="#544621" title="String">prefix</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">var</span> <a title="String" id="544629">name</a> = <a href="#544498" title="Reshape.this.global.DefDef">defdef</a>.<a href="../../internal/Trees.scala.html#410280" title="=&gt; Reshape.this.global.Name">name</a>.<span title="()String">toString</span>.<span title="(x$1: Int)String">substring</span><span class="delimiter">(</span><a href="#544621" title="String">prefix</a>.<span title="()Int">length</span><span class="delimiter">)</span>
            <span class="keyword">def</span> <a title="(s: String)String" id="544630">uncapitalize</a><span class="delimiter">(</span><a title="String" id="544635">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#544635" title="String">s</a>.<span title="()Int">length</span> <a href="../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <span class="delimiter">{</span> <span class="keyword">val</span> <a title="Array[Char]" id="544641">chars</a> = <a href="#544635" title="String">s</a>.<span title="()Array[Char]">toCharArray</span>; <a href="../../../Array.scala.html#56640" title="(i: Int, x: Char)Unit">chars</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <a href="../../../Array.scala.html#56639" title="(i: Int)Char">chars</a><a href="../../../LowPriorityImplicits.scala.html#7396" title="implicit scala.LowPriorityImplicits.charWrapper : (c: Char)scala.runtime.RichChar" class="delimiter">(</a><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="../../../runtime/RichChar.scala.html#57211" title="=&gt; Char">toLower</a>; <span title="(x$1: Array[Char])String" class="keyword">new</span> <a href="../../../Predef.scala.html#7433" title="String">String</a><span class="delimiter">(</span><a href="#544641" title="Array[Char]">chars</a><span class="delimiter">)</span> <span class="delimiter">}</span>
            <span class="keyword">def</span> <a title="(name: String)Option[Reshape.this.global.ValDef]" id="544631">findValDef</a><span class="delimiter">(</span><a title="String" id="544654">name</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#544242" title="scala.collection.immutable.Map[Reshape.this.global.Symbol,Reshape.this.global.ValOrDefDef]">symdefs</a>.<a href="../../../collection/MapLike.scala.html#87542" title="=&gt; Iterable[Reshape.this.global.ValOrDefDef]">values</a> <a href="../../../collection/TraversableLike.scala.html#58075" title="(pf: PartialFunction[Reshape.this.global.ValOrDefDef,Reshape.this.global.ValDef])(implicit bf: scala.collection.generic.CanBuildFrom[Iterable[Reshape.this.global.ValOrDefDef],Reshape.this.global.ValDef,Iterable[Reshape.this.global.ValDef]])Iterable[Reshape.this.global.ValDef]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.global.ValOrDefDef,Reshape.this.global.ValDef] with Serializable" id="544690" class="delimiter">{</a> <span class="keyword">case</span> <a href="#3295140" title="B1" id="3295212">vdef</a>: ValDef <span class="keyword">if</span> <a href="../../internal/StdNames.scala.html#407871" title="Reshape.this.global.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#414069" title="(name: Reshape.this.global.Name)Reshape.this.global.Name">dropLocalSuffix</a><span class="delimiter">(</span>vdef.<a href="../../internal/Trees.scala.html#410300" title="=&gt; Reshape.this.global.TermName">name</a><span class="delimiter">)</span>.<span title="()String">toString</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#544654" title="String">name</a> =&gt; <a href="#3295146" title="(x: B1)B1">vdef</a> <span class="delimiter">}</span><span class="delimiter">)</span>.<a href="../../../collection/TraversableLike.scala.html#58103" title="=&gt; Option[Reshape.this.global.ValDef]">headOption</a>
            <span class="keyword">val</span> <a title="Reshape.this.global.ValDef" id="544632">valdef</a> = <a href="#544631" title="(name: String)Option[Reshape.this.global.ValDef]">findValDef</a><span class="delimiter">(</span><a href="#544629" title="String">name</a><span class="delimiter">)</span>.<a href="../../../Option.scala.html#62890" title="(alternative: =&gt; Option[Reshape.this.global.ValDef])Option[Reshape.this.global.ValDef]">orElse</a><span class="delimiter">(</span><a href="#544631" title="(name: String)Option[Reshape.this.global.ValDef]">findValDef</a><span class="delimiter">(</span><a href="#544630" title="(s: String)String">uncapitalize</a><span class="delimiter">(</span><a href="#544629" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../Option.scala.html#62862" title="(implicit ev: &lt;:&lt;[Null,Reshape.this.global.ValDef])Reshape.this.global.ValDef">orNull</a>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#544632" title="Reshape.this.global.ValDef">valdef</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../collection/mutable/MapLike.scala.html#87611" title="(key: Reshape.this.global.ValDef, value: List[Reshape.this.global.DefDef])Unit">accessors</a><span class="delimiter">(</span><a href="#544632" title="Reshape.this.global.ValDef">valdef</a><span class="delimiter">)</span> = <a href="#544243" title="scala.collection.mutable.Map[Reshape.this.global.ValDef,List[Reshape.this.global.DefDef]]">accessors</a>.<a href="../../../collection/MapLike.scala.html#87532" title="(key: Reshape.this.global.ValDef, default: =&gt; List[Reshape.this.global.DefDef])List[Reshape.this.global.DefDef]">getOrElse</a><span class="delimiter">(</span><a href="#544632" title="Reshape.this.global.ValDef">valdef</a>, <a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span> <a href="../../../collection/SeqLike.scala.html#58855" title="(elem: Reshape.this.global.DefDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.DefDef],Reshape.this.global.DefDef,List[Reshape.this.global.DefDef]])List[Reshape.this.global.DefDef]">:+</a> <a href="#544498" title="Reshape.this.global.DefDef">defdef</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
        <a href="#544500" title="(prefix: String)Unit">detectBeanAccessors</a><span class="delimiter">(</span><span title="String(&quot;get&quot;)" class="string">&quot;get&quot;</span><span class="delimiter">)</span>
        <a href="#544500" title="(prefix: String)Unit">detectBeanAccessors</a><span class="delimiter">(</span><span title="String(&quot;set&quot;)" class="string">&quot;set&quot;</span><span class="delimiter">)</span>
        <a href="#544500" title="(prefix: String)Unit">detectBeanAccessors</a><span class="delimiter">(</span><span title="String(&quot;is&quot;)" class="string">&quot;is&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>;

      <span class="keyword">var</span> <a title="List[Reshape.this.global.Tree]" id="544244">stats1</a> = <a href="#542894" title="List[Reshape.this.global.Tree]">stats</a> <a href="../../../collection/TraversableLike.scala.html#58068" title="(f: Reshape.this.global.Tree =&gt; scala.collection.GenTraversableOnce[Reshape.this.global.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.Tree],Reshape.this.global.Tree,List[Reshape.this.global.Tree]])List[Reshape.this.global.Tree]">flatMap</a> <a href="#544838" title="Reshape.this.global.Tree" class="delimiter">{</a>
        <span class="keyword">case</span> vdef @ ValDef<a href="#3295224" title="Iterable[Reshape.this.global.Tree]" id="3295226" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410298" title="Reshape.this.global.Modifiers" id="544846">mods</a>, <a href="../../internal/Trees.scala.html#410300" title="Reshape.this.global.TermName" id="544847">name</a>, <a href="../../internal/Trees.scala.html#410302" title="Reshape.this.global.Tree" id="544848">tpt</a>, <a href="../../internal/Trees.scala.html#410304" title="Reshape.this.global.Tree" id="544849">rhs</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="Reshape.this.global.Modifiers" id="544850">mods1</a> = <span title="Reshape.this.global.Modifiers" class="keyword">if</span> <span class="delimiter">(</span><a href="#544243" title="scala.collection.mutable.Map[Reshape.this.global.ValDef,List[Reshape.this.global.DefDef]]">accessors</a>.<a href="../../../collection/MapLike.scala.html#87536" title="(key: Reshape.this.global.ValDef)Boolean">contains</a><span class="delimiter">(</span>vdef<span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="Reshape.this.global.DefDef" id="544856">ddef</a> = <a href="../../../collection/MapLike.scala.html#87535" title="(key: Reshape.this.global.ValDef)List[Reshape.this.global.DefDef]">accessors</a><a href="../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)Reshape.this.global.DefDef" class="delimiter">(</a>vdef<span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> // any accessor will do
            <span class="keyword">val</span> Modifiers<a href="#3295220" title="(x: (Long, Reshape.this.global.Name, List[Reshape.this.global.Tree]))(Long, Reshape.this.global.Name, List[Reshape.this.global.Tree])" class="delimiter">(</a><a href="../../internal/Trees.scala.html#409800" title="Long" id="544858">flags</a>, <a href="../../internal/Trees.scala.html#409802" title="Reshape.this.global.Name" id="544859">privateWithin</a>, <a href="../../internal/Trees.scala.html#409804" title="List[Reshape.this.global.Tree]" id="544860">annotations</a><span class="delimiter">)</span> = <a href="#544846" title="Reshape.this.global.Modifiers">mods</a>
            <span class="keyword">var</span> <a title="Long" id="544861">flags1</a> = <a href="#544858" title="Long">flags</a> <a href="../../../Long.scala.html#57510" title="(x: Int)Long">&amp;</a> <a href="../../../Int.scala.html#57084" title="=&gt; Int">~</a><span title="Int(524288)">LOCAL</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#544856" title="Reshape.this.global.DefDef">ddef</a>.<a href="../../internal/Trees.scala.html#409939" title="=&gt; Reshape.this.global.Symbol">symbol</a>.<a href="../../internal/HasFlags.scala.html#409863" title="=&gt; Boolean">isPrivate</a><span class="delimiter">)</span> <a href="#544861" title="Long">flags1</a> = <a href="#544861" title="Long">flags1</a> <a href="../../../Long.scala.html#57510" title="(x: Int)Long">&amp;</a> <a href="../../../Int.scala.html#57084" title="=&gt; Int">~</a><span title="Int(4)">PRIVATE</span>
            <span class="keyword">val</span> <a title="Reshape.this.global.Name" id="544862">privateWithin1</a> = <a href="#544856" title="Reshape.this.global.DefDef">ddef</a>.<a href="../../internal/Trees.scala.html#410278" title="=&gt; Reshape.this.global.Modifiers">mods</a>.<a href="../../internal/Trees.scala.html#409802" title="=&gt; Reshape.this.global.Name">privateWithin</a>
            <span class="keyword">val</span> <a title="List[Reshape.this.global.Tree]" id="544863">annotations1</a> = <a href="../../../collection/MapLike.scala.html#87535" title="(key: Reshape.this.global.ValDef)List[Reshape.this.global.DefDef]">accessors</a><span class="delimiter">(</span>vdef<span class="delimiter">)</span>.<a href="../../../collection/LinearSeqOptimized.scala.html#86382" title="(z: List[Reshape.this.global.Tree])(f: (List[Reshape.this.global.Tree], Reshape.this.global.DefDef) =&gt; List[Reshape.this.global.Tree])List[Reshape.this.global.Tree]">foldLeft</a><span class="delimiter">(</span><a href="#544860" title="List[Reshape.this.global.Tree]">annotations</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="List[Reshape.this.global.Tree]" id="544946">curr</a>, <a title="Reshape.this.global.DefDef" id="544947">acc</a><span class="delimiter">)</span> =&gt; <a href="#544946" title="List[Reshape.this.global.Tree]">curr</a> <a href="../../../collection/immutable/List.scala.html#62697" title="(that: scala.collection.GenTraversableOnce[Reshape.this.global.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.Tree],Reshape.this.global.Tree,List[Reshape.this.global.Tree]])List[Reshape.this.global.Tree]">++</a> <span class="delimiter">(</span><a href="#544947" title="Reshape.this.global.DefDef">acc</a>.<a href="../../internal/Trees.scala.html#409939" title="=&gt; Reshape.this.global.Symbol">symbol</a>.<a href="../../internal/Symbols.scala.html#411400" title="=&gt; List[Reshape.this.global.AnnotationInfo]">annotations</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: Reshape.this.global.AnnotationInfo =&gt; Reshape.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.AnnotationInfo],Reshape.this.global.Tree,List[Reshape.this.global.Tree]])List[Reshape.this.global.Tree]">map</a> <a href="#542668" title="(ann: Reshape.this.global.AnnotationInfo)Reshape.this.global.Tree">toPreTyperAnnotation</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="../../internal/Trees.scala.html#484441" title="(flags: Long, privateWithin: Reshape.this.global.Name, annotations: List[Reshape.this.global.Tree])Reshape.this.global.Modifiers">Modifiers</a><span class="delimiter">(</span><a href="#544861" title="Long">flags1</a>, <a href="#544862" title="Reshape.this.global.Name">privateWithin1</a>, <a href="#544863" title="List[Reshape.this.global.Tree]">annotations1</a><span class="delimiter">)</span> <a href="../../internal/Trees.scala.html#409810" title="(poss: scala.collection.immutable.Map[Long,scala.reflect.internal.util.Position])Reshape.this.global.Modifiers">setPositions</a> <a href="#544846" title="Reshape.this.global.Modifiers">mods</a>.<a href="../../internal/Trees.scala.html#409807" title="=&gt; Map[Long,Reshape.this.global.Position]">positions</a>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="#544846" title="Reshape.this.global.Modifiers">mods</a>
          <span class="delimiter">}</span>
          <span class="keyword">val</span> <a title="Reshape.this.global.Modifiers" id="544851">mods2</a> = <a href="#542663" title="(mods: Reshape.this.global.Modifiers, sym: Reshape.this.global.Symbol)Reshape.this.global.Modifiers">toPreTyperModifiers</a><span class="delimiter">(</span><a href="#544850" title="Reshape.this.global.Modifiers">mods1</a>, vdef.<a href="../../internal/Trees.scala.html#409939" title="=&gt; Reshape.this.global.Symbol">symbol</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Reshape.this.global.Name" id="544852">name1</a> = <a href="../../internal/StdNames.scala.html#407871" title="Reshape.this.global.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#414069" title="(name: Reshape.this.global.Name)Reshape.this.global.Name">dropLocalSuffix</a><span class="delimiter">(</span><a href="#544847" title="Reshape.this.global.TermName">name</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Reshape.this.global.ValDef" id="544853">vdef1</a> = <a href="../../internal/Trees.scala.html#452311" title="(mods: Reshape.this.global.Modifiers, name: Reshape.this.global.TermName, tpt: Reshape.this.global.Tree, rhs: Reshape.this.global.Tree)Reshape.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#544851" title="Reshape.this.global.Modifiers">mods2</a>, <a href="../../internal/Names.scala.html#406832" title="implicit scala.reflect.internal.Names.promoteTermNamesAsNecessary : (name: Reshape.this.global.Name)Reshape.this.global.TermName">name1</a>, <a href="#544848" title="Reshape.this.global.Tree">tpt</a>, <a href="#544849" title="Reshape.this.global.Tree">rhs</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;resetting visibility of field: %s =&gt; %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span>vdef, <a href="#544853" title="Reshape.this.global.ValDef">vdef1</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../Option.scala.html#63128" title="(x: Reshape.this.global.ValDef)Some[Reshape.this.global.ValDef]">Some</a><a href="../../../Option.scala.html#97396" title="(xo: Option[Reshape.this.global.ValDef])Iterable[Reshape.this.global.ValDef]" class="delimiter">(</a><a href="#544853" title="Reshape.this.global.ValDef">vdef1</a><span class="delimiter">)</span> // no copyAttrs here, because new ValDef and old symbols are now out of sync
        <span class="keyword">case</span> ddef @ DefDef<a href="#3295224" title="Iterable[Reshape.this.global.Tree]" id="3295228" class="delimiter">(</a><a href="../../internal/Trees.scala.html#410278" title="Reshape.this.global.Modifiers" id="545138">mods</a>, <a href="../../internal/Trees.scala.html#410280" title="Reshape.this.global.Name" id="545139">name</a>, <a href="../../internal/Trees.scala.html#410282" title="List[Reshape.this.global.TypeDef]" id="545140">tparams</a>, <a href="../../internal/Trees.scala.html#410284" title="List[List[Reshape.this.global.ValDef]]" id="545141">vparamss</a>, <a href="../../internal/Trees.scala.html#410286" title="Reshape.this.global.Tree" id="545142">tpt</a>, <a href="../../internal/Trees.scala.html#410288" title="Reshape.this.global.Tree" id="545143">rhs</a><span class="delimiter">)</span> =&gt;
          <a href="#3295230" title="(x: Iterable[Reshape.this.global.Tree])Iterable[Reshape.this.global.Tree]" class="keyword">if</a> <span class="delimiter">(</span><a href="#544243" title="scala.collection.mutable.Map[Reshape.this.global.ValDef,List[Reshape.this.global.DefDef]]">accessors</a>.<a href="../../../collection/MapLike.scala.html#87542" title="=&gt; Iterable[List[Reshape.this.global.DefDef]]">values</a>.<a href="../../../collection/IterableLike.scala.html#58566" title="(p: List[Reshape.this.global.DefDef] =&gt; Boolean)Boolean">exists</a><span class="delimiter">(</span><a href="#545157" title="List[Reshape.this.global.DefDef]">_</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span>ddef<span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;discarding accessor method: &quot;)" class="string">&quot;discarding accessor method: &quot;</span> <span title="(x$1: Any)String">+</span> ddef<span class="delimiter">)</span>
            <a href="../../../Option.scala.html#97396" title="(xo: Option[Nothing])Iterable[Nothing]">None</a>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="../../../Option.scala.html#63128" title="(x: Reshape.this.global.DefDef)Some[Reshape.this.global.DefDef]">Some</a><a href="../../../Option.scala.html#97396" title="(xo: Option[Reshape.this.global.DefDef])Iterable[Reshape.this.global.DefDef]" class="delimiter">(</a>ddef<span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> tree =&gt;
          <a href="../../../Option.scala.html#63128" title="(x: Reshape.this.global.Tree)Some[Reshape.this.global.Tree]">Some</a><a href="#3295230" title="(x: Iterable[Reshape.this.global.Tree])Iterable[Reshape.this.global.Tree]" class="delimiter">(</a>tree<span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#544244" title="List[Reshape.this.global.Tree]">stats1</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(deff: Reshape.this.global.Tree, stats: List[Reshape.this.global.Tree])List[Reshape.this.global.Tree]" id="542670">trimSyntheticCaseClassMembers</a><span class="delimiter">(</span><a title="Reshape.this.global.Tree" id="542895">deff</a>: <a href="../../internal/Trees.scala.html#407938" title="Reshape.this.global.Tree">Tree</a>, <a title="List[Reshape.this.global.Tree]" id="542896">stats</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Reshape.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Reshape.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> =
      <a href="#542896" title="List[Reshape.this.global.Tree]">stats</a> <a href="../../../collection/TraversableLike.scala.html#58074" title="(p: Reshape.this.global.Tree =&gt; Boolean)List[Reshape.this.global.Tree]">filterNot</a> <span class="delimiter">(</span><a title="Reshape.this.global.Tree" id="545242">memberDef</a> =&gt; <a href="#545242" title="Reshape.this.global.Tree">memberDef</a>.<a href="../../internal/Trees.scala.html#408581" title="=&gt; Boolean">isDef</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Boolean" id="545243">isSynthetic</a> = <a href="#545242" title="Reshape.this.global.Tree">memberDef</a>.<a href="../../internal/Trees.scala.html#408577" title="=&gt; Reshape.this.global.Symbol">symbol</a>.<a href="../../internal/HasFlags.scala.html#409872" title="=&gt; Boolean">isSynthetic</a>
        // this doesn't work for local classes, e.g. for ones that are top-level to a quasiquote (see comments to companionClass)
        // that's why I replace the check with an assumption that all synthetic members are, in fact, generated of case classes
        // val isCaseMember = deff.symbol.isCaseClass || deff.symbol.companionClass.isCaseClass
        <span class="keyword">val</span> <a title="Boolean" id="545244">isCaseMember</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#545243" title="Boolean">isSynthetic</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#545244" title="Boolean">isCaseMember</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;discarding case class synthetic def: &quot;)" class="string">&quot;discarding case class synthetic def: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#545242" title="Reshape.this.global.Tree">memberDef</a><span class="delimiter">)</span>
        <a href="#545243" title="Boolean">isSynthetic</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#545244" title="Boolean">isCaseMember</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(stats: List[Reshape.this.global.Tree])List[Reshape.this.global.Tree]" id="542671">trimSyntheticCaseClassCompanions</a><span class="delimiter">(</span><a title="List[Reshape.this.global.Tree]" id="543108">stats</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Reshape.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Reshape.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> =
      <a href="#543108" title="List[Reshape.this.global.Tree]">stats</a> <a href="../../../collection/SeqLike.scala.html#58830" title="(that: scala.collection.GenSeq[Reshape.this.global.Tree])List[Reshape.this.global.Tree]">diff</a> <span class="delimiter">(</span><a href="#543108" title="List[Reshape.this.global.Tree]">stats</a> <a href="../../../collection/TraversableLike.scala.html#58075" title="(pf: PartialFunction[Reshape.this.global.Tree,Reshape.this.global.ModuleDef])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.global.Tree],Reshape.this.global.ModuleDef,List[Reshape.this.global.ModuleDef]])List[Reshape.this.global.ModuleDef]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.global.Tree,Reshape.this.global.ModuleDef] with Serializable" id="545274" class="delimiter">{</a> <span class="keyword">case</span> <a href="#3295236" title="B1" id="3295308">moddef</a>: ModuleDef =&gt; <a href="#3295242" title="(x: B1)B1">moddef</a> <span class="delimiter">}</span> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: Reshape.this.global.ModuleDef =&gt; Boolean)List[Reshape.this.global.ModuleDef]">filter</a> <span class="delimiter">(</span><a title="Reshape.this.global.ModuleDef" id="545338">moddef</a> =&gt; <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Boolean" id="545339">isSynthetic</a> = <a href="#545338" title="Reshape.this.global.ModuleDef">moddef</a>.<a href="../../internal/Trees.scala.html#409939" title="=&gt; Reshape.this.global.Symbol">symbol</a>.<a href="../../internal/HasFlags.scala.html#409872" title="=&gt; Boolean">isSynthetic</a>
        // this doesn't work for local classes, e.g. for ones that are top-level to a quasiquote (see comments to companionClass)
        // that's why I replace the check with an assumption that all synthetic modules are, in fact, companions of case classes
        // val isCaseCompanion = moddef.symbol.companionClass.isCaseClass
        <span class="keyword">val</span> <a title="Boolean" id="545340">isCaseCompanion</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#545339" title="Boolean">isSynthetic</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#545340" title="Boolean">isCaseCompanion</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../utils/Utils.scala.html#540837" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;discarding synthetic case class companion: &quot;)" class="string">&quot;discarding synthetic case class companion: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#545338" title="Reshape.this.global.ModuleDef">moddef</a><span class="delimiter">)</span>
        <a href="#545339" title="Boolean">isSynthetic</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#545340" title="Boolean">isCaseCompanion</a>
      <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/actors/remote/NetKernel.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2005-2013, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */


<span class="keyword">package</span> scala.actors
<span class="keyword">package</span> remote

<span class="keyword">import</span> scala.collection.mutable

case <span class="keyword">class</span> <a title="class NamedSend extends AnyRef with Product with Serializable" id="124169">NamedSend</a><a href="../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="scala.actors.remote.Locator" id="123740">senderLoc</a>: <a href="#124254" title="scala.actors.remote.Locator">Locator</a>, <a title="scala.actors.remote.Locator" id="123741">receiverLoc</a>: <a href="#124254" title="scala.actors.remote.Locator">Locator</a>, <a title="Array[Byte]" id="123742">data</a>: <a href="../../Array.scala.html#174" title="Array[Byte]">Array</a><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Symbol" id="123743">session</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a><span class="delimiter">)</span>

case <span class="keyword">class</span> <a title="class RemoteApply0 extends AnyRef with Product with Serializable" id="124173">RemoteApply0</a><a href="../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="scala.actors.remote.Locator" id="123862">senderLoc</a>: <a href="#124254" title="scala.actors.remote.Locator">Locator</a>, <a title="scala.actors.remote.Locator" id="123863">receiverLoc</a>: <a href="#124254" title="scala.actors.remote.Locator">Locator</a>, <a title="(scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit" id="123864">rfun</a>: <a href="../../Function2.scala.html#120" title="(scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit">Function2</a><span class="delimiter">[</span>AbstractActor, Proxy, Unit<span class="delimiter">]</span><span class="delimiter">)</span>
case <span class="keyword">class</span> <a title="class LocalApply0 extends AnyRef with Product with Serializable" id="124199">LocalApply0</a><a href="../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="(scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit" id="124058">rfun</a>: <a href="../../Function2.scala.html#120" title="(scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit">Function2</a><span class="delimiter">[</span>AbstractActor, Proxy, Unit<span class="delimiter">]</span>, <a title="scala.actors.AbstractActor" id="124059">a</a>: <a href="../AbstractActor.scala.html#8766" title="scala.actors.AbstractActor">AbstractActor</a><span class="delimiter">)</span>

case <span class="keyword">class</span>  <a title="class SendTo extends AnyRef with Product with Serializable" id="124228">SendTo</a><a href="../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="scala.actors.OutputChannel[Any]" id="124109">a</a>: <a href="../OutputChannel.scala.html#8900" title="scala.actors.OutputChannel[Any]">OutputChannel</a><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="Any" id="124110">msg</a>: <span title="Any">Any</span>, <a title="Symbol" id="124111">session</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a><span class="delimiter">)</span>
case <span class="keyword">object</span> <a href="#123638" title="scala.actors.remote.Terminate.type" id="123646">Terminate</a>

case <span class="keyword">class</span> <a title="class Locator extends AnyRef with Product with Serializable" id="124254">Locator</a><a href="../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="scala.actors.remote.Node" id="123836">node</a>: <a href="RemoteActor.scala.html#9011" title="scala.actors.remote.Node">Node</a>, <a title="Symbol" id="123837">name</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a><span class="delimiter">)</span>

/**
 * @version 0.9.17
 * @author Philipp Haller
 */
<span class="keyword">private</span><span class="delimiter">[</span>remote<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class NetKernel extends Object" id="8993">NetKernel</a><a href="#8993" title="scala.actors.remote.NetKernel" class="delimiter">(</a><a title="scala.actors.remote.Service" id="123724">service</a>: <a href="Service.scala.html#9023" title="scala.actors.remote.Service">Service</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(node: scala.actors.remote.Node, msg: AnyRef)Unit" id="123700">sendToNode</a><span class="delimiter">(</span><a title="scala.actors.remote.Node" id="123725">node</a>: <a href="RemoteActor.scala.html#9011" title="scala.actors.remote.Node">Node</a>, <a title="AnyRef" id="123726">msg</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[Byte]" id="123727">bytes</a> = <a href="#123724" title="scala.actors.remote.Service">service</a>.<a href="Service.scala.html#123142" title="=&gt; scala.actors.remote.Serializer">serializer</a>.<a href="Serializer.scala.html#123123" title="(o: AnyRef)Array[Byte]">serialize</a><span class="delimiter">(</span><a href="#123726" title="AnyRef">msg</a><span class="delimiter">)</span>
    <a href="#123724" title="scala.actors.remote.Service">service</a>.<a href="Service.scala.html#123144" title="(node: scala.actors.remote.Node, data: Array[Byte])Unit">send</a><span class="delimiter">(</span><a href="#123725" title="scala.actors.remote.Node">node</a>, <a href="#123727" title="Array[Byte]">bytes</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(senderLoc: scala.actors.remote.Locator, receiverLoc: scala.actors.remote.Locator, msg: AnyRef, session: Symbol)Unit" id="123701">namedSend</a><span class="delimiter">(</span><a title="scala.actors.remote.Locator" id="123730">senderLoc</a>: <a href="#124254" title="scala.actors.remote.Locator">Locator</a>, <a title="scala.actors.remote.Locator" id="123731">receiverLoc</a>: <a href="#124254" title="scala.actors.remote.Locator">Locator</a>,
                <a title="AnyRef" id="123732">msg</a>: <span title="AnyRef">AnyRef</span>, <a title="Symbol" id="123733">session</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[Byte]" id="123734">bytes</a> = <a href="#123724" title="scala.actors.remote.Service">service</a>.<a href="Service.scala.html#123142" title="=&gt; scala.actors.remote.Serializer">serializer</a>.<a href="Serializer.scala.html#123123" title="(o: AnyRef)Array[Byte]">serialize</a><span class="delimiter">(</span><a href="#123732" title="AnyRef">msg</a><span class="delimiter">)</span>
    <a href="#123700" title="(node: scala.actors.remote.Node, msg: AnyRef)Unit">sendToNode</a><span class="delimiter">(</span><a href="#123731" title="scala.actors.remote.Locator">receiverLoc</a>.<a href="#123836" title="=&gt; scala.actors.remote.Node">node</a>, <a href="#124169" title="(senderLoc: scala.actors.remote.Locator, receiverLoc: scala.actors.remote.Locator, data: Array[Byte], session: Symbol)scala.actors.remote.NamedSend">NamedSend</a><span class="delimiter">(</span><a href="#123730" title="scala.actors.remote.Locator">senderLoc</a>, <a href="#123731" title="scala.actors.remote.Locator">receiverLoc</a>, <a href="#123734" title="Array[Byte]">bytes</a>, <a href="#123733" title="Symbol">session</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[Symbol,scala.actors.OutputChannel[Any]]" id="123702">actors</a> = <a href="../../collection/mutable/HashMap.scala.html#88242" title="()scala.collection.mutable.HashMap[Symbol,scala.actors.OutputChannel[Any]]" class="keyword">new</a> mutable.<a href="../../collection/mutable/HashMap.scala.html#12447" title="scala.collection.mutable.HashMap[Symbol,scala.actors.OutputChannel[Any]]">HashMap</a><span class="delimiter">[</span>Symbol, OutputChannel<span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[scala.actors.OutputChannel[Any],Symbol]" id="123704">names</a> = <a href="../../collection/mutable/HashMap.scala.html#88242" title="()scala.collection.mutable.HashMap[scala.actors.OutputChannel[Any],Symbol]" class="keyword">new</a> mutable.<a href="../../collection/mutable/HashMap.scala.html#12447" title="scala.collection.mutable.HashMap[scala.actors.OutputChannel[Any],Symbol]">HashMap</a><span class="delimiter">[</span>OutputChannel<span class="delimiter">[</span>Any<span class="delimiter">]</span>, Symbol<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(name: Symbol, a: scala.actors.OutputChannel[Any])Unit" id="123706">register</a><span class="delimiter">(</span><a title="Symbol" id="123752">name</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a>, <a title="scala.actors.OutputChannel[Any]" id="123753">a</a>: <a href="../OutputChannel.scala.html#8900" title="scala.actors.OutputChannel[Any]">OutputChannel</a><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#1515" title="Unit">Unit</a> = <a href="#8993" title="(x$1: scala.collection.mutable.HashMap[scala.actors.OutputChannel[Any],Symbol])scala.collection.mutable.HashMap[scala.actors.OutputChannel[Any],Symbol]">synchronized</a> <span title="Unit" class="delimiter">{</span>
    <a href="#123702" title="=&gt; scala.collection.mutable.HashMap[Symbol,scala.actors.OutputChannel[Any]]">actors</a> <a href="../../collection/mutable/HashMap.scala.html#88250" title="(kv: (Symbol, scala.actors.OutputChannel[Any]))NetKernel.this.actors.type">+=</a> <a href="../../Predef.scala.html#63093" title="(x: Symbol, y: scala.actors.OutputChannel[Any])(Symbol, scala.actors.OutputChannel[Any])">Pair</a><span class="delimiter">(</span><a href="#123752" title="Symbol">name</a>, <a href="#123753" title="scala.actors.OutputChannel[Any]">a</a><span class="delimiter">)</span>
    <a href="#123704" title="=&gt; scala.collection.mutable.HashMap[scala.actors.OutputChannel[Any],Symbol]">names</a> <a href="../../collection/mutable/HashMap.scala.html#88250" title="(kv: (scala.actors.OutputChannel[Any], Symbol))NetKernel.this.names.type">+=</a> <a href="../../Predef.scala.html#63093" title="(x: scala.actors.OutputChannel[Any], y: Symbol)(scala.actors.OutputChannel[Any], Symbol)">Pair</a><span class="delimiter">(</span><a href="#123753" title="scala.actors.OutputChannel[Any]">a</a>, <a href="#123752" title="Symbol">name</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(from: scala.actors.OutputChannel[Any])Symbol" id="123707">getOrCreateName</a><span class="delimiter">(</span><a title="scala.actors.OutputChannel[Any]" id="123810">from</a>: <a href="../OutputChannel.scala.html#8900" title="scala.actors.OutputChannel[Any]">OutputChannel</a><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#123704" title="=&gt; scala.collection.mutable.HashMap[scala.actors.OutputChannel[Any],Symbol]">names</a>.<a href="../../collection/mutable/HashMap.scala.html#88246" title="(key: scala.actors.OutputChannel[Any])Option[Symbol]">get</a><a href="#3266561" title="(x: Symbol)Symbol" class="delimiter">(</a><a href="#123810" title="scala.actors.OutputChannel[Any]">from</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="../../Option.scala.html#1585" title="Symbol" id="3266559">None</a> =&gt;
      <span class="keyword">val</span> <a title="Symbol" id="123814">freshName</a> = <a href="FreshNameCreator.scala.html#8964" title="scala.actors.remote.FreshNameCreator.type">FreshNameCreator</a>.<a href="FreshNameCreator.scala.html#121502" title="(prefix: String)Symbol">newName</a><span class="delimiter">(</span><span title="String(&quot;remotesender&quot;)" class="string">&quot;remotesender&quot;</span><span class="delimiter">)</span>
      <a href="#123706" title="(name: Symbol, a: scala.actors.OutputChannel[Any])Unit">register</a><span class="delimiter">(</span><a href="#123814" title="Symbol">freshName</a>, <a href="#123810" title="scala.actors.OutputChannel[Any]">from</a><span class="delimiter">)</span>
      <a href="#123814" title="Symbol">freshName</a>
    <span class="keyword">case</span> Some<a href="#3266556" title="Symbol" id="3266558" class="delimiter">(</a><a href="../../Option.scala.html#63132" title="Symbol" id="123818">name</a><span class="delimiter">)</span> =&gt;
      <a href="#3266561" title="(x: Symbol)Symbol">name</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(node: scala.actors.remote.Node, name: Symbol, msg: AnyRef)Unit" id="123708">send</a><span class="delimiter">(</span><a title="scala.actors.remote.Node" id="123819">node</a>: <a href="RemoteActor.scala.html#9011" title="scala.actors.remote.Node">Node</a>, <a title="Symbol" id="123820">name</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a>, <a title="AnyRef" id="123821">msg</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#1515" title="Unit">Unit</a> =
    <a href="#123709" title="(node: scala.actors.remote.Node, name: Symbol, msg: AnyRef, session: Symbol)Unit">send</a><span class="delimiter">(</span><a href="#123819" title="scala.actors.remote.Node">node</a>, <a href="#123820" title="Symbol">name</a>, <a href="#123821" title="AnyRef">msg</a>, <a href="../../Symbol.scala.html#101310" title="(name: String)Symbol" class="symbol">'nosession</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(node: scala.actors.remote.Node, name: Symbol, msg: AnyRef, session: Symbol)Unit" id="123709">send</a><span class="delimiter">(</span><a title="scala.actors.remote.Node" id="123826">node</a>: <a href="RemoteActor.scala.html#9011" title="scala.actors.remote.Node">Node</a>, <a title="Symbol" id="123827">name</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a>, <a title="AnyRef" id="123828">msg</a>: <span title="AnyRef">AnyRef</span>, <a title="Symbol" id="123829">session</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.actors.remote.Locator" id="123830">senderLoc</a> = <a href="#124254" title="(node: scala.actors.remote.Node, name: Symbol)scala.actors.remote.Locator">Locator</a><span class="delimiter">(</span><a href="#123724" title="scala.actors.remote.Service">service</a>.<a href="Service.scala.html#123143" title="=&gt; scala.actors.remote.Node">node</a>, <a href="#123707" title="(from: scala.actors.OutputChannel[Any])Symbol">getOrCreateName</a><span class="delimiter">(</span><a href="../Actor.scala.html#8773" title="scala.actors.Actor.type">Actor</a>.<a href="../Actor.scala.html#113681" title="(sched: scala.actors.IScheduler)scala.actors.InternalActor">self</a><span class="delimiter">(</span><a href="../Scheduler.scala.html#8942" title="scala.actors.Scheduler.type">Scheduler</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.actors.remote.Locator" id="123831">receiverLoc</a> = <a href="#124254" title="(node: scala.actors.remote.Node, name: Symbol)scala.actors.remote.Locator">Locator</a><span class="delimiter">(</span><a href="#123826" title="scala.actors.remote.Node">node</a>, <a href="#123827" title="Symbol">name</a><span class="delimiter">)</span>
    <a href="#123701" title="(senderLoc: scala.actors.remote.Locator, receiverLoc: scala.actors.remote.Locator, msg: AnyRef, session: Symbol)Unit">namedSend</a><span class="delimiter">(</span><a href="#123830" title="scala.actors.remote.Locator">senderLoc</a>, <a href="#123831" title="scala.actors.remote.Locator">receiverLoc</a>, <a href="#123828" title="AnyRef">msg</a>, <a href="#123829" title="Symbol">session</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(from: scala.actors.OutputChannel[Any], node: scala.actors.remote.Node, name: Symbol, msg: AnyRef, session: Symbol)Unit" id="123710">forward</a><span class="delimiter">(</span><a title="scala.actors.OutputChannel[Any]" id="123844">from</a>: <a href="../OutputChannel.scala.html#8900" title="scala.actors.OutputChannel[Any]">OutputChannel</a><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="scala.actors.remote.Node" id="123845">node</a>: <a href="RemoteActor.scala.html#9011" title="scala.actors.remote.Node">Node</a>, <a title="Symbol" id="123846">name</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a>, <a title="AnyRef" id="123847">msg</a>: <span title="AnyRef">AnyRef</span>, <a title="Symbol" id="123848">session</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.actors.remote.Locator" id="123849">senderLoc</a> = <a href="#124254" title="(node: scala.actors.remote.Node, name: Symbol)scala.actors.remote.Locator">Locator</a><span class="delimiter">(</span><a href="#123724" title="scala.actors.remote.Service">service</a>.<a href="Service.scala.html#123143" title="=&gt; scala.actors.remote.Node">node</a>, <a href="#123707" title="(from: scala.actors.OutputChannel[Any])Symbol">getOrCreateName</a><span class="delimiter">(</span><a href="#123844" title="scala.actors.OutputChannel[Any]">from</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.actors.remote.Locator" id="123850">receiverLoc</a> = <a href="#124254" title="(node: scala.actors.remote.Node, name: Symbol)scala.actors.remote.Locator">Locator</a><span class="delimiter">(</span><a href="#123845" title="scala.actors.remote.Node">node</a>, <a href="#123846" title="Symbol">name</a><span class="delimiter">)</span>
    <a href="#123701" title="(senderLoc: scala.actors.remote.Locator, receiverLoc: scala.actors.remote.Locator, msg: AnyRef, session: Symbol)Unit">namedSend</a><span class="delimiter">(</span><a href="#123849" title="scala.actors.remote.Locator">senderLoc</a>, <a href="#123850" title="scala.actors.remote.Locator">receiverLoc</a>, <a href="#123847" title="AnyRef">msg</a>, <a href="#123848" title="Symbol">session</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(node: scala.actors.remote.Node, name: Symbol, from: scala.actors.OutputChannel[Any], rfun: (scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit)Unit" id="123711">remoteApply</a><span class="delimiter">(</span><a title="scala.actors.remote.Node" id="123851">node</a>: <a href="RemoteActor.scala.html#9011" title="scala.actors.remote.Node">Node</a>, <a title="Symbol" id="123852">name</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a>, <a title="scala.actors.OutputChannel[Any]" id="123853">from</a>: <a href="../OutputChannel.scala.html#8900" title="scala.actors.OutputChannel[Any]">OutputChannel</a><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="(scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit" id="123854">rfun</a>: <a href="../../Function2.scala.html#120" title="(scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit">Function2</a><span class="delimiter">[</span>AbstractActor, Proxy, Unit<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.actors.remote.Locator" id="123855">senderLoc</a> = <a href="#124254" title="(node: scala.actors.remote.Node, name: Symbol)scala.actors.remote.Locator">Locator</a><span class="delimiter">(</span><a href="#123724" title="scala.actors.remote.Service">service</a>.<a href="Service.scala.html#123143" title="=&gt; scala.actors.remote.Node">node</a>, <a href="#123707" title="(from: scala.actors.OutputChannel[Any])Symbol">getOrCreateName</a><span class="delimiter">(</span><a href="#123853" title="scala.actors.OutputChannel[Any]">from</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.actors.remote.Locator" id="123856">receiverLoc</a> = <a href="#124254" title="(node: scala.actors.remote.Node, name: Symbol)scala.actors.remote.Locator">Locator</a><span class="delimiter">(</span><a href="#123851" title="scala.actors.remote.Node">node</a>, <a href="#123852" title="Symbol">name</a><span class="delimiter">)</span>
    <a href="#123700" title="(node: scala.actors.remote.Node, msg: AnyRef)Unit">sendToNode</a><span class="delimiter">(</span><a href="#123856" title="scala.actors.remote.Locator">receiverLoc</a>.<a href="#123836" title="=&gt; scala.actors.remote.Node">node</a>, <a href="#124173" title="(senderLoc: scala.actors.remote.Locator, receiverLoc: scala.actors.remote.Locator, rfun: (scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit)scala.actors.remote.RemoteApply0">RemoteApply0</a><span class="delimiter">(</span><a href="#123855" title="scala.actors.remote.Locator">senderLoc</a>, <a href="#123856" title="scala.actors.remote.Locator">receiverLoc</a>, <a href="#123854" title="(scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit">rfun</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(node: scala.actors.remote.Node, sym: Symbol)scala.actors.remote.Proxy" id="123712">createProxy</a><span class="delimiter">(</span><a title="scala.actors.remote.Node" id="123871">node</a>: <a href="RemoteActor.scala.html#9011" title="scala.actors.remote.Node">Node</a>, <a title="Symbol" id="123872">sym</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a><span class="delimiter">)</span>: <a href="Proxy.scala.html#8998" title="scala.actors.remote.Proxy">Proxy</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.actors.remote.Proxy" id="123906">p</a> = <span title="scala.actors.remote.Proxy" class="keyword">new</span> <a href="Proxy.scala.html#8998" title="scala.actors.remote.Proxy">Proxy</a><span class="delimiter">(</span><a href="#123871" title="scala.actors.remote.Node">node</a>, <a href="#123872" title="Symbol">sym</a>, <a href="#8993" title="scala.actors.remote.NetKernel" class="keyword">this</a><span class="delimiter">)</span>
    <a href="#123713" title="=&gt; scala.collection.mutable.HashMap[(scala.actors.remote.Node, Symbol),scala.actors.remote.Proxy]">proxies</a> <a href="../../collection/mutable/HashMap.scala.html#88250" title="(kv: ((scala.actors.remote.Node, Symbol), scala.actors.remote.Proxy))NetKernel.this.proxies.type">+=</a> <a href="../../Predef.scala.html#63093" title="(x: (scala.actors.remote.Node, Symbol), y: scala.actors.remote.Proxy)((scala.actors.remote.Node, Symbol), scala.actors.remote.Proxy)">Pair</a><span class="delimiter">(</span><a href="../../Tuple2.scala.html#62849" title="(_1: scala.actors.remote.Node, _2: Symbol)(scala.actors.remote.Node, Symbol)" class="delimiter">(</a><a href="#123871" title="scala.actors.remote.Node">node</a>, <a href="#123872" title="Symbol">sym</a><span class="delimiter">)</span>, <a href="#123906" title="scala.actors.remote.Proxy">p</a><span class="delimiter">)</span>
    <a href="#123906" title="scala.actors.remote.Proxy">p</a>
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[(scala.actors.remote.Node, Symbol),scala.actors.remote.Proxy]" id="123713">proxies</a> = <a href="../../collection/mutable/HashMap.scala.html#88242" title="()scala.collection.mutable.HashMap[(scala.actors.remote.Node, Symbol),scala.actors.remote.Proxy]" class="keyword">new</a> mutable.<a href="../../collection/mutable/HashMap.scala.html#12447" title="scala.collection.mutable.HashMap[(scala.actors.remote.Node, Symbol),scala.actors.remote.Proxy]">HashMap</a><span class="delimiter">[</span><span class="delimiter">(</span>Node, Symbol<span class="delimiter">)</span>, Proxy<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(senderNode: scala.actors.remote.Node, senderName: Symbol)scala.actors.remote.Proxy" id="123715">getOrCreateProxy</a><span class="delimiter">(</span><a title="scala.actors.remote.Node" id="123931">senderNode</a>: <a href="RemoteActor.scala.html#9011" title="scala.actors.remote.Node">Node</a>, <a title="Symbol" id="123932">senderName</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a><span class="delimiter">)</span>: <a href="Proxy.scala.html#8998" title="scala.actors.remote.Proxy">Proxy</a> =
    <a href="#123713" title="=&gt; scala.collection.mutable.HashMap[(scala.actors.remote.Node, Symbol),scala.actors.remote.Proxy]">proxies</a>.<span title="(x$1: scala.actors.remote.Proxy)scala.actors.remote.Proxy">synchronized</span> <span class="delimiter">{</span>
      <a href="#123713" title="=&gt; scala.collection.mutable.HashMap[(scala.actors.remote.Node, Symbol),scala.actors.remote.Proxy]">proxies</a>.<a href="../../collection/mutable/HashMap.scala.html#88246" title="(key: (scala.actors.remote.Node, Symbol))Option[scala.actors.remote.Proxy]">get</a><a href="#3266574" title="(x: scala.actors.remote.Proxy)scala.actors.remote.Proxy" class="delimiter">(</a><a href="../../Tuple2.scala.html#62849" title="(_1: scala.actors.remote.Node, _2: Symbol)(scala.actors.remote.Node, Symbol)" class="delimiter">(</a><a href="#123931" title="scala.actors.remote.Node">senderNode</a>, <a href="#123932" title="Symbol">senderName</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#3266569" title="scala.actors.remote.Proxy" id="3266570" class="delimiter">(</a><a href="../../Option.scala.html#63132" title="scala.actors.remote.Proxy" id="123945">senderProxy</a><span class="delimiter">)</span> =&gt; <a href="#3266574" title="(x: scala.actors.remote.Proxy)scala.actors.remote.Proxy">senderProxy</a>
        <span class="keyword">case</span> <a href="../../Option.scala.html#1585" title="scala.actors.remote.Proxy" id="3266572">None</a>              =&gt; <a href="#123712" title="(node: scala.actors.remote.Node, sym: Symbol)scala.actors.remote.Proxy">createProxy</a><a href="#3266574" title="(x: scala.actors.remote.Proxy)scala.actors.remote.Proxy" class="delimiter">(</a><a href="#123931" title="scala.actors.remote.Node">senderNode</a>, <a href="#123932" title="Symbol">senderName</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  /* Register proxy if no other proxy has been registered.
   */
  <span class="keyword">def</span> <a title="(senderNode: scala.actors.remote.Node, senderName: Symbol, p: scala.actors.remote.Proxy)Unit" id="123716">registerProxy</a><span class="delimiter">(</span><a title="scala.actors.remote.Node" id="123947">senderNode</a>: <a href="RemoteActor.scala.html#9011" title="scala.actors.remote.Node">Node</a>, <a title="Symbol" id="123948">senderName</a>: <a href="../../Symbol.scala.html#1545" title="Symbol">Symbol</a>, <a title="scala.actors.remote.Proxy" id="123949">p</a>: <a href="Proxy.scala.html#8998" title="scala.actors.remote.Proxy">Proxy</a><span class="delimiter">)</span>: <a href="../../Unit.scala.html#1515" title="Unit">Unit</a> =
    <a href="#123713" title="=&gt; scala.collection.mutable.HashMap[(scala.actors.remote.Node, Symbol),scala.actors.remote.Proxy]">proxies</a>.<span title="(x$1: Any)Any">synchronized</span> <span title="Unit" class="delimiter">{</span>
      <a href="#123713" title="=&gt; scala.collection.mutable.HashMap[(scala.actors.remote.Node, Symbol),scala.actors.remote.Proxy]">proxies</a>.<a href="../../collection/mutable/HashMap.scala.html#88246" title="(key: (scala.actors.remote.Node, Symbol))Option[scala.actors.remote.Proxy]">get</a><a href="#3266587" title="(x: Any)Any" class="delimiter">(</a><a href="../../Tuple2.scala.html#62849" title="(_1: scala.actors.remote.Node, _2: Symbol)(scala.actors.remote.Node, Symbol)" class="delimiter">(</a><a href="#123947" title="scala.actors.remote.Node">senderNode</a>, <a href="#123948" title="Symbol">senderName</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#3266582" title="Any" id="3266583" class="delimiter">(</a><a href="../../Option.scala.html#63132" title="scala.actors.remote.Proxy" id="123959">senderProxy</a><span class="delimiter">)</span> =&gt; // do nothing
        <span class="keyword">case</span> <a href="../../Option.scala.html#1585" title="Any" id="3266585">None</a>              =&gt; <a href="#123713" title="=&gt; scala.collection.mutable.HashMap[(scala.actors.remote.Node, Symbol),scala.actors.remote.Proxy]">proxies</a> <a href="#3266587" title="(x: Any)Any">+=</a> <a href="../../Predef.scala.html#63093" title="(x: (scala.actors.remote.Node, Symbol), y: scala.actors.remote.Proxy)((scala.actors.remote.Node, Symbol), scala.actors.remote.Proxy)">Pair</a><span class="delimiter">(</span><a href="../../Tuple2.scala.html#62849" title="(_1: scala.actors.remote.Node, _2: Symbol)(scala.actors.remote.Node, Symbol)" class="delimiter">(</a><a href="#123947" title="scala.actors.remote.Node">senderNode</a>, <a href="#123948" title="Symbol">senderName</a><span class="delimiter">)</span>, <a href="#123949" title="scala.actors.remote.Proxy">p</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(senderNode: scala.actors.remote.Node, msg: AnyRef)Unit" id="123717">processMsg</a><span class="delimiter">(</span><a title="scala.actors.remote.Node" id="124008">senderNode</a>: <a href="RemoteActor.scala.html#9011" title="scala.actors.remote.Node">Node</a>, <a title="AnyRef" id="124009">msg</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#1515" title="Unit">Unit</a> = <a href="#8993" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
    <a href="#124009" title="AnyRef">msg</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> cmd@RemoteApply0<a href="#3266621" title="Unit" id="3266622" class="delimiter">(</a><a href="#123862" title="scala.actors.remote.Locator" id="124036">senderLoc</a>, <a href="#123863" title="scala.actors.remote.Locator" id="124037">receiverLoc</a>, <a href="#123864" title="(scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit" id="124038">rfun</a><span class="delimiter">)</span> =&gt;
        <a href="../Debug.scala.html#8829" title="scala.actors.Debug.type">Debug</a>.<a href="../Debug.scala.html#116633" title="(s: String)Unit">info</a><span class="delimiter">(</span><a href="../../Predef.scala.html#7605" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd" class="keyword">this</a><a href="../../runtime/StringAdd.scala.html#60046" title="(other: String)String">+</a><span title="String(&quot;: processing &quot;)" class="string">&quot;: processing &quot;</span><span title="(x$1: Any)String">+</span>cmd<span class="delimiter">)</span>
        <a href="#123702" title="=&gt; scala.collection.mutable.HashMap[Symbol,scala.actors.OutputChannel[Any]]">actors</a>.<a href="../../collection/mutable/HashMap.scala.html#88246" title="(key: Symbol)Option[scala.actors.OutputChannel[Any]]">get</a><a href="#3266600" title="(x: Unit)Unit" class="delimiter">(</a><a href="#124037" title="scala.actors.remote.Locator">receiverLoc</a>.<a href="#123837" title="=&gt; Symbol">name</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Some<a href="#3266595" title="Unit" id="3266596" class="delimiter">(</a><a href="../../Option.scala.html#63132" title="scala.actors.OutputChannel[Any]" id="124045">a</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="scala.actors.remote.Proxy" id="124046">senderProxy</a> = <a href="#123715" title="(senderNode: scala.actors.remote.Node, senderName: Symbol)scala.actors.remote.Proxy">getOrCreateProxy</a><span class="delimiter">(</span><a href="#124036" title="scala.actors.remote.Locator">senderLoc</a>.<a href="#123836" title="=&gt; scala.actors.remote.Node">node</a>, <a href="#124036" title="scala.actors.remote.Locator">senderLoc</a>.<a href="#123837" title="=&gt; Symbol">name</a><span class="delimiter">)</span>
            <a href="#124046" title="scala.actors.remote.Proxy">senderProxy</a>.<a href="Proxy.scala.html#123893" title="(msg: Any, replyCh: scala.actors.OutputChannel[Any])Unit">send</a><span class="delimiter">(</span><a href="#124199" title="(rfun: (scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit, a: scala.actors.AbstractActor)scala.actors.remote.LocalApply0">LocalApply0</a><span class="delimiter">(</span><a href="#124038" title="(scala.actors.AbstractActor, scala.actors.remote.Proxy) =&gt; Unit">rfun</a>, <a href="#124045" title="scala.actors.OutputChannel[Any]">a</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.actors.AbstractActor" class="delimiter">[</span><a href="../AbstractActor.scala.html#8766" title="scala.actors.AbstractActor">AbstractActor</a><span class="delimiter">]</span><span class="delimiter">)</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <a href="../../Option.scala.html#1585" title="Unit" id="3266598">None</a> =&gt;
            // message is lost
            <a href="../Debug.scala.html#8829" title="scala.actors.Debug.type">Debug</a>.<a href="../Debug.scala.html#116633" title="(s: String)Unit">info</a><a href="#3266600" title="(x: Unit)Unit" class="delimiter">(</a><a href="../../Predef.scala.html#7605" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd" class="keyword">this</a><a href="../../runtime/StringAdd.scala.html#60046" title="(other: String)String">+</a><span title="String(&quot;: lost message&quot;)" class="string">&quot;: lost message&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

      <span class="keyword">case</span> cmd@NamedSend<a href="#3266621" title="Unit" id="3266623" class="delimiter">(</a><a href="#123740" title="scala.actors.remote.Locator" id="124093">senderLoc</a>, <a href="#123741" title="scala.actors.remote.Locator" id="124094">receiverLoc</a>, <a href="#123742" title="Array[Byte]" id="124095">data</a>, <a href="#123743" title="Symbol" id="124096">session</a><span class="delimiter">)</span> =&gt;
        <a href="../Debug.scala.html#8829" title="scala.actors.Debug.type">Debug</a>.<a href="../Debug.scala.html#116633" title="(s: String)Unit">info</a><span class="delimiter">(</span><a href="../../Predef.scala.html#7605" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd" class="keyword">this</a><a href="../../runtime/StringAdd.scala.html#60046" title="(other: String)String">+</a><span title="String(&quot;: processing &quot;)" class="string">&quot;: processing &quot;</span><span title="(x$1: Any)String">+</span>cmd<span class="delimiter">)</span>
        <a href="#123702" title="=&gt; scala.collection.mutable.HashMap[Symbol,scala.actors.OutputChannel[Any]]">actors</a>.<a href="../../collection/mutable/HashMap.scala.html#88246" title="(key: Symbol)Option[scala.actors.OutputChannel[Any]]">get</a><a href="#3266613" title="(x: Unit)Unit" class="delimiter">(</a><a href="#124094" title="scala.actors.remote.Locator">receiverLoc</a>.<a href="#123837" title="=&gt; Symbol">name</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Some<a href="#3266608" title="Unit" id="3266609" class="delimiter">(</a><a href="../../Option.scala.html#63132" title="scala.actors.OutputChannel[Any]" id="124100">a</a><span class="delimiter">)</span> =&gt;
            <a href="#3266613" title="(x: Unit)Unit" class="keyword">try</a> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="AnyRef" id="124101">msg</a> = <a href="#123724" title="scala.actors.remote.Service">service</a>.<a href="Service.scala.html#123142" title="=&gt; scala.actors.remote.Serializer">serializer</a>.<a href="Serializer.scala.html#123124" title="(a: Array[Byte])AnyRef">deserialize</a><span class="delimiter">(</span><a href="#124095" title="Array[Byte]">data</a><span class="delimiter">)</span>
              <span class="keyword">val</span> <a title="scala.actors.remote.Proxy" id="124102">senderProxy</a> = <a href="#123715" title="(senderNode: scala.actors.remote.Node, senderName: Symbol)scala.actors.remote.Proxy">getOrCreateProxy</a><span class="delimiter">(</span><a href="#124093" title="scala.actors.remote.Locator">senderLoc</a>.<a href="#123836" title="=&gt; scala.actors.remote.Node">node</a>, <a href="#124093" title="scala.actors.remote.Locator">senderLoc</a>.<a href="#123837" title="=&gt; Symbol">name</a><span class="delimiter">)</span>
              <a href="#124102" title="scala.actors.remote.Proxy">senderProxy</a>.<a href="Proxy.scala.html#123893" title="(msg: Any, replyCh: scala.actors.OutputChannel[Any])Unit">send</a><span class="delimiter">(</span><a href="#124228" title="(a: scala.actors.OutputChannel[Any], msg: Any, session: Symbol)scala.actors.remote.SendTo">SendTo</a><span class="delimiter">(</span><a href="#124100" title="scala.actors.OutputChannel[Any]">a</a>, <a href="#124101" title="AnyRef">msg</a>, <a href="#124096" title="Symbol">session</a><span class="delimiter">)</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a title="Unit" id="124118">e</a>: <span title="Exception">Exception</span> =&gt;
                <a href="../Debug.scala.html#8829" title="scala.actors.Debug.type">Debug</a>.<a href="../Debug.scala.html#116635" title="(s: String)Unit">error</a><span class="delimiter">(</span><a href="../../Predef.scala.html#7605" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd" class="keyword">this</a><a href="../../runtime/StringAdd.scala.html#60046" title="(other: String)String">+</a><span title="String(&quot;: caught &quot;)" class="string">&quot;: caught &quot;</span><span title="(x$1: Any)String">+</span><a href="#124118" title="Exception">e</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> <a href="../../Option.scala.html#1585" title="Unit" id="3266611">None</a> =&gt;
            // message is lost
            <a href="../Debug.scala.html#8829" title="scala.actors.Debug.type">Debug</a>.<a href="../Debug.scala.html#116633" title="(s: String)Unit">info</a><a href="#3266613" title="(x: Unit)Unit" class="delimiter">(</a><a href="../../Predef.scala.html#7605" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd" class="keyword">this</a><a href="../../runtime/StringAdd.scala.html#60046" title="(other: String)String">+</a><span title="String(&quot;: lost message&quot;)" class="string">&quot;: lost message&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="123718">terminate</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    // tell all proxies to terminate
    <a href="#123713" title="=&gt; scala.collection.mutable.HashMap[(scala.actors.remote.Node, Symbol),scala.actors.remote.Proxy]">proxies</a>.<a href="../../collection/mutable/HashMap.scala.html#88257" title="=&gt; Iterable[scala.actors.remote.Proxy]">values</a> <a href="../../collection/IterableLike.scala.html#58562" title="(f: scala.actors.remote.Proxy =&gt; Unit)Unit">foreach</a> <span class="delimiter">{</span> <a href="#124162" title="scala.actors.remote.Proxy">_</a>.<a href="Proxy.scala.html#123893" title="(msg: Any, replyCh: scala.actors.OutputChannel[Any])Unit">send</a><span class="delimiter">(</span><a href="#123646" title="scala.actors.remote.Terminate.type">Terminate</a>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">}</span>

    // tell service to terminate
    <a href="#123724" title="scala.actors.remote.Service">service</a>.<a href="Service.scala.html#123145" title="()Unit">terminate</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
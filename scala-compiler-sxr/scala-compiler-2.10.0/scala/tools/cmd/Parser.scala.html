<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/cmd/Parser.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NEST (New Scala Test)
 * Copyright 2007-2013 LAMP/EPFL
 * @author Paul Phillips
 */

<span class="keyword">package</span> scala.tools
<span class="keyword">package</span> cmd

<span class="keyword">import</span> scala.util.parsing.combinator._
<span class="keyword">import</span> scala.util.parsing.input.<a href="../../util/parsing/input/CharArrayReader.scala.html#53422" title="scala.util.parsing.input.CharArrayReader.type">CharArrayReader</a>.EofCh

/** A simple (overly so) command line parser.
 *  !!! This needs a thorough test suite to make sure quoting is
 *  done correctly and portably.
 */
<span class="keyword">trait</span> <a title="trait ParserUtil extends Object with scala.util.parsing.combinator.Parsers" id="26603">ParserUtil</a> <a href="../../Unit.scala.html#1515" title="Unit" class="keyword">extends</a> <a href="../../util/parsing/combinator/Parsers.scala.html#52870" title="scala.util.parsing.combinator.Parsers">Parsers</a> <span class="delimiter">{</span>
  <span class="keyword">class</span> <a title="class ParserPlus[+T] extends Object" id="600999">ParserPlus</a><span class="delimiter">[</span>+<a title="" id="601000">T</a><span class="delimiter">]</span><a href="#600999" title="ParserUtil.this.ParserPlus[T]" class="delimiter">(</a><a title="ParserUtil.this.Parser[T]" id="611303">underlying</a>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="ParserUtil.this.Parser[T]">Parser</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[U](p: =&gt; ParserUtil.this.Parser[U])ParserUtil.this.Parser[U]" id="611225">!~&gt;</a><span class="delimiter">[</span><a title="" id="611227">U</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; ParserUtil.this.Parser[U]" id="611304">p</a>: =&gt; Parser<span class="delimiter">[</span>U<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="ParserUtil.this.Parser[U]">Parser</a><span class="delimiter">[</span>U<span class="delimiter">]</span> = <span class="delimiter">(</span><a href="#611303" title="ParserUtil.this.Parser[T]">underlying</a> <a href="../../util/parsing/combinator/Parsers.scala.html#611268" title="(p: =&gt; ParserUtil.this.Parser[U])ParserUtil.this.Parser[ParserUtil.this.~[T,U]]">~!</a> <a href="#611304" title="=&gt; ParserUtil.this.Parser[U]">p</a><span class="delimiter">)</span> <a href="../../util/parsing/combinator/Parsers.scala.html#611277" title="(f: ParserUtil.this.~[T,U] =&gt; U)ParserUtil.this.Parser[U]">^^</a> <a href="#611320" title="ParserUtil.this.~[T,U]" class="delimiter">{</a> <span class="keyword">case</span> <a href="../../util/parsing/combinator/Parsers.scala.html#611323" title="T" id="611372">a</a>~<a href="../../util/parsing/combinator/Parsers.scala.html#611325" title="U" id="611373">b</a>  =&gt; <a href="#3298499" title="(x: U)U">b</a> <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="[U](p: =&gt; ParserUtil.this.Parser[U])ParserUtil.this.Parser[T]" id="611228">&lt;~!</a><span class="delimiter">[</span><a title="" id="611230">U</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; ParserUtil.this.Parser[U]" id="611375">p</a>: =&gt; Parser<span class="delimiter">[</span>U<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="ParserUtil.this.Parser[T]">Parser</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">(</span><a href="#611303" title="ParserUtil.this.Parser[T]">underlying</a> <a href="../../util/parsing/combinator/Parsers.scala.html#611268" title="(p: =&gt; ParserUtil.this.Parser[U])ParserUtil.this.Parser[ParserUtil.this.~[T,U]]">~!</a> <a href="#611375" title="=&gt; ParserUtil.this.Parser[U]">p</a><span class="delimiter">)</span> <a href="../../util/parsing/combinator/Parsers.scala.html#611277" title="(f: ParserUtil.this.~[T,U] =&gt; T)ParserUtil.this.Parser[T]">^^</a> <a href="#611384" title="ParserUtil.this.~[T,U]" class="delimiter">{</a> <span class="keyword">case</span> <a href="../../util/parsing/combinator/Parsers.scala.html#611323" title="T" id="611388">a</a>~<a href="../../util/parsing/combinator/Parsers.scala.html#611325" title="U" id="611389">b</a>  =&gt; <a href="#3298505" title="(x: T)T">a</a> <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="keyword">protected</span> <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](p: ParserUtil.this.Parser[T])ParserUtil.this.ParserPlus[T]" id="601001">parser2parserPlus</a><span class="delimiter">[</span><a title="" id="601003">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="ParserUtil.this.Parser[T]" id="611391">p</a>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="ParserUtil.this.Parser[T]">Parser</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#600999" title="ParserUtil.this.ParserPlus[T]">ParserPlus</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span title="ParserUtil.this.ParserPlus[T]" class="keyword">new</span> <a href="#600999" title="ParserUtil.this.ParserPlus[T]">ParserPlus</a><span class="delimiter">(</span><a href="#611391" title="ParserUtil.this.Parser[T]">p</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="scala.tools.cmd.Parser.type" id="26697">Parser</a> <a href="#26698" title="scala.tools.cmd.Parser.type" class="keyword">extends</a> <a href="../../util/parsing/combinator/RegexParsers.scala.html#52759" title="scala.util.parsing.combinator.RegexParsers">RegexParsers</a> <span class="keyword">with</span> <a href="#26603" title="scala.tools.cmd.ParserUtil">ParserUtil</a> <span class="delimiter">{</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="600980">skipWhitespace</a> = <span title="Boolean(false)" class="keyword">false</span>

  <span class="keyword">def</span> <a title="(xs: scala.tools.cmd.Parser.Elem*)scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem]" id="600981">elemExcept</a><span class="delimiter">(</span><a title="scala.tools.cmd.Parser.Elem*" id="611428">xs</a>: <span title="scala.tools.cmd.Parser.Elem*">Elem</span>*<span class="delimiter">)</span>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem]">Parser</a><span class="delimiter">[</span>Elem<span class="delimiter">]</span> = <a href="../../util/parsing/combinator/Parsers.scala.html#600867" title="(kind: String, p: scala.tools.cmd.Parser.Elem =&gt; Boolean)scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem]">elem</a><span class="delimiter">(</span><span title="String(&quot;elemExcept&quot;)" class="string">&quot;elemExcept&quot;</span>, <a title="scala.tools.cmd.Parser.Elem" id="611447">x</a> =&gt; <a href="#611447" title="scala.tools.cmd.Parser.Elem">x</a> <a href="../../Char.scala.html#57253" title="(x: Char)Boolean">!=</a> <span title="Char('\032')">EofCh</span> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="#611428" title="scala.tools.cmd.Parser.Elem*">xs</a> <a href="../../collection/SeqLike.scala.html#58824" title="(elem: Any)Boolean">contains</a> <a href="#611447" title="scala.tools.cmd.Parser.Elem">x</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(xs: scala.tools.cmd.Parser.Elem*)scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem]" id="600982">elemOf</a><span class="delimiter">(</span><a title="scala.tools.cmd.Parser.Elem*" id="611452">xs</a>: <span title="scala.tools.cmd.Parser.Elem*">Elem</span>*<span class="delimiter">)</span>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem]">Parser</a><span class="delimiter">[</span>Elem<span class="delimiter">]</span>     = <a href="../../util/parsing/combinator/Parsers.scala.html#600867" title="(kind: String, p: scala.tools.cmd.Parser.Elem =&gt; Boolean)scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem]">elem</a><span class="delimiter">(</span><span title="String(&quot;elemOf&quot;)" class="string">&quot;elemOf&quot;</span>, <a href="#611452" title="scala.tools.cmd.Parser.Elem*">xs</a> <a href="../../collection/SeqLike.scala.html#58824" title="(elem: Any)Boolean">contains</a> <a href="#611459" title="scala.tools.cmd.Parser.Elem">_</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(ch: Char)scala.tools.cmd.Parser.Parser[String]" id="600983">escaped</a><span class="delimiter">(</span><a title="Char" id="611460">ch</a>: <a href="../../Char.scala.html#822" title="Char">Char</a><span class="delimiter">)</span>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="scala.tools.cmd.Parser.Parser[String]">Parser</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="String(&quot;\\&quot;)" class="string">&quot;\\&quot;</span> <a href="../../util/parsing/combinator/RegexParsers.scala.html#600953" title="implicit scala.util.parsing.combinator.RegexParsers.literal : (s: String)scala.tools.cmd.Parser.Parser[String]">+</a> <a href="#611460" title="Char">ch</a>
  <span class="keyword">def</span> <a title="(ch: Char)scala.tools.cmd.Parser.Parser[String]" id="600984">mkQuoted</a><span class="delimiter">(</span><a title="Char" id="611462">ch</a>: <a href="../../Char.scala.html#822" title="Char">Char</a><span class="delimiter">)</span>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="scala.tools.cmd.Parser.Parser[String]">Parser</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">(</span>
      <a href="../../util/parsing/combinator/Parsers.scala.html#600868" title="(e: scala.tools.cmd.Parser.Elem)scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem]">elem</a><a href="#601001" title="(p: scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem])scala.tools.cmd.Parser.ParserPlus[scala.tools.cmd.Parser.Elem]" class="delimiter">(</a><a href="#611462" title="Char">ch</a><span class="delimiter">)</span> <a href="#611225" title="(p: =&gt; scala.tools.cmd.Parser.Parser[List[Any]])scala.tools.cmd.Parser.Parser[List[Any]]">!~&gt;</a> <a href="../../util/parsing/combinator/Parsers.scala.html#600891" title="(p: =&gt; scala.tools.cmd.Parser.Parser[Any])scala.tools.cmd.Parser.Parser[List[Any]]">rep</a><span class="delimiter">(</span><a href="#600983" title="(ch: Char)scala.tools.cmd.Parser.Parser[String]">escaped</a><span class="delimiter">(</span><a href="#611462" title="Char">ch</a><span class="delimiter">)</span> <a href="../../util/parsing/combinator/Parsers.scala.html#611271" title="(q: =&gt; scala.tools.cmd.Parser.Parser[Any])scala.tools.cmd.Parser.Parser[Any]">|</a> <a href="#600981" title="(xs: scala.tools.cmd.Parser.Elem*)scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem]">elemExcept</a><span class="delimiter">(</span><a href="#611462" title="Char">ch</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../util/parsing/combinator/Parsers.scala.html#611265" title="(q: =&gt; scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem])scala.tools.cmd.Parser.Parser[List[Any]]">&lt;~</a> <a href="../../util/parsing/combinator/Parsers.scala.html#600869" title="implicit scala.util.parsing.combinator.Parsers.accept : (e: scala.tools.cmd.Parser.Elem)scala.tools.cmd.Parser.Parser[scala.tools.cmd.Parser.Elem]">ch</a> <a href="../../util/parsing/combinator/Parsers.scala.html#611277" title="(f: List[Any] =&gt; String)scala.tools.cmd.Parser.Parser[String]">^^</a> <span class="delimiter">(</span><a href="#611562" title="List[Any]">_</a>.<a href="../../collection/TraversableOnce.scala.html#58284" title="=&gt; String">mkString</a><span class="delimiter">)</span>
    <a href="../../util/parsing/combinator/Parsers.scala.html#611271" title="(q: =&gt; scala.tools.cmd.Parser.Parser[String])scala.tools.cmd.Parser.Parser[String]">|</a> <a href="../../util/parsing/combinator/Parsers.scala.html#600883" title="(msg: String)scala.tools.cmd.Parser.Parser[Nothing]">failure</a><span class="delimiter">(</span><a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Unmatched %s in input.&quot;</a> <a href="../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a> <a href="#611462" title="Char">ch</a><span class="delimiter">)</span>
  <span class="delimiter">)</span>

  /** Apparently windows can't deal with the quotes sticking around. */
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.cmd.Parser.Parser[String]" id="600986">squoted</a>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="scala.tools.cmd.Parser.Parser[String]">Parser</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="#600984" title="(ch: Char)scala.tools.cmd.Parser.Parser[String]">mkQuoted</a><span class="delimiter">(</span><span title="Char('\'')" class="char">'\''</span><span class="delimiter">)</span>   // ^^ (x =&gt; &quot;'%s'&quot; format x)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.cmd.Parser.Parser[String]" id="600988">dquoted</a>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="scala.tools.cmd.Parser.Parser[String]">Parser</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="#600984" title="(ch: Char)scala.tools.cmd.Parser.Parser[String]">mkQuoted</a><span class="delimiter">(</span><span title="Char('\&quot;')" class="char">'&quot;'</span><span class="delimiter">)</span>    // ^^ (x =&gt; &quot;\&quot;&quot; + x + &quot;\&quot;&quot;)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.cmd.Parser.Parser[String]" id="600990">token</a>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="scala.tools.cmd.Parser.Parser[String]">Parser</a><span class="delimiter">[</span>String<span class="delimiter">]</span>   = <a href="../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;\S+&quot;&quot;&quot;</a>.<a href="../../util/parsing/combinator/RegexParsers.scala.html#600954" title="implicit scala.util.parsing.combinator.RegexParsers.regex : (r: scala.util.matching.Regex)scala.tools.cmd.Parser.Parser[String]">r</a>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.cmd.Parser.Parser[String]" id="600992">argument</a>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="scala.tools.cmd.Parser.Parser[String]">Parser</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="#600985" title="=&gt; scala.tools.cmd.Parser.Parser[String]">squoted</a> <a href="../../util/parsing/combinator/Parsers.scala.html#611271" title="(q: =&gt; scala.tools.cmd.Parser.Parser[String])scala.tools.cmd.Parser.Parser[String]">|</a> <a href="#600987" title="=&gt; scala.tools.cmd.Parser.Parser[String]">dquoted</a> <a href="../../util/parsing/combinator/Parsers.scala.html#611271" title="(q: =&gt; scala.tools.cmd.Parser.Parser[String])scala.tools.cmd.Parser.Parser[String]">|</a> <a href="#600989" title="=&gt; scala.tools.cmd.Parser.Parser[String]">token</a>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.cmd.Parser.Parser[List[String]]" id="600994">commandLine</a>: <a href="../../util/parsing/combinator/Parsers.scala.html#600862" title="scala.tools.cmd.Parser.Parser[List[String]]">Parser</a><span class="delimiter">[</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="../../util/parsing/combinator/RegexParsers.scala.html#600958" title="(p: scala.tools.cmd.Parser.Parser[List[String]])scala.tools.cmd.Parser.Parser[List[String]]">phrase</a><span class="delimiter">(</span><a href="../../util/parsing/combinator/Parsers.scala.html#600894" title="(p: =&gt; scala.tools.cmd.Parser.Parser[String], q: =&gt; scala.tools.cmd.Parser.Parser[Any])scala.tools.cmd.Parser.Parser[List[String]]">repsep</a><span class="delimiter">(</span><a href="#600991" title="=&gt; scala.tools.cmd.Parser.Parser[String]">argument</a>, <a href="../../util/parsing/combinator/RegexParsers.scala.html#600954" title="implicit scala.util.parsing.combinator.RegexParsers.regex : (r: scala.util.matching.Regex)scala.tools.cmd.Parser.Parser[String]">whiteSpace</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">class</span> <a title="class ParseException extends RuntimeException" id="600995">ParseException</a><a href="#600995" title="scala.tools.cmd.Parser.ParseException" class="delimiter">(</a><a title="String" id="611832">msg</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../package.scala.html#55502" title="RuntimeException">RuntimeException</a><span class="delimiter">(</span><a href="#611832" title="String">msg</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(line: String)List[String]" id="600996">tokenize</a><span class="delimiter">(</span><a title="String" id="601009">line</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../collection/immutable/List.scala.html#11952" title="List[String]">List</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="#600997" title="(line: String, errorFn: String =&gt; Unit)List[String]">tokenize</a><span class="delimiter">(</span><a href="#601009" title="String">line</a>, <a title="String" id="611843">x</a> =&gt; <span title="Nothing" class="keyword">throw</span> <span title="scala.tools.cmd.Parser.ParseException" class="keyword">new</span> <a href="#600995" title="scala.tools.cmd.Parser.ParseException">ParseException</a><span class="delimiter">(</span><a href="#611843" title="String">x</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(line: String, errorFn: String =&gt; Unit)List[String]" id="600997">tokenize</a><span class="delimiter">(</span><a title="String" id="601006">line</a>: <span title="String">String</span>, <a title="String =&gt; Unit" id="601007">errorFn</a>: String =&gt; Unit<span class="delimiter">)</span>: <a href="../../collection/immutable/List.scala.html#11952" title="List[String]">List</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="../../util/parsing/combinator/RegexParsers.scala.html#600964" title="(p: scala.tools.cmd.Parser.Parser[List[String]], in: CharSequence)scala.tools.cmd.Parser.ParseResult[List[String]]">parse</a><a href="#3298509" title="scala.tools.cmd.Parser.ParseResult[List[String]]" class="delimiter">(</a><a href="#600993" title="=&gt; scala.tools.cmd.Parser.Parser[List[String]]">commandLine</a>, <a href="#601006" title="String">line</a>.<span title="()String">trim</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Success<a href="#3298509" title="List[String]" id="3298511" class="delimiter">(</a><a href="../../util/parsing/combinator/Parsers.scala.html#611700" title="List[String]" id="611898">args</a>, <a href="../../util/parsing/combinator/Parsers.scala.html#611702" title="scala.tools.cmd.Parser.Input" id="3298510">_</a><span class="delimiter">)</span>     =&gt; <a href="#3298514" title="(x: List[String])List[String]">args</a>
      <span class="keyword">case</span> <a href="../../util/parsing/combinator/Parsers.scala.html#611900" title="Option[(String, scala.tools.cmd.Parser.Input)]" id="3298519">NoSuccess</a><span class="delimiter">(</span><a href="../../Tuple2.scala.html#60635" title="String" id="612007">msg</a>, <a href="../../Tuple2.scala.html#60637" title="scala.tools.cmd.Parser.Input" id="612008">rest</a><span class="delimiter">)</span> =&gt; <a href="../../Function1.scala.html#58642" title="(v1: String)Unit">errorFn</a><span class="delimiter">(</span><a href="#612007" title="String">msg</a><span class="delimiter">)</span> ; <a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
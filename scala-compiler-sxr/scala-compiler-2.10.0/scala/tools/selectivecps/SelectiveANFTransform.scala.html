<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/selectivecps/SelectiveANFTransform.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
// $Id$

<span class="keyword">package</span> scala.tools.selectivecps

<span class="keyword">import</span> scala.tools.nsc._
<span class="keyword">import</span> scala.tools.nsc.transform._
<span class="keyword">import</span> scala.tools.nsc.symtab._
<span class="keyword">import</span> scala.tools.nsc.plugins._

<span class="keyword">import</span> scala.tools.nsc.ast._

/**
 * In methods marked @cps, explicitly name results of calls to other @cps methods
 */
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class SelectiveANFTransform extends scala.tools.nsc.plugins.PluginComponent with scala.tools.nsc.transform.Transform with scala.tools.nsc.transform.TypingTransformers with scala.tools.selectivecps.CPSUtils" id="51713">SelectiveANFTransform</a> <a href="#51713" title="scala.tools.selectivecps.SelectiveANFTransform" class="keyword">extends</a> <a href="../nsc/plugins/PluginComponent.scala.html#41112" title="scala.tools.nsc.plugins.PluginComponent">PluginComponent</a> <span class="keyword">with</span> <a href="../nsc/transform/Transform.scala.html#43152" title="scala.tools.nsc.transform.Transform">Transform</a> <span class="keyword">with</span>
  <a href="../nsc/transform/TypingTransformers.scala.html#43407" title="scala.tools.nsc.transform.TypingTransformers">TypingTransformers</a> <span class="keyword">with</span> <a href="CPSUtils.scala.html#51704" title="scala.tools.selectivecps.CPSUtils">CPSUtils</a> <span class="delimiter">{</span>
  // inherits abstract value `global` and class `Phase` from Transform

  <span class="keyword">import</span> <a href="CPSUtils.scala.html#1211325" title="=&gt; scala.tools.nsc.Global">global</a>._                  // the global environment
  <span class="keyword">import</span> <a href="../../reflect/internal/Definitions.scala.html#407777" title="SelectiveANFTransform.this.global.definitions.type">definitions</a>._             // standard classes and methods
  <span class="keyword">import</span> <a href="../nsc/Global.scala.html#537612" title="SelectiveANFTransform.this.global.typer.type">typer</a>.atOwner             // methods to type trees

  /** the following two members override abstract members in Transform */
  <span class="keyword">val</span> <a title="String" id="1213157">phaseName</a>: <span title="String">String</span> = <span title="String(&quot;selectiveanf&quot;)" class="string">&quot;selectiveanf&quot;</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(unit: SelectiveANFTransform.this.global.CompilationUnit)SelectiveANFTransform.this.global.Transformer" id="1213159">newTransformer</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.CompilationUnit" id="1213164">unit</a>: <a href="../nsc/CompilationUnits.scala.html#537766" title="SelectiveANFTransform.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span>: <a href="../nsc/ast/Trees.scala.html#537817" title="SelectiveANFTransform.this.global.Transformer">Transformer</a> =
    <span title="SelectiveANFTransform.this.ANFTransformer" class="keyword">new</span> <a href="#1213160" title="SelectiveANFTransform.this.ANFTransformer">ANFTransformer</a><span class="delimiter">(</span><a href="#1213164" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a><span class="delimiter">)</span>


  <span class="keyword">class</span> <a title="class ANFTransformer extends SelectiveANFTransform.this.TypingTransformer" id="1213160">ANFTransformer</a><a href="#1213160" title="SelectiveANFTransform.this.ANFTransformer" class="delimiter">(</a><a title="SelectiveANFTransform.this.global.CompilationUnit" id="1213186">unit</a>: <a href="../nsc/CompilationUnits.scala.html#537766" title="SelectiveANFTransform.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../nsc/transform/TypingTransformers.scala.html#621441" title="SelectiveANFTransform.this.TypingTransformer">TypingTransformer</a><span class="delimiter">(</span><a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a><span class="delimiter">)</span> <span class="delimiter">{</span>

    <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.CompilationUnit" id="1213170">_unit</a> = <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a> // allow code in CPSUtils.scala to report errors
    <span class="keyword">var</span> <a title="Boolean" id="1213173">cpsAllowed</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span> // detect cps code in places we do not handle (yet)

    <span class="keyword">object</span> <a title="ANFTransformer.this.RemoveTailReturnsTransformer.type" id="1213175">RemoveTailReturnsTransformer</a> <a href="#1213176" title="ANFTransformer.this.RemoveTailReturnsTransformer.type" class="keyword">extends</a> <a href="../nsc/ast/Trees.scala.html#537817" title="SelectiveANFTransform.this.global.Transformer">Transformer</a> <span class="delimiter">{</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" id="1213192">transform</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1213194">tree</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a> = <a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Block<a href="#3381894" title="Boolean" id="3381896" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410192" title="List[SelectiveANFTransform.this.global.Tree]" id="1213202">stms</a>, <a href="../../reflect/internal/Trees.scala.html#410194" title="SelectiveANFTransform.this.global.Tree" id="1213203">r</a> @ Return<a href="#1213203" title="SelectiveANFTransform.this.global.Tree" id="3381898" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410090" title="SelectiveANFTransform.this.global.Tree" id="1213205">expr</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405380" title="(tree: SelectiveANFTransform.this.global.Tree, stats: List[SelectiveANFTransform.this.global.Tree], expr: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Block">Block</a><a href="#3381932" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213202" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="#1213205" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Block<span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#410192" title="List[SelectiveANFTransform.this.global.Tree]" id="1213213">stms</a>, <a href="../../reflect/internal/Trees.scala.html#410194" title="SelectiveANFTransform.this.global.Tree" id="1213214">expr</a><span class="delimiter">)</span> =&gt;
          <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405380" title="(tree: SelectiveANFTransform.this.global.Tree, stats: List[SelectiveANFTransform.this.global.Tree], expr: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Block">Block</a><a href="#3381932" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213213" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213214" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> If<a href="#3381894" title="Boolean" id="3381902" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410107" title="SelectiveANFTransform.this.global.Tree" id="1213218">cond</a>, <a href="../../reflect/internal/Trees.scala.html#410109" title="SelectiveANFTransform.this.global.Tree" id="1213219">r1</a> @ Return<a href="#1213219" title="SelectiveANFTransform.this.global.Tree" id="3381904" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410090" title="SelectiveANFTransform.this.global.Tree" id="1213221">thenExpr</a><span class="delimiter">)</span>, <a href="../../reflect/internal/Trees.scala.html#410111" title="SelectiveANFTransform.this.global.Tree" id="1213222">r2</a> @ Return<a href="#1213222" title="SelectiveANFTransform.this.global.Tree" id="3381906" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410090" title="SelectiveANFTransform.this.global.Tree" id="1213224">elseExpr</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405389" title="(tree: SelectiveANFTransform.this.global.Tree, cond: SelectiveANFTransform.this.global.Tree, thenp: SelectiveANFTransform.this.global.Tree, elsep: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.If">If</a><a href="#3381932" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213218" title="SelectiveANFTransform.this.global.Tree">cond</a>, <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213221" title="SelectiveANFTransform.this.global.Tree">thenExpr</a><span class="delimiter">)</span>, <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213224" title="SelectiveANFTransform.this.global.Tree">elseExpr</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> If<span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#410107" title="SelectiveANFTransform.this.global.Tree" id="1213232">cond</a>, <a href="../../reflect/internal/Trees.scala.html#410109" title="SelectiveANFTransform.this.global.Tree" id="1213233">r1</a> @ Return<a href="#1213233" title="SelectiveANFTransform.this.global.Tree" id="3381910" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410090" title="SelectiveANFTransform.this.global.Tree" id="1213235">thenExpr</a><span class="delimiter">)</span>, <a href="../../reflect/internal/Trees.scala.html#410111" title="SelectiveANFTransform.this.global.Tree" id="1213236">elseExpr</a><span class="delimiter">)</span> =&gt;
          <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405389" title="(tree: SelectiveANFTransform.this.global.Tree, cond: SelectiveANFTransform.this.global.Tree, thenp: SelectiveANFTransform.this.global.Tree, elsep: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.If">If</a><a href="#3381932" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213232" title="SelectiveANFTransform.this.global.Tree">cond</a>, <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213235" title="SelectiveANFTransform.this.global.Tree">thenExpr</a><span class="delimiter">)</span>, <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213236" title="SelectiveANFTransform.this.global.Tree">elseExpr</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> If<span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#410107" title="SelectiveANFTransform.this.global.Tree" id="1213240">cond</a>, <a href="../../reflect/internal/Trees.scala.html#410109" title="SelectiveANFTransform.this.global.Tree" id="1213241">thenExpr</a>, <a href="../../reflect/internal/Trees.scala.html#410111" title="SelectiveANFTransform.this.global.Tree" id="1213242">r2</a> @ Return<a href="#1213242" title="SelectiveANFTransform.this.global.Tree" id="3381914" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410090" title="SelectiveANFTransform.this.global.Tree" id="1213244">elseExpr</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405389" title="(tree: SelectiveANFTransform.this.global.Tree, cond: SelectiveANFTransform.this.global.Tree, thenp: SelectiveANFTransform.this.global.Tree, elsep: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.If">If</a><a href="#3381932" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213240" title="SelectiveANFTransform.this.global.Tree">cond</a>, <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213241" title="SelectiveANFTransform.this.global.Tree">thenExpr</a><span class="delimiter">)</span>, <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213244" title="SelectiveANFTransform.this.global.Tree">elseExpr</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> If<span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#410107" title="SelectiveANFTransform.this.global.Tree" id="1213248">cond</a>, <a href="../../reflect/internal/Trees.scala.html#410109" title="SelectiveANFTransform.this.global.Tree" id="1213249">thenExpr</a>, <a href="../../reflect/internal/Trees.scala.html#410111" title="SelectiveANFTransform.this.global.Tree" id="1213250">elseExpr</a><span class="delimiter">)</span> =&gt;
          <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405389" title="(tree: SelectiveANFTransform.this.global.Tree, cond: SelectiveANFTransform.this.global.Tree, thenp: SelectiveANFTransform.this.global.Tree, elsep: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.If">If</a><a href="#3381932" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213248" title="SelectiveANFTransform.this.global.Tree">cond</a>, <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213249" title="SelectiveANFTransform.this.global.Tree">thenExpr</a><span class="delimiter">)</span>, <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213250" title="SelectiveANFTransform.this.global.Tree">elseExpr</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> Try<a href="#3381894" title="SelectiveANFTransform.this.global.Tree" id="3381918" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410079" title="SelectiveANFTransform.this.global.Tree" id="1213260">block</a>, <a href="../../reflect/internal/Trees.scala.html#410081" title="List[SelectiveANFTransform.this.global.CaseDef]" id="1213261">catches</a>, <a href="../../reflect/internal/Trees.scala.html#410083" title="SelectiveANFTransform.this.global.Tree" id="1213262">finalizer</a><span class="delimiter">)</span> =&gt;
          <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405392" title="(tree: SelectiveANFTransform.this.global.Tree, block: SelectiveANFTransform.this.global.Tree, catches: List[SelectiveANFTransform.this.global.CaseDef], finalizer: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Try">Try</a><a href="#3381932" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>,
                       <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213260" title="SelectiveANFTransform.this.global.Tree">block</a><span class="delimiter">)</span>,
                       <span class="delimiter">(</span><a href="#1213261" title="List[SelectiveANFTransform.this.global.CaseDef]">catches</a> <a href="../../collection/TraversableLike.scala.html#58063" title="(f: SelectiveANFTransform.this.global.CaseDef =&gt; SelectiveANFTransform.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.CaseDef],SelectiveANFTransform.this.global.Tree,List[SelectiveANFTransform.this.global.Tree]])List[SelectiveANFTransform.this.global.Tree]">map</a> <span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.CaseDef" id="1213283">t</a> =&gt; <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213283" title="SelectiveANFTransform.this.global.CaseDef">t</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="List[SelectiveANFTransform.this.global.CaseDef]" class="delimiter">[</span><a href="../../collection/immutable/List.scala.html#11952" title="List[SelectiveANFTransform.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span><span class="delimiter">]</span>,
                       <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213262" title="SelectiveANFTransform.this.global.Tree">finalizer</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> CaseDef<a href="#3381894" title="Boolean" id="3381920" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410180" title="SelectiveANFTransform.this.global.Tree" id="1213330">pat</a>, <a href="../../reflect/internal/Trees.scala.html#410182" title="SelectiveANFTransform.this.global.Tree" id="1213331">guard</a>, <a href="../../reflect/internal/Trees.scala.html#410184" title="SelectiveANFTransform.this.global.Tree" id="1213332">r</a> @ Return<a href="#1213332" title="SelectiveANFTransform.this.global.Tree" id="3381922" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410090" title="SelectiveANFTransform.this.global.Tree" id="1213334">expr</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405381" title="(tree: SelectiveANFTransform.this.global.Tree, pat: SelectiveANFTransform.this.global.Tree, guard: SelectiveANFTransform.this.global.Tree, body: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.CaseDef">CaseDef</a><a href="#3381932" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213330" title="SelectiveANFTransform.this.global.Tree">pat</a>, <a href="#1213331" title="SelectiveANFTransform.this.global.Tree">guard</a>, <a href="#1213334" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span>

        <span class="keyword">case</span> CaseDef<span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#410180" title="SelectiveANFTransform.this.global.Tree" id="1213344">pat</a>, <a href="../../reflect/internal/Trees.scala.html#410182" title="SelectiveANFTransform.this.global.Tree" id="1213345">guard</a>, <a href="../../reflect/internal/Trees.scala.html#410184" title="SelectiveANFTransform.this.global.Tree" id="1213346">body</a><span class="delimiter">)</span> =&gt;
          <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405381" title="(tree: SelectiveANFTransform.this.global.Tree, pat: SelectiveANFTransform.this.global.Tree, guard: SelectiveANFTransform.this.global.Tree, body: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.CaseDef">CaseDef</a><a href="#3381932" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213344" title="SelectiveANFTransform.this.global.Tree">pat</a>, <a href="#1213345" title="SelectiveANFTransform.this.global.Tree">guard</a>, <a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213346" title="SelectiveANFTransform.this.global.Tree">body</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> Return<a href="#3381894" title="SelectiveANFTransform.this.global.Tree" id="3381927" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410090" title="SelectiveANFTransform.this.global.Tree" id="3381925">_</a><span class="delimiter">)</span> =&gt;
          <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539298" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;return expressions in CPS code must be in tail position&quot;)" class="string">&quot;return expressions in CPS code must be in tail position&quot;</span><span class="delimiter">)</span>
          <a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a>

        <span class="keyword">case</span> _ =&gt;
          <span class="keyword">super</span>.<a href="../../reflect/api/Trees.scala.html#405652" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><a href="#3381932" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213194" title="SelectiveANFTransform.this.global.Tree">tree</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(body: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" id="1213177">removeTailReturns</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1213351">body</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      // support body with single return expression
      <a href="#1213351" title="SelectiveANFTransform.this.global.Tree">body</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Return<a href="#3381946" title="SelectiveANFTransform.this.global.Tree" id="3381948" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410090" title="SelectiveANFTransform.this.global.Tree" id="1213353">expr</a><span class="delimiter">)</span> =&gt; <a href="#3381950" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">expr</a>
        <span class="keyword">case</span> _ =&gt; <a href="#1213175" title="ANFTransformer.this.RemoveTailReturnsTransformer.type">RemoveTailReturnsTransformer</a>.<a href="#1213192" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><a href="#3381950" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213351" title="SelectiveANFTransform.this.global.Tree">body</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" id="1213178">transform</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1213355">tree</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#1211328" title="=&gt; Boolean">cpsEnabled</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">return</span> <a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a>

      <a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>

        // Maybe we should further generalize the transform and move it over
        // to the regular Transformer facility. But then, actual and required cps
        // state would need more complicated (stateful!) tracking.

        // Making the default case use transExpr(tree, None, None) instead of
        // calling super.transform() would be a start, but at the moment,
        // this would cause infinite recursion. But we could remove the
        // ValDef case here.

        <span class="keyword">case</span> dd @ DefDef<a href="#3382026" title="SelectiveANFTransform.this.global.Tree" id="3382028" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410278" title="SelectiveANFTransform.this.global.Modifiers" id="1213397">mods</a>, <a href="../../reflect/internal/Trees.scala.html#410280" title="SelectiveANFTransform.this.global.Name" id="1213398">name</a>, <a href="../../reflect/internal/Trees.scala.html#410282" title="List[SelectiveANFTransform.this.global.TypeDef]" id="1213399">tparams</a>, <a href="../../reflect/internal/Trees.scala.html#410284" title="List[List[SelectiveANFTransform.this.global.ValDef]]" id="1213400">vparamss</a>, <a href="../../reflect/internal/Trees.scala.html#410286" title="SelectiveANFTransform.this.global.Tree" id="1213401">tpt</a>, <a href="../../reflect/internal/Trees.scala.html#410288" title="SelectiveANFTransform.this.global.Tree" id="1213402">rhs0</a><span class="delimiter">)</span> =&gt;
          <a href="../nsc/Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;transforming &quot;)" class="string">&quot;transforming &quot;</span> <span title="(x$1: Any)String">+</span> dd.<a href="../../reflect/internal/Trees.scala.html#409939" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a><span class="delimiter">)</span>

          <a href="../nsc/transform/TypingTransformers.scala.html#984463" title="(owner: SelectiveANFTransform.this.global.Symbol)(trans: =&gt; SelectiveANFTransform.this.global.DefDef)SelectiveANFTransform.this.global.DefDef">atOwner</a><span class="delimiter">(</span>dd.<a href="../../reflect/internal/Trees.scala.html#409939" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1213423">rhs</a> =
              <span title="SelectiveANFTransform.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="CPSUtils.scala.html#1211377" title="(tpe: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">cpsParamTypes</a><span class="delimiter">(</span><a href="#1213401" title="SelectiveANFTransform.this.global.Tree">tpt</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>.<a href="../../Option.scala.html#62879" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <a href="#1213177" title="(body: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">removeTailReturns</a><span class="delimiter">(</span><a href="#1213402" title="SelectiveANFTransform.this.global.Tree">rhs0</a><span class="delimiter">)</span>
              <span class="keyword">else</span> <a href="#1213402" title="SelectiveANFTransform.this.global.Tree">rhs0</a>
            <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1213424">rhs1</a> = <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><span class="delimiter">(</span><a href="#1213423" title="SelectiveANFTransform.this.global.Tree">rhs</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="CPSUtils.scala.html#1211383" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getExternalAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213401" title="SelectiveANFTransform.this.global.Tree">tpt</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="CPSUtils.scala.html#1211383" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getExternalAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213401" title="SelectiveANFTransform.this.global.Tree">tpt</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span>

            <a href="../nsc/Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;result &quot;)" class="string">&quot;result &quot;</span><span title="(x$1: Any)String">+</span><a href="#1213424" title="SelectiveANFTransform.this.global.Tree">rhs1</a><span class="delimiter">)</span>
            <a href="../nsc/Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;result is of type &quot;)" class="string">&quot;result is of type &quot;</span><span title="(x$1: Any)String">+</span><a href="#1213424" title="SelectiveANFTransform.this.global.Tree">rhs1</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>

            <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405375" title="(tree: SelectiveANFTransform.this.global.Tree, mods: SelectiveANFTransform.this.global.Modifiers, name: SelectiveANFTransform.this.global.Name, tparams: List[SelectiveANFTransform.this.global.TypeDef], vparamss: List[List[SelectiveANFTransform.this.global.ValDef]], tpt: SelectiveANFTransform.this.global.Tree, rhs: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.DefDef">DefDef</a><span class="delimiter">(</span>dd, <a href="#1213397" title="SelectiveANFTransform.this.global.Modifiers">mods</a>, <a href="#1213398" title="SelectiveANFTransform.this.global.Name">name</a>, <a href="../../reflect/api/Trees.scala.html#405655" title="(trees: List[SelectiveANFTransform.this.global.TypeDef])List[SelectiveANFTransform.this.global.TypeDef]">transformTypeDefs</a><span class="delimiter">(</span><a href="#1213399" title="List[SelectiveANFTransform.this.global.TypeDef]">tparams</a><span class="delimiter">)</span>, <a href="../../reflect/api/Trees.scala.html#405658" title="(treess: List[List[SelectiveANFTransform.this.global.ValDef]])List[List[SelectiveANFTransform.this.global.ValDef]]">transformValDefss</a><span class="delimiter">(</span><a href="#1213400" title="List[List[SelectiveANFTransform.this.global.ValDef]]">vparamss</a><span class="delimiter">)</span>,
                        <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213401" title="SelectiveANFTransform.this.global.Tree">tpt</a><span class="delimiter">)</span>, <a href="#1213424" title="SelectiveANFTransform.this.global.Tree">rhs1</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> ff @ Function<a href="#3382026" title="SelectiveANFTransform.this.global.Tree" id="3382030" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410136" title="List[SelectiveANFTransform.this.global.ValDef]" id="1213447">vparams</a>, <a href="../../reflect/internal/Trees.scala.html#410138" title="SelectiveANFTransform.this.global.Tree" id="1213448">body</a><span class="delimiter">)</span> =&gt;
          <a href="../nsc/Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;transforming anon function &quot;)" class="string">&quot;transforming anon function &quot;</span> <span title="(x$1: Any)String">+</span> ff.<a href="../../reflect/internal/Trees.scala.html#409939" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a><span class="delimiter">)</span>

          <a href="../nsc/transform/TypingTransformers.scala.html#984463" title="(owner: SelectiveANFTransform.this.global.Symbol)(trans: =&gt; SelectiveANFTransform.this.global.Function)SelectiveANFTransform.this.global.Function">atOwner</a><span class="delimiter">(</span>ff.<a href="../../reflect/internal/Trees.scala.html#409939" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>

            //val body1 = transExpr(body, None, getExternalAnswerTypeAnn(body.tpe))

            // need to special case partial functions: if expected type is @cps
            // but all cases are pure, then we would transform
            // { x =&gt; x match { case A =&gt; ... }} to
            // { x =&gt; shiftUnit(x match { case A =&gt; ... })}
            // which Uncurry cannot handle (see function6.scala)
            // thus, we push down the shiftUnit to each of the case bodies

            <span class="keyword">val</span> <a title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]" id="1213465">ext</a> = <a href="CPSUtils.scala.html#1211383" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getExternalAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213448" title="SelectiveANFTransform.this.global.Tree">body</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="Boolean" id="1213466">pureBody</a> = <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213448" title="SelectiveANFTransform.this.global.Tree">body</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>.<a href="../../Option.scala.html#62856" title="=&gt; Boolean">isEmpty</a>
            <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="Boolean" id="1213467">isParentImpure</a> = <a href="#1213465" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">ext</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a>

            <span class="keyword">def</span> <a title="(tree: SelectiveANFTransform.this.global.Tree, selector: SelectiveANFTransform.this.global.Tree, cases: List[SelectiveANFTransform.this.global.CaseDef])SelectiveANFTransform.this.global.Match" id="1213468">transformPureMatch</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1213472">tree</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a>, <a title="SelectiveANFTransform.this.global.Tree" id="1213473">selector</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a>, <a title="List[SelectiveANFTransform.this.global.CaseDef]" id="1213474">cases</a>: <a href="../../collection/immutable/List.scala.html#11952" title="List[SelectiveANFTransform.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="List[SelectiveANFTransform.this.global.CaseDef]" id="1213475">caseVals</a> = <a href="#1213474" title="List[SelectiveANFTransform.this.global.CaseDef]">cases</a> <a href="../../collection/TraversableLike.scala.html#58063" title="(f: SelectiveANFTransform.this.global.CaseDef =&gt; SelectiveANFTransform.this.global.CaseDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.CaseDef],SelectiveANFTransform.this.global.CaseDef,List[SelectiveANFTransform.this.global.CaseDef]])List[SelectiveANFTransform.this.global.CaseDef]">map</a> <a href="#1213492" title="SelectiveANFTransform.this.global.CaseDef" class="delimiter">{</a> <span class="keyword">case</span> cd @ CaseDef<span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#410180" title="SelectiveANFTransform.this.global.Tree" id="1213499">pat</a>, <a href="../../reflect/internal/Trees.scala.html#410182" title="SelectiveANFTransform.this.global.Tree" id="1213500">guard</a>, <a href="../../reflect/internal/Trees.scala.html#410184" title="SelectiveANFTransform.this.global.Tree" id="1213501">body</a><span class="delimiter">)</span> =&gt;
                // if (!hasPlusMarker(body.tpe)) body.tpe = body.tpe withAnnotation newPlusMarker() // TODO: to avoid warning
                <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1213502">bodyVal</a> = <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><a href="#1213467" title="Boolean" class="delimiter">(</a><a href="#1213501" title="SelectiveANFTransform.this.global.Tree">body</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="#1213465" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">ext</a><span class="delimiter">)</span> // ??? triggers &quot;cps-transformed unexpectedly&quot; warning in transTailValue
                <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405381" title="(tree: SelectiveANFTransform.this.global.Tree, pat: SelectiveANFTransform.this.global.Tree, guard: SelectiveANFTransform.this.global.Tree, body: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.CaseDef">CaseDef</a><span class="delimiter">(</span>cd, <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213499" title="SelectiveANFTransform.this.global.Tree">pat</a><span class="delimiter">)</span>, <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213500" title="SelectiveANFTransform.this.global.Tree">guard</a><span class="delimiter">)</span>, <a href="#1213502" title="SelectiveANFTransform.this.global.Tree">bodyVal</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
              <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405390" title="(tree: SelectiveANFTransform.this.global.Tree, selector: SelectiveANFTransform.this.global.Tree, cases: List[SelectiveANFTransform.this.global.CaseDef])SelectiveANFTransform.this.global.Match">Match</a><span class="delimiter">(</span><a href="#1213472" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213473" title="SelectiveANFTransform.this.global.Tree">selector</a><span class="delimiter">)</span>, <a href="#1213475" title="List[SelectiveANFTransform.this.global.CaseDef]">caseVals</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

            <span class="keyword">def</span> <a title="(body: SelectiveANFTransform.this.global.Block, selDef: SelectiveANFTransform.this.global.ValDef, cases: List[SelectiveANFTransform.this.global.Tree], matchEnd: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Block" id="1213469">transformPureVirtMatch</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Block" id="1213539">body</a>: <a href="../../reflect/internal/Trees.scala.html#407981" title="SelectiveANFTransform.this.global.Block">Block</a>, <a title="SelectiveANFTransform.this.global.ValDef" id="1213540">selDef</a>: <a href="../../reflect/internal/Trees.scala.html#407960" title="SelectiveANFTransform.this.global.ValDef">ValDef</a>, <a title="List[SelectiveANFTransform.this.global.Tree]" id="1213541">cases</a>: <a href="../../collection/immutable/List.scala.html#11952" title="List[SelectiveANFTransform.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="SelectiveANFTransform.this.global.Tree" id="1213542">matchEnd</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="List[SelectiveANFTransform.this.global.Tree]" id="1213543">stats</a> = <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213540" title="SelectiveANFTransform.this.global.ValDef">selDef</a><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#62685" title="(x: SelectiveANFTransform.this.global.Tree)List[SelectiveANFTransform.this.global.Tree]">::</a> <span class="delimiter">(</span><a href="#1213541" title="List[SelectiveANFTransform.this.global.Tree]">cases</a> <a href="../../collection/TraversableLike.scala.html#58063" title="(f: SelectiveANFTransform.this.global.Tree =&gt; SelectiveANFTransform.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.Tree],SelectiveANFTransform.this.global.Tree,List[SelectiveANFTransform.this.global.Tree]])List[SelectiveANFTransform.this.global.Tree]">map</a> <span class="delimiter">(</span><a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><a href="#1213467" title="Boolean" class="delimiter">(</a><a href="#1213561" title="SelectiveANFTransform.this.global.Tree">_</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="#1213465" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">ext</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405380" title="(tree: SelectiveANFTransform.this.global.Tree, stats: List[SelectiveANFTransform.this.global.Tree], expr: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Block">Block</a><span class="delimiter">(</span><a href="#1213539" title="SelectiveANFTransform.this.global.Block">body</a>, <a href="#1213543" title="List[SelectiveANFTransform.this.global.Tree]">stats</a>, <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><a href="#1213467" title="Boolean" class="delimiter">(</a><a href="#1213542" title="SelectiveANFTransform.this.global.Tree">matchEnd</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="#1213465" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">ext</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>

            <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1213470">body1</a> = <a href="#1213448" title="SelectiveANFTransform.this.global.Tree">body</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Match<a href="#3381961" title="SelectiveANFTransform.this.global.Tree" id="3381963" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410097" title="SelectiveANFTransform.this.global.Tree" id="1213600">selector</a>, <a href="../../reflect/internal/Trees.scala.html#410099" title="List[SelectiveANFTransform.this.global.CaseDef]" id="1213601">cases</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#1213465" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">ext</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1213466" title="Boolean">pureBody</a> =&gt;
                <a href="#1213468" title="(tree: SelectiveANFTransform.this.global.Tree, selector: SelectiveANFTransform.this.global.Tree, cases: List[SelectiveANFTransform.this.global.CaseDef])SelectiveANFTransform.this.global.Match">transformPureMatch</a><a href="#3381994" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213448" title="SelectiveANFTransform.this.global.Tree">body</a>, <a href="#1213600" title="SelectiveANFTransform.this.global.Tree">selector</a>, <a href="#1213601" title="List[SelectiveANFTransform.this.global.CaseDef]">cases</a><span class="delimiter">)</span>

              // virtpatmat switch
              <span class="keyword">case</span> Block<a href="#3381961" title="Boolean" id="3381966" class="delimiter">(</a><a href="../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[SelectiveANFTransform.this.global.Tree]]" id="3381999">List</a><a href="../../reflect/internal/Trees.scala.html#410192" title="List[SelectiveANFTransform.this.global.Tree]" id="3381964" class="delimiter">(</a><a title="SelectiveANFTransform.this.global.Tree" id="1213618">selDef</a>: ValDef<span class="delimiter">)</span>, <a href="../../reflect/internal/Trees.scala.html#410194" title="SelectiveANFTransform.this.global.Tree" id="1213619">mat</a>@Match<a href="#1213619" title="SelectiveANFTransform.this.global.Tree" id="3381972" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410097" title="SelectiveANFTransform.this.global.Tree" id="1213622">selector</a>, <a href="../../reflect/internal/Trees.scala.html#410099" title="List[SelectiveANFTransform.this.global.CaseDef]" id="1213623">cases</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#1213465" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">ext</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1213466" title="Boolean">pureBody</a> =&gt;
                <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405380" title="(tree: SelectiveANFTransform.this.global.Tree, stats: List[SelectiveANFTransform.this.global.Tree], expr: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Block">Block</a><a href="#3381994" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213448" title="SelectiveANFTransform.this.global.Tree">body</a>, <a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.Tree*)List[SelectiveANFTransform.this.global.Tree]">List</a><span class="delimiter">(</span><a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span>selDef<span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1213468" title="(tree: SelectiveANFTransform.this.global.Tree, selector: SelectiveANFTransform.this.global.Tree, cases: List[SelectiveANFTransform.this.global.CaseDef])SelectiveANFTransform.this.global.Match">transformPureMatch</a><span class="delimiter">(</span>mat, <a href="#1213622" title="SelectiveANFTransform.this.global.Tree">selector</a>, <a href="#1213623" title="List[SelectiveANFTransform.this.global.CaseDef]">cases</a><span class="delimiter">)</span><span class="delimiter">)</span>

              // virtpatmat
              <span class="keyword">case</span> b@Block<span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#410192" title="List[SelectiveANFTransform.this.global.Tree]" id="1213636">matchStats</a>@<span class="delimiter">(</span><span class="delimiter">(</span><a href="../../collection/immutable/List.scala.html#206583" title="SelectiveANFTransform.this.global.Tree" id="1213639">selDef</a>: ValDef<span class="delimiter">)</span> <a href="#1213636" title="SelectiveANFTransform.this.global.Tree" id="3381975">::</a> <a href="../../collection/immutable/List.scala.html#206584" title="List[SelectiveANFTransform.this.global.Tree]" id="1213640">cases</a><span class="delimiter">)</span>, <a href="../../reflect/internal/Trees.scala.html#410194" title="SelectiveANFTransform.this.global.Tree" id="1213641">matchEnd</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#1213465" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">ext</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1213466" title="Boolean">pureBody</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span>matchStats <a href="../../collection/LinearSeqOptimized.scala.html#86378" title="(p: SelectiveANFTransform.this.global.Tree =&gt; Boolean)Boolean">forall</a> <a href="../nsc/ast/Trees.scala.html#537807" title="SelectiveANFTransform.this.global.treeInfo.type">treeInfo</a>.<a href="../../reflect/internal/TreeInfo.scala.html#479246" title="(t: SelectiveANFTransform.this.global.treeInfo.global.Tree)Boolean">hasSynthCaseSymbol</a><span class="delimiter">)</span> =&gt;
                <a href="#1213469" title="(body: SelectiveANFTransform.this.global.Block, selDef: SelectiveANFTransform.this.global.ValDef, cases: List[SelectiveANFTransform.this.global.Tree], matchEnd: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Block">transformPureVirtMatch</a><a href="#3381994" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a>b, selDef, <a href="#1213640" title="List[SelectiveANFTransform.this.global.Tree]">cases</a>, <a href="#1213641" title="SelectiveANFTransform.this.global.Tree">matchEnd</a><span class="delimiter">)</span>

              // virtpatmat that stores the scrut separately -- TODO: can we eliminate this case??
              <span class="keyword">case</span> Block<span class="delimiter">(</span><a href="../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[SelectiveANFTransform.this.global.Tree]]" id="3382002">List</a><a href="../../reflect/internal/Trees.scala.html#410192" title="List[SelectiveANFTransform.this.global.Tree]" id="3381977" class="delimiter">(</a><a title="SelectiveANFTransform.this.global.Tree" id="1213662">selDef0</a>: ValDef<span class="delimiter">)</span>, <a href="../../reflect/internal/Trees.scala.html#410194" title="SelectiveANFTransform.this.global.Tree" id="1213663">mat</a>@Block<a href="#1213663" title="SelectiveANFTransform.this.global.Tree" id="3381985" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410192" title="List[SelectiveANFTransform.this.global.Tree]" id="1213668">matchStats</a>@<span class="delimiter">(</span><span class="delimiter">(</span><a href="../../collection/immutable/List.scala.html#206583" title="SelectiveANFTransform.this.global.Tree" id="1213671">selDef</a>: ValDef<span class="delimiter">)</span> <a href="#1213668" title="SelectiveANFTransform.this.global.Tree" id="3381986">::</a> <a href="../../collection/immutable/List.scala.html#206584" title="List[SelectiveANFTransform.this.global.Tree]" id="1213672">cases</a><span class="delimiter">)</span>, <a href="../../reflect/internal/Trees.scala.html#410194" title="SelectiveANFTransform.this.global.Tree" id="1213673">matchEnd</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#1213465" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">ext</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1213466" title="Boolean">pureBody</a>  <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span>matchStats <a href="../../collection/LinearSeqOptimized.scala.html#86378" title="(p: SelectiveANFTransform.this.global.Tree =&gt; Boolean)Boolean">forall</a> <a href="../nsc/ast/Trees.scala.html#537807" title="SelectiveANFTransform.this.global.treeInfo.type">treeInfo</a>.<a href="../../reflect/internal/TreeInfo.scala.html#479246" title="(t: SelectiveANFTransform.this.global.treeInfo.global.Tree)Boolean">hasSynthCaseSymbol</a><span class="delimiter">)</span>=&gt;
                <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405380" title="(tree: SelectiveANFTransform.this.global.Tree, stats: List[SelectiveANFTransform.this.global.Tree], expr: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Block">Block</a><a href="#3381994" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213448" title="SelectiveANFTransform.this.global.Tree">body</a>, <a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.Tree*)List[SelectiveANFTransform.this.global.Tree]">List</a><span class="delimiter">(</span><a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span>selDef0<span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1213469" title="(body: SelectiveANFTransform.this.global.Block, selDef: SelectiveANFTransform.this.global.ValDef, cases: List[SelectiveANFTransform.this.global.Tree], matchEnd: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Block">transformPureVirtMatch</a><span class="delimiter">(</span>mat, selDef, <a href="#1213672" title="List[SelectiveANFTransform.this.global.Tree]">cases</a>, <a href="#1213673" title="SelectiveANFTransform.this.global.Tree">matchEnd</a><span class="delimiter">)</span><span class="delimiter">)</span>

              <span class="keyword">case</span> _ =&gt;
                <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><a href="#3381994" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213448" title="SelectiveANFTransform.this.global.Tree">body</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="#1213465" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">ext</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

            <a href="../nsc/Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;anf result &quot;)" class="string">&quot;anf result &quot;</span><span title="(x$1: Any)String">+</span><a href="#1213470" title="SelectiveANFTransform.this.global.Tree">body1</a><span title="(x$1: Any)String">+</span><span title="String(&quot;\nresult is of type &quot;)" class="string">&quot;\nresult is of type &quot;</span><span title="(x$1: Any)String">+</span><a href="#1213470" title="SelectiveANFTransform.this.global.Tree">body1</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>

            <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405386" title="(tree: SelectiveANFTransform.this.global.Tree, vparams: List[SelectiveANFTransform.this.global.ValDef], body: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Function">Function</a><span class="delimiter">(</span>ff, <a href="../../reflect/api/Trees.scala.html#405657" title="(trees: List[SelectiveANFTransform.this.global.ValDef])List[SelectiveANFTransform.this.global.ValDef]">transformValDefs</a><span class="delimiter">(</span><a href="#1213447" title="List[SelectiveANFTransform.this.global.ValDef]">vparams</a><span class="delimiter">)</span>, <a href="#1213470" title="SelectiveANFTransform.this.global.Tree">body1</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> vd @ ValDef<a href="#3382026" title="SelectiveANFTransform.this.global.Tree" id="3382032" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410298" title="SelectiveANFTransform.this.global.Modifiers" id="1213707">mods</a>, <a href="../../reflect/internal/Trees.scala.html#410300" title="SelectiveANFTransform.this.global.TermName" id="1213708">name</a>, <a href="../../reflect/internal/Trees.scala.html#410302" title="SelectiveANFTransform.this.global.Tree" id="1213709">tpt</a>, <a href="../../reflect/internal/Trees.scala.html#410304" title="SelectiveANFTransform.this.global.Tree" id="1213710">rhs</a><span class="delimiter">)</span> =&gt; // object-level valdefs
          <a href="../nsc/Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;transforming valdef &quot;)" class="string">&quot;transforming valdef &quot;</span> <span title="(x$1: Any)String">+</span> vd.<a href="../../reflect/internal/Trees.scala.html#409939" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a><span class="delimiter">)</span>

          <span title="SelectiveANFTransform.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="CPSUtils.scala.html#1211383" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getExternalAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213709" title="SelectiveANFTransform.this.global.Tree">tpt</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>.<a href="../../Option.scala.html#62856" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            
            <a href="../nsc/transform/TypingTransformers.scala.html#984463" title="(owner: SelectiveANFTransform.this.global.Symbol)(trans: =&gt; SelectiveANFTransform.this.global.ValDef)SelectiveANFTransform.this.global.ValDef">atOwner</a><span class="delimiter">(</span>vd.<a href="../../reflect/internal/Trees.scala.html#409939" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>

              <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1213727">rhs1</a> = <a href="#1213160" title="ANFTransformer.this.type">transExpr</a><a href="#1213430" title="Boolean" id="1213734" class="delimiter">(</a><a href="#1213710" title="SelectiveANFTransform.this.global.Tree" id="1213728">rhs</a>, <a href="../../Option.scala.html#1585" title="None.type" id="1213729">None</a>, <a href="../../Option.scala.html#1585" title="None.type" id="1213730">None</a><span class="delimiter">)</span>

              <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405374" title="(tree: SelectiveANFTransform.this.global.Tree, mods: SelectiveANFTransform.this.global.Modifiers, name: SelectiveANFTransform.this.global.Name, tpt: SelectiveANFTransform.this.global.Tree, rhs: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.ValDef">ValDef</a><span class="delimiter">(</span>vd, <a href="#1213707" title="SelectiveANFTransform.this.global.Modifiers">mods</a>, <a href="#1213708" title="SelectiveANFTransform.this.global.TermName">name</a>, <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213709" title="SelectiveANFTransform.this.global.Tree">tpt</a><span class="delimiter">)</span>, <a href="#1213727" title="SelectiveANFTransform.this.global.Tree">rhs1</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539298" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;cps annotations not allowed on by-value parameters or value definitions&quot;)" class="string">&quot;cps annotations not allowed on by-value parameters or value definitions&quot;</span><span class="delimiter">)</span>
            <a href="#1213160" title="SelectiveANFTransform.this.ANFTransformer" class="keyword">super</a>.<a href="../nsc/transform/TypingTransformers.scala.html#984469" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> TypeTree<a href="#3382026" title="SelectiveANFTransform.this.global.Tree" id="3382034" class="delimiter">(</a><span class="delimiter">)</span> =&gt;
          // circumvent cpsAllowed here
          <a href="#1213160" title="SelectiveANFTransform.this.ANFTransformer" class="keyword">super</a>.<a href="../nsc/transform/TypingTransformers.scala.html#984469" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><a href="#3382040" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Apply<a href="#3382026" title="SelectiveANFTransform.this.global.Tree" id="3382038" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410031" title="SelectiveANFTransform.this.global.Tree" id="3382035">_</a>,<a href="../../reflect/internal/Trees.scala.html#410033" title="List[SelectiveANFTransform.this.global.Tree]" id="3382036">_</a><span class="delimiter">)</span> =&gt;
          // this allows reset { ... } in object constructors
          // it's kind of a hack to put it here (see note above)
          <a href="#1213160" title="ANFTransformer.this.type">transExpr</a><a href="#3382040" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" id="1213760" class="delimiter">(</a><a href="#1213355" title="SelectiveANFTransform.this.global.Tree" id="1213757">tree</a>, <a href="../../Option.scala.html#1585" title="None.type" id="1213758">None</a>, <a href="../../Option.scala.html#1585" title="None.type" id="1213759">None</a><span class="delimiter">)</span>

        <span class="keyword">case</span> _ =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="CPSUtils.scala.html#1211385" title="(tp: SelectiveANFTransform.this.global.Type)Boolean">hasAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1213173" title="=&gt; Boolean">cpsAllowed</a><span class="delimiter">)</span>
              <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539298" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;cps code not allowed here / &quot;)" class="string">&quot;cps code not allowed here / &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a>.<span title="()Class[_]">getClass</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; / &quot;)" class="string">&quot; / &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a><span class="delimiter">)</span>

            <a href="../nsc/Global.scala.html#537516" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <a href="#1213173" title="(x$1: Boolean)Unit">cpsAllowed</a> = <span title="Boolean(false)" class="keyword">false</span>
          <a href="#1213160" title="SelectiveANFTransform.this.ANFTransformer" class="keyword">super</a>.<a href="../nsc/transform/TypingTransformers.scala.html#984469" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213355" title="SelectiveANFTransform.this.global.Tree">tree</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>


    <span class="keyword">def</span> <a title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree" id="1213179">transExpr</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1213731">tree</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a>, <a title="SelectiveANFTransform.this.CPSInfo" id="1213732">cpsA</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a>, <a title="SelectiveANFTransform.this.CPSInfo" id="1213733">cpsR</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Boolean" id="1213430">isAnyParentImpure</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      <a href="#1213182" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)">transTailValue</a><span class="delimiter">(</span><a href="#1213731" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213732" title="SelectiveANFTransform.this.CPSInfo">cpsA</a>, <a href="#1213733" title="SelectiveANFTransform.this.CPSInfo">cpsR</a><span class="delimiter">)</span><a href="#3382049" title="SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213733" title="SelectiveANFTransform.this.CPSInfo">cpsR</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#1213430" title="Boolean">isAnyParentImpure</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span class="delimiter">(</span><a href="../../Tuple2.scala.html#60635" title="List[SelectiveANFTransform.this.global.Tree]" id="3382052">Nil</a>, <a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.global.Tree" id="1213772">b</a><span class="delimiter">)</span> =&gt; <a href="#3382054" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">b</a>
        <span class="keyword">case</span> <span class="delimiter">(</span><a href="../../Tuple2.scala.html#60635" title="List[SelectiveANFTransform.this.global.Tree]" id="1213775">a</a>, <a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.global.Tree" id="1213776">b</a><span class="delimiter">)</span> =&gt;
          <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405380" title="(tree: SelectiveANFTransform.this.global.Tree, stats: List[SelectiveANFTransform.this.global.Tree], expr: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Block">Block</a><a href="#3382054" title="(x: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree" class="delimiter">(</a><a href="#1213731" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213775" title="List[SelectiveANFTransform.this.global.Tree]">a</a>,<a href="#1213776" title="SelectiveANFTransform.this.global.Tree">b</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>


    <span class="keyword">def</span> <a title="(fun: SelectiveANFTransform.this.global.Tree, args: List[SelectiveANFTransform.this.global.Tree], cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[List[SelectiveANFTransform.this.global.Tree]], List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)" id="1213180">transArgList</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1213777">fun</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a>, <a title="List[SelectiveANFTransform.this.global.Tree]" id="1213778">args</a>: <a href="../../collection/immutable/List.scala.html#11952" title="List[SelectiveANFTransform.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="SelectiveANFTransform.this.CPSInfo" id="1213779">cpsA</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Boolean" id="1213780">isAnyParentImpure</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../Tuple3.scala.html#126" title="(List[List[SelectiveANFTransform.this.global.Tree]], List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a>List<span class="delimiter">[</span>List<span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">]</span>, List<span class="delimiter">[</span>Tree<span class="delimiter">]</span>, CPSInfo<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[SelectiveANFTransform.this.global.Type]" id="1213781">formals</a> = <a href="#1213777" title="SelectiveANFTransform.this.global.Tree">fun</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a>.<a href="../../reflect/internal/Types.scala.html#408431" title="=&gt; List[SelectiveANFTransform.this.global.Type]">paramTypes</a>
      <span class="keyword">val</span> <a title="Int" id="1213782">overshoot</a> = <a href="#1213778" title="List[SelectiveANFTransform.this.global.Tree]">args</a>.<a href="../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57161" title="(x: Int)Int">-</a> <a href="#1213781" title="List[SelectiveANFTransform.this.global.Type]">formals</a>.<a href="../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a>

      <span class="keyword">var</span> <a title="SelectiveANFTransform.this.CPSInfo" id="1213783">spc</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a> = <a href="#1213779" title="SelectiveANFTransform.this.CPSInfo">cpsA</a>

      <span class="keyword">val</span> <a href="#3382110" title="(x: (List[List[SelectiveANFTransform.this.global.Tree]], List[SelectiveANFTransform.this.global.Tree]))(List[List[SelectiveANFTransform.this.global.Tree]], List[SelectiveANFTransform.this.global.Tree])" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="List[List[SelectiveANFTransform.this.global.Tree]]" id="1213785">stm</a>,<a href="../../Tuple2.scala.html#60637" title="List[SelectiveANFTransform.this.global.Tree]" id="1213786">expr</a><span class="delimiter">)</span> = <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../../Tuple2.scala.html#60635" title="SelectiveANFTransform.this.global.Tree" id="1213892">a</a>,<a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.global.Type" id="1213893">tp</a><span class="delimiter">)</span> &lt;- <a href="#1213778" title="List[SelectiveANFTransform.this.global.Tree]">args</a>.<a href="../../collection/IterableLike.scala.html#58590" title="(that: scala.collection.GenIterable[SelectiveANFTransform.this.global.Type])(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.Tree],(SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.global.Type),List[(SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.global.Type)]])List[(SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.global.Type)]">zip</a><a href="../../collection/TraversableLike.scala.html#58063" title="(f: ((SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.global.Type)) =&gt; (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree))(implicit bf: scala.collection.generic.CanBuildFrom[List[(SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.global.Type)],(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree),List[(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)]])List[(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)]" class="delimiter">(</a><a href="#1213781" title="List[SelectiveANFTransform.this.global.Type]">formals</a> <a href="../../collection/immutable/List.scala.html#62688" title="(prefix: List[SelectiveANFTransform.this.global.Type])List[SelectiveANFTransform.this.global.Type]">:::</a> <a href="../../collection/immutable/List.scala.html#11953" title="scala.collection.immutable.List.type">List</a>.<a href="../../collection/generic/GenTraversableFactory.scala.html#59945" title="(n: Int)(elem: =&gt; SelectiveANFTransform.this.global.NoType.type)List[SelectiveANFTransform.this.global.NoType.type]">fill</a><span class="delimiter">(</span><a href="#1213782" title="Int">overshoot</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../../reflect/internal/Types.scala.html#407284" title="SelectiveANFTransform.this.global.NoType.type">NoType</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <a href="#3382104" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)">tp</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> TypeRef<a href="#3382068" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" id="3382073" class="delimiter">(</a><a href="../../reflect/internal/Types.scala.html#410887" title="SelectiveANFTransform.this.global.Type" id="3382069">_</a>, <a href="../../reflect/internal/Types.scala.html#410889" title="SelectiveANFTransform.this.global.Symbol" id="3382079">ByNameParamClass</a>, <a href="../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[SelectiveANFTransform.this.global.Type]]" id="3382086">List</a><a href="../../reflect/internal/Types.scala.html#410891" title="List[SelectiveANFTransform.this.global.Type]" id="3382071" class="delimiter">(</a><a title="SelectiveANFTransform.this.global.Type" id="1213905">elemtp</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            // note that we're not passing just isAnyParentImpure
            <a href="#3382082" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a><a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><span class="delimiter">(</span><a href="#1213892" title="SelectiveANFTransform.this.global.Tree">a</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213905" title="SelectiveANFTransform.this.global.Type">elemtp</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213905" title="SelectiveANFTransform.this.global.Type">elemtp</a><span class="delimiter">)</span>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#1213780" title="Boolean">isAnyParentImpure</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> _ =&gt;
            <span class="keyword">val</span> <a href="#3382064" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1213913">valStm</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1213914">valExpr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1213915">valSpc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1213780" title="Boolean" class="delimiter">(</a><a href="#1213892" title="SelectiveANFTransform.this.global.Tree">a</a>, <a href="#1213783" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>
            <a href="#1213783" title="SelectiveANFTransform.this.CPSInfo">spc</a> = <a href="#1213915" title="SelectiveANFTransform.this.CPSInfo">valSpc</a>
            <a href="../../Tuple2.scala.html#62849" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a><a href="#1213913" title="List[SelectiveANFTransform.this.global.Tree]">valStm</a>, <a href="#1213914" title="SelectiveANFTransform.this.global.Tree">valExpr</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>.<a href="../../collection/generic/GenericTraversableTemplate.scala.html#58476" title="(implicit asPair: ((List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)) =&gt; (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree))(List[List[SelectiveANFTransform.this.global.Tree]], List[SelectiveANFTransform.this.global.Tree])">unzip</a>

      <a href="../../Tuple3.scala.html#63169" title="(_1: List[List[SelectiveANFTransform.this.global.Tree]], _2: List[SelectiveANFTransform.this.global.Tree], _3: SelectiveANFTransform.this.CPSInfo)(List[List[SelectiveANFTransform.this.global.Tree]], List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1213785" title="List[List[SelectiveANFTransform.this.global.Tree]]">stm</a>,<a href="#1213786" title="List[SelectiveANFTransform.this.global.Tree]">expr</a>,<a href="#1213783" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>


    // precondition: cpsR.isDefined &quot;implies&quot; isAnyParentImpure
    <span class="keyword">def</span> <a title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="1213181">transValue</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1213996">tree</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a>, <a title="SelectiveANFTransform.this.CPSInfo" id="1213997">cpsA</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a>, <a title="SelectiveANFTransform.this.CPSInfo" id="1213998">cpsR</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Boolean" id="1213999">isAnyParentImpure</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../Tuple3.scala.html#126" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a>List<span class="delimiter">[</span>Tree<span class="delimiter">]</span>, Tree, CPSInfo<span class="delimiter">)</span> = <span class="delimiter">{</span>
      // return value: (stms, expr, spc), where spc is CPSInfo after stms but *before* expr
      <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Position" id="1214000">pos</a> = <a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>
      <a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Block<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382225" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410192" title="List[SelectiveANFTransform.this.global.Tree]" id="1214005">stms</a>, <a href="../../reflect/internal/Trees.scala.html#410194" title="SelectiveANFTransform.this.global.Tree" id="1214006">expr</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#3382116" title="(x: (SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo))(SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="SelectiveANFTransform.this.CPSInfo" id="1214008">cpsA2</a>, <a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.CPSInfo" id="1214009">cpsR2</a><span class="delimiter">)</span> = <a href="../../Tuple2.scala.html#62849" title="(_1: SelectiveANFTransform.this.CPSInfo, _2: SelectiveANFTransform.this.CPSInfo)(SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a>, <a href="CPSUtils.scala.html#1211388" title="(a: SelectiveANFTransform.this.CPSInfo, b: SelectiveANFTransform.this.CPSInfo)(implicit unit: SelectiveANFTransform.this.global.CompilationUnit, implicit pos: SelectiveANFTransform.this.global.Position)SelectiveANFTransform.this.CPSInfo">linearize</a><a href="#1213170" title="=&gt; SelectiveANFTransform.this.global.CompilationUnit" class="delimiter">(</a><a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a>, <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> // tbd
          //          val (cpsA2, cpsR2) = (None, getAnswerTypeAnn(tree.tpe))

          <span class="keyword">val</span> <a href="#3382122" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="List[SelectiveANFTransform.this.global.Tree]" id="1214011">a</a>, <a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.global.Tree" id="1214012">b</a><span class="delimiter">)</span> = <a href="#1213185" title="(stms: List[SelectiveANFTransform.this.global.Tree], expr: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)">transBlock</a><span class="delimiter">(</span><a href="#1214005" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="#1214006" title="SelectiveANFTransform.this.global.Tree">expr</a>, <a href="#1214008" title="SelectiveANFTransform.this.CPSInfo">cpsA2</a>, <a href="#1214009" title="SelectiveANFTransform.this.CPSInfo">cpsR2</a><span class="delimiter">)</span><a href="../../Tuple2.scala.html#783" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree) @unchecked" class="delimiter">(</a><a href="#1214009" title="SelectiveANFTransform.this.CPSInfo">cpsR2</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#1213999" title="Boolean">isAnyParentImpure</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Block" id="1214013">tree1</a>  = <span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405380" title="(tree: SelectiveANFTransform.this.global.Tree, stats: List[SelectiveANFTransform.this.global.Tree], expr: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Block">Block</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214011" title="List[SelectiveANFTransform.this.global.Tree]">a</a>, <a href="#1214012" title="SelectiveANFTransform.this.global.Tree">b</a><span class="delimiter">)</span><span class="delimiter">)</span> // no updateSynthFlag here!!!

          <a href="../../Tuple3.scala.html#63169" title="(_1: scala.collection.immutable.Nil.type, _2: SelectiveANFTransform.this.global.Block, _3: SelectiveANFTransform.this.CPSInfo)(scala.collection.immutable.Nil.type, SelectiveANFTransform.this.global.Block, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="#1214013" title="SelectiveANFTransform.this.global.Block">tree1</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>

        <span class="keyword">case</span> If<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382227" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410107" title="SelectiveANFTransform.this.global.Tree" id="1214068">cond</a>, <a href="../../reflect/internal/Trees.scala.html#410109" title="SelectiveANFTransform.this.global.Tree" id="1214069">thenp</a>, <a href="../../reflect/internal/Trees.scala.html#410111" title="SelectiveANFTransform.this.global.Tree" id="1214070">elsep</a><span class="delimiter">)</span> =&gt;
          /* possible situations:
          cps before (cpsA)
          cps in condition (spc)  &lt;-- synth flag set if *only* here!
          cps in (one or both) branches */
          <span class="keyword">val</span> <a href="#3382128" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1214072">condStats</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1214073">condVal</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214074">spc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214068" title="SelectiveANFTransform.this.global.Tree">cond</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a href="#3382134" title="(x: (SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo))(SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="SelectiveANFTransform.this.CPSInfo" id="1214076">cpsA2</a>, <a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.CPSInfo" id="1214077">cpsR2</a><span class="delimiter">)</span> = <a href="#3382132" title="(SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo)" class="keyword">if</a> <span class="delimiter">(</span><a href="CPSUtils.scala.html#1211375" title="(tpe: SelectiveANFTransform.this.global.Type)Boolean">hasSynthMarker</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="../../Tuple2.scala.html#62849" title="(_1: SelectiveANFTransform.this.CPSInfo, _2: SelectiveANFTransform.this.CPSInfo)(SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214074" title="SelectiveANFTransform.this.CPSInfo">spc</a>, <a href="CPSUtils.scala.html#1211388" title="(a: SelectiveANFTransform.this.CPSInfo, b: SelectiveANFTransform.this.CPSInfo)(implicit unit: SelectiveANFTransform.this.global.CompilationUnit, implicit pos: SelectiveANFTransform.this.global.Position)SelectiveANFTransform.this.CPSInfo">linearize</a><a href="#1213170" title="=&gt; SelectiveANFTransform.this.global.CompilationUnit" class="delimiter">(</a><a href="#1214074" title="SelectiveANFTransform.this.CPSInfo">spc</a>, <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">else</span>
            <a href="../../Tuple2.scala.html#62849" title="(_1: None.type, _2: Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)])(None.type, Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)])" class="delimiter">(</a><a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span> // if no cps in condition, branches must conform to tree.tpe directly
          <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1214078">thenVal</a> = <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><span class="delimiter">(</span><a href="#1214069" title="SelectiveANFTransform.this.global.Tree">thenp</a>, <a href="#1214076" title="SelectiveANFTransform.this.CPSInfo">cpsA2</a>, <a href="#1214077" title="SelectiveANFTransform.this.CPSInfo">cpsR2</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#1214077" title="SelectiveANFTransform.this.CPSInfo">cpsR2</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#1213999" title="Boolean">isAnyParentImpure</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1214079">elseVal</a> = <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><span class="delimiter">(</span><a href="#1214070" title="SelectiveANFTransform.this.global.Tree">elsep</a>, <a href="#1214076" title="SelectiveANFTransform.this.CPSInfo">cpsA2</a>, <a href="#1214077" title="SelectiveANFTransform.this.CPSInfo">cpsR2</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#1214077" title="SelectiveANFTransform.this.CPSInfo">cpsR2</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#1213999" title="Boolean">isAnyParentImpure</a><span class="delimiter">)</span>

          // check that then and else parts agree (not necessary any more, but left as sanity check)
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1213998" title="SelectiveANFTransform.this.CPSInfo">cpsR</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1214070" title="SelectiveANFTransform.this.global.Tree">elsep</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../reflect/internal/Trees.scala.html#407946" title="SelectiveANFTransform.this.global.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span>
              <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539298" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;always need else part in cps code&quot;)" class="string">&quot;always need else part in cps code&quot;</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="CPSUtils.scala.html#1211385" title="(tp: SelectiveANFTransform.this.global.Type)Boolean">hasAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1214078" title="SelectiveANFTransform.this.global.Tree">thenVal</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#57824" title="(x: Boolean)Boolean">!=</a> <a href="CPSUtils.scala.html#1211385" title="(tp: SelectiveANFTransform.this.global.Type)Boolean">hasAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1214079" title="SelectiveANFTransform.this.global.Tree">elseVal</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539298" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;then and else parts must both be cps code or neither of them&quot;)" class="string">&quot;then and else parts must both be cps code or neither of them&quot;</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214072" title="List[SelectiveANFTransform.this.global.Tree]">condStats</a>, <a href="CPSUtils.scala.html#1211386" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">updateSynthFlag</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405389" title="(tree: SelectiveANFTransform.this.global.Tree, cond: SelectiveANFTransform.this.global.Tree, thenp: SelectiveANFTransform.this.global.Tree, elsep: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.If">If</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214073" title="SelectiveANFTransform.this.global.Tree">condVal</a>, <a href="#1214078" title="SelectiveANFTransform.this.global.Tree">thenVal</a>, <a href="#1214079" title="SelectiveANFTransform.this.global.Tree">elseVal</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1214074" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Match<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382229" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410097" title="SelectiveANFTransform.this.global.Tree" id="1214149">selector</a>, <a href="../../reflect/internal/Trees.scala.html#410099" title="List[SelectiveANFTransform.this.global.CaseDef]" id="1214150">cases</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#3382140" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1214152">selStats</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1214153">selVal</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214154">spc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214149" title="SelectiveANFTransform.this.global.Tree">selector</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a href="#3382146" title="(x: (SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo))(SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="SelectiveANFTransform.this.CPSInfo" id="1214156">cpsA2</a>, <a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.CPSInfo" id="1214157">cpsR2</a><span class="delimiter">)</span> =
            <a href="#3382144" title="(SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo)" class="keyword">if</a> <span class="delimiter">(</span><a href="CPSUtils.scala.html#1211375" title="(tpe: SelectiveANFTransform.this.global.Type)Boolean">hasSynthMarker</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Tuple2.scala.html#62849" title="(_1: SelectiveANFTransform.this.CPSInfo, _2: SelectiveANFTransform.this.CPSInfo)(SelectiveANFTransform.this.CPSInfo, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214154" title="SelectiveANFTransform.this.CPSInfo">spc</a>, <a href="CPSUtils.scala.html#1211388" title="(a: SelectiveANFTransform.this.CPSInfo, b: SelectiveANFTransform.this.CPSInfo)(implicit unit: SelectiveANFTransform.this.global.CompilationUnit, implicit pos: SelectiveANFTransform.this.global.Position)SelectiveANFTransform.this.CPSInfo">linearize</a><a href="#1213170" title="=&gt; SelectiveANFTransform.this.global.CompilationUnit" class="delimiter">(</a><a href="#1214154" title="SelectiveANFTransform.this.CPSInfo">spc</a>, <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">else</span> <a href="../../Tuple2.scala.html#62849" title="(_1: None.type, _2: Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)])(None.type, Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)])" class="delimiter">(</a><a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">val</span> <a title="List[SelectiveANFTransform.this.global.CaseDef]" id="1214158">caseVals</a> = <a href="#1214150" title="List[SelectiveANFTransform.this.global.CaseDef]">cases</a> <a href="../../collection/TraversableLike.scala.html#58063" title="(f: SelectiveANFTransform.this.global.CaseDef =&gt; SelectiveANFTransform.this.global.CaseDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.CaseDef],SelectiveANFTransform.this.global.CaseDef,List[SelectiveANFTransform.this.global.CaseDef]])List[SelectiveANFTransform.this.global.CaseDef]">map</a> <a href="#1214218" title="SelectiveANFTransform.this.global.CaseDef" class="delimiter">{</a> <span class="keyword">case</span> cd @ CaseDef<span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#410180" title="SelectiveANFTransform.this.global.Tree" id="1214225">pat</a>, <a href="../../reflect/internal/Trees.scala.html#410182" title="SelectiveANFTransform.this.global.Tree" id="1214226">guard</a>, <a href="../../reflect/internal/Trees.scala.html#410184" title="SelectiveANFTransform.this.global.Tree" id="1214227">body</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1214228">bodyVal</a> = <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><span class="delimiter">(</span><a href="#1214227" title="SelectiveANFTransform.this.global.Tree">body</a>, <a href="#1214156" title="SelectiveANFTransform.this.CPSInfo">cpsA2</a>, <a href="#1214157" title="SelectiveANFTransform.this.CPSInfo">cpsR2</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#1214157" title="SelectiveANFTransform.this.CPSInfo">cpsR2</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#1213999" title="Boolean">isAnyParentImpure</a><span class="delimiter">)</span>
            <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405381" title="(tree: SelectiveANFTransform.this.global.Tree, pat: SelectiveANFTransform.this.global.Tree, guard: SelectiveANFTransform.this.global.Tree, body: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.CaseDef">CaseDef</a><span class="delimiter">(</span>cd, <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1214225" title="SelectiveANFTransform.this.global.Tree">pat</a><span class="delimiter">)</span>, <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1214226" title="SelectiveANFTransform.this.global.Tree">guard</a><span class="delimiter">)</span>, <a href="#1214228" title="SelectiveANFTransform.this.global.Tree">bodyVal</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214152" title="List[SelectiveANFTransform.this.global.Tree]">selStats</a>, <a href="CPSUtils.scala.html#1211386" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">updateSynthFlag</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405390" title="(tree: SelectiveANFTransform.this.global.Tree, selector: SelectiveANFTransform.this.global.Tree, cases: List[SelectiveANFTransform.this.global.CaseDef])SelectiveANFTransform.this.global.Match">Match</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214153" title="SelectiveANFTransform.this.global.Tree">selVal</a>, <a href="#1214158" title="List[SelectiveANFTransform.this.global.CaseDef]">caseVals</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1214154" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>

        // this is utterly broken: LabelDefs need to be considered together when transforming them to DefDefs:
        // suppose a Block {L1; ... ; LN}
        // this should become {D1def ; ... ; DNdef ; D1()}
        // where D$idef = def L$i(..) = {L$i.body; L${i+1}(..)}

        <span class="keyword">case</span> ldef @ LabelDef<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382231" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410239" title="SelectiveANFTransform.this.global.TermName" id="1214280">name</a>, <a href="../../reflect/internal/Trees.scala.html#410241" title="List[SelectiveANFTransform.this.global.Ident]" id="1214281">params</a>, <a href="../../reflect/internal/Trees.scala.html#410243" title="SelectiveANFTransform.this.global.Tree" id="1214282">rhs</a><span class="delimiter">)</span> =&gt;
          // println(&quot;trans LABELDEF &quot;+(name, params, tree.tpe, hasAnswerTypeAnn(tree.tpe)))
          // TODO why does the labeldef's type have a cpsMinus annotation, whereas the rhs does not? (BYVALmode missing/too much somewhere?)
          <a href="#3382249" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="keyword">if</a> <span class="delimiter">(</span><a href="CPSUtils.scala.html#1211385" title="(tp: SelectiveANFTransform.this.global.Type)Boolean">hasAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            // currentOwner.newMethod(name, tree.pos, Flags.SYNTHETIC) setInfo ldef.symbol.info
            <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Symbol" id="1214283">sym</a>    = ldef.<a href="../../reflect/internal/Trees.scala.html#409939" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a> <a href="../../reflect/internal/Symbols.scala.html#411237" title="(mask: Long)SelectiveANFTransform.this.global.Symbol">resetFlag</a> Flags.<span title="Long(131072L)">LABEL</span>
            <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1214284">rhs1</a>   = <a href="#1214282" title="SelectiveANFTransform.this.global.Tree">rhs</a> //new TreeSymSubstituter(List(ldef.symbol), List(sym)).transform(rhs)
            <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1214285">rhsVal</a> = <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><span class="delimiter">(</span><a href="#1214284" title="SelectiveANFTransform.this.global.Tree">rhs1</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#1213999" title="Boolean">isAnyParentImpure</a><span class="delimiter">)</span> <a href="../../reflect/internal/Trees.scala.html#408563" title="(pairs: (SelectiveANFTransform.this.global.Symbol, SelectiveANFTransform.this.global.Symbol)*)SelectiveANFTransform.this.global.Tree">changeOwner</a> <span class="delimiter">(</span><a href="../../Predef.scala.html#7509" title="(x: SelectiveANFTransform.this.global.Symbol)ArrowAssoc[SelectiveANFTransform.this.global.Symbol]">currentOwner</a> <a href="../../Predef.scala.html#62634" title="(y: SelectiveANFTransform.this.global.Symbol)(SelectiveANFTransform.this.global.Symbol, SelectiveANFTransform.this.global.Symbol)">-&gt;</a> <a href="#1214283" title="SelectiveANFTransform.this.global.Symbol">sym</a><span class="delimiter">)</span>

            <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.analyzer.global.Tree" id="1214286">stm1</a> = <a href="../nsc/transform/TypingTransformers.scala.html#984456" title="=&gt; SelectiveANFTransform.this.global.analyzer.Typer">localTyper</a>.<a href="../nsc/typechecker/Typers.scala.html#538701" title="(tree: SelectiveANFTransform.this.global.analyzer.global.Tree)SelectiveANFTransform.this.global.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#408109" title="(sym: SelectiveANFTransform.this.global.Symbol, rhs: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.DefDef">DefDef</a><span class="delimiter">(</span><a href="#1214283" title="SelectiveANFTransform.this.global.Symbol">sym</a>, <a href="#1214285" title="SelectiveANFTransform.this.global.Tree">rhsVal</a><span class="delimiter">)</span><span class="delimiter">)</span>
            // since virtpatmat does not rely on fall-through, don't call the labels it emits
            // transBlock will take care of calling the first label
            // calling each labeldef is wrong, since some labels may be jumped over
            // we can get away with this for now since the only other labels we emit are for tailcalls/while loops,
            // which do not have consecutive labeldefs (and thus fall-through is irrelevant)
            <span title="(List[SelectiveANFTransform.this.global.analyzer.global.Tree], SelectiveANFTransform.this.global.analyzer.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="keyword">if</span> <span class="delimiter">(</span><a href="../nsc/ast/Trees.scala.html#537807" title="SelectiveANFTransform.this.global.treeInfo.type">treeInfo</a>.<a href="../../reflect/internal/TreeInfo.scala.html#479246" title="(t: SelectiveANFTransform.this.global.treeInfo.global.Tree)Boolean">hasSynthCaseSymbol</a><span class="delimiter">(</span>ldef<span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.analyzer.global.Tree], _2: SelectiveANFTransform.this.global.analyzer.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.analyzer.global.Tree], SelectiveANFTransform.this.global.analyzer.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.analyzer.global.Tree*)List[SelectiveANFTransform.this.global.analyzer.global.Tree]">List</a><span class="delimiter">(</span><a href="#1214286" title="SelectiveANFTransform.this.global.analyzer.global.Tree">stm1</a><span class="delimiter">)</span>, <a href="../nsc/transform/TypingTransformers.scala.html#984456" title="=&gt; SelectiveANFTransform.this.global.analyzer.Typer">localTyper</a>.<a href="../nsc/typechecker/Typers.scala.html#538701" title="(tree: SelectiveANFTransform.this.global.analyzer.global.Tree)SelectiveANFTransform.this.global.analyzer.global.Tree">typed</a><span class="delimiter">{</span><a href="../../reflect/internal/Trees.scala.html#413609" title="(value: SelectiveANFTransform.this.global.Constant)SelectiveANFTransform.this.global.Literal">Literal</a><span class="delimiter">(</span><a href="../../reflect/internal/Constants.scala.html#415091" title="(value: Any)SelectiveANFTransform.this.global.Constant">Constant</a><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">}</span>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
            <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="../nsc/Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#1214281" title="List[SelectiveANFTransform.this.global.Ident]">params</a>.<a href="../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a>, <span title="String(&quot;problem in ANF transforming label with non-empty params &quot;)" class="string">&quot;problem in ANF transforming label with non-empty params &quot;</span><span title="(x$1: Any)String">+</span> ldef<span class="delimiter">)</span>
              <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.analyzer.global.Tree], _2: SelectiveANFTransform.this.global.analyzer.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.analyzer.global.Tree], SelectiveANFTransform.this.global.analyzer.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.analyzer.global.Tree*)List[SelectiveANFTransform.this.global.analyzer.global.Tree]">List</a><span class="delimiter">(</span><a href="#1214286" title="SelectiveANFTransform.this.global.analyzer.global.Tree">stm1</a><span class="delimiter">)</span>, <a href="../nsc/transform/TypingTransformers.scala.html#984456" title="=&gt; SelectiveANFTransform.this.global.analyzer.Typer">localTyper</a>.<a href="../nsc/typechecker/Typers.scala.html#538701" title="(tree: SelectiveANFTransform.this.global.analyzer.global.Tree)SelectiveANFTransform.this.global.analyzer.global.Tree">typed</a><span class="delimiter">{</span><a href="../../reflect/internal/Trees.scala.html#413581" title="(fun: SelectiveANFTransform.this.global.Tree, args: List[SelectiveANFTransform.this.global.Tree])SelectiveANFTransform.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#408127" title="(sym: SelectiveANFTransform.this.global.Symbol)SelectiveANFTransform.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#1214283" title="SelectiveANFTransform.this.global.Symbol">sym</a><span class="delimiter">)</span>, List<a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type" class="delimiter">(</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">}</span>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1214420">rhsVal</a> = <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214282" title="SelectiveANFTransform.this.global.Tree">rhs</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a><span class="delimiter">)</span>
            <a href="../../Tuple3.scala.html#63169" title="(_1: scala.collection.immutable.Nil.type, _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(scala.collection.immutable.Nil.type, SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="CPSUtils.scala.html#1211386" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">updateSynthFlag</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405377" title="(tree: SelectiveANFTransform.this.global.Tree, name: SelectiveANFTransform.this.global.Name, params: List[SelectiveANFTransform.this.global.Ident], rhs: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.LabelDef">LabelDef</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214280" title="SelectiveANFTransform.this.global.TermName">name</a>, <a href="#1214281" title="List[SelectiveANFTransform.this.global.Ident]">params</a>, <a href="#1214420" title="SelectiveANFTransform.this.global.Tree">rhsVal</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>


        <span class="keyword">case</span> Try<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382233" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410079" title="SelectiveANFTransform.this.global.Tree" id="1214439">block</a>, <a href="../../reflect/internal/Trees.scala.html#410081" title="List[SelectiveANFTransform.this.global.CaseDef]" id="1214440">catches</a>, <a href="../../reflect/internal/Trees.scala.html#410083" title="SelectiveANFTransform.this.global.Tree" id="1214441">finalizer</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1214442">blockVal</a> = <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214439" title="SelectiveANFTransform.this.global.Tree">block</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a>, <a href="#1213998" title="SelectiveANFTransform.this.CPSInfo">cpsR</a><span class="delimiter">)</span>

          <span class="keyword">val</span> <a title="List[SelectiveANFTransform.this.global.CaseDef]" id="1214443">catchVals</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
            <a href="../../Tuple2.scala.html#62849" title="(_1: SelectiveANFTransform.this.global.CaseDef, _2: SelectiveANFTransform.this.global.Tree)(SelectiveANFTransform.this.global.CaseDef, SelectiveANFTransform.this.global.Tree)" id="1214537">cd</a> @ CaseDef<span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#410180" title="SelectiveANFTransform.this.global.Tree" id="1214543">pat</a>, <a href="../../reflect/internal/Trees.scala.html#410182" title="SelectiveANFTransform.this.global.Tree" id="1214544">guard</a>, <a href="../../reflect/internal/Trees.scala.html#410184" title="SelectiveANFTransform.this.global.Tree" id="1214545">body</a><span class="delimiter">)</span> &lt;- <a href="../../collection/generic/FilterMonadic.scala.html#58161" title="(f: SelectiveANFTransform.this.global.CaseDef =&gt; (SelectiveANFTransform.this.global.CaseDef, SelectiveANFTransform.this.global.Tree))(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.CaseDef],(SelectiveANFTransform.this.global.CaseDef, SelectiveANFTransform.this.global.Tree),List[(SelectiveANFTransform.this.global.CaseDef, SelectiveANFTransform.this.global.Tree)]])List[(SelectiveANFTransform.this.global.CaseDef, SelectiveANFTransform.this.global.Tree)]">catches</a>
            <a href="#3382165" title="(x: (SelectiveANFTransform.this.global.CaseDef, SelectiveANFTransform.this.global.Tree))(SelectiveANFTransform.this.global.CaseDef, SelectiveANFTransform.this.global.Tree)" id="1214546">bodyVal</a> = <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214545" title="SelectiveANFTransform.this.global.Tree">body</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a>, <a href="#1213998" title="SelectiveANFTransform.this.CPSInfo">cpsR</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
            <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405381" title="(tree: SelectiveANFTransform.this.global.Tree, pat: SelectiveANFTransform.this.global.Tree, guard: SelectiveANFTransform.this.global.Tree, body: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.CaseDef">CaseDef</a><a href="#3382171" title="(x: SelectiveANFTransform.this.global.CaseDef)SelectiveANFTransform.this.global.CaseDef" class="delimiter">(</a><a href="#1214537" title="SelectiveANFTransform.this.global.CaseDef">cd</a>, <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1214543" title="SelectiveANFTransform.this.global.Tree">pat</a><span class="delimiter">)</span>, <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1214544" title="SelectiveANFTransform.this.global.Tree">guard</a><span class="delimiter">)</span>, <a href="#1214546" title="SelectiveANFTransform.this.global.Tree">bodyVal</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1214444">finallyVal</a> = <a href="#1213179" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)SelectiveANFTransform.this.global.Tree">transExpr</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214441" title="SelectiveANFTransform.this.global.Tree">finalizer</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a><span class="delimiter">)</span> // for now, no cps in finally

          <a href="../../Tuple3.scala.html#63169" title="(_1: scala.collection.immutable.Nil.type, _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(scala.collection.immutable.Nil.type, SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="CPSUtils.scala.html#1211386" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">updateSynthFlag</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405392" title="(tree: SelectiveANFTransform.this.global.Tree, block: SelectiveANFTransform.this.global.Tree, catches: List[SelectiveANFTransform.this.global.CaseDef], finalizer: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Try">Try</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214442" title="SelectiveANFTransform.this.global.Tree">blockVal</a>, <a href="#1214443" title="List[SelectiveANFTransform.this.global.CaseDef]">catchVals</a>, <a href="#1214444" title="SelectiveANFTransform.this.global.Tree">finallyVal</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Assign<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382235" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410127" title="SelectiveANFTransform.this.global.Tree" id="1214591">lhs</a>, <a href="../../reflect/internal/Trees.scala.html#410129" title="SelectiveANFTransform.this.global.Tree" id="1214592">rhs</a><span class="delimiter">)</span> =&gt;
          // allow cps code in rhs only
          <span class="keyword">val</span> <a href="#3382177" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1214594">stms</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1214595">expr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214596">spc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214592" title="SelectiveANFTransform.this.global.Tree">rhs</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214594" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="CPSUtils.scala.html#1211386" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">updateSynthFlag</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405387" title="(tree: SelectiveANFTransform.this.global.Tree, lhs: SelectiveANFTransform.this.global.Tree, rhs: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Assign">Assign</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1214591" title="SelectiveANFTransform.this.global.Tree">lhs</a><span class="delimiter">)</span>, <a href="#1214595" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1214596" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Return<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382237" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410090" title="SelectiveANFTransform.this.global.Tree" id="1214626">expr0</a><span class="delimiter">)</span> =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1213999" title="Boolean">isAnyParentImpure</a><span class="delimiter">)</span>
            <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539298" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;return expression not allowed, since method calls CPS method&quot;)" class="string">&quot;return expression not allowed, since method calls CPS method&quot;</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a href="#3382183" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1214628">stms</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1214629">expr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214630">spc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214626" title="SelectiveANFTransform.this.global.Tree">expr0</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214628" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="CPSUtils.scala.html#1211386" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">updateSynthFlag</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405391" title="(tree: SelectiveANFTransform.this.global.Tree, expr: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Return">Return</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214629" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1214630" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Throw<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382239" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410070" title="SelectiveANFTransform.this.global.Tree" id="1214665">expr0</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#3382189" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1214667">stms</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1214668">expr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214669">spc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214665" title="SelectiveANFTransform.this.global.Tree">expr0</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214667" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="CPSUtils.scala.html#1211386" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">updateSynthFlag</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405393" title="(tree: SelectiveANFTransform.this.global.Tree, expr: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Throw">Throw</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214668" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1214669" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Typed<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382241" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410055" title="SelectiveANFTransform.this.global.Tree" id="1214699">expr0</a>, <a href="../../reflect/internal/Trees.scala.html#410057" title="SelectiveANFTransform.this.global.Tree" id="1214700">tpt</a><span class="delimiter">)</span> =&gt;
          // TODO: should x: A @cps[B,C] have a special meaning?
          // type casts used in different ways (see match2.scala, #3199)
          <span class="keyword">val</span> <a href="#3382195" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1214702">stms</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1214703">expr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214704">spc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214699" title="SelectiveANFTransform.this.global.Tree">expr0</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Tree" id="1214705">tpt1</a> = <span title="SelectiveANFTransform.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="../nsc/ast/Trees.scala.html#537807" title="SelectiveANFTransform.this.global.treeInfo.type">treeInfo</a>.<a href="../../reflect/internal/TreeInfo.scala.html#479228" title="(tree: SelectiveANFTransform.this.global.treeInfo.global.Tree)Boolean">isWildcardStarArg</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#1214700" title="SelectiveANFTransform.this.global.Tree">tpt</a> <span class="keyword">else</span>
            <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405404" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="#1214700" title="SelectiveANFTransform.this.global.Tree">tpt</a><span class="delimiter">)</span>.<a href="../../reflect/internal/Trees.scala.html#408575" title="(tp: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.TypeTree">setType</a><span class="delimiter">(</span><a href="CPSUtils.scala.html#1211380" title="(tpe: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.Type">removeAllCPSAnnotations</a><span class="delimiter">(</span><a href="#1214700" title="SelectiveANFTransform.this.global.Tree">tpt</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
//        (stms, updateSynthFlag(treeCopy.Typed(tree, expr, tpt1)), spc)
          <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Typed, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Typed, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214702" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405395" title="(tree: SelectiveANFTransform.this.global.Tree, expr: SelectiveANFTransform.this.global.Tree, tpt: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Typed">Typed</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214703" title="SelectiveANFTransform.this.global.Tree">expr</a>, <a href="#1214705" title="SelectiveANFTransform.this.global.Tree">tpt1</a><span class="delimiter">)</span>.<a href="../../reflect/internal/Trees.scala.html#408575" title="(tp: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.Typed">setType</a><span class="delimiter">(</span><a href="CPSUtils.scala.html#1211380" title="(tpe: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.Type">removeAllCPSAnnotations</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1214704" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>

        <span class="keyword">case</span> TypeApply<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382243" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410043" title="SelectiveANFTransform.this.global.Tree" id="1214751">fun</a>, <a href="../../reflect/internal/Trees.scala.html#410045" title="List[SelectiveANFTransform.this.global.Tree]" id="1214752">args</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#3382201" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1214754">stms</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1214755">expr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214756">spc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214751" title="SelectiveANFTransform.this.global.Tree">fun</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214754" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="CPSUtils.scala.html#1211386" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">updateSynthFlag</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405396" title="(tree: SelectiveANFTransform.this.global.Tree, fun: SelectiveANFTransform.this.global.Tree, args: List[SelectiveANFTransform.this.global.Tree])SelectiveANFTransform.this.global.TypeApply">TypeApply</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214755" title="SelectiveANFTransform.this.global.Tree">expr</a>, <a href="#1214752" title="List[SelectiveANFTransform.this.global.Tree]">args</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1214756" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Select<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382245" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#409999" title="SelectiveANFTransform.this.global.Tree" id="1214797">qual</a>, <a href="../../reflect/internal/Trees.scala.html#410001" title="SelectiveANFTransform.this.global.Name" id="1214798">name</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#3382207" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1214800">stms</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1214801">expr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214802">spc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214797" title="SelectiveANFTransform.this.global.Tree">qual</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214800" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="CPSUtils.scala.html#1211386" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">updateSynthFlag</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405400" title="(tree: SelectiveANFTransform.this.global.Tree, qualifier: SelectiveANFTransform.this.global.Tree, selector: SelectiveANFTransform.this.global.Name)SelectiveANFTransform.this.global.Select">Select</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214801" title="SelectiveANFTransform.this.global.Tree">expr</a>, <a href="#1214798" title="SelectiveANFTransform.this.global.Name">name</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1214802" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Apply<a href="#3382223" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382247" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410031" title="SelectiveANFTransform.this.global.Tree" id="1214835">fun</a>, <a href="../../reflect/internal/Trees.scala.html#410033" title="List[SelectiveANFTransform.this.global.Tree]" id="1214836">args</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#3382213" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1214838">funStm</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1214839">funExpr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214840">funSpc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214835" title="SelectiveANFTransform.this.global.Tree">fun</a>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a href="#3382219" title="(x: (List[List[SelectiveANFTransform.this.global.Tree]], List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo))(List[List[SelectiveANFTransform.this.global.Tree]], List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[List[SelectiveANFTransform.this.global.Tree]]" id="1214842">argStm</a>, <a href="../../Tuple3.scala.html#60578" title="List[SelectiveANFTransform.this.global.Tree]" id="1214843">argExpr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214844">argSpc</a><span class="delimiter">)</span> = <a href="#1213180" title="(fun: SelectiveANFTransform.this.global.Tree, args: List[SelectiveANFTransform.this.global.Tree], cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[List[SelectiveANFTransform.this.global.Tree]], List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)">transArgList</a><a href="#1213999" title="Boolean" class="delimiter">(</a><a href="#1214835" title="SelectiveANFTransform.this.global.Tree">fun</a>, <a href="#1214836" title="List[SelectiveANFTransform.this.global.Tree]">args</a>, <a href="#1214840" title="SelectiveANFTransform.this.CPSInfo">funSpc</a><span class="delimiter">)</span>

          <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1214838" title="List[SelectiveANFTransform.this.global.Tree]">funStm</a> <a href="../../collection/immutable/List.scala.html#62688" title="(prefix: List[SelectiveANFTransform.this.global.Tree])List[SelectiveANFTransform.this.global.Tree]">:::</a> <span class="delimiter">(</span><a href="#1214842" title="List[List[SelectiveANFTransform.this.global.Tree]]">argStm</a>.<a href="../../collection/generic/GenericTraversableTemplate.scala.html#58488" title="(implicit asTraversable: List[SelectiveANFTransform.this.global.Tree] =&gt; scala.collection.GenTraversableOnce[SelectiveANFTransform.this.global.Tree])List[SelectiveANFTransform.this.global.Tree]">flatten</a><span class="delimiter">)</span>, <a href="CPSUtils.scala.html#1211386" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">updateSynthFlag</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405397" title="(tree: SelectiveANFTransform.this.global.Tree, fun: SelectiveANFTransform.this.global.Tree, args: List[SelectiveANFTransform.this.global.Tree])SelectiveANFTransform.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1214839" title="SelectiveANFTransform.this.global.Tree">funExpr</a>, <a href="#1214843" title="List[SelectiveANFTransform.this.global.Tree]">argExpr</a><span class="delimiter">)</span><span class="delimiter">)</span>,
            <a href="#1214844" title="SelectiveANFTransform.this.CPSInfo">argSpc</a><span class="delimiter">)</span>

        <span class="keyword">case</span> _ =&gt;
          <a href="#1213173" title="(x$1: Boolean)Unit">cpsAllowed</a> = <span title="Boolean(true)" class="keyword">true</span>
          <a href="../../Tuple3.scala.html#63169" title="(_1: scala.collection.immutable.Nil.type, _2: SelectiveANFTransform.this.global.Tree, _3: SelectiveANFTransform.this.CPSInfo)(scala.collection.immutable.Nil.type, SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="#1213178" title="(tree: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1213996" title="SelectiveANFTransform.this.global.Tree">tree</a><span class="delimiter">)</span>, <a href="#1213997" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    // precondition: cpsR.isDefined &quot;implies&quot; isAnyParentImpure
    <span class="keyword">def</span> <a title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" id="1213182">transTailValue</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1213766">tree</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a>, <a title="SelectiveANFTransform.this.CPSInfo" id="1213767">cpsA</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a>, <a title="SelectiveANFTransform.this.CPSInfo" id="1213768">cpsR</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Boolean" id="1213769">isAnyParentImpure</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../Tuple2.scala.html#783" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a>List<span class="delimiter">[</span>Tree<span class="delimiter">]</span>, Tree<span class="delimiter">)</span> = <span class="delimiter">{</span>

      <span class="keyword">val</span> <a href="#3382267" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1214915">stms</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1214916">expr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1214917">spc</a><span class="delimiter">)</span> = <a href="#1213181" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transValue</a><a href="#1213769" title="Boolean" class="delimiter">(</a><a href="#1213766" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213767" title="SelectiveANFTransform.this.CPSInfo">cpsA</a>, <a href="#1213768" title="SelectiveANFTransform.this.CPSInfo">cpsR</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="SelectiveANFTransform.this.CPSInfo" id="1214918">bot</a> = <a href="CPSUtils.scala.html#1211388" title="(a: SelectiveANFTransform.this.CPSInfo, b: SelectiveANFTransform.this.CPSInfo)(implicit unit: SelectiveANFTransform.this.global.CompilationUnit, implicit pos: SelectiveANFTransform.this.global.Position)SelectiveANFTransform.this.CPSInfo">linearize</a><span class="delimiter">(</span><a href="#1214917" title="SelectiveANFTransform.this.CPSInfo">spc</a>, <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>, <a href="#1213766" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Type" id="1214919">plainTpe</a> = <a href="CPSUtils.scala.html#1211380" title="(tpe: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.Type">removeAllCPSAnnotations</a><span class="delimiter">(</span><a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>

      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#1213768" title="SelectiveANFTransform.this.CPSInfo">cpsR</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1214918" title="SelectiveANFTransform.this.CPSInfo">bot</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408582" title="=&gt; Boolean">isEmpty</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a>.<a href="../../reflect/internal/Types.scala.html#408407" title="=&gt; SelectiveANFTransform.this.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">ne</span> <a href="../../reflect/internal/Definitions.scala.html#408692" title="SelectiveANFTransform.this.global.definitions.NothingClass.type">NothingClass</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          // must convert!
          <a href="../nsc/Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;cps type conversion (has: &quot;)" class="string">&quot;cps type conversion (has: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1213767" title="SelectiveANFTransform.this.CPSInfo">cpsA</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1214917" title="SelectiveANFTransform.this.CPSInfo">spc</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a>  <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
          <a href="../nsc/Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;cps type conversion (expected: &quot;)" class="string">&quot;cps type conversion (expected: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1213768" title="SelectiveANFTransform.this.CPSInfo">cpsR</a>.<a href="../../Option.scala.html#62858" title="=&gt; (SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)">get</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;): &quot;)" class="string">&quot;): &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span>

          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#1211374" title="(tpe: SelectiveANFTransform.this.global.Type)Boolean">hasPlusMarker</a><span class="delimiter">(</span><a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539299" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">warning</a><span class="delimiter">(</span><a href="#1213766" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;expression &quot;)" class="string">&quot;expression &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1213766" title="SelectiveANFTransform.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; is cps-transformed unexpectedly&quot;)" class="string">&quot; is cps-transformed unexpectedly&quot;</span><span class="delimiter">)</span>

          <span class="keyword">try</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> Some<a href="#3382271" title="(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)" id="3382273" class="delimiter">(</a><a href="../../Option.scala.html#63132" title="(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)" id="3382272" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="SelectiveANFTransform.this.global.Type" id="1214945">a</a>, <a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.global.Type" id="1214946">b</a><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="#1213768" title="SelectiveANFTransform.this.CPSInfo">cpsR</a>
            /** Since shiftUnit is bounded [A,B,C&gt;:B] this may not typecheck
             *  if C is overly specific.  So if !(B &lt;:&lt; C), call shiftUnit0
             *  instead, which takes only two type arguments.
             */
            <span class="keyword">val</span> <a title="Boolean" id="1214947">conforms</a> = <a href="#1214945" title="SelectiveANFTransform.this.global.Type">a</a> <a href="../../reflect/internal/Types.scala.html#408481" title="(that: SelectiveANFTransform.this.global.Type)Boolean">&lt;:&lt;</a> <a href="#1214946" title="SelectiveANFTransform.this.global.Type">b</a>
            <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.analyzer.global.Tree" id="1214948">call</a> = <a href="../nsc/transform/TypingTransformers.scala.html#984456" title="=&gt; SelectiveANFTransform.this.global.analyzer.Typer">localTyper</a>.<a href="../nsc/typechecker/Typers.scala.html#538703" title="(pos: SelectiveANFTransform.this.global.analyzer.global.Position)(tree: SelectiveANFTransform.this.global.analyzer.global.Tree)SelectiveANFTransform.this.global.analyzer.global.Tree">typedPos</a><span class="delimiter">(</span><a href="#1213766" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span>
              <a href="../../reflect/internal/Trees.scala.html#413581" title="(fun: SelectiveANFTransform.this.global.Tree, args: List[SelectiveANFTransform.this.global.Tree])SelectiveANFTransform.this.global.Apply">Apply</a><span class="delimiter">(</span>
                <a href="../../reflect/internal/Trees.scala.html#453869" title="(fun: SelectiveANFTransform.this.global.Tree, args: List[SelectiveANFTransform.this.global.Tree])SelectiveANFTransform.this.global.TypeApply">TypeApply</a><span class="delimiter">(</span>
                  <a href="../nsc/Global.scala.html#537460" title="SelectiveANFTransform.this.global.gen.type">gen</a>.<a href="../../reflect/internal/TreeGen.scala.html#470989" title="(sym: SelectiveANFTransform.this.global.gen.global.Symbol)SelectiveANFTransform.this.global.gen.global.Tree">mkAttributedRef</a><span class="delimiter">(</span> <span title="SelectiveANFTransform.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#1214947" title="Boolean">conforms</a><span class="delimiter">)</span> <a href="CPSUtils.scala.html#1211350" title="=&gt; SelectiveANFTransform.this.global.Symbol">MethShiftUnit</a> <span class="keyword">else</span> <a href="CPSUtils.scala.html#1211352" title="=&gt; SelectiveANFTransform.this.global.Symbol">MethShiftUnit0</a> <span class="delimiter">)</span>,
                  <a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.TypeTree*)List[SelectiveANFTransform.this.global.TypeTree]">List</a><span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#408087" title="(tp: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="#1214919" title="SelectiveANFTransform.this.global.Type">plainTpe</a><span class="delimiter">)</span>, <a href="../../reflect/internal/Trees.scala.html#408087" title="(tp: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="#1214945" title="SelectiveANFTransform.this.global.Type">a</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#62697" title="(that: scala.collection.GenTraversableOnce[SelectiveANFTransform.this.global.TypeTree])(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.TypeTree],SelectiveANFTransform.this.global.TypeTree,List[SelectiveANFTransform.this.global.Tree]])List[SelectiveANFTransform.this.global.Tree]">++</a> <span class="delimiter">(</span> <span title="List[SelectiveANFTransform.this.global.TypeTree]" class="keyword">if</span> <span class="delimiter">(</span><a href="#1214947" title="Boolean">conforms</a><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.TypeTree*)List[SelectiveANFTransform.this.global.TypeTree]">List</a><span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#408087" title="(tp: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="#1214946" title="SelectiveANFTransform.this.global.Type">b</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a> <span class="delimiter">)</span>
                <span class="delimiter">)</span>,
                <a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.Tree*)List[SelectiveANFTransform.this.global.Tree]">List</a><span class="delimiter">(</span><a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span>
              <span class="delimiter">)</span>
            <span class="delimiter">)</span>
            // This is today's sick/meaningless heuristic for spotting breakdown so
            // we don't proceed until stack traces start draping themselves over everything.
            // If there are wildcard types in the tree and B == Nothing, something went wrong.
            // (I thought WildcardTypes would be enough, but nope.  'reset0 { 0 }' has them.)
            //
            // Code as simple as    reset((_: String).length)
            // will crash meaninglessly without this check.  See SI-3718.
            //
            // TODO - obviously this should be done earlier, differently, or with
            // a more skilled hand.  Most likely, all three.
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#1214946" title="SelectiveANFTransform.this.global.Type">b</a>.<a href="../../reflect/internal/Types.scala.html#408407" title="=&gt; SelectiveANFTransform.this.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../reflect/internal/Definitions.scala.html#408692" title="SelectiveANFTransform.this.global.definitions.NothingClass.type">NothingClass</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1214948" title="SelectiveANFTransform.this.global.analyzer.global.Tree">call</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.analyzer.global.Type">tpe</a>.<a href="../../reflect/internal/Types.scala.html#408478" title="(p: SelectiveANFTransform.this.global.analyzer.global.Type =&gt; Boolean)Boolean">exists</a><span class="delimiter">(</span><a href="#1215093" title="SelectiveANFTransform.this.global.analyzer.global.Type">_</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../reflect/internal/Types.scala.html#407279" title="SelectiveANFTransform.this.global.WildcardType.type">WildcardType</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539298" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1213766" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;cannot cps-transform malformed (possibly in shift/reset placement) expression&quot;)" class="string">&quot;cannot cps-transform malformed (possibly in shift/reset placement) expression&quot;</span><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <span title="Nothing" class="keyword">return</span> <span class="delimiter">(</span><a href="../../Tuple2.scala.html#62849" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.analyzer.global.Tree)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.analyzer.global.Tree)" class="delimiter">(</a><a href="#1214915" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="#1214948" title="SelectiveANFTransform.this.global.analyzer.global.Tree">call</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <span class="keyword">catch</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Unit" id="1215100">ex</a>:<a href="../../reflect/internal/Types.scala.html#407625" title="SelectiveANFTransform.this.global.TypeError">TypeError</a> =&gt;
              <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539298" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1215100" title="SelectiveANFTransform.this.global.TypeError">ex</a>.<a href="../../reflect/internal/Types.scala.html#416070" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;cannot cps-transform expression &quot;)" class="string">&quot;cannot cps-transform expression &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1213766" title="SelectiveANFTransform.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1215100" title="SelectiveANFTransform.this.global.TypeError">ex</a>.<a href="../../reflect/internal/Types.scala.html#416073" title="=&gt; String">msg</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1213768" title="SelectiveANFTransform.this.CPSInfo">cpsR</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1214918" title="SelectiveANFTransform.this.CPSInfo">bot</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        // error!
        <a href="../nsc/Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;cps type error: &quot;)" class="string">&quot;cps type error: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span>
        //println(&quot;cps type error: &quot; + expr + &quot;/&quot; + expr.tpe + &quot;/&quot; + getAnswerTypeAnn(expr.tpe))

        //println(cpsR + &quot;/&quot; + spc + &quot;/&quot; + bot)

        <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539298" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1213766" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;found cps expression in non-cps position&quot;)" class="string">&quot;found cps expression in non-cps position&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        // all is well

        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="CPSUtils.scala.html#1211374" title="(tpe: SelectiveANFTransform.this.global.Type)Boolean">hasPlusMarker</a><span class="delimiter">(</span><a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539299" title="(pos: SelectiveANFTransform.this.global.Position, msg: String)Unit">warning</a><span class="delimiter">(</span><a href="#1213766" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, <span title="String(&quot;expression &quot;)" class="string">&quot;expression &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; of type &quot;)" class="string">&quot; of type &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; is not expected to have a cps type&quot;)" class="string">&quot; is not expected to have a cps type&quot;</span><span class="delimiter">)</span>
          <a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a> <a href="../../reflect/internal/Trees.scala.html#408561" title="(f: SelectiveANFTransform.this.global.Type =&gt; SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.Tree">modifyType</a> <a href="CPSUtils.scala.html#1211380" title="(tpe: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.Type">removeAllCPSAnnotations</a>
        <span class="delimiter">}</span>

        // TODO: sanity check that types agree
      <span class="delimiter">}</span>

      <a href="../../Tuple2.scala.html#62849" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a><a href="#1214915" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="#1214916" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="1213183">transInlineValue</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1213916">tree</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a>, <a title="SelectiveANFTransform.this.CPSInfo" id="1213917">cpsA</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Boolean" id="1213918">isAnyParentImpure</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../Tuple3.scala.html#126" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a>List<span class="delimiter">[</span>Tree<span class="delimiter">]</span>, Tree, CPSInfo<span class="delimiter">)</span> = <span class="delimiter">{</span>

      <span class="keyword">val</span> <a href="#3382281" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1215116">stms</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1215117">expr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1215118">spc</a><span class="delimiter">)</span> = <a href="#1213181" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transValue</a><a href="#1213918" title="Boolean" class="delimiter">(</a><a href="#1213916" title="SelectiveANFTransform.this.global.Tree">tree</a>, <a href="#1213917" title="SelectiveANFTransform.this.CPSInfo">cpsA</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a><span class="delimiter">)</span> // never required to be cps

      <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><a href="#3382287" title="Some[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]" class="delimiter">(</a><a href="#1215117" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> spcVal @ Some<a href="#3382285" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" id="3382287" class="delimiter">(</a><a href="../../Option.scala.html#63132" title="(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)" id="3382286">_</a><span class="delimiter">)</span> =&gt;

          <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Type" id="1215137">valueTpe</a> = <a href="CPSUtils.scala.html#1211380" title="(tpe: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.Type">removeAllCPSAnnotations</a><span class="delimiter">(</span><a href="#1215117" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>

          <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.Symbol" id="1215138">sym</a>: <a href="../../reflect/internal/Symbols.scala.html#407146" title="SelectiveANFTransform.this.global.Symbol">Symbol</a> = <span class="delimiter">(</span>
            <a href="../../reflect/api/Trees.scala.html#405647" title="=&gt; SelectiveANFTransform.this.global.Symbol">currentOwner</a>.<a href="../../reflect/internal/Symbols.scala.html#411109" title="(name: SelectiveANFTransform.this.global.TermName, pos: SelectiveANFTransform.this.global.Position, newFlags: Long)SelectiveANFTransform.this.global.TermSymbol">newValue</a><span class="delimiter">(</span><a href="../../reflect/internal/Names.scala.html#406859" title="(s: String)SelectiveANFTransform.this.global.TermName">newTermName</a><span class="delimiter">(</span><a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>.<a href="../nsc/CompilationUnits.scala.html#539273" title="=&gt; scala.tools.nsc.util.FreshNameCreator">fresh</a>.<a href="../nsc/util/FreshNameCreator.scala.html#540550" title="(prefix: String)String">newName</a><span class="delimiter">(</span><span title="String(&quot;tmp&quot;)" class="string">&quot;tmp&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#1213916" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a>, Flags.<span title="Long(2097152L)">SYNTHETIC</span><span class="delimiter">)</span>
              <a href="../../reflect/internal/Symbols.scala.html#411369" title="(info: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.TermSymbol">setInfo</a> <a href="#1215137" title="SelectiveANFTransform.this.global.Type">valueTpe</a>
              <a href="../../reflect/internal/Symbols.scala.html#411401" title="(annots: List[SelectiveANFTransform.this.global.AnnotationInfo])SelectiveANFTransform.this.global.TermSymbol">setAnnotations</a> <a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.AnnotationInfo*)List[SelectiveANFTransform.this.global.AnnotationInfo]">List</a><span class="delimiter">(</span><a href="../../reflect/internal/AnnotationInfos.scala.html#411921" title="(atp: SelectiveANFTransform.this.global.Type, args: List[SelectiveANFTransform.this.global.Tree], assocs: List[(SelectiveANFTransform.this.global.Name, SelectiveANFTransform.this.global.ClassfileAnnotArg)])SelectiveANFTransform.this.global.AnnotationInfo">AnnotationInfo</a><span class="delimiter">(</span><a href="CPSUtils.scala.html#1211336" title="=&gt; SelectiveANFTransform.this.global.ClassSymbol">MarkerCPSSym</a>.<a href="../../reflect/internal/Symbols.scala.html#411559" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a>, <a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">)</span>
          <a href="#1215117" title="SelectiveANFTransform.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#408563" title="(pairs: (SelectiveANFTransform.this.global.Symbol, SelectiveANFTransform.this.global.Symbol)*)SelectiveANFTransform.this.global.Tree">changeOwner</a><span class="delimiter">(</span><a href="../../Predef.scala.html#7509" title="(x: SelectiveANFTransform.this.global.Symbol)ArrowAssoc[SelectiveANFTransform.this.global.Symbol]">currentOwner</a> <a href="../../Predef.scala.html#62634" title="(y: SelectiveANFTransform.this.global.Symbol)(SelectiveANFTransform.this.global.Symbol, SelectiveANFTransform.this.global.Symbol)">-&gt;</a> <a href="#1215138" title="SelectiveANFTransform.this.global.Symbol">sym</a><span class="delimiter">)</span>

          <a href="../../Tuple3.scala.html#63169" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Ident, _3: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Ident, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1215116" title="List[SelectiveANFTransform.this.global.Tree]">stms</a> <a href="../../collection/immutable/List.scala.html#62688" title="(prefix: List[SelectiveANFTransform.this.global.Tree])List[SelectiveANFTransform.this.global.Tree]">:::</a> <a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.ValDef*)List[SelectiveANFTransform.this.global.ValDef]">List</a><span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#408102" title="(sym: SelectiveANFTransform.this.global.Symbol, rhs: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#1215138" title="SelectiveANFTransform.this.global.Symbol">sym</a>, <a href="#1215117" title="SelectiveANFTransform.this.global.Tree">expr</a><span class="delimiter">)</span> <a href="../../reflect/internal/Trees.scala.html#408575" title="(tp: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.ValDef">setType</a><span class="delimiter">(</span><a href="../../reflect/internal/Types.scala.html#407284" title="SelectiveANFTransform.this.global.NoType.type">NoType</a><span class="delimiter">)</span><span class="delimiter">)</span>,
             <a href="../../reflect/internal/Trees.scala.html#408127" title="(sym: SelectiveANFTransform.this.global.Symbol)SelectiveANFTransform.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#1215138" title="SelectiveANFTransform.this.global.Symbol">sym</a><span class="delimiter">)</span> <a href="../../reflect/internal/Trees.scala.html#408575" title="(tp: SelectiveANFTransform.this.global.Type)SelectiveANFTransform.this.global.Ident">setType</a><span class="delimiter">(</span><a href="#1215137" title="SelectiveANFTransform.this.global.Type">valueTpe</a><span class="delimiter">)</span> <a href="../../reflect/internal/StdAttachments.scala.html#409604" title="(newpos: scala.reflect.internal.util.Position)SelectiveANFTransform.this.global.Ident">setPos</a><span class="delimiter">(</span><a href="#1213916" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a><span class="delimiter">)</span>, <a href="CPSUtils.scala.html#1211388" title="(a: SelectiveANFTransform.this.CPSInfo, b: SelectiveANFTransform.this.CPSInfo)(implicit unit: SelectiveANFTransform.this.global.CompilationUnit, implicit pos: SelectiveANFTransform.this.global.Position)SelectiveANFTransform.this.CPSInfo">linearize</a><span class="delimiter">(</span><a href="#1215118" title="SelectiveANFTransform.this.CPSInfo">spc</a>, spcVal<span class="delimiter">)</span><span class="delimiter">(</span><a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>, <a href="#1213916" title="SelectiveANFTransform.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> _ =&gt;
          <a href="#3382289" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1215116" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="#1215117" title="SelectiveANFTransform.this.global.Tree">expr</a>, <a href="#1215118" title="SelectiveANFTransform.this.CPSInfo">spc</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span>



    <span class="keyword">def</span> <a title="(stm: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)" id="1213184">transInlineStm</a><span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1215278">stm</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a>, <a title="SelectiveANFTransform.this.CPSInfo" id="1215279">cpsA</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Boolean" id="1215280">isAnyParentImpure</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>:  <a href="../../Tuple2.scala.html#783" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a>List<span class="delimiter">[</span>Tree<span class="delimiter">]</span>, CPSInfo<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#1215278" title="SelectiveANFTransform.this.global.Tree">stm</a> <span class="keyword">match</span> <span class="delimiter">{</span>

        // TODO: what about DefDefs?
        // TODO: relation to top-level val def?
        // TODO: what about lazy vals?

        <span class="keyword">case</span> tree @ ValDef<a href="#3382306" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)" id="3382308" class="delimiter">(</a><a href="../../reflect/internal/Trees.scala.html#410298" title="SelectiveANFTransform.this.global.Modifiers" id="1215288">mods</a>, <a href="../../reflect/internal/Trees.scala.html#410300" title="SelectiveANFTransform.this.global.TermName" id="1215289">name</a>, <a href="../../reflect/internal/Trees.scala.html#410302" title="SelectiveANFTransform.this.global.Tree" id="1215290">tpt</a>, <a href="../../reflect/internal/Trees.scala.html#410304" title="SelectiveANFTransform.this.global.Tree" id="1215291">rhs</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#3382296" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1215293">stms</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1215294">anfRhs</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1215295">spc</a><span class="delimiter">)</span> = <a href="../nsc/transform/TypingTransformers.scala.html#984463" title="(owner: SelectiveANFTransform.this.global.Symbol)(trans: =&gt; (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">atOwner</a><span class="delimiter">(</span>tree.<a href="../../reflect/internal/Trees.scala.html#409939" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a><span class="delimiter">)</span> <a href="../../Tuple3.scala.html#126" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo) @unchecked" class="delimiter">{</a> <a href="#1213181" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transValue</a><a href="#1215280" title="Boolean" class="delimiter">(</a><a href="#1215291" title="SelectiveANFTransform.this.global.Tree">rhs</a>, <a href="#1215279" title="SelectiveANFTransform.this.CPSInfo">cpsA</a>, <a href="../../Option.scala.html#1585" title="None.type">None</a><span class="delimiter">)</span> <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="SelectiveANFTransform.this.global.ChangeOwnerTraverser" id="1215296">tv</a> = <span title="SelectiveANFTransform.this.global.ChangeOwnerTraverser" class="keyword">new</span> <a href="../../reflect/internal/Trees.scala.html#408135" title="SelectiveANFTransform.this.global.ChangeOwnerTraverser">ChangeOwnerTraverser</a><span class="delimiter">(</span>tree.<a href="../../reflect/internal/Trees.scala.html#409939" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a>, <a href="../../reflect/api/Trees.scala.html#405647" title="=&gt; SelectiveANFTransform.this.global.Symbol">currentOwner</a><span class="delimiter">)</span>
          <a href="#1215293" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>.<a href="../../collection/immutable/List.scala.html#62719" title="(f: SelectiveANFTransform.this.global.Tree =&gt; Unit)Unit">foreach</a><span class="delimiter">(</span><a href="#1215296" title="SelectiveANFTransform.this.global.ChangeOwnerTraverser">tv</a>.<a href="../../reflect/internal/Trees.scala.html#481308" title="(tree: SelectiveANFTransform.this.global.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#1215354" title="SelectiveANFTransform.this.global.Tree">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

          // TODO: symbol might already have annotation. Should check conformance
          // TODO: better yet: do without annotations on symbols

          <span class="keyword">val</span> <a title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]" id="1215297">spcVal</a> = <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1215294" title="SelectiveANFTransform.this.global.Tree">anfRhs</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>
          <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#1215297" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">spcVal</a>.<a href="../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              tree.<a href="../../reflect/internal/Trees.scala.html#409939" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a>.<a href="../../reflect/internal/Symbols.scala.html#411401" title="(annots: List[SelectiveANFTransform.this.global.AnnotationInfo])SelectiveANFTransform.this.global.Symbol">setAnnotations</a><span class="delimiter">(</span><a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.AnnotationInfo*)List[SelectiveANFTransform.this.global.AnnotationInfo]">List</a><span class="delimiter">(</span><a href="../../reflect/internal/AnnotationInfos.scala.html#411921" title="(atp: SelectiveANFTransform.this.global.Type, args: List[SelectiveANFTransform.this.global.Tree], assocs: List[(SelectiveANFTransform.this.global.Name, SelectiveANFTransform.this.global.ClassfileAnnotArg)])SelectiveANFTransform.this.global.AnnotationInfo">AnnotationInfo</a><span class="delimiter">(</span><a href="CPSUtils.scala.html#1211336" title="=&gt; SelectiveANFTransform.this.global.ClassSymbol">MarkerCPSSym</a>.<a href="../../reflect/internal/Symbols.scala.html#411559" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a>, <a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <a href="../../Tuple2.scala.html#62849" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1215293" title="List[SelectiveANFTransform.this.global.Tree]">stms</a><a href="../../collection/immutable/List.scala.html#62688" title="(prefix: List[SelectiveANFTransform.this.global.Tree])List[SelectiveANFTransform.this.global.Tree]">:::</a><a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.ValDef*)List[SelectiveANFTransform.this.global.ValDef]">List</a><span class="delimiter">(</span><a href="../../reflect/api/Trees.scala.html#405645" title="=&gt; SelectiveANFTransform.this.global.TreeCopier">treeCopy</a>.<a href="../../reflect/api/Trees.scala.html#405374" title="(tree: SelectiveANFTransform.this.global.Tree, mods: SelectiveANFTransform.this.global.Modifiers, name: SelectiveANFTransform.this.global.Name, tpt: SelectiveANFTransform.this.global.Tree, rhs: SelectiveANFTransform.this.global.Tree)SelectiveANFTransform.this.global.ValDef">ValDef</a><span class="delimiter">(</span>tree, <a href="#1215288" title="SelectiveANFTransform.this.global.Modifiers">mods</a>, <a href="#1215289" title="SelectiveANFTransform.this.global.TermName">name</a>, <a href="#1215290" title="SelectiveANFTransform.this.global.Tree">tpt</a>, <a href="#1215294" title="SelectiveANFTransform.this.global.Tree">anfRhs</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="CPSUtils.scala.html#1211388" title="(a: SelectiveANFTransform.this.CPSInfo, b: SelectiveANFTransform.this.CPSInfo)(implicit unit: SelectiveANFTransform.this.global.CompilationUnit, implicit pos: SelectiveANFTransform.this.global.Position)SelectiveANFTransform.this.CPSInfo">linearize</a><span class="delimiter">(</span><a href="#1215295" title="SelectiveANFTransform.this.CPSInfo">spc</a>, <a href="#1215297" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">spcVal</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>, tree.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> _ =&gt;
          <span class="keyword">val</span> <a href="#3382302" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple3.scala.html#60576" title="List[SelectiveANFTransform.this.global.Tree]" id="1215408">headStms</a>, <a href="../../Tuple3.scala.html#60578" title="SelectiveANFTransform.this.global.Tree" id="1215409">headExpr</a>, <a href="../../Tuple3.scala.html#60580" title="SelectiveANFTransform.this.CPSInfo" id="1215410">headSpc</a><span class="delimiter">)</span> = <a href="#1213183" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree, SelectiveANFTransform.this.CPSInfo)">transInlineValue</a><a href="#1215280" title="Boolean" class="delimiter">(</a><a href="#1215278" title="SelectiveANFTransform.this.global.Tree">stm</a>, <a href="#1215279" title="SelectiveANFTransform.this.CPSInfo">cpsA</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]" id="1215411">valSpc</a> = <a href="CPSUtils.scala.html#1211384" title="(tp: SelectiveANFTransform.this.global.Type)Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">getAnswerTypeAnn</a><span class="delimiter">(</span><a href="#1215409" title="SelectiveANFTransform.this.global.Tree">headExpr</a>.<a href="../../reflect/internal/Trees.scala.html#408573" title="=&gt; SelectiveANFTransform.this.global.Type">tpe</a><span class="delimiter">)</span>
          <a href="../../Tuple2.scala.html#62849" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.CPSInfo)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="#1215408" title="List[SelectiveANFTransform.this.global.Tree]">headStms</a><a href="../../collection/immutable/List.scala.html#62688" title="(prefix: List[SelectiveANFTransform.this.global.Tree])List[SelectiveANFTransform.this.global.Tree]">:::</a><a href="../../collection/immutable/List.scala.html#62451" title="(xs: SelectiveANFTransform.this.global.Tree*)List[SelectiveANFTransform.this.global.Tree]">List</a><span class="delimiter">(</span><a href="#1215409" title="SelectiveANFTransform.this.global.Tree">headExpr</a><span class="delimiter">)</span>, <a href="CPSUtils.scala.html#1211388" title="(a: SelectiveANFTransform.this.CPSInfo, b: SelectiveANFTransform.this.CPSInfo)(implicit unit: SelectiveANFTransform.this.global.CompilationUnit, implicit pos: SelectiveANFTransform.this.global.Position)SelectiveANFTransform.this.CPSInfo">linearize</a><span class="delimiter">(</span><a href="#1215410" title="SelectiveANFTransform.this.CPSInfo">headSpc</a>, <a href="#1215411" title="Option[(SelectiveANFTransform.this.global.Type, SelectiveANFTransform.this.global.Type)]">valSpc</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#1213186" title="SelectiveANFTransform.this.global.CompilationUnit">unit</a>, <a href="#1215278" title="SelectiveANFTransform.this.global.Tree">stm</a>.<a href="../../reflect/internal/Trees.scala.html#408571" title="=&gt; SelectiveANFTransform.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    // precondition: cpsR.isDefined &quot;implies&quot; isAnyParentImpure
    <span class="keyword">def</span> <a title="(stms: List[SelectiveANFTransform.this.global.Tree], expr: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" id="1213185">transBlock</a><span class="delimiter">(</span><a title="List[SelectiveANFTransform.this.global.Tree]" id="1214040">stms</a>: <a href="../../collection/immutable/List.scala.html#11952" title="List[SelectiveANFTransform.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="SelectiveANFTransform.this.global.Tree" id="1214041">expr</a>: <a href="../../reflect/internal/Trees.scala.html#407938" title="SelectiveANFTransform.this.global.Tree">Tree</a>, <a title="SelectiveANFTransform.this.CPSInfo" id="1214042">cpsA</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a>, <a title="SelectiveANFTransform.this.CPSInfo" id="1214043">cpsR</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Boolean" id="1214044">isAnyParentImpure</a>: <a href="../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../Tuple2.scala.html#783" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a>List<span class="delimiter">[</span>Tree<span class="delimiter">]</span>, Tree<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(currStats: List[SelectiveANFTransform.this.global.Tree], currAns: SelectiveANFTransform.this.CPSInfo, accum: List[SelectiveANFTransform.this.global.Tree])(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" id="1215451">rec</a><span class="delimiter">(</span><a title="List[SelectiveANFTransform.this.global.Tree]" id="1215455">currStats</a>: <a href="../../collection/immutable/List.scala.html#11952" title="List[SelectiveANFTransform.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="SelectiveANFTransform.this.CPSInfo" id="1215456">currAns</a>: <a href="../../Option.scala.html#978" title="SelectiveANFTransform.this.CPSInfo">CPSInfo</a>, <a title="List[SelectiveANFTransform.this.global.Tree]" id="1215457">accum</a>: <a href="../../collection/immutable/List.scala.html#11952" title="List[SelectiveANFTransform.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Tuple2.scala.html#783" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a>List<span class="delimiter">[</span>Tree<span class="delimiter">]</span>, Tree<span class="delimiter">)</span> =
        <a href="#1215455" title="List[SelectiveANFTransform.this.global.Tree]">currStats</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="../../collection/immutable/List.scala.html#11188" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" id="3382330">Nil</a> =&gt;
            <span class="keyword">val</span> <a href="#3382317" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="List[SelectiveANFTransform.this.global.Tree]" id="1215459">anfStats</a>, <a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.global.Tree" id="1215460">anfExpr</a><span class="delimiter">)</span> = <a href="#1213182" title="(tree: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo, cpsR: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)">transTailValue</a><a href="#1214044" title="Boolean" class="delimiter">(</a><a href="#1214041" title="SelectiveANFTransform.this.global.Tree">expr</a>, <a href="#1215456" title="SelectiveANFTransform.this.CPSInfo">currAns</a>, <a href="#1214043" title="SelectiveANFTransform.this.CPSInfo">cpsR</a><span class="delimiter">)</span>
            <a href="../../Tuple2.scala.html#62849" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a><a href="#1215457" title="List[SelectiveANFTransform.this.global.Tree]">accum</a> <a href="../../collection/immutable/List.scala.html#62697" title="(that: scala.collection.GenTraversableOnce[SelectiveANFTransform.this.global.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.Tree],SelectiveANFTransform.this.global.Tree,List[SelectiveANFTransform.this.global.Tree]])List[SelectiveANFTransform.this.global.Tree]">++</a> <a href="#1215459" title="List[SelectiveANFTransform.this.global.Tree]">anfStats</a>, <a href="#1215460" title="SelectiveANFTransform.this.global.Tree">anfExpr</a><span class="delimiter">)</span>

          <span class="keyword">case</span> <a href="../../collection/immutable/List.scala.html#206583" title="SelectiveANFTransform.this.global.Tree" id="1215532">stat</a> <a href="#3382327" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" id="3382329">::</a> <a href="../../collection/immutable/List.scala.html#206584" title="List[SelectiveANFTransform.this.global.Tree]" id="1215533">rest</a> =&gt;
            <span class="keyword">val</span> <a href="#3382323" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="List[SelectiveANFTransform.this.global.Tree]" id="1215535">stats</a>, <a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.CPSInfo" id="1215536">nextAns</a><span class="delimiter">)</span> = <a href="#1213184" title="(stm: SelectiveANFTransform.this.global.Tree, cpsA: SelectiveANFTransform.this.CPSInfo)(implicit isAnyParentImpure: Boolean)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.CPSInfo)">transInlineStm</a><a href="#1214044" title="Boolean" class="delimiter">(</a><a href="#1215532" title="SelectiveANFTransform.this.global.Tree">stat</a>, <a href="#1215456" title="SelectiveANFTransform.this.CPSInfo">currAns</a><span class="delimiter">)</span>
            <a href="#1215451" title="(currStats: List[SelectiveANFTransform.this.global.Tree], currAns: SelectiveANFTransform.this.CPSInfo, accum: List[SelectiveANFTransform.this.global.Tree])(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)">rec</a><span class="delimiter">(</span><a href="#1215533" title="List[SelectiveANFTransform.this.global.Tree]">rest</a>, <a href="#1215536" title="SelectiveANFTransform.this.CPSInfo">nextAns</a>, <a href="#1215457" title="List[SelectiveANFTransform.this.global.Tree]">accum</a> <a href="../../collection/immutable/List.scala.html#62697" title="(that: scala.collection.GenTraversableOnce[SelectiveANFTransform.this.global.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.Tree],SelectiveANFTransform.this.global.Tree,List[SelectiveANFTransform.this.global.Tree]])List[SelectiveANFTransform.this.global.Tree]">++</a> <a href="#1215535" title="List[SelectiveANFTransform.this.global.Tree]">stats</a><span class="delimiter">)</span>
         <span class="delimiter">}</span>

      <span class="keyword">val</span> <a href="#3382342" title="(x: (List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree))(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="List[SelectiveANFTransform.this.global.Tree]" id="1215453">anfStats</a>, <a href="../../Tuple2.scala.html#60637" title="SelectiveANFTransform.this.global.Tree" id="1215454">anfExpr</a><span class="delimiter">)</span> = <a href="#1215451" title="(currStats: List[SelectiveANFTransform.this.global.Tree], currAns: SelectiveANFTransform.this.CPSInfo, accum: List[SelectiveANFTransform.this.global.Tree])(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)">rec</a><a href="../../Tuple2.scala.html#783" title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree) @unchecked" class="delimiter">(</a><a href="#1214040" title="List[SelectiveANFTransform.this.global.Tree]">stms</a>, <a href="#1214042" title="SelectiveANFTransform.this.CPSInfo">cpsA</a>, List<a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type" class="delimiter">(</a><span class="delimiter">)</span><span class="delimiter">)</span>
      // println(&quot;\nanf-block:\n&quot;+ ((stms :+ expr) mkString (&quot;{&quot;, &quot;\n&quot;, &quot;}&quot;)) +&quot;\nBECAME\n&quot;+ ((anfStats :+ anfExpr) mkString (&quot;{&quot;, &quot;\n&quot;, &quot;}&quot;)))
      // println(&quot;synth case? &quot;+ (anfStats map (t =&gt; (t, t.isDef, treeInfo.hasSynthCaseSymbol(t)))))
      // SUPER UGLY HACK: handle virtpatmat-style matches, whose labels have already been turned into DefDefs
      <span title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.analyzer.global.Tree)" class="keyword">if</span> <span class="delimiter">(</span><a href="#1215453" title="List[SelectiveANFTransform.this.global.Tree]">anfStats</a>.<a href="../../collection/TraversableOnce.scala.html#58191" title="=&gt; Boolean">nonEmpty</a> <a href="../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#1215453" title="List[SelectiveANFTransform.this.global.Tree]">anfStats</a> <a href="../../collection/LinearSeqOptimized.scala.html#86378" title="(p: SelectiveANFTransform.this.global.Tree =&gt; Boolean)Boolean">forall</a> <span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1215609">t</a> =&gt; <a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1215609" title="SelectiveANFTransform.this.global.Tree">t</a>.<a href="../../reflect/internal/Trees.scala.html#408581" title="=&gt; Boolean">isDef</a> <a href="../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="../nsc/ast/Trees.scala.html#537807" title="SelectiveANFTransform.this.global.treeInfo.type">treeInfo</a>.<a href="../../reflect/internal/TreeInfo.scala.html#479246" title="(t: SelectiveANFTransform.this.global.treeInfo.global.Tree)Boolean">hasSynthCaseSymbol</a><span class="delimiter">(</span><a href="#1215609" title="SelectiveANFTransform.this.global.Tree">t</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a href="#3382348" title="(x: (List[SelectiveANFTransform.this.global.Tree], List[SelectiveANFTransform.this.global.Tree]))(List[SelectiveANFTransform.this.global.Tree], List[SelectiveANFTransform.this.global.Tree])" class="delimiter">(</a><a href="../../Tuple2.scala.html#60635" title="List[SelectiveANFTransform.this.global.Tree]" id="1215611">prologue</a>, <a href="../../Tuple2.scala.html#60637" title="List[SelectiveANFTransform.this.global.Tree]" id="1215612">rest</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#1215453" title="List[SelectiveANFTransform.this.global.Tree]">anfStats</a> <a href="../../collection/SeqLike.scala.html#58855" title="(elem: SelectiveANFTransform.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.Tree],SelectiveANFTransform.this.global.Tree,List[SelectiveANFTransform.this.global.Tree]])List[SelectiveANFTransform.this.global.Tree]">:+</a> <a href="#1215454" title="SelectiveANFTransform.this.global.Tree">anfExpr</a><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#62715" title="(p: SelectiveANFTransform.this.global.Tree =&gt; Boolean)(List[SelectiveANFTransform.this.global.Tree], List[SelectiveANFTransform.this.global.Tree])">span</a> <span class="delimiter">(</span><a title="SelectiveANFTransform.this.global.Tree" id="1215665">s</a> =&gt; <a href="../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1215665" title="SelectiveANFTransform.this.global.Tree">s</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../reflect/internal/Trees.scala.html#407963" title="SelectiveANFTransform.this.global.DefDef">DefDef</a><span class="delimiter">]</span><span class="delimiter">)</span> // find first case
        // println(&quot;rest: &quot;+ rest)
        // val (defs, calls) = rest partition (_.isInstanceOf[DefDef])
        <span title="(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.analyzer.global.Tree)" class="keyword">if</span> <span class="delimiter">(</span><a href="#1215612" title="List[SelectiveANFTransform.this.global.Tree]">rest</a>.<a href="../../collection/TraversableOnce.scala.html#58191" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          // the filter drops the ()'s emitted when transValue encountered a LabelDef
          <span class="keyword">val</span> <a title="List[SelectiveANFTransform.this.global.Tree]" id="1215677">stats</a> = <a href="#1215611" title="List[SelectiveANFTransform.this.global.Tree]">prologue</a> <a href="../../collection/immutable/List.scala.html#62697" title="(that: scala.collection.GenTraversableOnce[SelectiveANFTransform.this.global.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[SelectiveANFTransform.this.global.Tree],SelectiveANFTransform.this.global.Tree,List[SelectiveANFTransform.this.global.Tree]])List[SelectiveANFTransform.this.global.Tree]">++</a> <span class="delimiter">(</span><a href="#1215612" title="List[SelectiveANFTransform.this.global.Tree]">rest</a> <a href="../../collection/TraversableLike.scala.html#58073" title="(p: SelectiveANFTransform.this.global.Tree =&gt; Boolean)List[SelectiveANFTransform.this.global.Tree]">filter</a> <span class="delimiter">(</span><a href="#1215705" title="SelectiveANFTransform.this.global.Tree">_</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../reflect/internal/Trees.scala.html#407963" title="SelectiveANFTransform.this.global.DefDef">DefDef</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../collection/immutable/List.scala.html#62716" title="=&gt; List[SelectiveANFTransform.this.global.Tree]">reverse</a> // ++ calls
          // println(&quot;REVERSED &quot;+ (stats mkString (&quot;{&quot;, &quot;\n&quot;, &quot;}&quot;)))
          <a href="../../Tuple2.scala.html#62849" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.analyzer.global.Tree)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.analyzer.global.Tree)" class="delimiter">(</a><a href="#1215677" title="List[SelectiveANFTransform.this.global.Tree]">stats</a>, <a href="../nsc/transform/TypingTransformers.scala.html#984456" title="=&gt; SelectiveANFTransform.this.global.analyzer.Typer">localTyper</a>.<a href="../nsc/typechecker/Typers.scala.html#538701" title="(tree: SelectiveANFTransform.this.global.analyzer.global.Tree)SelectiveANFTransform.this.global.analyzer.global.Tree">typed</a><span class="delimiter">{</span><a href="../../reflect/internal/Trees.scala.html#413581" title="(fun: SelectiveANFTransform.this.global.Tree, args: List[SelectiveANFTransform.this.global.Tree])SelectiveANFTransform.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="../../reflect/internal/Trees.scala.html#408127" title="(sym: SelectiveANFTransform.this.global.Symbol)SelectiveANFTransform.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#1215612" title="List[SelectiveANFTransform.this.global.Tree]">rest</a>.<a href="../../collection/IterableLike.scala.html#58577" title="=&gt; SelectiveANFTransform.this.global.Tree">head</a>.<a href="../../reflect/internal/Trees.scala.html#408577" title="=&gt; SelectiveANFTransform.this.global.Symbol">symbol</a><span class="delimiter">)</span>, List<a href="../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type" class="delimiter">(</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">)</span> // call first label to kick-start the match
        <span class="delimiter">}</span> <span class="keyword">else</span> <a href="../../Tuple2.scala.html#62849" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a><a href="#1215453" title="List[SelectiveANFTransform.this.global.Tree]">anfStats</a>, <a href="#1215454" title="SelectiveANFTransform.this.global.Tree">anfExpr</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <a href="../../Tuple2.scala.html#62849" title="(_1: List[SelectiveANFTransform.this.global.Tree], _2: SelectiveANFTransform.this.global.Tree)(List[SelectiveANFTransform.this.global.Tree], SelectiveANFTransform.this.global.Tree)" class="delimiter">(</a><a href="#1215453" title="List[SelectiveANFTransform.this.global.Tree]">anfStats</a>, <a href="#1215454" title="SelectiveANFTransform.this.global.Tree">anfExpr</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/interactive/ScratchPadMaker.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interactive

<span class="keyword">import</span> scala.reflect.internal.util.<span class="delimiter">{</span>SourceFile, BatchSourceFile, RangePosition<span class="delimiter">}</span>
<span class="keyword">import</span> scala.collection.mutable.ArrayBuffer
<span class="keyword">import</span> scala.reflect.internal.<a href="../../../reflect/internal/Chars.scala.html#18749" title="scala.reflect.internal.Chars.type">Chars</a>.<span class="delimiter">{</span>isLineBreakChar, isWhitespace<span class="delimiter">}</span>
<span class="keyword">import</span> ast.parser.<a href="../ast/parser/Tokens.scala.html#28987" title="scala.tools.nsc.ast.parser.Tokens.type">Tokens</a>._

@deprecated<span class="delimiter">(</span><span class="string">&quot;SI-6458: Instrumentation logic will be moved out of the compiler.&quot;</span>,<span class="string">&quot;2.10.0&quot;</span><span class="delimiter">)</span>
<span class="keyword">trait</span> <a title="trait ScratchPadMaker extends Object" id="36321">ScratchPadMaker</a> <a href="../../../Unit.scala.html#1515" title="Unit" class="delimiter">{</a> self: Global =&gt;

  <span class="keyword">import</span> <a href="../../../reflect/internal/Definitions.scala.html#407777" title="ScratchPadMaker.this.definitions.type">definitions</a>._

  <span class="keyword">private</span> case <span class="keyword">class</span> <a title="class Patch extends AnyRef with Product with Serializable" id="863547">Patch</a><a href="../../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="Int" id="861137">offset</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="String" id="861138">text</a>: <span title="String">String</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class Patcher extends ScratchPadMaker.this.Traverser" id="633545">Patcher</a><a href="#633545" title="ScratchPadMaker.this.Patcher" class="delimiter">(</a><a title="Array[Char]" id="861021">contents</a>: <a href="../../../Array.scala.html#174" title="Array[Char]">Array</a><span class="delimiter">[</span>Char<span class="delimiter">]</span>, <a title="ScratchPadMaker.this.LexicalStructure" id="861022">lex</a>: <a href="#633546" title="ScratchPadMaker.this.LexicalStructure">LexicalStructure</a>, <a title="Int" id="861023">endOffset</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../reflect/api/Trees.scala.html#56467" title="ScratchPadMaker.this.Traverser">Traverser</a> <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="String" id="860963">objectName</a>: <span title="String">String</span> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch]" id="860965">patches</a> = <a href="../../../collection/mutable/ArrayBuffer.scala.html#66876" title="()scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch]" class="keyword">new</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#12792" title="scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch]">ArrayBuffer</a><span class="delimiter">[</span>Patch<span class="delimiter">]</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[String]" id="860967">toPrint</a> = <a href="../../../collection/mutable/ArrayBuffer.scala.html#66876" title="()scala.collection.mutable.ArrayBuffer[String]" class="keyword">new</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#12792" title="scala.collection.mutable.ArrayBuffer[String]">ArrayBuffer</a><span class="delimiter">[</span>String<span class="delimiter">]</span>
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="860970">skipped</a> = <span title="Int(0)" class="int">0</span>
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="860973">resNum</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a> = -<span title="Int(-1)" class="int">1</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()String" id="860975">nextRes</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      <a href="#860973" title="(x$1: Int)Unit">resNum</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
      <span title="String(&quot;res$&quot;)" class="string">&quot;res$&quot;</span><span title="(x$1: Any)String">+</span><a href="#860973" title="=&gt; Int">resNum</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: String, tpe: ScratchPadMaker.this.Type)String" id="860976">nameType</a><span class="delimiter">(</span><a title="String" id="861030">name</a>: <span title="String">String</span>, <a title="ScratchPadMaker.this.Type" id="861031">tpe</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="ScratchPadMaker.this.Type">Type</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      // if name ends in symbol character, add a space to separate it from the following ':'
      <span class="keyword">val</span> <a title="String" id="861032">pad</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><span title="Character.type">Character</span>.<span title="(x$1: Char)Boolean">isLetter</span><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">name</a>.<a href="../../../collection/IndexedSeqOptimized.scala.html#59160" title="=&gt; Char">last</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <span title="Character.type">Character</span>.<span title="(x$1: Char)Boolean">isDigit</span><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">name</a>.<a href="../../../collection/IndexedSeqOptimized.scala.html#59160" title="=&gt; Char">last</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span>
      <a href="#861030" title="String">name</a><span title="(x$1: Any)String">+</span><a href="#861032" title="String">pad</a><span title="(x$1: Any)String">+</span><span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span><span title="(x$1: Any)String">+</span><a href="#861031" title="ScratchPadMaker.this.Type">tpe</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: ScratchPadMaker.this.Symbol)String" id="860977">nameType</a><span class="delimiter">(</span><a title="ScratchPadMaker.this.Symbol" id="861111">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="ScratchPadMaker.this.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#860976" title="(name: String, tpe: ScratchPadMaker.this.Type)String">nameType</a><span class="delimiter">(</span><a href="#861111" title="ScratchPadMaker.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a>.<a href="../../../reflect/internal/Names.scala.html#410418" title="=&gt; String">decoded</a>, <a href="#861111" title="ScratchPadMaker.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; ScratchPadMaker.this.Type">tpe</a><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(str: String)String" id="860978">literal</a><span class="delimiter">(</span><a title="String" id="861117">str</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="String(&quot;\&quot;\&quot;\&quot;&quot;)" class="string">&quot;\&quot;\&quot;\&quot;&quot;</span><span title="(x$1: Any)String">+</span><a href="#861117" title="String">str</a><span title="(x$1: Any)String">+</span><span title="String(&quot;\&quot;\&quot;\&quot;&quot;)" class="string">&quot;\&quot;\&quot;\&quot;&quot;</span>

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="String" id="860979">prologue</a> = <span title="String(&quot;;import scala.runtime.WorksheetSupport._; def main(args: Array[String])=$execute{&quot;)" class="string">&quot;;import scala.runtime.WorksheetSupport._; def main(args: Array[String])=$execute{&quot;</span>

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="String" id="860981">epilogue</a> = <span title="String(&quot;}&quot;)" class="string">&quot;}&quot;</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(offset: Int)Unit" id="860983">applyPendingPatches</a><span class="delimiter">(</span><a title="Int" id="861118">offset</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#860970" title="=&gt; Int">skipped</a> <a href="../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#860965" title="=&gt; scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch]">patches</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: ScratchPadMaker.this.Patch)Patcher.this.patches.type">+=</a> <a href="#863547" title="(offset: Int, text: String)ScratchPadMaker.this.Patch">Patch</a><span class="delimiter">(</span><a href="#861118" title="Int">offset</a>, <a href="#860979" title="=&gt; String">prologue</a><span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="String" id="861174">msg</a> &lt;- <a href="../../../collection/mutable/ResizableArray.scala.html#67021" title="(f: String =&gt; scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch])Unit">toPrint</a><span class="delimiter">)</span> <a href="#860965" title="=&gt; scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch]">patches</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: ScratchPadMaker.this.Patch)Patcher.this.patches.type">+=</a> <a href="#863547" title="(offset: Int, text: String)ScratchPadMaker.this.Patch">Patch</a><span class="delimiter">(</span><a href="#861118" title="Int">offset</a>, <span title="String(&quot;;System.out.println(&quot;)" class="string">&quot;;System.out.println(&quot;</span><span title="(x$1: Any)String">+</span><a href="#861174" title="String">msg</a><span title="(x$1: Any)String">+</span><span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
      <a href="#860967" title="=&gt; scala.collection.mutable.ArrayBuffer[String]">toPrint</a>.<a href="../../../collection/mutable/ArrayBuffer.scala.html#66877" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    /** The position where to insert an instrumentation statement in front of giuven statement.
     *  This is at the latest `stat.pos.start`. But in order not to mess with column numbers
     *  in position we try to insert it at the end of the previous token instead.
     *  Furthermore, `(' tokens have to be skipped because they do not show up
     *  in statement range positions.
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(start: Int)Int" id="860984">instrumentPos</a><span class="delimiter">(</span><a title="Int" id="861178">start</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <a href="../../../Int.scala.html#321" title="Int">Int</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a href="#3331839" title="(x: (Int, Int, Int))(Int, Int, Int)" class="delimiter">(</a><a href="../../../Tuple3.scala.html#60576" title="Int" id="861180">prevToken</a>, <a href="../../../Tuple3.scala.html#60578" title="Int" id="861181">prevStart</a>, <a href="../../../Tuple3.scala.html#60580" title="Int" id="861182">prevEnd</a><span class="delimiter">)</span> = <a href="#861022" title="ScratchPadMaker.this.LexicalStructure">lex</a>.<a href="#861020" title="(offset: Int)(Int, Int, Int)">locate</a><a href="../../../Tuple3.scala.html#126" title="(Int, Int, Int) @unchecked" class="delimiter">(</a><a href="#861178" title="Int">start</a> <a href="../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#861181" title="Int">prevStart</a> <a href="../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> <a href="#861178" title="Int">start</a><span class="delimiter">)</span> <a href="#861178" title="Int">start</a>
      <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#861180" title="Int">prevToken</a> <a href="../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(90)">LPAREN</span><span class="delimiter">)</span> <a href="#860984" title="(start: Int)Int">instrumentPos</a><span class="delimiter">(</span><a href="#861181" title="Int">prevStart</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <a href="#861182" title="Int">prevEnd</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(stat: ScratchPadMaker.this.Tree)Unit" id="860985">addSkip</a><span class="delimiter">(</span><a title="ScratchPadMaker.this.Tree" id="861212">stat</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="ScratchPadMaker.this.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="861213">ipos</a> = <a href="#860984" title="(start: Int)Int">instrumentPos</a><span class="delimiter">(</span><a href="#861212" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; ScratchPadMaker.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409671" title="=&gt; Int">start</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#861212" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; ScratchPadMaker.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409671" title="=&gt; Int">start</a> <a href="../../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <a href="#860970" title="=&gt; Int">skipped</a><span class="delimiter">)</span> <a href="#860983" title="(offset: Int)Unit">applyPendingPatches</a><span class="delimiter">(</span><a href="#861213" title="Int">ipos</a><span class="delimiter">)</span>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#861212" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; ScratchPadMaker.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409671" title="=&gt; Int">start</a> <a href="../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> <a href="#861023" title="Int">endOffset</a><span class="delimiter">)</span>
        <a href="#860965" title="=&gt; scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch]">patches</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: ScratchPadMaker.this.Patch)Patcher.this.patches.type">+=</a> <a href="#863547" title="(offset: Int, text: String)ScratchPadMaker.this.Patch">Patch</a><span class="delimiter">(</span><a href="#861213" title="Int">ipos</a>, <span title="String(&quot;;$stop()&quot;)" class="string">&quot;;$stop()&quot;</span><span class="delimiter">)</span>
      <span class="keyword">var</span> <a title="Int" id="861214">end</a> = <a href="#861212" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; ScratchPadMaker.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409675" title="=&gt; Int">end</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#861214" title="Int">end</a> <a href="../../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <a href="#860970" title="=&gt; Int">skipped</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#861214" title="Int">end</a> <a href="../../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="#861021" title="Array[Char]">contents</a>.<a href="../../../Array.scala.html#56638" title="=&gt; Int">length</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="../../../reflect/internal/Chars.scala.html#419123" title="(c: Char)Boolean">isLineBreakChar</a><span class="delimiter">(</span><a href="../../../Array.scala.html#56639" title="(i: Int)Char">contents</a><span class="delimiter">(</span><a href="#861214" title="Int">end</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#861214" title="Int">end</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
        <a href="#860965" title="=&gt; scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch]">patches</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: ScratchPadMaker.this.Patch)Patcher.this.patches.type">+=</a> <a href="#863547" title="(offset: Int, text: String)ScratchPadMaker.this.Patch">Patch</a><span class="delimiter">(</span><a href="#861213" title="Int">ipos</a>, <span title="String(&quot;;$skip(&quot;)" class="string">&quot;;$skip(&quot;</span><span title="(x$1: Any)String">+</span><span class="delimiter">(</span><a href="#861214" title="Int">end</a><a href="../../../Int.scala.html#57161" title="(x: Int)Int">-</a><a href="#860970" title="=&gt; Int">skipped</a><span class="delimiter">)</span><span title="(x$1: Any)String">+</span><span title="String(&quot;); &quot;)" class="string">&quot;); &quot;</span><span class="delimiter">)</span>
        <a href="#860970" title="(x$1: Int)Unit">skipped</a> = <a href="#861214" title="Int">end</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(expr: ScratchPadMaker.this.Tree)Unit" id="860986">addSandbox</a><span class="delimiter">(</span><a title="ScratchPadMaker.this.Tree" id="861255">expr</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="ScratchPadMaker.this.Tree">Tree</a><span class="delimiter">)</span> = <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
//      patches += (Patch(expr.pos.start, &quot;sandbox(&quot;), Patch(expr.pos.end, &quot;)&quot;))

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(prefix: String, expr: String)String" id="860987">resultString</a><span class="delimiter">(</span><a title="String" id="861256">prefix</a>: <span title="String">String</span>, <a title="String" id="861257">expr</a>: <span title="String">String</span><span class="delimiter">)</span> =
      <a href="#860978" title="(str: String)String">literal</a><span class="delimiter">(</span><a href="#861256" title="String">prefix</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; = &quot;)" class="string">&quot; = &quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; + $show(&quot;)" class="string">&quot; + $show(&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#861257" title="String">expr</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(stat: ScratchPadMaker.this.Tree)Any" id="860988">traverseStat</a><span class="delimiter">(</span><a title="ScratchPadMaker.this.Tree" id="861258">stat</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="ScratchPadMaker.this.Tree">Tree</a><span class="delimiter">)</span> =
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; ScratchPadMaker.this.Position">pos</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../../reflect/internal/util/Position.scala.html#22761" title="scala.reflect.internal.util.RangePosition">RangePosition</a><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#861258" title="ScratchPadMaker.this.Tree">stat</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> ValDef<a href="#3331843" title="Any" id="3331848" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410298" title="ScratchPadMaker.this.Modifiers" id="3331844">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410300" title="ScratchPadMaker.this.TermName" id="3331845">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410302" title="ScratchPadMaker.this.Tree" id="3331846">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410304" title="ScratchPadMaker.this.Tree" id="861270">rhs</a><span class="delimiter">)</span> =&gt;
            <a href="#860985" title="(stat: ScratchPadMaker.this.Tree)Unit">addSkip</a><span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a><span class="delimiter">)</span>
            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; ScratchPadMaker.this.Symbol">symbol</a>.<a href="../../../reflect/internal/HasFlags.scala.html#409857" title="=&gt; Boolean">isLazy</a><span class="delimiter">)</span>
              <a href="#860967" title="=&gt; scala.collection.mutable.ArrayBuffer[String]">toPrint</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: String)Patcher.this.toPrint.type">+=</a> <a href="#860978" title="(str: String)String">literal</a><span class="delimiter">(</span><a href="#860977" title="(sym: ScratchPadMaker.this.Symbol)String">nameType</a><span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; ScratchPadMaker.this.Symbol">symbol</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; = &lt;lazy&gt;&quot;)" class="string">&quot; = &lt;lazy&gt;&quot;</span><span class="delimiter">)</span>
            <span class="keyword">else</span> <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; ScratchPadMaker.this.Symbol">symbol</a>.<a href="../../../reflect/internal/HasFlags.scala.html#409872" title="=&gt; Boolean">isSynthetic</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#860986" title="(expr: ScratchPadMaker.this.Tree)Unit">addSandbox</a><span class="delimiter">(</span><a href="#861270" title="ScratchPadMaker.this.Tree">rhs</a><span class="delimiter">)</span>
              <a href="#860967" title="=&gt; scala.collection.mutable.ArrayBuffer[String]">toPrint</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: String)Patcher.this.toPrint.type">+=</a> <a href="#860987" title="(prefix: String, expr: String)String">resultString</a><span class="delimiter">(</span><a href="#860977" title="(sym: ScratchPadMaker.this.Symbol)String">nameType</a><span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; ScratchPadMaker.this.Symbol">symbol</a><span class="delimiter">)</span>, <a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; ScratchPadMaker.this.Symbol">symbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; ScratchPadMaker.this.Symbol#NameType">name</a>.<span title="()String">toString</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="keyword">case</span> DefDef<a href="#3331843" title="Any" id="3331856" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410278" title="ScratchPadMaker.this.Modifiers" id="3331849">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410280" title="ScratchPadMaker.this.Name" id="3331850">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410282" title="List[ScratchPadMaker.this.TypeDef]" id="3331851">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410284" title="List[List[ScratchPadMaker.this.ValDef]]" id="3331852">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410286" title="ScratchPadMaker.this.Tree" id="3331853">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410288" title="ScratchPadMaker.this.Tree" id="3331854">_</a><span class="delimiter">)</span> =&gt;
            <a href="#860985" title="(stat: ScratchPadMaker.this.Tree)Unit">addSkip</a><span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a><span class="delimiter">)</span>
            <a href="#860967" title="=&gt; scala.collection.mutable.ArrayBuffer[String]">toPrint</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: String)Patcher.this.toPrint.type">+=</a> <a href="#860978" title="(str: String)String">literal</a><span class="delimiter">(</span><a href="#860977" title="(sym: ScratchPadMaker.this.Symbol)String">nameType</a><span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; ScratchPadMaker.this.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> Annotated<a href="#3331843" title="Any" id="3331859" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409965" title="ScratchPadMaker.this.Tree" id="3331857">_</a>, <a href="../../../reflect/internal/Trees.scala.html#409967" title="ScratchPadMaker.this.Tree" id="861371">arg</a><span class="delimiter">)</span> =&gt;
            <a href="#860989" title="(tree: ScratchPadMaker.this.Tree)Unit">traverse</a><a href="#3331864" title="(x: Any)Any" class="delimiter">(</a><a href="#861371" title="ScratchPadMaker.this.Tree">arg</a><span class="delimiter">)</span>
          <span class="keyword">case</span> DocDef<a href="#3331843" title="Any" id="3331862" class="delimiter">(</a><a href="../ast/Trees.scala.html#634369" title="ScratchPadMaker.this.DocComment" id="3331860">_</a>, <a href="../ast/Trees.scala.html#634371" title="ScratchPadMaker.this.Tree" id="861376">defn</a><span class="delimiter">)</span> =&gt;
            <a href="#860989" title="(tree: ScratchPadMaker.this.Tree)Unit">traverse</a><a href="#3331864" title="(x: Any)Any" class="delimiter">(</a><a href="#861376" title="ScratchPadMaker.this.Tree">defn</a><span class="delimiter">)</span>
          <span class="keyword">case</span> _ =&gt;
            <a href="#3331864" title="(x: Any)Any" class="keyword">if</a> <span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408583" title="=&gt; Boolean">isTerm</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#860985" title="(stat: ScratchPadMaker.this.Tree)Unit">addSkip</a><span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a><span class="delimiter">)</span>
              <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; ScratchPadMaker.this.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#408407" title="=&gt; ScratchPadMaker.this.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Definitions.scala.html#409353" title="=&gt; ScratchPadMaker.this.ClassSymbol">UnitClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#860986" title="(expr: ScratchPadMaker.this.Tree)Unit">addSandbox</a><span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="String" id="861383">resName</a> = <a href="#860975" title="()String">nextRes</a><span class="delimiter">(</span><span class="delimiter">)</span>
                <span class="keyword">val</span> <a title="String" id="861384">dispResName</a> = <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">resName</a> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: Char =&gt; Boolean)String">filter</a> <span class="delimiter">(</span><span title="Char('$')" class="char">'$'</span> <a href="../../../Char.scala.html#57253" title="(x: Char)Boolean">!=</a> <a href="#861482" title="Char">_</a><span class="delimiter">)</span>
                <span class="keyword">val</span> <a title="Int" id="861385">offset</a> = <a href="#860984" title="(start: Int)Int">instrumentPos</a><span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; ScratchPadMaker.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409671" title="=&gt; Int">start</a><span class="delimiter">)</span>
                <a href="#860965" title="=&gt; scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch]">patches</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: ScratchPadMaker.this.Patch)Patcher.this.patches.type">+=</a> <a href="#863547" title="(offset: Int, text: String)ScratchPadMaker.this.Patch">Patch</a><span class="delimiter">(</span><a href="#861385" title="Int">offset</a>, <span title="String(&quot;val &quot;)" class="string">&quot;val &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#861383" title="String">resName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; = &quot;)" class="string">&quot; = &quot;</span><span class="delimiter">)</span>
                <a href="#860986" title="(expr: ScratchPadMaker.this.Tree)Unit">addSandbox</a><span class="delimiter">(</span><a href="#861258" title="ScratchPadMaker.this.Tree">stat</a><span class="delimiter">)</span>
                <a href="#860967" title="=&gt; scala.collection.mutable.ArrayBuffer[String]">toPrint</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: String)Patcher.this.toPrint.type">+=</a> <a href="#860987" title="(prefix: String, expr: String)String">resultString</a><span class="delimiter">(</span><a href="#860976" title="(name: String, tpe: ScratchPadMaker.this.Type)String">nameType</a><span class="delimiter">(</span><a href="#861384" title="String">dispResName</a>, <a href="#861258" title="ScratchPadMaker.this.Tree">stat</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; ScratchPadMaker.this.Type">tpe</a><span class="delimiter">)</span>, <a href="#861383" title="String">resName</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: ScratchPadMaker.this.Tree)Unit" id="860989">traverse</a><span class="delimiter">(</span><a title="ScratchPadMaker.this.Tree" id="861372">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="ScratchPadMaker.this.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> = <a href="#861372" title="ScratchPadMaker.this.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> PackageDef<a href="#3331872" title="Unit" id="3331876" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410345" title="ScratchPadMaker.this.RefTree" id="3331873">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410347" title="List[ScratchPadMaker.this.Tree]" id="3331874">_</a><span class="delimiter">)</span> =&gt;
        <a href="#633545" title="ScratchPadMaker.this.Patcher" class="keyword">super</a>.<a href="../../../reflect/api/Trees.scala.html#405544" title="(tree: ScratchPadMaker.this.Tree)Unit">traverse</a><a href="#3331884" title="(x: Unit)Unit" class="delimiter">(</a><a href="#861372" title="ScratchPadMaker.this.Tree">tree</a><span class="delimiter">)</span>
      <span class="keyword">case</span> ModuleDef<a href="#3331872" title="Unit" id="3331880" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410316" title="ScratchPadMaker.this.Modifiers" id="3331877">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410318" title="ScratchPadMaker.this.TermName" id="861525">name</a>, Template<a href="../../../reflect/internal/Trees.scala.html#410320" title="ScratchPadMaker.this.Template" id="3331878" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410203" title="List[ScratchPadMaker.this.Tree]" id="3331881">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410205" title="ScratchPadMaker.this.ValDef" id="3331882">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410207" title="List[ScratchPadMaker.this.Tree]" id="861537">body</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="Boolean" id="861538">topLevel</a> = <a href="#860963" title="=&gt; String">objectName</a>.<span title="()Boolean">isEmpty</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#861538" title="Boolean">topLevel</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#860963" title="(x$1: String)Unit">objectName</a> = <a href="#861372" title="ScratchPadMaker.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; ScratchPadMaker.this.Symbol">symbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#411334" title="=&gt; String">fullName</a>
          <a href="#861537" title="List[ScratchPadMaker.this.Tree]">body</a> <a href="../../../collection/immutable/List.scala.html#62719" title="(f: ScratchPadMaker.this.Tree =&gt; Any)Unit">foreach</a> <a href="#860988" title="(stat: ScratchPadMaker.this.Tree)Any">traverseStat</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#860970" title="=&gt; Int">skipped</a> <a href="../../../Int.scala.html#57104" title="(x: Int)Boolean">!=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span> // don't issue prologue and epilogue if there are no instrumented statements
            <a href="#860983" title="(offset: Int)Unit">applyPendingPatches</a><span class="delimiter">(</span><a href="#860970" title="=&gt; Int">skipped</a><span class="delimiter">)</span>
            <a href="#860965" title="=&gt; scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch]">patches</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: ScratchPadMaker.this.Patch)Patcher.this.patches.type">+=</a> <a href="#863547" title="(offset: Int, text: String)ScratchPadMaker.this.Patch">Patch</a><span class="delimiter">(</span><a href="#860970" title="=&gt; Int">skipped</a>, <a href="#860981" title="=&gt; String">epilogue</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> _ =&gt;
    <span class="delimiter">}</span>

    /** The patched text.
     *  @require  traverse is run first
     */
    <span class="keyword">def</span> <a title="=&gt; Array[Char]" id="860990">result</a>: <a href="../../../Array.scala.html#174" title="Array[Char]">Array</a><span class="delimiter">[</span>Char<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="861578">reslen</a> = <a href="#861021" title="Array[Char]">contents</a>.<a href="../../../Array.scala.html#56638" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span class="delimiter">(</span><a href="#860965" title="=&gt; scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch]">patches</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: ScratchPadMaker.this.Patch =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.mutable.ArrayBuffer[ScratchPadMaker.this.Patch],Int,scala.collection.mutable.ArrayBuffer[Int]])scala.collection.mutable.ArrayBuffer[Int]">map</a> <span class="delimiter">(</span><a href="#861603" title="ScratchPadMaker.this.Patch">_</a>.<a href="#861138" title="=&gt; String">text</a>.<span title="()Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../collection/TraversableOnce.scala.html#58232" title="(implicit num: Numeric[Int])Int">sum</a>
      <span class="keyword">val</span> <a title="Array[Char]" id="861579">res</a> = <a href="../../../Array.scala.html#175" title="Array.type">Array</a>.<a href="../../../Array.scala.html#72272" title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassTag[T])Array[T]">ofDim</a><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassTag[Char])Array[Char]" class="delimiter">[</span><a href="../../../Char.scala.html#822" title="Char">Char</a><span class="delimiter">]</span><a href="../../../reflect/ClassTag.scala.html#81025" title="=&gt; scala.reflect.ClassTag[Char]" class="delimiter">(</a><a href="#861578" title="Int">reslen</a><span class="delimiter">)</span>
      <span class="keyword">var</span> <a title="Int" id="861580">lastOffset</a> = <span title="Int(0)" class="int">0</span>
      <span class="keyword">var</span> <a title="Int" id="861581">from</a> = <span title="Int(0)" class="int">0</span>
      <span class="keyword">var</span> <a title="Int" id="861582">to</a> = <span title="Int(0)" class="int">0</span>
      <span class="keyword">for</span> <span class="delimiter">(</span>Patch<span class="delimiter">(</span><a href="#861137" title="Int" id="861695">offset</a>, <a href="#861138" title="String" id="861696">text</a><span class="delimiter">)</span> &lt;- <a href="../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: ScratchPadMaker.this.Patch =&gt; Unit)Unit">patches</a><span class="delimiter">)</span> <a href="#3331899" title="(x: Unit)Unit" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="Int" id="861697">delta</a> = <a href="#861695" title="Int">offset</a> <a href="../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <a href="#861580" title="Int">lastOffset</a>
        <a href="../Global.scala.html#537498" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#861697" title="Int">delta</a> <a href="../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        <a href="../../../Array.scala.html#175" title="Array.type">Array</a>.<a href="../../../Array.scala.html#72256" title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</a><span class="delimiter">(</span><a href="#861021" title="Array[Char]">contents</a>, <a href="#861581" title="Int">from</a>, <a href="#861579" title="Array[Char]">res</a>, <a href="#861582" title="Int">to</a>, <a href="#861697" title="Int">delta</a><span class="delimiter">)</span>
        <a href="#861581" title="Int">from</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <a href="#861697" title="Int">delta</a>
        <a href="#861582" title="Int">to</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <a href="#861697" title="Int">delta</a>
        <a href="#861580" title="Int">lastOffset</a> = <a href="#861695" title="Int">offset</a>
        <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">text</a>.<a href="../../../collection/TraversableOnce.scala.html#58253" title="(xs: Array[Char], start: Int)Unit">copyToArray</a><span class="delimiter">(</span><a href="#861579" title="Array[Char]">res</a>, <a href="#861582" title="Int">to</a><span class="delimiter">)</span>
        <a href="#861582" title="Int">to</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <a href="#861696" title="String">text</a>.<span title="()Int">length</span>
      <span class="delimiter">}</span>
      <a href="../Global.scala.html#537498" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#861021" title="Array[Char]">contents</a>.<a href="../../../Array.scala.html#56638" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <a href="#861581" title="Int">from</a> <a href="../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#861578" title="Int">reslen</a> <a href="../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <a href="#861582" title="Int">to</a><span class="delimiter">)</span>
      <a href="../../../Array.scala.html#175" title="Array.type">Array</a>.<a href="../../../Array.scala.html#72256" title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</a><span class="delimiter">(</span><a href="#861021" title="Array[Char]">contents</a>, <a href="#861581" title="Int">from</a>, <a href="#861579" title="Array[Char]">res</a>, <a href="#861582" title="Int">to</a>, <a href="#861021" title="Array[Char]">contents</a>.<a href="../../../Array.scala.html#56638" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <a href="#861581" title="Int">from</a><span class="delimiter">)</span>
      <a href="#861579" title="Array[Char]">res</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class LexicalStructure extends Object" id="633546">LexicalStructure</a><a href="#633546" title="ScratchPadMaker.this.LexicalStructure" class="delimiter">(</a><a title="scala.reflect.internal.util.SourceFile" id="863423">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[Int]" id="861012">token</a> = <a href="../../../collection/mutable/ArrayBuffer.scala.html#66876" title="()scala.collection.mutable.ArrayBuffer[Int]" class="keyword">new</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#12792" title="scala.collection.mutable.ArrayBuffer[Int]">ArrayBuffer</a><span class="delimiter">[</span>Int<span class="delimiter">]</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[Int]" id="861014">startOffset</a> = <a href="../../../collection/mutable/ArrayBuffer.scala.html#66876" title="()scala.collection.mutable.ArrayBuffer[Int]" class="keyword">new</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#12792" title="scala.collection.mutable.ArrayBuffer[Int]">ArrayBuffer</a><span class="delimiter">[</span>Int<span class="delimiter">]</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[Int]" id="861016">endOffset</a> = <a href="../../../collection/mutable/ArrayBuffer.scala.html#66876" title="()scala.collection.mutable.ArrayBuffer[Int]" class="keyword">new</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#12792" title="scala.collection.mutable.ArrayBuffer[Int]">ArrayBuffer</a><span class="delimiter">[</span>Int<span class="delimiter">]</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="ScratchPadMaker.this.syntaxAnalyzer.UnitScanner" id="861018">scanner</a> = <a href="../ast/parser/Scanners.scala.html#627964" title="(unit: ScratchPadMaker.this.syntaxAnalyzer.global.CompilationUnit)ScratchPadMaker.this.syntaxAnalyzer.UnitScanner" class="keyword">new</a> <a href="../Global.scala.html#537548" title="ScratchPadMaker.this.syntaxAnalyzer.type">syntaxAnalyzer</a>.<a href="../ast/parser/Scanners.scala.html#621045" title="ScratchPadMaker.this.syntaxAnalyzer.UnitScanner">UnitScanner</a><span class="delimiter">(</span><span title="ScratchPadMaker.this.CompilationUnit" class="keyword">new</span> <a href="../CompilationUnits.scala.html#537766" title="ScratchPadMaker.this.CompilationUnit">CompilationUnit</a><span class="delimiter">(</span><a href="#863423" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#861018" title="=&gt; ScratchPadMaker.this.syntaxAnalyzer.UnitScanner">scanner</a>.<a href="../ast/parser/Scanners.scala.html#627946" title="()Unit">init</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#861018" title="=&gt; ScratchPadMaker.this.syntaxAnalyzer.UnitScanner">scanner</a>.<a href="../ast/parser/Scanners.scala.html#627982" title="=&gt; Int">token</a> <a href="../../../Int.scala.html#57104" title="(x: Int)Boolean">!=</a> <span title="Int(0)">EOF</span><span class="delimiter">)</span> <a href="#863424" title="()Unit" class="delimiter">{</a>
      <a href="#861014" title="=&gt; scala.collection.mutable.ArrayBuffer[Int]">startOffset</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: Int)LexicalStructure.this.startOffset.type">+=</a> <a href="#861018" title="=&gt; ScratchPadMaker.this.syntaxAnalyzer.UnitScanner">scanner</a>.<a href="../ast/parser/Scanners.scala.html#627985" title="=&gt; ScratchPadMaker.this.syntaxAnalyzer.Offset">offset</a>
      <a href="#861012" title="=&gt; scala.collection.mutable.ArrayBuffer[Int]">token</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: Int)LexicalStructure.this.token.type">+=</a> <a href="#861018" title="=&gt; ScratchPadMaker.this.syntaxAnalyzer.UnitScanner">scanner</a>.<a href="../ast/parser/Scanners.scala.html#627982" title="=&gt; Int">token</a>
      <a href="#861018" title="=&gt; ScratchPadMaker.this.syntaxAnalyzer.UnitScanner">scanner</a>.<a href="../ast/parser/Scanners.scala.html#627910" title="()Unit">nextToken</a>
      <a href="#861016" title="=&gt; scala.collection.mutable.ArrayBuffer[Int]">endOffset</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#66880" title="(elem: Int)LexicalStructure.this.endOffset.type">+=</a> <a href="#861018" title="=&gt; ScratchPadMaker.this.syntaxAnalyzer.UnitScanner">scanner</a>.<a href="../ast/parser/Scanners.scala.html#627988" title="=&gt; ScratchPadMaker.this.syntaxAnalyzer.Offset">lastOffset</a>
    <span class="delimiter">}</span>

    /** @return token that starts before or at offset, its startOffset, its endOffset
     */
    <span class="keyword">def</span> <a title="(offset: Int)(Int, Int, Int)" id="861020">locate</a><span class="delimiter">(</span><a title="Int" id="861183">offset</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <a href="../../../Tuple3.scala.html#126" title="(Int, Int, Int)" class="delimiter">(</a>Int, Int, Int<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="863457">lo</a> = <span title="Int(0)" class="int">0</span>
      <span class="keyword">var</span> <a title="Int" id="863458">hi</a> = <a href="#861012" title="=&gt; scala.collection.mutable.ArrayBuffer[Int]">token</a>.<a href="../../../collection/mutable/ResizableArray.scala.html#67018" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#863457" title="Int">lo</a> <a href="../../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="#863458" title="Int">hi</a><span class="delimiter">)</span> <a href="#863459" title="()Unit" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="Int" id="863468">mid</a> = <span class="delimiter">(</span><a href="#863457" title="Int">lo</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+</a> <a href="#863458" title="Int">hi</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="../../../Int.scala.html#57175" title="(x: Int)Int">/</a> <span title="Int(2)" class="int">2</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#67019" title="(idx: Int)Int">startOffset</a><span class="delimiter">(</span><a href="#863468" title="Int">mid</a><span class="delimiter">)</span> <a href="../../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <a href="#861183" title="Int">offset</a><span class="delimiter">)</span> <a href="#863457" title="Int">lo</a> = <a href="#863468" title="Int">mid</a>
        <span class="keyword">else</span> <a href="#863458" title="Int">hi</a> = <a href="#863468" title="Int">mid</a> <a href="../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
      <span class="delimiter">}</span>
      <a href="../../../Tuple3.scala.html#63169" title="(_1: Int, _2: Int, _3: Int)(Int, Int, Int)" class="delimiter">(</a><a href="../../../collection/mutable/ResizableArray.scala.html#67019" title="(idx: Int)Int">token</a><span class="delimiter">(</span><a href="#863457" title="Int">lo</a><span class="delimiter">)</span>, <a href="../../../collection/mutable/ResizableArray.scala.html#67019" title="(idx: Int)Int">startOffset</a><span class="delimiter">(</span><a href="#863457" title="Int">lo</a><span class="delimiter">)</span>, <a href="../../../collection/mutable/ResizableArray.scala.html#67019" title="(idx: Int)Int">endOffset</a><span class="delimiter">(</span><a href="#863457" title="Int">lo</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Compute an instrumented version of a sourcefile.
   *  @param source  The given sourcefile.
   *  @param line    The line up to which results should be printed, -1 = whole document.
   *  @return        A pair consisting of
   *                  - the fully qualified name of the first top-level object definition in the file.
   *                    or &quot;&quot; if there are no object definitions.
   *                  - the text of the instrumented program which, when run,
   *                    prints its output and all defined values in a comment column.
   */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile, line: Int)(String, Array[Char])" id="633547">instrument</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="847637">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a>, <a title="Int" id="847638">line</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <a href="../../../Tuple2.scala.html#783" title="(String, Array[Char])" class="delimiter">(</a>String, Array<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ScratchPadMaker.this.Tree" id="863526">tree</a> = <a href="Global.scala.html#633384" title="(source: scala.reflect.internal.util.SourceFile, forceReload: Boolean)ScratchPadMaker.this.Tree">typedTree</a><span class="delimiter">(</span><a href="#847637" title="scala.reflect.internal.util.SourceFile">source</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="863527">endOffset</a> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#847638" title="Int">line</a> <a href="../../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#847637" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403757" title="=&gt; Int">length</a> <span class="keyword">else</span> <a href="#847637" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403761" title="(index: Int)Int">lineToOffset</a><span class="delimiter">(</span><a href="#847638" title="Int">line</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ScratchPadMaker.this.Patcher" id="863528">patcher</a> = <span title="ScratchPadMaker.this.Patcher" class="keyword">new</span> <a href="#633545" title="ScratchPadMaker.this.Patcher">Patcher</a><span class="delimiter">(</span><a href="#847637" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403753" title="=&gt; Array[Char]">content</a>, <span title="ScratchPadMaker.this.LexicalStructure" class="keyword">new</span> <a href="#633546" title="ScratchPadMaker.this.LexicalStructure">LexicalStructure</a><span class="delimiter">(</span><a href="#847637" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span>, <a href="#863527" title="Int">endOffset</a><span class="delimiter">)</span>
    <a href="#863528" title="ScratchPadMaker.this.Patcher">patcher</a>.<a href="#860989" title="(tree: ScratchPadMaker.this.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#863526" title="ScratchPadMaker.this.Tree">tree</a><span class="delimiter">)</span>
    <a href="../../../Tuple2.scala.html#62849" title="(_1: String, _2: Array[Char])(String, Array[Char])" class="delimiter">(</a><a href="#863528" title="ScratchPadMaker.this.Patcher">patcher</a>.<a href="#860963" title="=&gt; String">objectName</a>, <a href="#863528" title="ScratchPadMaker.this.Patcher">patcher</a>.<a href="#860990" title="=&gt; Array[Char]">result</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
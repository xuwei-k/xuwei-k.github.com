<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/interactive/Global.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2009-2013 Typesafe/Scala Solutions and LAMP/EPFL
 * @author Martin Odersky
 */
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interactive

<span class="keyword">import</span> java.io.<span class="delimiter">{</span> PrintWriter, StringWriter, FileReader, FileWriter <span class="delimiter">}</span>
<span class="keyword">import</span> scala.collection.mutable
<span class="keyword">import</span> mutable.<span class="delimiter">{</span>LinkedHashMap, SynchronizedMap, HashSet, SynchronizedSet<span class="delimiter">}</span>
<span class="keyword">import</span> scala.concurrent.SyncVar
<span class="keyword">import</span> scala.util.control.ControlThrowable
<span class="keyword">import</span> scala.tools.nsc.io.<span class="delimiter">{</span> AbstractFile, LogReplay, Logger, NullLogger, Replayer <span class="delimiter">}</span>
<span class="keyword">import</span> scala.tools.nsc.util.<span class="delimiter">{</span> WorkScheduler, MultiHashMap <span class="delimiter">}</span>
<span class="keyword">import</span> scala.reflect.internal.util.<span class="delimiter">{</span> SourceFile, BatchSourceFile, Position, RangePosition, NoPosition <span class="delimiter">}</span>
<span class="keyword">import</span> scala.tools.nsc.reporters._
<span class="keyword">import</span> scala.tools.nsc.symtab._
<span class="keyword">import</span> scala.tools.nsc.ast._
<span class="keyword">import</span> scala.tools.nsc.io.<a href="../io/Pickler.scala.html#40018" title="scala.tools.nsc.io.Pickler.type">Pickler</a>._
<span class="keyword">import</span> scala.tools.nsc.typechecker.DivergentImplicit
<span class="keyword">import</span> scala.annotation.tailrec
<span class="keyword">import</span> symtab.<a href="../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.<span class="delimiter">{</span>ACCESSOR, PARAMACCESSOR<span class="delimiter">}</span>
<span class="keyword">import</span> scala.<a href="../../../language.scala.html#1423" title="language.type">language</a>.implicitConversions

/** The main class of the presentation compiler in an interactive environment such as an IDE
 */
<span class="keyword">class</span> <a title="class Global extends scala.tools.nsc.Global with scala.tools.nsc.interactive.CompilerControl with scala.tools.nsc.interactive.RangePositions with scala.tools.nsc.interactive.ContextTrees with scala.tools.nsc.interactive.RichCompilationUnits with scala.tools.nsc.interactive.ScratchPadMaker with scala.tools.nsc.interactive.Picklers" id="35890">Global</a><a href="#35890" title="scala.tools.nsc.interactive.Global" class="delimiter">(</a><a title="scala.tools.nsc.Settings" id="633594">settings</a>: <a href="../Settings.scala.html#27643" title="scala.tools.nsc.Settings">Settings</a>, <a title="scala.tools.nsc.reporters.Reporter" id="633595">_reporter</a>: <a href="../reporters/Reporter.scala.html#41226" title="scala.tools.nsc.reporters.Reporter">Reporter</a>, <a title="String" id="633598">projectName</a>: <span title="String">String</span> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> scala.tools.nsc.<a href="../Global.scala.html#27346" title="scala.tools.nsc.Global">Global</a><span class="delimiter">(</span><a href="#633594" title="scala.tools.nsc.Settings">settings</a>, <a href="#633595" title="scala.tools.nsc.reporters.Reporter">_reporter</a><span class="delimiter">)</span>
     <span class="keyword">with</span> <a href="CompilerControl.scala.html#35751" title="scala.tools.nsc.interactive.CompilerControl">CompilerControl</a>
     <span class="keyword">with</span> <a href="RangePositions.scala.html#35922" title="scala.tools.nsc.interactive.RangePositions">RangePositions</a>
     <span class="keyword">with</span> <a href="ContextTrees.scala.html#36396" title="scala.tools.nsc.interactive.ContextTrees">ContextTrees</a>
     <span class="keyword">with</span> <a href="RichCompilationUnits.scala.html#36258" title="scala.tools.nsc.interactive.RichCompilationUnits">RichCompilationUnits</a>
     <span class="keyword">with</span> <a href="ScratchPadMaker.scala.html#36321" title="scala.tools.nsc.interactive.ScratchPadMaker">ScratchPadMaker</a>
     <span class="keyword">with</span> <a href="Picklers.scala.html#36357" title="scala.tools.nsc.interactive.Picklers">Picklers</a> <span class="delimiter">{</span>

  <span class="keyword">import</span> <a href="../../../reflect/internal/Definitions.scala.html#407777" title="Global.this.definitions.type">definitions</a>._

  <span class="keyword">val</span> <a title="Boolean" id="633264">debugIDE</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <a href="#633594" title="scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#540172" title="=&gt; Global.this.settings.BooleanSetting">YpresentationDebug</a>.<a href="../settings/MutableSettings.scala.html#541066" title="=&gt; Boolean">value</a>
  <span class="keyword">val</span> <a title="Boolean" id="633266">verboseIDE</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <a href="#633594" title="scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#540170" title="=&gt; Global.this.settings.BooleanSetting">YpresentationVerbose</a>.<a href="../settings/MutableSettings.scala.html#541066" title="=&gt; Boolean">value</a>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Global.this.settings.YpresentationReplay.T" id="633268">replayName</a> = <a href="#633594" title="scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#540178" title="=&gt; Global.this.settings.StringSetting">YpresentationReplay</a>.<a href="../../../reflect/internal/settings/MutableSettings.scala.html#423752" title="=&gt; Global.this.settings.YpresentationReplay.T">value</a>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Global.this.settings.YpresentationLog.T" id="633269">logName</a> = <a href="#633594" title="scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#540176" title="=&gt; Global.this.settings.StringSetting">YpresentationLog</a>.<a href="../../../reflect/internal/settings/MutableSettings.scala.html#423752" title="=&gt; Global.this.settings.YpresentationLog.T">value</a>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Int" id="633270">afterTypeDelay</a> = <a href="#633594" title="scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#540180" title="=&gt; Global.this.settings.IntSetting">YpresentationDelay</a>.<a href="../settings/MutableSettings.scala.html#593041" title="=&gt; Int">value</a>
  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(10)" id="633271">SleepTime</a> = <span title="Int(10)" class="int">10</span>

  <span class="keyword">val</span> <a title="scala.tools.nsc.io.LogReplay" id="633273">log</a> =
    <span title="scala.tools.nsc.io.LogReplay" class="keyword">if</span> <span class="delimiter">(</span><a href="#633268" title="=&gt; Global.this.settings.YpresentationReplay.T">replayName</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span title="scala.tools.nsc.io.Replayer" class="keyword">new</span> <a href="../io/Replayer.scala.html#40023" title="scala.tools.nsc.io.Replayer">Replayer</a><span class="delimiter">(</span><span title="java.io.FileReader" class="keyword">new</span> <span title="java.io.FileReader">FileReader</span><span class="delimiter">(</span><a href="#633268" title="=&gt; Global.this.settings.YpresentationReplay.T">replayName</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="scala.tools.nsc.io.LogReplay" class="keyword">if</span> <span class="delimiter">(</span><a href="#633269" title="=&gt; Global.this.settings.YpresentationLog.T">logName</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span title="scala.tools.nsc.io.Logger" class="keyword">new</span> <a href="../io/Replayer.scala.html#39933" title="scala.tools.nsc.io.Logger">Logger</a><span class="delimiter">(</span><span title="java.io.FileWriter" class="keyword">new</span> <span title="java.io.FileWriter">FileWriter</span><span class="delimiter">(</span><a href="#633269" title="=&gt; Global.this.settings.YpresentationLog.T">logName</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="../io/Replayer.scala.html#39799" title="scala.tools.nsc.io.NullLogger.type">NullLogger</a>

  <span class="keyword">import</span> <a href="#633273" title="=&gt; scala.tools.nsc.io.LogReplay">log</a>.logreplay
  <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;logger: &quot;)" class="string">&quot;logger: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#633273" title="=&gt; scala.tools.nsc.io.LogReplay">log</a>.<span title="()Class[_]">getClass</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; writing to &quot;)" class="string">&quot; writing to &quot;</span> <span title="(x$1: Any)String">+</span> <span class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> java.io.<span title="java.io.File">File</span><span class="delimiter">(</span><a href="#633269" title="=&gt; Global.this.settings.YpresentationLog.T">logName</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="()String">getAbsolutePath</span><span class="delimiter">)</span>
  <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;classpath: &quot;)" class="string">&quot;classpath: &quot;</span><span title="(x$1: Any)String">+</span><a href="../Global.scala.html#537458" title="=&gt; Global.this.PlatformClassPath">classPath</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Long" id="633277">curTime</a> = <span title="System.type">System</span>.<span title="()Long">nanoTime</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; String" id="633279">timeStep</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Long" id="848893">last</a> = <a href="#633277" title="=&gt; Long">curTime</a>
    <a href="#633277" title="(x$1: Long)Unit">curTime</a> = <span title="System.type">System</span>.<span title="()Long">nanoTime</span>
    <span title="String(&quot;, delay = &quot;)" class="string">&quot;, delay = &quot;</span> <span title="(x$1: Any)String">+</span> <span class="delimiter">(</span><a href="#633277" title="=&gt; Long">curTime</a> <a href="../../../Long.scala.html#57528" title="(x: Long)Long">-</a> <a href="#848893" title="Long">last</a><span class="delimiter">)</span> <a href="../../../Long.scala.html#57541" title="(x: Int)Long">/</a> <span title="Int(1000000)" class="int">1000000</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;ms&quot;)" class="string">&quot;ms&quot;</span>
  <span class="delimiter">}</span>

  /** Print msg only when debugIDE is true. */
  @inline <span class="keyword">final</span> <span class="keyword">def</span> <a title="(msg: =&gt; String)Unit" id="633280">debugLog</a><span class="delimiter">(</span><a title="=&gt; String" id="846033">msg</a>: =&gt; String<span class="delimiter">)</span> =
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633264" title="=&gt; Boolean">debugIDE</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;[%s] %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#633598" title="String">projectName</a>, <a href="#846033" title="=&gt; String">msg</a><span class="delimiter">)</span><span class="delimiter">)</span>

  /** Inform with msg only when verboseIDE is true. */
  @inline <span class="keyword">final</span> <span class="keyword">def</span> <a title="(msg: =&gt; String)Unit" id="633281">informIDE</a><span class="delimiter">(</span><a title="=&gt; String" id="848902">msg</a>: =&gt; String<span class="delimiter">)</span> =
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633266" title="=&gt; Boolean">verboseIDE</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;[%s][%s]&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#633598" title="String">projectName</a>, <a href="#848902" title="=&gt; String">msg</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="633282">forInteractive</a> = <span title="Boolean(true)" class="keyword">true</span>

  /** A map of all loaded files to the rich compilation units that correspond to them.
   */
  <span class="keyword">val</span> <a title="unitOfFile extends scala.collection.mutable.LinkedHashMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit] with scala.collection.mutable.SynchronizedMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit]" id="633283">unitOfFile</a> = <a href="#845955" title="scala.collection.mutable.LinkedHashMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit] with scala.collection.mutable.SynchronizedMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit]" class="keyword">new</a> <a title="anonymous class $anon extends scala.collection.mutable.LinkedHashMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit] with scala.collection.mutable.SynchronizedMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit]" id="845955">LinkedHashMap</a><span class="delimiter">[</span>AbstractFile, RichCompilationUnit<span class="delimiter">]</span> <span class="keyword">with</span>
                       <a href="../../../collection/mutable/SynchronizedMap.scala.html#12693" title="scala.collection.mutable.SynchronizedMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit]">SynchronizedMap</a><span class="delimiter">[</span>AbstractFile, RichCompilationUnit<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(key: tools.nsc.io.AbstractFile, value: Global.this.RichCompilationUnit)Option[Global.this.RichCompilationUnit]" id="845957">put</a><span class="delimiter">(</span><a title="tools.nsc.io.AbstractFile" id="845966">key</a>: <a href="../../../reflect/io/AbstractFile.scala.html#23215" title="tools.nsc.io.AbstractFile">AbstractFile</a>, <a title="Global.this.RichCompilationUnit" id="845967">value</a>: <a href="RichCompilationUnits.scala.html#633538" title="Global.this.RichCompilationUnit">RichCompilationUnit</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Option[Global.this.RichCompilationUnit]" id="846025">r</a> = <a href="#845955" title="scala.collection.mutable.LinkedHashMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit] with scala.collection.mutable.SynchronizedMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit]" class="keyword">super</a>.<a href="../../../collection/mutable/SynchronizedMap.scala.html#299891" title="(key: tools.nsc.io.AbstractFile, value: Global.this.RichCompilationUnit)Option[Global.this.RichCompilationUnit]">put</a><span class="delimiter">(</span><a href="#845966" title="tools.nsc.io.AbstractFile">key</a>, <a href="#845967" title="Global.this.RichCompilationUnit">value</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#846025" title="Option[Global.this.RichCompilationUnit]">r</a>.<a href="../../../Option.scala.html#62856" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;added unit for &quot;)" class="string">&quot;added unit for &quot;</span><span title="(x$1: Any)String">+</span><a href="#845966" title="tools.nsc.io.AbstractFile">key</a><span class="delimiter">)</span>
      <a href="#846025" title="Option[Global.this.RichCompilationUnit]">r</a>
    <span class="delimiter">}</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(key: tools.nsc.io.AbstractFile)Option[Global.this.RichCompilationUnit]" id="845958">remove</a><span class="delimiter">(</span><a title="tools.nsc.io.AbstractFile" id="846371">key</a>: <a href="../../../reflect/io/AbstractFile.scala.html#23215" title="tools.nsc.io.AbstractFile">AbstractFile</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Option[Global.this.RichCompilationUnit]" id="846382">r</a> = <a href="#845955" title="scala.collection.mutable.LinkedHashMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit] with scala.collection.mutable.SynchronizedMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit]" class="keyword">super</a>.<a href="../../../collection/mutable/SynchronizedMap.scala.html#299893" title="(key: tools.nsc.io.AbstractFile)Option[Global.this.RichCompilationUnit]">remove</a><span class="delimiter">(</span><a href="#846371" title="tools.nsc.io.AbstractFile">key</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#846382" title="Option[Global.this.RichCompilationUnit]">r</a>.<a href="../../../Option.scala.html#62879" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;removed unit for &quot;)" class="string">&quot;removed unit for &quot;</span><span title="(x$1: Any)String">+</span><a href="#846371" title="tools.nsc.io.AbstractFile">key</a><span class="delimiter">)</span>
      <a href="#846382" title="Option[Global.this.RichCompilationUnit]">r</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** A set containing all those files that need to be removed
   *  Units are removed by getUnit, typically once a unit is finished compiled.
   */
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="scala.collection.mutable.Set[tools.nsc.io.AbstractFile]" id="633285">toBeRemoved</a>: mutable.<a href="../../../collection/mutable/Set.scala.html#13128" title="scala.collection.mutable.Set[tools.nsc.io.AbstractFile]">Set</a><span class="delimiter">[</span>AbstractFile<span class="delimiter">]</span> =
    <a href="#848913" title="scala.collection.mutable.HashSet[tools.nsc.io.AbstractFile] with scala.collection.mutable.SynchronizedSet[tools.nsc.io.AbstractFile]" class="keyword">new</a> <a href="../../../collection/mutable/HashSet.scala.html#125959" title="anonymous class $anon extends scala.collection.mutable.HashSet[tools.nsc.io.AbstractFile] with scala.collection.mutable.SynchronizedSet[tools.nsc.io.AbstractFile]" id="848913">HashSet</a><span class="delimiter">[</span>AbstractFile<span class="delimiter">]</span> <span class="keyword">with</span> <a href="../../../collection/mutable/SynchronizedSet.scala.html#13317" title="scala.collection.mutable.SynchronizedSet[tools.nsc.io.AbstractFile]">SynchronizedSet</a><span class="delimiter">[</span>AbstractFile<span class="delimiter">]</span>

  /** A set containing all those files that need to be removed after a full background compiler run
   */
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="scala.collection.mutable.Set[tools.nsc.io.AbstractFile]" id="633287">toBeRemovedAfterRun</a>: mutable.<a href="../../../collection/mutable/Set.scala.html#13128" title="scala.collection.mutable.Set[tools.nsc.io.AbstractFile]">Set</a><span class="delimiter">[</span>AbstractFile<span class="delimiter">]</span> =
    <a href="#849312" title="scala.collection.mutable.HashSet[tools.nsc.io.AbstractFile] with scala.collection.mutable.SynchronizedSet[tools.nsc.io.AbstractFile]" class="keyword">new</a> <a href="../../../collection/mutable/HashSet.scala.html#125959" title="anonymous class $anon extends scala.collection.mutable.HashSet[tools.nsc.io.AbstractFile] with scala.collection.mutable.SynchronizedSet[tools.nsc.io.AbstractFile]" id="849312">HashSet</a><span class="delimiter">[</span>AbstractFile<span class="delimiter">]</span> <span class="keyword">with</span> <a href="../../../collection/mutable/SynchronizedSet.scala.html#13317" title="scala.collection.mutable.SynchronizedSet[tools.nsc.io.AbstractFile]">SynchronizedSet</a><span class="delimiter">[</span>AbstractFile<span class="delimiter">]</span>

  <span class="keyword">class</span> <a title="class ResponseMap extends scala.tools.nsc.util.MultiHashMap[scala.reflect.internal.util.SourceFile,Global.this.Response[Global.this.Tree]]" id="633289">ResponseMap</a> <a href="#633289" title="Global.this.ResponseMap" class="keyword">extends</a> <a href="../util/MultiHashMap.scala.html#49990" title="scala.tools.nsc.util.MultiHashMap[scala.reflect.internal.util.SourceFile,Global.this.Response[Global.this.Tree]]">MultiHashMap</a><span class="delimiter">[</span>SourceFile, Response<span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(binding: (scala.reflect.internal.util.SourceFile, Set[Global.this.Response[Global.this.Tree]]))ResponseMap.this.type" id="848807">+=</a> <span class="delimiter">(</span><a title="(scala.reflect.internal.util.SourceFile, Set[Global.this.Response[Global.this.Tree]])" id="849709">binding</a>: <a href="../../../Tuple2.scala.html#783" title="(scala.reflect.internal.util.SourceFile, Set[Global.this.Response[Global.this.Tree]])" class="delimiter">(</a>SourceFile, Set<span class="delimiter">[</span>Response<span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#633324" title="=&gt; Boolean">interruptsEnabled</a>, <span title="String(&quot;delayed operation within an ask&quot;)" class="string">&quot;delayed operation within an ask&quot;</span><span class="delimiter">)</span>
      <a href="#633289" title="Global.this.ResponseMap" class="keyword">super</a>.<a href="../../../collection/mutable/HashMap.scala.html#88250" title="(kv: (scala.reflect.internal.util.SourceFile, scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]]))ResponseMap.this.type">+=</a><span class="delimiter">(</span><a href="#849709" title="(scala.reflect.internal.util.SourceFile, Set[Global.this.Response[Global.this.Tree]])">binding</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** A map that associates with each abstract file the set of responses that are waiting
   *  (via waitLoadedTyped) for the unit associated with the abstract file to be loaded and completely typechecked.
   */
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Global.this.ResponseMap" id="633290">waitLoadedTypeResponses</a> = <span title="Global.this.ResponseMap" class="keyword">new</span> <a href="#633289" title="Global.this.ResponseMap">ResponseMap</a>

  /** A map that associates with each abstract file the set of responses that ware waiting
   *  (via build) for the unit associated with the abstract file to be parsed and entered
   */
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="Global.this.ResponseMap" id="633293">getParsedEnteredResponses</a> = <span title="Global.this.ResponseMap" class="keyword">new</span> <a href="#633289" title="Global.this.ResponseMap">ResponseMap</a>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(rmap: Global.this.ResponseMap)Unit" id="633295">cleanResponses</a><span class="delimiter">(</span><a title="Global.this.ResponseMap" id="849749">rmap</a>: <a href="#633289" title="Global.this.ResponseMap">ResponseMap</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> = <span class="delimiter">{</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../../../Tuple2.scala.html#60635" title="scala.reflect.internal.util.SourceFile" id="849777">source</a>, <a href="../../../Tuple2.scala.html#60637" title="scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]]" id="849778">rs</a><span class="delimiter">)</span> &lt;- <a href="#849749" title="Global.this.ResponseMap">rmap</a>.<a href="../../../collection/immutable/List.scala.html#62719" title="(f: ((scala.reflect.internal.util.SourceFile, scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]])) =&gt; Any)Unit">toList</a><span class="delimiter">)</span> <a href="#3330491" title="(x: Any)Any" class="delimiter">{</a>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.Response[Global.this.Tree]" id="849795">r</a> &lt;- <a href="../../../collection/IterableLike.scala.html#58562" title="(f: Global.this.Response[Global.this.Tree] =&gt; Unit)Unit">rs</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633300" title="(s: scala.reflect.internal.util.SourceFile)Option[Global.this.RichCompilationUnit]">getUnit</a><span class="delimiter">(</span><a href="#849777" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span>.<a href="../../../Option.scala.html#62856" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
          <a href="#849795" title="Global.this.Response[Global.this.Tree]">r</a> <a href="Response.scala.html#633702" title="(exc: Throwable)Unit">raise</a> <span title="scala.tools.nsc.interactive.NoSuchUnitError" class="keyword">new</span> <a href="CompilerControl.scala.html#36540" title="scala.tools.nsc.interactive.NoSuchUnitError">NoSuchUnitError</a><span class="delimiter">(</span><a href="#849777" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#849795" title="Global.this.Response[Global.this.Tree]">r</a>.<a href="Response.scala.html#633705" title="=&gt; Boolean">isComplete</a><span class="delimiter">)</span>
          <a href="../../../collection/mutable/HashMap.scala.html#88248" title="(key: scala.reflect.internal.util.SourceFile, value: scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]])Unit">rmap</a><span class="delimiter">(</span><a href="#849777" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span> <a href="../../../collection/SetLike.scala.html#66446" title="(elem: Global.this.Response[Global.this.Tree])scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]]">-=</a> <a href="#849795" title="Global.this.Response[Global.this.Tree]">r</a>
      <span class="delimiter">}</span>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../collection/mutable/HashMap.scala.html#88245" title="(key: scala.reflect.internal.util.SourceFile)scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]]">rmap</a><span class="delimiter">(</span><a href="#849777" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span>.<a href="../../../collection/SetLike.scala.html#66447" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
        <a href="#849749" title="Global.this.ResponseMap">rmap</a> <a href="../../../collection/mutable/HashMap.scala.html#88251" title="(key: scala.reflect.internal.util.SourceFile)rmap.type">-=</a> <a href="#849777" title="scala.reflect.internal.util.SourceFile">source</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="633296">cleanAllResponses</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633295" title="(rmap: Global.this.ResponseMap)Unit">cleanResponses</a><span class="delimiter">(</span><a href="#633290" title="=&gt; Global.this.ResponseMap">waitLoadedTypeResponses</a><span class="delimiter">)</span>
    <a href="#633295" title="(rmap: Global.this.ResponseMap)Unit">cleanResponses</a><span class="delimiter">(</span><a href="#633293" title="=&gt; Global.this.ResponseMap">getParsedEnteredResponses</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(rmap: Global.this.ResponseMap)Unit" id="633297">checkNoOutstanding</a><span class="delimiter">(</span><a title="Global.this.ResponseMap" id="849887">rmap</a>: <a href="#633289" title="Global.this.ResponseMap">ResponseMap</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> =
    <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../../../Tuple2.scala.html#60635" title="scala.reflect.internal.util.SourceFile" id="3330496">_</a>, <a href="../../../Tuple2.scala.html#60637" title="scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]]" id="849915">rs</a><span class="delimiter">)</span> &lt;- <a href="#849887" title="Global.this.ResponseMap">rmap</a>.<a href="../../../collection/immutable/List.scala.html#62719" title="(f: ((scala.reflect.internal.util.SourceFile, scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]])) =&gt; Unit)Unit">toList</a>; <a title="Global.this.Response[Global.this.Tree]" id="849932">r</a> &lt;- <a href="../../../collection/IterableLike.scala.html#58562" title="(f: Global.this.Response[Global.this.Tree] =&gt; Unit)Unit">rs</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;ERROR: missing response, request will be discarded&quot;)" class="string">&quot;ERROR: missing response, request will be discarded&quot;</span><span class="delimiter">)</span>
      <a href="#849932" title="Global.this.Response[Global.this.Tree]">r</a> <a href="Response.scala.html#633702" title="(exc: Throwable)Unit">raise</a> <span title="scala.tools.nsc.interactive.MissingResponse" class="keyword">new</span> <a href="CompilerControl.scala.html#36441" title="scala.tools.nsc.interactive.MissingResponse">MissingResponse</a>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="633298">checkNoResponsesOutstanding</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633297" title="(rmap: Global.this.ResponseMap)Unit">checkNoOutstanding</a><span class="delimiter">(</span><a href="#633290" title="=&gt; Global.this.ResponseMap">waitLoadedTypeResponses</a><span class="delimiter">)</span>
    <a href="#633297" title="(rmap: Global.this.ResponseMap)Unit">checkNoOutstanding</a><span class="delimiter">(</span><a href="#633293" title="=&gt; Global.this.ResponseMap">getParsedEnteredResponses</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** The compilation unit corresponding to a source file
   *  if it does not yet exist create a new one atomically
   *  Note: We want to remove this.
   */
  <span class="keyword">protected</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile)Global.this.RichCompilationUnit" id="633299">getOrCreateUnitOf</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="846487">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a><span class="delimiter">)</span>: <a href="RichCompilationUnits.scala.html#633538" title="Global.this.RichCompilationUnit">RichCompilationUnit</a> =
    <a href="#633283" title="=&gt; scala.collection.mutable.LinkedHashMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit] with scala.collection.mutable.SynchronizedMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit]">unitOfFile</a>.<a href="../../../collection/MapLike.scala.html#87532" title="(key: tools.nsc.io.AbstractFile, default: =&gt; Global.this.RichCompilationUnit)Global.this.RichCompilationUnit">getOrElse</a><span class="delimiter">(</span><a href="#846487" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a>, <span class="delimiter">{</span> <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;precondition violated: &quot;)" class="string">&quot;precondition violated: &quot;</span><span title="(x$1: Any)String">+</span><a href="#846487" title="scala.reflect.internal.util.SourceFile">source</a><span title="(x$1: Any)String">+</span><span title="String(&quot; is not loaded&quot;)" class="string">&quot; is not loaded&quot;</span><span class="delimiter">)</span>; <span title="Exception" class="keyword">new</span> <a href="../../../package.scala.html#55500" title="Exception">Exception</a><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>; <span title="Global.this.RichCompilationUnit" class="keyword">new</span> <a href="RichCompilationUnits.scala.html#633538" title="Global.this.RichCompilationUnit">RichCompilationUnit</a><span class="delimiter">(</span><a href="#846487" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span> <span class="delimiter">}</span><span class="delimiter">)</span>

  /** Work through toBeRemoved list to remove any units.
   *  Then return optionally unit associated with given source.
   */
  <span class="keyword">protected</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(s: scala.reflect.internal.util.SourceFile)Option[Global.this.RichCompilationUnit]" id="633300">getUnit</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="845949">s</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a><span class="delimiter">)</span>: <a href="../../../Option.scala.html#978" title="Option[Global.this.RichCompilationUnit]">Option</a><span class="delimiter">[</span>RichCompilationUnit<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#633285" title="=&gt; scala.collection.mutable.Set[tools.nsc.io.AbstractFile]">toBeRemoved</a>.<span title="(x$1: Unit)Unit">synchronized</span> <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="tools.nsc.io.AbstractFile" id="849978">f</a> &lt;- <a href="../../../collection/IterableLike.scala.html#58562" title="(f: tools.nsc.io.AbstractFile =&gt; Unit)Unit">toBeRemoved</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#633281" title="(msg: =&gt; String)Unit">informIDE</a><span class="delimiter">(</span><span title="String(&quot;removed: &quot;)" class="string">&quot;removed: &quot;</span><span title="(x$1: Any)String">+</span><a href="#845949" title="scala.reflect.internal.util.SourceFile">s</a><span class="delimiter">)</span>
        <a href="#633283" title="=&gt; scala.collection.mutable.LinkedHashMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit] with scala.collection.mutable.SynchronizedMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit]">unitOfFile</a> <a href="../../../collection/mutable/SynchronizedMap.scala.html#299889" title="(key: tools.nsc.io.AbstractFile)scala.tools.nsc.interactive.Global.&lt;refinement&gt;.type">-=</a> <a href="#849978" title="tools.nsc.io.AbstractFile">f</a>
        <a href="#633302" title="(x$1: List[scala.reflect.internal.util.SourceFile])Unit">allSources</a> = <a href="#633302" title="=&gt; List[scala.reflect.internal.util.SourceFile]">allSources</a> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: scala.reflect.internal.util.SourceFile =&gt; Boolean)List[scala.reflect.internal.util.SourceFile]">filter</a> <span class="delimiter">(</span><a href="#849993" title="scala.reflect.internal.util.SourceFile">_</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#849978" title="tools.nsc.io.AbstractFile">f</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#633285" title="=&gt; scala.collection.mutable.Set[tools.nsc.io.AbstractFile]">toBeRemoved</a>.<a href="../../../collection/mutable/SetLike.scala.html#90900" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#633283" title="=&gt; scala.collection.mutable.LinkedHashMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit] with scala.collection.mutable.SynchronizedMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit]">unitOfFile</a> <a href="../../../collection/mutable/SynchronizedMap.scala.html#299886" title="(key: tools.nsc.io.AbstractFile)Option[Global.this.RichCompilationUnit]">get</a> <a href="#845949" title="scala.reflect.internal.util.SourceFile">s</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a>
  <span class="delimiter">}</span>

  /** A list giving all files to be typechecked in the order they should be checked.
   */
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="List[scala.reflect.internal.util.SourceFile]" id="633302">allSources</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[scala.reflect.internal.util.SourceFile]">List</a><span class="delimiter">[</span>SourceFile<span class="delimiter">]</span> = List<a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type" class="delimiter">(</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Option[Throwable]" id="633305">lastException</a>: <a href="../../../Option.scala.html#978" title="Option[Throwable]">Option</a><span class="delimiter">[</span>Throwable<span class="delimiter">]</span> = <a href="../../../Option.scala.html#1585" title="None.type">None</a>

  /** A list of files that crashed the compiler. They will be ignored during background
   *  compilation until they are removed from this list.
   */
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Set[tools.nsc.io.AbstractFile]" id="633308">ignoredFiles</a>: <a href="../../../collection/immutable/Set.scala.html#11919" title="Set[tools.nsc.io.AbstractFile]">Set</a><span class="delimiter">[</span>AbstractFile<span class="delimiter">]</span> = <a href="../../../collection/generic/GenericCompanion.scala.html#59933" title="(elems: tools.nsc.io.AbstractFile*)scala.collection.immutable.Set[tools.nsc.io.AbstractFile]">Set</a><span class="delimiter">(</span><span class="delimiter">)</span>

  /** Flush the buffer of sources that are ignored during background compilation. */
  <span class="keyword">def</span> <a title="()Unit" id="633310">clearIgnoredFiles</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633308" title="(x$1: Set[tools.nsc.io.AbstractFile])Unit">ignoredFiles</a> = <a href="../../../collection/generic/GenericCompanion.scala.html#59933" title="(elems: tools.nsc.io.AbstractFile*)scala.collection.immutable.Set[tools.nsc.io.AbstractFile]">Set</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Remove a crashed file from the ignore buffer. Background compilation will take it into account
   *  and errors will be reported against it. */
  <span class="keyword">def</span> <a title="(file: tools.nsc.io.AbstractFile)Unit" id="633311">enableIgnoredFile</a><span class="delimiter">(</span><a title="tools.nsc.io.AbstractFile" id="847427">file</a>: <a href="../../../reflect/io/AbstractFile.scala.html#23215" title="tools.nsc.io.AbstractFile">AbstractFile</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633308" title="(x$1: Set[tools.nsc.io.AbstractFile])Unit">ignoredFiles</a> <a href="../../../collection/SetLike.scala.html#66446" title="(elem: tools.nsc.io.AbstractFile)scala.collection.immutable.Set[tools.nsc.io.AbstractFile]">-=</a> <a href="#847427" title="tools.nsc.io.AbstractFile">file</a>
    <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Removed crashed file %s. Still in the ignored buffer: %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#847427" title="tools.nsc.io.AbstractFile">file</a>, <a href="#633308" title="=&gt; Set[tools.nsc.io.AbstractFile]">ignoredFiles</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** The currently active typer run */
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Global.this.TyperRun" id="633313">currentTyperRun</a>: <a href="#633403" title="Global.this.TyperRun">TyperRun</a> = _
  <a href="#633404" title="()Unit">newTyperRun</a><span class="delimiter">(</span><span class="delimiter">)</span>

  /** Is a background compiler run needed?
   *  Note: outOfDate is true as long as there is a background compile scheduled or going on.
   */
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Boolean" id="633316">outOfDate</a> = <span title="Boolean(false)" class="keyword">false</span>

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="633318">isOutOfDate</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <a href="#633316" title="=&gt; Boolean">outOfDate</a>

  <span class="keyword">def</span> <a title="()Unit" id="633319">demandNewCompilerRun</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633316" title="=&gt; Boolean">outOfDate</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <span title="scala.tools.nsc.interactive.FreshRunReq" class="keyword">new</span> <a href="CompilerControl.scala.html#35931" title="scala.tools.nsc.interactive.FreshRunReq">FreshRunReq</a> // cancel background compile
    <span class="keyword">else</span> <a href="#633316" title="(x$1: Boolean)Unit">outOfDate</a> = <span title="Boolean(true)" class="keyword">true</span>            // proceed normally and enable new background compile
  <span class="delimiter">}</span>

  <span class="keyword">protected</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">var</span> <a title="Int" id="633321">minRunId</a> = <span title="Int(1)" class="int">1</span>

  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">var</span> <a title="Boolean" id="633324">interruptsEnabled</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Global.this.Response[_]" id="633326">NoResponse</a>: <a href="Response.scala.html#36348" title="Global.this.Response[_]">Response</a><span class="delimiter">[</span>_<span class="delimiter">]</span> = <span title="Global.this.Response[Any]" class="keyword">new</span> <a href="Response.scala.html#36348" title="Global.this.Response[Any]">Response</a><span class="delimiter">[</span>Any<span class="delimiter">]</span>

  /** The response that is currently pending, i.e. the compiler
   *  is working on providing an asnwer for it.
   */
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Global.this.Response[_]" id="633329">pendingResponse</a>: <a href="Response.scala.html#36348" title="Global.this.Response[_]">Response</a><span class="delimiter">[</span>_<span class="delimiter">]</span> = <a href="#633326" title="=&gt; Global.this.Response[_]">NoResponse</a>

  // ----------- Overriding hooks in nsc.Global -----------------------

  /** Called from parser, which signals hereby that a method definition has been parsed.
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(pos: Global.this.Position)Unit" id="633331">signalParseProgress</a><span class="delimiter">(</span><a title="Global.this.Position" id="850061">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Global.this.Position">Position</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633356" title="(pos: Global.this.Position)Unit">checkForMoreWork</a><span class="delimiter">(</span><a href="#850061" title="Global.this.Position">pos</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Called from typechecker, which signals hereby that a node has been completely typechecked.
   *  If the node includes unit.targetPos, abandons run and returns newly attributed tree.
   *  Otherwise, if there's some higher priority work to be done, also abandons run with a FreshRunReq.
   *  @param  context  The context that typechecked the node
   *  @param  old      The original node
   *  @param  result   The transformed node
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(context: Global.this.Context, old: Global.this.Tree, result: Global.this.Tree)Unit" id="633332">signalDone</a><span class="delimiter">(</span><a title="Global.this.Context" id="850066">context</a>: <a href="../typechecker/Contexts.scala.html#537993" title="Global.this.Context">Context</a>, <a title="Global.this.Tree" id="850067">old</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a>, <a title="Global.this.Tree" id="850068">result</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633324" title="=&gt; Boolean">interruptsEnabled</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../Global.scala.html#537550" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: Global.this.type}">analyzer</a>.<a href="../typechecker/Namers.scala.html#538015" title="=&gt; Int">lockedCount</a> <a href="../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#850066" title="Global.this.Context">context</a>.<a href="../typechecker/Contexts.scala.html#538743" title="=&gt; Global.this.analyzer.global.CompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539281" title="=&gt; Boolean">exists</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
          <a href="#850068" title="Global.this.Tree">result</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Global.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409669" title="=&gt; Boolean">isOpaqueRange</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
          <span class="delimiter">(</span><a href="#850068" title="Global.this.Tree">result</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Global.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#409686" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#850066" title="Global.this.Context">context</a>.<a href="../typechecker/Contexts.scala.html#538743" title="=&gt; Global.this.analyzer.global.CompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539294" title="=&gt; Global.this.analyzer.global.Position">targetPos</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">var</span> <a title="Global.this.Tree" id="850087">located</a> = <span title="Global.this.TypedLocator" class="keyword">new</span> <a href="RangePositions.scala.html#633518" title="Global.this.TypedLocator">TypedLocator</a><span class="delimiter">(</span><a href="#850066" title="Global.this.Context">context</a>.<a href="../typechecker/Contexts.scala.html#538743" title="=&gt; Global.this.analyzer.global.CompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539294" title="=&gt; Global.this.analyzer.global.Position">targetPos</a><span class="delimiter">)</span> <a href="RangePositions.scala.html#846570" title="(root: Global.this.Tree)Global.this.Tree">locateIn</a> <a href="#850068" title="Global.this.Tree">result</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#850087" title="Global.this.Tree">located</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Trees.scala.html#407946" title="Global.this.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;something\'s wrong: no &quot;)" class="string">&quot;something's wrong: no &quot;</span><span title="(x$1: Any)String">+</span><a href="#850066" title="Global.this.Context">context</a>.<a href="../typechecker/Contexts.scala.html#538743" title="=&gt; Global.this.analyzer.global.CompilationUnit">unit</a><span title="(x$1: Any)String">+</span><span title="String(&quot; in &quot;)" class="string">&quot; in &quot;</span><span title="(x$1: Any)String">+</span><a href="#850068" title="Global.this.Tree">result</a><span title="(x$1: Any)String">+</span><a href="#850068" title="Global.this.Tree">result</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Global.this.Position">pos</a><span class="delimiter">)</span>
          <a href="#850087" title="Global.this.Tree">located</a> = <a href="#850068" title="Global.this.Tree">result</a>
        <span class="delimiter">}</span>
        <span title="Nothing" class="keyword">throw</span> <span title="Global.this.TyperResult" class="keyword">new</span> <a href="#633405" title="Global.this.TyperResult">TyperResult</a><span class="delimiter">(</span><a href="#850087" title="Global.this.Tree">located</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="#633356" title="(pos: Global.this.Position)Unit">checkForMoreWork</a><span class="delimiter">(</span><a href="#850067" title="Global.this.Tree">old</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Global.this.Position">pos</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Unit" id="850107">ex</a>: <a href="RangePositions.scala.html#633516" title="Global.this.ValidateException">ValidateException</a> =&gt; // Ignore, this will have been reported elsewhere
          <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;validate exception caught: &quot;)" class="string">&quot;validate exception caught: &quot;</span><span title="(x$1: Any)String">+</span><a href="#850107" title="Global.this.ValidateException">ex</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a title="Nothing" id="850111">ex</a>: <span title="Throwable">Throwable</span> =&gt;
          <a href="#633273" title="=&gt; scala.tools.nsc.io.LogReplay">log</a>.<a href="../io/Replayer.scala.html#846052" title="()Unit">flush</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="Nothing" class="keyword">throw</span> <a href="#850111" title="Throwable">ex</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Called from typechecker every time a context is created.
   *  Registers the context in a context tree
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(c: Global.this.Context)Unit" id="633333">registerContext</a><span class="delimiter">(</span><a title="Global.this.Context" id="850116">c</a>: <a href="../typechecker/Contexts.scala.html#537993" title="Global.this.Context">Context</a><span class="delimiter">)</span> = <a href="#850116" title="Global.this.Context">c</a>.<a href="../typechecker/Contexts.scala.html#538743" title="=&gt; Global.this.analyzer.global.CompilationUnit">unit</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#3330502" title="Unit" id="3330504">u</a>: RichCompilationUnit =&gt; <a href="ContextTrees.scala.html#633528" title="(contexts: Global.this.Contexts, context: Global.this.Context)Unit">addContext</a><a href="#3330506" title="(x: Unit)Unit" class="delimiter">(</a>u.<a href="RichCompilationUnits.scala.html#846006" title="=&gt; Global.this.Contexts">contexts</a>, <a href="#850116" title="Global.this.Context">c</a><span class="delimiter">)</span>
    <span class="keyword">case</span> _ =&gt;
  <span class="delimiter">}</span>

  /** The top level classes and objects currently seen in the presentation compiler
   */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.LinkedHashSet[Global.this.Symbol]" id="633334">currentTopLevelSyms</a> = <span title="scala.collection.mutable.LinkedHashSet[Global.this.Symbol]" class="keyword">new</span> mutable.<a href="../../../collection/mutable/LinkedHashSet.scala.html#12468" title="scala.collection.mutable.LinkedHashSet[Global.this.Symbol]">LinkedHashSet</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span>

  /** The top level classes and objects no longer seen in the presentation compiler
   */
  <span class="keyword">val</span> <a title="deletedTopLevelSyms extends scala.collection.mutable.LinkedHashSet[Global.this.Symbol] with scala.collection.mutable.SynchronizedSet[Global.this.Symbol]" id="633336">deletedTopLevelSyms</a> = <a href="#846503" title="scala.collection.mutable.LinkedHashSet[Global.this.Symbol] with scala.collection.mutable.SynchronizedSet[Global.this.Symbol]" class="keyword">new</a> <a title="anonymous class $anon extends scala.collection.mutable.LinkedHashSet[Global.this.Symbol] with scala.collection.mutable.SynchronizedSet[Global.this.Symbol]" id="846503">mutable</a>.<a href="../../../collection/mutable/LinkedHashSet.scala.html#12468" title="scala.collection.mutable.LinkedHashSet[Global.this.Symbol]">LinkedHashSet</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span> <span class="keyword">with</span> mutable.<a href="../../../collection/mutable/SynchronizedSet.scala.html#13317" title="scala.collection.mutable.SynchronizedSet[Global.this.Symbol]">SynchronizedSet</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span>

  /** Called from typechecker every time a top-level class or object is entered.
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(sym: Global.this.Symbol)Unit" id="633338">registerTopLevelSym</a><span class="delimiter">(</span><a title="Global.this.Symbol" id="850130">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Global.this.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#633334" title="=&gt; scala.collection.mutable.LinkedHashSet[Global.this.Symbol]">currentTopLevelSyms</a> <a href="../../../collection/mutable/LinkedHashSet.scala.html#285729" title="(elem: Global.this.Symbol)Global.this.currentTopLevelSyms.type">+=</a> <a href="#850130" title="Global.this.Symbol">sym</a> <span class="delimiter">}</span>

  /** Symbol loaders in the IDE parse all source files loaded from a package for
   *  top-level idents. Therefore, we can detect top-level symbols that have a name
   *  different from their source file
   */
  <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="loaders extends scala.tools.nsc.symtab.BrowsingLoaders" id="633340">loaders</a> = <a href="#850142" title="scala.tools.nsc.symtab.BrowsingLoaders{}" class="keyword">new</a> <a href="../symtab/BrowsingLoaders.scala.html#41597" title="anonymous class $anon extends scala.tools.nsc.symtab.BrowsingLoaders" id="850142">BrowsingLoaders</a> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Global.this.type" id="850150">global</a>: Global.<span class="keyword">this</span>.<span class="keyword">type</span> = <a href="#35890" title="Global.this.type">Global</a>.<span class="keyword">this</span>
  <span class="delimiter">}</span>

  // ----------------- Polling ---------------------------------------

  case <span class="keyword">class</span> <a title="class WorkEvent extends AnyRef with Product with Serializable" id="852778">WorkEvent</a><a href="../../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="Int" id="852773">atNode</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="Long" id="852774">atMillis</a>: <a href="../../../Long.scala.html#1293" title="Long">Long</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="633345">moreWorkAtNode</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a> = -<span title="Int(-1)" class="int">1</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="633348">nodesSeen</a> = <span title="Int(0)" class="int">0</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Boolean" id="633351">lastWasReload</a> = <span title="Boolean(false)" class="keyword">false</span>

  /** The number of pollForWorks after which the presentation compiler yields.
   *  Yielding improves responsiveness on systems with few cores because it
   *  gives the UI thread a chance to get new tasks and interrupt the presentation
   *  compiler with them.
   */
  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(10)" id="633353">yieldPeriod</a> = <span title="Int(10)" class="int">10</span>

  /** Called from runner thread and signalDone:
   *  Poll for interrupts and execute them immediately.
   *  Then, poll for exceptions and execute them.
   *  Then, poll for work reload/typedTreeAt/doFirst commands during background checking.
   *  @param pos   The position of the tree if polling while typechecking, NoPosition otherwise
   *
   */
  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(pos: Global.this.Position)Unit" id="633355">pollForWork</a><span class="delimiter">(</span><a title="Global.this.Position" id="850213">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Global.this.Position">Position</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#633324" title="=&gt; Boolean">interruptsEnabled</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">return</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#850213" title="Global.this.Position">pos</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Positions.scala.html#408302" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#633348" title="=&gt; Int">nodesSeen</a> <a href="../../../Int.scala.html#57182" title="(x: Int)Int">%</a> <span title="Int(10)">yieldPeriod</span> <a href="../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Thread.type">Thread</span>.<span title="()Unit">`yield`</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="()Option[Global.this.WorkEvent]" id="850215">nodeWithWork</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../Option.scala.html#978" title="Option[Global.this.WorkEvent]">Option</a><span class="delimiter">[</span>WorkEvent<span class="delimiter">]</span> =
      <span title="Option[Global.this.WorkEvent]" class="keyword">if</span> <span class="delimiter">(</span><a href="CompilerControl.scala.html#633416" title="=&gt; scala.tools.nsc.util.WorkScheduler">scheduler</a>.<a href="../util/WorkScheduler.scala.html#633724" title="=&gt; Boolean">moreWork</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#633329" title="=&gt; Global.this.Response[_]">pendingResponse</a>.<a href="Response.scala.html#633707" title="=&gt; Boolean">isCancelled</a><span class="delimiter">)</span> <a href="../../../Option.scala.html#63128" title="(x: Global.this.WorkEvent)Some[Global.this.WorkEvent]">Some</a><span class="delimiter">(</span><span title="Global.this.WorkEvent" class="keyword">new</span> <a href="#852778" title="Global.this.WorkEvent">WorkEvent</a><span class="delimiter">(</span><a href="#633348" title="=&gt; Int">nodesSeen</a>, <span title="System.type">System</span>.<span title="()Long">currentTimeMillis</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <a href="../../../Option.scala.html#1585" title="None.type">None</a>

    <a href="#633348" title="(x$1: Int)Unit">nodesSeen</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <a href="../io/Replayer.scala.html#846048" title="(event: String, x: =&gt; Option[Global.this.WorkEvent])(implicit evidence$1: scala.tools.nsc.io.Pickler[Global.this.WorkEvent])Option[Global.this.WorkEvent]">logreplay</a><a href="Picklers.scala.html#633581" title="=&gt; scala.tools.nsc.io.Pickler[Global.this.WorkEvent]" class="delimiter">(</a><span title="String(&quot;atnode&quot;)" class="string">&quot;atnode&quot;</span>, <a href="#850215" title="()Option[Global.this.WorkEvent]">nodeWithWork</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<a href="#3330525" title="Unit" id="3330527" class="delimiter">(</a>WorkEvent<a href="../../../Option.scala.html#63132" title="Global.this.WorkEvent" id="3330526" class="delimiter">(</a><a href="#852773" title="Int" id="850308">id</a>, <a href="#852774" title="Long" id="3330528">_</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;some work at node &quot;)" class="string">&quot;some work at node &quot;</span><span title="(x$1: Any)String">+</span><a href="#850308" title="Int">id</a><span title="(x$1: Any)String">+</span><span title="String(&quot; current = &quot;)" class="string">&quot; current = &quot;</span><span title="(x$1: Any)String">+</span><a href="#633348" title="=&gt; Int">nodesSeen</a><span class="delimiter">)</span>
//        assert(id &gt;= nodesSeen)
        <a href="#633345" title="(x$1: Int)Unit">moreWorkAtNode</a> = <a href="#850308" title="Int">id</a>
      <span class="keyword">case</span> <a href="../../../Option.scala.html#1585" title="Unit" id="3330530">None</a> =&gt;
    <span class="delimiter">}</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633348" title="=&gt; Int">nodesSeen</a> <a href="../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> <a href="#633345" title="=&gt; Int">moreWorkAtNode</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <a href="../io/Replayer.scala.html#846048" title="(event: String, x: =&gt; Option[scala.tools.nsc.util.InterruptReq])(implicit evidence$1: scala.tools.nsc.io.Pickler[scala.tools.nsc.util.InterruptReq])Option[scala.tools.nsc.util.InterruptReq]">logreplay</a><a href="Picklers.scala.html#633582" title="=&gt; scala.tools.nsc.io.Pickler[scala.tools.nsc.util.InterruptReq]" class="delimiter">(</a><span title="String(&quot;asked&quot;)" class="string">&quot;asked&quot;</span>, <a href="CompilerControl.scala.html#633416" title="=&gt; scala.tools.nsc.util.WorkScheduler">scheduler</a>.<a href="../util/WorkScheduler.scala.html#633731" title="()Option[scala.tools.nsc.util.InterruptReq]">pollInterrupt</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#3330540" title="Unit" id="3330541" class="delimiter">(</a><a href="../../../Option.scala.html#63132" title="scala.tools.nsc.util.InterruptReq" id="850355">ir</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">try</span> <span class="delimiter">{</span>
            <a href="#633324" title="(x$1: Boolean)Unit">interruptsEnabled</a> = <span title="Boolean(false)" class="keyword">false</span>
            <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;ask started&quot;)" class="string">&quot;ask started&quot;</span><span title="(x$1: Any)String">+</span><a href="#633279" title="=&gt; String">timeStep</a><span class="delimiter">)</span>
            <a href="#850355" title="scala.tools.nsc.util.InterruptReq">ir</a>.<a href="../util/InterruptReq.scala.html#846861" title="()Unit">execute</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
            <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;ask finished&quot;)" class="string">&quot;ask finished&quot;</span><span title="(x$1: Any)String">+</span><a href="#633279" title="=&gt; String">timeStep</a><span class="delimiter">)</span>
            <a href="#633324" title="(x$1: Boolean)Unit">interruptsEnabled</a> = <span title="Boolean(true)" class="keyword">true</span>
          <span class="delimiter">}</span>
          <a href="#633355" title="(pos: Global.this.Position)Unit">pollForWork</a><span class="delimiter">(</span><a href="#850213" title="Global.this.Position">pos</a><span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt;
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../io/Replayer.scala.html#846047" title="(event: String, x: =&gt; Boolean)Boolean">logreplay</a><span class="delimiter">(</span><span title="String(&quot;cancelled&quot;)" class="string">&quot;cancelled&quot;</span>, <a href="#633329" title="=&gt; Global.this.Response[_]">pendingResponse</a>.<a href="Response.scala.html#633707" title="=&gt; Boolean">isCancelled</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Nothing" class="keyword">throw</span> <a href="#852787" title="scala.tools.nsc.interactive.CancelException.type">CancelException</a>
      <span class="delimiter">}</span>

      <a href="../io/Replayer.scala.html#846048" title="(event: String, x: =&gt; Option[Throwable])(implicit evidence$1: scala.tools.nsc.io.Pickler[Throwable])Option[Throwable]">logreplay</a><a href="Picklers.scala.html#633557" title="=&gt; scala.tools.nsc.io.Pickler[Throwable]" class="delimiter">(</a><span title="String(&quot;exception thrown&quot;)" class="string">&quot;exception thrown&quot;</span>, <a href="CompilerControl.scala.html#633416" title="=&gt; scala.tools.nsc.util.WorkScheduler">scheduler</a>.<a href="../util/WorkScheduler.scala.html#633730" title="()Option[Throwable]">pollThrowable</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#3330558" title="Boolean" id="3330559" class="delimiter">(</a><a href="../../../Option.scala.html#63132" title="Throwable" id="850408">ex</a>: FreshRunReq<span class="delimiter">)</span> =&gt;
          <a href="#633404" title="()Unit">newTyperRun</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#633321" title="(x$1: Int)Unit">minRunId</a> = <a href="../Global.scala.html#537743" title="=&gt; Int">currentRunId</a>
          <a href="#633319" title="()Unit">demandNewCompilerRun</a><span class="delimiter">(</span><span class="delimiter">)</span>

        <span class="keyword">case</span> Some<span class="delimiter">(</span><a href="../../../Option.scala.html#63132" title="Throwable" id="3330565">ShutdownReq</a><span class="delimiter">)</span> =&gt;
          <a href="CompilerControl.scala.html#633416" title="=&gt; scala.tools.nsc.util.WorkScheduler">scheduler</a>.<span title="(x$1: Nothing)Nothing">synchronized</span> <a href="#3330569" title="(x: Unit)Unit" class="delimiter">{</a> // lock the work queue so no more items are posted while we clean it up
            <span class="keyword">val</span> <a title="Seq[Unit]" id="850412">units</a> = <a href="CompilerControl.scala.html#633416" title="=&gt; scala.tools.nsc.util.WorkScheduler">scheduler</a>.<a href="../util/WorkScheduler.scala.html#633726" title="(f: (() =&gt; Unit) =&gt; Option[Unit])Seq[Unit]">dequeueAll</a> <a href="#850417" title="() =&gt; Unit" class="delimiter">{</a>
              <span class="keyword">case</span> <a href="../../../Boolean.scala.html#57826" title="Some[Unit]" id="3330551">item</a>: WorkItem =&gt; <a href="../../../Option.scala.html#63128" title="(x: Unit)Some[Unit]">Some</a><a href="#3330553" title="(x: Some[Unit])Some[Unit]" class="delimiter">(</a>item.<a href="CompilerControl.scala.html#633755" title="()Unit">raiseMissing</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> _ =&gt; <a href="../../../Option.scala.html#63128" title="(x: Unit)Some[Unit]">Some</a><a href="#3330553" title="(x: Some[Unit])Some[Unit]" class="delimiter">(</a><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>

            // don't forget to service interrupt requests
            <span class="keyword">val</span> <a title="Unit" id="850413">iqs</a> = <a href="CompilerControl.scala.html#633416" title="=&gt; scala.tools.nsc.util.WorkScheduler">scheduler</a>.<a href="../util/WorkScheduler.scala.html#633729" title="(f: scala.tools.nsc.util.InterruptReq =&gt; Unit)Unit">dequeueAllInterrupts</a><span class="delimiter">(</span><a href="#850428" title="scala.tools.nsc.util.InterruptReq">_</a>.<a href="../util/InterruptReq.scala.html#846861" title="()Unit">execute</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

            <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;ShutdownReq: cleaning work queue (%d items)&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#850412" title="Seq[Unit]">units</a>.<a href="../../../collection/SeqLike.scala.html#58788" title="=&gt; Int">size</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Cleanup up responses (%d loadedType pending, %d parsedEntered pending)&quot;</a>
                .<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#633290" title="=&gt; Global.this.ResponseMap">waitLoadedTypeResponses</a>.<a href="../../../collection/mutable/HashMap.scala.html#88241" title="=&gt; Int">size</a>, <a href="#633293" title="=&gt; Global.this.ResponseMap">getParsedEnteredResponses</a>.<a href="../../../collection/mutable/HashMap.scala.html#88241" title="=&gt; Int">size</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#633298" title="()Unit">checkNoResponsesOutstanding</a><span class="delimiter">(</span><span class="delimiter">)</span>

            <a href="#633273" title="=&gt; scala.tools.nsc.io.LogReplay">log</a>.<a href="../io/Replayer.scala.html#846052" title="()Unit">flush</a><span class="delimiter">(</span><span class="delimiter">)</span>;
            <a href="CompilerControl.scala.html#633417" title="(x$1: scala.tools.nsc.util.WorkScheduler)Unit">scheduler</a> = <span title="Global.this.NoWorkScheduler" class="keyword">new</span> <a href="CompilerControl.scala.html#633493" title="Global.this.NoWorkScheduler">NoWorkScheduler</a>
            <span title="Nothing" class="keyword">throw</span> <a href="CompilerControl.scala.html#35992" title="scala.tools.nsc.interactive.ShutdownReq.type">ShutdownReq</a>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> Some<span class="delimiter">(</span><a href="../../../Option.scala.html#63132" title="Throwable" id="850442">ex</a>: Throwable<span class="delimiter">)</span> =&gt; <a href="#633273" title="=&gt; scala.tools.nsc.io.LogReplay">log</a>.<a href="../io/Replayer.scala.html#846052" title="()Unit">flush</a><span class="delimiter">(</span><span class="delimiter">)</span>; <span title="Nothing" class="keyword">throw</span> ex
        <span class="keyword">case</span> _ =&gt;
      <span class="delimiter">}</span>

      <a href="#633351" title="(x$1: Boolean)Unit">lastWasReload</a> = <span title="Boolean(false)" class="keyword">false</span>

      <a href="../io/Replayer.scala.html#846048" title="(event: String, x: =&gt; Option[() =&gt; Unit])(implicit evidence$1: scala.tools.nsc.io.Pickler[() =&gt; Unit])Option[() =&gt; Unit]">logreplay</a><a href="Picklers.scala.html#633593" title="=&gt; scala.tools.nsc.io.Pickler[() =&gt; Unit]" class="delimiter">(</a><span title="String(&quot;workitem&quot;)" class="string">&quot;workitem&quot;</span>, <a href="CompilerControl.scala.html#633416" title="=&gt; scala.tools.nsc.util.WorkScheduler">scheduler</a>.<a href="../util/WorkScheduler.scala.html#633725" title="()Option[() =&gt; Unit]">nextWorkItem</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#3330579" title="Unit" id="3330580" class="delimiter">(</a><a href="../../../Option.scala.html#63132" title="() =&gt; Unit" id="850491">action</a><span class="delimiter">)</span> =&gt;
          <a href="#3330584" title="(x: Unit)Unit" class="keyword">try</a> <span class="delimiter">{</span>
            <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;picked up work item at &quot;)" class="string">&quot;picked up work item at &quot;</span><span title="(x$1: Any)String">+</span><a href="#850213" title="Global.this.Position">pos</a><span title="(x$1: Any)String">+</span><span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span><span title="(x$1: Any)String">+</span><a href="#850491" title="() =&gt; Unit">action</a><span title="(x$1: Any)String">+</span><a href="#633279" title="=&gt; String">timeStep</a><span class="delimiter">)</span>
            <a href="../../../Function0.scala.html#65930" title="()Unit">action</a><span class="delimiter">(</span><span class="delimiter">)</span>
            <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;done with work item: &quot;)" class="string">&quot;done with work item: &quot;</span><span title="(x$1: Any)String">+</span><a href="#850491" title="() =&gt; Unit">action</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
            <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;quitting work item: &quot;)" class="string">&quot;quitting work item: &quot;</span><span title="(x$1: Any)String">+</span><a href="#850491" title="() =&gt; Unit">action</a><span title="(x$1: Any)String">+</span><a href="#633279" title="=&gt; String">timeStep</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> <a href="../../../Option.scala.html#1585" title="Unit" id="3330582">None</a> =&gt;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(pos: Global.this.Position)Unit" id="633356">checkForMoreWork</a><span class="delimiter">(</span><a title="Global.this.Position" id="850064">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Global.this.Position">Position</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Global.this.TyperRun" id="850492">typerRun</a> = <a href="#633313" title="=&gt; Global.this.TyperRun">currentTyperRun</a>
    <a href="#633355" title="(pos: Global.this.Position)Unit">pollForWork</a><span class="delimiter">(</span><a href="#850064" title="Global.this.Position">pos</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#850492" title="Global.this.TyperRun">typerRun</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#633313" title="=&gt; Global.this.TyperRun">currentTyperRun</a><span class="delimiter">)</span> <a href="#633319" title="()Unit">demandNewCompilerRun</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile, start: Int, length: Int)String" id="633357">debugInfo</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="850497">source</a> : <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a>, <a title="Int" id="850498">start</a> : <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="850499">length</a> : <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;DEBUG INFO &quot;)" class="string">&quot;DEBUG INFO &quot;</span><span title="(x$1: Any)String">+</span><a href="#850497" title="scala.reflect.internal.util.SourceFile">source</a><span title="(x$1: Any)String">+</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="#850498" title="Int">start</a><span title="(x$1: Any)String">+</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="#850499" title="Int">length</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="850501">end</a> = <a href="#850498" title="Int">start</a><a href="../../../Int.scala.html#57154" title="(x: Int)Int">+</a><a href="#850499" title="Int">length</a>
    <span class="keyword">val</span> <a title="scala.reflect.internal.util.RangePosition" id="850502">pos</a> = <a href="RangePositions.scala.html#633499" title="(source: scala.reflect.internal.util.SourceFile, start: Int, point: Int, end: Int)scala.reflect.internal.util.RangePosition">rangePos</a><span class="delimiter">(</span><a href="#850497" title="scala.reflect.internal.util.SourceFile">source</a>, <a href="#850498" title="Int">start</a>, <a href="#850498" title="Int">start</a>, <a href="#850501" title="Int">end</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Global.this.Tree" id="850503">tree</a> = <a href="CompilerControl.scala.html#633427" title="(pos: Global.this.Position)Global.this.Tree">locateTree</a><span class="delimiter">(</span><a href="#850502" title="scala.reflect.internal.util.RangePosition">pos</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.io.StringWriter" id="850504">sw</a> = <span title="java.io.StringWriter" class="keyword">new</span> <span title="java.io.StringWriter">StringWriter</span>
    <span class="keyword">val</span> <a title="java.io.PrintWriter" id="850505">pw</a> = <span title="java.io.PrintWriter" class="keyword">new</span> <span title="java.io.PrintWriter">PrintWriter</span><span class="delimiter">(</span><a href="#850504" title="java.io.StringWriter">sw</a><span class="delimiter">)</span>
    <a href="../ast/Printers.scala.html#537846" title="(writer: java.io.PrintWriter)Global.this.TreePrinter">newTreePrinter</a><span class="delimiter">(</span><a href="#850505" title="java.io.PrintWriter">pw</a><span class="delimiter">)</span>.<a href="../ast/Printers.scala.html#619643" title="(args: Any*)Unit">print</a><span class="delimiter">(</span><a href="#850503" title="Global.this.Tree">tree</a><span class="delimiter">)</span>
    <a href="#850505" title="java.io.PrintWriter">pw</a>.<span title="()Unit">flush</span>

    <span class="keyword">val</span> <a title="scala.tools.nsc.interactive.Response[Global.this.Tree]" id="850506">typed</a> = <span title="Global.this.Response[Global.this.Tree]" class="keyword">new</span> <a href="Response.scala.html#36348" title="Global.this.Response[Global.this.Tree]">Response</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>
    <a href="CompilerControl.scala.html#633433" title="(pos: Global.this.Position, response: Global.this.Response[Global.this.Tree])Unit">askTypeAt</a><span class="delimiter">(</span><a href="#850502" title="scala.reflect.internal.util.RangePosition">pos</a>, <a href="#850506" title="scala.tools.nsc.interactive.Response[Global.this.Tree]">typed</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="String" id="850507">typ</a> = <a href="#850506" title="scala.tools.nsc.interactive.Response[Global.this.Tree]">typed</a>.<a href="Response.scala.html#633703" title="=&gt; Either[Global.this.Tree,Throwable]">get</a>.<a href="../../../util/Either.scala.html#97627" title="=&gt; scala.util.Either.LeftProjection[Global.this.Tree,Throwable]">left</a>.<a href="../../../util/Either.scala.html#850572" title="=&gt; Option[Global.this.Tree]">toOption</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<a href="#3330592" title="String" id="3330593" class="delimiter">(</a><a href="../../../Option.scala.html#63132" title="Global.this.Tree" id="850609">tree</a><span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="java.io.StringWriter" id="850610">sw</a> = <span title="java.io.StringWriter" class="keyword">new</span> <span title="java.io.StringWriter">StringWriter</span>
        <span class="keyword">val</span> <a title="java.io.PrintWriter" id="850611">pw</a> = <span title="java.io.PrintWriter" class="keyword">new</span> <span title="java.io.PrintWriter">PrintWriter</span><span class="delimiter">(</span><a href="#850610" title="java.io.StringWriter">sw</a><span class="delimiter">)</span>
        <a href="../ast/Printers.scala.html#537846" title="(writer: java.io.PrintWriter)Global.this.TreePrinter">newTreePrinter</a><span class="delimiter">(</span><a href="#850611" title="java.io.PrintWriter">pw</a><span class="delimiter">)</span>.<a href="../ast/Printers.scala.html#619643" title="(args: Any*)Unit">print</a><span class="delimiter">(</span><a href="#850609" title="Global.this.Tree">tree</a><span class="delimiter">)</span>
        <a href="#850611" title="java.io.PrintWriter">pw</a>.<span title="()Unit">flush</span>
        <a href="#850610" title="java.io.StringWriter">sw</a>.<span title="()String">toString</span>
      <span class="keyword">case</span> <a href="../../../Option.scala.html#1585" title="String" id="3330595">None</a> =&gt; <a href="#3330597" title="(x: String)String" class="string">&quot;&lt;None&gt;&quot;</a>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="scala.tools.nsc.interactive.Response[List[Global.this.Member]]" id="850508">completionResponse</a> = <span title="Global.this.Response[List[Global.this.Member]]" class="keyword">new</span> <a href="Response.scala.html#36348" title="Global.this.Response[List[Global.this.Member]]">Response</a><span class="delimiter">[</span>List<span class="delimiter">[</span>Member<span class="delimiter">]</span><span class="delimiter">]</span>
    <a href="CompilerControl.scala.html#633436" title="(pos: Global.this.Position, response: Global.this.Response[List[Global.this.Member]])Unit">askTypeCompletion</a><span class="delimiter">(</span><a href="#850502" title="scala.reflect.internal.util.RangePosition">pos</a>, <a href="#850508" title="scala.tools.nsc.interactive.Response[List[Global.this.Member]]">completionResponse</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="String" id="850509">completion</a> = <a href="#850508" title="scala.tools.nsc.interactive.Response[List[Global.this.Member]]">completionResponse</a>.<a href="Response.scala.html#633703" title="=&gt; Either[List[Global.this.Member],Throwable]">get</a>.<a href="../../../util/Either.scala.html#97627" title="=&gt; scala.util.Either.LeftProjection[List[Global.this.Member],Throwable]">left</a>.<a href="../../../util/Either.scala.html#850572" title="=&gt; Option[List[Global.this.Member]]">toOption</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<a href="#3330605" title="String" id="3330606" class="delimiter">(</a><a href="../../../Option.scala.html#63132" title="List[Global.this.Member]" id="850630">members</a><span class="delimiter">)</span> =&gt;
        <a href="#850630" title="List[Global.this.Member]">members</a> <a href="#3330610" title="(x: String)String">mkString</a> <span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span>
      <span class="keyword">case</span> <a href="../../../Option.scala.html#1585" title="String" id="3330608">None</a> =&gt; <a href="#3330610" title="(x: String)String" class="string">&quot;&lt;None&gt;&quot;</a>
    <span class="delimiter">}</span>

    <a href="#850497" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../Predef.scala.html#7550" title="implicit scala.Predef.charArrayOps : (xs: Array[Char])scala.collection.mutable.ArrayOps[Char]">content</a>.<a href="../../../collection/mutable/IndexedSeqLike.scala.html#59087" title="=&gt; scala.collection.mutable.IndexedSeqView[Char,Array[Char]]">view</a>.<a href="../../../collection/mutable/IndexedSeqView.scala.html#76022" title="(n: Int)scala.collection.mutable.IndexedSeqView[Char,Array[Char]]">drop</a><span class="delimiter">(</span><a href="#850498" title="Int">start</a><span class="delimiter">)</span>.<a href="../../../collection/mutable/IndexedSeqView.scala.html#76023" title="(n: Int)scala.collection.mutable.IndexedSeqView[Char,Array[Char]]">take</a><span class="delimiter">(</span><a href="#850499" title="Int">length</a><span class="delimiter">)</span>.<a href="../../../collection/TraversableViewLike.scala.html#67907" title="=&gt; String">mkString</a><span title="(x$1: Any)String">+</span><span title="String(&quot; : &quot;)" class="string">&quot; : &quot;</span><span title="(x$1: Any)String">+</span><a href="#850497" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403765" title="=&gt; String">path</a><span title="(x$1: Any)String">+</span><span title="String(&quot; (&quot;)" class="string">&quot; (&quot;</span><span title="(x$1: Any)String">+</span><a href="#850498" title="Int">start</a><span title="(x$1: Any)String">+</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span title="(x$1: Any)String">+</span><a href="#850501" title="Int">end</a><span title="(x$1: Any)String">+</span>
    <span title="String(&quot;)\n\nlocateTree:\n&quot;)" class="string">&quot;)\n\nlocateTree:\n&quot;</span><span title="(x$1: Any)String">+</span><a href="#850504" title="java.io.StringWriter">sw</a>.<span title="()String">toString</span><span title="(x$1: Any)String">+</span><span title="String(&quot;\n\naskTypeAt:\n&quot;)" class="string">&quot;\n\naskTypeAt:\n&quot;</span><span title="(x$1: Any)String">+</span><a href="#850507" title="String">typ</a><span title="(x$1: Any)String">+</span><span title="String(&quot;\n\ncompletion:\n&quot;)" class="string">&quot;\n\ncompletion:\n&quot;</span><span title="(x$1: Any)String">+</span><a href="#850509" title="String">completion</a>
  <span class="delimiter">}</span>

  // ----------------- The Background Runner Thread -----------------------

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="633359">threadId</a> = <span title="Int(0)" class="int">0</span>

  /** The current presentation compiler runner */
  @volatile <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">var</span> <a title="Thread" id="633362">compileRunner</a> = <a href="#633364" title="()Thread">newRunnerThread</a><span class="delimiter">(</span><span class="delimiter">)</span>

  /** Create a new presentation compiler runner.
   */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Thread" id="633364">newRunnerThread</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Thread">Thread</span> = <span class="delimiter">{</span>
    <a href="#633359" title="(x$1: Int)Unit">threadId</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <a href="#633362" title="(x$1: Thread)Unit">compileRunner</a> = <span title="scala.tools.nsc.interactive.PresentationCompilerThread" class="keyword">new</span> <a href="PresentationCompilerThread.scala.html#35739" title="scala.tools.nsc.interactive.PresentationCompilerThread">PresentationCompilerThread</a><span class="delimiter">(</span><a href="#35890" title="scala.tools.nsc.interactive.Global" class="keyword">this</a>, <a href="#633598" title="String">projectName</a><span class="delimiter">)</span>
    <a href="#633362" title="=&gt; Thread">compileRunner</a>.<span title="(x$1: Boolean)Unit">setDaemon</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
    <a href="#633362" title="=&gt; Thread">compileRunner</a>.<span title="()Unit">start</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#633362" title="=&gt; Thread">compileRunner</a>
  <span class="delimiter">}</span>

  /** Compile all loaded source files in the order given by `allSources`.
   */
  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="()Unit" id="633365">backgroundCompile</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633281" title="(msg: =&gt; String)Unit">informIDE</a><span class="delimiter">(</span><span title="String(&quot;Starting new presentation compiler type checking pass&quot;)" class="string">&quot;Starting new presentation compiler type checking pass&quot;</span><span class="delimiter">)</span>
    <a href="../Global.scala.html#537436" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="../reporters/Reporter.scala.html#539689" title="()Unit">reset</a><span class="delimiter">(</span><span class="delimiter">)</span>

    // remove any files in first that are no longer maintained by presentation compiler (i.e. closed)
    <a href="#633302" title="(x$1: List[scala.reflect.internal.util.SourceFile])Unit">allSources</a> = <a href="#633302" title="=&gt; List[scala.reflect.internal.util.SourceFile]">allSources</a> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: scala.reflect.internal.util.SourceFile =&gt; Boolean)List[scala.reflect.internal.util.SourceFile]">filter</a> <span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="850934">s</a> =&gt; <a href="#633283" title="=&gt; scala.collection.mutable.LinkedHashMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit] with scala.collection.mutable.SynchronizedMap[tools.nsc.io.AbstractFile,Global.this.RichCompilationUnit]">unitOfFile</a> <a href="../../../collection/mutable/SynchronizedMap.scala.html#299909" title="(key: tools.nsc.io.AbstractFile)Boolean">contains</a> <span class="delimiter">(</span><a href="#850934" title="scala.reflect.internal.util.SourceFile">s</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a><span class="delimiter">)</span><span class="delimiter">)</span>

    // ensure all loaded units are parsed
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="850960">s</a> &lt;- <a href="../../../collection/immutable/List.scala.html#62719" title="(f: scala.reflect.internal.util.SourceFile =&gt; Unit)Unit">allSources</a>; <a title="Global.this.RichCompilationUnit" id="850965">unit</a> &lt;- <a href="#633300" title="(s: scala.reflect.internal.util.SourceFile)Option[Global.this.RichCompilationUnit]">getUnit</a><a href="../../../Option.scala.html#62884" title="(f: Global.this.RichCompilationUnit =&gt; Unit)Unit" class="delimiter">(</a><a href="#850960" title="scala.reflect.internal.util.SourceFile">s</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      // checkForMoreWork(NoPosition)  // disabled, as any work done here would be in an inconsistent state
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#850965" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845995" title="=&gt; Boolean">isUpToDate</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#850965" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845990" title="=&gt; Int">status</a> <a href="../../../Int.scala.html#57104" title="(x: Int)Boolean">!=</a> <span title="Int(-1)">JustParsed</span><span class="delimiter">)</span> <a href="#633367" title="(unit: Global.this.RichCompilationUnit)Unit">reset</a><span class="delimiter">(</span><a href="#850965" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span> // reparse previously typechecked units.
      <a href="#633368" title="(unit: Global.this.RichCompilationUnit)Unit">parseAndEnter</a><span class="delimiter">(</span><a href="#850965" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
      <a href="#633366" title="()Unit">serviceParsedEntered</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    // sleep window
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633270" title="=&gt; Int">afterTypeDelay</a> <a href="../../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#633351" title="=&gt; Boolean">lastWasReload</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Long" id="850982">limit</a> = <span title="System.type">System</span>.<span title="()Long">currentTimeMillis</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../Long.scala.html#57520" title="(x: Int)Long">+</a> <a href="#633270" title="=&gt; Int">afterTypeDelay</a>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="System.type">System</span>.<span title="()Long">currentTimeMillis</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../Long.scala.html#57478" title="(x: Long)Boolean">&lt;</a> <a href="#850982" title="Long">limit</a><span class="delimiter">)</span> <a href="#850987" title="()Unit" class="delimiter">{</a>
        <span title="Thread.type">Thread</span>.<span title="(x$1: Long)Unit">sleep</span><span class="delimiter">(</span><span title="Long(10L)">SleepTime</span><span class="delimiter">)</span>
        <a href="#633356" title="(pos: Global.this.Position)Unit">checkForMoreWork</a><span class="delimiter">(</span><a href="../../../reflect/internal/Positions.scala.html#408302" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    // ensure all loaded units are typechecked
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="851017">s</a> &lt;- <a href="../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: scala.reflect.internal.util.SourceFile =&gt; Unit)Unit">allSources</a>; <span class="keyword">if</span> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="../../../collection/GenSetLike.scala.html#66403" title="(elem: tools.nsc.io.AbstractFile)Boolean">ignoredFiles</a><span class="delimiter">(</span><a href="#851017" title="scala.reflect.internal.util.SourceFile">s</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a><span class="delimiter">)</span>; <a title="Global.this.RichCompilationUnit" id="851021">unit</a> &lt;- <a href="#633300" title="(s: scala.reflect.internal.util.SourceFile)Option[Global.this.RichCompilationUnit]">getUnit</a><a href="../../../Option.scala.html#62884" title="(f: Global.this.RichCompilationUnit =&gt; Unit)Unit" class="delimiter">(</a><a href="#851017" title="scala.reflect.internal.util.SourceFile">s</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#3330636" title="Unit" id="3330628" class="keyword">try</a> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#851021" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845995" title="=&gt; Boolean">isUpToDate</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#851021" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845999" title="=&gt; scala.collection.mutable.ArrayBuffer[scala.tools.nsc.interactive.Problem]">problems</a>.<a href="../../../collection/IndexedSeqOptimized.scala.html#59120" title="=&gt; Boolean">isEmpty</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#633594" title="scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#540174" title="=&gt; Global.this.settings.BooleanSetting">YpresentationStrict</a>.<a href="../settings/MutableSettings.scala.html#541066" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
            <a href="#633369" title="(unit: Global.this.RichCompilationUnit)Unit">typeCheck</a><span class="delimiter">(</span><a href="#851021" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
          <span class="keyword">else</span> <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s has syntax errors. Skipped typechecking&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#851021" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;already up to date: &quot;)" class="string">&quot;already up to date: &quot;</span><span title="(x$1: Any)String">+</span><a href="#851021" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.Response[Global.this.Tree]" id="851073">r</a> &lt;- <a href="../../../collection/mutable/HashMap.scala.html#88245" title="(key: scala.reflect.internal.util.SourceFile)scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]]">waitLoadedTypeResponses</a><a href="../../../collection/IterableLike.scala.html#58562" title="(f: Global.this.Response[Global.this.Tree] =&gt; Unit)Unit" class="delimiter">(</a><a href="#851021" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539270" title="=&gt; scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#851073" title="Global.this.Response[Global.this.Tree]">r</a> <a href="Response.scala.html#633701" title="(x: Global.this.Tree)Unit">set</a> <a href="#851021" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539278" title="=&gt; Global.this.Tree">body</a>
        <a href="#633366" title="()Unit">serviceParsedEntered</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#3330628" title="Unit" id="3330629">ex</a>: FreshRunReq =&gt; <a href="#3330636" title="(x: Unit)Unit" class="keyword">throw</a> ex           // propagate a new run request
        <span class="keyword">case</span> <a href="CompilerControl.scala.html#35992" title="Unit" id="3330631">ShutdownReq</a>     =&gt; <a href="#3330636" title="(x: Unit)Unit" class="keyword">throw</a> <a href="CompilerControl.scala.html#35992" title="scala.tools.nsc.interactive.ShutdownReq.type">ShutdownReq</a>  // propagate a shutdown request
        <span class="keyword">case</span> <a href="#3330628" title="Unit" id="3330632">ex</a>: ControlThrowable =&gt; <a href="#3330636" title="(x: Unit)Unit" class="keyword">throw</a> ex
        <span class="keyword">case</span> <a href="#3330628" title="Unit" id="3330633">ex</a>: Throwable =&gt;
          <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;[%s]: exception during background compile: &quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#851021" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539270" title="=&gt; scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> ex<span class="delimiter">)</span>
          ex.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.Response[Global.this.Tree]" id="851123">r</a> &lt;- <a href="../../../collection/mutable/HashMap.scala.html#88245" title="(key: scala.reflect.internal.util.SourceFile)scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]]">waitLoadedTypeResponses</a><a href="../../../collection/IterableLike.scala.html#58562" title="(f: Global.this.Response[Global.this.Tree] =&gt; Unit)Unit" class="delimiter">(</a><a href="#851021" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539270" title="=&gt; scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#851123" title="Global.this.Response[Global.this.Tree]">r</a>.<a href="Response.scala.html#633702" title="(exc: Throwable)Unit">raise</a><span class="delimiter">(</span>ex<span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#633366" title="()Unit">serviceParsedEntered</a><span class="delimiter">(</span><span class="delimiter">)</span>

          <a href="#633305" title="(x$1: Option[Throwable])Unit">lastException</a> = <a href="../../../Option.scala.html#63128" title="(x: Throwable)Some[Throwable]">Some</a><span class="delimiter">(</span>ex<span class="delimiter">)</span>
          <a href="#633308" title="(x$1: Set[tools.nsc.io.AbstractFile])Unit">ignoredFiles</a> <a href="../../../collection/SetLike.scala.html#66443" title="(elem: tools.nsc.io.AbstractFile)scala.collection.immutable.Set[tools.nsc.io.AbstractFile]">+=</a> <a href="#851021" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539270" title="=&gt; scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a>
          <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;[%s] marking unit as crashed (crashedFiles: %s)&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#851021" title="Global.this.RichCompilationUnit">unit</a>, <a href="#633308" title="=&gt; Set[tools.nsc.io.AbstractFile]">ignoredFiles</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <a href="../Global.scala.html#537436" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="../reporters/Reporter.scala.html#539685" title="(pos: scala.reflect.internal.util.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#851021" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539278" title="=&gt; Global.this.Tree">body</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Global.this.Position">pos</a>, <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Presentation compiler crashed while type checking this file: %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span>ex.<span title="()String">toString</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    // move units removable after this run to the &quot;to-be-removed&quot; buffer
    <a href="#633285" title="=&gt; scala.collection.mutable.Set[tools.nsc.io.AbstractFile]">toBeRemoved</a> <a href="../../../collection/generic/Growable.scala.html#60003" title="(xs: scala.collection.TraversableOnce[tools.nsc.io.AbstractFile])Global.this.toBeRemoved.type">++=</a> <a href="#633287" title="=&gt; scala.collection.mutable.Set[tools.nsc.io.AbstractFile]">toBeRemovedAfterRun</a>

    // clean out stale waiting responses
    <a href="#633296" title="()Unit">cleanAllResponses</a><span class="delimiter">(</span><span class="delimiter">)</span>

    // wind down
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633290" title="=&gt; Global.this.ResponseMap">waitLoadedTypeResponses</a>.<a href="../../../collection/TraversableOnce.scala.html#58191" title="=&gt; Boolean">nonEmpty</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#633293" title="=&gt; Global.this.ResponseMap">getParsedEnteredResponses</a>.<a href="../../../collection/TraversableOnce.scala.html#58191" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      // need another cycle to treat those
      <a href="#633404" title="()Unit">newTyperRun</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#633365" title="()Unit">backgroundCompile</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#633316" title="(x$1: Boolean)Unit">outOfDate</a> = <span title="Boolean(false)" class="keyword">false</span>
      <a href="#633281" title="(msg: =&gt; String)Unit">informIDE</a><span class="delimiter">(</span><span title="String(&quot;Everything is now up to date&quot;)" class="string">&quot;Everything is now up to date&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Service all pending getParsedEntered requests
   */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="633366">serviceParsedEntered</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Boolean" id="851157">atOldRun</a> = <span title="Boolean(true)" class="keyword">true</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../../../Tuple2.scala.html#60635" title="scala.reflect.internal.util.SourceFile" id="851182">source</a>, <a href="../../../Tuple2.scala.html#60637" title="scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]]" id="851183">rs</a><span class="delimiter">)</span> &lt;- <a href="../../../collection/mutable/HashMap.scala.html#88253" title="(f: ((scala.reflect.internal.util.SourceFile, scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]])) =&gt; Unit)Unit">getParsedEnteredResponses</a>; <a title="Global.this.Response[Global.this.Tree]" id="851200">r</a> &lt;- <a href="../../../collection/IterableLike.scala.html#58562" title="(f: Global.this.Response[Global.this.Tree] =&gt; Unit)Unit">rs</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#851157" title="Boolean">atOldRun</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#633404" title="()Unit">newTyperRun</a><span class="delimiter">(</span><span class="delimiter">)</span>; <a href="#851157" title="Boolean">atOldRun</a> = <span title="Boolean(false)" class="keyword">false</span> <span class="delimiter">}</span>
      <a href="#633400" title="(source: scala.reflect.internal.util.SourceFile, response: Global.this.Response[Global.this.Tree])Unit">getParsedEnteredNow</a><span class="delimiter">(</span><a href="#851182" title="scala.reflect.internal.util.SourceFile">source</a>, <a href="#851200" title="Global.this.Response[Global.this.Tree]">r</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#633293" title="=&gt; Global.this.ResponseMap">getParsedEnteredResponses</a>.<a href="../../../collection/mutable/HashMap.scala.html#88240" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Reset unit to unloaded state */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(unit: Global.this.RichCompilationUnit)Unit" id="633367">reset</a><span class="delimiter">(</span><a title="Global.this.RichCompilationUnit" id="850971">unit</a>: <a href="RichCompilationUnits.scala.html#633538" title="Global.this.RichCompilationUnit">RichCompilationUnit</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> = <span class="delimiter">{</span>
    <a href="#850971" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539282" title="=&gt; scala.collection.mutable.HashSet[Global.this.Symbol]">depends</a>.<a href="../../../collection/mutable/HashSet.scala.html#125968" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#850971" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539284" title="=&gt; scala.collection.mutable.HashSet[Global.this.Symbol]">defined</a>.<a href="../../../collection/mutable/HashSet.scala.html#125968" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#850971" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539286" title="=&gt; scala.collection.mutable.HashMap[Global.this.Symbol,Global.this.Tree]">synthetics</a>.<a href="../../../collection/mutable/HashMap.scala.html#88240" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#850971" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539288" title="=&gt; scala.collection.mutable.ListBuffer[() =&gt; Unit]">toCheck</a>.<a href="../../../collection/mutable/ListBuffer.scala.html#79768" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#850971" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539291" title="(x$1: scala.collection.immutable.Set[Global.this.Symbol])Unit">checkedFeatures</a> = <a href="../../../collection/generic/GenericCompanion.scala.html#59933" title="(elems: Global.this.Symbol*)scala.collection.immutable.Set[Global.this.Symbol]">Set</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#850971" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#846005" title="(p: Global.this.Position)Unit">targetPos</a> = <a href="../../../reflect/internal/Positions.scala.html#408302" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a>
    <a href="#850971" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#846006" title="=&gt; Global.this.Contexts">contexts</a>.<a href="../../../collection/mutable/ArrayBuffer.scala.html#66877" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#850971" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845999" title="=&gt; scala.collection.mutable.ArrayBuffer[scala.tools.nsc.interactive.Problem]">problems</a>.<a href="../../../collection/mutable/ArrayBuffer.scala.html#66877" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#850971" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539279" title="(x$1: Global.this.Tree)Unit">body</a> = <a href="../../../reflect/internal/Trees.scala.html#407946" title="Global.this.EmptyTree.type">EmptyTree</a>
    <a href="#850971" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845991" title="(x$1: Int)Unit">status</a> = <span title="Int(-2)">NotLoaded</span>
  <span class="delimiter">}</span>

  /** Parse unit and create a name index, unless this has already been done before */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(unit: Global.this.RichCompilationUnit)Unit" id="633368">parseAndEnter</a><span class="delimiter">(</span><a title="Global.this.RichCompilationUnit" id="850973">unit</a>: <a href="RichCompilationUnits.scala.html#633538" title="Global.this.RichCompilationUnit">RichCompilationUnit</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> =
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#850973" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845990" title="=&gt; Int">status</a> <a href="../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(-2)">NotLoaded</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;parsing: &quot;)" class="string">&quot;parsing: &quot;</span><span title="(x$1: Any)String">+</span><a href="#850973" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
      <a href="#633313" title="=&gt; Global.this.TyperRun">currentTyperRun</a>.<a href="../Global.scala.html#539436" title="(unit: Global.this.CompilationUnit)Unit">compileLate</a><span class="delimiter">(</span><a href="#850973" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633264" title="=&gt; Boolean">debugIDE</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="../Global.scala.html#537436" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="../reporters/Reporter.scala.html#539679" title="=&gt; Boolean">hasErrors</a><span class="delimiter">)</span> <a href="RangePositions.scala.html#633515" title="(tree: Global.this.Tree)Unit">validatePositions</a><span class="delimiter">(</span><a href="#850973" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539278" title="=&gt; Global.this.Tree">body</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#850973" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539305" title="=&gt; Boolean">isJava</a><span class="delimiter">)</span> <a href="#633370" title="(unit: Global.this.RichCompilationUnit)Unit">syncTopLevelSyms</a><span class="delimiter">(</span><a href="#850973" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
      <a href="#850973" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845991" title="(x$1: Int)Unit">status</a> = <span title="Int(-1)">JustParsed</span>
    <span class="delimiter">}</span>

  /** Make sure unit is typechecked
   */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(unit: Global.this.RichCompilationUnit)Unit" id="633369">typeCheck</a><span class="delimiter">(</span><a title="Global.this.RichCompilationUnit" id="851031">unit</a>: <a href="RichCompilationUnits.scala.html#633538" title="Global.this.RichCompilationUnit">RichCompilationUnit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;type checking: &quot;)" class="string">&quot;type checking: &quot;</span><span title="(x$1: Any)String">+</span><a href="#851031" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
    <a href="#633368" title="(unit: Global.this.RichCompilationUnit)Unit">parseAndEnter</a><span class="delimiter">(</span><a href="#851031" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
    <a href="#851031" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845991" title="(x$1: Int)Unit">status</a> = <span title="Int(0)">PartiallyChecked</span>
    <a href="#633313" title="=&gt; Global.this.TyperRun">currentTyperRun</a>.<a href="#850045" title="(unit: Global.this.CompilationUnit)Unit">typeCheck</a><span class="delimiter">(</span><a href="#851031" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
    <a href="#851031" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#846010" title="(x$1: Global.this.Tree)Unit">lastBody</a> = <a href="#851031" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539278" title="=&gt; Global.this.Tree">body</a>
    <a href="#851031" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845991" title="(x$1: Int)Unit">status</a> = <a href="../Global.scala.html#537743" title="=&gt; Int">currentRunId</a>
  <span class="delimiter">}</span>

  /** Update deleted and current top-level symbols sets */
  <span class="keyword">def</span> <a title="(unit: Global.this.RichCompilationUnit)Unit" id="633370">syncTopLevelSyms</a><span class="delimiter">(</span><a title="Global.this.RichCompilationUnit" id="851231">unit</a>: <a href="RichCompilationUnits.scala.html#633538" title="Global.this.RichCompilationUnit">RichCompilationUnit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.LinkedHashSet[Global.this.Symbol]" id="851236">deleted</a> = <a href="#633334" title="=&gt; scala.collection.mutable.LinkedHashSet[Global.this.Symbol]">currentTopLevelSyms</a> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: Global.this.Symbol =&gt; Boolean)scala.collection.mutable.LinkedHashSet[Global.this.Symbol]">filter</a> <span class="delimiter">{</span> <a title="Global.this.Symbol" id="851240">sym</a> =&gt;
      /** We sync after namer phase and it resets all the top-level symbols
       *  that survive the new parsing
       *  round to NoPeriod.
       */
      <a href="#851240" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411483" title="=&gt; scala.reflect.io.AbstractFile">sourceFile</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#851231" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539270" title="=&gt; scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
      <a href="#851240" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411097" title="=&gt; Global.this.Period">validTo</a> <a href="../../../Int.scala.html#57104" title="(x: Int)Boolean">!=</a> <span title="Int(0)">NoPeriod</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
      <a href="../../../reflect/internal/SymbolTable.scala.html#406665" title="(period: Global.this.Period)Global.this.RunId">runId</a><span class="delimiter">(</span><a href="#851240" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411097" title="=&gt; Global.this.Period">validTo</a><span class="delimiter">)</span> <a href="../../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="../Global.scala.html#537743" title="=&gt; Int">currentRunId</a>
    <span class="delimiter">}</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.Symbol" id="851274">d</a> &lt;- <a href="../../../collection/mutable/LinkedHashSet.scala.html#285734" title="(f: Global.this.Symbol =&gt; scala.collection.mutable.LinkedHashSet[Global.this.Symbol])Unit">deleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#851274" title="Global.this.Symbol">d</a>.<a href="../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; Global.this.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#411367" title="=&gt; Global.this.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#408442" title="=&gt; Global.this.Scope">decls</a> <a href="../../../reflect/internal/Scopes.scala.html#410516" title="(sym: Global.this.Symbol)Unit">unlink</a> <a href="#851274" title="Global.this.Symbol">d</a>
      <a href="#633336" title="=&gt; scala.collection.mutable.LinkedHashSet[Global.this.Symbol] with scala.collection.mutable.SynchronizedSet[Global.this.Symbol]">deletedTopLevelSyms</a> <a href="../../../collection/mutable/SynchronizedSet.scala.html#300417" title="(elem: Global.this.Symbol)scala.tools.nsc.interactive.Global.&lt;refinement&gt;.type">+=</a> <a href="#851274" title="Global.this.Symbol">d</a>
      <a href="#633334" title="=&gt; scala.collection.mutable.LinkedHashSet[Global.this.Symbol]">currentTopLevelSyms</a> <a href="../../../collection/mutable/LinkedHashSet.scala.html#285730" title="(elem: Global.this.Symbol)Global.this.currentTopLevelSyms.type">-=</a> <a href="#851274" title="Global.this.Symbol">d</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Move list of files to front of allSources */
  <span class="keyword">def</span> <a title="(fs: List[scala.reflect.internal.util.SourceFile])Unit" id="633371">moveToFront</a><span class="delimiter">(</span><a title="List[scala.reflect.internal.util.SourceFile]" id="847418">fs</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[scala.reflect.internal.util.SourceFile]">List</a><span class="delimiter">[</span>SourceFile<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633302" title="(x$1: List[scala.reflect.internal.util.SourceFile])Unit">allSources</a> = <a href="#847418" title="List[scala.reflect.internal.util.SourceFile]">fs</a> <a href="../../../collection/immutable/List.scala.html#62688" title="(prefix: List[scala.reflect.internal.util.SourceFile])List[scala.reflect.internal.util.SourceFile]">:::</a> <span class="delimiter">(</span><a href="#633302" title="=&gt; List[scala.reflect.internal.util.SourceFile]">allSources</a> <a href="../../../collection/SeqLike.scala.html#58830" title="(that: scala.collection.GenSeq[scala.reflect.internal.util.SourceFile])List[scala.reflect.internal.util.SourceFile]">diff</a> <a href="#847418" title="List[scala.reflect.internal.util.SourceFile]">fs</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  // ----------------- Implementations of client commands -----------------------

  <span class="keyword">def</span> <a title="[T](result: Global.this.Response[T])(op: =&gt; T)Unit" id="633372">respond</a><span class="delimiter">[</span><a title="" id="633374">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Global.this.Response[T]" id="846795">result</a>: <a href="Response.scala.html#36348" title="Global.this.Response[T]">Response</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; T" id="846796">op</a>: =&gt; T<span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> =
    <a href="#633375" title="(response: Global.this.Response[T])(op: =&gt; Stream[T])Unit">respondGradually</a><span class="delimiter">(</span><a href="#846795" title="Global.this.Response[T]">result</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../../../collection/immutable/Stream.scala.html#143245" title="(xs: T*)scala.collection.immutable.Stream[T]">Stream</a><span class="delimiter">(</span><a href="#846796" title="=&gt; T">op</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[T](response: Global.this.Response[T])(op: =&gt; Stream[T])Unit" id="633375">respondGradually</a><span class="delimiter">[</span><a title="" id="633377">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Global.this.Response[T]" id="851317">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[T]">Response</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; Stream[T]" id="851318">op</a>: =&gt; Stream<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.tools.nsc.interactive.Response[_]" id="851336">prevResponse</a> = <a href="#633329" title="=&gt; Global.this.Response[_]">pendingResponse</a>
    <a href="#3330672" title="Unit" id="3330663" class="keyword">try</a> <span class="delimiter">{</span>
      <a href="#633329" title="(x$1: Global.this.Response[_])Unit">pendingResponse</a> = <a href="#851317" title="Global.this.Response[T]">response</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#851317" title="Global.this.Response[T]">response</a>.<a href="Response.scala.html#633707" title="=&gt; Boolean">isCancelled</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">var</span> <a title="Stream[T]" id="851340">results</a> = <a href="#851318" title="=&gt; Stream[T]">op</a>
        <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#851317" title="Global.this.Response[T]">response</a>.<a href="Response.scala.html#633707" title="=&gt; Boolean">isCancelled</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#851340" title="Stream[T]">results</a>.<a href="../../../collection/TraversableOnce.scala.html#58191" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <a href="#851341" title="()Unit" class="delimiter">{</a>
          <span class="keyword">val</span> <a title="T" id="851343">result</a> = <a href="#851340" title="Stream[T]">results</a>.<a href="../../../collection/IterableLike.scala.html#58577" title="=&gt; T">head</a>
          <a href="#851340" title="Stream[T]">results</a> = <a href="#851340" title="Stream[T]">results</a>.<a href="../../../collection/TraversableLike.scala.html#58104" title="=&gt; scala.collection.immutable.Stream[T]">tail</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#851340" title="Stream[T]">results</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#851317" title="Global.this.Response[T]">response</a> <a href="Response.scala.html#633701" title="(x: T)Unit">set</a> <a href="#851343" title="T">result</a>
            <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;responded&quot;)" class="string">&quot;responded&quot;</span><span title="(x$1: Any)String">+</span><a href="#633279" title="=&gt; String">timeStep</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#851317" title="Global.this.Response[T]">response</a> <a href="Response.scala.html#633700" title="(x: T)Unit">setProvisionally</a> <a href="#851343" title="T">result</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#852787" title="Unit" id="3330665">CancelException</a> =&gt;
        <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><a href="#3330672" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;cancelled&quot;)" class="string">&quot;cancelled&quot;</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="#3330663" title="Unit" id="3330666">ex</a>: FreshRunReq =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633264" title="=&gt; Boolean">debugIDE</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;FreshRunReq thrown during response&quot;)" class="string">&quot;FreshRunReq thrown during response&quot;</span><span class="delimiter">)</span>
          ex.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#851317" title="Global.this.Response[T]">response</a> <a href="Response.scala.html#633702" title="(exc: Throwable)Unit">raise</a> ex
        <span title="Nothing" class="keyword">throw</span> ex

      <span class="keyword">case</span> ex @ <a href="CompilerControl.scala.html#35992" title="Unit" id="3330668">ShutdownReq</a> =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633264" title="=&gt; Boolean">debugIDE</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;ShutdownReq thrown during response&quot;)" class="string">&quot;ShutdownReq thrown during response&quot;</span><span class="delimiter">)</span>
          ex.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#851317" title="Global.this.Response[T]">response</a> <a href="Response.scala.html#633702" title="(exc: Throwable)Unit">raise</a> ex
        <span title="Nothing" class="keyword">throw</span> ex

      <span class="keyword">case</span> <a href="#3330663" title="Unit" id="3330669">ex</a>: Throwable =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#633264" title="=&gt; Boolean">debugIDE</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;exception thrown during response: &quot;)" class="string">&quot;exception thrown during response: &quot;</span><span title="(x$1: Any)String">+</span>ex<span class="delimiter">)</span>
          ex.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#851317" title="Global.this.Response[T]">response</a> <a href="Response.scala.html#633702" title="(exc: Throwable)Unit">raise</a> ex
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="#633329" title="(x$1: Global.this.Response[_])Unit">pendingResponse</a> = <a href="#851336" title="scala.tools.nsc.interactive.Response[_]">prevResponse</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile)Unit" id="633378">reloadSource</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="851381">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Global.this.RichCompilationUnit" id="851383">unit</a> = <span title="Global.this.RichCompilationUnit" class="keyword">new</span> <a href="RichCompilationUnits.scala.html#633538" title="Global.this.RichCompilationUnit">RichCompilationUnit</a><span class="delimiter">(</span><a href="#851381" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span>
    <a href="../../../collection/mutable/SynchronizedMap.scala.html#299892" title="(key: tools.nsc.io.AbstractFile, value: Global.this.RichCompilationUnit)Unit">unitOfFile</a><span class="delimiter">(</span><a href="#851381" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a><span class="delimiter">)</span> = <a href="#851383" title="Global.this.RichCompilationUnit">unit</a>
    <a href="#633285" title="=&gt; scala.collection.mutable.Set[tools.nsc.io.AbstractFile]">toBeRemoved</a> <a href="../../../collection/mutable/SetLike.scala.html#90898" title="(elem: tools.nsc.io.AbstractFile)Global.this.toBeRemoved.type">-=</a> <a href="#851381" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a>
    <a href="#633287" title="=&gt; scala.collection.mutable.Set[tools.nsc.io.AbstractFile]">toBeRemovedAfterRun</a> <a href="../../../collection/mutable/SetLike.scala.html#90898" title="(elem: tools.nsc.io.AbstractFile)Global.this.toBeRemovedAfterRun.type">-=</a> <a href="#851381" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a>
    <a href="#633367" title="(unit: Global.this.RichCompilationUnit)Unit">reset</a><span class="delimiter">(</span><a href="#851383" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
    //parseAndEnter(unit)
  <span class="delimiter">}</span>

  /** Make sure a set of compilation units is loaded and parsed */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sources: List[scala.reflect.internal.util.SourceFile])Unit" id="633379">reloadSources</a><span class="delimiter">(</span><a title="List[scala.reflect.internal.util.SourceFile]" id="851402">sources</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[scala.reflect.internal.util.SourceFile]">List</a><span class="delimiter">[</span>SourceFile<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633404" title="()Unit">newTyperRun</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#633321" title="(x$1: Int)Unit">minRunId</a> = <a href="../Global.scala.html#537743" title="=&gt; Int">currentRunId</a>
    <a href="#851402" title="List[scala.reflect.internal.util.SourceFile]">sources</a> <a href="../../../collection/immutable/List.scala.html#62719" title="(f: scala.reflect.internal.util.SourceFile =&gt; Unit)Unit">foreach</a> <a href="#633378" title="(source: scala.reflect.internal.util.SourceFile)Unit">reloadSource</a>
    <a href="#633371" title="(fs: List[scala.reflect.internal.util.SourceFile])Unit">moveToFront</a><span class="delimiter">(</span><a href="#851402" title="List[scala.reflect.internal.util.SourceFile]">sources</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Make sure a set of compilation units is loaded and parsed */
  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(sources: List[scala.reflect.internal.util.SourceFile], response: Global.this.Response[Unit])Unit" id="633380">reload</a><span class="delimiter">(</span><a title="List[scala.reflect.internal.util.SourceFile]" id="847100">sources</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[scala.reflect.internal.util.SourceFile]">List</a><span class="delimiter">[</span>SourceFile<span class="delimiter">]</span>, <a title="Global.this.Response[Unit]" id="847101">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[Unit]">Response</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633281" title="(msg: =&gt; String)Unit">informIDE</a><span class="delimiter">(</span><span title="String(&quot;reload: &quot;)" class="string">&quot;reload: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#847100" title="List[scala.reflect.internal.util.SourceFile]">sources</a><span class="delimiter">)</span>
    <a href="#633351" title="(x$1: Boolean)Unit">lastWasReload</a> = <span title="Boolean(true)" class="keyword">true</span>
    <a href="#633372" title="(result: Global.this.Response[Unit])(op: =&gt; Unit)Unit">respond</a><span class="delimiter">(</span><a href="#847101" title="Global.this.Response[Unit]">response</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#633379" title="(sources: List[scala.reflect.internal.util.SourceFile])Unit">reloadSources</a><span class="delimiter">(</span><a href="#847100" title="List[scala.reflect.internal.util.SourceFile]">sources</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#633319" title="()Unit">demandNewCompilerRun</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(sources: List[scala.reflect.internal.util.SourceFile], response: Global.this.Response[Unit])Unit" id="633381">filesDeleted</a><span class="delimiter">(</span><a title="List[scala.reflect.internal.util.SourceFile]" id="847152">sources</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[scala.reflect.internal.util.SourceFile]">List</a><span class="delimiter">[</span>SourceFile<span class="delimiter">]</span>, <a title="Global.this.Response[Unit]" id="847153">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[Unit]">Response</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633281" title="(msg: =&gt; String)Unit">informIDE</a><span class="delimiter">(</span><span title="String(&quot;files deleted: &quot;)" class="string">&quot;files deleted: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#847152" title="List[scala.reflect.internal.util.SourceFile]">sources</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Set[scala.reflect.io.AbstractFile]" id="851433">deletedFiles</a> = <a href="#847152" title="List[scala.reflect.internal.util.SourceFile]">sources</a>.<a href="../../../collection/TraversableLike.scala.html#58063" title="(f: scala.reflect.internal.util.SourceFile =&gt; scala.reflect.io.AbstractFile)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.reflect.internal.util.SourceFile],scala.reflect.io.AbstractFile,List[scala.reflect.io.AbstractFile]])List[scala.reflect.io.AbstractFile]">map</a><a href="../../../collection/immutable/List.scala.html#62442" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,scala.reflect.io.AbstractFile,List[scala.reflect.io.AbstractFile]]" class="delimiter">(</a><a href="#851451" title="scala.reflect.internal.util.SourceFile">_</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a><span class="delimiter">)</span>.<a href="../../../collection/TraversableOnce.scala.html#58270" title="scala.collection.immutable.Set[scala.reflect.io.AbstractFile]">toSet</a>
    <span class="keyword">val</span> <a title="scala.collection.mutable.LinkedHashSet[Global.this.Symbol]" id="851434">deletedSyms</a> = <a href="#633334" title="=&gt; scala.collection.mutable.LinkedHashSet[Global.this.Symbol]">currentTopLevelSyms</a> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: Global.this.Symbol =&gt; Boolean)scala.collection.mutable.LinkedHashSet[Global.this.Symbol]">filter</a> <span class="delimiter">{</span><a title="Global.this.Symbol" id="851488">sym</a> =&gt; <a href="#851433" title="scala.collection.immutable.Set[scala.reflect.io.AbstractFile]">deletedFiles</a> <a href="../../../collection/SetLike.scala.html#66442" title="(elem: scala.reflect.io.AbstractFile)Boolean">contains</a> <a href="#851488" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411483" title="=&gt; scala.reflect.io.AbstractFile">sourceFile</a><span class="delimiter">}</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.Symbol" id="851509">d</a> &lt;- <a href="../../../collection/mutable/LinkedHashSet.scala.html#285734" title="(f: Global.this.Symbol =&gt; scala.collection.mutable.LinkedHashSet[Global.this.Symbol])Unit">deletedSyms</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#851509" title="Global.this.Symbol">d</a>.<a href="../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; Global.this.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#411367" title="=&gt; Global.this.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#408442" title="=&gt; Global.this.Scope">decls</a> <a href="../../../reflect/internal/Scopes.scala.html#410516" title="(sym: Global.this.Symbol)Unit">unlink</a> <a href="#851509" title="Global.this.Symbol">d</a>
      <a href="#633336" title="=&gt; scala.collection.mutable.LinkedHashSet[Global.this.Symbol] with scala.collection.mutable.SynchronizedSet[Global.this.Symbol]">deletedTopLevelSyms</a> <a href="../../../collection/mutable/SynchronizedSet.scala.html#300417" title="(elem: Global.this.Symbol)scala.tools.nsc.interactive.Global.&lt;refinement&gt;.type">+=</a> <a href="#851509" title="Global.this.Symbol">d</a>
      <a href="#633334" title="=&gt; scala.collection.mutable.LinkedHashSet[Global.this.Symbol]">currentTopLevelSyms</a> <a href="../../../collection/mutable/LinkedHashSet.scala.html#285730" title="(elem: Global.this.Symbol)Global.this.currentTopLevelSyms.type">-=</a> <a href="#851509" title="Global.this.Symbol">d</a>
    <span class="delimiter">}</span>
    <a href="#847152" title="List[scala.reflect.internal.util.SourceFile]">sources</a> <a href="../../../collection/immutable/List.scala.html#62719" title="(f: scala.reflect.internal.util.SourceFile =&gt; Option[Global.this.RichCompilationUnit])Unit">foreach</a> <span class="delimiter">(</span><a href="CompilerControl.scala.html#633425" title="(s: scala.reflect.internal.util.SourceFile)Option[Global.this.RichCompilationUnit]">removeUnitOf</a><span class="delimiter">(</span><a href="#851544" title="scala.reflect.internal.util.SourceFile">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#633321" title="(x$1: Int)Unit">minRunId</a> = <a href="../Global.scala.html#537743" title="=&gt; Int">currentRunId</a>
    <a href="#633372" title="(result: Global.this.Response[Unit])(op: =&gt; Unit)Unit">respond</a><span class="delimiter">(</span><a href="#847153" title="Global.this.Response[Unit]">response</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#633319" title="()Unit">demandNewCompilerRun</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Arrange for unit to be removed after run, to give a chance to typecheck the unit fully.
   *  If we do just removeUnit, some problems with default parameters can ensue.
   *  Calls to this method could probably be replaced by removeUnit once default parameters are handled more robustly.
   */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile)Unit" id="633382">afterRunRemoveUnitOf</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="851553">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633287" title="=&gt; scala.collection.mutable.Set[tools.nsc.io.AbstractFile]">toBeRemovedAfterRun</a> <a href="../../../collection/mutable/SetLike.scala.html#90897" title="(elem: tools.nsc.io.AbstractFile)Global.this.toBeRemovedAfterRun.type">+=</a> <a href="#851553" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a>
  <span class="delimiter">}</span>

  /** A fully attributed tree located at position `pos` */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: Global.this.Position)Global.this.Tree" id="633383">typedTreeAt</a><span class="delimiter">(</span><a title="Global.this.Position" id="851563">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Global.this.Position">Position</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a> = <a href="#633300" title="(s: scala.reflect.internal.util.SourceFile)Option[Global.this.RichCompilationUnit]">getUnit</a><a href="#3330700" title="(x: Global.this.Tree)Global.this.Tree" class="delimiter">(</a><a href="#851563" title="Global.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409665" title="=&gt; scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="../../../Option.scala.html#1585" title="Global.this.Tree" id="3330698">None</a> =&gt;
      <a href="#633379" title="(sources: List[scala.reflect.internal.util.SourceFile])Unit">reloadSources</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#62451" title="(xs: scala.reflect.internal.util.SourceFile*)List[scala.reflect.internal.util.SourceFile]">List</a><span class="delimiter">(</span><a href="#851563" title="Global.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409665" title="=&gt; scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">try</span> <a href="#633383" title="(pos: Global.this.Position)Global.this.Tree">typedTreeAt</a><span class="delimiter">(</span><a href="#851563" title="Global.this.Position">pos</a><span class="delimiter">)</span>
      <span class="keyword">finally</span> <a href="#633382" title="(source: scala.reflect.internal.util.SourceFile)Unit">afterRunRemoveUnitOf</a><span class="delimiter">(</span><a href="#851563" title="Global.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409665" title="=&gt; scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span>
    <span class="keyword">case</span> Some<a href="#3330695" title="Global.this.Tree" id="3330697" class="delimiter">(</a><a href="../../../Option.scala.html#63132" title="Global.this.RichCompilationUnit" id="851573">unit</a><span class="delimiter">)</span> =&gt;
      <a href="#633281" title="(msg: =&gt; String)Unit">informIDE</a><span class="delimiter">(</span><span title="String(&quot;typedTreeAt &quot;)" class="string">&quot;typedTreeAt &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#851563" title="Global.this.Position">pos</a><span class="delimiter">)</span>
      <a href="#633368" title="(unit: Global.this.RichCompilationUnit)Unit">parseAndEnter</a><span class="delimiter">(</span><a href="#851573" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Global.this.Tree" id="851574">tree</a> = <a href="CompilerControl.scala.html#633427" title="(pos: Global.this.Position)Global.this.Tree">locateTree</a><span class="delimiter">(</span><a href="#851563" title="Global.this.Position">pos</a><span class="delimiter">)</span>
      <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;at pos &quot;)" class="string">&quot;at pos &quot;</span><span title="(x$1: Any)String">+</span><a href="#851563" title="Global.this.Position">pos</a><span title="(x$1: Any)String">+</span><span title="String(&quot; was found: &quot;)" class="string">&quot; was found: &quot;</span><span title="(x$1: Any)String">+</span><a href="#851574" title="Global.this.Tree">tree</a>.<span title="()Class[_]">getClass</span><span title="(x$1: Any)String">+</span><span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span title="(x$1: Any)String">+</span><a href="#851574" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Global.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409699" title="=&gt; String">show</a><span class="delimiter">)</span>
      <a href="#851574" title="Global.this.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Import<a href="#3330685" title="Unit" id="3330688" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410214" title="Global.this.Tree" id="851580">expr</a>, <a href="../../../reflect/internal/Trees.scala.html#410216" title="List[Global.this.ImportSelector]" id="3330686">_</a><span class="delimiter">)</span> =&gt;
          <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><a href="#3330690" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;import found&quot;)" class="string">&quot;import found&quot;</span><span title="(x$1: Any)String">+</span><a href="#851580" title="Global.this.Tree">expr</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a><span title="(x$1: Any)String">+</span><span class="delimiter">(</span><span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#851580" title="Global.this.Tree">expr</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span title="(x$1: Any)String">+</span><a href="#851580" title="Global.this.Tree">expr</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#408446" title="=&gt; Global.this.Scope">members</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt;
      <span class="delimiter">}</span>
      <span title="Global.this.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#633388" title="(tree: Global.this.Tree)Global.this.Type">stabilizedType</a><span class="delimiter">(</span><a href="#851574" title="Global.this.Tree">tree</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;already attributed: &quot;)" class="string">&quot;already attributed: &quot;</span><span title="(x$1: Any)String">+</span><a href="#851574" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; Global.this.Symbol">symbol</a><span title="(x$1: Any)String">+</span><span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span title="(x$1: Any)String">+</span><a href="#851574" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a><span class="delimiter">)</span>
        <a href="#851574" title="Global.this.Tree">tree</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#851573" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#846005" title="(p: Global.this.Position)Unit">targetPos</a> = <a href="#851563" title="Global.this.Position">pos</a>
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;starting targeted type check&quot;)" class="string">&quot;starting targeted type check&quot;</span><span class="delimiter">)</span>
          <a href="#633369" title="(unit: Global.this.RichCompilationUnit)Unit">typeCheck</a><span class="delimiter">(</span><a href="#851573" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
          <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;tree not found at &quot;)" class="string">&quot;tree not found at &quot;</span><span title="(x$1: Any)String">+</span><a href="#851563" title="Global.this.Position">pos</a><span class="delimiter">)</span>
          <a href="../../../reflect/internal/Trees.scala.html#407946" title="Global.this.EmptyTree.type">EmptyTree</a>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a title="Global.this.Tree" id="851592">ex</a>: <a href="#633405" title="Global.this.TyperResult">TyperResult</a> =&gt; <span title="Global.this.Locator" class="keyword">new</span> <a href="RangePositions.scala.html#633517" title="Global.this.Locator">Locator</a><span class="delimiter">(</span><a href="#851563" title="Global.this.Position">pos</a><span class="delimiter">)</span> <a href="RangePositions.scala.html#846570" title="(root: Global.this.Tree)Global.this.Tree">locateIn</a> <a href="#851592" title="Global.this.TyperResult">ex</a>.<a href="#850106" title="=&gt; Global.this.Tree">tree</a>
        <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
          <a href="#851573" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#846005" title="(p: Global.this.Position)Unit">targetPos</a> = <a href="../../../reflect/internal/Positions.scala.html#408302" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** A fully attributed tree corresponding to the entire compilation unit  */
  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile, forceReload: Boolean)Global.this.Tree" id="633384">typedTree</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="851595">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a>, <a title="Boolean" id="851596">forceReload</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a> = <span class="delimiter">{</span>
    <a href="#633281" title="(msg: =&gt; String)Unit">informIDE</a><span class="delimiter">(</span><span title="String(&quot;typedTree &quot;)" class="string">&quot;typedTree &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#851595" title="scala.reflect.internal.util.SourceFile">source</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; forceReload: &quot;)" class="string">&quot; forceReload: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#851596" title="Boolean">forceReload</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Global.this.RichCompilationUnit" id="851598">unit</a> = <a href="#633299" title="(source: scala.reflect.internal.util.SourceFile)Global.this.RichCompilationUnit">getOrCreateUnitOf</a><span class="delimiter">(</span><a href="#851595" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#851596" title="Boolean">forceReload</a><span class="delimiter">)</span> <a href="#633367" title="(unit: Global.this.RichCompilationUnit)Unit">reset</a><span class="delimiter">(</span><a href="#851598" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
    <a href="#633368" title="(unit: Global.this.RichCompilationUnit)Unit">parseAndEnter</a><span class="delimiter">(</span><a href="#851598" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#851598" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845990" title="=&gt; Int">status</a> <a href="../../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <span title="Int(0)">PartiallyChecked</span><span class="delimiter">)</span> <a href="#633369" title="(unit: Global.this.RichCompilationUnit)Unit">typeCheck</a><span class="delimiter">(</span><a href="#851598" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
    <a href="#851598" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539278" title="=&gt; Global.this.Tree">body</a>
  <span class="delimiter">}</span>

  /** Set sync var `response` to a fully attributed tree located at position `pos`  */
  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(pos: Global.this.Position, response: Global.this.Response[Global.this.Tree])Unit" id="633385">getTypedTreeAt</a><span class="delimiter">(</span><a title="Global.this.Position" id="847203">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Global.this.Position">Position</a>, <a title="Global.this.Response[Global.this.Tree]" id="847204">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[Global.this.Tree]">Response</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633372" title="(result: Global.this.Response[Global.this.Tree])(op: =&gt; Global.this.Tree)Unit">respond</a><span class="delimiter">(</span><a href="#847204" title="Global.this.Response[Global.this.Tree]">response</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#633383" title="(pos: Global.this.Position)Global.this.Tree">typedTreeAt</a><span class="delimiter">(</span><a href="#847203" title="Global.this.Position">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Set sync var `response` to a fully attributed tree corresponding to the
   *  entire compilation unit  */
  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile, forceReload: Boolean, response: Global.this.Response[Global.this.Tree])Unit" id="633386">getTypedTree</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="847255">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a>, <a title="Boolean" id="847256">forceReload</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a>, <a title="Global.this.Response[Global.this.Tree]" id="847257">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[Global.this.Tree]">Response</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633372" title="(result: Global.this.Response[Global.this.Tree])(op: =&gt; Global.this.Tree)Unit">respond</a><span class="delimiter">(</span><a href="#847257" title="Global.this.Response[Global.this.Tree]">response</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#633384" title="(source: scala.reflect.internal.util.SourceFile, forceReload: Boolean)Global.this.Tree">typedTree</a><span class="delimiter">(</span><a href="#847255" title="scala.reflect.internal.util.SourceFile">source</a>, <a href="#847256" title="Boolean">forceReload</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Implements CompilerControl.askLinkPos */
  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(sym: Global.this.Symbol, source: scala.reflect.internal.util.SourceFile, response: Global.this.Response[Global.this.Position])Unit" id="633387">getLinkPos</a><span class="delimiter">(</span><a title="Global.this.Symbol" id="847438">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Global.this.Symbol">Symbol</a>, <a title="scala.reflect.internal.util.SourceFile" id="847439">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a>, <a title="Global.this.Response[Global.this.Position]" id="847440">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[Global.this.Position]">Response</a><span class="delimiter">[</span>Position<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>

    /** Find position of symbol `sym` in unit `unit`. Pre: `unit is loaded. */
    <span class="keyword">def</span> <a title="(unit: Global.this.RichCompilationUnit)Global.this.Position" id="851617">findLinkPos</a><span class="delimiter">(</span><a title="Global.this.RichCompilationUnit" id="851618">unit</a>: <a href="RichCompilationUnits.scala.html#633538" title="Global.this.RichCompilationUnit">RichCompilationUnit</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Global.this.Position">Position</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[Global.this.Symbol]" id="851619">originalTypeParams</a> = <a href="#847438" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; Global.this.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#411389" title="=&gt; List[Global.this.Symbol]">typeParams</a>
      <a href="#633368" title="(unit: Global.this.RichCompilationUnit)Unit">parseAndEnter</a><span class="delimiter">(</span><a href="#851618" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Global.this.Type" id="851620">pre</a> = <a href="../../../reflect/internal/Types.scala.html#474748" title="(tp: Global.this.Type)Global.this.Type">adaptToNewRunMap</a><span class="delimiter">(</span><a href="../../../reflect/internal/Types.scala.html#442139" title="(sym: Global.this.Symbol)Global.this.Type">ThisType</a><span class="delimiter">(</span><a href="#847438" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; Global.this.Symbol">owner</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Global.this.Symbol" id="851621">rawsym</a> = <a href="#851620" title="Global.this.Type">pre</a>.<a href="../../../reflect/internal/Types.scala.html#408407" title="=&gt; Global.this.Symbol">typeSymbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#411367" title="=&gt; Global.this.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#408443" title="(name: Global.this.Name)Global.this.Symbol">decl</a><span class="delimiter">(</span><a href="#847438" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Global.this.Symbol" id="851622">newsym</a> = <a href="#851621" title="Global.this.Symbol">rawsym</a> <a href="../../../reflect/internal/Symbols.scala.html#411414" title="(cond: Global.this.Symbol =&gt; Boolean)Global.this.Symbol">filter</a> <span class="delimiter">{</span> <a title="Global.this.Symbol" id="851632">alt</a> =&gt;
        <a href="#847438" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/api/Symbols.scala.html#402394" title="=&gt; Boolean">isType</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <span class="delimiter">{</span>
          <a href="#3330718" title="Boolean" id="3330713" class="keyword">try</a> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="Global.this.Type" id="851633">tp1</a> = <a href="#851620" title="Global.this.Type">pre</a>.<a href="../../../reflect/internal/Types.scala.html#408462" title="(sym: Global.this.Symbol)Global.this.Type">memberType</a><a href="#633406" title="(x: =&gt; Global.this.Type)Global.this.OnTypeError[Global.this.Type]" class="delimiter">(</a><a href="#851632" title="Global.this.Symbol">alt</a><span class="delimiter">)</span> <a href="#846606" title="(alt: =&gt; Global.this.Type)Global.this.Type">onTypeError</a> <a href="../../../reflect/internal/Types.scala.html#407284" title="Global.this.NoType.type">NoType</a>
            <span class="keyword">val</span> <a title="Global.this.Type" id="851634">tp2</a> = <a href="../../../reflect/internal/Types.scala.html#474748" title="(tp: Global.this.Type)Global.this.Type">adaptToNewRunMap</a><span class="delimiter">(</span><a href="#847438" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; Global.this.Type">tpe</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Types.scala.html#408465" title="(from: List[Global.this.Symbol], to: List[Global.this.Symbol])Global.this.Type">substSym</a> <span class="delimiter">(</span><a href="#851619" title="List[Global.this.Symbol]">originalTypeParams</a>, <a href="#847438" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; Global.this.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#411389" title="=&gt; List[Global.this.Symbol]">typeParams</a><span class="delimiter">)</span>
            <a href="../../../reflect/internal/Types.scala.html#407574" title="(tp1: Global.this.Type, tp2: Global.this.Type, alwaysMatchSimple: Boolean)Boolean">matchesType</a><span class="delimiter">(</span><a href="#851633" title="Global.this.Type">tp1</a>, <a href="#851634" title="Global.this.Type">tp2</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <span class="delimiter">{</span>
              <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><a href="../../../StringContext.scala.html#56629" title="(args: Any*)String">s</a>&quot;getLinkPos matchesType($<a href="#851633" title="Global.this.Type">tp1</a>, $<a href="#851634" title="Global.this.Type">tp2</a><span class="string">) failed&quot;</span><span class="delimiter">)</span>
              <span class="keyword">val</span> <a title="Global.this.Type" id="851665">tp3</a> = <a href="../../../reflect/internal/Types.scala.html#474748" title="(tp: Global.this.Type)Global.this.Type">adaptToNewRunMap</a><span class="delimiter">(</span><a href="#847438" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; Global.this.Type">tpe</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Types.scala.html#408465" title="(from: List[Global.this.Symbol], to: List[Global.this.Symbol])Global.this.Type">substSym</a> <span class="delimiter">(</span><a href="#851619" title="List[Global.this.Symbol]">originalTypeParams</a>, <a href="#851632" title="Global.this.Symbol">alt</a>.<a href="../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; Global.this.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#411389" title="=&gt; List[Global.this.Symbol]">typeParams</a><span class="delimiter">)</span>
              <a href="../../../reflect/internal/Types.scala.html#407574" title="(tp1: Global.this.Type, tp2: Global.this.Type, alwaysMatchSimple: Boolean)Boolean">matchesType</a><span class="delimiter">(</span><a href="#851633" title="Global.this.Type">tp1</a>, <a href="#851665" title="Global.this.Type">tp3</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <span class="delimiter">{</span>
                <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><a href="../../../StringContext.scala.html#56629" title="(args: Any*)String">s</a>&quot;getLinkPos fallback matchesType($<a href="#851633" title="Global.this.Type">tp1</a>, $<a href="#851665" title="Global.this.Type">tp3</a><span class="string">) failed&quot;</span><span class="delimiter">)</span>
                <span title="Boolean(false)" class="keyword">false</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
          <span class="keyword">catch</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#3330713" title="Boolean" id="3330714">ex</a>: ControlThrowable =&gt; <a href="#3330718" title="(x: Boolean)Boolean" class="keyword">throw</a> ex
            <span class="keyword">case</span> <a href="#3330713" title="Boolean" id="3330715">ex</a>: Throwable =&gt;
              <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;error in hyperlinking: &quot;)" class="string">&quot;error in hyperlinking: &quot;</span> <span title="(x$1: Any)String">+</span> ex<span class="delimiter">)</span>
              ex.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
              <span title="Boolean(false)" class="keyword">false</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span title="Global.this.Position" class="keyword">if</span> <span class="delimiter">(</span><a href="#851622" title="Global.this.Symbol">newsym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; Global.this.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Global.this.Position" class="keyword">if</span> <span class="delimiter">(</span><a href="#851621" title="Global.this.Symbol">rawsym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411310" title="=&gt; Boolean">exists</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#851621" title="Global.this.Symbol">rawsym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411206" title="=&gt; Boolean">isOverloaded</a><span class="delimiter">)</span> <a href="#851621" title="Global.this.Symbol">rawsym</a>.<a href="../../../reflect/internal/StdAttachments.scala.html#409602" title="=&gt; Global.this.Position">pos</a>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;link not found &quot;)" class="string">&quot;link not found &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#847438" title="Global.this.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#847439" title="scala.reflect.internal.util.SourceFile">source</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#851620" title="Global.this.Type">pre</a><span class="delimiter">)</span>
          <a href="../../../reflect/internal/Positions.scala.html#408302" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Global.this.Position" class="keyword">if</span> <span class="delimiter">(</span><a href="#851622" title="Global.this.Symbol">newsym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411206" title="=&gt; Boolean">isOverloaded</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#633594" title="scala.tools.nsc.Settings">settings</a>.<a href="../settings/StandardScalaSettings.scala.html#540224" title="=&gt; Global.this.settings.BooleanSetting">uniqid</a>.<a href="../../../reflect/internal/settings/MutableSettings.scala.html#423753" title="(arg: Global.this.settings.uniqid.T)Unit">value</a> = <span title="Boolean(true)" class="keyword">true</span>
        <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;link ambiguous &quot;)" class="string">&quot;link ambiguous &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#847438" title="Global.this.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#847439" title="scala.reflect.internal.util.SourceFile">source</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#851620" title="Global.this.Type">pre</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#851622" title="Global.this.Symbol">newsym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411413" title="=&gt; List[Global.this.Symbol]">alternatives</a><span class="delimiter">)</span>
        <a href="../../../reflect/internal/Positions.scala.html#408302" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;link found for &quot;)" class="string">&quot;link found for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#851622" title="Global.this.Symbol">newsym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#851622" title="Global.this.Symbol">newsym</a>.<a href="../../../reflect/internal/StdAttachments.scala.html#409602" title="=&gt; Global.this.Position">pos</a><span class="delimiter">)</span>
        <a href="#851622" title="Global.this.Symbol">newsym</a>.<a href="../../../reflect/internal/StdAttachments.scala.html#409602" title="=&gt; Global.this.Position">pos</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <a href="#633281" title="(msg: =&gt; String)Unit">informIDE</a><span class="delimiter">(</span><span title="String(&quot;getLinkPos &quot;)" class="string">&quot;getLinkPos &quot;</span><span title="(x$1: Any)String">+</span><a href="#847438" title="Global.this.Symbol">sym</a><span title="(x$1: Any)String">+</span><span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span title="(x$1: Any)String">+</span><a href="#847439" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span>
    <a href="#633372" title="(result: Global.this.Response[Global.this.Position])(op: =&gt; Global.this.Position)Unit">respond</a><span class="delimiter">(</span><a href="#847440" title="Global.this.Response[Global.this.Position]">response</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Global.this.Position" class="keyword">if</span> <span class="delimiter">(</span><a href="#847438" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; Global.this.Symbol">owner</a>.<a href="../../../reflect/api/Symbols.scala.html#402403" title="=&gt; Boolean">isClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#633300" title="(s: scala.reflect.internal.util.SourceFile)Option[Global.this.RichCompilationUnit]">getUnit</a><a href="#3330728" title="(x: Global.this.Position)Global.this.Position" class="delimiter">(</a><a href="#847439" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="../../../Option.scala.html#1585" title="Global.this.Position" id="3330726">None</a> =&gt;
            <a href="#633379" title="(sources: List[scala.reflect.internal.util.SourceFile])Unit">reloadSources</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#62451" title="(xs: scala.reflect.internal.util.SourceFile*)List[scala.reflect.internal.util.SourceFile]">List</a><span class="delimiter">(</span><a href="#847439" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">try</span> <a href="#851617" title="(unit: Global.this.RichCompilationUnit)Global.this.Position">findLinkPos</a><span class="delimiter">(</span><a href="#633300" title="(s: scala.reflect.internal.util.SourceFile)Option[Global.this.RichCompilationUnit]">getUnit</a><span class="delimiter">(</span><a href="#847439" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span>.<a href="../../../Option.scala.html#62858" title="=&gt; Global.this.RichCompilationUnit">get</a><span class="delimiter">)</span>
            <span class="keyword">finally</span> <a href="#633382" title="(source: scala.reflect.internal.util.SourceFile)Unit">afterRunRemoveUnitOf</a><span class="delimiter">(</span><a href="#847439" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span>
          <span class="keyword">case</span> Some<a href="#3330723" title="Global.this.Position" id="3330725" class="delimiter">(</a><a href="../../../Option.scala.html#63132" title="Global.this.RichCompilationUnit" id="851692">unit</a><span class="delimiter">)</span> =&gt;
            <a href="#851617" title="(unit: Global.this.RichCompilationUnit)Global.this.Position">findLinkPos</a><a href="#3330728" title="(x: Global.this.Position)Global.this.Position" class="delimiter">(</a><a href="#851692" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;link not in class &quot;)" class="string">&quot;link not in class &quot;</span><span title="(x$1: Any)String">+</span><a href="#847438" title="Global.this.Symbol">sym</a><span title="(x$1: Any)String">+</span><span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span title="(x$1: Any)String">+</span><a href="#847439" title="scala.reflect.internal.util.SourceFile">source</a><span title="(x$1: Any)String">+</span><span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span title="(x$1: Any)String">+</span><a href="#847438" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; Global.this.Symbol">owner</a><span class="delimiter">)</span>
        <a href="../../../reflect/internal/Positions.scala.html#408302" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(tree: Global.this.Tree)Global.this.Type" id="633388">stabilizedType</a><span class="delimiter">(</span><a title="Global.this.Tree" id="851587">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Types.scala.html#407270" title="Global.this.Type">Type</a> = <a href="#851587" title="Global.this.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Ident<a href="#3330761" title="Global.this.Type" id="3330764" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409987" title="Global.this.Name" id="3330762">_</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#851587" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; Global.this.Symbol">symbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#411286" title="=&gt; Boolean">isStable</a> =&gt;
      <a href="../../../reflect/internal/Types.scala.html#407398" title="(pre: Global.this.Type, sym: Global.this.Symbol)Global.this.Type">singleType</a><a href="#3330771" title="(x: Global.this.Type)Global.this.Type" class="delimiter">(</a><a href="../../../reflect/internal/Types.scala.html#407286" title="Global.this.NoPrefix.type">NoPrefix</a>, <a href="#851587" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; Global.this.Symbol">symbol</a><span class="delimiter">)</span>
    <span class="keyword">case</span> Select<a href="#3330761" title="Global.this.Type" id="3330767" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409999" title="Global.this.Tree" id="851712">qual</a>, <a href="../../../reflect/internal/Trees.scala.html#410001" title="Global.this.Name" id="3330765">_</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#851712" title="Global.this.Tree">qual</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#851587" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; Global.this.Symbol">symbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#411286" title="=&gt; Boolean">isStable</a> =&gt;
      <a href="../../../reflect/internal/Types.scala.html#407398" title="(pre: Global.this.Type, sym: Global.this.Symbol)Global.this.Type">singleType</a><a href="#3330771" title="(x: Global.this.Type)Global.this.Type" class="delimiter">(</a><a href="#851712" title="Global.this.Tree">qual</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a>, <a href="#851587" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; Global.this.Symbol">symbol</a><span class="delimiter">)</span>
    <span class="keyword">case</span> Import<a href="#3330761" title="Global.this.Type" id="3330769" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410214" title="Global.this.Tree" id="851720">expr</a>, <a href="../../../reflect/internal/Trees.scala.html#410216" title="List[Global.this.ImportSelector]" id="851721">selectors</a><span class="delimiter">)</span> =&gt;
      <a href="#851587" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; Global.this.Symbol">symbol</a>.<a href="#3330771" title="(x: Global.this.Type)Global.this.Type">info</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> analyzer.ImportType<a href="../../../Boolean.scala.html#57826" title="Global.this.Type" id="3330754" class="delimiter">(</a><a href="../typechecker/Contexts.scala.html#662189" title="Global.this.analyzer.global.Tree" id="851723">expr</a><span class="delimiter">)</span> =&gt; <a href="#3330756" title="(x: Global.this.Type)Global.this.Type">expr</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> s@Select<a href="#3330736" title="Global.this.Type" id="3330738" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409999" title="Global.this.Tree" id="851728">qual</a>, <a href="../../../reflect/internal/Trees.scala.html#410001" title="Global.this.Name" id="851729">name</a><span class="delimiter">)</span> =&gt; <a href="../../../reflect/internal/Types.scala.html#407398" title="(pre: Global.this.Type, sym: Global.this.Symbol)Global.this.Type">singleType</a><a href="#3330742" title="(x: Global.this.Type)Global.this.Type" class="delimiter">(</a><a href="#851728" title="Global.this.Tree">qual</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a>, s.<a href="../../../reflect/internal/Trees.scala.html#409939" title="=&gt; Global.this.Symbol">symbol</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="#3330736" title="Global.this.Type" id="3330740">i</a> : Ident =&gt; i.<a href="#3330742" title="(x: Global.this.Type)Global.this.Type">tpe</a>
          <span class="keyword">case</span> _ =&gt; <a href="#851587" title="Global.this.Tree">tree</a>.<a href="#3330742" title="(x: Global.this.Type)Global.this.Type">tpe</a>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> _ =&gt; <a href="#851587" title="Global.this.Tree">tree</a>.<a href="#3330756" title="(x: Global.this.Type)Global.this.Type">tpe</a>
      <span class="delimiter">}</span>

    <span class="keyword">case</span> _ =&gt; <a href="#851587" title="Global.this.Tree">tree</a>.<a href="#3330771" title="(x: Global.this.Type)Global.this.Type">tpe</a>
  <span class="delimiter">}</span>

  <span class="keyword">import</span> <a href="../Global.scala.html#537550" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: Global.this.type}">analyzer</a>.<span class="delimiter">{</span>SearchResult, ImplicitSearch<span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(pos: Global.this.Position, response: Global.this.Response[List[Global.this.Member]])Unit" id="633390">getScopeCompletion</a><span class="delimiter">(</span><a title="Global.this.Position" id="847370">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Global.this.Position">Position</a>, <a title="Global.this.Response[List[Global.this.Member]]" id="847371">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[List[Global.this.Member]]">Response</a><span class="delimiter">[</span>List<span class="delimiter">[</span>Member<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633281" title="(msg: =&gt; String)Unit">informIDE</a><span class="delimiter">(</span><span title="String(&quot;getScopeCompletion&quot;)" class="string">&quot;getScopeCompletion&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#847370" title="Global.this.Position">pos</a><span class="delimiter">)</span>
    <a href="#633372" title="(result: Global.this.Response[List[Global.this.Member]])(op: =&gt; List[Global.this.Member])Unit">respond</a><span class="delimiter">(</span><a href="#847371" title="Global.this.Response[List[Global.this.Member]]">response</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#633395" title="(pos: Global.this.Position)List[Global.this.ScopeMember]">scopeMembers</a><span class="delimiter">(</span><a href="#847370" title="Global.this.Position">pos</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Global.this.TermName" id="633391">Dollar</a> = <a href="../../../reflect/internal/Names.scala.html#406859" title="(s: String)Global.this.TermName">newTermName</a><span class="delimiter">(</span><span title="String(&quot;$&quot;)" class="string">&quot;$&quot;</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class Members[M &lt;: Global.this.Member] extends scala.collection.mutable.LinkedHashMap[Global.this.Name,Set[M]]" id="633393">Members</a><span class="delimiter">[</span><a title=" &lt;: Global.this.Member" id="633394">M</a> &lt;: Member<span class="delimiter">]</span> <a href="#633393" title="Global.this.Members[M]" class="keyword">extends</a> <a href="../../../collection/mutable/LinkedHashMap.scala.html#12729" title="scala.collection.mutable.LinkedHashMap[Global.this.Name,Set[M]]">LinkedHashMap</a><span class="delimiter">[</span>Name, Set<span class="delimiter">[</span>M<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(key: Global.this.Name)scala.collection.immutable.Set[M]" id="851741">default</a><span class="delimiter">(</span><a title="Global.this.Name" id="851762">key</a>: <a href="../../../reflect/internal/Names.scala.html#406868" title="Global.this.Name">Name</a><span class="delimiter">)</span> = <a href="../../../collection/generic/GenericCompanion.scala.html#59933" title="(elems: M*)scala.collection.immutable.Set[M]">Set</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: Global.this.Symbol, symtpe: Global.this.Type, ms: Set[M])Option[M]" id="851742">matching</a><span class="delimiter">(</span><a title="Global.this.Symbol" id="851781">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Global.this.Symbol">Symbol</a>, <a title="Global.this.Type" id="851782">symtpe</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="Global.this.Type">Type</a>, <a title="Set[M]" id="851783">ms</a>: <a href="../../../collection/immutable/Set.scala.html#11919" title="Set[M]">Set</a><span class="delimiter">[</span>M<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../Option.scala.html#978" title="Option[M]">Option</a><span class="delimiter">[</span>M<span class="delimiter">]</span> = <a href="#851783" title="Set[M]">ms</a>.<a href="../../../collection/IterableLike.scala.html#58567" title="(p: M =&gt; Boolean)Option[M]">find</a> <span class="delimiter">{</span> <a title="M" id="851789">m</a> =&gt;
      <span class="delimiter">(</span><a href="#851789" title="M">m</a>.<a href="CompilerControl.scala.html#846903" title="=&gt; Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; m.sym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#851781" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#851789" title="M">m</a>.<a href="CompilerControl.scala.html#846903" title="=&gt; Global.this.Symbol">sym</a>.<a href="../../../reflect/api/Symbols.scala.html#402394" title="=&gt; Boolean">isType</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#851789" title="M">m</a>.<a href="CompilerControl.scala.html#846904" title="=&gt; Global.this.Type">tpe</a> <a href="../../../reflect/internal/Types.scala.html#408487" title="(that: Global.this.Type)Boolean">matches</a> <a href="#851782" title="Global.this.Type">symtpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(m: M, sym: Global.this.Symbol, implicitlyAdded: Boolean)Boolean" id="851743">keepSecond</a><span class="delimiter">(</span><a title="M" id="851796">m</a>: <a href="#633394" title="M">M</a>, <a title="Global.this.Symbol" id="851797">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Global.this.Symbol">Symbol</a>, <a title="Boolean" id="851798">implicitlyAdded</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> =
      <a href="#851796" title="M">m</a>.<a href="CompilerControl.scala.html#846903" title="=&gt; Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411234" title="(mask: Long)Boolean">hasFlag</a><span class="delimiter">(</span>ACCESSOR <span title="Long(671088640L)">|</span> PARAMACCESSOR<span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
      <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#851797" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411234" title="(mask: Long)Boolean">hasFlag</a><span class="delimiter">(</span>ACCESSOR <span title="Long(671088640L)">|</span> PARAMACCESSOR<span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
      <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#851798" title="Boolean">implicitlyAdded</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#851796" title="M">m</a>.<a href="CompilerControl.scala.html#846906" title="=&gt; Boolean">implicitlyAdded</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(sym: Global.this.Symbol, pre: Global.this.Type, implicitlyAdded: Boolean)(toMember: (Global.this.Symbol, Global.this.Type) =&gt; M)Unit" id="851744">add</a><span class="delimiter">(</span><a title="Global.this.Symbol" id="851807">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Global.this.Symbol">Symbol</a>, <a title="Global.this.Type" id="851808">pre</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="Global.this.Type">Type</a>, <a title="Boolean" id="851809">implicitlyAdded</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="(Global.this.Symbol, Global.this.Type) =&gt; M" id="851810">toMember</a>: <span class="delimiter">(</span>Symbol, Type<span class="delimiter">)</span> =&gt; M<span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411203" title="=&gt; Boolean">isGetter</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411207" title="=&gt; Boolean">isSetter</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411430" title="=&gt; Global.this.Symbol">accessed</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; Global.this.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#851744" title="(sym: Global.this.Symbol, pre: Global.this.Type, implicitlyAdded: Boolean)(toMember: (Global.this.Symbol, Global.this.Type) =&gt; M)Unit">add</a><span class="delimiter">(</span><a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411430" title="=&gt; Global.this.Symbol">accessed</a>, <a href="#851808" title="Global.this.Type">pre</a>, <a href="#851809" title="Boolean">implicitlyAdded</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#851810" title="(Global.this.Symbol, Global.this.Type) =&gt; M">toMember</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a>.<a href="../../../reflect/internal/Names.scala.html#410429" title="=&gt; Name.this.ThisNameType">decodedName</a>.<a href="../../../reflect/internal/Names.scala.html#410404" title="(subname: String)Boolean">containsName</a><span class="delimiter">(</span><a href="../../../reflect/internal/StdNames.scala.html#407855" title="implicit scala.reflect.internal.StdNames.lowerTermNames : (n: Global.this.TermName)String">Dollar</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/HasFlags.scala.html#409872" title="=&gt; Boolean">isSynthetic</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411375" title="=&gt; Boolean">hasRawInfo</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Global.this.Type" id="851827">symtpe</a> = <a href="#851808" title="Global.this.Type">pre</a>.<a href="../../../reflect/internal/Types.scala.html#408462" title="(sym: Global.this.Symbol)Global.this.Type">memberType</a><a href="#633406" title="(x: =&gt; Global.this.Type)Global.this.OnTypeError[Global.this.Type]" class="delimiter">(</a><a href="#851807" title="Global.this.Symbol">sym</a><span class="delimiter">)</span> <a href="#846606" title="(alt: =&gt; Global.this.Type)Global.this.Type">onTypeError</a> <a href="../../../reflect/internal/Types.scala.html#407277" title="Global.this.ErrorType.type">ErrorType</a>
        <a href="#851742" title="(sym: Global.this.Symbol, symtpe: Global.this.Type, ms: Set[M])Option[M]">matching</a><a href="#3330783" title="(x: Unit)Unit" class="delimiter">(</a><a href="#851807" title="Global.this.Symbol">sym</a>, <a href="#851827" title="Global.this.Type">symtpe</a>, <a href="../../../collection/MapLike.scala.html#87535" title="(key: Global.this.Name)Set[M]" class="keyword">this</a><span class="delimiter">(</span><a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Some<a href="#3330778" title="Unit" id="3330779" class="delimiter">(</a><a href="../../../Option.scala.html#63132" title="M" id="851872">m</a><span class="delimiter">)</span> =&gt;
            <a href="#3330783" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#851743" title="(m: M, sym: Global.this.Symbol, implicitlyAdded: Boolean)Boolean">keepSecond</a><span class="delimiter">(</span><a href="#851872" title="M">m</a>, <a href="#851807" title="Global.this.Symbol">sym</a>, <a href="#851809" title="Boolean">implicitlyAdded</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              //print(&quot; -+ &quot;+sym.name)
              <a href="../../../collection/mutable/MapLike.scala.html#87611" title="(key: Global.this.Name, value: Set[M])Unit" class="keyword">this</a><span class="delimiter">(</span><a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span> = <a href="../../../collection/MapLike.scala.html#87535" title="(key: Global.this.Name)Set[M]" class="keyword">this</a><span class="delimiter">(</span><a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span> <a href="../../../collection/SetLike.scala.html#66446" title="(elem: M)scala.collection.immutable.Set[M]">-</a> <a href="#851872" title="M">m</a> <a href="../../../collection/SetLike.scala.html#66443" title="(elem: M)scala.collection.immutable.Set[M]">+</a> <a href="../../../Function2.scala.html#65848" title="(v1: Global.this.Symbol, v2: Global.this.Type)M">toMember</a><span class="delimiter">(</span><a href="#851807" title="Global.this.Symbol">sym</a>, <a href="#851827" title="Global.this.Type">symtpe</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="keyword">case</span> <a href="../../../Option.scala.html#1585" title="Unit" id="3330781">None</a> =&gt;
            //print(&quot; + &quot;+sym.name)
            <a href="../../../collection/mutable/MapLike.scala.html#87611" title="(key: Global.this.Name, value: Set[M])Unit" class="keyword">this</a><span class="delimiter">(</span><a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span> = <a href="../../../collection/MapLike.scala.html#87535" title="(key: Global.this.Name)Set[M]" class="keyword">this</a><span class="delimiter">(</span><a href="#851807" title="Global.this.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span> <a href="../../../collection/SetLike.scala.html#66443" title="(elem: M)scala.collection.immutable.Set[M]">+</a> <a href="../../../Function2.scala.html#65848" title="(v1: Global.this.Symbol, v2: Global.this.Type)M">toMember</a><span class="delimiter">(</span><a href="#851807" title="Global.this.Symbol">sym</a>, <a href="#851827" title="Global.this.Type">symtpe</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(other: Global.this.Members[M])Unit" id="851745">addNonShadowed</a><span class="delimiter">(</span><a title="Global.this.Members[M]" id="851952">other</a>: <a href="#633393" title="Global.this.Members[M]">Members</a><span class="delimiter">[</span>M<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../../../Tuple2.scala.html#60635" title="Global.this.Name" id="851980">name</a>, <a href="../../../Tuple2.scala.html#60637" title="Set[M]" id="851981">ms</a><span class="delimiter">)</span> &lt;- <a href="../../../collection/mutable/LinkedHashMap.scala.html#285251" title="(f: ((Global.this.Name, Set[M])) =&gt; Unit)Unit">other</a><span class="delimiter">)</span>
        <a href="#3330793" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#851981" title="Set[M]">ms</a>.<a href="../../../collection/TraversableOnce.scala.html#58191" title="=&gt; Boolean">nonEmpty</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../collection/MapLike.scala.html#87535" title="(key: Global.this.Name)Set[M]" class="keyword">this</a><span class="delimiter">(</span><a href="#851980" title="Global.this.Name">name</a><span class="delimiter">)</span>.<a href="../../../collection/SetLike.scala.html#66447" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../collection/mutable/MapLike.scala.html#87611" title="(key: Global.this.Name, value: Set[M])Unit" class="keyword">this</a><span class="delimiter">(</span><a href="#851980" title="Global.this.Name">name</a><span class="delimiter">)</span> = <a href="#851981" title="Set[M]">ms</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="=&gt; List[M]" id="851746">allMembers</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[M]">List</a><span class="delimiter">[</span>M<span class="delimiter">]</span> = <a href="../../../collection/MapLike.scala.html#87542" title="=&gt; Iterable[Set[M]]">values</a>.<a href="../../../collection/TraversableOnce.scala.html#58263" title="=&gt; List[Set[M]]">toList</a>.<a href="../../../collection/generic/GenericTraversableTemplate.scala.html#58488" title="(implicit asTraversable: Set[M] =&gt; scala.collection.GenTraversableOnce[M])List[M]">flatten</a>
  <span class="delimiter">}</span>

  /** Return all members visible without prefix in context enclosing `pos`. */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: Global.this.Position)List[Global.this.ScopeMember]" id="633395">scopeMembers</a><span class="delimiter">(</span><a title="Global.this.Position" id="851738">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Global.this.Position">Position</a><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Global.this.ScopeMember]">List</a><span class="delimiter">[</span>ScopeMember<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#633383" title="(pos: Global.this.Position)Global.this.Tree">typedTreeAt</a><span class="delimiter">(</span><a href="#851738" title="Global.this.Position">pos</a><span class="delimiter">)</span> // to make sure context is entered
    <span class="keyword">val</span> <a title="Global.this.Context" id="852014">context</a> = <a href="CompilerControl.scala.html#633429" title="(pos: Global.this.Position)Global.this.Context">doLocateContext</a><span class="delimiter">(</span><a href="#851738" title="Global.this.Position">pos</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Global.this.Members[Global.this.ScopeMember]" id="852015">locals</a> = <span title="Global.this.Members[Global.this.ScopeMember]" class="keyword">new</span> <a href="#633393" title="Global.this.Members[Global.this.ScopeMember]">Members</a><span class="delimiter">[</span>ScopeMember<span class="delimiter">]</span>
    <span class="keyword">val</span> <a title="Global.this.Members[Global.this.ScopeMember]" id="852016">enclosing</a> = <span title="Global.this.Members[Global.this.ScopeMember]" class="keyword">new</span> <a href="#633393" title="Global.this.Members[Global.this.ScopeMember]">Members</a><span class="delimiter">[</span>ScopeMember<span class="delimiter">]</span>
    <span class="keyword">def</span> <a title="(sym: Global.this.Symbol, pre: Global.this.Type, viaImport: Global.this.Tree)Unit" id="852017">addScopeMember</a><span class="delimiter">(</span><a title="Global.this.Symbol" id="852023">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Global.this.Symbol">Symbol</a>, <a title="Global.this.Type" id="852024">pre</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="Global.this.Type">Type</a>, <a title="Global.this.Tree" id="852025">viaImport</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a><span class="delimiter">)</span> =
      <a href="#852015" title="Global.this.Members[Global.this.ScopeMember]">locals</a>.<a href="#851744" title="(sym: Global.this.Symbol, pre: Global.this.Type, implicitlyAdded: Boolean)(toMember: (Global.this.Symbol, Global.this.Type) =&gt; Global.this.ScopeMember)Unit">add</a><span class="delimiter">(</span><a href="#852023" title="Global.this.Symbol">sym</a>, <a href="#852024" title="Global.this.Type">pre</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="Global.this.Symbol" id="852028">s</a>, <a title="Global.this.Type" id="852029">st</a><span class="delimiter">)</span> =&gt;
        <span title="Global.this.ScopeMember" class="keyword">new</span> <a href="CompilerControl.scala.html#633458" title="Global.this.ScopeMember">ScopeMember</a><span class="delimiter">(</span><a href="#852028" title="Global.this.Symbol">s</a>, <a href="#852029" title="Global.this.Type">st</a>, <a href="#852014" title="Global.this.Context">context</a>.<a href="../typechecker/Contexts.scala.html#538894" title="(sym: Global.this.analyzer.global.Symbol, pre: Global.this.analyzer.global.Type, superAccess: Boolean)Boolean">isAccessible</a><span class="delimiter">(</span><a href="#852028" title="Global.this.Symbol">s</a>, <a href="#852024" title="Global.this.Type">pre</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>, <a href="#852025" title="Global.this.Tree">viaImport</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="()Unit" id="852018">localsToEnclosing</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#852016" title="Global.this.Members[Global.this.ScopeMember]">enclosing</a>.<a href="#851745" title="(other: Global.this.Members[Global.this.ScopeMember])Unit">addNonShadowed</a><span class="delimiter">(</span><a href="#852015" title="Global.this.Members[Global.this.ScopeMember]">locals</a><span class="delimiter">)</span>
      <a href="#852015" title="Global.this.Members[Global.this.ScopeMember]">locals</a>.<a href="../../../collection/mutable/LinkedHashMap.scala.html#285260" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    //print(&quot;add scope members&quot;)
    <span class="keyword">var</span> <a title="Global.this.Context" id="852019">cx</a> = <a href="#852014" title="Global.this.Context">context</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#852019" title="Global.this.Context">cx</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="ContextTrees.scala.html#633522" title="=&gt; Global.this.analyzer.NoContext.type">NoContext</a><span class="delimiter">)</span> <a href="#852021" title="()Unit" class="delimiter">{</a>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.analyzer.global.Symbol" id="852067">sym</a> &lt;- <a href="#852019" title="Global.this.Context">cx</a>.<a href="../../../reflect/internal/Scopes.scala.html#410525" title="(p: Global.this.analyzer.global.Symbol =&gt; Unit)Unit">scope</a><span class="delimiter">)</span>
        <a href="#852017" title="(sym: Global.this.Symbol, pre: Global.this.Type, viaImport: Global.this.Tree)Unit">addScopeMember</a><span class="delimiter">(</span><a href="#852067" title="Global.this.analyzer.global.Symbol">sym</a>, <a href="../../../reflect/internal/Types.scala.html#407286" title="Global.this.NoPrefix.type">NoPrefix</a>, <a href="../../../reflect/internal/Trees.scala.html#407946" title="Global.this.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span>
      <a href="#852018" title="()Unit">localsToEnclosing</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#852019" title="Global.this.Context">cx</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#852019" title="Global.this.Context">cx</a>.<a href="../typechecker/Contexts.scala.html#538758" title="=&gt; Global.this.analyzer.Context">enclClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Global.this.analyzer.global.Type" id="852074">pre</a> = <a href="#852019" title="Global.this.Context">cx</a>.<a href="../typechecker/Contexts.scala.html#538785" title="=&gt; Global.this.analyzer.global.Type">prefix</a>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.analyzer.global.Symbol" id="852095">sym</a> &lt;- <a href="#852074" title="Global.this.analyzer.global.Type">pre</a>.<a href="../../../reflect/internal/Scopes.scala.html#410525" title="(p: Global.this.analyzer.global.Symbol =&gt; Unit)Unit">members</a><span class="delimiter">)</span>
          <a href="#852017" title="(sym: Global.this.Symbol, pre: Global.this.Type, viaImport: Global.this.Tree)Unit">addScopeMember</a><span class="delimiter">(</span><a href="#852095" title="Global.this.analyzer.global.Symbol">sym</a>, <a href="#852074" title="Global.this.analyzer.global.Type">pre</a>, <a href="../../../reflect/internal/Trees.scala.html#407946" title="Global.this.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span>
        <a href="#852018" title="()Unit">localsToEnclosing</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#852019" title="Global.this.Context">cx</a> = <a href="#852019" title="Global.this.Context">cx</a>.<a href="../typechecker/Contexts.scala.html#538755" title="=&gt; Global.this.analyzer.Context">outer</a>
    <span class="delimiter">}</span>
    //print(&quot;\nadd imported members&quot;)
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.analyzer.ImportInfo" id="852119">imp</a> &lt;- <a href="#852014" title="Global.this.Context">context</a>.<a href="../../../collection/immutable/List.scala.html#62719" title="(f: Global.this.analyzer.ImportInfo =&gt; Unit)Unit">imports</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Global.this.analyzer.global.Type" id="852133">pre</a> = <a href="#852119" title="Global.this.analyzer.ImportInfo">imp</a>.<a href="../typechecker/Contexts.scala.html#852127" title="=&gt; Global.this.analyzer.global.Tree">qual</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.analyzer.global.Type">tpe</a>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.analyzer.global.Symbol" id="852155">sym</a> &lt;- <a href="#852119" title="Global.this.analyzer.ImportInfo">imp</a>.<a href="../../../collection/IterableLike.scala.html#58562" title="(f: Global.this.analyzer.global.Symbol =&gt; Unit)Unit">allImportedSymbols</a><span class="delimiter">)</span>
        <a href="#852017" title="(sym: Global.this.Symbol, pre: Global.this.Type, viaImport: Global.this.Tree)Unit">addScopeMember</a><span class="delimiter">(</span><a href="#852155" title="Global.this.analyzer.global.Symbol">sym</a>, <a href="#852133" title="Global.this.analyzer.global.Type">pre</a>, <a href="#852119" title="Global.this.analyzer.ImportInfo">imp</a>.<a href="../typechecker/Contexts.scala.html#852127" title="=&gt; Global.this.analyzer.global.Tree">qual</a><span class="delimiter">)</span>
      <a href="#852018" title="()Unit">localsToEnclosing</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    // println()
    <span class="keyword">val</span> <a title="List[Global.this.ScopeMember]" id="852020">result</a> = <a href="#852016" title="Global.this.Members[Global.this.ScopeMember]">enclosing</a>.<a href="#851746" title="=&gt; List[Global.this.ScopeMember]">allMembers</a>
//    if (debugIDE) for (m &lt;- result) println(m)
    <a href="#852020" title="List[Global.this.ScopeMember]">result</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(pos: Global.this.Position, response: Global.this.Response[List[Global.this.Member]])Unit" id="633396">getTypeCompletion</a><span class="delimiter">(</span><a title="Global.this.Position" id="847319">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Global.this.Position">Position</a>, <a title="Global.this.Response[List[Global.this.Member]]" id="847320">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[List[Global.this.Member]]">Response</a><span class="delimiter">[</span>List<span class="delimiter">[</span>Member<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633281" title="(msg: =&gt; String)Unit">informIDE</a><span class="delimiter">(</span><span title="String(&quot;getTypeCompletion &quot;)" class="string">&quot;getTypeCompletion &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#847319" title="Global.this.Position">pos</a><span class="delimiter">)</span>
    <a href="#633375" title="(response: Global.this.Response[List[Global.this.Member]])(op: =&gt; Stream[List[Global.this.Member]])Unit">respondGradually</a><span class="delimiter">(</span><a href="#847320" title="Global.this.Response[List[Global.this.Member]]">response</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#633397" title="(pos: Global.this.Position)Stream[List[Global.this.TypeMember]]">typeMembers</a><span class="delimiter">(</span><a href="#847319" title="Global.this.Position">pos</a><span class="delimiter">)</span> <span class="delimiter">}</span>
    //if (debugIDE) typeMembers(pos)
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: Global.this.Position)Stream[List[Global.this.TypeMember]]" id="633397">typeMembers</a><span class="delimiter">(</span><a title="Global.this.Position" id="852165">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Global.this.Position">Position</a><span class="delimiter">)</span>: <a href="../../../collection/immutable/Stream.scala.html#11226" title="Stream[List[Global.this.TypeMember]]">Stream</a><span class="delimiter">[</span>List<span class="delimiter">[</span>TypeMember<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Global.this.Tree" id="852167">tree</a> = <a href="#633383" title="(pos: Global.this.Position)Global.this.Tree">typedTreeAt</a><span class="delimiter">(</span><a href="#852165" title="Global.this.Position">pos</a><span class="delimiter">)</span>

    // if tree consists of just x. or x.fo where fo is not yet a full member name
    // ignore the selection and look in just x.
    <a href="#852167" title="Global.this.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Select<a href="#3330797" title="Unit" id="3330799" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409999" title="Global.this.Tree" id="852178">qual</a>, <a href="../../../reflect/internal/Trees.scala.html#410001" title="Global.this.Name" id="852179">name</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#852167" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Types.scala.html#407277" title="Global.this.ErrorType.type">ErrorType</a> =&gt; <a href="#852167" title="Global.this.Tree">tree</a> = <a href="#852178" title="Global.this.Tree">qual</a>
      <span class="keyword">case</span> _ =&gt;
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Global.this.Context" id="852168">context</a> = <a href="CompilerControl.scala.html#633429" title="(pos: Global.this.Position)Global.this.Context">doLocateContext</a><span class="delimiter">(</span><a href="#852165" title="Global.this.Position">pos</a><span class="delimiter">)</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#852167" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
      // TODO: guard with try/catch to deal with ill-typed qualifiers.
      <a href="#852167" title="Global.this.Tree">tree</a> = <a href="../Global.scala.html#537550" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: Global.this.type}">analyzer</a>.<a href="../typechecker/Typers.scala.html#538108" title="(context: Global.this.analyzer.Context)Global.this.analyzer.Typer">newTyper</a><span class="delimiter">(</span><a href="#852168" title="Global.this.Context">context</a><span class="delimiter">)</span>.<a href="../typechecker/Typers.scala.html#538707" title="(tree: Global.this.analyzer.global.Tree)Global.this.analyzer.global.Tree">typedQualifier</a><span class="delimiter">(</span><a href="#852167" title="Global.this.Tree">tree</a><span class="delimiter">)</span>

    <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;typeMembers at &quot;)" class="string">&quot;typeMembers at &quot;</span><span title="(x$1: Any)String">+</span><a href="#852167" title="Global.this.Tree">tree</a><span title="(x$1: Any)String">+</span><span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span title="(x$1: Any)String">+</span><a href="#852167" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Boolean" id="852169">superAccess</a> = <a href="#852167" title="Global.this.Tree">tree</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../../reflect/internal/Trees.scala.html#408045" title="Global.this.Super">Super</a><span class="delimiter">]</span>
    <span class="keyword">val</span> <a title="Global.this.Members[Global.this.TypeMember]" id="852170">members</a> = <span title="Global.this.Members[Global.this.TypeMember]" class="keyword">new</span> <a href="#633393" title="Global.this.Members[Global.this.TypeMember]">Members</a><span class="delimiter">[</span>TypeMember<span class="delimiter">]</span>

    <span class="keyword">def</span> <a title="(sym: Global.this.Symbol, pre: Global.this.Type, inherited: Boolean, viaView: Global.this.Symbol)Unit" id="852171">addTypeMember</a><span class="delimiter">(</span><a title="Global.this.Symbol" id="852211">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Global.this.Symbol">Symbol</a>, <a title="Global.this.Type" id="852212">pre</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="Global.this.Type">Type</a>, <a title="Boolean" id="852213">inherited</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a>, <a title="Global.this.Symbol" id="852214">viaView</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Global.this.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Boolean" id="852215">implicitlyAdded</a> = <a href="#852214" title="Global.this.Symbol">viaView</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; Global.this.NoSymbol">NoSymbol</a>
      <a href="#852170" title="Global.this.Members[Global.this.TypeMember]">members</a>.<a href="#851744" title="(sym: Global.this.Symbol, pre: Global.this.Type, implicitlyAdded: Boolean)(toMember: (Global.this.Symbol, Global.this.Type) =&gt; Global.this.TypeMember)Unit">add</a><span class="delimiter">(</span><a href="#852211" title="Global.this.Symbol">sym</a>, <a href="#852212" title="Global.this.Type">pre</a>, <a href="#852215" title="Boolean">implicitlyAdded</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="Global.this.Symbol" id="852222">s</a>, <a title="Global.this.Type" id="852223">st</a><span class="delimiter">)</span> =&gt;
        <span title="Global.this.TypeMember" class="keyword">new</span> <a href="CompilerControl.scala.html#633455" title="Global.this.TypeMember">TypeMember</a><span class="delimiter">(</span><a href="#852222" title="Global.this.Symbol">s</a>, <a href="#852223" title="Global.this.Type">st</a>,
          <a href="#852168" title="Global.this.Context">context</a>.<a href="../typechecker/Contexts.scala.html#538894" title="(sym: Global.this.analyzer.global.Symbol, pre: Global.this.analyzer.global.Type, superAccess: Boolean)Boolean">isAccessible</a><span class="delimiter">(</span><span title="Global.this.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#852222" title="Global.this.Symbol">s</a>.<a href="../../../reflect/internal/Symbols.scala.html#411244" title="=&gt; Boolean">hasGetter</a><span class="delimiter">)</span> <a href="#852222" title="Global.this.Symbol">s</a>.<a href="../../../reflect/internal/Symbols.scala.html#411469" title="(base: Global.this.Symbol)Global.this.Symbol">getter</a><span class="delimiter">(</span><a href="#852222" title="Global.this.Symbol">s</a>.<a href="../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; Global.this.Symbol">owner</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#852222" title="Global.this.Symbol">s</a>, <a href="#852212" title="Global.this.Type">pre</a>, <a href="#852169" title="Boolean">superAccess</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#852215" title="Boolean">implicitlyAdded</a><span class="delimiter">)</span>,
          <a href="#852213" title="Boolean">inherited</a>,
          <a href="#852214" title="Global.this.Symbol">viaView</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /** Create a function application of a given view function to `tree` and typechecked it.
     */
    <span class="keyword">def</span> <a title="(view: Global.this.analyzer.SearchResult)Global.this.Tree" id="852172">viewApply</a><span class="delimiter">(</span><a title="Global.this.analyzer.SearchResult" id="852235">view</a>: <a href="../typechecker/Implicits.scala.html#538194" title="Global.this.analyzer.SearchResult">SearchResult</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a> = <span class="delimiter">{</span>
      <a href="../Global.scala.html#537498" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#852235" title="Global.this.analyzer.SearchResult">view</a>.<a href="../typechecker/Implicits.scala.html#541693" title="=&gt; Global.this.analyzer.global.Tree">tree</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../reflect/internal/Trees.scala.html#407946" title="Global.this.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span>
      <a href="../Global.scala.html#537550" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: Global.this.type}">analyzer</a>.<a href="../typechecker/Typers.scala.html#538108" title="(context: Global.this.analyzer.Context)Global.this.analyzer.Typer">newTyper</a><span class="delimiter">(</span><a href="#852168" title="Global.this.Context">context</a>.<a href="../typechecker/Contexts.scala.html#538873" title="(reportAmbiguousErrors: Boolean)Global.this.analyzer.Context">makeImplicit</a><span class="delimiter">(</span>reportAmbiguousErrors = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>
        .<a href="../typechecker/Typers.scala.html#538701" title="(tree: Global.this.analyzer.global.Tree)Global.this.analyzer.global.Tree">typed</a><a href="#633406" title="(x: =&gt; Global.this.analyzer.global.Tree)Global.this.OnTypeError[Global.this.analyzer.global.Tree]" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#413581" title="(fun: Global.this.Tree, args: List[Global.this.Tree])Global.this.Apply">Apply</a><span class="delimiter">(</span><a href="#852235" title="Global.this.analyzer.SearchResult">view</a>.<a href="../typechecker/Implicits.scala.html#541693" title="=&gt; Global.this.analyzer.global.Tree">tree</a>, <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: Global.this.Tree*)List[Global.this.Tree]">List</a><span class="delimiter">(</span><a href="#852167" title="Global.this.Tree">tree</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../reflect/internal/StdAttachments.scala.html#409604" title="(newpos: scala.reflect.internal.util.Position)Global.this.Apply">setPos</a> <a href="#852167" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Global.this.Position">pos</a><span class="delimiter">)</span>
        .<a href="#846606" title="(alt: =&gt; Global.this.analyzer.global.Tree)Global.this.analyzer.global.Tree">onTypeError</a><span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#407946" title="Global.this.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Global.this.Type" id="852173">pre</a> = <a href="#633388" title="(tree: Global.this.Tree)Global.this.Type">stabilizedType</a><span class="delimiter">(</span><a href="#852167" title="Global.this.Tree">tree</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Global.this.analyzer.global.Type" id="852174">ownerTpe</a> = <a href="#852167" title="Global.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> analyzer.ImportType<a href="../../../Boolean.scala.html#57826" title="Global.this.analyzer.global.Type" id="3330809" class="delimiter">(</a><a href="../typechecker/Contexts.scala.html#662189" title="Global.this.analyzer.global.Tree" id="852313">expr</a><span class="delimiter">)</span> =&gt; <a href="#852313" title="Global.this.analyzer.global.Tree">expr</a>.<a href="#3330820" title="(x: Global.this.analyzer.global.Type)Global.this.analyzer.global.Type">tpe</a>
      <span class="keyword">case</span> <a href="#3330806" title="Global.this.analyzer.global.Type" id="3330818" class="keyword">null</a> =&gt; <a href="#3330820" title="(x: Global.this.analyzer.global.Type)Global.this.analyzer.global.Type">pre</a>
      <span class="keyword">case</span> MethodType<a href="#3330806" title="Global.this.analyzer.global.Type" id="3330814" class="delimiter">(</a><a href="../../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[Global.this.Symbol]]" id="3330826">List</a><a href="../../../reflect/internal/Types.scala.html#410769" title="List[Global.this.Symbol]" id="3330812" class="delimiter">(</a><span class="delimiter">)</span>, <a href="../../../reflect/internal/Types.scala.html#410771" title="Global.this.Type" id="852328">rtpe</a><span class="delimiter">)</span> =&gt; <a href="#3330820" title="(x: Global.this.analyzer.global.Type)Global.this.analyzer.global.Type">rtpe</a>
      <span class="keyword">case</span> _ =&gt; <a href="#852167" title="Global.this.Tree">tree</a>.<a href="#3330820" title="(x: Global.this.analyzer.global.Type)Global.this.analyzer.global.Type">tpe</a>
    <span class="delimiter">}</span>

    //print(&quot;add members&quot;)
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.analyzer.global.Symbol" id="852350">sym</a> &lt;- <a href="#852174" title="Global.this.analyzer.global.Type">ownerTpe</a>.<a href="../../../reflect/internal/Scopes.scala.html#410525" title="(p: Global.this.analyzer.global.Symbol =&gt; Unit)Unit">members</a><span class="delimiter">)</span>
      <a href="#852171" title="(sym: Global.this.Symbol, pre: Global.this.Type, inherited: Boolean, viaView: Global.this.Symbol)Unit">addTypeMember</a><span class="delimiter">(</span><a href="#852350" title="Global.this.analyzer.global.Symbol">sym</a>, <a href="#852173" title="Global.this.Type">pre</a>, <a href="#852350" title="Global.this.analyzer.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; Global.this.analyzer.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#852174" title="Global.this.analyzer.global.Type">ownerTpe</a>.<a href="../../../reflect/internal/Types.scala.html#408407" title="=&gt; Global.this.analyzer.global.Symbol">typeSymbol</a>, <a href="../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; Global.this.NoSymbol">NoSymbol</a><span class="delimiter">)</span>
    <a href="#852170" title="Global.this.Members[Global.this.TypeMember]">members</a>.<a href="#851746" title="=&gt; List[Global.this.TypeMember]">allMembers</a> <a href="../../../collection/immutable/Stream.scala.html#232418" title="(hd: List[Global.this.TypeMember])scala.collection.immutable.Stream[List[Global.this.TypeMember]]">#::</a> <a href="../../../collection/immutable/Stream.scala.html#143250" title="(stream: =&gt; scala.collection.immutable.Stream[List[Global.this.TypeMember]])scala.collection.immutable.Stream.ConsWrapper[List[Global.this.TypeMember]]" class="delimiter">{</a>
      //print(&quot;\nadd pimped&quot;)
      <span class="keyword">val</span> <a title="List[Global.this.analyzer.SearchResult]" id="852358">applicableViews</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Global.this.analyzer.SearchResult]">List</a><span class="delimiter">[</span>SearchResult<span class="delimiter">]</span> =
        <span title="List[Global.this.analyzer.SearchResult]" class="keyword">if</span> <span class="delimiter">(</span><a href="#852174" title="Global.this.analyzer.global.Type">ownerTpe</a>.<a href="../../../reflect/internal/Types.scala.html#408402" title="=&gt; Boolean">isErroneous</a><span class="delimiter">)</span> List<a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type" class="delimiter">(</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <a href="../typechecker/Implicits.scala.html#852428" title="Global.this.analyzer.ImplicitSearch" class="keyword">new</a> <a href="../typechecker/Implicits.scala.html#538207" title="Global.this.analyzer.ImplicitSearch">ImplicitSearch</a><span class="delimiter">(</span>
          <a href="#852167" title="Global.this.Tree">tree</a>, <a href="../../../reflect/internal/Definitions.scala.html#408996" title="(formals: List[Global.this.Type], restpe: Global.this.Type)Global.this.Type">functionType</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#62451" title="(xs: Global.this.analyzer.global.Type*)List[Global.this.analyzer.global.Type]">List</a><span class="delimiter">(</span><a href="#852174" title="Global.this.analyzer.global.Type">ownerTpe</a><span class="delimiter">)</span>, <a href="../../../reflect/internal/Definitions.scala.html#408667" title="=&gt; Global.this.ClassSymbol">AnyClass</a>.<a href="../../../reflect/internal/Symbols.scala.html#411559" title="=&gt; Global.this.Type">tpe</a><span class="delimiter">)</span>, isView = <span title="Boolean(true)" class="keyword">true</span>,
          context0 = <a href="#852168" title="Global.this.Context">context</a>.<a href="../typechecker/Contexts.scala.html#538873" title="(reportAmbiguousErrors: Boolean)Global.this.analyzer.Context">makeImplicit</a><span class="delimiter">(</span>reportAmbiguousErrors = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../typechecker/Implicits.scala.html#852415" title="=&gt; List[Global.this.analyzer.SearchResult]">allImplicits</a>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.analyzer.SearchResult" id="852465">view</a> &lt;- <a href="../../../collection/immutable/List.scala.html#62719" title="(f: Global.this.analyzer.SearchResult =&gt; Unit)Unit">applicableViews</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Global.this.Tree" id="852466">vtree</a> = <a href="#852172" title="(view: Global.this.analyzer.SearchResult)Global.this.Tree">viewApply</a><span class="delimiter">(</span><a href="#852465" title="Global.this.analyzer.SearchResult">view</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Global.this.Type" id="852467">vpre</a> = <a href="#633388" title="(tree: Global.this.Tree)Global.this.Type">stabilizedType</a><span class="delimiter">(</span><a href="#852466" title="Global.this.Tree">vtree</a><span class="delimiter">)</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="Global.this.Symbol" id="852489">sym</a> &lt;- <a href="#852466" title="Global.this.Tree">vtree</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Global.this.Type">tpe</a>.<a href="../../../reflect/internal/Scopes.scala.html#410525" title="(p: Global.this.Symbol =&gt; Unit)Unit">members</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#852171" title="(sym: Global.this.Symbol, pre: Global.this.Type, inherited: Boolean, viaView: Global.this.Symbol)Unit">addTypeMember</a><span class="delimiter">(</span><a href="#852489" title="Global.this.Symbol">sym</a>, <a href="#852467" title="Global.this.Type">vpre</a>, <span title="Boolean(false)" class="keyword">false</span>, <a href="#852465" title="Global.this.analyzer.SearchResult">view</a>.<a href="../typechecker/Implicits.scala.html#541693" title="=&gt; Global.this.analyzer.global.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; Global.this.analyzer.global.Symbol">symbol</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      //println()
      <a href="../../../collection/immutable/Stream.scala.html#143245" title="(xs: List[Global.this.TypeMember]*)scala.collection.immutable.Stream[List[Global.this.TypeMember]]">Stream</a><span class="delimiter">(</span><a href="#852170" title="Global.this.Members[Global.this.TypeMember]">members</a>.<a href="#851746" title="=&gt; List[Global.this.TypeMember]">allMembers</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Implements CompilerControl.askLoadedTyped */
  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile, response: Global.this.Response[Global.this.Tree], onSameThread: Boolean)Unit" id="633398">waitLoadedTyped</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="847501">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a>, <a title="Global.this.Response[Global.this.Tree]" id="847502">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[Global.this.Tree]">Response</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="Boolean" id="847505">onSameThread</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633300" title="(s: scala.reflect.internal.util.SourceFile)Option[Global.this.RichCompilationUnit]">getUnit</a><a href="#3330839" title="(x: Unit)Unit" class="delimiter">(</a><a href="#847501" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<a href="#3330834" title="Unit" id="3330835" class="delimiter">(</a><a href="../../../Option.scala.html#63132" title="Global.this.RichCompilationUnit" id="852530">unit</a><span class="delimiter">)</span> =&gt;
        <a href="#3330839" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#852530" title="Global.this.RichCompilationUnit">unit</a>.<a href="RichCompilationUnits.scala.html#845995" title="=&gt; Boolean">isUpToDate</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;already typed&quot;)" class="string">&quot;already typed&quot;</span><span class="delimiter">)</span>;
          <a href="#847502" title="Global.this.Response[Global.this.Tree]">response</a> <a href="Response.scala.html#633701" title="(x: Global.this.Tree)Unit">set</a> <a href="#852530" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539278" title="=&gt; Global.this.Tree">body</a>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../collection/GenSetLike.scala.html#66403" title="(elem: tools.nsc.io.AbstractFile)Boolean">ignoredFiles</a><span class="delimiter">(</span><a href="#847501" title="scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#847502" title="Global.this.Response[Global.this.Tree]">response</a>.<a href="Response.scala.html#633702" title="(exc: Throwable)Unit">raise</a><span class="delimiter">(</span><a href="#633305" title="=&gt; Option[Throwable]">lastException</a>.<a href="../../../Option.scala.html#62859" title="(default: =&gt; Throwable)Throwable">getOrElse</a><span class="delimiter">(</span><a href="#852787" title="scala.tools.nsc.interactive.CancelException.type">CancelException</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#847505" title="Boolean">onSameThread</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#633386" title="(source: scala.reflect.internal.util.SourceFile, forceReload: Boolean, response: Global.this.Response[Global.this.Tree])Unit">getTypedTree</a><span class="delimiter">(</span><a href="#847501" title="scala.reflect.internal.util.SourceFile">source</a>, forceReload = <span title="Boolean(false)" class="keyword">false</span>, <a href="#847502" title="Global.this.Response[Global.this.Tree]">response</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;wait for later&quot;)" class="string">&quot;wait for later&quot;</span><span class="delimiter">)</span>
          <a href="#633316" title="(x$1: Boolean)Unit">outOfDate</a> = <span title="Boolean(true)" class="keyword">true</span>
          <a href="../../../collection/mutable/HashMap.scala.html#88248" title="(key: scala.reflect.internal.util.SourceFile, value: scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]])Unit">waitLoadedTypeResponses</a><span class="delimiter">(</span><a href="#847501" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span> <a href="../../../collection/SetLike.scala.html#66443" title="(elem: Global.this.Response[Global.this.Tree])scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]]">+=</a> <a href="#847502" title="Global.this.Response[Global.this.Tree]">response</a>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="../../../Option.scala.html#1585" title="Unit" id="3330837">None</a> =&gt;
        <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;load unit and type&quot;)" class="string">&quot;load unit and type&quot;</span><span class="delimiter">)</span>
        <span class="keyword">try</span> <a href="#633379" title="(sources: List[scala.reflect.internal.util.SourceFile])Unit">reloadSources</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#62451" title="(xs: scala.reflect.internal.util.SourceFile*)List[scala.reflect.internal.util.SourceFile]">List</a><span class="delimiter">(</span><a href="#847501" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">finally</span> <a href="#633398" title="(source: scala.reflect.internal.util.SourceFile, response: Global.this.Response[Global.this.Tree], onSameThread: Boolean)Unit">waitLoadedTyped</a><span class="delimiter">(</span><a href="#847501" title="scala.reflect.internal.util.SourceFile">source</a>, <a href="#847502" title="Global.this.Response[Global.this.Tree]">response</a>, <a href="#847505" title="Boolean">onSameThread</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Implements CompilerControl.askParsedEntered */
  <span class="keyword">private</span><span class="delimiter">[</span>interactive<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile, keepLoaded: Boolean, response: Global.this.Response[Global.this.Tree], onSameThread: Boolean)Unit" id="633399">getParsedEntered</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="847556">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a>, <a title="Boolean" id="847557">keepLoaded</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a>, <a title="Global.this.Response[Global.this.Tree]" id="847558">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[Global.this.Tree]">Response</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="Boolean" id="847561">onSameThread</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633300" title="(s: scala.reflect.internal.util.SourceFile)Option[Global.this.RichCompilationUnit]">getUnit</a><a href="#3330852" title="(x: Unit)Unit" class="delimiter">(</a><a href="#847556" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<a href="#3330847" title="Unit" id="3330848" class="delimiter">(</a><a href="../../../Option.scala.html#63132" title="Global.this.RichCompilationUnit" id="852616">unit</a><span class="delimiter">)</span> =&gt;
        <a href="#633400" title="(source: scala.reflect.internal.util.SourceFile, response: Global.this.Response[Global.this.Tree])Unit">getParsedEnteredNow</a><a href="#3330852" title="(x: Unit)Unit" class="delimiter">(</a><a href="#847556" title="scala.reflect.internal.util.SourceFile">source</a>, <a href="#847558" title="Global.this.Response[Global.this.Tree]">response</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../../../Option.scala.html#1585" title="Unit" id="3330850">None</a> =&gt;
        <a href="#3330852" title="(x: Unit)Unit" class="keyword">try</a> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#847557" title="Boolean">keepLoaded</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#633316" title="=&gt; Boolean">outOfDate</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#847561" title="Boolean">onSameThread</a><span class="delimiter">)</span>
            <a href="#633379" title="(sources: List[scala.reflect.internal.util.SourceFile])Unit">reloadSources</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#62451" title="(xs: scala.reflect.internal.util.SourceFile*)List[scala.reflect.internal.util.SourceFile]">List</a><span class="delimiter">(</span><a href="#847556" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#847557" title="Boolean">keepLoaded</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#633316" title="=&gt; Boolean">outOfDate</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#847561" title="Boolean">onSameThread</a><span class="delimiter">)</span>
            <a href="#633400" title="(source: scala.reflect.internal.util.SourceFile, response: Global.this.Response[Global.this.Tree])Unit">getParsedEnteredNow</a><span class="delimiter">(</span><a href="#847556" title="scala.reflect.internal.util.SourceFile">source</a>, <a href="#847558" title="Global.this.Response[Global.this.Tree]">response</a><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#633293" title="=&gt; Global.this.ResponseMap">getParsedEnteredResponses</a><span class="delimiter">(</span><a href="#847556" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span> <a href="../../../collection/SetLike.scala.html#66443" title="(elem: Global.this.Response[Global.this.Tree])scala.collection.immutable.Set[Global.this.Response[Global.this.Tree]]">+=</a> <a href="#847558" title="Global.this.Response[Global.this.Tree]">response</a>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Parses and enters given source file, stroring parse tree in response */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile, response: Global.this.Response[Global.this.Tree])Unit" id="633400">getParsedEnteredNow</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="851201">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a>, <a title="Global.this.Response[Global.this.Tree]" id="851202">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[Global.this.Tree]">Response</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633372" title="(result: Global.this.Response[Global.this.Tree])(op: =&gt; Global.this.Tree)Unit">respond</a><span class="delimiter">(</span><a href="#851202" title="Global.this.Response[Global.this.Tree]">response</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="CompilerControl.scala.html#633420" title="(source: scala.reflect.internal.util.SourceFile)(op: Global.this.RichCompilationUnit =&gt; Global.this.Tree)Global.this.Tree">onUnitOf</a><span class="delimiter">(</span><a href="#851201" title="scala.reflect.internal.util.SourceFile">source</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="Global.this.RichCompilationUnit" id="852714">unit</a> =&gt;
        <a href="#633368" title="(unit: Global.this.RichCompilationUnit)Unit">parseAndEnter</a><span class="delimiter">(</span><a href="#852714" title="Global.this.RichCompilationUnit">unit</a><span class="delimiter">)</span>
        <a href="#852714" title="Global.this.RichCompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539278" title="=&gt; Global.this.Tree">body</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  @deprecated<span class="delimiter">(</span><span class="string">&quot;SI-6458: Instrumentation logic will be moved out of the compiler.&quot;</span>,<span class="string">&quot;2.10.0&quot;</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile, line: Int, response: Global.this.Response[(String, Array[Char])])Unit" id="633401">getInstrumented</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="847624">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a>, <a title="Int" id="847625">line</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="Global.this.Response[(String, Array[Char])]" id="847626">response</a>: <a href="Response.scala.html#36348" title="Global.this.Response[(String, Array[Char])]">Response</a><span class="delimiter">[</span><span class="delimiter">(</span>String, Array<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span> =
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#633324" title="(x$1: Boolean)Unit">interruptsEnabled</a> = <span title="Boolean(false)" class="keyword">false</span>
      <a href="#633372" title="(result: Global.this.Response[(String, Array[Char])])(op: =&gt; (String, Array[Char]))Unit">respond</a><span class="delimiter">(</span><a href="#847626" title="Global.this.Response[(String, Array[Char])]">response</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="ScratchPadMaker.scala.html#633547" title="(source: scala.reflect.internal.util.SourceFile, line: Int)(String, Array[Char])">instrument</a><span class="delimiter">(</span><a href="#847624" title="scala.reflect.internal.util.SourceFile">source</a>, <a href="#847625" title="Int">line</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="#633324" title="(x$1: Boolean)Unit">interruptsEnabled</a> = <span title="Boolean(true)" class="keyword">true</span>
    <span class="delimiter">}</span>

  // ---------------- Helper classes ---------------------------

  /** A transformer that replaces tree `from` with tree `to` in a given tree */
  <span class="keyword">class</span> <a title="class TreeReplacer extends Global.this.Transformer" id="633402">TreeReplacer</a><a href="#633402" title="Global.this.TreeReplacer" class="delimiter">(</a><a title="Global.this.Tree" id="852726">from</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a>, <a title="Global.this.Tree" id="852727">to</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../ast/Trees.scala.html#537817" title="Global.this.Transformer">Transformer</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(t: Global.this.Tree)Global.this.Tree" id="852722">transform</a><span class="delimiter">(</span><a title="Global.this.Tree" id="852728">t</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a> = <span class="delimiter">{</span>
      <span title="Global.this.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#852728" title="Global.this.Tree">t</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#852726" title="Global.this.Tree">from</a><span class="delimiter">)</span> <a href="#852727" title="Global.this.Tree">to</a>
      <span class="keyword">else</span> <span title="Global.this.Tree" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#852728" title="Global.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Global.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#409686" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#852726" title="Global.this.Tree">from</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Global.this.Position">pos</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#852728" title="Global.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Global.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409667" title="=&gt; Boolean">isTransparent</a><span class="delimiter">)</span> <a href="#633402" title="Global.this.TreeReplacer" class="keyword">super</a>.<a href="../../../reflect/api/Trees.scala.html#405652" title="(tree: Global.this.Tree)Global.this.Tree">transform</a><span class="delimiter">(</span><a href="#852728" title="Global.this.Tree">t</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <a href="#852728" title="Global.this.Tree">t</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** The typer run */
  <span class="keyword">class</span> <a title="class TyperRun extends Global.this.Run" id="633403">TyperRun</a> <a href="#633403" title="Global.this.TyperRun" class="keyword">extends</a> <a href="../Global.scala.html#537750" title="Global.this.Run">Run</a> <span class="delimiter">{</span>
    // units is always empty

    /** canRedefine is used to detect double declarations of classes and objects
     *  in multiple source files.
     *  Since the IDE rechecks units several times in the same run, these tests
     *  are disabled by always returning true here.
     */
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(sym: Global.this.Symbol)Boolean" id="850044">canRedefine</a><span class="delimiter">(</span><a title="Global.this.Symbol" id="852739">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Global.this.Symbol">Symbol</a><span class="delimiter">)</span> = <span title="Boolean(true)" class="keyword">true</span>

    <span class="keyword">def</span> <a title="(unit: Global.this.CompilationUnit)Unit" id="850045">typeCheck</a><span class="delimiter">(</span><a title="Global.this.CompilationUnit" id="851233">unit</a>: <a href="../CompilationUnits.scala.html#537766" title="Global.this.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> = <span class="delimiter">{</span>
      <a href="#850046" title="(phase: scala.tools.nsc.Phase, unit: Global.this.CompilationUnit)Unit">applyPhase</a><span class="delimiter">(</span><a href="../Global.scala.html#539378" title="=&gt; scala.tools.nsc.Phase">typerPhase</a>, <a href="#851233" title="Global.this.CompilationUnit">unit</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    /** Apply a phase to a compilation unit
     *  @return true iff typechecked correctly
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(phase: scala.tools.nsc.Phase, unit: Global.this.CompilationUnit)Unit" id="850046">applyPhase</a><span class="delimiter">(</span><a title="scala.tools.nsc.Phase" id="852741">phase</a>: <a href="../../../reflect/internal/Phase.scala.html#19756" title="scala.tools.nsc.Phase">Phase</a>, <a title="Global.this.CompilationUnit" id="852742">unit</a>: <a href="../CompilationUnits.scala.html#537766" title="Global.this.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../../reflect/internal/SymbolTable.scala.html#406672" title="(ph: scala.reflect.internal.Phase)(op: =&gt; Unit)Unit">atPhase</a><span class="delimiter">(</span><a href="#852741" title="scala.tools.nsc.Phase">phase</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#852741" title="scala.tools.nsc.Phase">phase</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Global.this.GlobalPhase" class="delimiter">[</span><a href="../Global.scala.html#537541" title="Global.this.GlobalPhase">GlobalPhase</a><span class="delimiter">]</span> <a href="../Global.scala.html#620905" title="(unit: Global.this.CompilationUnit)Unit">applyPhase</a> <a href="#852742" title="Global.this.CompilationUnit">unit</a> <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="633404">newTyperRun</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#633313" title="(x$1: Global.this.TyperRun)Unit">currentTyperRun</a> = <span title="Global.this.TyperRun" class="keyword">new</span> <a href="#633403" title="Global.this.TyperRun">TyperRun</a>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class TyperResult extends Throwable with scala.util.control.ControlThrowable" id="633405">TyperResult</a><a href="#633405" title="Global.this.TyperResult" class="delimiter">(</a><span class="keyword">val</span> <a title="Global.this.Tree" id="850106">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Global.this.Tree">Tree</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../util/control/ControlThrowable.scala.html#52278" title="scala.util.control.ControlThrowable">ControlThrowable</a>

  <a href="../Global.scala.html#537498" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="../Global.scala.html#537534" title="=&gt; scala.tools.nsc.Phase">globalPhase</a>.<a href="../../../reflect/internal/Phase.scala.html#419695" title="=&gt; Int">id</a> <a href="../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](x: =&gt; T)Global.this.OnTypeError[T]" id="633406">addOnTypeError</a><span class="delimiter">[</span><a title="" id="633408">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; T" id="633631">x</a>: =&gt; T<span class="delimiter">)</span>: <a href="#633409" title="Global.this.OnTypeError[T]">OnTypeError</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span title="Global.this.OnTypeError[T]" class="keyword">new</span> <a href="#633409" title="Global.this.OnTypeError[T]">OnTypeError</a><span class="delimiter">(</span><a href="#633631" title="=&gt; T">x</a><span class="delimiter">)</span>

  // OnTypeError should still catch TypeError because of cyclic references,
  // but DivergentImplicit shouldn't leak anymore here
  <span class="keyword">class</span> <a title="class OnTypeError[T] extends Object" id="633409">OnTypeError</a><span class="delimiter">[</span><a title="" id="633410">T</a><span class="delimiter">]</span><a href="#633409" title="Global.this.OnTypeError[T]" class="delimiter">(</a><a title="=&gt; T" id="852765">op</a>: =&gt; T<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(alt: =&gt; T)T" id="846606">onTypeError</a><span class="delimiter">(</span><a title="=&gt; T" id="851640">alt</a>: =&gt; T<span class="delimiter">)</span> = <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#852765" title="=&gt; T">op</a>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="T" id="851641">ex</a>: <a href="../../../reflect/internal/Types.scala.html#407625" title="Global.this.TypeError">TypeError</a> =&gt;
        <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;type error caught: &quot;)" class="string">&quot;type error caught: &quot;</span><span title="(x$1: Any)String">+</span><a href="#851641" title="Global.this.TypeError">ex</a><span class="delimiter">)</span>
        <a href="#851640" title="=&gt; T">alt</a>
      <span class="keyword">case</span> <a title="T" id="851642">ex</a>: <a href="../typechecker/Implicits.scala.html#48413" title="scala.tools.nsc.typechecker.DivergentImplicit">DivergentImplicit</a> =&gt;
        <a href="#633280" title="(msg: =&gt; String)Unit">debugLog</a><span class="delimiter">(</span><span title="String(&quot;divergent implicit caught: &quot;)" class="string">&quot;divergent implicit caught: &quot;</span><span title="(x$1: Any)String">+</span><a href="#851642" title="scala.tools.nsc.typechecker.DivergentImplicit">ex</a><span class="delimiter">)</span>
        <a href="#851640" title="=&gt; T">alt</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span title="Object" class="delimiter">}</span>

<span class="keyword">object</span> <a title="scala.tools.nsc.interactive.CancelException.type" id="852787">CancelException</a> <a href="#36071" title="scala.tools.nsc.interactive.CancelException.type" class="keyword">extends</a> <a href="../../../package.scala.html#55500" title="Exception">Exception</a>


        </pre>
    </body>
</html>
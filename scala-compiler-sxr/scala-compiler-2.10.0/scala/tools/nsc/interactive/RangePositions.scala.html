<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/interactive/RangePositions.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2009-2013 Typesafe/Scala Solutions and LAMP/EPFL
 * @author Martin Odersky
 */
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interactive

<span class="keyword">import</span> ast.Trees
<span class="keyword">import</span> ast.Positions
<span class="keyword">import</span> scala.reflect.internal.util.<span class="delimiter">{</span>SourceFile, Position, RangePosition, NoPosition<span class="delimiter">}</span>
<span class="keyword">import</span> scala.tools.nsc.util.WorkScheduler
<span class="keyword">import</span> scala.collection.mutable.ListBuffer

/** Handling range positions
 *  atPos, the main method in this trait, will add positions to a tree,
 *  and will ensure the following properties:
 *
 *    1. All nodes between the root of the tree and nodes that already have positions
 *       will be assigned positions.
 *    2. No node which already has a position will be assigned a different range; however
 *       a RangePosition might become a TransparentPosition.
 *    3. The position of each assigned node includes the positions of each of its children.
 *    4. The positions of all solid descendants of children of an assigned node
 *       are mutually non-overlapping.
 *
 * Here, the solid descendant of a node are:
 *
 *   If the node has a TransparentPosition, the solid descendants of all its children
 *   Otherwise, the singleton consisting of the node itself.
 */
<span class="keyword">trait</span> <a title="trait RangePositions extends Object with scala.tools.nsc.ast.Trees with scala.tools.nsc.ast.Positions" id="35922">RangePositions</a> <a href="../../../Unit.scala.html#1515" title="Unit" class="keyword">extends</a> <a href="../ast/Trees.scala.html#28315" title="scala.tools.nsc.ast.Trees">Trees</a> <span class="keyword">with</span> <a href="../ast/Positions.scala.html#28627" title="scala.tools.nsc.ast.Positions">Positions</a> <span class="delimiter">{</span>
self: scala.tools.nsc.Global =&gt;

  case <span class="keyword">class</span> <a title="class Range extends AnyRef with Product with Serializable" id="857792">Range</a><a href="../../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="RangePositions.this.Position" id="856926">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="RangePositions.this.Position">Position</a>, <a title="RangePositions.this.Tree" id="856927">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="856476">isFree</a> = <a href="#856927" title="=&gt; RangePositions.this.Tree">tree</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Trees.scala.html#407946" title="RangePositions.this.EmptyTree.type">EmptyTree</a>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(source: scala.reflect.internal.util.SourceFile, start: Int, point: Int, end: Int)scala.reflect.internal.util.RangePosition" id="633499">rangePos</a><span class="delimiter">(</span><a title="scala.reflect.internal.util.SourceFile" id="850516">source</a>: <a href="../../../reflect/internal/util/SourceFile.scala.html#22662" title="scala.reflect.internal.util.SourceFile">SourceFile</a>, <a title="Int" id="850517">start</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="850518">point</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="850519">end</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> =
    <span title="scala.reflect.internal.util.RangePosition" class="keyword">new</span> <a href="../../../reflect/internal/util/Position.scala.html#22761" title="scala.reflect.internal.util.RangePosition">RangePosition</a><span class="delimiter">(</span><a href="#850516" title="scala.reflect.internal.util.SourceFile">source</a>, <a href="#850517" title="Int">start</a>, <a href="#850518" title="Int">point</a>, <a href="#850519" title="Int">end</a><span class="delimiter">)</span>

  /** A position that wraps a set of trees.
   *  The point of the wrapping position is the point of the default position.
   *  If some of the trees are ranges, returns a range position enclosing all ranges
   *  Otherwise returns default position that is either focused or not.
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(default: RangePositions.this.Position, trees: List[RangePositions.this.Tree], focus: Boolean)RangePositions.this.Position" id="633500">wrappingPos</a><span class="delimiter">(</span><a title="RangePositions.this.Position" id="856527">default</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="RangePositions.this.Position">Position</a>, <a title="List[RangePositions.this.Tree]" id="856528">trees</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="Boolean" id="856529">focus</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="RangePositions.this.Position">Position</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[RangePositions.this.Tree]" id="856547">ranged</a> = <a href="#856528" title="List[RangePositions.this.Tree]">trees</a> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: RangePositions.this.Tree =&gt; Boolean)List[RangePositions.this.Tree]">filter</a> <span class="delimiter">(</span><a href="#856551" title="RangePositions.this.Tree">_</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409668" title="=&gt; Boolean">isRange</a><span class="delimiter">)</span>
    <span title="RangePositions.this.Position" class="keyword">if</span> <span class="delimiter">(</span><a href="#856547" title="List[RangePositions.this.Tree]">ranged</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span title="scala.reflect.internal.util.Position" class="keyword">if</span> <span class="delimiter">(</span><a href="#856529" title="Boolean">focus</a><span class="delimiter">)</span> <a href="#856527" title="RangePositions.this.Position">default</a>.<a href="../../../reflect/internal/util/Position.scala.html#409684" title="=&gt; scala.reflect.internal.util.Position">focus</a> <span class="keyword">else</span> <a href="#856527" title="RangePositions.this.Position">default</a>
    <span class="keyword">else</span> <span title="scala.reflect.internal.util.RangePosition" class="keyword">new</span> <a href="../../../reflect/internal/util/Position.scala.html#22761" title="scala.reflect.internal.util.RangePosition">RangePosition</a><span class="delimiter">(</span><a href="#856527" title="RangePositions.this.Position">default</a>.<a href="../../../reflect/internal/util/Position.scala.html#409665" title="=&gt; scala.reflect.internal.util.SourceFile">source</a>, <span class="delimiter">(</span><a href="#856547" title="List[RangePositions.this.Tree]">ranged</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: RangePositions.this.Tree =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[List[RangePositions.this.Tree],Int,List[Int]])List[Int]">map</a> <span class="delimiter">(</span><a href="#856569" title="RangePositions.this.Tree">_</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409671" title="=&gt; Int">start</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../collection/TraversableOnce.scala.html#58238" title="(implicit cmp: Ordering[Int])Int">min</a>, <a href="#856527" title="RangePositions.this.Position">default</a>.<a href="../../../reflect/internal/util/Position.scala.html#409673" title="=&gt; Int">point</a>, <span class="delimiter">(</span><a href="#856547" title="List[RangePositions.this.Tree]">ranged</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: RangePositions.this.Tree =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[List[RangePositions.this.Tree],Int,List[Int]])List[Int]">map</a> <span class="delimiter">(</span><a href="#856681" title="RangePositions.this.Tree">_</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409675" title="=&gt; Int">end</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../collection/TraversableOnce.scala.html#58241" title="(implicit cmp: Ordering[Int])Int">max</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** A position that wraps a non-empty set of trees.
   *  The point of the wrapping position is the point of the first trees' position.
   *  If some of the trees are ranges, returns a range position enclosing all ranges
   *  Otherwise returns first tree's position.
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(trees: List[RangePositions.this.Tree])RangePositions.this.Position" id="633501">wrappingPos</a><span class="delimiter">(</span><a title="List[RangePositions.this.Tree]" id="856776">trees</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="RangePositions.this.Position">Position</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="RangePositions.this.Position" id="856794">headpos</a> = <a href="#856776" title="List[RangePositions.this.Tree]">trees</a>.<a href="../../../collection/IterableLike.scala.html#58577" title="=&gt; RangePositions.this.Tree">head</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>
    <span title="RangePositions.this.Position" class="keyword">if</span> <span class="delimiter">(</span><a href="#856794" title="RangePositions.this.Position">headpos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409666" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Positions.scala.html#408306" title="(default: RangePositions.this.Position, trees: List[RangePositions.this.Tree])RangePositions.this.Position">wrappingPos</a><span class="delimiter">(</span><a href="#856794" title="RangePositions.this.Position">headpos</a>, <a href="#856776" title="List[RangePositions.this.Tree]">trees</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#856794" title="RangePositions.this.Position">headpos</a>
  <span class="delimiter">}</span>

  // -------------- ensuring no overlaps -------------------------------
  
  /** Ensure that given tree has no positions that overlap with
   *  any of the positions of `others`. This is done by
   *  shortening the range, assigning TransparentPositions
   *  to some of the nodes in `tree` or focusing on the position.
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: RangePositions.this.Tree, others: List[RangePositions.this.Tree], focus: Boolean)Unit" id="633502">ensureNonOverlapping</a><span class="delimiter">(</span><a title="RangePositions.this.Tree" id="856803">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a>, <a title="List[RangePositions.this.Tree]" id="856804">others</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="Boolean" id="856805">focus</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(pos: RangePositions.this.Position)Boolean" id="856813">isOverlapping</a><span class="delimiter">(</span><a title="RangePositions.this.Position" id="856814">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="RangePositions.this.Position">Position</a><span class="delimiter">)</span> =
      <a href="#856814" title="RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409668" title="=&gt; Boolean">isRange</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#856804" title="List[RangePositions.this.Tree]">others</a> <a href="../../../collection/LinearSeqOptimized.scala.html#86379" title="(p: RangePositions.this.Tree =&gt; Boolean)Boolean">exists</a> <span class="delimiter">(</span><a href="#856814" title="RangePositions.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#409690" title="(pos: scala.reflect.internal.util.Position)Boolean">overlaps</a> <a href="#856821" title="RangePositions.this.Tree">_</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#856813" title="(pos: RangePositions.this.Position)Boolean">isOverlapping</a><span class="delimiter">(</span><a href="#856803" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[RangePositions.this.Tree]" id="856823">children</a> = <a href="#856803" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408549" title="=&gt; List[RangePositions.this.Tree]">children</a>
      <a href="#856823" title="List[RangePositions.this.Tree]">children</a> <a href="../../../collection/immutable/List.scala.html#62719" title="(f: RangePositions.this.Tree =&gt; Unit)Unit">foreach</a> <span class="delimiter">(</span><a href="#633502" title="(tree: RangePositions.this.Tree, others: List[RangePositions.this.Tree], focus: Boolean)Unit">ensureNonOverlapping</a><span class="delimiter">(</span><a href="#856844" title="RangePositions.this.Tree">_</a>, <a href="#856804" title="List[RangePositions.this.Tree]">others</a>, <a href="#856805" title="Boolean">focus</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#856803" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409669" title="=&gt; Boolean">isOpaqueRange</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="RangePositions.this.Position" id="856851">wpos</a> = <a href="#633500" title="(default: RangePositions.this.Position, trees: List[RangePositions.this.Tree], focus: Boolean)RangePositions.this.Position">wrappingPos</a><span class="delimiter">(</span><a href="#856803" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>, <a href="#856823" title="List[RangePositions.this.Tree]">children</a>, <a href="#856805" title="Boolean">focus</a><span class="delimiter">)</span>
        <a href="#856803" title="RangePositions.this.Tree">tree</a> <a href="../../../reflect/internal/StdAttachments.scala.html#409604" title="(newpos: RangePositions.this.Position)tree.type">setPos</a> <span class="delimiter">(</span><span title="scala.reflect.internal.util.Position" class="keyword">if</span> <span class="delimiter">(</span><a href="#856813" title="(pos: RangePositions.this.Position)Boolean">isOverlapping</a><span class="delimiter">(</span><a href="#856851" title="RangePositions.this.Position">wpos</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#856803" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409670" title="=&gt; scala.reflect.internal.util.Position">makeTransparent</a> <span class="keyword">else</span> <a href="#856851" title="RangePositions.this.Position">wpos</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(tree: RangePositions.this.Tree)List[RangePositions.this.Tree]" id="633503">solidDescendants</a><span class="delimiter">(</span><a title="RangePositions.this.Tree" id="848448">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> =
    <span title="List[RangePositions.this.Tree]" class="keyword">if</span> <span class="delimiter">(</span><a href="#848448" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409667" title="=&gt; Boolean">isTransparent</a><span class="delimiter">)</span> <a href="#848448" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408549" title="=&gt; List[RangePositions.this.Tree]">children</a> <a href="../../../collection/TraversableLike.scala.html#58068" title="(f: RangePositions.this.Tree =&gt; scala.collection.GenTraversableOnce[RangePositions.this.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[RangePositions.this.Tree],RangePositions.this.Tree,List[RangePositions.this.Tree]])List[RangePositions.this.Tree]">flatMap</a> <a href="#633503" title="(tree: RangePositions.this.Tree)List[RangePositions.this.Tree]">solidDescendants</a>
    <span class="keyword">else</span> <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: RangePositions.this.Tree*)List[RangePositions.this.Tree]">List</a><span class="delimiter">(</span><a href="#848448" title="RangePositions.this.Tree">tree</a><span class="delimiter">)</span>

  /** A free range from `lo` to `hi` */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(lo: Int, hi: Int)RangePositions.this.Range" id="633504">free</a><span class="delimiter">(</span><a title="Int" id="856919">lo</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="856920">hi</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <a href="#857792" title="RangePositions.this.Range">Range</a> =
    <a href="#857792" title="(pos: RangePositions.this.Position, tree: RangePositions.this.Tree)RangePositions.this.Range">Range</a><span class="delimiter">(</span><span title="scala.reflect.internal.util.RangePosition" class="keyword">new</span> <a href="../../../reflect/internal/util/Position.scala.html#22761" title="scala.reflect.internal.util.RangePosition">RangePosition</a><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <a href="#856919" title="Int">lo</a>, <a href="#856919" title="Int">lo</a>, <a href="#856920" title="Int">hi</a><span class="delimiter">)</span>, <a href="../../../reflect/internal/Trees.scala.html#407946" title="RangePositions.this.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span>

  /** The maximal free range */
  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="RangePositions.this.Range" id="633506">maxFree</a>: <a href="#857792" title="RangePositions.this.Range">Range</a> = <a href="#633504" title="(lo: Int, hi: Int)RangePositions.this.Range">free</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, Int.<span title="Int(2147483647)">MaxValue</span><span class="delimiter">)</span>

  /** A singleton list of a non-empty range from `lo` to `hi`, or else the empty List */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(lo: Int, hi: Int)List[RangePositions.this.Range]" id="633507">maybeFree</a><span class="delimiter">(</span><a title="Int" id="856932">lo</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="Int" id="856933">hi</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> =
    <span title="List[RangePositions.this.Range]" class="keyword">if</span> <span class="delimiter">(</span><a href="#856932" title="Int">lo</a> <a href="../../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="#856933" title="Int">hi</a><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: RangePositions.this.Range*)List[RangePositions.this.Range]">List</a><span class="delimiter">(</span><a href="#633504" title="(lo: Int, hi: Int)RangePositions.this.Range">free</a><span class="delimiter">(</span><a href="#856932" title="Int">lo</a>, <a href="#856933" title="Int">hi</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">else</span> List<a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type" class="delimiter">(</a><span class="delimiter">)</span>

  /** Insert `pos` into ranges `rs` if possible;
   *  otherwise add conflicting trees to `conflicting`.
   */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(rs: List[RangePositions.this.Range], t: RangePositions.this.Tree, conflicting: scala.collection.mutable.ListBuffer[RangePositions.this.Tree])List[RangePositions.this.Range]" id="633508">insert</a><span class="delimiter">(</span><a title="List[RangePositions.this.Range]" id="856954">rs</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Range]">List</a><span class="delimiter">[</span>Range<span class="delimiter">]</span>, <a title="RangePositions.this.Tree" id="856955">t</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a>, <a title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]" id="856956">conflicting</a>: <a href="../../../collection/mutable/ListBuffer.scala.html#13347" title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]">ListBuffer</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Range]">List</a><span class="delimiter">[</span>Range<span class="delimiter">]</span> = <a href="#856954" title="List[RangePositions.this.Range]">rs</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="../../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[RangePositions.this.Range]]" id="3331375">List</a><span class="delimiter">(</span><span class="delimiter">)</span> =&gt;
      <a href="../Global.scala.html#537498" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#856956" title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]">conflicting</a>.<a href="../../../collection/generic/TraversableForwarder.scala.html#79861" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span>
      <a href="#856954" title="List[RangePositions.this.Range]">rs</a>
    <span class="keyword">case</span> <a href="../../../collection/immutable/List.scala.html#206583" title="RangePositions.this.Range" id="856976">r</a> <a href="#3331365" title="List[RangePositions.this.Range]" id="3331369">::</a> <a href="../../../collection/immutable/List.scala.html#206584" title="List[RangePositions.this.Range]" id="856977">rs1</a> =&gt;
      <a href="../Global.scala.html#537498" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#856955" title="RangePositions.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409667" title="=&gt; Boolean">isTransparent</a><span class="delimiter">)</span>
      <span title="List[RangePositions.this.Range]" class="keyword">if</span> <span class="delimiter">(</span><a href="#856976" title="RangePositions.this.Range">r</a>.<a href="#856476" title="=&gt; Boolean">isFree</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#856976" title="RangePositions.this.Range">r</a>.<a href="#856926" title="=&gt; RangePositions.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#409686" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#856955" title="RangePositions.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
//      println(&quot;subdividing &quot;+r+&quot;/&quot;+t.pos)
        <a href="#633507" title="(lo: Int, hi: Int)List[RangePositions.this.Range]">maybeFree</a><span class="delimiter">(</span><a href="#856955" title="RangePositions.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409675" title="=&gt; Int">end</a>, <a href="#856976" title="RangePositions.this.Range">r</a>.<a href="#856926" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409675" title="=&gt; Int">end</a><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#62688" title="(prefix: List[RangePositions.this.Range])List[RangePositions.this.Range]">:::</a> <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: RangePositions.this.Range*)List[RangePositions.this.Range]">List</a><span class="delimiter">(</span><a href="#857792" title="(pos: RangePositions.this.Position, tree: RangePositions.this.Tree)RangePositions.this.Range">Range</a><span class="delimiter">(</span><a href="#856955" title="RangePositions.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>, <a href="#856955" title="RangePositions.this.Tree">t</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#62688" title="(prefix: List[RangePositions.this.Range])List[RangePositions.this.Range]">:::</a> <a href="#633507" title="(lo: Int, hi: Int)List[RangePositions.this.Range]">maybeFree</a><span class="delimiter">(</span><a href="#856976" title="RangePositions.this.Range">r</a>.<a href="#856926" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409671" title="=&gt; Int">start</a>, <a href="#856955" title="RangePositions.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409671" title="=&gt; Int">start</a><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#62688" title="(prefix: List[RangePositions.this.Range])List[RangePositions.this.Range]">:::</a> <a href="#856977" title="List[RangePositions.this.Range]">rs1</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#856976" title="RangePositions.this.Range">r</a>.<a href="#856476" title="=&gt; Boolean">isFree</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#856976" title="RangePositions.this.Range">r</a>.<a href="#856926" title="=&gt; RangePositions.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#409690" title="(pos: scala.reflect.internal.util.Position)Boolean">overlaps</a> <a href="#856955" title="RangePositions.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#856956" title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]">conflicting</a> <a href="../../../collection/mutable/ListBuffer.scala.html#79765" title="(x: RangePositions.this.Tree)conflicting.type">+=</a> <a href="#856976" title="RangePositions.this.Range">r</a>.<a href="#856927" title="=&gt; RangePositions.this.Tree">tree</a>
        <a href="#856976" title="RangePositions.this.Range">r</a> <a href="../../../collection/immutable/List.scala.html#62685" title="(x: RangePositions.this.Range)List[RangePositions.this.Range]">::</a> <a href="#633508" title="(rs: List[RangePositions.this.Range], t: RangePositions.this.Tree, conflicting: scala.collection.mutable.ListBuffer[RangePositions.this.Tree])List[RangePositions.this.Range]">insert</a><span class="delimiter">(</span><a href="#856977" title="List[RangePositions.this.Range]">rs1</a>, <a href="#856955" title="RangePositions.this.Tree">t</a>, <a href="#856956" title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]">conflicting</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Replace elem `t` of `ts` by `replacement` list. */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ts: List[RangePositions.this.Tree], t: RangePositions.this.Tree, replacement: List[RangePositions.this.Tree])List[RangePositions.this.Tree]" id="633509">replace</a><span class="delimiter">(</span><a title="List[RangePositions.this.Tree]" id="857038">ts</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="RangePositions.this.Tree" id="857039">t</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a>, <a title="List[RangePositions.this.Tree]" id="857040">replacement</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> =
    <span title="List[RangePositions.this.Tree]" class="keyword">if</span> <span class="delimiter">(</span><a href="#857038" title="List[RangePositions.this.Tree]">ts</a>.<a href="../../../collection/IterableLike.scala.html#58577" title="=&gt; RangePositions.this.Tree">head</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#857039" title="RangePositions.this.Tree">t</a><span class="delimiter">)</span> <a href="#857040" title="List[RangePositions.this.Tree]">replacement</a> <a href="../../../collection/immutable/List.scala.html#62688" title="(prefix: List[RangePositions.this.Tree])List[RangePositions.this.Tree]">:::</a> <a href="#857038" title="List[RangePositions.this.Tree]">ts</a>.<a href="../../../collection/TraversableLike.scala.html#58104" title="=&gt; List[RangePositions.this.Tree]">tail</a>
    <span class="keyword">else</span> <a href="#857038" title="List[RangePositions.this.Tree]">ts</a>.<a href="../../../collection/IterableLike.scala.html#58577" title="=&gt; RangePositions.this.Tree">head</a> <a href="../../../collection/immutable/List.scala.html#62685" title="(x: RangePositions.this.Tree)List[RangePositions.this.Tree]">::</a> <a href="#633509" title="(ts: List[RangePositions.this.Tree], t: RangePositions.this.Tree, replacement: List[RangePositions.this.Tree])List[RangePositions.this.Tree]">replace</a><span class="delimiter">(</span><a href="#857038" title="List[RangePositions.this.Tree]">ts</a>.<a href="../../../collection/TraversableLike.scala.html#58104" title="=&gt; List[RangePositions.this.Tree]">tail</a>, <a href="#857039" title="RangePositions.this.Tree">t</a>, <a href="#857040" title="List[RangePositions.this.Tree]">replacement</a><span class="delimiter">)</span>

  /** Does given list of trees have mutually non-overlapping positions?
   *  pre: None of the trees is transparent
   */
  <span class="keyword">def</span> <a title="(cts: List[RangePositions.this.Tree])List[(RangePositions.this.Tree, RangePositions.this.Tree)]" id="633510">findOverlapping</a><span class="delimiter">(</span><a title="List[RangePositions.this.Tree]" id="857059">cts</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[(RangePositions.this.Tree, RangePositions.this.Tree)]">List</a><span class="delimiter">[</span><span class="delimiter">(</span>Tree, Tree<span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="List[RangePositions.this.Range]" id="857061">ranges</a> = <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: RangePositions.this.Range*)List[RangePositions.this.Range]">List</a><span class="delimiter">(</span><a href="#633505" title="=&gt; RangePositions.this.Range">maxFree</a><span class="delimiter">)</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="RangePositions.this.Tree" id="857089">ct</a> &lt;- <a href="../../../collection/immutable/List.scala.html#62719" title="(f: RangePositions.this.Tree =&gt; Unit)Unit">cts</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#857089" title="RangePositions.this.Tree">ct</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409669" title="=&gt; Boolean">isOpaqueRange</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]" id="857091">conflicting</a> = <span title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]" class="keyword">new</span> <a href="../../../collection/mutable/ListBuffer.scala.html#13347" title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]">ListBuffer</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>
        <a href="#857061" title="List[RangePositions.this.Range]">ranges</a> = <a href="#633508" title="(rs: List[RangePositions.this.Range], t: RangePositions.this.Tree, conflicting: scala.collection.mutable.ListBuffer[RangePositions.this.Tree])List[RangePositions.this.Range]">insert</a><span class="delimiter">(</span><a href="#857061" title="List[RangePositions.this.Range]">ranges</a>, <a href="#857089" title="RangePositions.this.Tree">ct</a>, <a href="#857091" title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]">conflicting</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#857091" title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]">conflicting</a>.<a href="../../../collection/generic/TraversableForwarder.scala.html#79861" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">return</span> <a href="#857091" title="scala.collection.mutable.ListBuffer[RangePositions.this.Tree]">conflicting</a>.<a href="../../../collection/mutable/ListBuffer.scala.html#79773" title="=&gt; List[RangePositions.this.Tree]">toList</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: RangePositions.this.Tree =&gt; (RangePositions.this.Tree, RangePositions.this.Tree))(implicit bf: scala.collection.generic.CanBuildFrom[List[RangePositions.this.Tree],(RangePositions.this.Tree, RangePositions.this.Tree),List[(RangePositions.this.Tree, RangePositions.this.Tree)]])List[(RangePositions.this.Tree, RangePositions.this.Tree)]">map</a> <span class="delimiter">(</span><a title="RangePositions.this.Tree" id="857111">t</a> =&gt; <a href="../../../Tuple2.scala.html#62849" title="(_1: RangePositions.this.Tree, _2: RangePositions.this.Tree)(RangePositions.this.Tree, RangePositions.this.Tree)" class="delimiter">(</a><a href="#857111" title="RangePositions.this.Tree">t</a>, <a href="#857089" title="RangePositions.this.Tree">ct</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    List<a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type" class="delimiter">(</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  // -------------- setting positions -------------------------------

  /** Set position of all children of a node
   *  @param  pos   A target position.
   *                Uses the point of the position as the point of all positions it assigns.
   *                Uses the start of this position as an Offset position for unpositioed trees
   *                without children.
   *  @param  trees  The children to position. All children must be positionable.
   */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: RangePositions.this.Position, trees: List[RangePositions.this.Tree])Unit" id="633511">setChildrenPos</a><span class="delimiter">(</span><a title="RangePositions.this.Position" id="857158">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="RangePositions.this.Position">Position</a>, <a title="List[RangePositions.this.Tree]" id="857159">trees</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[RangePositions.this.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> = <span class="keyword">try</span> <span class="delimiter">{</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="RangePositions.this.Tree" id="857181">tree</a> &lt;- <a href="../../../collection/immutable/List.scala.html#62719" title="(f: RangePositions.this.Tree =&gt; Any)Unit">trees</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#857181" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408582" title="=&gt; Boolean">isEmpty</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#857181" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Positions.scala.html#408302" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="List[RangePositions.this.Tree]" id="857187">children</a> = <a href="#857181" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408549" title="=&gt; List[RangePositions.this.Tree]">children</a>
        <span title="tree.type" class="keyword">if</span> <span class="delimiter">(</span><a href="#857187" title="List[RangePositions.this.Tree]">children</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#857181" title="RangePositions.this.Tree">tree</a> <a href="../../../reflect/internal/StdAttachments.scala.html#409604" title="(newpos: RangePositions.this.Position)tree.type">setPos</a> <a href="#857158" title="RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409684" title="=&gt; scala.reflect.internal.util.Position">focus</a>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#633511" title="(pos: RangePositions.this.Position, trees: List[RangePositions.this.Tree])Unit">setChildrenPos</a><span class="delimiter">(</span><a href="#857158" title="RangePositions.this.Position">pos</a>, <a href="#857187" title="List[RangePositions.this.Tree]">children</a><span class="delimiter">)</span>
          <a href="#857181" title="RangePositions.this.Tree">tree</a> <a href="../../../reflect/internal/StdAttachments.scala.html#409604" title="(newpos: RangePositions.this.Position)tree.type">setPos</a> <a href="../../../reflect/internal/Positions.scala.html#408306" title="(default: RangePositions.this.Position, trees: List[RangePositions.this.Tree])RangePositions.this.Position">wrappingPos</a><span class="delimiter">(</span><a href="#857158" title="RangePositions.this.Position">pos</a>, <a href="#857187" title="List[RangePositions.this.Tree]">children</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="Nothing" id="857212">ex</a>: <span title="Exception">Exception</span> =&gt;
      <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;error while set children pos &quot;)" class="string">&quot;error while set children pos &quot;</span><span title="(x$1: Any)String">+</span><a href="#857158" title="RangePositions.this.Position">pos</a><span title="(x$1: Any)String">+</span><span title="String(&quot; of &quot;)" class="string">&quot; of &quot;</span><span title="(x$1: Any)String">+</span><a href="#857159" title="List[RangePositions.this.Tree]">trees</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <a href="#857212" title="Exception">ex</a>
  <span class="delimiter">}</span>

  /** Position a tree.
   *  This means: Set position of a node and position all its unpositioned children.
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[T &lt;: RangePositions.this.Tree](pos: RangePositions.this.Position)(tree: T)T" id="633512">atPos</a><span class="delimiter">[</span><a title=" &lt;: RangePositions.this.Tree" id="633514">T</a> &lt;: Tree<span class="delimiter">]</span><span class="delimiter">(</span><a title="RangePositions.this.Position" id="857215">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="RangePositions.this.Position">Position</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="T" id="857216">tree</a>: <a href="#633514" title="T">T</a><span class="delimiter">)</span>: <a href="#633514" title="T">T</a> = <span class="delimiter">{</span>
    <span title="T" class="keyword">if</span> <span class="delimiter">(</span><a href="#857215" title="RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409669" title="=&gt; Boolean">isOpaqueRange</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#857216" title="T">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408582" title="=&gt; Boolean">isEmpty</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#857216" title="T">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Positions.scala.html#408302" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#857216" title="T">tree</a>.<a href="../../../reflect/internal/StdAttachments.scala.html#409604" title="(newpos: RangePositions.this.Position)tree.type">setPos</a><span class="delimiter">(</span><a href="#857215" title="RangePositions.this.Position">pos</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="List[RangePositions.this.Tree]" id="857236">children</a> = <a href="#857216" title="T">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408549" title="=&gt; List[RangePositions.this.Tree]">children</a>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#857236" title="List[RangePositions.this.Tree]">children</a>.<a href="../../../collection/TraversableOnce.scala.html#58191" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#857236" title="List[RangePositions.this.Tree]">children</a>.<a href="../../../collection/TraversableLike.scala.html#58104" title="=&gt; List[RangePositions.this.Tree]">tail</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#633512" title="(pos: RangePositions.this.Position)(tree: RangePositions.this.Tree)RangePositions.this.Tree">atPos</a><span class="delimiter">(</span><a href="#857215" title="RangePositions.this.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#857236" title="List[RangePositions.this.Tree]">children</a>.<a href="../../../collection/IterableLike.scala.html#58577" title="=&gt; RangePositions.this.Tree">head</a><span class="delimiter">)</span>
          <span class="keyword">else</span> <a href="#633511" title="(pos: RangePositions.this.Position, trees: List[RangePositions.this.Tree])Unit">setChildrenPos</a><span class="delimiter">(</span><a href="#857215" title="RangePositions.this.Position">pos</a>, <a href="#857236" title="List[RangePositions.this.Tree]">children</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <a href="#857216" title="T">tree</a>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#35922" title="nsc extends scala.tools.nsc.interactive.RangePositions with scala.tools.nsc.Global" class="keyword">super</a>.<a href="../../../reflect/internal/Positions.scala.html#408315" title="(pos: RangePositions.this.Position)(tree: T)T">atPos</a><span class="delimiter">(</span><a href="#857215" title="RangePositions.this.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#857216" title="T">tree</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  // ---------------- Validating positions ----------------------------------

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: RangePositions.this.Tree)Unit" id="633515">validatePositions</a><span class="delimiter">(</span><a title="RangePositions.this.Tree" id="851226">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(prefix: String, tree: RangePositions.this.Tree)Unit" id="857267">reportTree</a><span class="delimiter">(</span><a title="String" id="857270">prefix</a> : <span title="String">String</span>, <a title="RangePositions.this.Tree" id="857271">tree</a> : <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Object" id="857272">source</a> = <span title="Object" class="keyword">if</span> <span class="delimiter">(</span><a href="#857271" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409666" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#857271" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409665" title="=&gt; scala.reflect.internal.util.SourceFile">source</a> <span class="keyword">else</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="String(&quot;== &quot;)" class="string">&quot;== &quot;</span><span title="(x$1: Any)String">+</span><a href="#857270" title="String">prefix</a><span title="(x$1: Any)String">+</span><span title="String(&quot; tree [&quot;)" class="string">&quot; tree [&quot;</span><span title="(x$1: Any)String">+</span><a href="#857271" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408569" title="=&gt; Int">id</a><span title="(x$1: Any)String">+</span><span title="String(&quot;] of type &quot;)" class="string">&quot;] of type &quot;</span><span title="(x$1: Any)String">+</span><a href="#857271" title="RangePositions.this.Tree">tree</a>.<a href="../../../Product.scala.html#56622" title="=&gt; String">productPrefix</a><span title="(x$1: Any)String">+</span><span title="String(&quot; at &quot;)" class="string">&quot; at &quot;</span><span title="(x$1: Any)String">+</span><a href="#857271" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409699" title="=&gt; String">show</a><span title="(x$1: Any)String">+</span><a href="#857272" title="Object">source</a><span class="delimiter">)</span>
      <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
      <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#537787" title="(t: RangePositions.this.Tree, enclosingTree: RangePositions.this.Tree)String">treeStatus</a><span class="delimiter">(</span><a href="#857271" title="RangePositions.this.Tree">tree</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(msg: String)(body: =&gt; Unit)Unit" id="857268">positionError</a><span class="delimiter">(</span><a title="String" id="857317">msg</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; Unit" id="857318">body</a> : =&gt; Unit<span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="String(&quot;======= Position error\n&quot;)" class="string">&quot;======= Position error\n&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#857317" title="String">msg</a><span class="delimiter">)</span>
      <a href="#857318" title="=&gt; Unit">body</a>
      <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="String(&quot;\nWhile validating #&quot;)" class="string">&quot;\nWhile validating #&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#851226" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408569" title="=&gt; Int">id</a><span class="delimiter">)</span>
      <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#537787" title="(t: RangePositions.this.Tree, enclosingTree: RangePositions.this.Tree)String">treeStatus</a><span class="delimiter">(</span><a href="#851226" title="RangePositions.this.Tree">tree</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="String(&quot;\nChildren:&quot;)" class="string">&quot;\nChildren:&quot;</span><span class="delimiter">)</span>
      <a href="#851226" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408549" title="=&gt; List[RangePositions.this.Tree]">children</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: RangePositions.this.Tree =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[RangePositions.this.Tree],String,List[String]])List[String]">map</a> <span class="delimiter">(</span><a title="RangePositions.this.Tree" id="857366">t</a> =&gt; <span title="String(&quot;  &quot;)" class="string">&quot;  &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../ast/Trees.scala.html#537787" title="(t: RangePositions.this.Tree, enclosingTree: RangePositions.this.Tree)String">treeStatus</a><span class="delimiter">(</span><a href="#857366" title="RangePositions.this.Tree">t</a>, <a href="#851226" title="RangePositions.this.Tree">tree</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#62719" title="(f: String =&gt; Unit)Unit">foreach</a> <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a>
      <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="String(&quot;=======&quot;)" class="string">&quot;=======&quot;</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <span title="RangePositions.this.ValidateException" class="keyword">new</span> <a href="#633516" title="RangePositions.this.ValidateException">ValidateException</a><span class="delimiter">(</span><a href="#857317" title="String">msg</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(tree: RangePositions.this.Tree, encltree: RangePositions.this.Tree)Unit" id="857269">validate</a><span class="delimiter">(</span><a title="RangePositions.this.Tree" id="857436">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a>, <a title="RangePositions.this.Tree" id="857437">encltree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> = <span class="delimiter">{</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#857436" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408582" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#540152" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">Yposdebug</a>.<a href="../settings/MutableSettings.scala.html#541066" title="=&gt; Boolean">value</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../settings/StandardScalaSettings.scala.html#540228" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">verbose</a>.<a href="../settings/MutableSettings.scala.html#541066" title="=&gt; Boolean">value</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#540111" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">Yrangepos</a>.<a href="../settings/MutableSettings.scala.html#541066" title="=&gt; Boolean">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../Predef.scala.html#7514" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;[%10s] %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><span title="String(&quot;validate&quot;)" class="string">&quot;validate&quot;</span>, <a href="../ast/Trees.scala.html#537787" title="(t: RangePositions.this.Tree, enclosingTree: RangePositions.this.Tree)String">treeStatus</a><span class="delimiter">(</span><a href="#857436" title="RangePositions.this.Tree">tree</a>, <a href="#857437" title="RangePositions.this.Tree">encltree</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#857436" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409666" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span>
          <a href="#857268" title="(msg: String)(body: =&gt; Unit)Unit">positionError</a><span class="delimiter">(</span><span title="String(&quot;Unpositioned tree #&quot;)" class="string">&quot;Unpositioned tree #&quot;</span><span title="(x$1: Any)String">+</span><a href="#857436" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408569" title="=&gt; Int">id</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%15s %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><span title="String(&quot;unpositioned&quot;)" class="string">&quot;unpositioned&quot;</span>, <a href="../ast/Trees.scala.html#537787" title="(t: RangePositions.this.Tree, enclosingTree: RangePositions.this.Tree)String">treeStatus</a><span class="delimiter">(</span><a href="#857436" title="RangePositions.this.Tree">tree</a>, <a href="#857437" title="RangePositions.this.Tree">encltree</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%15s %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><span title="String(&quot;enclosing&quot;)" class="string">&quot;enclosing&quot;</span>, <a href="../ast/Trees.scala.html#537787" title="(t: RangePositions.this.Tree, enclosingTree: RangePositions.this.Tree)String">treeStatus</a><span class="delimiter">(</span><a href="#857437" title="RangePositions.this.Tree">encltree</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#857437" title="RangePositions.this.Tree">encltree</a>.<a href="../../../reflect/internal/Trees.scala.html#408549" title="=&gt; List[RangePositions.this.Tree]">children</a> <a href="../../../collection/immutable/List.scala.html#62719" title="(f: RangePositions.this.Tree =&gt; Unit)Unit">foreach</a> <span class="delimiter">(</span><a title="RangePositions.this.Tree" id="857492">t</a> =&gt; <a href="../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%15s %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><span title="String(&quot;sibling&quot;)" class="string">&quot;sibling&quot;</span>, <a href="../ast/Trees.scala.html#537787" title="(t: RangePositions.this.Tree, enclosingTree: RangePositions.this.Tree)String">treeStatus</a><span class="delimiter">(</span><a href="#857492" title="RangePositions.this.Tree">t</a>, <a href="#857437" title="RangePositions.this.Tree">encltree</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#857436" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409668" title="=&gt; Boolean">isRange</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#857437" title="RangePositions.this.Tree">encltree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409668" title="=&gt; Boolean">isRange</a><span class="delimiter">)</span>
            <a href="#857268" title="(msg: String)(body: =&gt; Unit)Unit">positionError</a><span class="delimiter">(</span><span title="String(&quot;Synthetic tree [&quot;)" class="string">&quot;Synthetic tree [&quot;</span><span title="(x$1: Any)String">+</span><a href="#857437" title="RangePositions.this.Tree">encltree</a>.<a href="../../../reflect/internal/Trees.scala.html#408569" title="=&gt; Int">id</a><span title="(x$1: Any)String">+</span><span title="String(&quot;] contains nonsynthetic tree [&quot;)" class="string">&quot;] contains nonsynthetic tree [&quot;</span><span title="(x$1: Any)String">+</span><a href="#857436" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408569" title="=&gt; Int">id</a><span title="(x$1: Any)String">+</span><span title="String(&quot;]&quot;)" class="string">&quot;]&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#857267" title="(prefix: String, tree: RangePositions.this.Tree)Unit">reportTree</a><span class="delimiter">(</span><span title="String(&quot;Enclosing&quot;)" class="string">&quot;Enclosing&quot;</span>, <a href="#857437" title="RangePositions.this.Tree">encltree</a><span class="delimiter">)</span>
            <a href="#857267" title="(prefix: String, tree: RangePositions.this.Tree)Unit">reportTree</a><span class="delimiter">(</span><span title="String(&quot;Enclosed&quot;)" class="string">&quot;Enclosed&quot;</span>, <a href="#857436" title="RangePositions.this.Tree">tree</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="#857437" title="RangePositions.this.Tree">encltree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#409686" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#857436" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#857268" title="(msg: String)(body: =&gt; Unit)Unit">positionError</a><span class="delimiter">(</span><span title="String(&quot;Enclosing tree [&quot;)" class="string">&quot;Enclosing tree [&quot;</span><span title="(x$1: Any)String">+</span><a href="#857437" title="RangePositions.this.Tree">encltree</a>.<a href="../../../reflect/internal/Trees.scala.html#408569" title="=&gt; Int">id</a><span title="(x$1: Any)String">+</span><span title="String(&quot;] does not include tree [&quot;)" class="string">&quot;] does not include tree [&quot;</span><span title="(x$1: Any)String">+</span><a href="#857436" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408569" title="=&gt; Int">id</a><span title="(x$1: Any)String">+</span><span title="String(&quot;]&quot;)" class="string">&quot;]&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#857267" title="(prefix: String, tree: RangePositions.this.Tree)Unit">reportTree</a><span class="delimiter">(</span><span title="String(&quot;Enclosing&quot;)" class="string">&quot;Enclosing&quot;</span>, <a href="#857437" title="RangePositions.this.Tree">encltree</a><span class="delimiter">)</span>
              <a href="#857267" title="(prefix: String, tree: RangePositions.this.Tree)Unit">reportTree</a><span class="delimiter">(</span><span title="String(&quot;Enclosed&quot;)" class="string">&quot;Enclosed&quot;</span>, <a href="#857436" title="RangePositions.this.Tree">tree</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <a href="#633510" title="(cts: List[RangePositions.this.Tree])List[(RangePositions.this.Tree, RangePositions.this.Tree)]">findOverlapping</a><a href="#3331392" title="List[(RangePositions.this.Tree, RangePositions.this.Tree)]" class="delimiter">(</a><a href="#857436" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408549" title="=&gt; List[RangePositions.this.Tree]">children</a> <a href="../../../collection/TraversableLike.scala.html#58068" title="(f: RangePositions.this.Tree =&gt; scala.collection.GenTraversableOnce[RangePositions.this.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[RangePositions.this.Tree],RangePositions.this.Tree,List[RangePositions.this.Tree]])List[RangePositions.this.Tree]">flatMap</a> <a href="#633503" title="(tree: RangePositions.this.Tree)List[RangePositions.this.Tree]">solidDescendants</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="../../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[(RangePositions.this.Tree, RangePositions.this.Tree)]]" id="3331401">List</a><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; ;
            <span class="keyword">case</span> xs =&gt; <span class="delimiter">{</span>
              <a href="#857268" title="(msg: String)(body: =&gt; Unit)Unit">positionError</a><span class="delimiter">(</span><span title="String(&quot;Overlapping trees &quot;)" class="string">&quot;Overlapping trees &quot;</span><span title="(x$1: Any)String">+</span>xs.<a href="../../../collection/TraversableLike.scala.html#58063" title="(f: ((RangePositions.this.Tree, RangePositions.this.Tree)) =&gt; (Int, Int))(implicit bf: scala.collection.generic.CanBuildFrom[List[(RangePositions.this.Tree, RangePositions.this.Tree)],(Int, Int),List[(Int, Int)]])List[(Int, Int)]">map</a> <a href="#857581" title="(RangePositions.this.Tree, RangePositions.this.Tree)" class="delimiter">{</a> <span class="keyword">case</span> <span class="delimiter">(</span><a href="../../../Tuple2.scala.html#60635" title="RangePositions.this.Tree" id="857584">x</a>, <a href="../../../Tuple2.scala.html#60637" title="RangePositions.this.Tree" id="857585">y</a><span class="delimiter">)</span> =&gt; <a href="#3331382" title="(x: (Int, Int))(Int, Int)" class="delimiter">(</a><a href="#857584" title="RangePositions.this.Tree">x</a>.<a href="../../../reflect/internal/Trees.scala.html#408569" title="=&gt; Int">id</a>, <a href="#857585" title="RangePositions.this.Tree">y</a>.<a href="../../../reflect/internal/Trees.scala.html#408569" title="=&gt; Int">id</a><span class="delimiter">)</span> <span class="delimiter">}</span>.<a href="../../../collection/TraversableOnce.scala.html#58282" title="(start: String, sep: String, end: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#3331397" title="(x: Unit)Unit" class="delimiter">{</a>
                <a href="#857267" title="(prefix: String, tree: RangePositions.this.Tree)Unit">reportTree</a><span class="delimiter">(</span><span title="String(&quot;Ancestor&quot;)" class="string">&quot;Ancestor&quot;</span>, <a href="#857436" title="RangePositions.this.Tree">tree</a><span class="delimiter">)</span>
                <span class="keyword">for</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="../../../Tuple2.scala.html#60635" title="RangePositions.this.Tree" id="857647">x</a>, <a href="../../../Tuple2.scala.html#60637" title="RangePositions.this.Tree" id="857648">y</a><span class="delimiter">)</span> &lt;- <a href="../../../collection/immutable/List.scala.html#62719" title="(f: ((RangePositions.this.Tree, RangePositions.this.Tree)) =&gt; Unit)Unit">xs</a><span class="delimiter">)</span> <a href="#3331388" title="(x: Unit)Unit" class="delimiter">{</a>
                  <a href="#857267" title="(prefix: String, tree: RangePositions.this.Tree)Unit">reportTree</a><span class="delimiter">(</span><span title="String(&quot;First overlapping&quot;)" class="string">&quot;First overlapping&quot;</span>, <a href="#857647" title="RangePositions.this.Tree">x</a><span class="delimiter">)</span>
                  <a href="#857267" title="(prefix: String, tree: RangePositions.this.Tree)Unit">reportTree</a><span class="delimiter">(</span><span title="String(&quot;Second overlapping&quot;)" class="string">&quot;Second overlapping&quot;</span>, <a href="#857648" title="RangePositions.this.Tree">y</a><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="RangePositions.this.Tree" id="857720">ct</a> &lt;- <a href="#857436" title="RangePositions.this.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408549" title="=&gt; List[RangePositions.this.Tree]">children</a> <a href="../../../collection/immutable/List.scala.html#62719" title="(f: RangePositions.this.Tree =&gt; Unit)Unit">flatMap</a> <a href="#633503" title="(tree: RangePositions.this.Tree)List[RangePositions.this.Tree]">solidDescendants</a><span class="delimiter">)</span> <a href="#857269" title="(tree: RangePositions.this.Tree, encltree: RangePositions.this.Tree)Unit">validate</a><span class="delimiter">(</span><a href="#857720" title="RangePositions.this.Tree">ct</a>, <a href="#857436" title="RangePositions.this.Tree">tree</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../reflect/internal/SymbolTable.scala.html#406659" title="=&gt; scala.reflect.internal.Phase">phase</a>.<a href="../../../reflect/internal/Phase.scala.html#419695" title="=&gt; Int">id</a> <a href="../../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <a href="../Global.scala.html#537672" title="=&gt; RangePositions.this.Run">currentRun</a>.<a href="../Global.scala.html#539378" title="=&gt; scala.tools.nsc.Phase">typerPhase</a>.<a href="../../../reflect/internal/Phase.scala.html#419695" title="=&gt; Int">id</a><span class="delimiter">)</span>
      <a href="#857269" title="(tree: RangePositions.this.Tree, encltree: RangePositions.this.Tree)Unit">validate</a><span class="delimiter">(</span><a href="#851226" title="RangePositions.this.Tree">tree</a>, <a href="#851226" title="RangePositions.this.Tree">tree</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class ValidateException extends Exception" id="633516">ValidateException</a><a href="#633516" title="RangePositions.this.ValidateException" class="delimiter">(</a><a title="String" id="857435">msg</a> : <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../package.scala.html#55500" title="Exception">Exception</a><span class="delimiter">(</span><a href="#857435" title="String">msg</a><span class="delimiter">)</span>

  // ---------------- Locating trees ----------------------------------

  /** A locator for trees with given positions.
   *  Given a position `pos`, locator.apply returns
   *  the smallest tree that encloses `pos`.
   */
  <span class="keyword">class</span> <a title="class Locator extends RangePositions.this.Traverser" id="633517">Locator</a><a href="#633517" title="RangePositions.this.Locator" class="delimiter">(</a><a title="RangePositions.this.Position" id="846573">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="RangePositions.this.Position">Position</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../reflect/api/Trees.scala.html#56467" title="RangePositions.this.Traverser">Traverser</a> <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="RangePositions.this.Tree" id="846568">last</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a> = _
    <span class="keyword">def</span> <a title="(root: RangePositions.this.Tree)RangePositions.this.Tree" id="846570">locateIn</a><span class="delimiter">(</span><a title="RangePositions.this.Tree" id="846575">root</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a> = <span class="delimiter">{</span>
      <a href="#633517" title="Locator.this.type" class="keyword">this</a>.<a href="#846568" title="(x$1: RangePositions.this.Tree)Unit">last</a> = <a href="../../../reflect/internal/Trees.scala.html#407946" title="RangePositions.this.EmptyTree.type">EmptyTree</a>
      <a href="#846572" title="(t: RangePositions.this.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#846575" title="RangePositions.this.Tree">root</a><span class="delimiter">)</span>
      <a href="#633517" title="Locator.this.type" class="keyword">this</a>.<a href="#846568" title="=&gt; RangePositions.this.Tree">last</a>
    <span class="delimiter">}</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(t: RangePositions.this.Tree)Boolean" id="846571">isEligible</a><span class="delimiter">(</span><a title="RangePositions.this.Tree" id="857742">t</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a><span class="delimiter">)</span> = <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#857742" title="RangePositions.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409667" title="=&gt; Boolean">isTransparent</a>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(t: RangePositions.this.Tree)Unit" id="846572">traverse</a><span class="delimiter">(</span><a title="RangePositions.this.Tree" id="857740">t</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#857740" title="RangePositions.this.Tree">t</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#3331415" title="Unit" id="3331417">tt</a> : TypeTree <span class="keyword">if</span> tt.<a href="../../../reflect/internal/Trees.scala.html#409893" title="=&gt; RangePositions.this.Tree">original</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span>tt.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#409686" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> tt.<a href="../../../reflect/internal/Trees.scala.html#409893" title="=&gt; RangePositions.this.Tree">original</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a><span class="delimiter">)</span> =&gt;
          <a href="#846572" title="(t: RangePositions.this.Tree)Unit">traverse</a><a href="#3331419" title="(x: Unit)Unit" class="delimiter">(</a>tt.<a href="../../../reflect/internal/Trees.scala.html#409893" title="=&gt; RangePositions.this.Tree">original</a><span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt;
          <a href="#3331419" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#857740" title="RangePositions.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; RangePositions.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#409686" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#846573" title="RangePositions.this.Position">pos</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#846571" title="(t: RangePositions.this.Tree)Boolean">isEligible</a><span class="delimiter">(</span><a href="#857740" title="RangePositions.this.Tree">t</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#846568" title="(x$1: RangePositions.this.Tree)Unit">last</a> = <a href="#857740" title="RangePositions.this.Tree">t</a>
            <a href="#633517" title="RangePositions.this.Locator" class="keyword">super</a>.<a href="../../../reflect/api/Trees.scala.html#405544" title="(tree: RangePositions.this.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#857740" title="RangePositions.this.Tree">t</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#857740" title="RangePositions.this.Tree">t</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#3331406" title="Unit" id="3331408">mdef</a>: MemberDef =&gt;
              <a href="../../../reflect/api/Trees.scala.html#405545" title="(trees: List[RangePositions.this.Tree])Unit">traverseTrees</a><a href="#3331410" title="(x: Unit)Unit" class="delimiter">(</a>mdef.<a href="../../../reflect/internal/Trees.scala.html#410250" title="=&gt; RangePositions.this.Modifiers">mods</a>.<a href="../../../reflect/internal/Trees.scala.html#409804" title="=&gt; List[RangePositions.this.Tree]">annotations</a><span class="delimiter">)</span>
            <span class="keyword">case</span> _ =&gt;
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class TypedLocator extends RangePositions.this.Locator" id="633518">TypedLocator</a><a href="#633518" title="RangePositions.this.TypedLocator" class="delimiter">(</a><a title="RangePositions.this.Position" id="850092">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="RangePositions.this.Position">Position</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#633517" title="RangePositions.this.Locator">Locator</a><span class="delimiter">(</span><a href="#850092" title="RangePositions.this.Position">pos</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(t: RangePositions.this.Tree)Boolean" id="850091">isEligible</a><span class="delimiter">(</span><a title="RangePositions.this.Tree" id="857761">t</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="RangePositions.this.Tree">Tree</a><span class="delimiter">)</span> = <a href="#633518" title="RangePositions.this.TypedLocator" class="keyword">super</a>.<a href="#846571" title="(t: RangePositions.this.Tree)Boolean">isEligible</a><span class="delimiter">(</span><a href="#857761" title="RangePositions.this.Tree">t</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#857761" title="RangePositions.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; RangePositions.this.Type">tpe</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
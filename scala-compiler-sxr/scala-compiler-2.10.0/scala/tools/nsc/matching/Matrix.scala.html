<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/matching/Matrix.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2013 LAMP/EPFL
 * Author: Paul Phillips
 */

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> matching

<span class="keyword">import</span> transform.ExplicitOuter
<span class="keyword">import</span> symtab.Flags
<span class="keyword">import</span> scala.collection.mutable
<span class="keyword">import</span> scala.<a href="../../../language.scala.html#1423" title="language.type">language</a>.implicitConversions

<span class="keyword">trait</span> <a title="trait Matrix extends Object with scala.tools.nsc.matching.MatrixAdditions" id="41016">Matrix</a> <a href="../../../Unit.scala.html#1515" title="Unit" class="keyword">extends</a> <a href="MatrixAdditions.scala.html#40947" title="scala.tools.nsc.matching.MatrixAdditions">MatrixAdditions</a> <span class="delimiter">{</span>
  self: ExplicitOuter <span class="keyword">with</span> ParallelMatching =&gt;

  <span class="keyword">import</span> <a href="../transform/TypingTransformers.scala.html#621439" title="=&gt; scala.tools.nsc.Global">global</a>.<span class="delimiter">{</span> typer =&gt; _, _ <span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="../Global.scala.html#537550" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: Matrix.this.global.type}">analyzer</a>.Typer
  <span class="keyword">import</span> <a href="../ast/TreeDSL.scala.html#538235" title="Matrix.this.CODE.type">CODE</a>._
  <span class="keyword">import</span> <a href="MatchSupport.scala.html#621954" title="Matrix.this.Debug.type">Debug</a>._
  <span class="keyword">import</span> <a href="../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.<span class="delimiter">{</span> SYNTHETIC, MUTABLE <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>matching<span class="delimiter">]</span> <span class="keyword">val</span> <a title="Long" id="621980">NO_EXHAUSTIVE</a> = Flags.<span title="Long(274877906944L)">TRANS_FLAG</span>

  /** Translation of match expressions.
   *
   *  `p`:  pattern
   *  `g`:  guard
   *  `bx`: body index
   *
   *   internal representation is (tvars:List[Symbol], rows:List[Row])
   *
   *         tmp1      tmp_n
   *    Row( p_11  ...  p_1n   g_1  b_1 ) + subst
   *
   *    Row( p_m1  ...  p_mn   g_m  b_m ) + subst
   *
   * Implementation based on the algorithm described in
   *
   *   &quot;A Term Pattern-Match Compiler Inspired by Finite Automata Theory&quot;
   *   Mikael Pettersson
   *   ftp://ftp.ida.liu.se/pub/labs/pelab/papers/cc92pmc.ps.gz
   *
   *  @author Burak Emir
   */

  /** &quot;The Mixture Rule&quot;

        {v=pat1, pats1 .. } {q1}
  match {..               } {..}
        {v=patn, patsn .. } {qn}

  The is the real work-horse of the algorithm. There is some column whose top-most pattern is a
  constructor. (Forsimplicity, itisdepicted above asthe left-most column, but anycolumn will do.)
  The goal is to build a test state with the variablevand some outgoing arcs (one for each construc-
  tor and possibly a default arc). Foreach constructor in the selected column, its arc is deﬁned as
  follows:

  Let {i1,...,ij} be the rows-indices of the patterns in the column that match c. Since the pat-
  terns are viewed as regular expressions, this will be the indices of the patterns that either
  have the same constructor c, or are wildcards.

  Let {pat1,...,patj} be the patterns in the column corresponding to the indices computed
  above, and let nbe the arity of the constructor c, i.e. the number of sub-patterns it has. For
  eachpati, its n sub-patterns are extracted; if pat i is a wildcard, nwildcards are produced
  instead, each tagged with the right path variable. This results in a pattern matrix with n
  columns and j rows. This matrix is then appended to the result of selecting, from each col-
  umn in the rest of the original matrix, those rows whose indices are in {i1,...,ij}. Finally
  the indices are used to select the corresponding ﬁnal states that go with these rows. Note
  that the order of the indices is signiﬁcant; selected rows do not change their relative orders.
  The arc for the constructor c is now deﬁned as (c’,state), where c’ is cwith any
  immediate sub-patterns replaced by their path variables (thus c’ is a simple pattern), and
  state is the result of recursively applying match to the new matrix and the new sequence
  of ﬁnal states.

  Finally, the possibility for matching failure is considered. If the set of constructors is exhaustive,
  then no more arcs are computed. Otherwise, a default arc(_,state)is the last arc. If there are
  any wildcard patterns in the selected column, then their rows are selected from the rest of the
  matrix and the ﬁnal states, and the state is the result of applying match to the new matrix and
  states. Otherwise,the error state is used after its reference count has been incremented.
  **/

  /** Handles all translation of pattern matching.
   */
  <span class="keyword">def</span> <a title="(selector: Matrix.this.global.Tree, cases: List[Matrix.this.global.CaseDef], isChecked: Boolean, context: Matrix.this.MatrixContext)Matrix.this.global.Tree" id="621982">handlePattern</a><span class="delimiter">(</span>
    <a title="Matrix.this.global.Tree" id="929640">selector</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Matrix.this.global.Tree">Tree</a>,         // tree being matched upon (called scrutinee after this)
    <a title="List[Matrix.this.global.CaseDef]" id="929641">cases</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Matrix.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span>,   // list of cases in the match
    <a title="Boolean" id="929642">isChecked</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a>,     // whether exhaustiveness checking is enabled (disabled with @unchecked)
    <a title="Matrix.this.MatrixContext" id="929643">context</a>: <a href="#931540" title="Matrix.this.MatrixContext">MatrixContext</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Matrix.this.global.Tree">Tree</a> =
  <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#929643" title="Matrix.this.MatrixContext">context</a>._
    <a href="MatchSupport.scala.html#928643" title="(f: String, xs: Any*)Unit">TRACE</a><span class="delimiter">(</span><span title="String(&quot;handlePattern&quot;)" class="string">&quot;handlePattern&quot;</span>, <span title="String(&quot;(%s: %s) match { %s cases }&quot;)" class="string">&quot;(%s: %s) match { %s cases }&quot;</span>, <a href="#929640" title="Matrix.this.global.Tree">selector</a>, <a href="#929640" title="Matrix.this.global.Tree">selector</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Matrix.this.global.Type">tpe</a>, <a href="#929641" title="List[Matrix.this.global.CaseDef]">cases</a>.<a href="../../../collection/SeqLike.scala.html#58788" title="=&gt; Int">size</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="context.MatrixInit" id="929693">matrixInit</a>: <a href="#931421" title="context.MatrixInit">MatrixInit</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="context.PatternVar" id="929711">v</a> = <a href="#929687" title="(root: Matrix.this.global.Tree, checked: Boolean, _tpe: Matrix.this.global.Type, label: String)context.PatternVar">copyVar</a><span class="delimiter">(</span><a href="#929640" title="Matrix.this.global.Tree">selector</a>, <a href="#929642" title="Boolean">isChecked</a>, <a href="#929640" title="Matrix.this.global.Tree">selector</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Matrix.this.global.Type">tpe</a>, <span title="String(&quot;temp&quot;)" class="string">&quot;temp&quot;</span><span class="delimiter">)</span>
      <a href="#931421" title="(roots: List[context.PatternVar], cases: List[Matrix.this.global.CaseDef], default: Matrix.this.global.Tree)context.MatrixInit">MatrixInit</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#62451" title="(xs: context.PatternVar*)List[context.PatternVar]">List</a><span class="delimiter">(</span><a href="#929711" title="context.PatternVar">v</a><span class="delimiter">)</span>, <a href="#929641" title="List[Matrix.this.global.CaseDef]">cases</a>, <a href="../../../reflect/internal/Positions.scala.html#408315" title="(pos: Matrix.this.global.Position)(tree: Matrix.this.global.Throw)Matrix.this.global.Throw">atPos</a><span class="delimiter">(</span><a href="#929640" title="Matrix.this.global.Tree">selector</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Matrix.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#624587" title="(arg: Matrix.this.global.Tree)Matrix.this.global.Throw">MATCHERROR</a><span class="delimiter">(</span><a href="#929711" title="context.PatternVar">v</a>.<a href="#929731" title="=&gt; Matrix.this.global.analyzer.global.Tree">ident</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="matrix extends Matrix.this.MatchMatrix" id="929694">matrix</a> = <a href="#929794" title="Matrix.this.MatchMatrix{}" class="keyword">new</a> <a href="ParallelMatching.scala.html#621942" title="anonymous class $anon extends Matrix.this.MatchMatrix" id="929794">MatchMatrix</a><span class="delimiter">(</span><a href="#929643" title="Matrix.this.MatrixContext">context</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="context.MatrixInit" id="929861">data</a> = <a href="#929693" title="context.MatrixInit">matrixInit</a> <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="Matrix.this.global.analyzer.global.Tree" id="929695">mch</a>     = <a href="#931500" title="=&gt; Matrix.this.global.analyzer.Typer">typer</a> <a href="../typechecker/Typers.scala.html#538701" title="(tree: Matrix.this.global.analyzer.global.Tree)Matrix.this.global.analyzer.global.Tree">typed</a> <a href="#929694" title="matrix extends Matrix.this.MatchMatrix">matrix</a>.<a href="ParallelMatching.scala.html#929819" title="=&gt; matrix.Rep">expansion</a>.<a href="ParallelMatching.scala.html#929918" title="()Matrix.this.global.Tree">toTree</a>
    <span class="keyword">val</span> <a title="Matrix.this.global.analyzer.global.Tree" id="929696">dfatree</a> = <a href="#931500" title="=&gt; Matrix.this.global.analyzer.Typer">typer</a> <a href="../typechecker/Typers.scala.html#538701" title="(tree: Matrix.this.global.analyzer.global.Tree)Matrix.this.global.analyzer.global.Tree">typed</a> <a href="../../../reflect/internal/Trees.scala.html#453067" title="(stats: List[Matrix.this.global.Tree], expr: Matrix.this.global.Tree)Matrix.this.global.Block">Block</a><span class="delimiter">(</span><a href="#929694" title="matrix extends Matrix.this.MatchMatrix">matrix</a>.<a href="#929883" title="=&gt; context.MatrixInit">data</a>.<a href="#929708" title="=&gt; List[Matrix.this.global.analyzer.global.ValDef]">valDefs</a>, <a href="#929695" title="Matrix.this.global.analyzer.global.Tree">mch</a><span class="delimiter">)</span>

    // redundancy check
    <a href="#929694" title="matrix extends Matrix.this.MatchMatrix">matrix</a>.<a href="ParallelMatching.scala.html#929817" title="=&gt; List[Product with Serializable with matrix.State]">targets</a> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: Product with Serializable with matrix.State =&gt; Boolean)List[Product with Serializable with matrix.State]">filter</a> <span class="delimiter">(</span><a href="#930568" title="MatchMatrix extends Product with Serializable with matrix.State">_</a>.<a href="ParallelMatching.scala.html#930288" title="=&gt; Boolean">unreached</a><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#62719" title="(f: Product with Serializable with matrix.State =&gt; Unit)Unit">foreach</a> <span class="delimiter">(</span><a title="MatchMatrix extends Product with Serializable with matrix.State" id="930596">cs</a> =&gt; <a href="#931498" title="=&gt; Matrix.this.global.CompilationUnit">cunit</a>.<a href="../CompilationUnits.scala.html#539298" title="(pos: Matrix.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#930596" title="MatchMatrix extends Product with Serializable with matrix.State">cs</a>.<a href="ParallelMatching.scala.html#930280" title="=&gt; Matrix.this.global.Tree">body</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Matrix.this.global.Position">pos</a>, <span title="String(&quot;unreachable code&quot;)" class="string">&quot;unreachable code&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    // optimize performs squeezing and resets any remaining NO_EXHAUSTIVE
    <a href="MatchSupport.scala.html#928645" title="(s: String)(x: Matrix.this.global.Tree)Matrix.this.global.Tree">tracing</a><span class="delimiter">(</span><span title="String(&quot;handlePattern&quot;)" class="string">&quot;handlePattern&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#929694" title="matrix extends Matrix.this.MatchMatrix">matrix</a> <a href="MatrixAdditions.scala.html#929798" title="(tree: Matrix.this.global.Tree)Matrix.this.global.Tree">optimize</a> <a href="#929696" title="Matrix.this.global.analyzer.global.Tree">dfatree</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class MatrixContext extends Object with Matrix.this.Squeezer with Product with Serializable" id="931540">MatrixContext</a><a href="../../../Product.scala.html#186" title="Product" class="delimiter">(</a>
    <a title="Matrix.this.global.CompilationUnit" id="931498">cunit</a>: <a href="../CompilationUnits.scala.html#537766" title="Matrix.this.global.CompilationUnit">CompilationUnit</a>,       // current unit
    <a title="Matrix.this.global.Tree =&gt; Matrix.this.global.Tree" id="931499">handleOuter</a>: Tree =&gt; Tree,    // for outer pointer
    <a title="Matrix.this.global.analyzer.Typer" id="931500">typer</a>: <a href="../typechecker/Typers.scala.html#538117" title="Matrix.this.global.analyzer.Typer">Typer</a>,                 // a local typer
    <a title="Matrix.this.global.Symbol" id="931501">owner</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Matrix.this.global.Symbol">Symbol</a>,                // the current owner
    <a title="Matrix.this.global.Type" id="931502">matchResultType</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="Matrix.this.global.Type">Type</a><span class="delimiter">)</span>        // the expected result type of the whole match
      <span class="keyword">extends</span> <a href="MatrixAdditions.scala.html#621970" title="Matrix.this.Squeezer">Squeezer</a>
  <span class="delimiter">{</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](x: T, alt: T)T" id="929669">ifNull</a><span class="delimiter">[</span><a title="" id="929671">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="930656">x</a>: <a href="#929671" title="T">T</a>, <a title="T" id="930657">alt</a>: <a href="#929671" title="T">T</a><span class="delimiter">)</span> = <span title="T" class="keyword">if</span> <span class="delimiter">(</span><a href="#930656" title="T">x</a> <span title="(x$1: Any)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#930657" title="T">alt</a> <span class="keyword">else</span> <a href="#930656" title="T">x</a>

    // NO_EXHAUSTIVE communicates there should be no exhaustiveness checking
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(checked: Boolean)List[Long]" id="929672">flags</a><span class="delimiter">(</span><a title="Boolean" id="930662">checked</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> = <span title="List[Long]" class="keyword">if</span> <span class="delimiter">(</span><a href="#930662" title="Boolean">checked</a><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a> <span class="keyword">else</span> <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: Long*)List[Long]">List</a><span class="delimiter">(</span><a href="#621980" title="=&gt; Long">NO_EXHAUSTIVE</a><span class="delimiter">)</span>

    // Recording the symbols of the synthetics we create so we don't go clearing
    // anyone else's mutable flags.
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[Matrix.this.global.Symbol]" id="929673">_syntheticSyms</a> = mutable.<a href="../../../collection/generic/GenericCompanion.scala.html#59933" title="[A](elems: A*)scala.collection.mutable.HashSet[A]">HashSet</a><span title="(elems: Matrix.this.global.Symbol*)scala.collection.mutable.HashSet[Matrix.this.global.Symbol]" class="delimiter">[</span><a href="../../../reflect/internal/Symbols.scala.html#407146" title="Matrix.this.global.Symbol">Symbol</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="()Unit" id="929675">clearSyntheticSyms</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#929673" title="=&gt; scala.collection.mutable.HashSet[Matrix.this.global.Symbol]">_syntheticSyms</a> <a href="../../../collection/mutable/HashSet.scala.html#125970" title="(f: Matrix.this.global.Symbol =&gt; Matrix.this.global.Symbol)Unit">foreach</a> <span class="delimiter">(</span><a href="#930692" title="Matrix.this.global.Symbol">_</a> <a href="../../../reflect/internal/Symbols.scala.html#411237" title="(mask: Long)x$2.type">resetFlag</a> <span class="delimiter">(</span><a href="#621980" title="=&gt; Long">NO_EXHAUSTIVE</a><a href="../../../Long.scala.html#57505" title="(x: Int)Long">|</a><span title="Int(4096)">MUTABLE</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Cleared NO_EXHAUSTIVE/MUTABLE on &quot;)" class="string">&quot;Cleared NO_EXHAUSTIVE/MUTABLE on &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#929673" title="=&gt; scala.collection.mutable.HashSet[Matrix.this.global.Symbol]">_syntheticSyms</a>.<a href="../../../collection/mutable/HashSet.scala.html#125961" title="=&gt; Int">size</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; synthetic symbols.&quot;)" class="string">&quot; synthetic symbols.&quot;</span><span class="delimiter">)</span>
      <a href="#929673" title="=&gt; scala.collection.mutable.HashSet[Matrix.this.global.Symbol]">_syntheticSyms</a>.<a href="../../../collection/mutable/HashSet.scala.html#125968" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(sym: Matrix.this.global.Symbol)Matrix.this.global.Symbol" id="929676">recordSyntheticSym</a><span class="delimiter">(</span><a title="Matrix.this.global.Symbol" id="930702">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Matrix.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Matrix.this.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
      <a href="#929673" title="=&gt; scala.collection.mutable.HashSet[Matrix.this.global.Symbol]">_syntheticSyms</a> <a href="../../../collection/mutable/HashSet.scala.html#125963" title="(elem: Matrix.this.global.Symbol)MatrixContext.this._syntheticSyms.type">+=</a> <a href="#930702" title="Matrix.this.global.Symbol">sym</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#929673" title="=&gt; scala.collection.mutable.HashSet[Matrix.this.global.Symbol]">_syntheticSyms</a>.<a href="../../../collection/mutable/HashSet.scala.html#125961" title="=&gt; Int">size</a> <a href="../../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <span title="Int(25000)" class="int">25000</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#931498" title="=&gt; Matrix.this.global.CompilationUnit">cunit</a>.<a href="../CompilationUnits.scala.html#539298" title="(pos: Matrix.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#931501" title="=&gt; Matrix.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/StdAttachments.scala.html#409602" title="=&gt; Matrix.this.global.Position">pos</a>, <span title="String(&quot;Sanity check failed: over 25000 symbols created for pattern match.&quot;)" class="string">&quot;Sanity check failed: over 25000 symbols created for pattern match.&quot;</span><span class="delimiter">)</span>
        <a href="../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="String(&quot;This is a bug in the pattern matcher.&quot;)" class="string">&quot;This is a bug in the pattern matcher.&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#930702" title="Matrix.this.global.Symbol">sym</a>
    <span class="delimiter">}</span>

    case <span class="keyword">class</span> <a title="class MatrixInit extends AnyRef with Product with Serializable" id="931421">MatrixInit</a><a href="../../../Product.scala.html#186" title="Product" class="delimiter">(</a>
      <a title="List[MatrixContext.this.PatternVar]" id="929740">roots</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[MatrixContext.this.PatternVar]">List</a><span class="delimiter">[</span>PatternVar<span class="delimiter">]</span>,
      <a title="List[Matrix.this.global.CaseDef]" id="929741">cases</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Matrix.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span>,
      <a title="Matrix.this.global.Tree" id="929742">default</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Matrix.this.global.Tree">Tree</a>
    <span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="=&gt; List[Matrix.this.global.Symbol]" id="929707">tvars</a> = <a href="#929740" title="=&gt; List[MatrixContext.this.PatternVar]">roots</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: MatrixContext.this.PatternVar =&gt; Matrix.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatrixContext.this.PatternVar],Matrix.this.global.Symbol,List[Matrix.this.global.Symbol]])List[Matrix.this.global.Symbol]">map</a> <span class="delimiter">(</span><a href="#930744" title="MatrixContext.this.PatternVar">_</a>.<a href="#930966" title="=&gt; Matrix.this.global.Symbol">lhs</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="=&gt; List[Matrix.this.global.analyzer.global.ValDef]" id="929708">valDefs</a> = <a href="#929740" title="=&gt; List[MatrixContext.this.PatternVar]">roots</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: MatrixContext.this.PatternVar =&gt; Matrix.this.global.analyzer.global.ValDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatrixContext.this.PatternVar],Matrix.this.global.analyzer.global.ValDef,List[Matrix.this.global.analyzer.global.ValDef]])List[Matrix.this.global.analyzer.global.ValDef]">map</a> <span class="delimiter">(</span><a href="#929961" title="MatrixContext.this.PatternVar">_</a>.<a href="#929733" title="=&gt; Matrix.this.global.analyzer.global.ValDef">valDef</a><span class="delimiter">)</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="929709">toString</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;MatrixInit(roots = %s, %d cases)&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="MatchSupport.scala.html#928641" title="(x: Any)String">pp</a><span class="delimiter">(</span><a href="#929740" title="=&gt; List[MatrixContext.this.PatternVar]">roots</a><span class="delimiter">)</span>, <a href="#929741" title="=&gt; List[Matrix.this.global.CaseDef]">cases</a>.<a href="../../../collection/SeqLike.scala.html#58788" title="=&gt; Int">size</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.matching.Matrix.MatrixContext.pvlist2pvgroup : (xs: List[MatrixContext.this.PatternVar])MatrixContext.this.PatternVarGroup" id="929680">pvlist2pvgroup</a><span class="delimiter">(</span><a title="List[MatrixContext.this.PatternVar]" id="929975">xs</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[MatrixContext.this.PatternVar]">List</a><span class="delimiter">[</span>PatternVar<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#929685" title="MatrixContext.this.PatternVarGroup">PatternVarGroup</a> =
      <a href="#930618" title="(xs: List[MatrixContext.this.PatternVar])MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">(</span><a href="#929975" title="List[MatrixContext.this.PatternVar]">xs</a><span class="delimiter">)</span>

    <span class="keyword">object</span> <a title="MatrixContext.this.PatternVarGroup.type" id="929681">PatternVarGroup</a> <a href="#929682" title="MatrixContext.this.PatternVarGroup.type" class="delimiter">{</a>
      <span class="keyword">def</span> <a title="(xs: MatrixContext.this.PatternVar*)MatrixContext.this.PatternVarGroup" id="930617">apply</a><span class="delimiter">(</span><a title="MatrixContext.this.PatternVar*" id="930646">xs</a>: <span title="MatrixContext.this.PatternVar*">PatternVar</span>*<span class="delimiter">)</span> = <span title="MatrixContext.this.PatternVarGroup" class="keyword">new</span> <a href="#929685" title="MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">(</span><a href="#930646" title="MatrixContext.this.PatternVar*">xs</a>.<a href="../../../collection/TraversableOnce.scala.html#58263" title="=&gt; List[MatrixContext.this.PatternVar]">toList</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="(xs: List[MatrixContext.this.PatternVar])MatrixContext.this.PatternVarGroup" id="930618">apply</a><span class="delimiter">(</span><a title="List[MatrixContext.this.PatternVar]" id="930622">xs</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[MatrixContext.this.PatternVar]">List</a><span class="delimiter">[</span>PatternVar<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="MatrixContext.this.PatternVarGroup" class="keyword">new</span> <a href="#929685" title="MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">(</span><a href="#930622" title="List[MatrixContext.this.PatternVar]">xs</a><span class="delimiter">)</span>

      // XXX - transitional
      <span class="keyword">def</span> <a title="(vlist: List[Matrix.this.Binding], freeVars: List[Matrix.this.global.Symbol])MatrixContext.this.PatternVarGroup" id="930619">fromBindings</a><span class="delimiter">(</span><a title="List[Matrix.this.Binding]" id="930835">vlist</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Matrix.this.Binding]">List</a><span class="delimiter">[</span>Binding<span class="delimiter">]</span>, <a title="List[Matrix.this.global.Symbol]" id="930837">freeVars</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Matrix.this.global.Symbol]">List</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span> = <a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="(v: Matrix.this.global.Symbol)Option[Matrix.this.Binding]" id="930838">vmap</a><span class="delimiter">(</span><a title="Matrix.this.global.Symbol" id="930841">v</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Matrix.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../Option.scala.html#978" title="Option[Matrix.this.Binding]">Option</a><span class="delimiter">[</span>Binding<span class="delimiter">]</span> = <a href="#930835" title="List[Matrix.this.Binding]">vlist</a> <a href="../../../collection/LinearSeqOptimized.scala.html#86381" title="(p: Matrix.this.Binding =&gt; Boolean)Option[Matrix.this.Binding]">find</a> <span class="delimiter">(</span><a href="#930848" title="Matrix.this.Binding">_</a>.<a href="PatternBindings.scala.html#930851" title="=&gt; Matrix.this.global.Symbol">pvar</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#930841" title="Matrix.this.global.Symbol">v</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="List[Matrix.this.Binding]" id="930839">info</a> =
          <span title="List[Matrix.this.Binding]" class="keyword">if</span> <span class="delimiter">(</span><a href="#930837" title="List[Matrix.this.global.Symbol]">freeVars</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#930835" title="List[Matrix.this.Binding]">vlist</a>
          <span class="keyword">else</span> <span class="delimiter">(</span><a href="#930837" title="List[Matrix.this.global.Symbol]">freeVars</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: Matrix.this.global.Symbol =&gt; Option[Matrix.this.Binding])(implicit bf: scala.collection.generic.CanBuildFrom[List[Matrix.this.global.Symbol],Option[Matrix.this.Binding],List[Option[Matrix.this.Binding]]])List[Option[Matrix.this.Binding]]">map</a> <a href="#930838" title="(v: Matrix.this.global.Symbol)Option[Matrix.this.Binding]">vmap</a><span class="delimiter">)</span>.<a href="../../../collection/generic/GenericTraversableTemplate.scala.html#58488" title="(implicit asTraversable: Option[Matrix.this.Binding] =&gt; scala.collection.GenTraversableOnce[Matrix.this.Binding])List[Matrix.this.Binding]">flatten</a>

        <span class="keyword">val</span> <a title="List[MatrixContext.this.PatternVar]" id="930840">xs</a> =
          <span class="keyword">for</span> <span class="delimiter">(</span>Binding<span class="delimiter">(</span><a href="PatternBindings.scala.html#930851" title="Matrix.this.global.Symbol" id="930964">lhs</a>, <a href="PatternBindings.scala.html#930853" title="Matrix.this.global.Symbol" id="930965">rhs</a><span class="delimiter">)</span> &lt;- <a href="../../../collection/generic/FilterMonadic.scala.html#58161" title="(f: Matrix.this.Binding =&gt; MatrixContext.this.PatternVar)(implicit bf: scala.collection.generic.CanBuildFrom[List[Matrix.this.Binding],MatrixContext.this.PatternVar,List[MatrixContext.this.PatternVar]])List[MatrixContext.this.PatternVar]">info</a><span class="delimiter">)</span> <span class="keyword">yield</span>
            <a href="#3336512" title="(x: MatrixContext.this.PatternVar)MatrixContext.this.PatternVar" class="keyword">new</a> <a href="#929686" title="MatrixContext.this.PatternVar">PatternVar</a><span class="delimiter">(</span><a href="#930964" title="Matrix.this.global.Symbol">lhs</a>, <a href="../../../reflect/internal/Trees.scala.html#408127" title="(sym: Matrix.this.global.Symbol)Matrix.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#930965" title="Matrix.this.global.Symbol">rhs</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Trees.scala.html#408575" title="(tp: Matrix.this.global.Type)Matrix.this.global.Ident">setType</a> <a href="#930964" title="Matrix.this.global.Symbol">lhs</a>.<a href="../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; Matrix.this.global.Type">tpe</a>, <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="#930965" title="Matrix.this.global.Symbol">rhs</a> <a href="../../../reflect/internal/Symbols.scala.html#411234" title="(mask: Long)Boolean">hasFlag</a> <a href="#621980" title="=&gt; Long">NO_EXHAUSTIVE</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span title="MatrixContext.this.PatternVarGroup" class="keyword">new</span> <a href="#929685" title="MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">(</span><a href="#930840" title="List[MatrixContext.this.PatternVar]">xs</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="MatrixContext.this.PatternVarGroup" id="929683">emptyPatternVarGroup</a> = <a href="#930617" title="(xs: MatrixContext.this.PatternVar*)MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">class</span> <a title="class PatternVarGroup extends Object" id="929685">PatternVarGroup</a><a href="#929685" title="MatrixContext.this.PatternVarGroup" class="delimiter">(</a><span class="keyword">val</span> <a title="List[MatrixContext.this.PatternVar]" id="930645">pvs</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[MatrixContext.this.PatternVar]">List</a><span class="delimiter">[</span>PatternVar<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="=&gt; List[Matrix.this.global.Symbol]" id="930627">syms</a>    = <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: MatrixContext.this.PatternVar =&gt; Matrix.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatrixContext.this.PatternVar],Matrix.this.global.Symbol,List[Matrix.this.global.Symbol]])List[Matrix.this.global.Symbol]">map</a> <span class="delimiter">(</span><a href="#931031" title="MatrixContext.this.PatternVar">_</a>.<a href="#929729" title="=&gt; Matrix.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="=&gt; List[Matrix.this.global.analyzer.global.ValDef]" id="930628">valDefs</a> = <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: MatrixContext.this.PatternVar =&gt; Matrix.this.global.analyzer.global.ValDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatrixContext.this.PatternVar],Matrix.this.global.analyzer.global.ValDef,List[Matrix.this.global.analyzer.global.ValDef]])List[Matrix.this.global.analyzer.global.ValDef]">map</a> <span class="delimiter">(</span><a href="#931070" title="MatrixContext.this.PatternVar">_</a>.<a href="#929733" title="=&gt; Matrix.this.global.analyzer.global.ValDef">valDef</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="=&gt; List[Matrix.this.global.analyzer.global.Tree]" id="930629">idents</a>  = <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: MatrixContext.this.PatternVar =&gt; Matrix.this.global.analyzer.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatrixContext.this.PatternVar],Matrix.this.global.analyzer.global.Tree,List[Matrix.this.global.analyzer.global.Tree]])List[Matrix.this.global.analyzer.global.Tree]">map</a> <span class="delimiter">(</span><a href="#931110" title="MatrixContext.this.PatternVar">_</a>.<a href="#929731" title="=&gt; Matrix.this.global.analyzer.global.Tree">ident</a><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(index: Int)(MatrixContext.this.PatternVar, MatrixContext.this.PatternVarGroup)" id="930630">extractIndex</a><span class="delimiter">(</span><a title="Int" id="931139">index</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <a href="../../../Tuple2.scala.html#783" title="(MatrixContext.this.PatternVar, MatrixContext.this.PatternVarGroup)" class="delimiter">(</a>PatternVar, PatternVarGroup<span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a href="#3336518" title="(x: (MatrixContext.this.PatternVar, List[MatrixContext.this.PatternVar]))(MatrixContext.this.PatternVar, List[MatrixContext.this.PatternVar])" class="delimiter">(</a><a href="../../../Tuple2.scala.html#60635" title="MatrixContext.this.PatternVar" id="931141">t</a>, <a href="../../../Tuple2.scala.html#60637" title="List[MatrixContext.this.PatternVar]" id="931142">ts</a><span class="delimiter">)</span> = <a href="#41016" title="scala.tools.nsc.matching.&lt;refinement&gt;.type">self</a>.<a href="MatchSupport.scala.html#621959" title="(xs: List[MatrixContext.this.PatternVar], n: Int)(MatrixContext.this.PatternVar, List[MatrixContext.this.PatternVar])">extractIndex</a><a href="../../../Tuple2.scala.html#783" title="(MatrixContext.this.PatternVar, List[MatrixContext.this.PatternVar]) @unchecked" class="delimiter">(</a><a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a>, <a href="#931139" title="Int">index</a><span class="delimiter">)</span>
        <a href="../../../Tuple2.scala.html#62849" title="(_1: MatrixContext.this.PatternVar, _2: MatrixContext.this.PatternVarGroup)(MatrixContext.this.PatternVar, MatrixContext.this.PatternVarGroup)" class="delimiter">(</a><a href="#931141" title="MatrixContext.this.PatternVar">t</a>, <a href="#930618" title="(xs: List[MatrixContext.this.PatternVar])MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">(</span><a href="#931142" title="List[MatrixContext.this.PatternVar]">ts</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="=&gt; Boolean" id="930631">isEmpty</a> = <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a>
      <span class="keyword">def</span> <a title="=&gt; Int" id="930632">size</a> = <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a>.<a href="../../../collection/SeqLike.scala.html#58788" title="=&gt; Int">size</a>
      <span class="keyword">def</span> <a title="=&gt; MatrixContext.this.PatternVar" id="930633">head</a> = <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a>.<a href="../../../collection/IterableLike.scala.html#58577" title="=&gt; MatrixContext.this.PatternVar">head</a>
      <span class="keyword">def</span> <a title="(t: MatrixContext.this.PatternVar)MatrixContext.this.PatternVarGroup" id="930634">::</a><span class="delimiter">(</span><a title="MatrixContext.this.PatternVar" id="931177">t</a>: <a href="#929686" title="MatrixContext.this.PatternVar">PatternVar</a><span class="delimiter">)</span> = <a href="#930618" title="(xs: List[MatrixContext.this.PatternVar])MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">(</span><a href="#931177" title="MatrixContext.this.PatternVar">t</a> <a href="../../../collection/immutable/List.scala.html#62685" title="(x: MatrixContext.this.PatternVar)List[MatrixContext.this.PatternVar]">::</a> <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="(ts: List[MatrixContext.this.PatternVar])MatrixContext.this.PatternVarGroup" id="930635">:::</a><span class="delimiter">(</span><a title="List[MatrixContext.this.PatternVar]" id="931192">ts</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[MatrixContext.this.PatternVar]">List</a><span class="delimiter">[</span>PatternVar<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#930618" title="(xs: List[MatrixContext.this.PatternVar])MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">(</span><a href="#931192" title="List[MatrixContext.this.PatternVar]">ts</a> <a href="../../../collection/immutable/List.scala.html#62688" title="(prefix: List[MatrixContext.this.PatternVar])List[MatrixContext.this.PatternVar]">:::</a> <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="(other: MatrixContext.this.PatternVarGroup)MatrixContext.this.PatternVarGroup" id="930636">++</a><span class="delimiter">(</span><a title="MatrixContext.this.PatternVarGroup" id="931207">other</a>: <a href="#929685" title="MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">)</span> = <a href="#930618" title="(xs: List[MatrixContext.this.PatternVar])MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">(</span><a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a> <a href="../../../collection/immutable/List.scala.html#62688" title="(prefix: List[MatrixContext.this.PatternVar])List[MatrixContext.this.PatternVar]">:::</a> <a href="#931207" title="MatrixContext.this.PatternVarGroup">other</a>.<a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(i: Int)MatrixContext.this.PatternVar" id="930637">apply</a><span class="delimiter">(</span><a title="Int" id="931222">i</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> = <a href="../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)MatrixContext.this.PatternVar">pvs</a><span class="delimiter">(</span><a href="#931222" title="Int">i</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="=&gt; List[(MatrixContext.this.PatternVar, Int)]" id="930638">zipWithIndex</a> = <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a>.<a href="../../../collection/IterableLike.scala.html#58604" title="(implicit bf: scala.collection.generic.CanBuildFrom[List[MatrixContext.this.PatternVar],(MatrixContext.this.PatternVar, Int),List[(MatrixContext.this.PatternVar, Int)]])List[(MatrixContext.this.PatternVar, Int)]">zipWithIndex</a>
      <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Range" id="930639">indices</a> = <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a>.<a href="../../../collection/SeqLike.scala.html#58876" title="=&gt; scala.collection.immutable.Range">indices</a>
      <span class="keyword">def</span> <a title="[T](f: MatrixContext.this.PatternVar =&gt; T)List[T]" id="930640">map</a><span class="delimiter">[</span><a title="" id="930642">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="MatrixContext.this.PatternVar =&gt; T" id="931267">f</a>: PatternVar =&gt; T<span class="delimiter">)</span> = <a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: MatrixContext.this.PatternVar =&gt; T)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatrixContext.this.PatternVar],T,List[T]])List[T]">map</a> <a href="#931267" title="MatrixContext.this.PatternVar =&gt; T">f</a>
      <span class="keyword">def</span> <a title="(p: MatrixContext.this.PatternVar =&gt; Boolean)MatrixContext.this.PatternVarGroup" id="930643">filter</a><span class="delimiter">(</span><a title="MatrixContext.this.PatternVar =&gt; Boolean" id="931306">p</a>: PatternVar =&gt; Boolean<span class="delimiter">)</span> = <a href="#930618" title="(xs: List[MatrixContext.this.PatternVar])MatrixContext.this.PatternVarGroup">PatternVarGroup</a><span class="delimiter">(</span><a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a> <a href="../../../collection/TraversableLike.scala.html#58073" title="(p: MatrixContext.this.PatternVar =&gt; Boolean)List[MatrixContext.this.PatternVar]">filter</a> <a href="#931306" title="MatrixContext.this.PatternVar =&gt; Boolean">p</a><span class="delimiter">)</span>

      <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="930644">toString</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="MatchSupport.scala.html#928641" title="(x: Any)String">pp</a><span class="delimiter">(</span><a href="#930645" title="=&gt; List[MatrixContext.this.PatternVar]">pvs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    /** Every temporary variable allocated is put in a PatternVar.
     */
    <span class="keyword">class</span> <a title="class PatternVar extends Object" id="929686">PatternVar</a><a href="#929686" title="MatrixContext.this.PatternVar" class="delimiter">(</a><span class="keyword">val</span> <a title="Matrix.this.global.Symbol" id="930966">lhs</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Matrix.this.global.Symbol">Symbol</a>, <span class="keyword">val</span> <a title="Matrix.this.global.Tree" id="930967">rhs</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Matrix.this.global.Tree">Tree</a>, <span class="keyword">val</span> <a title="Boolean" id="930968">checked</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="=&gt; Matrix.this.global.Symbol" id="929729">sym</a> = <a href="#930966" title="=&gt; Matrix.this.global.Symbol">lhs</a>
      <span class="keyword">def</span> <a title="=&gt; Matrix.this.global.Type" id="929730">tpe</a> = <a href="#930966" title="=&gt; Matrix.this.global.Symbol">lhs</a>.<a href="../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; Matrix.this.global.Type">tpe</a>
      <span title="PatternVar.this.lhs.type" class="keyword">if</span> <span class="delimiter">(</span><a href="#930968" title="=&gt; Boolean">checked</a><span class="delimiter">)</span>
        <a href="#930966" title="=&gt; Matrix.this.global.Symbol">lhs</a> <a href="../../../reflect/internal/Symbols.scala.html#411237" title="(mask: Long)PatternVar.this.lhs.type">resetFlag</a> <a href="#621980" title="=&gt; Long">NO_EXHAUSTIVE</a>
      <span class="keyword">else</span>
        <a href="#930966" title="=&gt; Matrix.this.global.Symbol">lhs</a> <a href="../../../reflect/internal/Symbols.scala.html#411236" title="(mask: Long)PatternVar.this.lhs.type">setFlag</a> <a href="#621980" title="=&gt; Long">NO_EXHAUSTIVE</a>

      // See #1427 for an example of a crash which occurs unless we retype:
      // in that instance there is an existential in the pattern.
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Matrix.this.global.analyzer.global.Tree" id="929732">ident</a>  = <a href="#931500" title="=&gt; Matrix.this.global.analyzer.Typer">typer</a> <a href="../typechecker/Typers.scala.html#538701" title="(tree: Matrix.this.global.analyzer.global.Tree)Matrix.this.global.analyzer.global.Tree">typed</a> <a href="../../../reflect/internal/Trees.scala.html#408127" title="(sym: Matrix.this.global.Symbol)Matrix.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#930966" title="=&gt; Matrix.this.global.Symbol">lhs</a><span class="delimiter">)</span>
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Matrix.this.global.analyzer.global.ValDef" id="929734">valDef</a> = <a href="#931500" title="=&gt; Matrix.this.global.analyzer.Typer">typer</a> <a href="../typechecker/Typers.scala.html#538637" title="(vdef: Matrix.this.global.analyzer.global.ValDef)Matrix.this.global.analyzer.global.ValDef">typedValDef</a> <a href="../../../reflect/internal/Trees.scala.html#408102" title="(sym: Matrix.this.global.Symbol, rhs: Matrix.this.global.Tree)Matrix.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#930966" title="=&gt; Matrix.this.global.Symbol">lhs</a>, <a href="#930967" title="=&gt; Matrix.this.global.Tree">rhs</a><span class="delimiter">)</span>

      <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="929735">toString</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s: %s = %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#930966" title="=&gt; Matrix.this.global.Symbol">lhs</a>, <a href="#929730" title="=&gt; Matrix.this.global.Type">tpe</a>, <a href="#930967" title="=&gt; Matrix.this.global.Tree">rhs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    /** Given a tree, creates a new synthetic variable of the same type
     *  and assigns the tree to it.
     */
    <span class="keyword">def</span> <a title="(root: Matrix.this.global.Tree, checked: Boolean, _tpe: Matrix.this.global.Type, label: String)MatrixContext.this.PatternVar" id="929687">copyVar</a><span class="delimiter">(</span>
      <a title="Matrix.this.global.Tree" id="929712">root</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="Matrix.this.global.Tree">Tree</a>,
      <a title="Boolean" id="929713">checked</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a>,
      <a title="Matrix.this.global.Type" id="929717">_tpe</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="Matrix.this.global.Type">Type</a> = <span title="Null(null)" class="keyword">null</span>,
      <a title="String" id="929718">label</a>: <span title="String">String</span> = <span title="String(&quot;temp&quot;)" class="string">&quot;temp&quot;</span><span class="delimiter">)</span>: <a href="#929686" title="MatrixContext.this.PatternVar">PatternVar</a> =
    <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Matrix.this.global.Type" id="931330">tpe</a>   = <a href="#929669" title="(x: Matrix.this.global.Type, alt: Matrix.this.global.Type)Matrix.this.global.Type">ifNull</a><span class="delimiter">(</span><a href="#929717" title="Matrix.this.global.Type">_tpe</a>, <a href="#929712" title="Matrix.this.global.Tree">root</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; Matrix.this.global.Type">tpe</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Matrix.this.global.TermName" id="931331">name</a>  = <a href="#931498" title="=&gt; Matrix.this.global.CompilationUnit">cunit</a>.<a href="../CompilationUnits.scala.html#539276" title="(prefix: String)Matrix.this.global.TermName">freshTermName</a><span class="delimiter">(</span><a href="#929718" title="String">label</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Matrix.this.global.Symbol" id="931332">sym</a>   = <a href="#929690" title="(pos: Matrix.this.global.Position, tpe: Matrix.this.global.Type, flags: List[Long], name: Matrix.this.global.TermName)Matrix.this.global.Symbol">newVar</a><span class="delimiter">(</span><a href="#929712" title="Matrix.this.global.Tree">root</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; Matrix.this.global.Position">pos</a>, <a href="#931330" title="Matrix.this.global.Type">tpe</a>, <a href="#929672" title="(checked: Boolean)List[Long]">flags</a><span class="delimiter">(</span><a href="#929713" title="Boolean">checked</a><span class="delimiter">)</span>, <a href="#931331" title="Matrix.this.global.TermName">name</a><span class="delimiter">)</span>

      <a href="MatchSupport.scala.html#928645" title="(s: String)(x: MatrixContext.this.PatternVar)MatrixContext.this.PatternVar">tracing</a><span class="delimiter">(</span><span title="String(&quot;copy&quot;)" class="string">&quot;copy&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><span title="MatrixContext.this.PatternVar" class="keyword">new</span> <a href="#929686" title="MatrixContext.this.PatternVar">PatternVar</a><span class="delimiter">(</span><a href="#931332" title="Matrix.this.global.Symbol">sym</a>, <a href="#929712" title="Matrix.this.global.Tree">root</a>, <a href="#929713" title="Boolean">checked</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    /** Creates a new synthetic variable of the specified type and
     *  assigns the result of f(symbol) to it.
     */
    <span class="keyword">def</span> <a title="(tpe: Matrix.this.global.Type, f: Matrix.this.global.Symbol =&gt; Matrix.this.global.Tree, checked: Boolean)MatrixContext.this.PatternVar" id="929688">createVar</a><span class="delimiter">(</span><a title="Matrix.this.global.Type" id="931351">tpe</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="Matrix.this.global.Type">Type</a>, <a title="Matrix.this.global.Symbol =&gt; Matrix.this.global.Tree" id="931352">f</a>: Symbol =&gt; Tree, <a title="Boolean" id="931353">checked</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Matrix.this.global.Symbol" id="931356">lhs</a> = <a href="#929690" title="(pos: Matrix.this.global.Position, tpe: Matrix.this.global.Type, flags: List[Long], name: Matrix.this.global.TermName)Matrix.this.global.Symbol">newVar</a><span class="delimiter">(</span><a href="#931501" title="=&gt; Matrix.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/StdAttachments.scala.html#409602" title="=&gt; Matrix.this.global.Position">pos</a>, <a href="#931351" title="Matrix.this.global.Type">tpe</a>, <a href="#929672" title="(checked: Boolean)List[Long]">flags</a><span class="delimiter">(</span><a href="#931353" title="Boolean">checked</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Matrix.this.global.Tree" id="931357">rhs</a> = <a href="../../../Function1.scala.html#58642" title="(v1: Matrix.this.global.Symbol)Matrix.this.global.Tree">f</a><span class="delimiter">(</span><a href="#931356" title="Matrix.this.global.Symbol">lhs</a><span class="delimiter">)</span>

      <a href="MatchSupport.scala.html#928645" title="(s: String)(x: MatrixContext.this.PatternVar)MatrixContext.this.PatternVar">tracing</a><span class="delimiter">(</span><span title="String(&quot;create&quot;)" class="string">&quot;create&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><span title="MatrixContext.this.PatternVar" class="keyword">new</span> <a href="#929686" title="MatrixContext.this.PatternVar">PatternVar</a><span class="delimiter">(</span><a href="#931356" title="Matrix.this.global.Symbol">lhs</a>, <a href="#931357" title="Matrix.this.global.Tree">rhs</a>, <a href="#931353" title="Boolean">checked</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(tpe: Matrix.this.global.Type, f: Matrix.this.global.Symbol =&gt; Matrix.this.global.Tree, checked: Boolean)MatrixContext.this.PatternVar" id="929689">createLazy</a><span class="delimiter">(</span><a title="Matrix.this.global.Type" id="931367">tpe</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="Matrix.this.global.Type">Type</a>, <a title="Matrix.this.global.Symbol =&gt; Matrix.this.global.Tree" id="931368">f</a>: Symbol =&gt; Tree, <a title="Boolean" id="931369">checked</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Matrix.this.global.Symbol" id="931372">lhs</a> = <a href="#929690" title="(pos: Matrix.this.global.Position, tpe: Matrix.this.global.Type, flags: List[Long], name: Matrix.this.global.TermName)Matrix.this.global.Symbol">newVar</a><span class="delimiter">(</span><a href="#931501" title="=&gt; Matrix.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/StdAttachments.scala.html#409602" title="=&gt; Matrix.this.global.Position">pos</a>, <a href="#931367" title="Matrix.this.global.Type">tpe</a>, Flags.<span title="Long(2147483648L)">LAZY</span> <a href="../../../collection/immutable/List.scala.html#62685" title="(x: Long)List[Long]">::</a> <a href="#929672" title="(checked: Boolean)List[Long]">flags</a><span class="delimiter">(</span><a href="#931369" title="Boolean">checked</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Matrix.this.global.Tree" id="931373">rhs</a> = <a href="../../../Function1.scala.html#58642" title="(v1: Matrix.this.global.Symbol)Matrix.this.global.Tree">f</a><span class="delimiter">(</span><a href="#931372" title="Matrix.this.global.Symbol">lhs</a><span class="delimiter">)</span>

      <a href="MatchSupport.scala.html#928645" title="(s: String)(x: MatrixContext.this.PatternVar)MatrixContext.this.PatternVar">tracing</a><span class="delimiter">(</span><span title="String(&quot;createLazy&quot;)" class="string">&quot;createLazy&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><span title="MatrixContext.this.PatternVar" class="keyword">new</span> <a href="#929686" title="MatrixContext.this.PatternVar">PatternVar</a><span class="delimiter">(</span><a href="#931372" title="Matrix.this.global.Symbol">lhs</a>, <a href="#931373" title="Matrix.this.global.Tree">rhs</a>, <a href="#931369" title="Boolean">checked</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: Matrix.this.global.Position, tpe: Matrix.this.global.Type, flags: List[Long], name: Matrix.this.global.TermName)Matrix.this.global.Symbol" id="929690">newVar</a><span class="delimiter">(</span>
      <a title="Matrix.this.global.Position" id="931338">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="Matrix.this.global.Position">Position</a>,
      <a title="Matrix.this.global.Type" id="931339">tpe</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="Matrix.this.global.Type">Type</a>,
      <a title="List[Long]" id="931343">flags</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Long]">List</a><span class="delimiter">[</span>Long<span class="delimiter">]</span> = <a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>,
      <a title="Matrix.this.global.TermName" id="931344">name</a>: <a href="../../../reflect/internal/Names.scala.html#406879" title="Matrix.this.global.TermName">TermName</a> = <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="Matrix.this.global.Symbol">Symbol</a> =
    <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Matrix.this.global.TermName" id="931387">n</a> = <span title="Matrix.this.global.TermName" class="keyword">if</span> <span class="delimiter">(</span><a href="#931344" title="Matrix.this.global.TermName">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#931498" title="=&gt; Matrix.this.global.CompilationUnit">cunit</a>.<a href="../CompilationUnits.scala.html#539276" title="(prefix: String)Matrix.this.global.TermName">freshTermName</a><span class="delimiter">(</span><span title="String(&quot;temp&quot;)" class="string">&quot;temp&quot;</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#931344" title="Matrix.this.global.TermName">name</a>
      // careful: pos has special meaning
      <span class="keyword">val</span> <a title="Long" id="931388">flagsLong</a> = <span class="delimiter">(</span><span title="Int(2097152)">SYNTHETIC</span>.<a href="../../../Int.scala.html#57081" title="=&gt; Long">toLong</a> <a href="../../../collection/TraversableOnce.scala.html#58196" title="(z: Long)(op: (Long, Long) =&gt; Long)Long">/:</a> <a href="#931343" title="List[Long]">flags</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#931406" title="Long">_</a><a href="../../../Long.scala.html#57506" title="(x: Long)Long">|</a><a href="#931407" title="Long">_</a><span class="delimiter">)</span>
      <a href="#929676" title="(sym: Matrix.this.global.Symbol)Matrix.this.global.Symbol">recordSyntheticSym</a><span class="delimiter">(</span><a href="#931501" title="=&gt; Matrix.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#411110" title="(name: Matrix.this.global.TermName, pos: Matrix.this.global.Position, newFlags: Long)Matrix.this.global.TermSymbol">newVariable</a><span class="delimiter">(</span><a href="#931387" title="Matrix.this.global.TermName">n</a>, <a href="#931338" title="Matrix.this.global.Position">pos</a>, <a href="#931388" title="Long">flagsLong</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Symbols.scala.html#411369" title="(info: Matrix.this.global.Type)Matrix.this.global.TermSymbol">setInfo</a> <a href="#931339" title="Matrix.this.global.Type">tpe</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
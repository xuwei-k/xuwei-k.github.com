<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/transform/TailCalls.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new scala compiler
 * Copyright 2005-2013 LAMP/EPFL
 * @author Iulian Dragos
 */

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> transform

<span class="keyword">import</span> symtab.Flags
<span class="keyword">import</span> <a href="../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.SYNTHETIC

/** Perform tail recursive call elimination.
 *
 *  @author Iulian Dragos
 *  @version 1.0
 */
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class TailCalls extends scala.tools.nsc.SubComponent with scala.tools.nsc.transform.Transform" id="42861">TailCalls</a> <a href="#42861" title="scala.tools.nsc.transform.TailCalls" class="keyword">extends</a> <a href="Transform.scala.html#43152" title="scala.tools.nsc.transform.Transform">Transform</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="../SubComponent.scala.html#620039" title="=&gt; scala.tools.nsc.Global">global</a>._                     // the global environment
  <span class="keyword">import</span> <a href="../../../reflect/internal/Definitions.scala.html#407777" title="TailCalls.this.global.definitions.type">definitions</a>._                // standard classes and methods
  <span class="keyword">import</span> <a href="../Global.scala.html#537612" title="TailCalls.this.global.typer.type">typer</a>.<span class="delimiter">{</span> typed, typedPos <span class="delimiter">}</span>    // methods to type trees

  <span class="keyword">val</span> <a title="String" id="621742">phaseName</a>: <span title="String">String</span> = <span title="String(&quot;tailcalls&quot;)" class="string">&quot;tailcalls&quot;</span>

  <span class="keyword">def</span> <a title="(unit: TailCalls.this.global.CompilationUnit)TailCalls.this.global.Transformer" id="621744">newTransformer</a><span class="delimiter">(</span><a title="TailCalls.this.global.CompilationUnit" id="1010330">unit</a>: <a href="../CompilationUnits.scala.html#537766" title="TailCalls.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span>: <a href="../ast/Trees.scala.html#537817" title="TailCalls.this.global.Transformer">Transformer</a> =
    <span title="TailCalls.this.TailCallElimination" class="keyword">new</span> <a href="#621748" title="TailCalls.this.TailCallElimination">TailCallElimination</a><span class="delimiter">(</span><a href="#1010330" title="TailCalls.this.global.CompilationUnit">unit</a><span class="delimiter">)</span>

  /** Create a new phase which applies transformer */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(prev: tools.nsc.Phase)TailCalls.this.StdPhase" id="621745">newPhase</a><span class="delimiter">(</span><a title="tools.nsc.Phase" id="624623">prev</a>: scala.tools.nsc.<a href="../../../reflect/internal/Phase.scala.html#19756" title="tools.nsc.Phase">Phase</a><span class="delimiter">)</span>: <a href="../SubComponent.scala.html#620064" title="TailCalls.this.StdPhase">StdPhase</a> = <span title="TailCalls.this.Phase" class="keyword">new</span> <a href="#621746" title="TailCalls.this.Phase">Phase</a><span class="delimiter">(</span><a href="#624623" title="tools.nsc.Phase">prev</a><span class="delimiter">)</span>

  /** The phase defined by this transform */
  <span class="keyword">class</span> <a title="class Phase extends TailCalls.this.StdPhase" id="621746">Phase</a><a href="#621746" title="TailCalls.this.Phase" class="delimiter">(</a><a title="tools.nsc.Phase" id="1010354">prev</a>: scala.tools.nsc.<a href="../../../reflect/internal/Phase.scala.html#19756" title="tools.nsc.Phase">Phase</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../SubComponent.scala.html#620064" title="TailCalls.this.StdPhase">StdPhase</a><span class="delimiter">(</span><a href="#1010354" title="tools.nsc.Phase">prev</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(unit: TailCalls.this.global.CompilationUnit)Unit" id="1010353">apply</a><span class="delimiter">(</span><a title="TailCalls.this.global.CompilationUnit" id="1010357">unit</a>: global.<a href="../CompilationUnits.scala.html#537766" title="TailCalls.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#540032" title="=&gt; scala.tools.nsc.Settings#ChoiceSetting">debuginfo</a>.<a href="../../../reflect/internal/settings/MutableSettings.scala.html#423752" title="=&gt; String">value</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;notailcalls&quot;)" class="string">&quot;notailcalls&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#621744" title="(unit: TailCalls.this.global.CompilationUnit)TailCalls.this.global.Transformer">newTransformer</a><span class="delimiter">(</span><a href="#1010357" title="TailCalls.this.global.CompilationUnit">unit</a><span class="delimiter">)</span>.<a href="../ast/Trees.scala.html#542655" title="(unit: TailCalls.this.global.CompilationUnit)Unit">transformUnit</a><span class="delimiter">(</span><a href="#1010357" title="TailCalls.this.global.CompilationUnit">unit</a><span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">import</span> <a href="../ast/Trees.scala.html#537807" title="TailCalls.this.global.treeInfo.type">treeInfo</a>.hasSynthCaseSymbol

  /**
   * A Tail Call Transformer
   *
   * @author     Erik Stenman, Iulian Dragos
   * @version    1.1
   *
   * What it does:
   * &lt;p&gt;
   *   Finds method calls in tail-position and replaces them with jumps.
   *   A call is in a tail-position if it is the last instruction to be
   *   executed in the body of a method.  This is done by recursing over
   *   the trees that may contain calls in tail-position (trees that can't
   *   contain such calls are not transformed). However, they are not that
   *   many.
   * &lt;/p&gt;
   * &lt;p&gt;
   *   Self-recursive calls in tail-position are replaced by jumps to a
   *   label at the beginning of the method. As the JVM provides no way to
   *   jump from a method to another one, non-recursive calls in
   *   tail-position are not optimized.
   * &lt;/p&gt;
   * &lt;p&gt;
   *   A method call is self-recursive if it calls the current method and
   *   the method is final (otherwise, it could
   *   be a call to an overridden method in a subclass). Furthermore, If
   *   the method has type parameters, the call must contain these
   *   parameters as type arguments. Recursive calls on a different instance
   *   are optimized. Since 'this' is not a local variable, a dummy local val
   *   is added and used as a label parameter. The backend knows to load
   *   the corresponding argument in the 'this' (local at index 0). This dummy local
   *   is never used and should be cleand up by dead code elimination (when enabled).
   * &lt;/p&gt;
   * &lt;p&gt;
   *   This phase has been moved before pattern matching to catch more
   *   of the common cases of tail recursive functions. This means that
   *   more cases should be taken into account (like nested function, and
   *   pattern cases).
   * &lt;/p&gt;
   * &lt;p&gt;
   *   If a method contains self-recursive calls, a label is added to at
   *   the beginning of its body and the calls are replaced by jumps to
   *   that label.
   * &lt;/p&gt;
   * &lt;p&gt;
   *   Assumes: &lt;code&gt;Uncurry&lt;/code&gt; has been run already, and no multiple
   *            parameter lists exit.
   * &lt;/p&gt;
   */
  <span class="keyword">class</span> <a title="class TailCallElimination extends TailCalls.this.global.Transformer" id="621748">TailCallElimination</a><a href="#621748" title="TailCalls.this.TailCallElimination" class="delimiter">(</a><a title="TailCalls.this.global.CompilationUnit" id="1010349">unit</a>: <a href="../CompilationUnits.scala.html#537766" title="TailCalls.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../ast/Trees.scala.html#537817" title="TailCalls.this.global.Transformer">Transformer</a> <span class="delimiter">{</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="String" id="1010336">defaultReason</a> = <span title="String(&quot;it contains a recursive call not in tail position&quot;)" class="string">&quot;it contains a recursive call not in tail position&quot;</span>

    /** Has the label been accessed? Then its symbol is in this set. */
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[TailCalls.this.global.Symbol]" id="1010338">accessed</a> = <a href="../../../collection/mutable/HashSet.scala.html#125959" title="()scala.collection.mutable.HashSet[TailCalls.this.global.Symbol]" class="keyword">new</a> scala.collection.mutable.<a href="../../../collection/mutable/HashSet.scala.html#13053" title="scala.collection.mutable.HashSet[TailCalls.this.global.Symbol]">HashSet</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    // `accessed` was stored as boolean in the current context -- this is no longer tenable
    // with jumps to labels in tailpositions now considered in tailposition,
    // a downstream context may access the label, and the upstream one will be none the wiser
    // this is necessary because tail-calls may occur in places where syntactically they seem impossible
    // (since we now consider jumps to labels that are in tailposition, such as matchEnd(x) {x})


    <span class="keyword">class</span> <a title="class Context extends Object" id="1010340">Context</a><a href="#1010340" title="TailCallElimination.this.Context" class="delimiter">(</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      /** The current method */
      <span class="keyword">var</span> <a title="TailCalls.this.global.Symbol" id="1010374">method</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="TailCalls.this.global.Symbol">Symbol</a> = <a href="../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; TailCalls.this.global.NoSymbol">NoSymbol</a>

      // symbols of label defs in this method that are in tail position
      <span class="keyword">var</span> <a title="Set[TailCalls.this.global.Symbol]" id="1010377">tailLabels</a>: <a href="../../../collection/immutable/Set.scala.html#11919" title="Set[TailCalls.this.global.Symbol]">Set</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span> = <a href="../../../collection/generic/GenericCompanion.scala.html#59933" title="(elems: TailCalls.this.global.Symbol*)scala.collection.immutable.Set[TailCalls.this.global.Symbol]">Set</a><span class="delimiter">(</span><span class="delimiter">)</span>

      /** The current tail-call label */
      <span class="keyword">var</span> <a title="TailCalls.this.global.Symbol" id="1010380">label</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="TailCalls.this.global.Symbol">Symbol</a> = <a href="../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; TailCalls.this.global.NoSymbol">NoSymbol</a>

      /** The expected type arguments of self-recursive calls */
      <span class="keyword">var</span> <a title="List[TailCalls.this.global.Symbol]" id="1010383">tparams</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[TailCalls.this.global.Symbol]">List</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span> = <a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>

      /** Tells whether we are in a (possible) tail position */
      <span class="keyword">var</span> <a title="Boolean" id="1010386">tailPos</a> = <span title="Boolean(false)" class="keyword">false</span>

      /** The reason this method could not be optimized. */
      <span class="keyword">var</span> <a title="String" id="1010389">failReason</a> = <a href="#1010336" title="=&gt; String">defaultReason</a>
      <span class="keyword">var</span> <a title="TailCalls.this.global.Position" id="1010392">failPos</a>    = <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/StdAttachments.scala.html#409602" title="=&gt; TailCalls.this.global.Position">pos</a>

      <span class="keyword">def</span> <a title="(that: TailCallElimination.this.Context)TailCallElimination.this.Context" id="1010394" class="keyword">this</a><span class="delimiter">(</span><a title="TailCallElimination.this.Context" id="1010419">that</a>: <a href="#1010340" title="TailCallElimination.this.Context">Context</a><span class="delimiter">)</span> = <span title="Unit" class="delimiter">{</span>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010374" title="(x$1: TailCalls.this.global.Symbol)Unit">method</a>   = <a href="#1010419" title="TailCallElimination.this.Context">that</a>.<a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010383" title="(x$1: List[TailCalls.this.global.Symbol])Unit">tparams</a>  = <a href="#1010419" title="TailCallElimination.this.Context">that</a>.<a href="#1010383" title="=&gt; List[TailCalls.this.global.Symbol]">tparams</a>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010386" title="(x$1: Boolean)Unit">tailPos</a>  = <a href="#1010419" title="TailCallElimination.this.Context">that</a>.<a href="#1010386" title="=&gt; Boolean">tailPos</a>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010392" title="(x$1: TailCalls.this.global.Position)Unit">failPos</a>  = <a href="#1010419" title="TailCallElimination.this.Context">that</a>.<a href="#1010392" title="=&gt; TailCalls.this.global.Position">failPos</a>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010380" title="(x$1: TailCalls.this.global.Symbol)Unit">label</a>    = <a href="#1010419" title="TailCallElimination.this.Context">that</a>.<a href="#1010380" title="=&gt; TailCalls.this.global.Symbol">label</a>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010377" title="(x$1: Set[TailCalls.this.global.Symbol])Unit">tailLabels</a> = <a href="#1010419" title="TailCallElimination.this.Context">that</a>.<a href="#1010377" title="=&gt; Set[TailCalls.this.global.Symbol]">tailLabels</a>
      <span class="delimiter">}</span>
      <span class="keyword">def</span> <a title="(dd: TailCalls.this.global.DefDef)TailCallElimination.this.Context" id="1010395" class="keyword">this</a><span class="delimiter">(</span><a title="TailCalls.this.global.DefDef" id="1010426">dd</a>: <a href="../../../reflect/internal/Trees.scala.html#407963" title="TailCalls.this.global.DefDef">DefDef</a><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010374" title="(x$1: TailCalls.this.global.Symbol)Unit">method</a>   = <a href="#1010426" title="TailCalls.this.global.DefDef">dd</a>.<a href="../../../reflect/internal/Trees.scala.html#409939" title="=&gt; TailCalls.this.global.Symbol">symbol</a>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010383" title="(x$1: List[TailCalls.this.global.Symbol])Unit">tparams</a>  = <a href="#1010426" title="TailCalls.this.global.DefDef">dd</a>.<a href="../../../reflect/internal/Trees.scala.html#410282" title="=&gt; List[TailCalls.this.global.TypeDef]">tparams</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: TailCalls.this.global.TypeDef =&gt; TailCalls.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[TailCalls.this.global.TypeDef],TailCalls.this.global.Symbol,List[TailCalls.this.global.Symbol]])List[TailCalls.this.global.Symbol]">map</a> <span class="delimiter">(</span><a href="#1010461" title="TailCalls.this.global.TypeDef">_</a>.<a href="../../../reflect/internal/Trees.scala.html#409939" title="=&gt; TailCalls.this.global.Symbol">symbol</a><span class="delimiter">)</span>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010386" title="(x$1: Boolean)Unit">tailPos</a>  = <span title="Boolean(true)" class="keyword">true</span>
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010392" title="(x$1: TailCalls.this.global.Position)Unit">failPos</a>  = <a href="#1010426" title="TailCalls.this.global.DefDef">dd</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; TailCalls.this.global.Position">pos</a>

        /** Create a new method symbol for the current method and store it in
          * the label field.
          */
        <a href="#1010340" title="Context.this.type" class="keyword">this</a>.<a href="#1010380" title="(x$1: TailCalls.this.global.Symbol)Unit">label</a>    = <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="TailCalls.this.global.MethodSymbol" id="1010495">label</a>     = <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411115" title="(name: TailCalls.this.global.TermName, pos: TailCalls.this.global.Position)TailCalls.this.global.MethodSymbol">newLabel</a><span class="delimiter">(</span><a href="../../../reflect/internal/Names.scala.html#406859" title="(s: String)TailCalls.this.global.TermName">newTermName</a><span class="delimiter">(</span><span title="String(&quot;_&quot;)" class="string">&quot;_&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; TailCalls.this.global.Symbol#NameType">name</a><span class="delimiter">)</span>, <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/StdAttachments.scala.html#409602" title="=&gt; TailCalls.this.global.Position">pos</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="TailCalls.this.global.TermSymbol" id="1010496">thisParam</a> = <a href="#1010374" title="TailCalls.this.global.Symbol" id="1010515">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#472716" title="TailCalls.this.global.TermName" id="1010519">newSyntheticValueParam</a><span class="delimiter">(</span><a href="../../../reflect/api/Trees.scala.html#405651" title="=&gt; TailCalls.this.global.Symbol">currentClass</a>.<a href="../../../reflect/internal/Symbols.scala.html#411426" title="TailCalls.this.global.Type" id="1010518">typeOfThis</a><span class="delimiter">)</span>
          <a href="#1010495" title="TailCalls.this.global.MethodSymbol">label</a> <a href="../../../reflect/internal/Symbols.scala.html#411369" title="(info: TailCalls.this.global.Type)label.type">setInfo</a> <a href="../../../reflect/internal/Types.scala.html#420479" title="(params: List[TailCalls.this.global.Symbol], resultType: TailCalls.this.global.Type)TailCalls.this.global.MethodType">MethodType</a><span class="delimiter">(</span><a href="#1010496" title="TailCalls.this.global.TermSymbol">thisParam</a> <a href="../../../collection/immutable/List.scala.html#62685" title="(x: TailCalls.this.global.Symbol)List[TailCalls.this.global.Symbol]">::</a> <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; TailCalls.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#408430" title="=&gt; List[TailCalls.this.global.Symbol]">params</a>, <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; TailCalls.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#408427" title="=&gt; TailCalls.this.global.Type">finalResultType</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#1010398" title="=&gt; Boolean">isEligible</a><span class="delimiter">)</span>
          <a href="#1010380" title="=&gt; TailCalls.this.global.Symbol">label</a> <a href="../../../reflect/internal/Symbols.scala.html#411371" title="(syms0: List[TailCalls.this.global.Symbol], syms1: List[TailCalls.this.global.Symbol])TailCalls.this.global.Symbol">substInfo</a> <span class="delimiter">(</span><a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; TailCalls.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#408432" title="=&gt; List[TailCalls.this.global.Symbol]">typeParams</a>, <a href="#1010383" title="=&gt; List[TailCalls.this.global.Symbol]">tparams</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="=&gt; TailCalls.this.global.Type" id="1010396">enclosingType</a>    = <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411422" title="=&gt; TailCalls.this.global.Symbol">enclClass</a>.<a href="../../../reflect/internal/Symbols.scala.html#411426" title="=&gt; TailCalls.this.global.Type">typeOfThis</a>
      <span class="keyword">def</span> <a title="=&gt; List[TailCalls.this.global.Symbol]" id="1010397">methodTypeParams</a> = <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; TailCalls.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#408432" title="=&gt; List[TailCalls.this.global.Symbol]">typeParams</a>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="1010398">isEligible</a>       = <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411298" title="=&gt; Boolean">isEffectivelyFinal</a>
      // @tailrec annotation indicates mandatory transformation
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="1010399">isMandatory</a>      = <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/AnnotationInfos.scala.html#408615" title="(cls: TailCalls.this.global.Symbol)Boolean">hasAnnotation</a><span class="delimiter">(</span><a href="../../../reflect/internal/Definitions.scala.html#409167" title="=&gt; TailCalls.this.global.ClassSymbol">TailrecClass</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="../Global.scala.html#537757" title="=&gt; Boolean">forMSIL</a>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="1010400">isTransformed</a>    = <a href="#1010398" title="=&gt; Boolean">isEligible</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../collection/GenSetLike.scala.html#66403" title="(elem: TailCalls.this.global.Symbol)Boolean">accessed</a><span class="delimiter">(</span><a href="#1010380" title="=&gt; TailCalls.this.global.Symbol">label</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="()Unit" id="1010401">tailrecFailure</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#1010349" title="TailCalls.this.global.CompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539298" title="(pos: TailCalls.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1010392" title="=&gt; TailCalls.this.global.Position">failPos</a>, <span title="String(&quot;could not optimize @tailrec annotated &quot;)" class="string">&quot;could not optimize @tailrec annotated &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010389" title="=&gt; String">failReason</a><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(pos: TailCalls.this.global.Position)TailCalls.this.global.TermSymbol" id="1010402">newThis</a><span class="delimiter">(</span><a title="TailCalls.this.global.Position" id="1010561">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#22953" title="TailCalls.this.global.Position">Position</a><span class="delimiter">)</span> = <a href="../../../reflect/internal/SymbolTable.scala.html#406629" title="(msg: =&gt; String)(result: TailCalls.this.global.TermSymbol)TailCalls.this.global.TermSymbol">logResult</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Creating new `this` during tailcalls\n  method: %s\n  current class: %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#59882" title="(args: Any*)String">format</a><span class="delimiter">(</span>
        <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411317" title="=&gt; List[TailCalls.this.global.Symbol]">ownerChain</a>.<a href="../../../collection/TraversableOnce.scala.html#58283" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span><span class="delimiter">)</span>, <a href="../../../reflect/api/Trees.scala.html#405651" title="=&gt; TailCalls.this.global.Symbol">currentClass</a>.<a href="../../../reflect/internal/Symbols.scala.html#411317" title="=&gt; List[TailCalls.this.global.Symbol]">ownerChain</a>.<a href="../../../collection/TraversableOnce.scala.html#58283" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411109" title="(name: TailCalls.this.global.TermName, pos: TailCalls.this.global.Position, newFlags: Long)TailCalls.this.global.TermSymbol">newValue</a><span class="delimiter">(</span><a href="../../../reflect/internal/StdNames.scala.html#407871" title="TailCalls.this.global.nme.type">nme</a>.<a href="../../../reflect/internal/StdNames.scala.html#414040" title="=&gt; TailCalls.this.global.nme.NameType">THIS</a>, <a href="#1010561" title="TailCalls.this.global.Position">pos</a>, <span title="Long(2097152L)">SYNTHETIC</span><span class="delimiter">)</span> <a href="../../../reflect/internal/Symbols.scala.html#411369" title="(info: TailCalls.this.global.Type)TailCalls.this.global.TermSymbol">setInfo</a> <a href="../../../reflect/api/Trees.scala.html#405651" title="=&gt; TailCalls.this.global.Symbol">currentClass</a>.<a href="../../../reflect/internal/Symbols.scala.html#411426" title="=&gt; TailCalls.this.global.Type">typeOfThis</a>
      <span class="delimiter">}</span>

      <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="1010403">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">(</span>
        <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; TailCalls.this.global.Symbol#NameType">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; tparams: &quot;)" class="string">&quot; tparams: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010383" title="=&gt; List[TailCalls.this.global.Symbol]">tparams</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; tailPos: &quot;)" class="string">&quot; tailPos: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010386" title="=&gt; Boolean">tailPos</a> <span title="(x$1: Any)String">+</span>
        <span title="String(&quot; Label: &quot;)" class="string">&quot; Label: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010380" title="=&gt; TailCalls.this.global.Symbol">label</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; Label type: &quot;)" class="string">&quot; Label type: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010380" title="=&gt; TailCalls.this.global.Symbol">label</a>.<a href="../../../reflect/internal/Symbols.scala.html#411367" title="=&gt; TailCalls.this.global.Type">info</a>
      <span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">var</span> <a title="TailCallElimination.this.Context" id="1010342">ctx</a>: <a href="#1010340" title="TailCallElimination.this.Context">Context</a> = <span title="TailCallElimination.this.Context" class="keyword">new</span> <a href="#1010340" title="TailCallElimination.this.Context">Context</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()TailCallElimination.this.Context" id="1010344">noTailContext</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="TailCallElimination.this.Context" id="1010595">t</a> = <a href="#1010394" title="(that: TailCallElimination.this.Context)TailCallElimination.this.Context" class="keyword">new</a> <a href="#1010340" title="TailCallElimination.this.Context">Context</a><span class="delimiter">(</span><a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a><span class="delimiter">)</span>
      <a href="#1010595" title="TailCallElimination.this.Context">t</a>.<a href="#1010386" title="(x$1: Boolean)Unit">tailPos</a> = <span title="Boolean(false)" class="keyword">false</span>
      <a href="#1010595" title="TailCallElimination.this.Context">t</a>
    <span class="delimiter">}</span>

    /** Rewrite this tree to contain no tail recursive calls */
    <span class="keyword">def</span> <a title="(tree: TailCalls.this.global.Tree, nctx: TailCallElimination.this.Context)TailCalls.this.global.Tree" id="1010345">transform</a><span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1010600">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a>, <a title="TailCallElimination.this.Context" id="1010601">nctx</a>: <a href="#1010340" title="TailCallElimination.this.Context">Context</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="TailCallElimination.this.Context" id="1010603">saved</a> = <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>
      <a href="#1010342" title="(x$1: TailCallElimination.this.Context)Unit">ctx</a> = <a href="#1010601" title="TailCallElimination.this.Context">nctx</a>
      <span class="keyword">try</span> <a href="#1010348" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1010600" title="TailCalls.this.global.Tree">tree</a><span class="delimiter">)</span>
      <span class="keyword">finally</span> <a href="#621748" title="TailCallElimination.this.type" class="keyword">this</a>.<a href="#1010342" title="(x$1: TailCallElimination.this.Context)Unit">ctx</a> = <a href="#1010603" title="TailCallElimination.this.Context">saved</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree" id="1010346">noTailTransform</a><span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1010609">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a> = <a href="#1010345" title="(tree: TailCalls.this.global.Tree, nctx: TailCallElimination.this.Context)TailCalls.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1010609" title="TailCalls.this.global.Tree">tree</a>, <a href="#1010344" title="()TailCallElimination.this.Context">noTailContext</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(trees: List[TailCalls.this.global.Tree])List[TailCalls.this.global.Tree]" id="1010347">noTailTransforms</a><span class="delimiter">(</span><a title="List[TailCalls.this.global.Tree]" id="1010614">trees</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[TailCalls.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="TailCallElimination.this.Context" id="1010615">nctx</a> = <a href="#1010344" title="()TailCallElimination.this.Context">noTailContext</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#1010614" title="List[TailCalls.this.global.Tree]">trees</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: TailCalls.this.global.Tree =&gt; TailCalls.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[TailCalls.this.global.Tree],TailCalls.this.global.Tree,List[TailCalls.this.global.Tree]])List[TailCalls.this.global.Tree]">map</a> <span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1010632">t</a> =&gt; <a href="#1010345" title="(tree: TailCalls.this.global.Tree, nctx: TailCallElimination.this.Context)TailCalls.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1010632" title="TailCalls.this.global.Tree">t</a>, <a href="#1010615" title="TailCallElimination.this.Context">nctx</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree" id="1010348">transform</a><span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1010604">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      /** A possibly polymorphic apply to be considered for tail call transformation.
       */
      <span class="keyword">def</span> <a title="(target: TailCalls.this.global.Tree, fun: TailCalls.this.global.Tree, targs: List[TailCalls.this.global.Tree], args: List[TailCalls.this.global.Tree])TailCalls.this.global.Tree" id="1010665">rewriteApply</a><span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1010666">target</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a>, <a title="TailCalls.this.global.Tree" id="1010667">fun</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a>, <a title="List[TailCalls.this.global.Tree]" id="1010668">targs</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[TailCalls.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="List[TailCalls.this.global.Tree]" id="1010669">args</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[TailCalls.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="TailCalls.this.global.Tree" id="1010670">receiver</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a> = <a href="#1010667" title="TailCalls.this.global.Tree">fun</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Select<a href="#3361437" title="TailCalls.this.global.Tree" id="3361440" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409999" title="TailCalls.this.global.Tree" id="1010691">qual</a>, <a href="../../../reflect/internal/Trees.scala.html#410001" title="TailCalls.this.global.Name" id="3361438">_</a><span class="delimiter">)</span>  =&gt; <a href="#3361442" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree">qual</a>
          <span class="keyword">case</span> _                =&gt; <a href="#3361442" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree">EmptyTree</a>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="=&gt; Boolean" id="1010671">receiverIsSame</a>    = <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010396" title="=&gt; TailCalls.this.global.Type">enclosingType</a>.<a href="../../../reflect/internal/Types.scala.html#408411" title="=&gt; TailCalls.this.global.Type">widen</a> <a href="../../../reflect/internal/Types.scala.html#408485" title="(that: TailCalls.this.global.Type)Boolean">=:=</a> <a href="#1010670" title="TailCalls.this.global.Tree">receiver</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; TailCalls.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#408411" title="=&gt; TailCalls.this.global.Type">widen</a>
        <span class="keyword">def</span> <a title="=&gt; Boolean" id="1010672">receiverIsSuper</a>   = <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010396" title="=&gt; TailCalls.this.global.Type">enclosingType</a>.<a href="../../../reflect/internal/Types.scala.html#408411" title="=&gt; TailCalls.this.global.Type">widen</a> <a href="../../../reflect/internal/Types.scala.html#408481" title="(that: TailCalls.this.global.Type)Boolean">&lt;:&lt;</a> <a href="#1010670" title="TailCalls.this.global.Tree">receiver</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; TailCalls.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#408411" title="=&gt; TailCalls.this.global.Type">widen</a>
        <span class="keyword">def</span> <a title="=&gt; Boolean" id="1010673">isRecursiveCall</a>   = <span class="delimiter">(</span><a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#1010667" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010386" title="=&gt; Boolean">tailPos</a>
        <span class="keyword">def</span> <a title="=&gt; List[TailCalls.this.global.Tree]" id="1010674">transformArgs</a>     = <a href="#1010347" title="(trees: List[TailCalls.this.global.Tree])List[TailCalls.this.global.Tree]">noTailTransforms</a><span class="delimiter">(</span><a href="#1010669" title="List[TailCalls.this.global.Tree]">args</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="=&gt; Boolean" id="1010675">matchesTypeArgs</a>   = <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010383" title="=&gt; List[TailCalls.this.global.Symbol]">tparams</a> <a href="../../../collection/LinearSeqOptimized.scala.html#86401" title="(that: scala.collection.GenIterable[TailCalls.this.global.Symbol])Boolean">sameElements</a> <span class="delimiter">(</span><a href="#1010668" title="List[TailCalls.this.global.Tree]">targs</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: TailCalls.this.global.Tree =&gt; TailCalls.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[TailCalls.this.global.Tree],TailCalls.this.global.Symbol,List[TailCalls.this.global.Symbol]])List[TailCalls.this.global.Symbol]">map</a> <span class="delimiter">(</span><a href="#1010733" title="TailCalls.this.global.Tree">_</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; TailCalls.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#408407" title="=&gt; TailCalls.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span><span class="delimiter">)</span>

        /** Records failure reason in Context for reporting.
         *  Position is unchanged (by default, the method definition.)
         */
        <span class="keyword">def</span> <a title="(reason: String)TailCalls.this.global.Apply" id="1010676">fail</a><span class="delimiter">(</span><a title="String" id="1010764">reason</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
          <a href="../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Cannot rewrite recursive call at: &quot;)" class="string">&quot;Cannot rewrite recursive call at: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010667" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; TailCalls.this.global.Position">pos</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; because: &quot;)" class="string">&quot; because: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010764" title="String">reason</a><span class="delimiter">)</span>

          <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010389" title="(x$1: String)Unit">failReason</a> = <a href="#1010764" title="String">reason</a>
          <a href="../../../reflect/api/Trees.scala.html#405645" title="=&gt; TailCalls.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#405397" title="(tree: TailCalls.this.global.Tree, fun: TailCalls.this.global.Tree, args: List[TailCalls.this.global.Tree])TailCalls.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>, <a href="#1010346" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">noTailTransform</a><span class="delimiter">(</span><a href="#1010666" title="TailCalls.this.global.Tree">target</a><span class="delimiter">)</span>, <a href="#1010674" title="=&gt; List[TailCalls.this.global.Tree]">transformArgs</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        /** Position of failure is that of the tree being considered.
         */
        <span class="keyword">def</span> <a title="(reason: String)TailCalls.this.global.Apply" id="1010677">failHere</a><span class="delimiter">(</span><a title="String" id="1010768">reason</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
          <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010392" title="(x$1: TailCalls.this.global.Position)Unit">failPos</a> = <a href="#1010667" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; TailCalls.this.global.Position">pos</a>
          <a href="#1010676" title="(reason: String)TailCalls.this.global.Apply">fail</a><span class="delimiter">(</span><a href="#1010768" title="String">reason</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">def</span> <a title="(recv: TailCalls.this.global.Tree)TailCalls.this.global.Tree" id="1010678">rewriteTailCall</a><span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1010769">recv</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
          <a href="../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Rewriting tail recursive call:  &quot;)" class="string">&quot;Rewriting tail recursive call:  &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010667" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; TailCalls.this.global.Position">pos</a>.<a href="../../../reflect/internal/util/Position.scala.html#409695" title="=&gt; String">lineContent</a>.<span title="()String">trim</span><span class="delimiter">)</span>

          <a href="#1010338" title="=&gt; scala.collection.mutable.HashSet[TailCalls.this.global.Symbol]">accessed</a> <a href="../../../collection/mutable/HashSet.scala.html#125963" title="(elem: TailCalls.this.global.Symbol)TailCallElimination.this.accessed.type">+=</a> <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010380" title="=&gt; TailCalls.this.global.Symbol">label</a>
          <a href="../typechecker/Typers.scala.html#538703" title="(pos: TailCalls.this.global.analyzer.global.Position)(tree: TailCalls.this.global.analyzer.global.Tree)TailCalls.this.global.analyzer.global.Tree">typedPos</a><span class="delimiter">(</span><a href="#1010667" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; TailCalls.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#413581" title="(fun: TailCalls.this.global.Tree, args: List[TailCalls.this.global.Tree])TailCalls.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#408127" title="(sym: TailCalls.this.global.Symbol)TailCalls.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010380" title="=&gt; TailCalls.this.global.Symbol">label</a><span class="delimiter">)</span>, <a href="#1010346" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">noTailTransform</a><span class="delimiter">(</span><a href="#1010769" title="TailCalls.this.global.Tree">recv</a><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#62685" title="(x: TailCalls.this.global.Tree)List[TailCalls.this.global.Tree]">::</a> <a href="#1010674" title="=&gt; List[TailCalls.this.global.Tree]">transformArgs</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span title="TailCalls.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010398" title="=&gt; Boolean">isEligible</a><span class="delimiter">)</span>            <a href="#1010676" title="(reason: String)TailCalls.this.global.Apply">fail</a><span class="delimiter">(</span><span title="String(&quot;it is neither private nor final so can be overridden&quot;)" class="string">&quot;it is neither private nor final so can be overridden&quot;</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <span title="TailCalls.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1010673" title="=&gt; Boolean">isRecursiveCall</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="TailCalls.this.global.Apply" class="keyword">if</span> <span class="delimiter">(</span><a href="#1010672" title="=&gt; Boolean">receiverIsSuper</a><span class="delimiter">)</span>          <a href="#1010677" title="(reason: String)TailCalls.this.global.Apply">failHere</a><span class="delimiter">(</span><span title="String(&quot;it contains a recursive call targeting supertype &quot;)" class="string">&quot;it contains a recursive call targeting supertype &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#1010670" title="TailCalls.this.global.Tree">receiver</a>.<a href="../../../reflect/internal/Trees.scala.html#408573" title="=&gt; TailCalls.this.global.Type">tpe</a><span class="delimiter">)</span>
          <span class="keyword">else</span>                          <a href="#1010677" title="(reason: String)TailCalls.this.global.Apply">failHere</a><span class="delimiter">(</span><a href="#1010336" title="=&gt; String">defaultReason</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">else</span> <span title="TailCalls.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1010675" title="=&gt; Boolean">matchesTypeArgs</a><span class="delimiter">)</span>      <a href="#1010677" title="(reason: String)TailCalls.this.global.Apply">failHere</a><span class="delimiter">(</span><span title="String(&quot;it is called recursively with different type arguments&quot;)" class="string">&quot;it is called recursively with different type arguments&quot;</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <span title="TailCalls.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#1010670" title="TailCalls.this.global.Tree">receiver</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Trees.scala.html#407946" title="TailCalls.this.global.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span> <a href="#1010678" title="(recv: TailCalls.this.global.Tree)TailCalls.this.global.Tree">rewriteTailCall</a><span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#408123" title="(sym: TailCalls.this.global.Symbol)TailCalls.this.global.Tree">This</a><span class="delimiter">(</span><a href="../../../reflect/api/Trees.scala.html#405651" title="=&gt; TailCalls.this.global.Symbol">currentClass</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <span title="TailCalls.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="../Global.scala.html#537757" title="=&gt; Boolean">forMSIL</a><span class="delimiter">)</span>               <a href="#1010676" title="(reason: String)TailCalls.this.global.Apply">fail</a><span class="delimiter">(</span><span title="String(&quot;it cannot be optimized on MSIL&quot;)" class="string">&quot;it cannot be optimized on MSIL&quot;</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <span title="TailCalls.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1010671" title="=&gt; Boolean">receiverIsSame</a><span class="delimiter">)</span>       <a href="#1010677" title="(reason: String)TailCalls.this.global.Apply">failHere</a><span class="delimiter">(</span><span title="String(&quot;it changes type of \'this\' on a polymorphic recursive call&quot;)" class="string">&quot;it changes type of 'this' on a polymorphic recursive call&quot;</span><span class="delimiter">)</span>
        <span class="keyword">else</span>                            <a href="#1010678" title="(recv: TailCalls.this.global.Tree)TailCalls.this.global.Tree">rewriteTailCall</a><span class="delimiter">(</span><a href="#1010670" title="TailCalls.this.global.Tree">receiver</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#1010604" title="TailCalls.this.global.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> ValDef<a href="#3361481" title="TailCalls.this.global.Tree" id="3361487" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410298" title="TailCalls.this.global.Modifiers" id="3361482">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410300" title="TailCalls.this.global.TermName" id="3361483">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410302" title="TailCalls.this.global.Tree" id="3361484">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410304" title="TailCalls.this.global.Tree" id="3361485">_</a><span class="delimiter">)</span> =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a>.<a href="../../../reflect/internal/HasFlags.scala.html#409857" title="=&gt; Boolean">isLazy</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1010604" title="TailCalls.this.global.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a>.<a href="../../../reflect/internal/AnnotationInfos.scala.html#408615" title="(cls: TailCalls.this.global.Symbol)Boolean">hasAnnotation</a><span class="delimiter">(</span><a href="../../../reflect/internal/Definitions.scala.html#409167" title="=&gt; TailCalls.this.global.ClassSymbol">TailrecClass</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#1010349" title="TailCalls.this.global.CompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539298" title="(pos: TailCalls.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; TailCalls.this.global.Position">pos</a>, <span title="String(&quot;lazy vals are not tailcall transformed&quot;)" class="string">&quot;lazy vals are not tailcall transformed&quot;</span><span class="delimiter">)</span>

          <a href="#621748" title="TailCalls.this.TailCallElimination" class="keyword">super</a>.<a href="../../../reflect/api/Trees.scala.html#405652" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a><span class="delimiter">)</span>

        <span class="keyword">case</span> dd @ DefDef<a href="#3361481" title="TailCalls.this.global.Tree" id="3361493" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410278" title="TailCalls.this.global.Modifiers" id="3361488">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410280" title="TailCalls.this.global.Name" id="3361489">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410282" title="List[TailCalls.this.global.TypeDef]" id="3361490">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410284" title="List[List[TailCalls.this.global.ValDef]]" id="1010901">vparamss0</a>, <a href="../../../reflect/internal/Trees.scala.html#410286" title="TailCalls.this.global.Tree" id="3361491">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410288" title="TailCalls.this.global.Tree" id="1010902">rhs0</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a>dd.<a href="../../../reflect/internal/Trees.scala.html#409939" title="=&gt; TailCalls.this.global.Symbol">symbol</a>.<a href="../../../reflect/internal/HasFlags.scala.html#409839" title="=&gt; Boolean">hasAccessorFlag</a> =&gt;
          <span class="keyword">val</span> <a title="TailCallElimination.this.Context" id="1010903">newCtx</a> = <a href="#1010395" title="(dd: TailCalls.this.global.DefDef)TailCallElimination.this.Context" class="keyword">new</a> <a href="#1010340" title="TailCallElimination.this.Context">Context</a><span class="delimiter">(</span>dd<span class="delimiter">)</span>
          <span class="keyword">def</span> <a title="(t: TailCalls.this.global.Tree)Boolean" id="1010904">isRecursiveCall</a><span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1010911">t</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="TailCalls.this.global.Symbol" id="1010912">sym</a> = <a href="#1010911" title="TailCalls.this.global.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a>
            <span class="delimiter">(</span><a href="#1010912" title="TailCalls.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">{</span>
              <a href="#1010912" title="TailCalls.this.global.Symbol">sym</a>.<a href="../../../reflect/api/Symbols.scala.html#402398" title="=&gt; Boolean">isMethod</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span>dd.<a href="../../../reflect/internal/Trees.scala.html#409939" title="=&gt; TailCalls.this.global.Symbol">symbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; TailCalls.this.global.Symbol#NameType">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#1010912" title="TailCalls.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span>dd.<a href="../../../reflect/internal/Trees.scala.html#409939" title="=&gt; TailCalls.this.global.Symbol">symbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#411422" title="=&gt; TailCalls.this.global.Symbol">enclClass</a> <a href="../../../reflect/internal/Symbols.scala.html#411410" title="(that: TailCalls.this.global.Symbol)Boolean">isSubClass</a> <a href="#1010912" title="TailCalls.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#411422" title="=&gt; TailCalls.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010399" title="=&gt; Boolean">isMandatory</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1010902" title="TailCalls.this.global.Tree">rhs0</a>.<a href="../../../reflect/internal/Trees.scala.html#408545" title="(p: TailCalls.this.global.Tree =&gt; Boolean)Boolean">exists</a><span class="delimiter">(</span><a href="#1010904" title="(t: TailCalls.this.global.Tree)Boolean">isRecursiveCall</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#1010349" title="TailCalls.this.global.CompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#539298" title="(pos: TailCalls.this.global.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; TailCalls.this.global.Position">pos</a>, <span title="String(&quot;@tailrec annotated method contains no recursive calls&quot;)" class="string">&quot;@tailrec annotated method contains no recursive calls&quot;</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>

          // labels are local to a method, so only traverse the rhs of a defdef
          <span class="keyword">val</span> <a title="TailCalls.this.TailPosLabelsTraverser" id="1010905">collectTailPosLabels</a> = <span title="TailCalls.this.TailPosLabelsTraverser" class="keyword">new</span> <a href="#621749" title="TailCalls.this.TailPosLabelsTraverser">TailPosLabelsTraverser</a>
          <a href="#1010905" title="TailCalls.this.TailPosLabelsTraverser">collectTailPosLabels</a> <a href="#1010939" title="(tree: TailCalls.this.global.Tree)Unit">traverse</a> <a href="#1010902" title="TailCalls.this.global.Tree">rhs0</a>
          <a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010377" title="(x$1: Set[TailCalls.this.global.Symbol])Unit">tailLabels</a> = <a href="#1010905" title="TailCalls.this.TailPosLabelsTraverser">collectTailPosLabels</a>.<a href="#1010931" title="=&gt; scala.collection.mutable.HashSet[TailCalls.this.global.Symbol]">tailLabels</a>.<a href="../../../collection/TraversableOnce.scala.html#58270" title="scala.collection.immutable.Set[TailCalls.this.global.Symbol]">toSet</a>

          <a href="../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Considering &quot;)" class="string">&quot;Considering &quot;</span> <span title="(x$1: Any)String">+</span> dd.<a href="../../../reflect/internal/Trees.scala.html#410280" title="=&gt; TailCalls.this.global.Name">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; for tailcalls, with labels in tailpos: &quot;)" class="string">&quot; for tailcalls, with labels in tailpos: &quot;</span><span title="(x$1: Any)String">+</span> <a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010377" title="=&gt; Set[TailCalls.this.global.Symbol]">tailLabels</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="TailCalls.this.global.Tree" id="1010906">newRHS</a> = <a href="#1010345" title="(tree: TailCalls.this.global.Tree, nctx: TailCallElimination.this.Context)TailCalls.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1010902" title="TailCalls.this.global.Tree">rhs0</a>, <a href="#1010903" title="TailCallElimination.this.Context">newCtx</a><span class="delimiter">)</span>

          <a href="../../../reflect/internal/Trees.scala.html#408156" title="(ddef: TailCalls.this.global.Tree)(applyToRhs: TailCalls.this.global.Tree =&gt; TailCalls.this.global.Tree)TailCalls.this.global.DefDef">deriveDefDef</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a><span class="delimiter">)</span><span class="delimiter">{</span><a title="TailCalls.this.global.Tree" id="1011220">rhs</a> =&gt;
            <span title="TailCalls.this.global.analyzer.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010400" title="=&gt; Boolean">isTransformed</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              /** We have rewritten the tree, but there may be nested recursive calls remaining.
               *  If @tailrec is given we need to fail those now.
               */
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010399" title="=&gt; Boolean">isMandatory</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="keyword">for</span> <span class="delimiter">(</span>t @ Apply<a href="#3361447" title="Boolean" id="3361469" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410031" title="TailCalls.this.global.Tree" id="1011263">fn</a>, <a href="../../../reflect/internal/Trees.scala.html#410033" title="List[TailCalls.this.global.Tree]" id="3361467">_</a><span class="delimiter">)</span> &lt;- <a href="../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: TailCalls.this.global.Tree =&gt; Unit)Unit">newRHS</a> ; <span class="keyword">if</span> <a href="#1011263" title="TailCalls.this.global.Tree">fn</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a> <a href="#3361462" title="(x: Boolean)Boolean">==</a> <a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010374" title="=&gt; TailCalls.this.global.Symbol">method</a><span class="delimiter">)</span> <a href="#3361471" title="(x: Unit)Unit" class="delimiter">{</a>
                  <a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010392" title="(x$1: TailCalls.this.global.Position)Unit">failPos</a> = t.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; TailCalls.this.global.Position">pos</a>
                  <a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010401" title="()Unit">tailrecFailure</a><span class="delimiter">(</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
              <span class="keyword">val</span> <a title="TailCalls.this.global.TermSymbol" id="1011221">newThis</a> = <a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010402" title="(pos: TailCalls.this.global.Position)TailCalls.this.global.TermSymbol">newThis</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; TailCalls.this.global.Position">pos</a><span class="delimiter">)</span>
              <span class="keyword">val</span> <a title="List[TailCalls.this.global.Symbol]" id="1011222">vpSyms</a>  = <a href="#1010901" title="List[List[TailCalls.this.global.ValDef]]">vparamss0</a>.<a href="../../../collection/generic/GenericTraversableTemplate.scala.html#58488" title="(implicit asTraversable: List[TailCalls.this.global.ValDef] =&gt; scala.collection.GenTraversableOnce[TailCalls.this.global.ValDef])List[TailCalls.this.global.ValDef]">flatten</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: TailCalls.this.global.ValDef =&gt; TailCalls.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[TailCalls.this.global.ValDef],TailCalls.this.global.Symbol,List[TailCalls.this.global.Symbol]])List[TailCalls.this.global.Symbol]">map</a> <span class="delimiter">(</span><a href="#1011290" title="TailCalls.this.global.ValDef">_</a>.<a href="../../../reflect/internal/Trees.scala.html#409939" title="=&gt; TailCalls.this.global.Symbol">symbol</a><span class="delimiter">)</span>

              <a href="../typechecker/Typers.scala.html#538703" title="(pos: TailCalls.this.global.analyzer.global.Position)(tree: TailCalls.this.global.analyzer.global.Tree)TailCalls.this.global.analyzer.global.Tree">typedPos</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408571" title="=&gt; TailCalls.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#453067" title="(stats: List[TailCalls.this.global.Tree], expr: TailCalls.this.global.Tree)TailCalls.this.global.Block">Block</a><span class="delimiter">(</span>
                <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: TailCalls.this.global.ValDef*)List[TailCalls.this.global.ValDef]">List</a><span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#408102" title="(sym: TailCalls.this.global.Symbol, rhs: TailCalls.this.global.Tree)TailCalls.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#1011221" title="TailCalls.this.global.TermSymbol">newThis</a>, <a href="../../../reflect/internal/Trees.scala.html#408123" title="(sym: TailCalls.this.global.Symbol)TailCalls.this.global.Tree">This</a><span class="delimiter">(</span><a href="../../../reflect/api/Trees.scala.html#405651" title="=&gt; TailCalls.this.global.Symbol">currentClass</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>,
                <a href="../../../reflect/internal/Trees.scala.html#408113" title="(sym: TailCalls.this.global.Symbol, params: List[TailCalls.this.global.Symbol], rhs: TailCalls.this.global.Tree)TailCalls.this.global.LabelDef">LabelDef</a><span class="delimiter">(</span><a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010380" title="=&gt; TailCalls.this.global.Symbol">label</a>, <a href="#1011221" title="TailCalls.this.global.TermSymbol">newThis</a> <a href="../../../collection/immutable/List.scala.html#62685" title="(x: TailCalls.this.global.Symbol)List[TailCalls.this.global.Symbol]">::</a> <a href="#1011222" title="List[TailCalls.this.global.Symbol]">vpSyms</a>, <a href="#1010906" title="TailCalls.this.global.Tree">newRHS</a><span class="delimiter">)</span>
              <span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <span class="keyword">else</span> <span class="delimiter">{</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010399" title="=&gt; Boolean">isMandatory</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1010906" title="TailCalls.this.global.Tree">newRHS</a>.<a href="../../../reflect/internal/Trees.scala.html#408545" title="(p: TailCalls.this.global.Tree =&gt; Boolean)Boolean">exists</a><span class="delimiter">(</span><a href="#1010904" title="(t: TailCalls.this.global.Tree)Boolean">isRecursiveCall</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#1010903" title="TailCallElimination.this.Context">newCtx</a>.<a href="#1010401" title="()Unit">tailrecFailure</a><span class="delimiter">(</span><span class="delimiter">)</span>

              <a href="#1010906" title="TailCalls.this.global.Tree">newRHS</a>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>

        // a translated match
        <span class="keyword">case</span> Block<a href="#3361481" title="Boolean" id="3361495" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410192" title="List[TailCalls.this.global.Tree]" id="1011412">stats</a>, <a href="../../../reflect/internal/Trees.scala.html#410194" title="TailCalls.this.global.Tree" id="1011413">expr</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#1011412" title="List[TailCalls.this.global.Tree]">stats</a> <a href="../../../collection/LinearSeqOptimized.scala.html#86378" title="(p: TailCalls.this.global.Tree =&gt; Boolean)Boolean">forall</a> <a href="../../../reflect/internal/TreeInfo.scala.html#479246" title="(t: TailCalls.this.global.treeInfo.global.Tree)Boolean">hasSynthCaseSymbol</a> =&gt;
          // the assumption is once we encounter a case, the remainder of the block will consist of cases
          // the prologue may be empty, usually it is the valdef that stores the scrut
          <span class="keyword">val</span> <a href="#3361477" title="(x: (List[TailCalls.this.global.Tree], List[TailCalls.this.global.Tree]))(List[TailCalls.this.global.Tree], List[TailCalls.this.global.Tree])" class="delimiter">(</a><a href="../../../Tuple2.scala.html#60635" title="List[TailCalls.this.global.Tree]" id="1011422">prologue</a>, <a href="../../../Tuple2.scala.html#60637" title="List[TailCalls.this.global.Tree]" id="1011423">cases</a><span class="delimiter">)</span> = <a href="#1011412" title="List[TailCalls.this.global.Tree]">stats</a> <a href="../../../collection/immutable/List.scala.html#62715" title="(p: TailCalls.this.global.Tree =&gt; Boolean)(List[TailCalls.this.global.Tree], List[TailCalls.this.global.Tree])">span</a> <span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1011429">s</a> =&gt; <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1011429" title="TailCalls.this.global.Tree">s</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../../reflect/internal/Trees.scala.html#407969" title="TailCalls.this.global.LabelDef">LabelDef</a><span class="delimiter">]</span><span class="delimiter">)</span>
          <a href="../../../reflect/api/Trees.scala.html#405645" title="=&gt; TailCalls.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#405380" title="(tree: TailCalls.this.global.Tree, stats: List[TailCalls.this.global.Tree], expr: TailCalls.this.global.Tree)TailCalls.this.global.Block">Block</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>,
            <a href="#1010347" title="(trees: List[TailCalls.this.global.Tree])List[TailCalls.this.global.Tree]">noTailTransforms</a><span class="delimiter">(</span><a href="#1011422" title="List[TailCalls.this.global.Tree]">prologue</a><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#62697" title="(that: scala.collection.GenTraversableOnce[TailCalls.this.global.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[TailCalls.this.global.Tree],TailCalls.this.global.Tree,List[TailCalls.this.global.Tree]])List[TailCalls.this.global.Tree]">++</a> <a href="../../../reflect/api/Trees.scala.html#405653" title="(trees: List[TailCalls.this.global.Tree])List[TailCalls.this.global.Tree]">transformTrees</a><span class="delimiter">(</span><a href="#1011423" title="List[TailCalls.this.global.Tree]">cases</a><span class="delimiter">)</span>,
            <a href="#1010348" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1011413" title="TailCalls.this.global.Tree">expr</a><span class="delimiter">)</span>
          <span class="delimiter">)</span>

        // a translated casedef
        <span class="keyword">case</span> LabelDef<a href="#3361481" title="TailCalls.this.global.Tree" id="3361499" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410239" title="TailCalls.this.global.TermName" id="3361496">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410241" title="List[TailCalls.this.global.Ident]" id="3361497">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410243" title="TailCalls.this.global.Tree" id="1011516">body</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../../reflect/internal/TreeInfo.scala.html#479246" title="(t: TailCalls.this.global.treeInfo.global.Tree)Boolean">hasSynthCaseSymbol</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a><span class="delimiter">)</span> =&gt;
          <a href="../../../reflect/internal/Trees.scala.html#408162" title="(ldef: TailCalls.this.global.Tree)(applyToRhs: TailCalls.this.global.Tree =&gt; TailCalls.this.global.Tree)TailCalls.this.global.LabelDef">deriveLabelDef</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a><span class="delimiter">)</span><a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="delimiter">(</a><a href="#1010348" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">transform</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Block<span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#410192" title="List[TailCalls.this.global.Tree]" id="1011531">stats</a>, <a href="../../../reflect/internal/Trees.scala.html#410194" title="TailCalls.this.global.Tree" id="1011532">expr</a><span class="delimiter">)</span> =&gt;
          <a href="../../../reflect/api/Trees.scala.html#405645" title="=&gt; TailCalls.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#405380" title="(tree: TailCalls.this.global.Tree, stats: List[TailCalls.this.global.Tree], expr: TailCalls.this.global.Tree)TailCalls.this.global.Block">Block</a><a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="delimiter">(</a><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>,
            <a href="#1010347" title="(trees: List[TailCalls.this.global.Tree])List[TailCalls.this.global.Tree]">noTailTransforms</a><span class="delimiter">(</span><a href="#1011531" title="List[TailCalls.this.global.Tree]">stats</a><span class="delimiter">)</span>,
            <a href="#1010348" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1011532" title="TailCalls.this.global.Tree">expr</a><span class="delimiter">)</span>
          <span class="delimiter">)</span>

        <span class="keyword">case</span> CaseDef<a href="#3361481" title="TailCalls.this.global.Tree" id="3361503" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410180" title="TailCalls.this.global.Tree" id="1011542">pat</a>, <a href="../../../reflect/internal/Trees.scala.html#410182" title="TailCalls.this.global.Tree" id="1011543">guard</a>, <a href="../../../reflect/internal/Trees.scala.html#410184" title="TailCalls.this.global.Tree" id="1011544">body</a><span class="delimiter">)</span> =&gt;
          <a href="../../../reflect/internal/Trees.scala.html#408161" title="(cdef: TailCalls.this.global.Tree)(applyToBody: TailCalls.this.global.Tree =&gt; TailCalls.this.global.Tree)TailCalls.this.global.CaseDef">deriveCaseDef</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a><span class="delimiter">)</span><a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="delimiter">(</a><a href="#1010348" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">transform</a><span class="delimiter">)</span>

        <span class="keyword">case</span> If<a href="#3361481" title="TailCalls.this.global.Tree" id="3361505" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410107" title="TailCalls.this.global.Tree" id="1011558">cond</a>, <a href="../../../reflect/internal/Trees.scala.html#410109" title="TailCalls.this.global.Tree" id="1011559">thenp</a>, <a href="../../../reflect/internal/Trees.scala.html#410111" title="TailCalls.this.global.Tree" id="1011560">elsep</a><span class="delimiter">)</span> =&gt;
          <a href="../../../reflect/api/Trees.scala.html#405645" title="=&gt; TailCalls.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#405389" title="(tree: TailCalls.this.global.Tree, cond: TailCalls.this.global.Tree, thenp: TailCalls.this.global.Tree, elsep: TailCalls.this.global.Tree)TailCalls.this.global.If">If</a><a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="delimiter">(</a><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>,
            <a href="#1011558" title="TailCalls.this.global.Tree">cond</a>,
            <a href="#1010348" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1011559" title="TailCalls.this.global.Tree">thenp</a><span class="delimiter">)</span>,
            <a href="#1010348" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1011560" title="TailCalls.this.global.Tree">elsep</a><span class="delimiter">)</span>
          <span class="delimiter">)</span>

        <span class="keyword">case</span> Match<a href="#3361481" title="TailCalls.this.global.Tree" id="3361507" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410097" title="TailCalls.this.global.Tree" id="1011575">selector</a>, <a href="../../../reflect/internal/Trees.scala.html#410099" title="List[TailCalls.this.global.CaseDef]" id="1011576">cases</a><span class="delimiter">)</span> =&gt;
          <a href="../../../reflect/api/Trees.scala.html#405645" title="=&gt; TailCalls.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#405390" title="(tree: TailCalls.this.global.Tree, selector: TailCalls.this.global.Tree, cases: List[TailCalls.this.global.CaseDef])TailCalls.this.global.Match">Match</a><a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="delimiter">(</a><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>,
            <a href="#1010346" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">noTailTransform</a><span class="delimiter">(</span><a href="#1011575" title="TailCalls.this.global.Tree">selector</a><span class="delimiter">)</span>,
            <a href="../../../reflect/api/Trees.scala.html#405653" title="(trees: List[TailCalls.this.global.Tree])List[TailCalls.this.global.Tree]">transformTrees</a><span class="delimiter">(</span><a href="#1011576" title="List[TailCalls.this.global.CaseDef]">cases</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="List[TailCalls.this.global.CaseDef]" class="delimiter">[</span><a href="../../../collection/immutable/List.scala.html#11952" title="List[TailCalls.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span><span class="delimiter">]</span>
          <span class="delimiter">)</span>

        <span class="keyword">case</span> Try<a href="#3361481" title="TailCalls.this.global.Tree" id="3361509" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410079" title="TailCalls.this.global.Tree" id="1011585">block</a>, <a href="../../../reflect/internal/Trees.scala.html#410081" title="List[TailCalls.this.global.CaseDef]" id="1011586">catches</a>, <a href="../../../reflect/internal/Trees.scala.html#410083" title="TailCalls.this.global.Tree" id="1011587">finalizer</a><span class="delimiter">)</span> =&gt;
           // no calls inside a try are in tail position, but keep recursing for nested functions
          <a href="../../../reflect/api/Trees.scala.html#405645" title="=&gt; TailCalls.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#405392" title="(tree: TailCalls.this.global.Tree, block: TailCalls.this.global.Tree, catches: List[TailCalls.this.global.CaseDef], finalizer: TailCalls.this.global.Tree)TailCalls.this.global.Try">Try</a><a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="delimiter">(</a><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>,
            <a href="#1010346" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">noTailTransform</a><span class="delimiter">(</span><a href="#1011585" title="TailCalls.this.global.Tree">block</a><span class="delimiter">)</span>,
            <a href="#1010347" title="(trees: List[TailCalls.this.global.Tree])List[TailCalls.this.global.Tree]">noTailTransforms</a><span class="delimiter">(</span><a href="#1011586" title="List[TailCalls.this.global.CaseDef]">catches</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="List[TailCalls.this.global.CaseDef]" class="delimiter">[</span><a href="../../../collection/immutable/List.scala.html#11952" title="List[TailCalls.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span><span class="delimiter">]</span>,
            <a href="#1010346" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">noTailTransform</a><span class="delimiter">(</span><a href="#1011587" title="TailCalls.this.global.Tree">finalizer</a><span class="delimiter">)</span>
          <span class="delimiter">)</span>

        <span class="keyword">case</span> Apply<a href="#3361481" title="Boolean" id="3361511" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410031" title="TailCalls.this.global.Tree" id="1011596">tapply</a> @ TypeApply<a href="#1011596" title="TailCalls.this.global.Tree" id="3361513" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410043" title="TailCalls.this.global.Tree" id="1011599">fun</a>, <a href="../../../reflect/internal/Trees.scala.html#410045" title="List[TailCalls.this.global.Tree]" id="1011600">targs</a><span class="delimiter">)</span>, <a href="../../../reflect/internal/Trees.scala.html#410033" title="List[TailCalls.this.global.Tree]" id="1011601">vargs</a><span class="delimiter">)</span> =&gt;
          <a href="#1010665" title="(target: TailCalls.this.global.Tree, fun: TailCalls.this.global.Tree, targs: List[TailCalls.this.global.Tree], args: List[TailCalls.this.global.Tree])TailCalls.this.global.Tree">rewriteApply</a><a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="delimiter">(</a>tapply, <a href="#1011599" title="TailCalls.this.global.Tree">fun</a>, <a href="#1011600" title="List[TailCalls.this.global.Tree]">targs</a>, <a href="#1011601" title="List[TailCalls.this.global.Tree]">vargs</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Apply<span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#410031" title="TailCalls.this.global.Tree" id="1011606">fun</a>, <a href="../../../reflect/internal/Trees.scala.html#410033" title="List[TailCalls.this.global.Tree]" id="1011607">args</a><span class="delimiter">)</span> =&gt;
          <a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="keyword">if</a> <span class="delimiter">(</span><a href="#1011606" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Definitions.scala.html#409373" title="=&gt; TailCalls.this.global.TermSymbol">Boolean_or</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#1011606" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Definitions.scala.html#409371" title="=&gt; TailCalls.this.global.TermSymbol">Boolean_and</a><span class="delimiter">)</span>
            <a href="../../../reflect/api/Trees.scala.html#405645" title="=&gt; TailCalls.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#405397" title="(tree: TailCalls.this.global.Tree, fun: TailCalls.this.global.Tree, args: List[TailCalls.this.global.Tree])TailCalls.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>, <a href="#1011606" title="TailCalls.this.global.Tree">fun</a>, <a href="../../../reflect/api/Trees.scala.html#405653" title="(trees: List[TailCalls.this.global.Tree])List[TailCalls.this.global.Tree]">transformTrees</a><span class="delimiter">(</span><a href="#1011607" title="List[TailCalls.this.global.Tree]">args</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">else</span> <span title="TailCalls.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#1011606" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#411218" title="=&gt; Boolean">isLabel</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1011607" title="List[TailCalls.this.global.Tree]">args</a>.<a href="../../../collection/TraversableOnce.scala.html#58191" title="=&gt; Boolean">nonEmpty</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1011607" title="List[TailCalls.this.global.Tree]">args</a>.<a href="../../../collection/TraversableLike.scala.html#58104" title="=&gt; List[TailCalls.this.global.Tree]">tail</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="../../../collection/GenSetLike.scala.html#66403" title="(elem: TailCalls.this.global.Symbol)Boolean">tailLabels</a><span class="delimiter">(</span><a href="#1011606" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            // this is to detect tailcalls in translated matches
            // it's a one-argument call to a label that is in a tailposition and that looks like label(x) {x}
            // thus, the argument to the call is in tailposition
            <span class="keyword">val</span> <a title="Boolean" id="1011637">saved</a> = <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010386" title="=&gt; Boolean">tailPos</a>
            <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010386" title="(x$1: Boolean)Unit">tailPos</a> = <span title="Boolean(true)" class="keyword">true</span>
            <a href="../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;in tailpos label: &quot;)" class="string">&quot;in tailpos label: &quot;</span><span title="(x$1: Any)String">+</span> <a href="#1011607" title="List[TailCalls.this.global.Tree]">args</a>.<a href="../../../collection/IterableLike.scala.html#58577" title="=&gt; TailCalls.this.global.Tree">head</a><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="TailCalls.this.global.Tree" id="1011638">res</a> = <a href="#1010348" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#1011607" title="List[TailCalls.this.global.Tree]">args</a>.<a href="../../../collection/IterableLike.scala.html#58577" title="=&gt; TailCalls.this.global.Tree">head</a><span class="delimiter">)</span>
            <a href="#1010342" title="=&gt; TailCallElimination.this.Context">ctx</a>.<a href="#1010386" title="(x$1: Boolean)Unit">tailPos</a> = <a href="#1011637" title="Boolean">saved</a>
            <span title="TailCalls.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#1011638" title="TailCalls.this.global.Tree">res</a> <span title="(x$1: AnyRef)Boolean">ne</span> <a href="#1011607" title="List[TailCalls.this.global.Tree]">args</a>.<a href="../../../collection/IterableLike.scala.html#58577" title="=&gt; TailCalls.this.global.Tree">head</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              // we tail-called -- TODO: shield from false-positives where we rewrite but don't tail-call
              // must leave the jump to the original tailpos-label (fun)!
              // there might be *a* tailcall *in* res, but it doesn't mean res *always* tailcalls
              <a href="../../../reflect/api/Trees.scala.html#405645" title="=&gt; TailCalls.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#405397" title="(tree: TailCalls.this.global.Tree, fun: TailCalls.this.global.Tree, args: List[TailCalls.this.global.Tree])TailCalls.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>, <a href="#1011606" title="TailCalls.this.global.Tree">fun</a>, <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: TailCalls.this.global.Tree*)List[TailCalls.this.global.Tree]">List</a><span class="delimiter">(</span><a href="#1011638" title="TailCalls.this.global.Tree">res</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <span class="keyword">else</span> <a href="#1010665" title="(target: TailCalls.this.global.Tree, fun: TailCalls.this.global.Tree, targs: List[TailCalls.this.global.Tree], args: List[TailCalls.this.global.Tree])TailCalls.this.global.Tree">rewriteApply</a><span class="delimiter">(</span><a href="#1011606" title="TailCalls.this.global.Tree">fun</a>, <a href="#1011606" title="TailCalls.this.global.Tree">fun</a>, <a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="#1011607" title="List[TailCalls.this.global.Tree]">args</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#1010665" title="(target: TailCalls.this.global.Tree, fun: TailCalls.this.global.Tree, targs: List[TailCalls.this.global.Tree], args: List[TailCalls.this.global.Tree])TailCalls.this.global.Tree">rewriteApply</a><span class="delimiter">(</span><a href="#1011606" title="TailCalls.this.global.Tree">fun</a>, <a href="#1011606" title="TailCalls.this.global.Tree">fun</a>, <a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="#1011607" title="List[TailCalls.this.global.Tree]">args</a><span class="delimiter">)</span>

        <span class="keyword">case</span> Alternative<a href="#3361481" title="TailCalls.this.global.Tree" id="3361518" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410172" title="List[TailCalls.this.global.Tree]" id="3361516">_</a><span class="delimiter">)</span> | Star<a href="#3361481" title="Boolean" id="3361521" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410166" title="TailCalls.this.global.Tree" id="3361519">_</a><span class="delimiter">)</span> | Bind<a href="#3361481" title="Boolean" id="3361525" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410157" title="TailCalls.this.global.Name" id="3361522">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410159" title="TailCalls.this.global.Tree" id="3361523">_</a><span class="delimiter">)</span> =&gt;
          sys.<a href="../../../sys/package.scala.html#55658" title="(message: String)Nothing">error</a><a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="delimiter">(</a><span title="String(&quot;We should\'ve never gotten inside a pattern&quot;)" class="string">&quot;We should've never gotten inside a pattern&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> Select<a href="#3361481" title="TailCalls.this.global.Tree" id="3361527" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409999" title="TailCalls.this.global.Tree" id="1011664">qual</a>, <a href="../../../reflect/internal/Trees.scala.html#410001" title="TailCalls.this.global.Name" id="1011665">name</a><span class="delimiter">)</span> =&gt;
          <a href="../../../reflect/api/Trees.scala.html#405645" title="=&gt; TailCalls.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#405400" title="(tree: TailCalls.this.global.Tree, qualifier: TailCalls.this.global.Tree, selector: TailCalls.this.global.Name)TailCalls.this.global.Select">Select</a><a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="delimiter">(</a><a href="#1010604" title="TailCalls.this.global.Tree">tree</a>, <a href="#1010346" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">noTailTransform</a><span class="delimiter">(</span><a href="#1011664" title="TailCalls.this.global.Tree">qual</a><span class="delimiter">)</span>, <a href="#1011665" title="TailCalls.this.global.Name">name</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../../../reflect/internal/Trees.scala.html#407946" title="TailCalls.this.global.Tree" id="3361548">EmptyTree</a> | Super<a href="#3361481" title="Boolean" id="3361532" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410016" title="TailCalls.this.global.Tree" id="3361529">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410018" title="TailCalls.this.global.TypeName" id="3361530">_</a><span class="delimiter">)</span> | This<a href="#3361481" title="Boolean" id="3361535" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410008" title="TailCalls.this.global.TypeName" id="3361533">_</a><span class="delimiter">)</span> | Ident<a href="#3361481" title="Boolean" id="3361538" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409987" title="TailCalls.this.global.Name" id="3361536">_</a><span class="delimiter">)</span> | Literal<a href="#3361481" title="Boolean" id="3361541" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409973" title="TailCalls.this.global.Constant" id="3361539">_</a><span class="delimiter">)</span> | Function<a href="#3361481" title="Boolean" id="3361545" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410136" title="List[TailCalls.this.global.ValDef]" id="3361542">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410138" title="TailCalls.this.global.Tree" id="3361543">_</a><span class="delimiter">)</span> | TypeTree<a href="#3361481" title="Boolean" id="3361547" class="delimiter">(</a><span class="delimiter">)</span> =&gt;
          <a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree">tree</a>
        <span class="keyword">case</span> _ =&gt;
          <a href="#621748" title="TailCalls.this.TailCallElimination" class="keyword">super</a>.<a href="../../../reflect/api/Trees.scala.html#405652" title="(tree: TailCalls.this.global.Tree)TailCalls.this.global.Tree">transform</a><a href="#3361552" title="(x: TailCalls.this.global.Tree)TailCalls.this.global.Tree" class="delimiter">(</a><a href="#1010604" title="TailCalls.this.global.Tree">tree</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  // collect the LabelDefs (generated by the pattern matcher) in a DefDef that are in tail position
  // the labels all look like: matchEnd(x) {x}
  // then, in a forward jump `matchEnd(expr)`, `expr` is considered in tail position (and the matchEnd jump is replaced by the jump generated by expr)
  <span class="keyword">class</span> <a title="class TailPosLabelsTraverser extends TailCalls.this.global.Traverser" id="621749">TailPosLabelsTraverser</a> <a href="#621749" title="TailCalls.this.TailPosLabelsTraverser" class="keyword">extends</a> <a href="../../../reflect/api/Trees.scala.html#56467" title="TailCalls.this.global.Traverser">Traverser</a> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[TailCalls.this.global.Symbol]" id="1010931">tailLabels</a> = <a href="../../../collection/mutable/HashSet.scala.html#125959" title="()scala.collection.mutable.HashSet[TailCalls.this.global.Symbol]" class="keyword">new</a> scala.collection.mutable.<a href="../../../collection/mutable/HashSet.scala.html#13053" title="scala.collection.mutable.HashSet[TailCalls.this.global.Symbol]">HashSet</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Boolean" id="1010934">maybeTail</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span> // since we start in the rhs of a DefDef

    <span class="keyword">def</span> <a title="(tree: TailCalls.this.global.Tree, maybeTailNew: Boolean)Unit" id="1010936">traverse</a><span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1011010">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a>, <a title="Boolean" id="1011011">maybeTailNew</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#1515" title="Unit">Unit</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Boolean" id="1011687">saved</a> = <a href="#1010934" title="=&gt; Boolean">maybeTail</a>
      <a href="#1010934" title="(x$1: Boolean)Unit">maybeTail</a> = <a href="#1011011" title="Boolean">maybeTailNew</a>
      <span class="keyword">try</span> <a href="#1010939" title="(tree: TailCalls.this.global.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#1011010" title="TailCalls.this.global.Tree">tree</a><span class="delimiter">)</span>
      <span class="keyword">finally</span> <a href="#1010934" title="(x$1: Boolean)Unit">maybeTail</a> = <a href="#1011687" title="Boolean">saved</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(tree: TailCalls.this.global.Tree)Unit" id="1010937">traverseNoTail</a><span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1011098">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a><span class="delimiter">)</span> = <a href="#1010936" title="(tree: TailCalls.this.global.Tree, maybeTailNew: Boolean)Unit">traverse</a><span class="delimiter">(</span><a href="#1011098" title="TailCalls.this.global.Tree">tree</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(trees: List[TailCalls.this.global.Tree])Unit" id="1010938">traverseTreesNoTail</a><span class="delimiter">(</span><a title="List[TailCalls.this.global.Tree]" id="1011078">trees</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[TailCalls.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#1011078" title="List[TailCalls.this.global.Tree]">trees</a> <a href="../../../collection/immutable/List.scala.html#62719" title="(f: TailCalls.this.global.Tree =&gt; Unit)Unit">foreach</a> <a href="#1010937" title="(tree: TailCalls.this.global.Tree)Unit">traverseNoTail</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: TailCalls.this.global.Tree)Unit" id="1010939">traverse</a><span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1010941">tree</a>: <a href="../../../reflect/internal/Trees.scala.html#407938" title="TailCalls.this.global.Tree">Tree</a><span class="delimiter">)</span> = <a href="#1010941" title="TailCalls.this.global.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      // we're looking for label(x){x} in tail position, since that means `a` is in tail position in a call `label(a)`
      <span class="keyword">case</span> LabelDef<a href="#3361595" title="Boolean" id="3361599" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410239" title="TailCalls.this.global.TermName" id="3361596">_</a>, <a href="../../../collection/generic/SeqFactory.scala.html#59986" title="Option[List[TailCalls.this.global.Ident]]" id="3361676">List</a><a href="../../../reflect/internal/Trees.scala.html#410241" title="List[TailCalls.this.global.Ident]" id="3361597" class="delimiter">(</a><a title="TailCalls.this.global.Ident" id="1010966">arg</a><span class="delimiter">)</span>, <a href="../../../reflect/internal/Trees.scala.html#410243" title="TailCalls.this.global.Tree" id="1010967">body</a>@Ident<a href="#1010967" title="Unit" id="3361605" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409987" title="TailCalls.this.global.Name" id="3361603">_</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#1010966" title="TailCalls.this.global.Ident">arg</a>.<a href="../../../reflect/internal/Trees.scala.html#409939" title="=&gt; TailCalls.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">==</span> body.<a href="../../../reflect/internal/Trees.scala.html#409939" title="=&gt; TailCalls.this.global.Symbol">symbol</a> =&gt;
        <a href="#3361672" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#1010934" title="=&gt; Boolean">maybeTail</a><span class="delimiter">)</span> <a href="#1010931" title="=&gt; scala.collection.mutable.HashSet[TailCalls.this.global.Symbol]">tailLabels</a> <a href="../../../collection/mutable/HashSet.scala.html#125963" title="(elem: TailCalls.this.global.Symbol)TailPosLabelsTraverser.this.tailLabels.type">+=</a> <a href="#1010941" title="TailCalls.this.global.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a>

      // jumps to matchEnd are transparent; need this case for nested matches
      // (and the translated match case below does things in reverse for this case's sake)
      <span class="keyword">case</span> Apply<a href="#3361595" title="Boolean" id="3361608" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410031" title="TailCalls.this.global.Tree" id="1010990">fun</a>, <a href="../../../collection/immutable/List.scala.html#206583" title="TailCalls.this.global.Tree" id="1010993">arg</a> <a href="../../../reflect/internal/Trees.scala.html#410033" title="List[TailCalls.this.global.Tree]" id="3361610">::</a> <a href="../../../collection/immutable/List.scala.html#206584" title="List[TailCalls.this.global.Tree]" id="3361666">Nil</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../../reflect/internal/TreeInfo.scala.html#479246" title="(t: TailCalls.this.global.treeInfo.global.Tree)Boolean">hasSynthCaseSymbol</a><span class="delimiter">(</span><a href="#1010990" title="TailCalls.this.global.Tree">fun</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../collection/GenSetLike.scala.html#66403" title="(elem: TailCalls.this.global.Symbol)Boolean">tailLabels</a><span class="delimiter">(</span><a href="#1010990" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a><span class="delimiter">)</span> =&gt;
        <a href="#1010939" title="(tree: TailCalls.this.global.Tree)Unit">traverse</a><a href="#3361672" title="(x: Unit)Unit" class="delimiter">(</a><a href="#1010993" title="TailCalls.this.global.Tree">arg</a><span class="delimiter">)</span>

      <span class="keyword">case</span> Apply<span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#410031" title="TailCalls.this.global.Tree" id="1011016">fun</a>, <a href="../../../reflect/internal/Trees.scala.html#410033" title="List[TailCalls.this.global.Tree]" id="1011017">args</a><span class="delimiter">)</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="#1011016" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Definitions.scala.html#409373" title="=&gt; TailCalls.this.global.TermSymbol">Boolean_or</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#1011016" title="TailCalls.this.global.Tree">fun</a>.<a href="../../../reflect/internal/Trees.scala.html#408577" title="=&gt; TailCalls.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Definitions.scala.html#409371" title="=&gt; TailCalls.this.global.TermSymbol">Boolean_and</a><span class="delimiter">)</span> =&gt;
        <a href="../../../reflect/api/Trees.scala.html#405545" title="(trees: List[TailCalls.this.global.Tree])Unit">traverseTrees</a><a href="#3361672" title="(x: Unit)Unit" class="delimiter">(</a><a href="#1011017" title="List[TailCalls.this.global.Tree]">args</a><span class="delimiter">)</span>

      // a translated casedef
      <span class="keyword">case</span> LabelDef<span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#410239" title="TailCalls.this.global.TermName" id="3361614">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410241" title="List[TailCalls.this.global.Ident]" id="3361615">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410243" title="TailCalls.this.global.Tree" id="1011034">body</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../../reflect/internal/TreeInfo.scala.html#479246" title="(t: TailCalls.this.global.treeInfo.global.Tree)Boolean">hasSynthCaseSymbol</a><span class="delimiter">(</span><a href="#1010941" title="TailCalls.this.global.Tree">tree</a><span class="delimiter">)</span> =&gt;
        <a href="#1010939" title="(tree: TailCalls.this.global.Tree)Unit">traverse</a><a href="#3361672" title="(x: Unit)Unit" class="delimiter">(</a><a href="#1011034" title="TailCalls.this.global.Tree">body</a><span class="delimiter">)</span>

      // a translated match
      <span class="keyword">case</span> Block<a href="#3361595" title="Boolean" id="3361619" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410192" title="List[TailCalls.this.global.Tree]" id="1011045">stats</a>, <a href="../../../reflect/internal/Trees.scala.html#410194" title="TailCalls.this.global.Tree" id="1011046">expr</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#1011045" title="List[TailCalls.this.global.Tree]">stats</a> <a href="../../../collection/LinearSeqOptimized.scala.html#86378" title="(p: TailCalls.this.global.Tree =&gt; Boolean)Boolean">forall</a> <a href="../../../reflect/internal/TreeInfo.scala.html#479246" title="(t: TailCalls.this.global.treeInfo.global.Tree)Boolean">hasSynthCaseSymbol</a> =&gt;
        // the assumption is once we encounter a case, the remainder of the block will consist of cases
        // the prologue may be empty, usually it is the valdef that stores the scrut
        <span class="keyword">val</span> <a href="#3361591" title="(x: (List[TailCalls.this.global.Tree], List[TailCalls.this.global.Tree]))(List[TailCalls.this.global.Tree], List[TailCalls.this.global.Tree])" class="delimiter">(</a><a href="../../../Tuple2.scala.html#60635" title="List[TailCalls.this.global.Tree]" id="1011055">prologue</a>, <a href="../../../Tuple2.scala.html#60637" title="List[TailCalls.this.global.Tree]" id="1011056">cases</a><span class="delimiter">)</span> = <a href="#1011045" title="List[TailCalls.this.global.Tree]">stats</a> <a href="../../../collection/immutable/List.scala.html#62715" title="(p: TailCalls.this.global.Tree =&gt; Boolean)(List[TailCalls.this.global.Tree], List[TailCalls.this.global.Tree])">span</a> <span class="delimiter">(</span><a title="TailCalls.this.global.Tree" id="1011062">s</a> =&gt; <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#1011062" title="TailCalls.this.global.Tree">s</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../../reflect/internal/Trees.scala.html#407969" title="TailCalls.this.global.LabelDef">LabelDef</a><span class="delimiter">]</span><span class="delimiter">)</span>
        <a href="#1010939" title="(tree: TailCalls.this.global.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#1011046" title="TailCalls.this.global.Tree">expr</a><span class="delimiter">)</span>
        <a href="../../../reflect/api/Trees.scala.html#405545" title="(trees: List[TailCalls.this.global.Tree])Unit">traverseTrees</a><span class="delimiter">(</span><a href="#1011056" title="List[TailCalls.this.global.Tree]">cases</a>.<a href="../../../collection/immutable/List.scala.html#62716" title="=&gt; List[TailCalls.this.global.Tree]">reverse</a><span class="delimiter">)</span>  // reverse so that we enter the matchEnd LabelDef before we see jumps to it
        <a href="#1010938" title="(trees: List[TailCalls.this.global.Tree])Unit">traverseTreesNoTail</a><span class="delimiter">(</span><a href="#1011055" title="List[TailCalls.this.global.Tree]">prologue</a><span class="delimiter">)</span> // selector (may be absent)

      <span class="keyword">case</span> CaseDef<a href="#3361595" title="Unit" id="3361621" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410180" title="TailCalls.this.global.Tree" id="1011115">pat</a>, <a href="../../../reflect/internal/Trees.scala.html#410182" title="TailCalls.this.global.Tree" id="1011116">guard</a>, <a href="../../../reflect/internal/Trees.scala.html#410184" title="TailCalls.this.global.Tree" id="1011117">body</a><span class="delimiter">)</span> =&gt;
        <a href="#1010939" title="(tree: TailCalls.this.global.Tree)Unit">traverse</a><a href="#3361672" title="(x: Unit)Unit" class="delimiter">(</a><a href="#1011117" title="TailCalls.this.global.Tree">body</a><span class="delimiter">)</span>

      <span class="keyword">case</span> Match<a href="#3361595" title="Unit" id="3361623" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410097" title="TailCalls.this.global.Tree" id="1011124">selector</a>, <a href="../../../reflect/internal/Trees.scala.html#410099" title="List[TailCalls.this.global.CaseDef]" id="1011125">cases</a><span class="delimiter">)</span> =&gt;
        <a href="#1010937" title="(tree: TailCalls.this.global.Tree)Unit">traverseNoTail</a><span class="delimiter">(</span><a href="#1011124" title="TailCalls.this.global.Tree">selector</a><span class="delimiter">)</span>
        <a href="../../../reflect/api/Trees.scala.html#405545" title="(trees: List[TailCalls.this.global.Tree])Unit">traverseTrees</a><span class="delimiter">(</span><a href="#1011125" title="List[TailCalls.this.global.CaseDef]">cases</a><span class="delimiter">)</span>

      <span class="keyword">case</span> dd @ DefDef<a href="#3361595" title="Unit" id="3361631" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410278" title="TailCalls.this.global.Modifiers" id="3361624">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410280" title="TailCalls.this.global.Name" id="3361625">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410282" title="List[TailCalls.this.global.TypeDef]" id="3361626">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410284" title="List[List[TailCalls.this.global.ValDef]]" id="3361627">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410286" title="TailCalls.this.global.Tree" id="3361628">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410288" title="TailCalls.this.global.Tree" id="3361629">_</a><span class="delimiter">)</span> =&gt; // we are run per-method

      <span class="keyword">case</span> Block<span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#410192" title="List[TailCalls.this.global.Tree]" id="1011139">stats</a>, <a href="../../../reflect/internal/Trees.scala.html#410194" title="TailCalls.this.global.Tree" id="1011140">expr</a><span class="delimiter">)</span> =&gt;
        <a href="#1010938" title="(trees: List[TailCalls.this.global.Tree])Unit">traverseTreesNoTail</a><span class="delimiter">(</span><a href="#1011139" title="List[TailCalls.this.global.Tree]">stats</a><span class="delimiter">)</span>
        <a href="#1010939" title="(tree: TailCalls.this.global.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#1011140" title="TailCalls.this.global.Tree">expr</a><span class="delimiter">)</span>

      <span class="keyword">case</span> If<a href="#3361595" title="Unit" id="3361635" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410107" title="TailCalls.this.global.Tree" id="1011148">cond</a>, <a href="../../../reflect/internal/Trees.scala.html#410109" title="TailCalls.this.global.Tree" id="1011149">thenp</a>, <a href="../../../reflect/internal/Trees.scala.html#410111" title="TailCalls.this.global.Tree" id="1011150">elsep</a><span class="delimiter">)</span> =&gt;
        <a href="#1010939" title="(tree: TailCalls.this.global.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#1011149" title="TailCalls.this.global.Tree">thenp</a><span class="delimiter">)</span>
        <a href="#1010939" title="(tree: TailCalls.this.global.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#1011150" title="TailCalls.this.global.Tree">elsep</a><span class="delimiter">)</span>

      <span class="keyword">case</span> Try<a href="#3361595" title="Unit" id="3361637" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410079" title="TailCalls.this.global.Tree" id="1011168">block</a>, <a href="../../../reflect/internal/Trees.scala.html#410081" title="List[TailCalls.this.global.CaseDef]" id="1011169">catches</a>, <a href="../../../reflect/internal/Trees.scala.html#410083" title="TailCalls.this.global.Tree" id="1011170">finalizer</a><span class="delimiter">)</span> =&gt;
        <a href="#1010937" title="(tree: TailCalls.this.global.Tree)Unit">traverseNoTail</a><span class="delimiter">(</span><a href="#1011168" title="TailCalls.this.global.Tree">block</a><span class="delimiter">)</span>
        <a href="#1010938" title="(trees: List[TailCalls.this.global.Tree])Unit">traverseTreesNoTail</a><span class="delimiter">(</span><a href="#1011169" title="List[TailCalls.this.global.CaseDef]">catches</a><span class="delimiter">)</span>
        <a href="#1010937" title="(tree: TailCalls.this.global.Tree)Unit">traverseNoTail</a><span class="delimiter">(</span><a href="#1011170" title="TailCalls.this.global.Tree">finalizer</a><span class="delimiter">)</span>

      <span class="keyword">case</span> Apply<a href="#3361595" title="Unit" id="3361641" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410031" title="TailCalls.this.global.Tree" id="3361638">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410033" title="List[TailCalls.this.global.Tree]" id="3361639">_</a><span class="delimiter">)</span> | <a href="../../../reflect/internal/Trees.scala.html#407946" title="Boolean" id="3361667">EmptyTree</a> | Super<a href="#3361595" title="Boolean" id="3361646" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410016" title="TailCalls.this.global.Tree" id="3361643">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410018" title="TailCalls.this.global.TypeName" id="3361644">_</a><span class="delimiter">)</span> | This<a href="#3361595" title="Boolean" id="3361649" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410008" title="TailCalls.this.global.TypeName" id="3361647">_</a><span class="delimiter">)</span> | Select<a href="#3361595" title="Boolean" id="3361653" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409999" title="TailCalls.this.global.Tree" id="3361650">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410001" title="TailCalls.this.global.Name" id="3361651">_</a><span class="delimiter">)</span> | Ident<a href="#3361595" title="Boolean" id="3361656" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409987" title="TailCalls.this.global.Name" id="3361654">_</a><span class="delimiter">)</span> | Literal<a href="#3361595" title="Boolean" id="3361659" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#409973" title="TailCalls.this.global.Constant" id="3361657">_</a><span class="delimiter">)</span> | Function<a href="#3361595" title="Boolean" id="3361663" class="delimiter">(</a><a href="../../../reflect/internal/Trees.scala.html#410136" title="List[TailCalls.this.global.ValDef]" id="3361660">_</a>, <a href="../../../reflect/internal/Trees.scala.html#410138" title="TailCalls.this.global.Tree" id="3361661">_</a><span class="delimiter">)</span> | TypeTree<a href="#3361595" title="Boolean" id="3361665" class="delimiter">(</a><span class="delimiter">)</span> =&gt;
      <span class="keyword">case</span> _ =&gt; <a href="#621749" title="TailCalls.this.TailPosLabelsTraverser" class="keyword">super</a>.<a href="../../../reflect/api/Trees.scala.html#405544" title="(tree: TailCalls.this.global.Tree)Unit">traverse</a><a href="#3361672" title="(x: Unit)Unit" class="delimiter">(</a><a href="#1010941" title="TailCalls.this.global.Tree">tree</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
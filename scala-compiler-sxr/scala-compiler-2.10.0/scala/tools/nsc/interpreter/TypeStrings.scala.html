<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/interpreter/TypeStrings.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2013 LAMP/EPFL
 * @author  Paul Phillips
 */

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interpreter

<span class="keyword">import</span> java.lang.<span class="delimiter">{</span> reflect =&gt; r <span class="delimiter">}</span>
<span class="keyword">import</span> r.TypeVariable
<span class="keyword">import</span> scala.reflect.NameTransformer
<span class="keyword">import</span> <a href="../../../reflect/NameTransformer.scala.html#2381" title="scala.reflect.NameTransformer.type">NameTransformer</a>._
<span class="keyword">import</span> scala.reflect.runtime.<span class="delimiter">{</span>universe =&gt; ru<span class="delimiter">}</span>
<span class="keyword">import</span> scala.reflect.<span class="delimiter">{</span>ClassTag, classTag<span class="delimiter">}</span>
<span class="keyword">import</span> typechecker.DestructureTypes
<span class="keyword">import</span> scala.reflect.internal.util.<a href="../../../reflect/internal/util/StringOps.scala.html#22972" title="scala.reflect.internal.util.StringOps.type">StringOps</a>.ojoin
<span class="keyword">import</span> scala.<a href="../../../language.scala.html#1423" title="language.type">language</a>.implicitConversions

/** A more principled system for turning types into strings.
 */
<span class="keyword">trait</span> <a title="trait StructuredTypeStrings extends Object with scala.tools.nsc.typechecker.DestructureTypes" id="38967">StructuredTypeStrings</a> <a href="../../../Unit.scala.html#1515" title="Unit" class="keyword">extends</a> <a href="../typechecker/DestructureTypes.scala.html#45464" title="scala.tools.nsc.typechecker.DestructureTypes">DestructureTypes</a> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="=&gt; scala.tools.nsc.Global" id="626594">global</a>: <a href="../Global.scala.html#27346" title="scala.tools.nsc.Global">Global</a>
  <span class="keyword">import</span> <a href="#626594" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="../../../reflect/internal/Definitions.scala.html#407777" title="StructuredTypeStrings.this.global.definitions.type">definitions</a>._

  case <span class="keyword">class</span> <a title="class LabelAndType extends AnyRef with Product with Serializable" id="914387">LabelAndType</a><a href="../../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="String" id="914384">label</a>: <span title="String">String</span>, <a title="String" id="914385">typeName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">}</span>
  <span class="keyword">object</span> <a title="StructuredTypeStrings.this.LabelAndType.type" id="914409">LabelAndType</a> <a href="#626599" title="StructuredTypeStrings.this.LabelAndType.type" class="delimiter">{</a>
    <span class="keyword">val</span> <a title="StructuredTypeStrings.this.LabelAndType" id="914379">empty</a> = <a href="#914387" title="(label: String, typeName: String)StructuredTypeStrings.this.LabelAndType">LabelAndType</a><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  case <span class="keyword">class</span> <a title="class Grouping extends AnyRef with Product with Serializable" id="915511">Grouping</a><a href="../../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="String" id="914315">ldelim</a>: <span title="String">String</span>, <a title="String" id="914316">mdelim</a>: <span title="String">String</span>, <a title="String" id="914317">rdelim</a>: <span title="String">String</span>, <a title="Boolean" id="914318">labels</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(elems: String*)String" id="914312">join</a><span class="delimiter">(</span><a title="String*" id="914419">elems</a>: <span title="String*">String</span>*<span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">(</span>
      <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#914419" title="String*">elems</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <span class="keyword">else</span> <a href="#914419" title="String*">elems</a>.<a href="../../../collection/TraversableOnce.scala.html#58282" title="(start: String, sep: String, end: String)String">mkString</a><span class="delimiter">(</span><a href="#914315" title="=&gt; String">ldelim</a>, <a href="#914316" title="=&gt; String">mdelim</a>, <a href="#914317" title="=&gt; String">rdelim</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">val</span> <a title="StructuredTypeStrings.this.Grouping" id="626603">NoGrouping</a>      = <a href="#915511" title="(ldelim: String, mdelim: String, rdelim: String, labels: Boolean)StructuredTypeStrings.this.Grouping">Grouping</a><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="StructuredTypeStrings.this.Grouping" id="626605">ListGrouping</a>    = <a href="#915511" title="(ldelim: String, mdelim: String, rdelim: String, labels: Boolean)StructuredTypeStrings.this.Grouping">Grouping</a><span class="delimiter">(</span><span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span>, <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span>, <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="StructuredTypeStrings.this.Grouping" id="626607">ProductGrouping</a> = <a href="#915511" title="(ldelim: String, mdelim: String, rdelim: String, labels: Boolean)StructuredTypeStrings.this.Grouping">Grouping</a><span class="delimiter">(</span><span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span>, <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span>, <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="StructuredTypeStrings.this.Grouping" id="626609">ParamGrouping</a>   = <a href="#915511" title="(ldelim: String, mdelim: String, rdelim: String, labels: Boolean)StructuredTypeStrings.this.Grouping">Grouping</a><span class="delimiter">(</span><span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span>, <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span>, <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="StructuredTypeStrings.this.Grouping" id="626611">BlockGrouping</a>   = <a href="#915511" title="(ldelim: String, mdelim: String, rdelim: String, labels: Boolean)StructuredTypeStrings.this.Grouping">Grouping</a><span class="delimiter">(</span><span title="String(&quot; { &quot;)" class="string">&quot; { &quot;</span>, <span title="String(&quot;; &quot;)" class="string">&quot;; &quot;</span>, <span title="String(&quot;}&quot;)" class="string">&quot;}&quot;</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.interpreter.StructuredTypeStrings.lowerName : (n: StructuredTypeStrings.this.global.Name)String" id="626613">lowerName</a><span class="delimiter">(</span><a title="StructuredTypeStrings.this.global.Name" id="914431">n</a>: <a href="../../../reflect/internal/Names.scala.html#406868" title="StructuredTypeStrings.this.global.Name">Name</a><span class="delimiter">)</span>: <span title="String">String</span> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#914431" title="StructuredTypeStrings.this.global.Name">n</a>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(level: Int)(body: =&gt; String)String" id="626614">str</a><span class="delimiter">(</span><a title="Int" id="914491">level</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; String" id="914492">body</a>: =&gt; String<span class="delimiter">)</span>: <span title="String">String</span> = <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;  &quot;</a> <a href="../../../collection/immutable/StringLike.scala.html#59852" title="(n: Int)String">*</a> <a href="#914491" title="Int">level</a> <span title="(x$1: Any)String">+</span> <a href="#914492" title="=&gt; String">body</a>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(level: Int, grouping: StructuredTypeStrings.this.Grouping)(name: String, nodes: List[StructuredTypeStrings.this.TypeNode])String" id="626615">block</a><span class="delimiter">(</span><a title="Int" id="914497">level</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="StructuredTypeStrings.this.Grouping" id="914498">grouping</a>: <a href="#915511" title="StructuredTypeStrings.this.Grouping">Grouping</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="String" id="914499">name</a>: <span title="String">String</span>, <a title="List[StructuredTypeStrings.this.TypeNode]" id="914500">nodes</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">[</span>TypeNode<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="914502">l1</a> = <a href="#626614" title="(level: Int)(body: =&gt; String)String">str</a><span class="delimiter">(</span><a href="#914497" title="Int">level</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#914499" title="String">name</a> <span title="(x$1: Any)String">+</span> <a href="#914498" title="StructuredTypeStrings.this.Grouping">grouping</a>.<a href="#914315" title="=&gt; String">ldelim</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="List[String]" id="914503">l2</a> = <a href="#914500" title="List[StructuredTypeStrings.this.TypeNode]">nodes</a>.<a href="../../../collection/TraversableLike.scala.html#58063" title="(f: StructuredTypeStrings.this.TypeNode =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[StructuredTypeStrings.this.TypeNode],String,List[String]])List[String]">map</a><a href="../../../collection/immutable/List.scala.html#62442" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">(</a><a href="#914521" title="StructuredTypeStrings.this.TypeNode">_</a> <a href="#914526" title="(indent: Int)String">show</a> <a href="#914497" title="Int">level</a> <a href="../../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="String" id="914504">l3</a> = <a href="#626614" title="(level: Int)(body: =&gt; String)String">str</a><span class="delimiter">(</span><a href="#914497" title="Int">level</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#914498" title="StructuredTypeStrings.this.Grouping">grouping</a>.<a href="#914317" title="=&gt; String">rdelim</a><span class="delimiter">)</span>

    <a href="#914502" title="String">l1</a> <a href="../../../collection/immutable/List.scala.html#62702" title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">+:</a> <a href="#914503" title="List[String]">l2</a> <a href="../../../collection/SeqLike.scala.html#58855" title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">:+</a> <a href="#914504" title="String">l3</a> <a href="../../../collection/TraversableOnce.scala.html#58283" title="(sep: String)String">mkString</a> <span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span>
  <span class="delimiter">}</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(level: Int, grouping: StructuredTypeStrings.this.Grouping)(name: String, nodes: List[StructuredTypeStrings.this.TypeNode])String" id="626616">maybeBlock</a><span class="delimiter">(</span><a title="Int" id="914682">level</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="StructuredTypeStrings.this.Grouping" id="914683">grouping</a>: <a href="#915511" title="StructuredTypeStrings.this.Grouping">Grouping</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="String" id="914684">name</a>: <span title="String">String</span>, <a title="List[StructuredTypeStrings.this.TypeNode]" id="914685">nodes</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">[</span>TypeNode<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#914683" title="StructuredTypeStrings.this.Grouping">grouping</a>._
    <span class="keyword">val</span> <a title="Int" id="914688">threshold</a> = <span title="Int(70)" class="int">70</span>

    <span class="keyword">val</span> <a title="String" id="914689">try1</a> = <a href="#626614" title="(level: Int)(body: =&gt; String)String">str</a><span class="delimiter">(</span><a href="#914682" title="Int">level</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#914684" title="String">name</a> <span title="(x$1: Any)String">+</span> <a href="#914683" title="StructuredTypeStrings.this.Grouping">grouping</a>.<a href="#914312" title="(elems: String*)String">join</a><span class="delimiter">(</span><a href="#914685" title="List[StructuredTypeStrings.this.TypeNode]">nodes</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: StructuredTypeStrings.this.TypeNode =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[StructuredTypeStrings.this.TypeNode],String,List[String]])List[String]">map</a> <span class="delimiter">(</span><a href="#914706" title="StructuredTypeStrings.this.TypeNode">_</a>.<a href="#914525" title="(indent: Int, showLabel: Boolean)String">show</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#914683" title="StructuredTypeStrings.this.Grouping">grouping</a>.<a href="#914318" title="=&gt; Boolean">labels</a><span class="delimiter">)</span><span class="delimiter">)</span>: _*<span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#914689" title="String">try1</a>.<span title="()Int">length</span> <a href="../../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="#914688" title="Int">threshold</a><span class="delimiter">)</span> <a href="#914689" title="String">try1</a>
    <span class="keyword">else</span> <a href="#626615" title="(level: Int, grouping: StructuredTypeStrings.this.Grouping)(name: String, nodes: List[StructuredTypeStrings.this.TypeNode])String">block</a><span class="delimiter">(</span><a href="#914682" title="Int">level</a>, <a href="#914683" title="StructuredTypeStrings.this.Grouping">grouping</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#914684" title="String">name</a>, <a href="#914685" title="List[StructuredTypeStrings.this.TypeNode]">nodes</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(x: Any)String" id="626617">shortClass</a><span class="delimiter">(</span><a title="Any" id="914741">x</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="../Global.scala.html#537522" title="StructuredTypeStrings.this.global.opt.type">opt</a>.<a href="../settings/AestheticSettings.scala.html#545408" title="=&gt; Boolean">debug</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="914744">name</a>   = <span class="delimiter">(</span><a href="#914741" title="Any">x</a>.<span title="()Class[_]">getClass</span>.<a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">getName</a> <a href="../../../Predef.scala.html#7555" title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]">split</a> <span title="Char('.')" class="char">'.'</span><span class="delimiter">)</span>.<a href="../../../collection/IndexedSeqOptimized.scala.html#59160" title="=&gt; String">last</a>
      <span class="keyword">val</span> <a title="Boolean" id="914745">isAnon</a> = <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">name</a>.<a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">reverse</a> <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">takeWhile</a> <span class="delimiter">(</span><a href="#914924" title="Char">_</a> <a href="../../../Char.scala.html#57253" title="(x: Char)Boolean">!=</a> <span title="Char('$')" class="char">'$'</span><span class="delimiter">)</span> <a href="../../../collection/IndexedSeqOptimized.scala.html#59124" title="(p: Char =&gt; Boolean)Boolean">forall</a> <span class="delimiter">(</span><a href="../../../LowPriorityImplicits.scala.html#7396" title="implicit scala.LowPriorityImplicits.charWrapper : (c: Char)scala.runtime.RichChar">_</a>.<a href="../../../runtime/RichChar.scala.html#57196" title="=&gt; Boolean">isDigit</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="String" id="914746">str</a>    = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#914745" title="Boolean">isAnon</a><span class="delimiter">)</span> <a href="#914744" title="String">name</a> <span class="keyword">else</span> <span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">name</a> <a href="../../../Predef.scala.html#7555" title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]">split</a> <span title="Char('$')" class="char">'$'</span><span class="delimiter">)</span>.<a href="../../../collection/IndexedSeqOptimized.scala.html#59160" title="=&gt; String">last</a>

      <span title="String(&quot; // &quot;)" class="string">&quot; // &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#914746" title="String">str</a>
    <span class="delimiter">}</span>
    <span class="keyword">else</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
  <span class="delimiter">}</span>

  <span class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class TypeNode extends Object" id="626618">TypeNode</a> <a href="#626618" title="StructuredTypeStrings.this.TypeNode" class="delimiter">{</a>
    <span class="keyword">def</span> <a title="=&gt; StructuredTypeStrings.this.Grouping" id="914523">grouping</a>: <a href="#915511" title="StructuredTypeStrings.this.Grouping">Grouping</a>
    <span class="keyword">def</span> <a title="=&gt; List[StructuredTypeStrings.this.TypeNode]" id="914524">nodes</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">[</span>TypeNode<span class="delimiter">]</span>

    <span class="keyword">def</span> <a title="(indent: Int, showLabel: Boolean)String" id="914525">show</a><span class="delimiter">(</span><a title="Int" id="914541">indent</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="Boolean" id="914542">showLabel</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#626616" title="(level: Int, grouping: StructuredTypeStrings.this.Grouping)(name: String, nodes: List[StructuredTypeStrings.this.TypeNode])String">maybeBlock</a><span class="delimiter">(</span><a href="#914541" title="Int">indent</a>, <a href="#914523" title="=&gt; StructuredTypeStrings.this.Grouping">grouping</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#914532" title="(showLabel: Boolean)String">mkPrefix</a><span class="delimiter">(</span><a href="#914542" title="Boolean">showLabel</a><span class="delimiter">)</span>, <a href="#914524" title="=&gt; List[StructuredTypeStrings.this.TypeNode]">nodes</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(indent: Int)String" id="914526">show</a><span class="delimiter">(</span><a title="Int" id="914540">indent</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#914525" title="(indent: Int, showLabel: Boolean)String">show</a><span class="delimiter">(</span><a href="#914540" title="Int">indent</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="()String" id="914527">show</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#914526" title="(indent: Int)String">show</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(l: String)TypeNode.this.type" id="914528">withLabel</a><span class="delimiter">(</span><a title="String" id="915091">l</a>: <span title="String">String</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <a href="#914537" title="(f: StructuredTypeStrings.this.LabelAndType =&gt; StructuredTypeStrings.this.LabelAndType)TypeNode.this.type">modifyNameInfo</a><span class="delimiter">(</span><a href="#915094" title="StructuredTypeStrings.this.LabelAndType">_</a>.<a href="#914387" title="(label: String, typeName: String)StructuredTypeStrings.this.LabelAndType">copy</a><span class="delimiter">(</span>label = <a href="#915091" title="String">l</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(t: String)TypeNode.this.type" id="914529">withType</a><span class="delimiter">(</span><a title="String" id="915103">t</a>: <span title="String">String</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span>  = <a href="#914537" title="(f: StructuredTypeStrings.this.LabelAndType =&gt; StructuredTypeStrings.this.LabelAndType)TypeNode.this.type">modifyNameInfo</a><span class="delimiter">(</span><a href="#915105" title="StructuredTypeStrings.this.LabelAndType">_</a>.<a href="#914384" title="String" id="915111">copy</a><span class="delimiter">(</span>typeName = <a href="#915103" title="String" id="915110">t</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="=&gt; String" id="914530">label</a>       = <a href="#914535" title="=&gt; StructuredTypeStrings.this.LabelAndType">nameInfo</a>.<a href="#914384" title="=&gt; String">label</a>
    <span class="keyword">def</span> <a title="=&gt; String" id="914531">typeName</a>    = <a href="#914535" title="=&gt; StructuredTypeStrings.this.LabelAndType">nameInfo</a>.<a href="#914385" title="=&gt; String">typeName</a>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(showLabel: Boolean)String" id="914532">mkPrefix</a><span class="delimiter">(</span><a title="Boolean" id="915076">showLabel</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="915077">pre</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#915076" title="Boolean">showLabel</a> <a href="../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#914530" title="=&gt; String">label</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <a href="#914530" title="=&gt; String">label</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; = &quot;)" class="string">&quot; = &quot;</span> <span class="keyword">else</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <a href="#915077" title="String">pre</a> <span title="(x$1: Any)String">+</span> <a href="#914531" title="=&gt; String">typeName</a>
    <span class="delimiter">}</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="914533">toString</a> = <a href="#914527" title="()String">show</a><span class="delimiter">(</span><span class="delimiter">)</span> // + &quot;(toString)&quot;
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="StructuredTypeStrings.this.LabelAndType" id="914535">nameInfo</a>: <a href="#914387" title="StructuredTypeStrings.this.LabelAndType">LabelAndType</a> = <a href="#914409" title="StructuredTypeStrings.this.LabelAndType.type">LabelAndType</a>.<a href="#914379" title="=&gt; StructuredTypeStrings.this.LabelAndType">empty</a>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(f: StructuredTypeStrings.this.LabelAndType =&gt; StructuredTypeStrings.this.LabelAndType)TypeNode.this.type" id="914537">modifyNameInfo</a><span class="delimiter">(</span><a title="StructuredTypeStrings.this.LabelAndType =&gt; StructuredTypeStrings.this.LabelAndType" id="915092">f</a>: LabelAndType =&gt; LabelAndType<span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
      <a href="#914535" title="(x$1: StructuredTypeStrings.this.LabelAndType)Unit">nameInfo</a> = <a href="../../../Function1.scala.html#58642" title="(v1: StructuredTypeStrings.this.LabelAndType)StructuredTypeStrings.this.LabelAndType">f</a><span class="delimiter">(</span><a href="#914535" title="=&gt; StructuredTypeStrings.this.LabelAndType">nameInfo</a><span class="delimiter">)</span>
      <a href="#626618" title="TypeNode.this.type" class="keyword">this</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  case <span class="keyword">class</span> <a href="#915157" title="class TypeAtom[T] extends StructuredTypeStrings.this.TypeNode with Product with Serializable" id="915544">TypeAtom</a><span class="delimiter">[</span><a title="" id="915519">T</a><span class="delimiter">]</span><a href="../../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="T" id="915523">atom</a>: <a href="#915519" title="T">T</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; StructuredTypeStrings.this.Grouping" id="915124">grouping</a> = <a href="#626603" title="=&gt; StructuredTypeStrings.this.Grouping">NoGrouping</a>
    <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Nil.type" id="915125">nodes</a> = <a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>
    <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(showLabel: Boolean)String" id="915126">mkPrefix</a><span class="delimiter">(</span><a title="Boolean" id="915139">showLabel</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> =
      <a href="#915544" title="StructuredTypeStrings.this.TypeAtom[T]" class="keyword">super</a>.<a href="#914532" title="(showLabel: Boolean)String">mkPrefix</a><span class="delimiter">(</span><a href="#915139" title="Boolean">showLabel</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <a href="#915523" title="=&gt; T">atom</a> <span title="(x$1: Any)String">+</span> <a href="#626617" title="(x: Any)String">shortClass</a><span class="delimiter">(</span><a href="#915523" title="=&gt; T">atom</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  case <span class="keyword">class</span> <a title="class TypeProduct extends StructuredTypeStrings.this.TypeNode with Product with Serializable" id="915575">TypeProduct</a><a href="../../../Product.scala.html#186" title="Product" class="delimiter">(</a><a title="List[StructuredTypeStrings.this.TypeNode]" id="915552">nodes</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">[</span>TypeNode<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; StructuredTypeStrings.this.Grouping" id="915177">grouping</a>: <a href="#915511" title="StructuredTypeStrings.this.Grouping">Grouping</a> = <a href="#626607" title="=&gt; StructuredTypeStrings.this.Grouping">ProductGrouping</a>
    <span class="keyword">def</span> <a title="=&gt; String" id="915178">emptyTypeName</a> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="915179">typeName</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#915552" title="=&gt; List[StructuredTypeStrings.this.TypeNode]">nodes</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#915178" title="=&gt; String">emptyTypeName</a> <span class="keyword">else</span> <a href="#915575" title="StructuredTypeStrings.this.TypeProduct" class="keyword">super</a>.<a href="#914531" title="=&gt; String">typeName</a>
  <span class="delimiter">}</span>

  /** For a NullaryMethod, in = TypeEmpty; for MethodType(Nil, _) in = TypeNil */
  <span class="keyword">class</span> <a title="class NullaryFunction extends StructuredTypeStrings.this.TypeProduct" id="626626">NullaryFunction</a><a href="#626626" title="StructuredTypeStrings.this.NullaryFunction" class="delimiter">(</a><a title="StructuredTypeStrings.this.TypeNode" id="915225">out</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#915575" title="StructuredTypeStrings.this.TypeProduct">TypeProduct</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#62451" title="(xs: StructuredTypeStrings.this.TypeNode*)List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">(</span><a href="#915225" title="StructuredTypeStrings.this.TypeNode">out</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="915222">typeName</a> = <span title="String(&quot;NullaryMethodType&quot;)" class="string">&quot;NullaryMethodType&quot;</span>
  <span class="delimiter">}</span>
  <span class="keyword">class</span> <a title="class MonoFunction extends StructuredTypeStrings.this.TypeProduct" id="626627">MonoFunction</a><a href="#626627" title="StructuredTypeStrings.this.MonoFunction" class="delimiter">(</a><a title="StructuredTypeStrings.this.TypeNode" id="915245">in</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a>, <a title="StructuredTypeStrings.this.TypeNode" id="915246">out</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#915575" title="StructuredTypeStrings.this.TypeProduct">TypeProduct</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#62451" title="(xs: StructuredTypeStrings.this.TypeNode*)List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">(</span><a href="#915245" title="StructuredTypeStrings.this.TypeNode">in</a>, <a href="#915246" title="StructuredTypeStrings.this.TypeNode">out</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="915241">typeName</a> = <span title="String(&quot;MethodType&quot;)" class="string">&quot;MethodType&quot;</span>
  <span class="delimiter">}</span>
  <span class="keyword">class</span> <a title="class PolyFunction extends StructuredTypeStrings.this.TypeProduct" id="626628">PolyFunction</a><a href="#626628" title="StructuredTypeStrings.this.PolyFunction" class="delimiter">(</a><a title="StructuredTypeStrings.this.TypeNode" id="915266">in</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a>, <a title="StructuredTypeStrings.this.TypeNode" id="915267">out</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#915575" title="StructuredTypeStrings.this.TypeProduct">TypeProduct</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#62451" title="(xs: StructuredTypeStrings.this.TypeNode*)List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">(</span><a href="#915266" title="StructuredTypeStrings.this.TypeNode">in</a>, <a href="#915267" title="StructuredTypeStrings.this.TypeNode">out</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="915262">typeName</a> = <span title="String(&quot;PolyType&quot;)" class="string">&quot;PolyType&quot;</span>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class TypeList extends StructuredTypeStrings.this.TypeProduct" id="626629">TypeList</a><a href="#626629" title="StructuredTypeStrings.this.TypeList" class="delimiter">(</a><a title="List[StructuredTypeStrings.this.TypeNode]" id="915286">nodes</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">[</span>TypeNode<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#915575" title="StructuredTypeStrings.this.TypeProduct">TypeProduct</a><span class="delimiter">(</span><a href="#915286" title="List[StructuredTypeStrings.this.TypeNode]">nodes</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; StructuredTypeStrings.this.Grouping" id="915281">grouping</a> = <a href="#626605" title="=&gt; StructuredTypeStrings.this.Grouping">ListGrouping</a>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="915282">emptyTypeName</a> = <span title="String(&quot;Nil&quot;)" class="string">&quot;Nil&quot;</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="915283">typeName</a> = <span title="String(&quot;List&quot;)" class="string">&quot;List&quot;</span>
  <span class="delimiter">}</span>
  <span class="keyword">class</span> <a title="class TypeScope extends StructuredTypeStrings.this.TypeProduct" id="626630">TypeScope</a><a href="#626630" title="StructuredTypeStrings.this.TypeScope" class="delimiter">(</a><a title="List[StructuredTypeStrings.this.TypeNode]" id="915301">nodes</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">[</span>TypeNode<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#915575" title="StructuredTypeStrings.this.TypeProduct">TypeProduct</a><span class="delimiter">(</span><a href="#915301" title="List[StructuredTypeStrings.this.TypeNode]">nodes</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; StructuredTypeStrings.this.Grouping" id="915296">grouping</a> = <a href="#626611" title="=&gt; StructuredTypeStrings.this.Grouping">BlockGrouping</a>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="915297">typeName</a> = <span title="String(&quot;Scope&quot;)" class="string">&quot;Scope&quot;</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="915298">emptyTypeName</a> = <span title="String(&quot;EmptyScope&quot;)" class="string">&quot;EmptyScope&quot;</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="StructuredTypeStrings.this.TypeEmpty.type" id="626631">TypeEmpty</a> <a href="#626632" title="StructuredTypeStrings.this.TypeEmpty.type" class="keyword">extends</a> <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; StructuredTypeStrings.this.Grouping" id="915309">grouping</a> = <a href="#626603" title="=&gt; StructuredTypeStrings.this.Grouping">NoGrouping</a>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Nil.type" id="915310">nodes</a> = <a href="../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="915311">label</a> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="915312">typeName</a> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(indent: Int, showLabel: Boolean)String" id="915313">show</a><span class="delimiter">(</span><a title="Int" id="915315">indent</a>: <a href="../../../Int.scala.html#321" title="Int">Int</a>, <a title="Boolean" id="915316">showLabel</a>: <a href="../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="StructuredTypeStrings.this.intoNodes.type" id="626633">intoNodes</a> <a href="#626634" title="StructuredTypeStrings.this.intoNodes.type" class="keyword">extends</a> <a href="../typechecker/DestructureTypes.scala.html#626591" title="StructuredTypeStrings.this.DestructureType[StructuredTypeStrings.this.TypeNode]">DestructureType</a><span class="delimiter">[</span>TypeNode<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(node: StructuredTypeStrings.this.TypeNode, label: String)StructuredTypeStrings.this.TypeNode" id="915378">withLabel</a><span class="delimiter">(</span><a title="StructuredTypeStrings.this.TypeNode" id="915389">node</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a>, <a title="String" id="915390">label</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a>   = <a href="#915389" title="StructuredTypeStrings.this.TypeNode">node</a> <a href="#914528" title="(l: String)node.type">withLabel</a> <a href="#915390" title="String">label</a>
    <span class="keyword">def</span> <a title="(node: StructuredTypeStrings.this.TypeNode, typeName: String)StructuredTypeStrings.this.TypeNode" id="915379">withType</a><span class="delimiter">(</span><a title="StructuredTypeStrings.this.TypeNode" id="915397">node</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a>, <a title="String" id="915398">typeName</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a> = <a href="#915397" title="StructuredTypeStrings.this.TypeNode">node</a> <a href="#914529" title="(t: String)node.type">withType</a> <a href="#915398" title="String">typeName</a>

    <span class="keyword">def</span> <a title="=&gt; StructuredTypeStrings.this.TypeEmpty.type" id="915380">wrapEmpty</a>                             = <a href="#626631" title="StructuredTypeStrings.this.TypeEmpty.type">TypeEmpty</a>
    <span class="keyword">def</span> <a title="(nodes: List[StructuredTypeStrings.this.TypeNode])StructuredTypeStrings.this.TypeList" id="915381">wrapSequence</a><span class="delimiter">(</span><a title="List[StructuredTypeStrings.this.TypeNode]" id="915410">nodes</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">[</span>TypeNode<span class="delimiter">]</span><span class="delimiter">)</span>   = <span title="StructuredTypeStrings.this.TypeList" class="keyword">new</span> <a href="#626629" title="StructuredTypeStrings.this.TypeList">TypeList</a><span class="delimiter">(</span><a href="#915410" title="List[StructuredTypeStrings.this.TypeNode]">nodes</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(nodes: List[StructuredTypeStrings.this.TypeNode])StructuredTypeStrings.this.TypeProduct" id="915382">wrapProduct</a><span class="delimiter">(</span><a title="List[StructuredTypeStrings.this.TypeNode]" id="915416">nodes</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[StructuredTypeStrings.this.TypeNode]">List</a><span class="delimiter">[</span>TypeNode<span class="delimiter">]</span><span class="delimiter">)</span>    = <span title="StructuredTypeStrings.this.TypeProduct" class="keyword">new</span> <a href="#915575" title="StructuredTypeStrings.this.TypeProduct">TypeProduct</a><span class="delimiter">(</span><a href="#915416" title="List[StructuredTypeStrings.this.TypeNode]">nodes</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(in: StructuredTypeStrings.this.TypeNode, out: StructuredTypeStrings.this.TypeNode)StructuredTypeStrings.this.PolyFunction" id="915383">wrapPoly</a><span class="delimiter">(</span><a title="StructuredTypeStrings.this.TypeNode" id="915422">in</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a>, <a title="StructuredTypeStrings.this.TypeNode" id="915423">out</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a><span class="delimiter">)</span> = <span title="StructuredTypeStrings.this.PolyFunction" class="keyword">new</span> <a href="#626628" title="StructuredTypeStrings.this.PolyFunction">PolyFunction</a><span class="delimiter">(</span><a href="#915422" title="StructuredTypeStrings.this.TypeNode">in</a>, <a href="#915423" title="StructuredTypeStrings.this.TypeNode">out</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(in: StructuredTypeStrings.this.TypeNode, out: StructuredTypeStrings.this.TypeNode)StructuredTypeStrings.this.TypeNode" id="915384">wrapMono</a><span class="delimiter">(</span><a title="StructuredTypeStrings.this.TypeNode" id="915431">in</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a>, <a title="StructuredTypeStrings.this.TypeNode" id="915432">out</a>: <a href="#626618" title="StructuredTypeStrings.this.TypeNode">TypeNode</a><span class="delimiter">)</span> = <span title="StructuredTypeStrings.this.TypeNode" class="keyword">if</span> <span class="delimiter">(</span><a href="#915431" title="StructuredTypeStrings.this.TypeNode">in</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#915380" title="=&gt; StructuredTypeStrings.this.TypeEmpty.type">wrapEmpty</a><span class="delimiter">)</span> <span title="StructuredTypeStrings.this.NullaryFunction" class="keyword">new</span> <a href="#626626" title="StructuredTypeStrings.this.NullaryFunction">NullaryFunction</a><span class="delimiter">(</span><a href="#915432" title="StructuredTypeStrings.this.TypeNode">out</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="StructuredTypeStrings.this.MonoFunction" class="keyword">new</span> <a href="#626627" title="StructuredTypeStrings.this.MonoFunction">MonoFunction</a><span class="delimiter">(</span><a href="#915431" title="StructuredTypeStrings.this.TypeNode">in</a>, <a href="#915432" title="StructuredTypeStrings.this.TypeNode">out</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[U](value: U)StructuredTypeStrings.this.TypeAtom[U]" id="915385">wrapAtom</a><span class="delimiter">[</span><a title="" id="915387">U</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="U" id="915444">value</a>: <a href="#915387" title="U">U</a><span class="delimiter">)</span>                 = <span title="StructuredTypeStrings.this.TypeAtom[U]" class="keyword">new</span> <a href="#915544" title="StructuredTypeStrings.this.TypeAtom[U]">TypeAtom</a><span class="delimiter">(</span><a href="#915444" title="U">value</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(tp: StructuredTypeStrings.this.global.Type)String" id="626635">show</a><span class="delimiter">(</span><a title="StructuredTypeStrings.this.global.Type" id="627293">tp</a>: <a href="../../../reflect/internal/Types.scala.html#407270" title="StructuredTypeStrings.this.global.Type">Type</a><span class="delimiter">)</span>: <span title="String">String</span> = <a href="../typechecker/DestructureTypes.scala.html#915376" title="(tp: StructuredTypeStrings.this.global.Type)StructuredTypeStrings.this.TypeNode">intoNodes</a><span class="delimiter">(</span><a href="#627293" title="StructuredTypeStrings.this.global.Type">tp</a><span class="delimiter">)</span>.<a href="#914527" title="()String">show</a>
<span class="delimiter">}</span>


/** Logic for turning a type into a String.  The goal is to be
 *  able to take some arbitrary object 'x' and obtain the most precise
 *  String for which an injection of x.asInstanceOf[String] will
 *  be valid from both the JVM's and scala's perspectives.
 *
 *  &quot;definition&quot; is when you want strings like
 */
<span class="keyword">trait</span> <a title="trait TypeStrings extends Object" id="37614">TypeStrings</a> <a href="../../../Unit.scala.html#1515" title="Unit" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Class[Object]" id="878476">ObjectClass</a> = classOf<span title="Class[Object](classOf[java.lang.Object])" class="delimiter">[</span>java.lang.Object<span class="delimiter">]</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.immutable.Set[String]" id="878478">primitives</a> = <a href="../../../collection/generic/GenericCompanion.scala.html#59933" title="[A](elems: A*)scala.collection.immutable.Set[A]">Set</a><span title="(elems: String*)scala.collection.immutable.Set[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><span class="delimiter">(</span><span title="String(&quot;byte&quot;)" class="string">&quot;byte&quot;</span>, <span title="String(&quot;char&quot;)" class="string">&quot;char&quot;</span>, <span title="String(&quot;short&quot;)" class="string">&quot;short&quot;</span>, <span title="String(&quot;int&quot;)" class="string">&quot;int&quot;</span>, <span title="String(&quot;long&quot;)" class="string">&quot;long&quot;</span>, <span title="String(&quot;float&quot;)" class="string">&quot;float&quot;</span>, <span title="String(&quot;double&quot;)" class="string">&quot;double&quot;</span>, <span title="String(&quot;boolean&quot;)" class="string">&quot;boolean&quot;</span>, <span title="String(&quot;void&quot;)" class="string">&quot;void&quot;</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,String]" id="878480">primitiveMap</a> = <a href="#878478" title="=&gt; scala.collection.immutable.Set[String]">primitives</a>.<a href="../../../collection/TraversableOnce.scala.html#58263" title="=&gt; List[String]">toList</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: String =&gt; (String, String))(implicit bf: scala.collection.generic.CanBuildFrom[List[String],(String, String),List[(String, String)]])List[(String, String)]">map</a> <span class="delimiter">{</span> <a title="String" id="915597">x</a> =&gt;
    <span class="keyword">val</span> <a title="String" id="915598">key</a> = <a href="#915597" title="String">x</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3334538" title="String" id="3334545" class="string">&quot;void&quot;</a> =&gt; <a href="#3334549" title="(x: String)String" class="string">&quot;Void&quot;</a>
      <span class="keyword">case</span> <a href="#3334538" title="String" id="3334546" class="string">&quot;int&quot;</a>  =&gt; <a href="#3334549" title="(x: String)String" class="string">&quot;Integer&quot;</a>
      <span class="keyword">case</span> <a href="#3334538" title="String" id="3334547" class="string">&quot;char&quot;</a> =&gt; <a href="#3334549" title="(x: String)String" class="string">&quot;Character&quot;</a>
      <span class="keyword">case</span> s      =&gt; <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<a href="#3334549" title="(x: String)String">capitalize</a>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="String" id="915599">value</a> = <a href="#915597" title="String">x</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#3334565" title="String" id="3334568" class="string">&quot;void&quot;</a> =&gt; <a href="#3334570" title="(x: String)String" class="string">&quot;Unit&quot;</a>
      <span class="keyword">case</span> s      =&gt; <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<a href="#3334570" title="(x: String)String">capitalize</a>
    <span class="delimiter">}</span>

    <span class="delimiter">(</span><span title="String(&quot;java.lang.&quot;)" class="string">&quot;java.lang.&quot;</span> <a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]">+</a> <a href="#915598" title="String">key</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span class="delimiter">(</span><span title="String(&quot;scala.&quot;)" class="string">&quot;scala.&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#915599" title="String">value</a><span class="delimiter">)</span>
  <span class="delimiter">}</span> <a href="../../../collection/TraversableOnce.scala.html#58277" title="(implicit ev: &lt;:&lt;[(String, String),(String, String)])scala.collection.immutable.Map[String,String]">toMap</a>

  <span class="keyword">def</span> <a title="(s: String)String" id="878482">scalaName</a><span class="delimiter">(</span><a title="String" id="915736">s</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#915736" title="String">s</a> <span title="(x$1: String)Boolean">endsWith</span> <a href="../../../reflect/NameTransformer.scala.html#86848" title="=&gt; String">MODULE_SUFFIX_STRING</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<a href="../../../collection/IndexedSeqOptimized.scala.html#59161" title="=&gt; String">init</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.type&quot;)" class="string">&quot;.type&quot;</span>
    <span class="keyword">else</span> <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#915736" title="String">s</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;void&quot;)" class="string">&quot;void&quot;</span><span class="delimiter">)</span> <span title="String(&quot;scala.Unit&quot;)" class="string">&quot;scala.Unit&quot;</span>
    <span class="keyword">else</span> <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../collection/GenSetLike.scala.html#66403" title="(elem: String)Boolean">primitives</a><span class="delimiter">(</span><a href="#915736" title="String">s</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="String(&quot;scala.&quot;)" class="string">&quot;scala.&quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<a href="../../../collection/immutable/StringLike.scala.html#59859" title="=&gt; String">capitalize</a>
    <span class="keyword">else</span> <a href="#878480" title="=&gt; scala.collection.immutable.Map[String,String]">primitiveMap</a>.<a href="../../../collection/MapLike.scala.html#87532" title="(key: String, default: =&gt; String)String">getOrElse</a><span class="delimiter">(</span><a href="#915736" title="String">s</a>, <a href="../../../reflect/NameTransformer.scala.html#2381" title="scala.reflect.NameTransformer.type">NameTransformer</a>.<a href="../../../reflect/NameTransformer.scala.html#86865" title="(name0: String)String">decode</a><span class="delimiter">(</span><a href="#915736" title="String">s</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  // Trying to put humpty dumpty back together again.
  <span class="keyword">def</span> <a title="(clazz: scala.tools.nsc.interpreter.JClass)String" id="878483">scalaName</a><span class="delimiter">(</span><a title="scala.tools.nsc.interpreter.JClass" id="915814">clazz</a>: <span title="scala.tools.nsc.interpreter.JClass">JClass</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="915815">name</a>      = <a href="#915814" title="scala.tools.nsc.interpreter.JClass">clazz</a>.<span title="()String">getName</span>
    <span class="keyword">val</span> <a title="Boolean" id="915816">isAnon</a>    = <a href="package.scala.html#55735" title="(clazz: Class[_$1])scala.tools.nsc.interpreter.RichClass[_$1]">clazz</a>.<a href="RichClass.scala.html#632719" title="=&gt; Boolean">isScalaAnonymous</a>
    <span class="keyword">val</span> <a title="Class[_]" id="915817">enclClass</a> = <a href="#915814" title="scala.tools.nsc.interpreter.JClass">clazz</a>.<span title="()Class[_]">getEnclosingClass</span>
    <span class="keyword">def</span> <a title="=&gt; String" id="915818">enclPre</a>   = <a href="#915817" title="Class[_]">enclClass</a>.<span title="()String">getName</span> <span title="(x$1: Any)String">+</span> <a href="../../../reflect/NameTransformer.scala.html#86848" title="=&gt; String">MODULE_SUFFIX_STRING</a>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="915819">enclMatch</a> = <a href="#915815" title="String">name</a> <span title="(x$1: String)Boolean">startsWith</span> <a href="#915818" title="=&gt; String">enclPre</a>

    <a href="#878482" title="(s: String)String">scalaName</a><span class="delimiter">(</span>
      <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#915817" title="Class[_]">enclClass</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#915816" title="Boolean">isAnon</a> <a href="../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#915819" title="=&gt; Boolean">enclMatch</a><span class="delimiter">)</span> <a href="#915815" title="String">name</a>
      <span class="keyword">else</span> <a href="#915817" title="Class[_]">enclClass</a>.<span title="()String">getName</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.&quot;)" class="string">&quot;.&quot;</span> <span title="(x$1: Any)String">+</span> <span class="delimiter">(</span><a href="../../../Predef.scala.html#7604" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">name</a> <a href="../../../collection/immutable/StringLike.scala.html#59860" title="(prefix: String)String">stripPrefix</a> <a href="#915818" title="=&gt; String">enclPre</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(ct: scala.reflect.ClassTag[_])String" id="878484">scalaName</a><span class="delimiter">(</span><a title="scala.reflect.ClassTag[_]" id="915838">ct</a>: <a href="../../../reflect/ClassTag.scala.html#2383" title="scala.reflect.ClassTag[_]">ClassTag</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#878483" title="(clazz: scala.tools.nsc.interpreter.JClass)String">scalaName</a><span class="delimiter">(</span><a href="#915838" title="scala.reflect.ClassTag[_]">ct</a>.<a href="../../../reflect/ClassTag.scala.html#62565" title="=&gt; Class[_]">runtimeClass</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(x: Any)scala.tools.nsc.interpreter.JClass" id="878485">anyClass</a><span class="delimiter">(</span><a title="Any" id="915867">x</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="scala.tools.nsc.interpreter.JClass">JClass</span>          = <span title="Class[?0]" class="keyword">if</span> <span class="delimiter">(</span><a href="#915867" title="Any">x</a> <span title="(x$1: Any)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="Null(null)" class="keyword">null</span> <span class="keyword">else</span> <a href="#915867" title="Any">x</a>.<span title="()Class[_]">getClass</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tps: String*)String" id="878486">brackets</a><span class="delimiter">(</span><a title="String*" id="915874">tps</a>: <span title="String*">String</span>*<span class="delimiter">)</span>: <span title="String">String</span> =
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#915874" title="String*">tps</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">else</span> <a href="#915874" title="String*">tps</a>.<a href="../../../collection/TraversableOnce.scala.html#58282" title="(start: String, sep: String, end: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;[&quot;)" class="string">&quot;[&quot;</span>, <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span>, <span title="String(&quot;]&quot;)" class="string">&quot;]&quot;</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tvar: java.lang.reflect.TypeVariable[_])String" id="878487">tvarString</a><span class="delimiter">(</span><a title="java.lang.reflect.TypeVariable[_]" id="915877">tvar</a>: <span title="java.lang.reflect.TypeVariable[_]">TypeVariable</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#878488" title="(bounds: List[AnyRef])String">tvarString</a><span class="delimiter">(</span><a href="#915877" title="java.lang.reflect.TypeVariable[_]">tvar</a>.<a href="../../../Predef.scala.html#7555" title="(xs: Array[java.lang.reflect.Type])scala.collection.mutable.ArrayOps[java.lang.reflect.Type]">getBounds</a>.<a href="../../../collection/TraversableOnce.scala.html#58263" title="=&gt; List[java.lang.reflect.Type]">toList</a><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(bounds: List[AnyRef])String" id="878488">tvarString</a><span class="delimiter">(</span><a title="List[AnyRef]" id="915885">bounds</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[AnyRef]">List</a><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[Class[_]]" id="915955">xs</a> = <a href="#915885" title="List[AnyRef]">bounds</a> <a href="../../../collection/TraversableLike.scala.html#58074" title="(p: AnyRef =&gt; Boolean)List[AnyRef]">filterNot</a> <span class="delimiter">(</span><a href="#915959" title="AnyRef">_</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#878476" title="=&gt; Class[Object]">ObjectClass</a><span class="delimiter">)</span> <a href="../../../collection/TraversableLike.scala.html#58075" title="(pf: PartialFunction[AnyRef,Class[_]])(implicit bf: scala.collection.generic.CanBuildFrom[List[AnyRef],Class[_],List[Class[_]]])List[Class[_]]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[AnyRef,Class[_]] with Serializable" id="915998" class="delimiter">{</a> <span class="keyword">case</span> <a href="#3334578" title="B1" id="3334616">x</a>: JClass =&gt; <a href="#3334599" title="(x: B1)B1">x</a> <span class="delimiter">}</span>
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#915955" title="List[Class[_]]">xs</a>.<a href="../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span title="String(&quot;_&quot;)" class="string">&quot;_&quot;</span>
    <span class="keyword">else</span> <a href="#878483" title="(clazz: scala.tools.nsc.interpreter.JClass)String">scalaName</a><span class="delimiter">(</span><a href="#915955" title="List[Class[_]]">xs</a>.<a href="../../../collection/IterableLike.scala.html#58577" title="=&gt; Class[_]">head</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: scala.tools.nsc.interpreter.JClass)String" id="878489">tparamString</a><span class="delimiter">(</span><a title="scala.tools.nsc.interpreter.JClass" id="916076">clazz</a>: <span title="scala.tools.nsc.interpreter.JClass">JClass</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <a href="#878486" title="(tps: String*)String">brackets</a><span class="delimiter">(</span><a href="#916076" title="scala.tools.nsc.interpreter.JClass">clazz</a>.<a href="../../../Predef.scala.html#7555" title="(xs: Array[java.lang.reflect.TypeVariable[Class[_$1]]])scala.collection.mutable.ArrayOps[java.lang.reflect.TypeVariable[Class[_$1]]]">getTypeParameters</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: java.lang.reflect.TypeVariable[Class[_$1]] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Array[java.lang.reflect.TypeVariable[Class[_$1]]],String,Array[String]])Array[String]">map</a> <a href="#878487" title="(tvar: java.lang.reflect.TypeVariable[_])String">tvarString</a>: _*<span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](implicit evidence$1: reflect.runtime.universe.TypeTag[T])String" id="916521">tparamString</a><span class="delimiter">[</span><a title="" id="878492">T</a>: ru.TypeTag<span class="delimiter">]</span> : <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; List[reflect.runtime.universe.Type]" id="916523">typeArguments</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[reflect.runtime.universe.Type]">List</a><span class="delimiter">[</span>ru.Type<span class="delimiter">]</span> = <a href="../../../reflect/runtime/package.scala.html#55653" title="=&gt; scala.reflect.api.JavaUniverse">ru</a>.<a href="../../../reflect/api/TypeTags.scala.html#56558" title="[T](implicit ttag: reflect.runtime.universe.TypeTag[T])reflect.runtime.universe.Type">typeOf</a><a href="#916521" title="(implicit ttag: reflect.runtime.universe.TypeTag[T])reflect.runtime.universe.Type" class="delimiter">[</a><a href="#878492" title="T">T</a><span class="delimiter">]</span> <span class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a href="../../../reflect/runtime/package.scala.html#55653" title="=&gt; scala.reflect.api.JavaUniverse">ru</a>.<a href="../../../reflect/api/Types.scala.html#406411" title="Option[(reflect.runtime.universe.Type, reflect.runtime.universe.Symbol, List[reflect.runtime.universe.Type])]" id="3334646">TypeRef</a><a href="#3334632" title="List[reflect.runtime.universe.Type]" id="3334638" class="delimiter">(</a><a href="../../../Tuple3.scala.html#60576" title="reflect.runtime.universe.Type" id="3334633">_</a>, <a href="../../../Tuple3.scala.html#60578" title="reflect.runtime.universe.Symbol" id="3334634">_</a>, <a href="../../../Tuple3.scala.html#60580" title="List[reflect.runtime.universe.Type]" id="916533">args</a><span class="delimiter">)</span> =&gt; <a href="#3334642" title="(x: List[reflect.runtime.universe.Type])List[reflect.runtime.universe.Type]">args</a>; <span class="keyword">case</span> _ =&gt; <a href="#3334642" title="(x: List[reflect.runtime.universe.Type])List[reflect.runtime.universe.Type]">Nil</a> <span class="delimiter">}</span>
    // [Eugene to Paul] need to use not the `rootMirror`, but a mirror with the REPL's classloader
    // how do I get to it? acquiring context classloader seems unreliable because of multithreading
    <span class="keyword">def</span> <a title="=&gt; List[Class[_]]" id="916524">typeVariables</a>: <a href="../../../collection/immutable/List.scala.html#11952" title="List[Class[_]]">List</a><span class="delimiter">[</span>java.lang.Class<span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#916523" title="=&gt; List[reflect.runtime.universe.Type]">typeArguments</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: reflect.runtime.universe.Type =&gt; Class[_])(implicit bf: scala.collection.generic.CanBuildFrom[List[reflect.runtime.universe.Type],Class[_],List[Class[_]]])List[Class[_]]">map</a> <span class="delimiter">(</span><a title="reflect.runtime.universe.Type" id="916559">targ</a> =&gt; <a href="../../../reflect/runtime/package.scala.html#55653" title="=&gt; scala.reflect.api.JavaUniverse">ru</a>.<a href="../../../reflect/api/Mirrors.scala.html#56588" title="=&gt; reflect.runtime.universe.Mirror">rootMirror</a>.<a href="../../../reflect/api/Mirrors.scala.html#403045" title="(tpe: reflect.runtime.universe.Type)reflect.runtime.universe.RuntimeClass">runtimeClass</a><span class="delimiter">(</span><a href="#916559" title="reflect.runtime.universe.Type">targ</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#878486" title="(tps: String*)String">brackets</a><span class="delimiter">(</span><a href="#916523" title="=&gt; List[reflect.runtime.universe.Type]">typeArguments</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: reflect.runtime.universe.Type =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[reflect.runtime.universe.Type],String,List[String]])List[String]">map</a> <span class="delimiter">(</span><a title="reflect.runtime.universe.Type" id="916632">jc</a> =&gt; <a href="#878488" title="(bounds: List[AnyRef])String">tvarString</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#62451" title="(xs: reflect.runtime.universe.Type*)List[reflect.runtime.universe.Type]">List</a><span class="delimiter">(</span><a href="#916632" title="reflect.runtime.universe.Type">jc</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>: _*<span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Going for an overabundance of caution right now.  Later these types
   *  can be a lot more precise, but right now the tags have a habit of
   *  introducing material which is not syntactically valid as scala source.
   *  When this happens it breaks the repl.  It would be nice if we mandated
   *  that tag toString methods (or some other method, since it's bad
   *  practice to rely on toString for correctness) generated the VALID string
   *  representation of the type.
   */
  <span class="keyword">def</span> <a title="[T](x: T)(implicit evidence$2: reflect.runtime.universe.TypeTag[T], implicit evidence$3: scala.reflect.ClassTag[T])String" id="916678">fromTypedValue</a><span class="delimiter">[</span><a title="" id="878495">T</a>: ru.TypeTag : ClassTag<span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="916676">x</a>: <a href="#878495" title="T">T</a><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#899651" title="[T](implicit evidence$4: reflect.runtime.universe.TypeTag[T], implicit evidence$5: scala.reflect.ClassTag[T])String">fromTag</a><a href="#916678" title="(implicit evidence$4: reflect.runtime.universe.TypeTag[T], implicit evidence$5: scala.reflect.ClassTag[T])String" class="delimiter">[</a><a href="#878495" title="T">T</a><span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="(value: Any)String" id="878496">fromValue</a><span class="delimiter">(</span><a title="Any" id="888115">value</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="String">String</span>                          = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#888115" title="Any">value</a> <span title="(x$1: Any)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="String(&quot;Null&quot;)" class="string">&quot;Null&quot;</span> <span class="keyword">else</span> <a href="#878497" title="(clazz: scala.tools.nsc.interpreter.JClass)String">fromClazz</a><span class="delimiter">(</span><a href="#878485" title="(x: Any)scala.tools.nsc.interpreter.JClass">anyClass</a><span class="delimiter">(</span><a href="#888115" title="Any">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(clazz: scala.tools.nsc.interpreter.JClass)String" id="878497">fromClazz</a><span class="delimiter">(</span><a title="scala.tools.nsc.interpreter.JClass" id="913741">clazz</a>: <span title="scala.tools.nsc.interpreter.JClass">JClass</span><span class="delimiter">)</span>: <span title="String">String</span>                       = <a href="#878483" title="(clazz: scala.tools.nsc.interpreter.JClass)String">scalaName</a><span class="delimiter">(</span><a href="#913741" title="scala.tools.nsc.interpreter.JClass">clazz</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <a href="#878489" title="(clazz: scala.tools.nsc.interpreter.JClass)String">tparamString</a><span class="delimiter">(</span><a href="#913741" title="scala.tools.nsc.interpreter.JClass">clazz</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[T](implicit evidence$4: reflect.runtime.universe.TypeTag[T], implicit evidence$5: scala.reflect.ClassTag[T])String" id="899651">fromTag</a><span class="delimiter">[</span><a title="" id="878500">T</a>: ru.TypeTag : ClassTag<span class="delimiter">]</span> : <span title="String">String</span>             = <a href="#878483" title="(clazz: scala.tools.nsc.interpreter.JClass)String">scalaName</a><span class="delimiter">(</span><a href="../../../reflect/package.scala.html#55632" title="[T](implicit ctag: scala.reflect.ClassTag[T])scala.reflect.ClassTag[T]">classTag</a><a href="#899651" title="(implicit ctag: scala.reflect.ClassTag[T])scala.reflect.ClassTag[T]" class="delimiter">[</a><a href="#878500" title="T">T</a><span class="delimiter">]</span>.<a href="../../../reflect/ClassTag.scala.html#62565" title="=&gt; Class[_]">runtimeClass</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <a href="#916521" title="[T](implicit evidence$1: reflect.runtime.universe.TypeTag[T])String">tparamString</a><a href="#899651" title="(implicit evidence$1: reflect.runtime.universe.TypeTag[T])String" class="delimiter">[</a><a href="#878500" title="T">T</a><span class="delimiter">]</span>

  /** Reducing fully qualified noise for some common packages.
   */
  <span class="keyword">def</span> <a title="(tpe: String, alsoStrip: String*)String" id="878501">quieter</a><span class="delimiter">(</span><a title="String" id="878505">tpe</a>: <span title="String">String</span>, <a title="String*" id="878506">alsoStrip</a>: <span title="String*">String</span>*<span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[(String, String)]" id="916730">transforms</a> = <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: (String, String)*)List[(String, String)]">List</a><span class="delimiter">(</span>
      <a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]" class="string">&quot;scala.collection.immutable.&quot;</a> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span title="String(&quot;immutable.&quot;)" class="string">&quot;immutable.&quot;</span>,
      <a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]" class="string">&quot;scala.collection.mutable.&quot;</a> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span title="String(&quot;mutable.&quot;)" class="string">&quot;mutable.&quot;</span>,
      <a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]" class="string">&quot;scala.collection.generic.&quot;</a> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span title="String(&quot;generic.&quot;)" class="string">&quot;generic.&quot;</span>,
      <a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]" class="string">&quot;java.lang.&quot;</a> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span title="String(&quot;jl.&quot;)" class="string">&quot;jl.&quot;</span>,
      <a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]" class="string">&quot;scala.runtime.&quot;</a> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span title="String(&quot;runtime.&quot;)" class="string">&quot;runtime.&quot;</span>
    <span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#62697" title="(that: scala.collection.GenTraversableOnce[(String, String)])(implicit bf: scala.collection.generic.CanBuildFrom[List[(String, String)],(String, String),List[(String, String)]])List[(String, String)]">++</a> <span class="delimiter">(</span><a href="#878506" title="String*">alsoStrip</a> <a href="../../../collection/TraversableLike.scala.html#58063" title="(f: String =&gt; (String, String))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],(String, String),Seq[(String, String)]])Seq[(String, String)]">map</a> <span class="delimiter">(</span><a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]">_</a> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <a href="#916730" title="List[(String, String)]">transforms</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#86382" title="(z: String)(f: (String, (String, String)) =&gt; String)String">foldLeft</a><span class="delimiter">(</span><a href="#878505" title="String">tpe</a><span class="delimiter">)</span> <a href="../../../Tuple2.scala.html#62849" title="(_1: String, _2: (String, String))(String, (String, String))" class="delimiter">{</a>
      <span class="keyword">case</span> <span class="delimiter">(</span><a href="../../../Tuple2.scala.html#60635" title="String" id="916954">res</a>, <a href="../../../Tuple2.scala.html#60637" title="(String, String)" id="3334655" class="delimiter">(</a><a href="../../../Tuple2.scala.html#60635" title="String" id="916957">k</a>, <a href="../../../Tuple2.scala.html#60637" title="String" id="916958">v</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#916954" title="String">res</a>.<span title="(x$1: String, x$2: String)String">replaceAll</span><a href="#3334657" title="(x: String)String" class="delimiter">(</a><a href="#916957" title="String">k</a>, <a href="#916958" title="String">v</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="List[(String, String)]" id="878502">typeTransforms</a> = <a href="../../../collection/immutable/List.scala.html#62451" title="(xs: (String, String)*)List[(String, String)]">List</a><span class="delimiter">(</span>
    <a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]" class="string">&quot;java.lang.&quot;</a> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>,
    <a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]" class="string">&quot;scala.collection.immutable.&quot;</a> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span title="String(&quot;immutable.&quot;)" class="string">&quot;immutable.&quot;</span>,
    <a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]" class="string">&quot;scala.collection.mutable.&quot;</a> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span title="String(&quot;mutable.&quot;)" class="string">&quot;mutable.&quot;</span>,
    <a href="../../../Predef.scala.html#7509" title="(x: String)ArrowAssoc[String]" class="string">&quot;scala.collection.generic.&quot;</a> <a href="../../../Predef.scala.html#62634" title="(y: String)(String, String)">-&gt;</a> <span title="String(&quot;generic.&quot;)" class="string">&quot;generic.&quot;</span>
  <span class="delimiter">)</span>
<span class="delimiter">}</span>

<span title="Object" class="keyword">object</span> <a title="scala.tools.nsc.interpreter.TypeStrings.type" id="37615">TypeStrings</a> <a href="#37616" title="scala.tools.nsc.interpreter.TypeStrings.type" class="keyword">extends</a> <a href="#37614" title="scala.tools.nsc.interpreter.TypeStrings">TypeStrings</a> <span class="delimiter">{</span> <span class="delimiter">}</span>

        </pre>
    </body>
</html>
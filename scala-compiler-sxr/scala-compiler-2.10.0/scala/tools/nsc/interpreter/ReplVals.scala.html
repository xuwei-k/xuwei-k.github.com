<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/interpreter/ReplVals.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2013 LAMP/EPFL
 * @author Paul Phillips
 */

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interpreter

<span class="keyword">import</span> scala.<a href="../../../language.scala.html#1423" title="language.type">language</a>.implicitConversions
<span class="keyword">import</span> scala.reflect.api.<span class="delimiter">{</span>Universe =&gt; ApiUniverse<span class="delimiter">}</span>
<span class="keyword">import</span> scala.reflect.runtime.<span class="delimiter">{</span>universe =&gt; ru<span class="delimiter">}</span>

/** A class which the repl utilizes to expose predefined objects.
 *  The base implementation is empty; the standard repl implementation
 *  is StdReplVals.
 */
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class ReplVals extends Object" id="37698">ReplVals</a> <a href="#37698" title="scala.tools.nsc.interpreter.ReplVals" class="delimiter">{</a> <span class="delimiter">}</span>

<span title="Object" class="keyword">class</span> <a title="class StdReplVals extends scala.tools.nsc.interpreter.ReplVals" id="39084">StdReplVals</a><a href="#39084" title="scala.tools.nsc.interpreter.StdReplVals" class="delimiter">(</a><span class="keyword">final</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.ILoop" id="875808">r</a>: <a href="ILoop.scala.html#37218" title="scala.tools.nsc.interpreter.ILoop">ILoop</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#37698" title="scala.tools.nsc.interpreter.ReplVals">ReplVals</a> <span class="delimiter">{</span>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.ILoop" id="875776">repl</a>                     = <a href="#875808" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.IMain" id="875778">intp</a>                     = <a href="#875808" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>.<a href="ILoop.scala.html#632786" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]" id="875780">power</a>                    = <a href="#875808" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>.<a href="ILoop.scala.html#632800" title="=&gt; scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]">power</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.InteractiveReader" id="875782">reader</a>                   = <a href="#875808" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>.<a href="ILoop.scala.html#632780" title="=&gt; scala.tools.nsc.interpreter.InteractiveReader">in</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.StdReplVals" id="875784">vals</a>                     = <a href="#39084" title="scala.tools.nsc.interpreter.StdReplVals" class="keyword">this</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="StdReplVals.this.intp.global.type" id="875786">global</a>: intp.global.<span class="keyword">type</span> = <a href="#875777" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#632489" title="=&gt; scala.tools.nsc.Global">global</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.ISettings" id="875788">isettings</a>                = <a href="#875777" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#632521" title="=&gt; scala.tools.nsc.interpreter.ISettings">isettings</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.Completion" id="875790">completion</a>               = <a href="#875781" title="=&gt; scala.tools.nsc.interpreter.InteractiveReader">reader</a>.<a href="InteractiveReader.scala.html#875584" title="=&gt; scala.tools.nsc.interpreter.Completion">completion</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.session.History" id="875792">history</a>                  = <a href="#875781" title="=&gt; scala.tools.nsc.interpreter.InteractiveReader">reader</a>.<a href="InteractiveReader.scala.html#875583" title="=&gt; scala.tools.nsc.interpreter.session.History">history</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.Phased" id="875794">phased</a>                   = <a href="#875779" title="=&gt; scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]">power</a>.<a href="Power.scala.html#875751" title="=&gt; scala.tools.nsc.interpreter.Phased">phased</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="analyzer extends Object with scala.tools.nsc.typechecker.Analyzer" id="875796">analyzer</a>                 = <a href="#875785" title="=&gt; StdReplVals.this.intp.global.type">global</a>.<a href="../Global.scala.html#537550" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: StdReplVals.this.global.type}">analyzer</a>

  <span class="keyword">object</span> <a title="StdReplVals.this.treedsl.type" id="875797">treedsl</a> <a href="#875798" title="StdReplVals.this.treedsl.type" class="keyword">extends</a> <span class="delimiter">{</span> <span class="keyword">val</span> <a title="StdReplVals.this.intp.global.type" id="913368">global</a>: intp.global.<span class="keyword">type</span> = <a href="#875777" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#632489" title="=&gt; scala.tools.nsc.Global">global</a> <span class="delimiter">}</span> <span class="keyword">with</span> ast.<a href="../ast/TreeDSL.scala.html#28843" title="scala.tools.nsc.ast.TreeDSL">TreeDSL</a> <span class="delimiter">{</span> <span class="delimiter">}</span>

  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="StdReplVals.this.analyzer.Typer" id="875800">typer</a> = <a href="#875795" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: StdReplVals.this.global.type}">analyzer</a>.<a href="../typechecker/Typers.scala.html#538108" title="(context: StdReplVals.this.analyzer.Context)StdReplVals.this.analyzer.Typer">newTyper</a><span class="delimiter">(</span>
    <a href="#875795" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: StdReplVals.this.global.type}">analyzer</a>.<a href="../typechecker/Contexts.scala.html#537987" title="(unit: StdReplVals.this.analyzer.global.CompilationUnit)StdReplVals.this.analyzer.Context">rootContext</a><span class="delimiter">(</span>
      <a href="#875779" title="=&gt; scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]">power</a>.<a href="Power.scala.html#875755" title="(code: String)StdReplVals.this.power.intp.global.CompilationUnit">unit</a><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="StdReplVals.this.analyzer.global.CompilationUnit" class="delimiter">[</span>analyzer.global.<a href="../CompilationUnits.scala.html#537766" title="StdReplVals.this.analyzer.global.CompilationUnit">CompilationUnit</a><span class="delimiter">]</span>
    <span class="delimiter">)</span>
  <span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; StdReplVals.this.intp.Request" id="875801">lastRequest</a> = <a href="#875777" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#632638" title="=&gt; StdReplVals.this.intp.Request">lastRequest</a>

  <span class="keyword">class</span> <a title="class ReplImplicits extends Object with StdReplVals.this.power.Implicits2" id="875802">ReplImplicits</a> <a href="#875802" title="StdReplVals.this.ReplImplicits" class="keyword">extends</a> power.<a href="Power.scala.html#875747" title="StdReplVals.this.power.Implicits2">Implicits2</a> <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#875777" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#632489" title="=&gt; scala.tools.nsc.Global">global</a>._

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="StdReplVals.this.global.Symbol =&gt; Object{def apply[M](implicit m1: reflect.runtime.universe.TypeTag[M]): StdReplVals.this.global.Type; def apply[M1, M2](implicit m1: reflect.runtime.universe.TypeTag[M1],implicit m2: reflect.runtime.universe.TypeTag[M2]): StdReplVals.this.global.Type}" id="913380">tagFn</a> = <a href="#37699" title="scala.tools.nsc.interpreter.ReplVals.type">ReplVals</a>.<a href="#913385" title="[T &lt;: scala.tools.nsc.Global](global: T)global.Symbol =&gt; Object{def apply[M](implicit m1: reflect.runtime.universe.TypeTag[M]): global.Type; def apply[M1, M2](implicit m1: reflect.runtime.universe.TypeTag[M1],implicit m2: reflect.runtime.universe.TypeTag[M2]): global.Type}">mkCompilerTypeFromTag</a><span title="(global: StdReplVals.this.intp.global.type)global.Symbol =&gt; Object{def apply[M](implicit m1: reflect.runtime.universe.TypeTag[M]): global.Type; def apply[M1, M2](implicit m1: reflect.runtime.universe.TypeTag[M1],implicit m2: reflect.runtime.universe.TypeTag[M2]): global.Type}" class="delimiter">[</span>intp.global.<span class="keyword">type</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#875785" title="=&gt; StdReplVals.this.intp.global.type">global</a><span class="delimiter">)</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.interpreter.StdReplVals.ReplImplicits.mkCompilerTypeFromTag : (sym: StdReplVals.this.intp.global.Symbol)Object{def apply[M](implicit m1: reflect.runtime.universe.TypeTag[M]): StdReplVals.this.global.Type; def apply[M1, M2](implicit m1: reflect.runtime.universe.TypeTag[M1],implicit m2: reflect.runtime.universe.TypeTag[M2]): StdReplVals.this.global.Type}" id="913382">mkCompilerTypeFromTag</a><span class="delimiter">(</span><a title="StdReplVals.this.intp.global.Symbol" id="913615">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="StdReplVals.this.intp.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="../../../Function1.scala.html#58642" title="(v1: StdReplVals.this.global.Symbol)Object{def apply[M](implicit m1: reflect.runtime.universe.TypeTag[M]): StdReplVals.this.global.Type; def apply[M1, M2](implicit m1: reflect.runtime.universe.TypeTag[M1],implicit m2: reflect.runtime.universe.TypeTag[M2]): StdReplVals.this.global.Type}">tagFn</a><span class="delimiter">(</span><a href="#913615" title="StdReplVals.this.intp.global.Symbol">sym</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="StdReplVals.this.ReplImplicits" id="875804">replImplicits</a> = <span title="StdReplVals.this.ReplImplicits" class="keyword">new</span> <a href="#875802" title="StdReplVals.this.ReplImplicits">ReplImplicits</a>

  <span class="keyword">def</span> <a title="[T &lt;: StdReplVals.this.analyzer.global.Tree](tree: T)T" id="875805">typed</a><span class="delimiter">[</span><a title=" &lt;: StdReplVals.this.analyzer.global.Tree" id="875807">T</a> &lt;: analyzer.global.Tree<span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="913665">tree</a>: <a href="#875807" title="T">T</a><span class="delimiter">)</span>: <a href="#875807" title="T">T</a> = <a href="#875799" title="=&gt; StdReplVals.this.analyzer.Typer">typer</a>.<a href="../typechecker/Typers.scala.html#538701" title="(tree: StdReplVals.this.analyzer.global.Tree)StdReplVals.this.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="#913665" title="T">tree</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="T" class="delimiter">[</span><a href="#875807" title="T">T</a><span class="delimiter">]</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="scala.tools.nsc.interpreter.ReplVals.type" id="37699">ReplVals</a> <a href="#37700" title="scala.tools.nsc.interpreter.ReplVals.type" class="delimiter">{</a>
  /** Latest attempt to work around the challenge of foo.global.Type
   *  not being seen as the same type as bar.global.Type even though
   *  the globals are the same.  Dependent method types to the rescue.
   */
  <span class="keyword">def</span> <a title="[T &lt;: scala.tools.nsc.Global](global: T)global.Symbol =&gt; Object{def apply[M](implicit m1: reflect.runtime.universe.TypeTag[M]): global.Type; def apply[M1, M2](implicit m1: reflect.runtime.universe.TypeTag[M1],implicit m2: reflect.runtime.universe.TypeTag[M2]): global.Type}" id="913385">mkCompilerTypeFromTag</a><span class="delimiter">[</span><a title=" &lt;: scala.tools.nsc.Global" id="913387">T</a> &lt;: Global<span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="913388">global</a>: <a href="#913387" title="T">T</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#913388" title="T">global</a>._
    <span class="keyword">import</span> <a href="../../../reflect/internal/Definitions.scala.html#407777" title="global.definitions.type">definitions</a>._

    /** We can't use definitions.compilerTypeFromTag directly because we're passing
     *  it to map and the compiler refuses to perform eta expansion on a method
     *  with a dependent return type.  (Can this be relaxed?) To get around this
     *  I have this forwarder which widens the type and then cast the result back
     *  to the dependent type.
     */
    <span class="keyword">def</span> <a title="(t: scala.reflect.api.Universe#WeakTypeTag[_])scala.tools.nsc.Global#Type" id="913391">compilerTypeFromTag</a><span class="delimiter">(</span><a title="scala.reflect.api.Universe#WeakTypeTag[_]" id="913393">t</a>: ApiUniverse # <a href="../../../reflect/api/TypeTags.scala.html#56533" title="scala.reflect.api.Universe#WeakTypeTag[_]">WeakTypeTag</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: Global#<a href="../../../reflect/internal/Types.scala.html#407270" title="scala.tools.nsc.Global#Type">Type</a> =
      <a href="../../../reflect/internal/Definitions.scala.html#407777" title="global.definitions.type">definitions</a>.<a href="../../../reflect/internal/Definitions.scala.html#408963" title="(tt: scala.reflect.api.Universe#WeakTypeTag[_])global.Type">compilerTypeFromTag</a><span class="delimiter">(</span><a href="#913393" title="scala.reflect.api.Universe#WeakTypeTag[_]">t</a><span class="delimiter">)</span>

    <span class="keyword">class</span> <a title="class AppliedTypeFromTags extends Object" id="913392">AppliedTypeFromTags</a><a href="#913392" title="AppliedTypeFromTags" class="delimiter">(</a><a title="global.Symbol" id="913422">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="[M](implicit m1: reflect.runtime.universe.TypeTag[M])global.Type" id="913412">apply</a><span class="delimiter">[</span><a title="" id="913414">M</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="reflect.runtime.universe.TypeTag[M]" id="913423">m1</a>: ru.<a href="../../../reflect/api/TypeTags.scala.html#56539" title="reflect.runtime.universe.TypeTag[M]">TypeTag</a><span class="delimiter">[</span>M<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Types.scala.html#407270" title="global.Type">Type</a> =
        <span title="global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#913422" title="global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; global.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Types.scala.html#407284" title="global.NoType.type">NoType</a>
        <span class="keyword">else</span> <a href="../../../reflect/internal/Types.scala.html#407409" title="(tyconSym: global.Symbol, args: global.Type*)global.Type">appliedType</a><span class="delimiter">(</span><a href="#913422" title="global.Symbol">sym</a>, <a href="#913391" title="(t: scala.reflect.api.Universe#WeakTypeTag[_])scala.tools.nsc.Global#Type">compilerTypeFromTag</a><span class="delimiter">(</span><a href="#913423" title="reflect.runtime.universe.TypeTag[M]">m1</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="global.Type" class="delimiter">[</span><a href="../../../reflect/internal/Types.scala.html#407270" title="global.Type">Type</a><span class="delimiter">]</span><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="[M1, M2](implicit m1: reflect.runtime.universe.TypeTag[M1], implicit m2: reflect.runtime.universe.TypeTag[M2])global.Type" id="913415">apply</a><span class="delimiter">[</span><a title="" id="913418">M1</a>, <a title="" id="913419">M2</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="reflect.runtime.universe.TypeTag[M1]" id="913436">m1</a>: ru.<a href="../../../reflect/api/TypeTags.scala.html#56539" title="reflect.runtime.universe.TypeTag[M1]">TypeTag</a><span class="delimiter">[</span>M1<span class="delimiter">]</span>, <a title="reflect.runtime.universe.TypeTag[M2]" id="913437">m2</a>: ru.<a href="../../../reflect/api/TypeTags.scala.html#56539" title="reflect.runtime.universe.TypeTag[M2]">TypeTag</a><span class="delimiter">[</span>M2<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Types.scala.html#407270" title="global.Type">Type</a> =
        <span title="global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#913422" title="global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; global.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Types.scala.html#407284" title="global.NoType.type">NoType</a>
        <span class="keyword">else</span> <a href="../../../reflect/internal/Types.scala.html#407409" title="(tyconSym: global.Symbol, args: global.Type*)global.Type">appliedType</a><span class="delimiter">(</span><a href="#913422" title="global.Symbol">sym</a>, <a href="#913391" title="(t: scala.reflect.api.Universe#WeakTypeTag[_])scala.tools.nsc.Global#Type">compilerTypeFromTag</a><span class="delimiter">(</span><a href="#913436" title="reflect.runtime.universe.TypeTag[M1]">m1</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="global.Type" class="delimiter">[</span><a href="../../../reflect/internal/Types.scala.html#407270" title="global.Type">Type</a><span class="delimiter">]</span>, <a href="#913391" title="(t: scala.reflect.api.Universe#WeakTypeTag[_])scala.tools.nsc.Global#Type">compilerTypeFromTag</a><span class="delimiter">(</span><a href="#913437" title="reflect.runtime.universe.TypeTag[M2]">m2</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="global.Type" class="delimiter">[</span><a href="../../../reflect/internal/Types.scala.html#407270" title="global.Type">Type</a><span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="delimiter">(</span>sym: <a href="../../../reflect/internal/Symbols.scala.html#407146" title="global.Symbol">Symbol</a><span class="delimiter">)</span> =&gt; <span title="AppliedTypeFromTags" class="keyword">new</span> <a href="#913392" title="AppliedTypeFromTags">AppliedTypeFromTags</a><span class="delimiter">(</span><a href="#913445" title="global.Symbol">sym</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
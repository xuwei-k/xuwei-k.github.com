<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/backend/opt/DeadCodeElimination.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new scala compiler
 * Copyright 2005-2013 LAMP/EPFL
 * @author  Iulian Dragos
 */


<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> backend.opt

<span class="keyword">import</span> scala.collection.<span class="delimiter">{</span> mutable, immutable <span class="delimiter">}</span>
<span class="keyword">import</span> symtab._

/**
 */
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class DeadCodeElimination extends scala.tools.nsc.SubComponent" id="33003">DeadCodeElimination</a> <a href="#33003" title="scala.tools.nsc.backend.opt.DeadCodeElimination" class="keyword">extends</a> <a href="../../SubComponent.scala.html#27133" title="scala.tools.nsc.SubComponent">SubComponent</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="../../SubComponent.scala.html#620039" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="../../Global.scala.html#537466" title="DeadCodeElimination.this.global.icodes.type">icodes</a>._
  <span class="keyword">import</span> <a href="../../Global.scala.html#537466" title="DeadCodeElimination.this.global.icodes.type">icodes</a>.<a href="../icode/Opcodes.scala.html#614967" title="DeadCodeElimination.this.global.icodes.opcodes.type">opcodes</a>._
  <span class="keyword">import</span> <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="DeadCodeElimination.this.global.definitions.type">definitions</a>.RuntimePackage

  <span class="keyword">val</span> <a title="String" id="622993">phaseName</a> = <span title="String(&quot;dce&quot;)" class="string">&quot;dce&quot;</span>

  /** Create a new phase */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(p: scala.tools.nsc.Phase)DeadCodeElimination.this.DeadCodeEliminationPhase" id="622995">newPhase</a><span class="delimiter">(</span><a title="scala.tools.nsc.Phase" id="624271">p</a>: <a href="../../../../reflect/internal/Phase.scala.html#19756" title="scala.tools.nsc.Phase">Phase</a><span class="delimiter">)</span> = <span title="DeadCodeElimination.this.DeadCodeEliminationPhase" class="keyword">new</span> <a href="#622996" title="DeadCodeElimination.this.DeadCodeEliminationPhase">DeadCodeEliminationPhase</a><span class="delimiter">(</span><a href="#624271" title="scala.tools.nsc.Phase">p</a><span class="delimiter">)</span>

  /** Dead code elimination phase.
   */
  <span class="keyword">class</span> <a title="class DeadCodeEliminationPhase extends DeadCodeElimination.this.global.icodes.ICodePhase" id="622996">DeadCodeEliminationPhase</a><a href="#622996" title="DeadCodeElimination.this.DeadCodeEliminationPhase" class="delimiter">(</a><a title="scala.tools.nsc.Phase" id="624407">prev</a>: <a href="../../../../reflect/internal/Phase.scala.html#19756" title="scala.tools.nsc.Phase">Phase</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../icode/ICodes.scala.html#614910" title="DeadCodeElimination.this.global.icodes.ICodePhase">ICodePhase</a><span class="delimiter">(</span><a href="#624407" title="scala.tools.nsc.Phase">prev</a><span class="delimiter">)</span> <span class="delimiter">{</span>

    <span class="keyword">def</span> <a title="=&gt; String" id="624403">name</a> = <a href="#622993" title="=&gt; String">phaseName</a>
    <span class="keyword">val</span> <a title="DeadCodeElimination.this.DeadCode" id="624404">dce</a> = <span title="DeadCodeElimination.this.DeadCode" class="keyword">new</span> <a href="#622999" title="DeadCodeElimination.this.DeadCode">DeadCode</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(c: DeadCodeElimination.this.global.icodes.IClass)Unit" id="624406">apply</a><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.IClass" id="761603">c</a>: <a href="../icode/Members.scala.html#614923" title="DeadCodeElimination.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#540055" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">Xdce</a>.<a href="../../settings/MutableSettings.scala.html#541066" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
        <a href="#624404" title="=&gt; DeadCodeElimination.this.DeadCode">dce</a>.<a href="#761573" title="(cls: DeadCodeElimination.this.global.icodes.IClass)Unit">analyzeClass</a><span class="delimiter">(</span><a href="#761603" title="DeadCodeElimination.this.global.icodes.IClass">c</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** closures that are instantiated at least once, after dead code elimination */
  <span class="keyword">val</span> <a title="scala.collection.mutable.Set[DeadCodeElimination.this.global.Symbol]" id="622997">liveClosures</a>: mutable.<a href="../../../../collection/mutable/Set.scala.html#13128" title="scala.collection.mutable.Set[DeadCodeElimination.this.global.Symbol]">Set</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span> = <a href="../../../../collection/mutable/HashSet.scala.html#125959" title="()scala.collection.mutable.HashSet[DeadCodeElimination.this.global.Symbol]" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/HashSet.scala.html#13053" title="scala.collection.mutable.HashSet[DeadCodeElimination.this.global.Symbol]">HashSet</a><span class="delimiter">(</span><span class="delimiter">)</span>

  /** Remove dead code.
   */
  <span class="keyword">class</span> <a title="class DeadCode extends Object" id="622999">DeadCode</a> <a href="#622999" title="DeadCodeElimination.this.DeadCode" class="delimiter">{</a>

    <span class="keyword">def</span> <a title="(cls: DeadCodeElimination.this.global.icodes.IClass)Unit" id="761573">analyzeClass</a><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.IClass" id="761611">cls</a>: <a href="../icode/Members.scala.html#614923" title="DeadCodeElimination.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#537516" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><a href="../../../../StringContext.scala.html#56629" title="(args: Any*)String">s</a>&quot;Analyzing $<span class="delimiter">{</span><a href="#761611" title="DeadCodeElimination.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#615194" title="=&gt; List[DeadCodeElimination.this.global.icodes.IMethod]">methods</a>.<a href="../../../../collection/SeqLike.scala.html#58788" title="=&gt; Int">size</a><span class="delimiter">}</span> methods in $<a href="#761611" title="DeadCodeElimination.this.global.icodes.IClass">cls</a><span class="string">.&quot;</span><span class="delimiter">)</span>
      <a href="#761611" title="DeadCodeElimination.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#615194" title="=&gt; List[DeadCodeElimination.this.global.icodes.IMethod]">methods</a>.<a href="../../../../collection/immutable/List.scala.html#62719" title="(f: DeadCodeElimination.this.global.icodes.IMethod =&gt; Unit)Unit">foreach</a> <span class="delimiter">{</span> <a title="DeadCodeElimination.this.global.icodes.IMethod" id="761645">m</a> =&gt;
        <a href="#622999" title="DeadCode.this.type" class="keyword">this</a>.<a href="#761587" title="(x$1: DeadCodeElimination.this.global.icodes.IMethod)Unit">method</a> = <a href="#761645" title="DeadCodeElimination.this.global.icodes.IMethod">m</a>
        <a href="#761591" title="(m: DeadCodeElimination.this.global.icodes.IMethod)Unit">dieCodeDie</a><span class="delimiter">(</span><a href="#761645" title="DeadCodeElimination.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
        <a href="../../SubComponent.scala.html#620039" title="=&gt; scala.tools.nsc.Global">global</a>.<a href="../../Global.scala.html#537592" title="DeadCodeElimination.this.global.closureElimination.type">closureElimination</a>.<a href="ClosureElimination.scala.html#760924" title="(m: DeadCodeElimination.this.global.closureElimination.global.icodes.IMethod)Unit">peephole</a><span class="delimiter">(</span><a href="#761645" title="DeadCodeElimination.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis" id="761574">rdef</a> = <span title="DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis" class="keyword">new</span> <a href="../icode/ICodes.scala.html#614892" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.type">reachingDefinitions</a>.<a href="../icode/analysis/ReachingDefinitions.scala.html#712150" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis">ReachingDefinitionsAnalysis</a>;

    /** Use-def chain: give the reaching definitions at the beginning of given instruction. */
    <span class="keyword">var</span> <a title="scala.collection.immutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),scala.collection.immutable.Set[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]]" id="761577">defs</a>: immutable.<a href="../../../../collection/immutable/Map.scala.html#11241" title="scala.collection.immutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),scala.collection.immutable.Set[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]]">Map</a><span class="delimiter">[</span><span class="delimiter">(</span>BasicBlock, Int<span class="delimiter">)</span>, immutable.Set<span class="delimiter">[</span>rdef.lattice.Definition<span class="delimiter">]</span><span class="delimiter">]</span> = immutable.<a href="../../../../collection/immutable/HashMap.scala.html#11176" title="scala.collection.immutable.HashMap.type">HashMap</a>.<a href="../../../../collection/immutable/HashMap.scala.html#197406" title="scala.collection.immutable.HashMap[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),Nothing]">empty</a>

    /** Useful instructions which have not been scanned yet. */
    <span class="keyword">val</span> <a title="scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]" id="761579">worklist</a>: mutable.<a href="../../../../collection/mutable/Set.scala.html#13128" title="scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">Set</a><span class="delimiter">[</span><span class="delimiter">(</span>BasicBlock, Int<span class="delimiter">)</span><span class="delimiter">]</span> = <span title="scala.collection.mutable.LinkedHashSet[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]" class="keyword">new</span> mutable.<a href="../../../../collection/mutable/LinkedHashSet.scala.html#12468" title="scala.collection.mutable.LinkedHashSet[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">LinkedHashSet</a>

    /** what instructions have been marked as useful? */
    <span class="keyword">val</span> <a title="scala.collection.mutable.Map[DeadCodeElimination.this.global.icodes.BasicBlock,scala.collection.mutable.BitSet]" id="761581">useful</a>: mutable.<a href="../../../../collection/mutable/Map.scala.html#12498" title="scala.collection.mutable.Map[DeadCodeElimination.this.global.icodes.BasicBlock,scala.collection.mutable.BitSet]">Map</a><span class="delimiter">[</span>BasicBlock, mutable.BitSet<span class="delimiter">]</span> = <a href="../../../../reflect/internal/SymbolTable.scala.html#406696" title="DeadCodeElimination.this.global.perRunCaches.type">perRunCaches</a>.<a href="../../../../reflect/internal/SymbolTable.scala.html#471987" title="()scala.collection.mutable.HashMap[DeadCodeElimination.this.global.icodes.BasicBlock,scala.collection.mutable.BitSet]">newMap</a><span class="delimiter">(</span><span class="delimiter">)</span>

    /** what local variables have been accessed at least once? */
    <span class="keyword">var</span> <a title="List[DeadCodeElimination.this.global.icodes.Local]" id="761584">accessedLocals</a>: <a href="../../../../collection/immutable/List.scala.html#11952" title="List[DeadCodeElimination.this.global.icodes.Local]">List</a><span class="delimiter">[</span>Local<span class="delimiter">]</span> = <a href="../../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>

    /** the current method. */
    <span class="keyword">var</span> <a title="DeadCodeElimination.this.global.icodes.IMethod" id="761587">method</a>: <a href="../icode/Members.scala.html#614927" title="DeadCodeElimination.this.global.icodes.IMethod">IMethod</a> = _

    /** Map instructions who have a drop on some control path, to that DROP instruction. */
    <span class="keyword">val</span> <a title="scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]]" id="761589">dropOf</a>: mutable.<a href="../../../../collection/mutable/Map.scala.html#12498" title="scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]]">Map</a><span class="delimiter">[</span><span class="delimiter">(</span>BasicBlock, Int<span class="delimiter">)</span>, List<span class="delimiter">[</span><span class="delimiter">(</span>BasicBlock, Int<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">]</span> = <a href="../../../../reflect/internal/SymbolTable.scala.html#406696" title="DeadCodeElimination.this.global.perRunCaches.type">perRunCaches</a>.<a href="../../../../reflect/internal/SymbolTable.scala.html#471987" title="()scala.collection.mutable.HashMap[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]]">newMap</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(m: DeadCodeElimination.this.global.icodes.IMethod)Unit" id="761591">dieCodeDie</a><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.IMethod" id="761646">m</a>: <a href="../icode/Members.scala.html#614927" title="DeadCodeElimination.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#761646" title="DeadCodeElimination.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696027" title="=&gt; Boolean">hasCode</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;dead code elimination on &quot;)" class="string">&quot;dead code elimination on &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#761646" title="DeadCodeElimination.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>;
        <a href="#761589" title="=&gt; scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]]">dropOf</a>.<a href="../../../../collection/mutable/MapLike.scala.html#87628" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#761646" title="DeadCodeElimination.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695989" title="=&gt; DeadCodeElimination.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#696082" title="=&gt; scala.collection.mutable.ListBuffer[DeadCodeElimination.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/mutable/ListBuffer.scala.html#79768" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#761584" title="(x$1: List[DeadCodeElimination.this.global.icodes.Local])Unit">accessedLocals</a> = <a href="#761646" title="DeadCodeElimination.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696024" title="=&gt; List[DeadCodeElimination.this.global.icodes.Local]">params</a>.<a href="../../../../collection/immutable/List.scala.html#62716" title="=&gt; List[DeadCodeElimination.this.global.icodes.Local]">reverse</a>
        <a href="#761646" title="DeadCodeElimination.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695989" title="=&gt; DeadCodeElimination.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#696082" title="=&gt; scala.collection.mutable.ListBuffer[DeadCodeElimination.this.global.icodes.BasicBlock]">blocks</a> <a href="../../../../collection/mutable/ListBuffer.scala.html#79766" title="(xs: scala.collection.TraversableOnce[DeadCodeElimination.this.global.icodes.BasicBlock])scala.collection.mutable.ListBuffer[DeadCodeElimination.this.global.icodes.BasicBlock]">++=</a> <a href="../icode/ICodes.scala.html#614880" title="=&gt; DeadCodeElimination.this.global.icodes.Linearizer">linearizer</a>.<a href="../icode/Linearizers.scala.html#712012" title="(c: DeadCodeElimination.this.global.icodes.IMethod)List[DeadCodeElimination.this.global.icodes.BasicBlock]">linearize</a><span class="delimiter">(</span><a href="#761646" title="DeadCodeElimination.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
        <a href="#761592" title="(m: DeadCodeElimination.this.global.icodes.IMethod)Unit">collectRDef</a><span class="delimiter">(</span><a href="#761646" title="DeadCodeElimination.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
        <a href="#761594" title="()Unit">mark</a>
        <a href="#761595" title="(m: DeadCodeElimination.this.global.icodes.IMethod)Unit">sweep</a><span class="delimiter">(</span><a href="#761646" title="DeadCodeElimination.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
        <a href="#761584" title="(x$1: List[DeadCodeElimination.this.global.icodes.Local])Unit">accessedLocals</a> = <a href="#761584" title="=&gt; List[DeadCodeElimination.this.global.icodes.Local]">accessedLocals</a>.<a href="../../../../collection/SeqLike.scala.html#58839" title="=&gt; List[DeadCodeElimination.this.global.icodes.Local]">distinct</a>
        <span class="keyword">val</span> <a title="List[DeadCodeElimination.this.global.icodes.Local]" id="761659">diff</a> = <a href="#761646" title="DeadCodeElimination.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696021" title="=&gt; List[DeadCodeElimination.this.global.icodes.Local]">locals</a> <a href="../../../../collection/SeqLike.scala.html#58830" title="(that: scala.collection.GenSeq[DeadCodeElimination.this.global.icodes.Local])List[DeadCodeElimination.this.global.icodes.Local]">diff</a> <a href="#761584" title="=&gt; List[DeadCodeElimination.this.global.icodes.Local]">accessedLocals</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#761659" title="List[DeadCodeElimination.this.global.icodes.Local]">diff</a>.<a href="../../../../collection/TraversableOnce.scala.html#58191" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="String" id="761701">msg</a> = <a href="#761659" title="List[DeadCodeElimination.this.global.icodes.Local]">diff</a>.<a href="../../../../collection/TraversableLike.scala.html#58063" title="(f: DeadCodeElimination.this.global.icodes.Local =&gt; x$1.sym.NameType forSome { val x$1: DeadCodeElimination.this.global.icodes.Local })(implicit bf: scala.collection.generic.CanBuildFrom[List[DeadCodeElimination.this.global.icodes.Local],x$1.sym.NameType forSome { val x$1: DeadCodeElimination.this.global.icodes.Local },List[x$1.sym.NameType forSome { val x$1: DeadCodeElimination.this.global.icodes.Local }]])List[x$1.sym.NameType forSome { val x$1: DeadCodeElimination.this.global.icodes.Local }]">map</a><a href="../../../../collection/immutable/List.scala.html#62442" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,x$1.sym.NameType forSome { val x$1: DeadCodeElimination.this.global.icodes.Local },List[x$1.sym.NameType forSome { val x$1: DeadCodeElimination.this.global.icodes.Local }]]" class="delimiter">(</a><a href="#761718" title="DeadCodeElimination.this.global.icodes.Local">_</a>.<a href="../icode/Members.scala.html#696350" title="=&gt; DeadCodeElimination.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; x$1.sym.NameType">name</a><span class="delimiter">)</span><a href="../../../../collection/TraversableOnce.scala.html#58283" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span>
          <a href="../../Global.scala.html#537516" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><a href="../../../../StringContext.scala.html#56629" title="(args: Any*)String">s</a>&quot;Removed $<span class="delimiter">{</span><a href="#761659" title="List[DeadCodeElimination.this.global.icodes.Local]">diff</a>.<a href="../../../../collection/SeqLike.scala.html#58788" title="=&gt; Int">size</a><span class="delimiter">}</span> dead locals: $<a href="#761701" title="String">msg</a><span class="string">&quot;</span><span class="delimiter">)</span>
          <a href="#761646" title="DeadCodeElimination.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696022" title="(x$1: List[DeadCodeElimination.this.global.icodes.Local])Unit">locals</a> = <a href="#761584" title="=&gt; List[DeadCodeElimination.this.global.icodes.Local]">accessedLocals</a>.<a href="../../../../collection/immutable/List.scala.html#62716" title="=&gt; List[DeadCodeElimination.this.global.icodes.Local]">reverse</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /** collect reaching definitions and initial useful instructions for this method. */
    <span class="keyword">def</span> <a title="(m: DeadCodeElimination.this.global.icodes.IMethod)Unit" id="761592">collectRDef</a><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.IMethod" id="761683">m</a>: <a href="../icode/Members.scala.html#614927" title="DeadCodeElimination.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span>: <a href="../../../../Unit.scala.html#1515" title="Unit">Unit</a> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#761683" title="DeadCodeElimination.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696027" title="=&gt; Boolean">hasCode</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#761577" title="(x$1: scala.collection.immutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),scala.collection.immutable.Set[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]])Unit">defs</a> = immutable.<a href="../../../../collection/immutable/HashMap.scala.html#11176" title="scala.collection.immutable.HashMap.type">HashMap</a>.<a href="../../../../collection/immutable/HashMap.scala.html#197406" title="scala.collection.immutable.HashMap[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),Nothing]">empty</a>; <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a>.<a href="../../../../collection/mutable/SetLike.scala.html#90900" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>; <a href="#761581" title="=&gt; scala.collection.mutable.Map[DeadCodeElimination.this.global.icodes.BasicBlock,scala.collection.mutable.BitSet]">useful</a>.<a href="../../../../collection/mutable/MapLike.scala.html#87628" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>;
      <a href="#761574" title="=&gt; DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis">rdef</a>.<a href="../icode/analysis/ReachingDefinitions.scala.html#723480" title="(m: DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.IMethod)Unit">init</a><span class="delimiter">(</span><a href="#761683" title="DeadCodeElimination.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>;
      <a href="#761574" title="=&gt; DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis">rdef</a>.<a href="../icode/analysis/ReachingDefinitions.scala.html#723484" title="()Unit">run</a>;

      <a href="#761683" title="DeadCodeElimination.this.global.icodes.IMethod">m</a> <a href="../icode/Members.scala.html#695997" title="(f: DeadCodeElimination.this.global.icodes.BasicBlock =&gt; Unit)Unit">foreachBlock</a> <span class="delimiter">{</span> <a title="DeadCodeElimination.this.global.icodes.BasicBlock" id="761778">bb</a> =&gt;
        <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: DeadCodeElimination.this.global.icodes.BasicBlock, value: scala.collection.mutable.BitSet)Unit">useful</a><span class="delimiter">(</span><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span> = <a href="../../../../collection/mutable/BitSet.scala.html#90868" title="(initSize: Int)scala.collection.mutable.BitSet" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/BitSet.scala.html#12450" title="scala.collection.mutable.BitSet">BitSet</a><span class="delimiter">(</span><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695938" title="=&gt; Int">size</a><span class="delimiter">)</span>
        <span class="keyword">var</span> <a title="DeadCode.this.rdef.lattice.Elem" id="761779">rd</a> = <a href="#761574" title="=&gt; DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis">rdef</a>.<a href="../../../../collection/MapLike.scala.html#87535" title="(key: DeadCode.this.rdef.P)DeadCode.this.rdef.lattice.Elem">in</a><span class="delimiter">(</span><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span>;
        <span class="keyword">for</span> <span class="delimiter">(</span><a href="../../../../Predef.scala.html#63098" title="Option[(DeadCodeElimination.this.global.icodes.Instruction, Int)]" id="3319853">Pair</a><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#60635" title="DeadCodeElimination.this.global.icodes.Instruction" id="761882">i</a>, <a href="../../../../Tuple2.scala.html#60637" title="Int" id="761883">idx</a><span class="delimiter">)</span> &lt;- <a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695929" title="=&gt; List[DeadCodeElimination.this.global.icodes.Instruction]">toList</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: ((DeadCodeElimination.this.global.icodes.Instruction, Int)) =&gt; Unit)Unit">zipWithIndex</a><span class="delimiter">)</span> <a href="#3319849" title="(x: Unit)Unit" class="delimiter">{</a>
          <a href="#761882" title="DeadCodeElimination.this.global.icodes.Instruction">i</a> <span class="keyword">match</span> <span class="delimiter">{</span>

            <span class="keyword">case</span> LOAD_LOCAL<a href="#3319747" title="Any" id="3319749" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703703" title="DeadCodeElimination.this.global.icodes.Local" id="761885">l</a><span class="delimiter">)</span> =&gt;
              <a href="#761577" title="(x$1: scala.collection.immutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),scala.collection.immutable.Set[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]])Unit">defs</a> = <a href="#761577" title="=&gt; scala.collection.immutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),scala.collection.immutable.Set[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]]">defs</a> <a href="../../../../collection/immutable/Map.scala.html#62533" title="(kv: ((DeadCodeElimination.this.global.icodes.BasicBlock, Int), scala.collection.immutable.Set[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]))scala.collection.immutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),scala.collection.immutable.Set[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]]">+</a> <a href="../../../../Predef.scala.html#63093" title="(x: (DeadCodeElimination.this.global.icodes.BasicBlock, Int), y: scala.collection.immutable.ListSet[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)])((DeadCodeElimination.this.global.icodes.BasicBlock, Int), scala.collection.immutable.ListSet[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)])">Pair</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#761883" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#761779" title="DeadCode.this.rdef.lattice.Elem">rd</a>.<a href="../icode/analysis/SemiLattice.scala.html#723173" title="=&gt; scala.collection.immutable.ListSet[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]">vars</a><span class="delimiter">)</span>

            <span class="keyword">case</span> STORE_LOCAL<a href="#3319747" title="Any" id="3319752" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700872" title="DeadCodeElimination.this.global.icodes.Local" id="3319750">_</a><span class="delimiter">)</span> =&gt;
              /* SI-4935 Check whether a module is stack top, if so mark the instruction that loaded it
               * (otherwise any side-effects of the module's constructor go lost).
               *   (a) The other two cases where a module's value is stored (STORE_FIELD and STORE_ARRAY_ITEM)
               *       are already marked (case clause below).
               *   (b) A CALL_METHOD targeting a method `m1` where the receiver is potentially a module (case clause below)
               *       will have the module's load marked provided `isSideEffecting(m1)`.
               *       TODO check for purity (the ICode?) of the module's constructor (besides m1's purity).
               *       See also https://github.com/paulp/scala/blob/topic/purity-analysis/src/compiler/scala/tools/nsc/backend/opt/DeadCodeElimination.scala
               */
              <span class="keyword">val</span> <a title="Boolean" id="761961">necessary</a> = <a href="#761574" title="=&gt; DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis">rdef</a>.<a href="../icode/analysis/ReachingDefinitions.scala.html#723491" title="(bb: DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, idx: Int, m: Int)List[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]">findDefs</a><span class="delimiter">(</span><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#761883" title="Int">idx</a>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#86379" title="(p: ((DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)) =&gt; Boolean)Boolean">exists</a> <span class="delimiter">{</span> <a title="(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)" id="761983">p</a> =&gt;
                <span class="keyword">val</span> <a href="#3319702" title="(x: (DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int))(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#60635" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock" id="761985">bb1</a>, <a href="../../../../Tuple2.scala.html#60637" title="Int" id="761986">idx1</a><span class="delimiter">)</span> = <a href="#761983" title="(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)">p</a>
                <a href="../icode/BasicBlocks.scala.html#695939" title="(n: Int)DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Instruction">bb1</a><span title="Boolean" class="delimiter">(</span><a href="#761986" title="Int">idx1</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> LOAD_MODULE<a href="#3319706" title="Boolean" id="3319708" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#707054" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="761999">module</a><span class="delimiter">)</span> =&gt; <a href="#761593" title="(module: DeadCodeElimination.this.global.Symbol)Boolean">isLoadNeeded</a><a href="#3319710" title="(x: Boolean)Boolean" class="delimiter">(</a><a href="#761999" title="DeadCodeElimination.this.global.icodes.global.Symbol">module</a><span class="delimiter">)</span>
                  <span class="keyword">case</span> _                   =&gt; <a href="#3319710" title="(x: Boolean)Boolean" class="keyword">false</a>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
              <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#761961" title="Boolean">necessary</a><span class="delimiter">)</span> <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a> <a href="../../../../collection/mutable/SetLike.scala.html#90897" title="(elem: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))DeadCode.this.worklist.type">+=</a> <span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#761883" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span>

            <span class="keyword">case</span> RETURN<a href="#3319747" title="Any" id="3319755" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700784" title="DeadCodeElimination.this.global.icodes.TypeKind" id="3319753">_</a><span class="delimiter">)</span> | JUMP<a href="#3319747" title="Boolean" id="3319758" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700755" title="DeadCodeElimination.this.global.icodes.BasicBlock" id="3319756">_</a><span class="delimiter">)</span> | CJUMP<a href="#3319747" title="Boolean" id="3319764" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#701128" title="DeadCodeElimination.this.global.icodes.BasicBlock" id="3319759">_</a>, <a href="../icode/Opcodes.scala.html#701130" title="DeadCodeElimination.this.global.icodes.BasicBlock" id="3319760">_</a>, <a href="../icode/Opcodes.scala.html#701132" title="DeadCodeElimination.this.global.icodes.TestOp" id="3319761">_</a>, <a href="../icode/Opcodes.scala.html#701134" title="DeadCodeElimination.this.global.icodes.TypeKind" id="3319762">_</a><span class="delimiter">)</span> | CZJUMP<a href="#3319747" title="Boolean" id="3319770" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#701202" title="DeadCodeElimination.this.global.icodes.BasicBlock" id="3319765">_</a>, <a href="../icode/Opcodes.scala.html#701204" title="DeadCodeElimination.this.global.icodes.BasicBlock" id="3319766">_</a>, <a href="../icode/Opcodes.scala.html#701206" title="DeadCodeElimination.this.global.icodes.TestOp" id="3319767">_</a>, <a href="../icode/Opcodes.scala.html#701208" title="DeadCodeElimination.this.global.icodes.TypeKind" id="3319768">_</a><span class="delimiter">)</span> | STORE_FIELD<a href="#3319747" title="Boolean" id="3319774" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#702957" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="3319771">_</a>, <a href="../icode/Opcodes.scala.html#702959" title="Boolean" id="3319772">_</a><span class="delimiter">)</span> |
                 THROW<a href="#3319747" title="Boolean" id="3319777" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700813" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="3319775">_</a><span class="delimiter">)</span>   | LOAD_ARRAY_ITEM<a href="#3319747" title="Boolean" id="3319780" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703309" title="DeadCodeElimination.this.global.icodes.TypeKind" id="3319778">_</a><span class="delimiter">)</span> | STORE_ARRAY_ITEM<a href="#3319747" title="Boolean" id="3319783" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703339" title="DeadCodeElimination.this.global.icodes.TypeKind" id="3319781">_</a><span class="delimiter">)</span> | SCOPE_ENTER<a href="#3319747" title="Boolean" id="3319786" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705011" title="DeadCodeElimination.this.global.icodes.Local" id="3319784">_</a><span class="delimiter">)</span> | SCOPE_EXIT<a href="#3319747" title="Boolean" id="3319789" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700843" title="DeadCodeElimination.this.global.icodes.Local" id="3319787">_</a><span class="delimiter">)</span> | STORE_THIS<a href="#3319747" title="Boolean" id="3319792" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#706867" title="DeadCodeElimination.this.global.icodes.TypeKind" id="3319790">_</a><span class="delimiter">)</span> |
                 LOAD_EXCEPTION<a href="#3319747" title="Boolean" id="3319795" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703522" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="3319793">_</a><span class="delimiter">)</span> | SWITCH<a href="#3319747" title="Boolean" id="3319799" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#701271" title="List[List[Int]]" id="3319796">_</a>, <a href="../icode/Opcodes.scala.html#701273" title="List[DeadCodeElimination.this.global.icodes.BasicBlock]" id="3319797">_</a><span class="delimiter">)</span> | MONITOR_ENTER<a href="#3319747" title="Boolean" id="3319801" class="delimiter">(</a><span class="delimiter">)</span> | MONITOR_EXIT<a href="#3319747" title="Boolean" id="3319803" class="delimiter">(</a><span class="delimiter">)</span> =&gt; <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a> <a href="#3319818" title="(x: Any)Any">+=</a> <span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#761883" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> CALL_METHOD<a href="#3319747" title="Boolean" id="3319806" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705592" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="762051">m1</a>, <a href="../icode/Opcodes.scala.html#705594" title="DeadCodeElimination.this.global.icodes.opcodes.InvokeStyle" id="3319804">_</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#761602" title="(sym: DeadCodeElimination.this.global.Symbol)Boolean">isSideEffecting</a><span class="delimiter">(</span><a href="#762051" title="DeadCodeElimination.this.global.icodes.global.Symbol">m1</a><span class="delimiter">)</span> =&gt; <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a> <a href="../../../../collection/mutable/SetLike.scala.html#90897" title="(elem: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))DeadCode.this.worklist.type">+=</a> <span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#761883" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span>; <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;marking &quot;)" class="string">&quot;marking &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762051" title="DeadCodeElimination.this.global.icodes.global.Symbol">m1</a><span class="delimiter">)</span>
            <span class="keyword">case</span> CALL_METHOD<span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#705592" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="762070">m1</a>, SuperCall<a href="../icode/Opcodes.scala.html#705594" title="DeadCodeElimination.this.global.icodes.opcodes.InvokeStyle" id="3319812" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705550" title="DeadCodeElimination.this.global.icodes.global.Name" id="3319810">_</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
              <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a> <a href="#3319818" title="(x: Any)Any">+=</a> <span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#761883" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span> // super calls to constructor
            <span class="keyword">case</span> DROP<a href="#3319747" title="Any" id="3319815" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#704127" title="DeadCodeElimination.this.global.icodes.TypeKind" id="3319813">_</a><span class="delimiter">)</span> =&gt;
              <span class="keyword">val</span> <a title="Boolean" id="762081">necessary</a> = <a href="#761574" title="=&gt; DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis">rdef</a>.<a href="../icode/analysis/ReachingDefinitions.scala.html#723491" title="(bb: DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, idx: Int, m: Int)List[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]">findDefs</a><span class="delimiter">(</span><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#761883" title="Int">idx</a>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#86379" title="(p: ((DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)) =&gt; Boolean)Boolean">exists</a> <span class="delimiter">{</span> <a title="(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)" id="762092">p</a> =&gt;
                <span class="keyword">val</span> <a href="#3319717" title="(x: (DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int))(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#60635" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock" id="762094">bb1</a>, <a href="../../../../Tuple2.scala.html#60637" title="Int" id="762095">idx1</a><span class="delimiter">)</span> = <a href="#762092" title="(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)">p</a>
                <a href="../icode/BasicBlocks.scala.html#695939" title="(n: Int)DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Instruction">bb1</a><span title="Boolean" class="delimiter">(</span><a href="#762095" title="Int">idx1</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> CALL_METHOD<a href="#3319721" title="Boolean" id="3319724" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705592" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="762109">m1</a>, <a href="../icode/Opcodes.scala.html#705594" title="DeadCodeElimination.this.global.icodes.opcodes.InvokeStyle" id="3319722">_</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#761602" title="(sym: DeadCodeElimination.this.global.Symbol)Boolean">isSideEffecting</a><span class="delimiter">(</span><a href="#762109" title="DeadCodeElimination.this.global.icodes.global.Symbol">m1</a><span class="delimiter">)</span> =&gt; <a href="#3319735" title="(x: Boolean)Boolean" class="keyword">true</a>
                  <span class="keyword">case</span> LOAD_EXCEPTION<a href="#3319721" title="Boolean" id="3319727" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703522" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="3319725">_</a><span class="delimiter">)</span> | DUP<a href="#3319721" title="Boolean" id="3319730" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703416" title="DeadCodeElimination.this.global.icodes.TypeKind" id="3319728">_</a><span class="delimiter">)</span> | LOAD_MODULE<a href="#3319721" title="Boolean" id="3319733" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#707054" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="3319731">_</a><span class="delimiter">)</span> =&gt; <a href="#3319735" title="(x: Boolean)Boolean" class="keyword">true</a>
                  <span class="keyword">case</span> _ =&gt;
                    <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: (DeadCodeElimination.this.global.icodes.BasicBlock, Int), value: List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)])Unit">dropOf</a><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#762094" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock">bb1</a>, <a href="#762095" title="Int">idx1</a><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>,<a href="#761883" title="Int">idx</a><span class="delimiter">)</span> <a href="../../../../collection/immutable/List.scala.html#62685" title="(x: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">::</a> <a href="#761589" title="=&gt; scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]]">dropOf</a>.<a href="../../../../collection/MapLike.scala.html#87532" title="(key: (DeadCodeElimination.this.global.icodes.BasicBlock, Int), default: =&gt; List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)])List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">getOrElse</a><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#762094" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock">bb1</a>, <a href="#762095" title="Int">idx1</a><span class="delimiter">)</span>, <a href="../../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>
//                    println(&quot;DROP is innessential: &quot; + i + &quot; because of: &quot; + bb1(idx1) + &quot; at &quot; + bb1 + &quot;:&quot; + idx1)
                    <span title="Boolean(false)" class="keyword">false</span>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
              <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#762081" title="Boolean">necessary</a><span class="delimiter">)</span> <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a> <a href="../../../../collection/mutable/SetLike.scala.html#90897" title="(elem: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))DeadCode.this.worklist.type">+=</a> <span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#761883" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> _ =&gt; <a href="#3319818" title="(x: Any)Any" class="delimiter">(</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#761779" title="DeadCode.this.rdef.lattice.Elem">rd</a> = <a href="#761574" title="=&gt; DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis">rdef</a>.<a href="../icode/analysis/ReachingDefinitions.scala.html#723489" title="(b: DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, idx: Int, in: DeadCode.this.rdef.lattice.Elem)DeadCode.this.rdef.lattice.Elem">interpret</a><span class="delimiter">(</span><a href="#761778" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#761883" title="Int">idx</a>, <a href="#761779" title="DeadCode.this.rdef.lattice.Elem">rd</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(module: DeadCodeElimination.this.global.Symbol)Boolean" id="761593">isLoadNeeded</a><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.Symbol" id="762000">module</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="DeadCodeElimination.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
      <a href="#762000" title="DeadCodeElimination.this.global.Symbol">module</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411367" title="=&gt; DeadCodeElimination.this.global.Type">info</a>.<a href="../../../../reflect/internal/Types.scala.html#408451" title="(name: DeadCodeElimination.this.global.Name)DeadCodeElimination.this.global.Symbol">member</a><span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#407871" title="DeadCodeElimination.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#413982" title="=&gt; DeadCodeElimination.this.global.nme.NameType">CONSTRUCTOR</a><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Symbols.scala.html#411414" title="(cond: DeadCodeElimination.this.global.Symbol =&gt; Boolean)DeadCodeElimination.this.global.Symbol">filter</a><span class="delimiter">(</span><a href="#761602" title="(sym: DeadCodeElimination.this.global.Symbol)Boolean">isSideEffecting</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; DeadCodeElimination.this.global.NoSymbol">NoSymbol</a>
    <span class="delimiter">}</span>

    /** Mark useful instructions. Instructions in the worklist are each inspected and their
     *  dependencies are marked useful too, and added to the worklist.
     */
    <span class="keyword">def</span> <a title="()Unit" id="761594">mark</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
//      log(&quot;Starting with worklist: &quot; + worklist)
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a>.<a href="../../../../collection/SetLike.scala.html#66447" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#762189" title="()Unit" class="delimiter">{</a>
        <span class="keyword">val</span> <a href="#3319858" title="(x: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#60635" title="DeadCodeElimination.this.global.icodes.BasicBlock" id="762191">bb</a>, <a href="../../../../Tuple2.scala.html#60637" title="Int" id="762192">idx</a><span class="delimiter">)</span> = <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a>.<a href="../../../../collection/GenSetLike.scala.html#66398" title="=&gt; Iterator[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">iterator</a>.<a href="../../../../collection/Iterator.scala.html#66748" title="()(DeadCodeElimination.this.global.icodes.BasicBlock, Int)">next</a>
        <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a> <a href="../../../../collection/mutable/SetLike.scala.html#90898" title="(elem: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))DeadCode.this.worklist.type">-=</a> <span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#762191" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#762192" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Marking instr: \tBB_&quot;)" class="string">&quot;Marking instr: \tBB_&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762191" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762192" title="Int">idx</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../icode/BasicBlocks.scala.html#695939" title="(n: Int)DeadCodeElimination.this.global.icodes.Instruction">bb</a><span class="delimiter">(</span><a href="#762192" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="DeadCodeElimination.this.global.icodes.Instruction" id="762193">instr</a> = <a href="../icode/BasicBlocks.scala.html#695939" title="(n: Int)DeadCodeElimination.this.global.icodes.Instruction">bb</a><span class="delimiter">(</span><a href="#762192" title="Int">idx</a><span class="delimiter">)</span>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="../../../../collection/MapLike.scala.html#87535" title="(key: DeadCodeElimination.this.global.icodes.BasicBlock)scala.collection.mutable.BitSet">useful</a><a href="../../../../collection/GenSetLike.scala.html#66403" title="(elem: Int)Boolean" class="delimiter">(</a><a href="#762191" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#762192" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../../../collection/MapLike.scala.html#87535" title="(key: DeadCodeElimination.this.global.icodes.BasicBlock)scala.collection.mutable.BitSet">useful</a><span class="delimiter">(</span><a href="#762191" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span> <a href="../../../../collection/mutable/BitSet.scala.html#90876" title="(elem: Int)scala.collection.mutable.BitSet">+=</a> <a href="#762192" title="Int">idx</a>
          <a href="#761589" title="=&gt; scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]]">dropOf</a>.<a href="../../../../collection/MapLike.scala.html#87525" title="(key: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))Option[List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]]">get</a><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#762191" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#762192" title="Int">idx</a><span class="delimiter">)</span> <a href="../../../../Option.scala.html#62884" title="(f: List[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)] =&gt; Unit)Unit">foreach</a> <span class="delimiter">{</span>
              <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#60635" title="DeadCodeElimination.this.global.icodes.BasicBlock" id="762314">bb1</a>, <a href="../../../../Tuple2.scala.html#60637" title="Int" id="762315">idx1</a><span class="delimiter">)</span> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: ((DeadCodeElimination.this.global.icodes.BasicBlock, Int)) =&gt; scala.collection.mutable.BitSet)Unit">_</a><span class="delimiter">)</span>
                <a href="../../../../collection/MapLike.scala.html#87535" title="(key: DeadCodeElimination.this.global.icodes.BasicBlock)scala.collection.mutable.BitSet">useful</a><span class="delimiter">(</span><a href="#762314" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb1</a><span class="delimiter">)</span> <a href="#3319864" title="(x: scala.collection.mutable.BitSet)scala.collection.mutable.BitSet">+=</a> <a href="#762315" title="Int">idx1</a>
          <span class="delimiter">}</span>
          <a href="#762193" title="DeadCodeElimination.this.global.icodes.Instruction">instr</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> LOAD_LOCAL<a href="#3319898" title="Any" id="3319900" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703703" title="DeadCodeElimination.this.global.icodes.Local" id="762350">l1</a><span class="delimiter">)</span> =&gt;
              <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../../../../Tuple3.scala.html#60576" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local" id="762442">l2</a>, <a href="../../../../Tuple3.scala.html#60578" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock" id="762443">bb1</a>, <a href="../../../../Tuple3.scala.html#60580" title="Int" id="762444">idx1</a><span class="delimiter">)</span> &lt;- <a href="../../../../collection/MapLike.scala.html#87535" title="(key: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))scala.collection.immutable.Set[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]">defs</a><a href="../../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: ((DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local, DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)) =&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)])Unit" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#762191" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#762192" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#762350" title="DeadCodeElimination.this.global.icodes.Local">l1</a> <a href="#3319870" title="(x: Boolean)Boolean">==</a> <a href="#762442" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Local">l2</a>; <span class="keyword">if</span> <a href="#3319876" title="(x: Boolean)Boolean">!</a><a href="../../../../collection/MapLike.scala.html#87535" title="(key: DeadCodeElimination.this.global.icodes.BasicBlock)scala.collection.mutable.BitSet">useful</a><a href="../../../../collection/GenSetLike.scala.html#66403" title="(elem: Int)Boolean" class="delimiter">(</a><a href="#762443" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock">bb1</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#762444" title="Int">idx1</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#3319882" title="(x: DeadCode.this.worklist.type)DeadCode.this.worklist.type" class="delimiter">{</a>
                <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;\tAdding &quot;)" class="string">&quot;\tAdding &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../icode/BasicBlocks.scala.html#695939" title="(n: Int)DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Instruction">bb1</a><span class="delimiter">(</span><a href="#762444" title="Int">idx1</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a> <a href="../../../../collection/mutable/SetLike.scala.html#90897" title="(elem: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))DeadCode.this.worklist.type">+=</a> <span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#762443" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock">bb1</a>, <a href="#762444" title="Int">idx1</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>

            <span class="keyword">case</span> nw @ NEW<a href="#3319898" title="Any" id="3319903" class="delimiter">(</a>REFERENCE<a href="../icode/Opcodes.scala.html#705364" title="DeadCodeElimination.this.global.icodes.REFERENCE" id="3319901" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="762463">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
              <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span>nw.<a href="../icode/Opcodes.scala.html#705371" title="=&gt; DeadCodeElimination.this.global.icodes.opcodes.CALL_METHOD">init</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span>, <span title="String(&quot;null new.init at: &quot;)" class="string">&quot;null new.init at: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762191" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762192" title="Int">idx</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762193" title="DeadCodeElimination.this.global.icodes.Instruction">instr</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
              <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a> <a href="../../../../collection/mutable/SetLike.scala.html#90897" title="(elem: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))DeadCode.this.worklist.type">+=</a> <a href="#761600" title="(bb: DeadCodeElimination.this.global.icodes.BasicBlock, i: DeadCodeElimination.this.global.icodes.Instruction)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)">findInstruction</a><span class="delimiter">(</span><a href="#762191" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, nw.<a href="../icode/Opcodes.scala.html#705371" title="=&gt; DeadCodeElimination.this.global.icodes.opcodes.CALL_METHOD">init</a><span class="delimiter">)</span>
              <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#537588" title="DeadCodeElimination.this.global.inliner.type">inliner</a>.<a href="Inliners.scala.html#622827" title="(cls: DeadCodeElimination.this.global.inliner.global.Symbol)Boolean">isClosureClass</a><span class="delimiter">(</span><a href="#762463" title="DeadCodeElimination.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#622997" title="=&gt; scala.collection.mutable.Set[DeadCodeElimination.this.global.Symbol]">liveClosures</a> <a href="../../../../collection/mutable/SetLike.scala.html#90897" title="(elem: DeadCodeElimination.this.global.Symbol)DeadCodeElimination.this.liveClosures.type">+=</a> <a href="#762463" title="DeadCodeElimination.this.global.icodes.global.Symbol">sym</a>
              <span class="delimiter">}</span>

            // it may be better to move static initializers from closures to
            // the enclosing class, to allow the optimizer to remove more closures.
            // right now, the only static fields in closures are created when caching
            // 'symbol literals.
            <span class="keyword">case</span> LOAD_FIELD<a href="#3319898" title="Any" id="3319906" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#706266" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="762486">sym</a>, <a href="../icode/Opcodes.scala.html#706268" title="Boolean" id="3319912" class="keyword">true</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../Global.scala.html#537588" title="DeadCodeElimination.this.global.inliner.type">inliner</a>.<a href="Inliners.scala.html#622827" title="(cls: DeadCodeElimination.this.global.inliner.global.Symbol)Boolean">isClosureClass</a><span class="delimiter">(</span><a href="#762486" title="DeadCodeElimination.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; DeadCodeElimination.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span> =&gt;
              <a href="../../Global.scala.html#537516" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;added closure class for field &quot;)" class="string">&quot;added closure class for field &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762486" title="DeadCodeElimination.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
              <a href="#622997" title="=&gt; scala.collection.mutable.Set[DeadCodeElimination.this.global.Symbol]">liveClosures</a> <a href="../../../../collection/mutable/SetLike.scala.html#90897" title="(elem: DeadCodeElimination.this.global.Symbol)DeadCodeElimination.this.liveClosures.type">+=</a> <a href="#762486" title="DeadCodeElimination.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; DeadCodeElimination.this.global.icodes.global.Symbol">owner</a>

            <span class="keyword">case</span> LOAD_EXCEPTION<a href="#3319898" title="Any" id="3319911" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703522" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="3319909">_</a><span class="delimiter">)</span> =&gt;
              <a href="#3319914" title="(x: Any)Any" class="delimiter">(</a><span class="delimiter">)</span>

            <span class="keyword">case</span> _ =&gt;
              <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#60635" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock" id="762539">bb1</a>, <a href="../../../../Tuple2.scala.html#60637" title="Int" id="762540">idx1</a><span class="delimiter">)</span> &lt;- <a href="#761574" title="=&gt; DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis">rdef</a>.<a href="../icode/analysis/ReachingDefinitions.scala.html#723491" title="(bb: DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, idx: Int, m: Int)List[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]">findDefs</a><a href="../../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: ((DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)) =&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)])Unit" class="delimiter">(</a><a href="#762191" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#762192" title="Int">idx</a>, <a href="#762193" title="DeadCodeElimination.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695875" title="=&gt; Int">consumed</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#3319888" title="(x: Boolean)Boolean">!</a><a href="../../../../collection/MapLike.scala.html#87535" title="(key: DeadCodeElimination.this.global.icodes.BasicBlock)scala.collection.mutable.BitSet">useful</a><a href="../../../../collection/GenSetLike.scala.html#66403" title="(elem: Int)Boolean" class="delimiter">(</a><a href="#762539" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock">bb1</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#762540" title="Int">idx1</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#3319894" title="(x: DeadCode.this.worklist.type)DeadCode.this.worklist.type" class="delimiter">{</a>
                <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;\tAdding &quot;)" class="string">&quot;\tAdding &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../icode/BasicBlocks.scala.html#695939" title="(n: Int)DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Instruction">bb1</a><span class="delimiter">(</span><a href="#762540" title="Int">idx1</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#761579" title="=&gt; scala.collection.mutable.Set[(DeadCodeElimination.this.global.icodes.BasicBlock, Int)]">worklist</a> <a href="../../../../collection/mutable/SetLike.scala.html#90897" title="(elem: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))DeadCode.this.worklist.type">+=</a> <span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#762539" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock">bb1</a>, <a href="#762540" title="Int">idx1</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(m: DeadCodeElimination.this.global.icodes.IMethod)Unit" id="761595">sweep</a><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.IMethod" id="761684">m</a>: <a href="../icode/Members.scala.html#614927" title="DeadCodeElimination.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[DeadCodeElimination.this.global.icodes.Instruction]]" id="762556">compensations</a> = <a href="#761596" title="(m: DeadCodeElimination.this.global.icodes.IMethod)scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[DeadCodeElimination.this.global.icodes.Instruction]]">computeCompensations</a><span class="delimiter">(</span><a href="#761684" title="DeadCodeElimination.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <a href="#761684" title="DeadCodeElimination.this.global.icodes.IMethod">m</a> <a href="../icode/Members.scala.html#695997" title="(f: DeadCodeElimination.this.global.icodes.BasicBlock =&gt; Unit)Unit">foreachBlock</a> <span class="delimiter">{</span> <a title="DeadCodeElimination.this.global.icodes.BasicBlock" id="762562">bb</a> =&gt;
//        Console.println(&quot;** Sweeping block &quot; + bb + &quot; **&quot;)
        <span class="keyword">val</span> <a title="List[DeadCodeElimination.this.global.icodes.Instruction]" id="762563">oldInstr</a> = <a href="#762562" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695929" title="=&gt; List[DeadCodeElimination.this.global.icodes.Instruction]">toList</a>
        <a href="#762562" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695954" title="()Unit">open</a>
        <a href="#762562" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695955" title="()Unit">clear</a>
        <span class="keyword">for</span> <span class="delimiter">(</span><a href="../../../../Predef.scala.html#63098" title="Option[(DeadCodeElimination.this.global.icodes.Instruction, Int)]" id="3319978">Pair</a><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#60635" title="DeadCodeElimination.this.global.icodes.Instruction" id="762632">i</a>, <a href="../../../../Tuple2.scala.html#60637" title="Int" id="762633">idx</a><span class="delimiter">)</span> &lt;- <a href="#762563" title="List[DeadCodeElimination.this.global.icodes.Instruction]">oldInstr</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: ((DeadCodeElimination.this.global.icodes.Instruction, Int)) =&gt; Unit)Unit">zipWithIndex</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#3319974" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="../../../../collection/MapLike.scala.html#87535" title="(key: DeadCodeElimination.this.global.icodes.BasicBlock)scala.collection.mutable.BitSet">useful</a><a href="../../../../collection/GenSetLike.scala.html#66403" title="(elem: Int)Boolean" class="delimiter">(</a><a href="#762562" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#762633" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
//            log(&quot; &quot; + i + &quot; is useful&quot;)
            <a href="#762562" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695948" title="(instr: DeadCodeElimination.this.global.icodes.Instruction, pos: scala.reflect.internal.util.Position)Unit">emit</a><span class="delimiter">(</span><a href="#762632" title="DeadCodeElimination.this.global.icodes.Instruction">i</a>, <a href="#762632" title="DeadCodeElimination.this.global.icodes.Instruction">i</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a><span class="delimiter">)</span>
            <a href="#762556" title="scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[DeadCodeElimination.this.global.icodes.Instruction]]">compensations</a>.<a href="../../../../collection/MapLike.scala.html#87525" title="(key: (DeadCodeElimination.this.global.icodes.BasicBlock, Int))Option[List[DeadCodeElimination.this.global.icodes.Instruction]]">get</a><a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#762562" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#762633" title="Int">idx</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#3319936" title="Unit" id="3319937" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="List[DeadCodeElimination.this.global.icodes.Instruction]" id="762677">is</a><span class="delimiter">)</span> =&gt; <a href="#762677" title="List[DeadCodeElimination.this.global.icodes.Instruction]">is</a> <a href="#3319941" title="(x: Unit)Unit">foreach</a> <a href="#762562" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695947" title="(instr: DeadCodeElimination.this.global.icodes.Instruction)Unit">emit</a>
              <span class="keyword">case</span> <a href="../../../../Option.scala.html#1585" title="Unit" id="3319939">None</a> =&gt; <a href="#3319941" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            // check for accessed locals
            <a href="#762632" title="DeadCodeElimination.this.global.icodes.Instruction">i</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> LOAD_LOCAL<a href="#3319949" title="Unit" id="3319951" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703703" title="DeadCodeElimination.this.global.icodes.Local" id="762707">l</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#762707" title="DeadCodeElimination.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#696354" title="=&gt; Boolean">arg</a> =&gt;
                <a href="#761584" title="(x$1: List[DeadCodeElimination.this.global.icodes.Local])Unit">accessedLocals</a> = <a href="#762707" title="DeadCodeElimination.this.global.icodes.Local">l</a> <a href="../../../../collection/immutable/List.scala.html#62685" title="(x: DeadCodeElimination.this.global.icodes.Local)List[DeadCodeElimination.this.global.icodes.Local]">::</a> <a href="#761584" title="=&gt; List[DeadCodeElimination.this.global.icodes.Local]">accessedLocals</a>
              <span class="keyword">case</span> STORE_LOCAL<a href="#3319949" title="Unit" id="3319953" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700872" title="DeadCodeElimination.this.global.icodes.Local" id="762715">l</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#762715" title="DeadCodeElimination.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#696354" title="=&gt; Boolean">arg</a> =&gt;
                <a href="#761584" title="(x$1: List[DeadCodeElimination.this.global.icodes.Local])Unit">accessedLocals</a> = <a href="#762715" title="DeadCodeElimination.this.global.icodes.Local">l</a> <a href="../../../../collection/immutable/List.scala.html#62685" title="(x: DeadCodeElimination.this.global.icodes.Local)List[DeadCodeElimination.this.global.icodes.Local]">::</a> <a href="#761584" title="=&gt; List[DeadCodeElimination.this.global.icodes.Local]">accessedLocals</a>
              <span class="keyword">case</span> _ =&gt; <a href="#3319955" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="#762632" title="DeadCodeElimination.this.global.icodes.Instruction">i</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> NEW<a href="#3319961" title="Unit" id="3319964" class="delimiter">(</a>REFERENCE<a href="../icode/Opcodes.scala.html#705364" title="DeadCodeElimination.this.global.icodes.REFERENCE" id="3319962" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="DeadCodeElimination.this.global.icodes.global.Symbol" id="762722">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
                <a href="../../Global.scala.html#537516" title="(msg: =&gt; AnyRef)Unit">log</a><a href="#3319966" title="(x: Unit)Unit" class="delimiter">(</a><a href="../../../../StringContext.scala.html#56629" title="(args: Any*)String">s</a>&quot;Eliminated instantation of $<a href="#762722" title="DeadCodeElimination.this.global.icodes.global.Symbol">sym</a> inside $<a href="#761684" title="DeadCodeElimination.this.global.icodes.IMethod">m</a><span class="string">&quot;</span><span class="delimiter">)</span>
              <span class="keyword">case</span> _ =&gt; <a href="#3319966" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Skipped: bb_&quot;)" class="string">&quot;Skipped: bb_&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762562" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762633" title="Int">idx</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;( &quot;)" class="string">&quot;( &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762632" title="DeadCodeElimination.this.global.icodes.Instruction">i</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#762562" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695957" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <a href="#762562" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695953" title="()Unit">close</a>
        <span class="keyword">else</span> <a href="../../Global.scala.html#537516" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><a href="../../../../StringContext.scala.html#56629" title="(args: Any*)String">s</a>&quot;empty block encountered in $<a href="#761684" title="DeadCodeElimination.this.global.icodes.IMethod">m</a><span class="string">&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(m: DeadCodeElimination.this.global.icodes.IMethod)scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[DeadCodeElimination.this.global.icodes.Instruction]]" id="761596">computeCompensations</a><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.IMethod" id="762557">m</a>: <a href="../icode/Members.scala.html#614927" title="DeadCodeElimination.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span>: mutable.<a href="../../../../collection/mutable/Map.scala.html#12498" title="scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[DeadCodeElimination.this.global.icodes.Instruction]]">Map</a><span class="delimiter">[</span><span class="delimiter">(</span>BasicBlock, Int<span class="delimiter">)</span>, List<span class="delimiter">[</span>Instruction<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[DeadCodeElimination.this.global.icodes.Instruction]]" id="762725">compensations</a>: mutable.<a href="../../../../collection/mutable/Map.scala.html#12498" title="scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[DeadCodeElimination.this.global.icodes.Instruction]]">Map</a><span class="delimiter">[</span><span class="delimiter">(</span>BasicBlock, Int<span class="delimiter">)</span>, List<span class="delimiter">[</span>Instruction<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="../../../../collection/mutable/HashMap.scala.html#88242" title="()scala.collection.mutable.HashMap[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[DeadCodeElimination.this.global.icodes.Instruction]]" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/HashMap.scala.html#12447" title="scala.collection.mutable.HashMap[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[DeadCodeElimination.this.global.icodes.Instruction]]">HashMap</a>

      <a href="#762557" title="DeadCodeElimination.this.global.icodes.IMethod">m</a> <a href="../icode/Members.scala.html#695997" title="(f: DeadCodeElimination.this.global.icodes.BasicBlock =&gt; Unit)Unit">foreachBlock</a> <span class="delimiter">{</span> <a title="DeadCodeElimination.this.global.icodes.BasicBlock" id="762733">bb</a> =&gt;
        <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#762733" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695907" title="=&gt; Boolean">closed</a>, <span title="String(&quot;Open block in computeCompensations&quot;)" class="string">&quot;Open block in computeCompensations&quot;</span><span class="delimiter">)</span>
        <a href="../../../../reflect/internal/util/Collections.scala.html#406765" title="(xs: List[DeadCodeElimination.this.global.icodes.Instruction])(f: (DeadCodeElimination.this.global.icodes.Instruction, Int) =&gt; Unit)Unit">foreachWithIndex</a><span class="delimiter">(</span><a href="#762733" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695929" title="=&gt; List[DeadCodeElimination.this.global.icodes.Instruction]">toList</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.Instruction" id="762754">i</a>, <a title="Int" id="762755">idx</a><span class="delimiter">)</span> =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="../../../../collection/MapLike.scala.html#87535" title="(key: DeadCodeElimination.this.global.icodes.BasicBlock)scala.collection.mutable.BitSet">useful</a><a href="../../../../collection/GenSetLike.scala.html#66403" title="(elem: Int)Boolean" class="delimiter">(</a><a href="#762733" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#762755" title="Int">idx</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../../../reflect/internal/util/Collections.scala.html#406765" title="(xs: List[DeadCodeElimination.this.global.icodes.TypeKind])(f: (DeadCodeElimination.this.global.icodes.TypeKind, Int) =&gt; Unit)Unit">foreachWithIndex</a><span class="delimiter">(</span><a href="#762754" title="DeadCodeElimination.this.global.icodes.Instruction">i</a>.<a href="../icode/Opcodes.scala.html#695877" title="=&gt; List[DeadCodeElimination.this.global.icodes.TypeKind]">consumedTypes</a>.<a href="../../../../collection/immutable/List.scala.html#62716" title="=&gt; List[DeadCodeElimination.this.global.icodes.TypeKind]">reverse</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.TypeKind" id="762802">consumedType</a>, <a title="Int" id="762803">depth</a><span class="delimiter">)</span> =&gt;
              <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Finding definitions of: &quot;)" class="string">&quot;Finding definitions of: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762754" title="DeadCodeElimination.this.global.icodes.Instruction">i</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\n\t&quot;)" class="string">&quot;\n\t&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762802" title="DeadCodeElimination.this.global.icodes.TypeKind">consumedType</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; at depth: &quot;)" class="string">&quot; at depth: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#762803" title="Int">depth</a><span class="delimiter">)</span>
              <span class="keyword">val</span> <a title="List[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]" id="762804">defs</a> = <a href="#761574" title="=&gt; DeadCodeElimination.this.global.icodes.reachingDefinitions.ReachingDefinitionsAnalysis">rdef</a>.<a href="../icode/analysis/ReachingDefinitions.scala.html#723490" title="(bb: DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, idx: Int, m: Int, depth: Int)List[(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)]">findDefs</a><span class="delimiter">(</span><a href="#762733" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>, <a href="#762755" title="Int">idx</a>, <span title="Int(1)" class="int">1</span>, <a href="#762803" title="Int">depth</a><span class="delimiter">)</span>
              <span class="keyword">for</span> <span class="delimiter">(</span><a title="(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)" id="762827">d</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: ((DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)) =&gt; Unit)Unit">defs</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a href="#3319983" title="(x: (DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int))(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#60635" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock" id="762829">bb</a>, <a href="../../../../Tuple2.scala.html#60637" title="Int" id="762830">idx</a><span class="delimiter">)</span> = <a href="#762827" title="(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)">d</a>
                <a href="../icode/BasicBlocks.scala.html#695939" title="(n: Int)DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Instruction">bb</a><span title="Unit" class="delimiter">(</span><a href="#762830" title="Int">idx</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> DUP<a href="#3319997" title="Unit" id="3320000" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703416" title="DeadCodeElimination.this.global.icodes.TypeKind" id="3319998">_</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#762830" title="Int">idx</a> <a href="../../../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span> =&gt;
                    <a href="../icode/BasicBlocks.scala.html#695939" title="(n: Int)DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.Instruction">bb</a><a href="#3320002" title="(x: Unit)Unit" class="delimiter">(</a><a href="#762830" title="Int">idx</a> <a href="../../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                      <span class="keyword">case</span> nw @ NEW<a href="#3319987" title="Unit" id="3319990" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705364" title="DeadCodeElimination.this.global.icodes.REFERENCE" id="3319988">_</a><span class="delimiter">)</span> =&gt;
                        <span class="keyword">val</span> <a title="(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" id="762853">init</a> = <a href="#761600" title="(bb: DeadCodeElimination.this.global.icodes.BasicBlock, i: DeadCodeElimination.this.global.icodes.Instruction)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)">findInstruction</a><span class="delimiter">(</span><a href="#762829" title="DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock">bb</a>, nw.<a href="../icode/Opcodes.scala.html#705371" title="=&gt; DeadCodeElimination.this.global.icodes.opcodes.CALL_METHOD">init</a><span class="delimiter">)</span>
                        <a href="../../Global.scala.html#537516" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;Moving DROP to after &lt;init&gt; call: &quot;)" class="string">&quot;Moving DROP to after &lt;init&gt; call: &quot;</span> <span title="(x$1: Any)String">+</span> nw.<a href="../icode/Opcodes.scala.html#705371" title="=&gt; DeadCodeElimination.this.global.icodes.opcodes.CALL_METHOD">init</a><span class="delimiter">)</span>
                        <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: (DeadCodeElimination.this.global.icodes.BasicBlock, Int), value: List[DeadCodeElimination.this.global.icodes.Instruction])Unit">compensations</a><span class="delimiter">(</span><a href="#762853" title="(DeadCodeElimination.this.global.icodes.BasicBlock, Int)">init</a><span class="delimiter">)</span> = <a href="../../../../collection/immutable/List.scala.html#62451" title="(xs: DeadCodeElimination.this.global.icodes.opcodes.DROP*)List[DeadCodeElimination.this.global.icodes.opcodes.DROP]">List</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#704125" title="(typ: DeadCodeElimination.this.global.icodes.TypeKind)DeadCodeElimination.this.global.icodes.opcodes.DROP">DROP</a><span class="delimiter">(</span><a href="#762802" title="DeadCodeElimination.this.global.icodes.TypeKind">consumedType</a><span class="delimiter">)</span><span class="delimiter">)</span>
                      <span class="keyword">case</span> _ =&gt;
                        <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: (DeadCodeElimination.this.global.icodes.BasicBlock, Int), value: List[DeadCodeElimination.this.global.icodes.Instruction])Unit">compensations</a><span class="delimiter">(</span><a href="#762827" title="(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)">d</a><span class="delimiter">)</span> = <a href="../../../../collection/immutable/List.scala.html#62451" title="(xs: DeadCodeElimination.this.global.icodes.opcodes.DROP*)List[DeadCodeElimination.this.global.icodes.opcodes.DROP]">List</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#704125" title="(typ: DeadCodeElimination.this.global.icodes.TypeKind)DeadCodeElimination.this.global.icodes.opcodes.DROP">DROP</a><span class="delimiter">(</span><a href="#762802" title="DeadCodeElimination.this.global.icodes.TypeKind">consumedType</a><span class="delimiter">)</span><span class="delimiter">)</span>
                    <span class="delimiter">}</span>
                  <span class="keyword">case</span> _ =&gt;
                    <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: (DeadCodeElimination.this.global.icodes.BasicBlock, Int), value: List[DeadCodeElimination.this.global.icodes.Instruction])Unit">compensations</a><span class="delimiter">(</span><a href="#762827" title="(DeadCodeElimination.this.global.icodes.reachingDefinitions.global.icodes.BasicBlock, Int)">d</a><span class="delimiter">)</span> = <a href="../../../../collection/immutable/List.scala.html#62451" title="(xs: DeadCodeElimination.this.global.icodes.opcodes.DROP*)List[DeadCodeElimination.this.global.icodes.opcodes.DROP]">List</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#704125" title="(typ: DeadCodeElimination.this.global.icodes.TypeKind)DeadCodeElimination.this.global.icodes.opcodes.DROP">DROP</a><span class="delimiter">(</span><a href="#762802" title="DeadCodeElimination.this.global.icodes.TypeKind">consumedType</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <a href="#762725" title="scala.collection.mutable.Map[(DeadCodeElimination.this.global.icodes.BasicBlock, Int),List[DeadCodeElimination.this.global.icodes.Instruction]]">compensations</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="[a](bb: DeadCodeElimination.this.global.icodes.BasicBlock)(f: =&gt; a)a" id="761597">withClosed</a><span class="delimiter">[</span><a title="" id="761599">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.BasicBlock" id="762881">bb</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="DeadCodeElimination.this.global.icodes.BasicBlock">BasicBlock</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; a" id="762882">f</a>: =&gt; a<span class="delimiter">)</span>: <a href="#761599" title="a">a</a> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#762881" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695957" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <a href="#762881" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695953" title="()Unit">close</a>
      <span class="keyword">val</span> <a title="a" id="762884">res</a> = <a href="#762882" title="=&gt; a">f</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#762881" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695957" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <a href="#762881" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#695954" title="()Unit">open</a>
      <a href="#762884" title="a">res</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(bb: DeadCodeElimination.this.global.icodes.BasicBlock, i: DeadCodeElimination.this.global.icodes.Instruction)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" id="761600">findInstruction</a><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.BasicBlock" id="762469">bb</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="DeadCodeElimination.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="DeadCodeElimination.this.global.icodes.Instruction" id="762470">i</a>: <a href="../icode/Opcodes.scala.html#614966" title="DeadCodeElimination.this.global.icodes.Instruction">Instruction</a><span class="delimiter">)</span>: <a href="../../../../Tuple2.scala.html#783" title="(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a>BasicBlock, Int<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="DeadCodeElimination.this.global.icodes.BasicBlock" id="762913">b</a> &lt;- <a href="../icode/ICodes.scala.html#614880" title="=&gt; DeadCodeElimination.this.global.icodes.Linearizer">linearizer</a>.<a href="../icode/Linearizers.scala.html#712013" title="(c: DeadCodeElimination.this.global.icodes.IMethod, start: DeadCodeElimination.this.global.icodes.BasicBlock)List[DeadCodeElimination.this.global.icodes.BasicBlock]">linearizeAt</a><a href="../../../../collection/immutable/List.scala.html#62719" title="(f: DeadCodeElimination.this.global.icodes.BasicBlock =&gt; Unit)Unit" class="delimiter">(</a><a href="#761587" title="=&gt; DeadCodeElimination.this.global.icodes.IMethod">method</a>, <a href="#762469" title="DeadCodeElimination.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Int" id="762914">idx</a> = <a href="#762913" title="DeadCodeElimination.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#695929" title="=&gt; List[DeadCodeElimination.this.global.icodes.Instruction]">toList</a> <a href="../../../../collection/GenSeqLike.scala.html#58688" title="(p: DeadCodeElimination.this.global.icodes.Instruction =&gt; Boolean)Int">indexWhere</a> <span class="delimiter">(</span><a href="#762929" title="DeadCodeElimination.this.global.icodes.Instruction">_</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#762470" title="DeadCodeElimination.this.global.icodes.Instruction">i</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#762914" title="Int">idx</a> <a href="../../../../Int.scala.html#57104" title="(x: Int)Boolean">!=</a> -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span>
          <span title="Nothing" class="keyword">return</span> <a href="../../../../Tuple2.scala.html#62849" title="(_1: DeadCodeElimination.this.global.icodes.BasicBlock, _2: Int)(DeadCodeElimination.this.global.icodes.BasicBlock, Int)" class="delimiter">(</a><a href="#762913" title="DeadCodeElimination.this.global.icodes.BasicBlock">b</a>, <a href="#762914" title="Int">idx</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="String(&quot;could not find init in: &quot;)" class="string">&quot;could not find init in: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#761587" title="=&gt; DeadCodeElimination.this.global.icodes.IMethod">method</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: DeadCodeElimination.this.global.Symbol)Boolean" id="761601">isPure</a><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.Symbol" id="762053">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="DeadCodeElimination.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">(</span>
         <span class="delimiter">(</span><a href="#762053" title="DeadCodeElimination.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411203" title="=&gt; Boolean">isGetter</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#762053" title="DeadCodeElimination.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411298" title="=&gt; Boolean">isEffectivelyFinal</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#762053" title="DeadCodeElimination.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#409857" title="=&gt; Boolean">isLazy</a><span class="delimiter">)</span>
      <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#762053" title="DeadCodeElimination.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411287" title="=&gt; Boolean">isPrimaryConstructor</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#762053" title="DeadCodeElimination.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411447" title="=&gt; DeadCodeElimination.this.global.Symbol">enclosingPackage</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#408644" title="=&gt; DeadCodeElimination.this.global.ModuleSymbol">RuntimePackage</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="../../Global.scala.html#537588" title="DeadCodeElimination.this.global.inliner.type">inliner</a>.<a href="Inliners.scala.html#622827" title="(cls: DeadCodeElimination.this.global.inliner.global.Symbol)Boolean">isClosureClass</a><span class="delimiter">(</span><a href="#762053" title="DeadCodeElimination.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; DeadCodeElimination.this.global.Symbol">owner</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">)</span>
    /** Is 'sym' a side-effecting method? TODO: proper analysis.  */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: DeadCodeElimination.this.global.Symbol)Boolean" id="761602">isSideEffecting</a><span class="delimiter">(</span><a title="DeadCodeElimination.this.global.Symbol" id="762052">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="DeadCodeElimination.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#761601" title="(sym: DeadCodeElimination.this.global.Symbol)Boolean">isPure</a><span class="delimiter">(</span><a href="#762052" title="DeadCodeElimination.this.global.Symbol">sym</a><span class="delimiter">)</span>

  <span class="delimiter">}</span> /* DeadCode */
<span title="Object" class="delimiter">}</span>

        </pre>
    </body>
</html>
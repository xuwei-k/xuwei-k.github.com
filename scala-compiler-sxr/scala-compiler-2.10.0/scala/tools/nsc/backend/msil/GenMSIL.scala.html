<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/backend/msil/GenMSIL.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new scala compiler
 * Copyright 2005-2013 LAMP/EPFL
 * @author Nikolay Mihaylov
 */


<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> backend.msil

<span class="keyword">import</span> java.io.<span class="delimiter">{</span>File, IOException<span class="delimiter">}</span>
<span class="keyword">import</span> java.nio.<span class="delimiter">{</span>ByteBuffer, ByteOrder<span class="delimiter">}</span>
<span class="keyword">import</span> scala.collection.<span class="delimiter">{</span> mutable, immutable <span class="delimiter">}</span>
<span class="keyword">import</span> scala.tools.nsc.symtab._

<span class="keyword">import</span> ch.epfl.lamp.compiler.msil.<span class="delimiter">{</span>Type =&gt; MsilType, _<span class="delimiter">}</span>
<span class="keyword">import</span> ch.epfl.lamp.compiler.msil.emit._
<span class="keyword">import</span> ch.epfl.lamp.compiler.msil.util.PECustomMod
<span class="keyword">import</span> scala.<a href="../../../../language.scala.html#1423" title="language.type">language</a>.postfixOps

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class GenMSIL extends scala.tools.nsc.SubComponent" id="32473">GenMSIL</a> <a href="#32473" title="scala.tools.nsc.backend.msil.GenMSIL" class="keyword">extends</a> <a href="../../SubComponent.scala.html#27133" title="scala.tools.nsc.SubComponent">SubComponent</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="../../SubComponent.scala.html#620039" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="../../Global.scala.html#537531" title="=&gt; scala.tools.nsc.symtab.SymbolLoaders{val global: GenMSIL.this.global.type}">loaders</a>.clrTypes
  <span class="keyword">import</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<span class="delimiter">{</span>types, constructors, methods, fields<span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="../../Global.scala.html#537466" title="GenMSIL.this.global.icodes.type">icodes</a>._
  <span class="keyword">import</span> <a href="../../Global.scala.html#537466" title="GenMSIL.this.global.icodes.type">icodes</a>.<a href="../icode/Opcodes.scala.html#614967" title="GenMSIL.this.global.icodes.opcodes.type">opcodes</a>._

  <span class="keyword">val</span> <a title="loaders extends scala.tools.nsc.symtab.SymbolLoaders" id="693680">x</a> = <a href="../../Global.scala.html#537531" title="=&gt; scala.tools.nsc.symtab.SymbolLoaders{val global: GenMSIL.this.global.type}">loaders</a>

  /** Create a new phase */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(p: scala.tools.nsc.Phase)GenMSIL.this.MsilPhase" id="693682">newPhase</a><span class="delimiter">(</span><a title="scala.tools.nsc.Phase" id="751765">p</a>: <a href="../../../../reflect/internal/Phase.scala.html#19756" title="scala.tools.nsc.Phase">Phase</a><span class="delimiter">)</span> = <span title="GenMSIL.this.MsilPhase" class="keyword">new</span> <a href="#693685" title="GenMSIL.this.MsilPhase">MsilPhase</a><span class="delimiter">(</span><a href="#751765" title="scala.tools.nsc.Phase">p</a><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="String" id="693683">phaseName</a> = <span title="String(&quot;msil&quot;)" class="string">&quot;msil&quot;</span>
  /** MSIL code generation phase
   */
  <span class="keyword">class</span> <a title="class MsilPhase extends GenMSIL.this.global.GlobalPhase" id="693685">MsilPhase</a><a href="#693685" title="GenMSIL.this.MsilPhase" class="delimiter">(</a><a title="scala.tools.nsc.Phase" id="751774">prev</a>: <a href="../../../../reflect/internal/Phase.scala.html#19756" title="scala.tools.nsc.Phase">Phase</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../Global.scala.html#537541" title="GenMSIL.this.global.GlobalPhase">GlobalPhase</a><span class="delimiter">(</span><a href="#751774" title="scala.tools.nsc.Phase">prev</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; String" id="751769">name</a> = <a href="#693683" title="=&gt; String">phaseName</a>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Long" id="751770">newFlags</a> = <a href="../../SubComponent.scala.html#620048" title="=&gt; Long">phaseNewFlags</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="751771">erasedTypes</a> = <span title="Boolean(true)" class="keyword">true</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="751772">run</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#540057" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#541066" title="=&gt; Boolean">value</a><span class="delimiter">)</span> <a href="../../Global.scala.html#537494" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="String(&quot;[running phase &quot;)" class="string">&quot;[running phase &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751769" title="=&gt; String">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; on icode]&quot;)" class="string">&quot; on icode]&quot;</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="GenMSIL.this.BytecodeGenerator" id="751781">codeGenerator</a> = <span title="GenMSIL.this.BytecodeGenerator" class="keyword">new</span> <a href="#693686" title="GenMSIL.this.BytecodeGenerator">BytecodeGenerator</a>

      //classes is ICodes.classes, a HashMap[Symbol, IClass]
      <a href="../icode/ICodes.scala.html#614876" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88257" title="=&gt; Iterable[GenMSIL.this.global.icodes.IClass]">values</a> <a href="../../../../collection/IterableLike.scala.html#58562" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#751781" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#751949" title="(cls: GenMSIL.this.global.icodes.IClass)Unit">findEntryPoint</a>
      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span> <a href="../../Global.scala.html#537522" title="GenMSIL.this.global.opt.type">opt</a>.<a href="../../Global.scala.html#545441" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#751781" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#751943" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">)</span> <span class="delimiter">{</span> // TODO introduce dedicated setting instead
        <span class="keyword">val</span> <a title="String" id="752015">entryclass</a> = <a href="../../Global.scala.html#537522" title="GenMSIL.this.global.opt.type">opt</a>.<a href="../../Global.scala.html#545441" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#62858" title="=&gt; GenMSIL.this.global.Name">get</a>.<span title="()String">toString</span>
        <a href="../../Global.scala.html#537496" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="String(&quot;Couldn\'t find entry class &quot;)" class="string">&quot;Couldn't find entry class &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#752015" title="String">entryclass</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#751781" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#751885" title="()Unit">initAssembly</a>

      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.IClass]" id="751782">classesSorted</a> = <a href="../icode/ICodes.scala.html#614876" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88257" title="=&gt; Iterable[GenMSIL.this.global.icodes.IClass]">values</a>.<a href="../../../../collection/TraversableOnce.scala.html#58263" title="=&gt; List[GenMSIL.this.global.icodes.IClass]">toList</a>.<a href="../../../../collection/SeqLike.scala.html#58869" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Int)(implicit ord: scala.math.Ordering[Int])List[GenMSIL.this.global.icodes.IClass]">sortBy</a><a href="../../../../math/Ordering.scala.html#82238" title="scala.math.Ordering.Int.type" class="delimiter">(</a><a title="GenMSIL.this.global.icodes.IClass" id="752024">c</a> =&gt; <a href="#752024" title="GenMSIL.this.global.icodes.IClass">c</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411094" title="=&gt; Int">id</a><span class="delimiter">)</span> // simplifies comparing cross-compiler vs. .exe output
      <a href="#751782" title="List[GenMSIL.this.global.icodes.IClass]">classesSorted</a> <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#751781" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#751956" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createTypeBuilder</a>
      <a href="#751782" title="List[GenMSIL.this.global.icodes.IClass]">classesSorted</a> <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#751781" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#751957" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createClassMembers</a>

      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="#751782" title="List[GenMSIL.this.global.icodes.IClass]">classesSorted</a> <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#751781" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#751892" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">genClass</a>
      <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
        <a href="#751781" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#751889" title="()Unit">writeAssembly</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(unit: GenMSIL.this.global.CompilationUnit)Unit" id="751773">apply</a><span class="delimiter">(</span><a title="GenMSIL.this.global.CompilationUnit" id="752139">unit</a>: <a href="../../CompilationUnits.scala.html#537766" title="GenMSIL.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="String(&quot;MSIL works on icode classes, not on compilation units!&quot;)" class="string">&quot;MSIL works on icode classes, not on compilation units!&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /**
   * MSIL bytecode generator.
   *
   */
  <span class="keyword">class</span> <a title="class BytecodeGenerator extends Object" id="693686">BytecodeGenerator</a> <a href="#693686" title="GenMSIL.this.BytecodeGenerator" class="delimiter">{</a>

    <span class="keyword">val</span> <a title="String" id="751793">MODULE_INSTANCE_NAME</a> = <span title="String(&quot;MODULE$&quot;)" class="string">&quot;MODULE$&quot;</span>

    <span class="keyword">import</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<span class="delimiter">{</span>VOID =&gt; MVOID, BOOLEAN =&gt; MBOOL, BYTE =&gt; MBYTE, SHORT =&gt; MSHORT,
                   CHAR =&gt; MCHAR, INT =&gt; MINT, LONG =&gt; MLONG, FLOAT =&gt; MFLOAT,
                   DOUBLE =&gt; MDOUBLE, OBJECT =&gt; MOBJECT, STRING =&gt; MSTRING,
                   STRING_ARRAY =&gt; MSTRING_ARRAY,
                   SYMTAB_CONSTR =&gt; SYMTAB_ATTRIBUTE_CONSTRUCTOR,
                   SYMTAB_DEFAULT_CONSTR =&gt; SYMTAB_ATTRIBUTE_EMPTY_CONSTRUCTOR<span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="751796">EXCEPTION</a> = <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694113" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.Exception&quot;)" class="string">&quot;System.Exception&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="751798">MBYTE_ARRAY</a> = <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694115" title="(elemType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">mkArrayType</a><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#694023" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBYTE</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="751800">ICLONEABLE</a> = <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694113" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.ICloneable&quot;)" class="string">&quot;System.ICloneable&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751802">MEMBERWISE_CLONE</a> = <a href="../../symtab/clr/CLRTypes.scala.html#694068" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;MemberwiseClone&quot;)" class="string">&quot;MemberwiseClone&quot;</span>, <span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="751804">MMONITOR</a>       = <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694113" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.Threading.Monitor&quot;)" class="string">&quot;System.Threading.Monitor&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751806">MMONITOR_ENTER</a> = <a href="#751804" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MMONITOR</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;Enter&quot;)" class="string">&quot;Enter&quot;</span>, <a href="../../../../Array.scala.html#72260" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#694068" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751808">MMONITOR_EXIT</a>  = <a href="#751804" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MMONITOR</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;Exit&quot;)" class="string">&quot;Exit&quot;</span>, <a href="../../../../Array.scala.html#72260" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#694068" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="751810">MSTRING_BUILDER</a> = <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694113" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.Text.StringBuilder&quot;)" class="string">&quot;System.Text.StringBuilder&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="751812">MSTRING_BUILDER_CONSTR</a> = <a href="#751810" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_BUILDER</a>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751814">MSTRING_BUILDER_TOSTRING</a> = <a href="#751810" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_BUILDER</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToString&quot;)" class="string">&quot;ToString&quot;</span>,
                                                             <span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751816">TYPE_FROM_HANDLE</a> =
      <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694113" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.Type&quot;)" class="string">&quot;System.Type&quot;</span><span class="delimiter">)</span>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;GetTypeFromHandle&quot;)" class="string">&quot;GetTypeFromHandle&quot;</span>, <a href="../../../../Array.scala.html#72260" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694113" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.RuntimeTypeHandle&quot;)" class="string">&quot;System.RuntimeTypeHandle&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="751818">INT_PTR</a> = <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694113" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.IntPtr&quot;)" class="string">&quot;System.IntPtr&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="GenMSIL.this.global.ClassSymbol" id="751820">JOBJECT</a> = <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408671" title="=&gt; GenMSIL.this.global.ClassSymbol">ObjectClass</a>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.ClassSymbol" id="751822">JSTRING</a> = <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408722" title="=&gt; GenMSIL.this.global.ClassSymbol">StringClass</a>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="751824">SystemConvert</a> = <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694113" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.Convert&quot;)" class="string">&quot;System.Convert&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="751826">objParam</a> = <a href="../../../../Array.scala.html#72260" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#694068" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751828">toBool</a>:   <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751824" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToBoolean&quot;)" class="string">&quot;ToBoolean&quot;</span>, <a href="#751826" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span> // see comment in emitUnbox
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751830">toSByte</a>:  <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751824" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToSByte&quot;)" class="string">&quot;ToSByte&quot;</span>,   <a href="#751826" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751832">toShort</a>:  <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751824" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToInt16&quot;)" class="string">&quot;ToInt16&quot;</span>,   <a href="#751826" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751834">toChar</a>:   <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751824" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToChar&quot;)" class="string">&quot;ToChar&quot;</span>,    <a href="#751826" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751836">toInt</a>:    <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751824" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToInt32&quot;)" class="string">&quot;ToInt32&quot;</span>,   <a href="#751826" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751838">toLong</a>:   <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751824" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToInt64&quot;)" class="string">&quot;ToInt64&quot;</span>,   <a href="#751826" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751840">toFloat</a>:  <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751824" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToSingle&quot;)" class="string">&quot;ToSingle&quot;</span>,  <a href="#751826" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="751842">toDouble</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751824" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToDouble&quot;)" class="string">&quot;ToDouble&quot;</span>,  <a href="#751826" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>

    //val boxedUnit: FieldInfo = msilType(definitions.BoxedUnitModule.info).GetField(&quot;UNIT&quot;)
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="751844">boxedUnit</a>: <span title="ch.epfl.lamp.compiler.msil.FieldInfo">FieldInfo</span> = <a href="../../../../collection/MapLike.scala.html#87535" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">fields</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409145" title="=&gt; GenMSIL.this.global.TermSymbol">BoxedUnit_UNIT</a><span class="delimiter">)</span>

    // Scala attributes
    // symtab.Definitions -&gt; object (singleton..)
    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="751846">SerializableAttr</a> = <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409163" title="=&gt; GenMSIL.this.global.ClassSymbol">SerializableAttr</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411559" title="=&gt; GenMSIL.this.global.Type">tpe</a>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="751848">CloneableAttr</a>    = <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409179" title="=&gt; GenMSIL.this.global.ClassSymbol">CloneableAttr</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411559" title="=&gt; GenMSIL.this.global.Type">tpe</a>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="751850">TransientAtt</a>     = <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409203" title="=&gt; GenMSIL.this.global.ClassSymbol">TransientAttr</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411559" title="=&gt; GenMSIL.this.global.Type">tpe</a>
    // remoting: the architectures are too different, no mapping (no portable code
    // possible)

    // java instance methods that are mapped to static methods in .net
    // these will need to be called with OpCodes.Call (not Callvirt)
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" id="751852">dynToStatMapped</a> = mutable.<a href="../../../../collection/generic/GenericCompanion.scala.html#59933" title="[A](elems: A*)scala.collection.mutable.HashSet[A]">HashSet</a><span title="(elems: GenMSIL.this.global.Symbol*)scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" class="delimiter">[</span><a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <a href="#751854" title="()Unit">initMappings</a><span class="delimiter">(</span><span class="delimiter">)</span>

    /** Create the mappings between java and .net classes and methods */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="751854">initMappings</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408667" title="=&gt; GenMSIL.this.global.ClassSymbol">AnyClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694068" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408669" title="=&gt; GenMSIL.this.global.AliasTypeSymbol">AnyRefClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694068" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span>
      //mapType(definitions.NullClass, clrTypes.getType(&quot;scala.AllRef$&quot;))
      //mapType(definitions.NothingClass, clrTypes.getType(&quot;scala.All$&quot;))
      // FIXME: for some reason the upper two lines map to null
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408694" title="GenMSIL.this.global.definitions.NullClass.type">NullClass</a>, <a href="#751796" title="=&gt; ch.epfl.lamp.compiler.msil.Type">EXCEPTION</a><span class="delimiter">)</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408692" title="GenMSIL.this.global.definitions.NothingClass.type">NothingClass</a>, <a href="#751796" title="=&gt; ch.epfl.lamp.compiler.msil.Type">EXCEPTION</a><span class="delimiter">)</span>

      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409369" title="=&gt; GenMSIL.this.global.ClassSymbol">BooleanClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694056" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBOOL</a><span class="delimiter">)</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409355" title="=&gt; GenMSIL.this.global.ClassSymbol">ByteClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694023" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBYTE</a><span class="delimiter">)</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409357" title="=&gt; GenMSIL.this.global.ClassSymbol">ShortClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694029" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSHORT</a><span class="delimiter">)</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409359" title="=&gt; GenMSIL.this.global.ClassSymbol">CharClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694035" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MCHAR</a><span class="delimiter">)</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409361" title="=&gt; GenMSIL.this.global.ClassSymbol">IntClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694038" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MINT</a><span class="delimiter">)</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409363" title="=&gt; GenMSIL.this.global.ClassSymbol">LongClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694044" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MLONG</a><span class="delimiter">)</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409365" title="=&gt; GenMSIL.this.global.ClassSymbol">FloatClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694050" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MFLOAT</a><span class="delimiter">)</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409367" title="=&gt; GenMSIL.this.global.ClassSymbol">DoubleClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694053" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MDOUBLE</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.IClass" id="751856">clasz</a>: <a href="../icode/Members.scala.html#614923" title="GenMSIL.this.global.icodes.IClass">IClass</a> = _
    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.IMethod" id="751859">method</a>: <a href="../icode/Members.scala.html#614927" title="GenMSIL.this.global.icodes.IMethod">IMethod</a> = _

    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder" id="751862">massembly</a>: <span title="ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">AssemblyBuilder</span> = _
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.ModuleBuilder" id="751865">mmodule</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">ModuleBuilder</span> = _
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="751868">mcode</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span> = _

    <span class="keyword">var</span> <a title="String" id="751871">assemName</a>: <span title="String">String</span> = _
    <span class="keyword">var</span> <a title="String" id="751874">firstSourceName</a> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">var</span> <a title="java.io.File" id="751877">outDir</a>: <span title="java.io.File">File</span> = _
    <span class="keyword">var</span> <a title="java.io.File" id="751880">srcPath</a>: <span title="java.io.File">File</span> = _
    <span class="keyword">var</span> <a title="String" id="751883">moduleName</a>: <span title="String">String</span> = _

    <span class="keyword">def</span> <a title="()Unit" id="751885">initAssembly</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>

      <a href="#751871" title="(x$1: String)Unit">assemName</a> = <a href="../../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#539953" title="=&gt; scala.tools.nsc.Settings#StringSetting">assemname</a>.<a href="../../../../reflect/internal/settings/MutableSettings.scala.html#423752" title="=&gt; String">value</a>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751871" title="=&gt; String">assemName</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751943" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#751871" title="(x$1: String)Unit">assemName</a> = <a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#751943" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411422" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
          // remove the $ at the end (from module-name)
          <a href="#751871" title="(x$1: String)Unit">assemName</a> = <a href="#751871" title="=&gt; String">assemName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#751871" title="=&gt; String">assemName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          // assuming filename of first source file
          <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#751874" title="=&gt; String">firstSourceName</a>.<span title="(x$1: String)Boolean">endsWith</span><span class="delimiter">(</span><span title="String(&quot;.scala&quot;)" class="string">&quot;.scala&quot;</span><span class="delimiter">)</span>, <a href="#751874" title="=&gt; String">firstSourceName</a><span class="delimiter">)</span>
          <a href="#751871" title="(x$1: String)Unit">assemName</a> = <a href="#751874" title="=&gt; String">firstSourceName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#751874" title="=&gt; String">firstSourceName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(6)" class="int">6</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751871" title="=&gt; String">assemName</a>.<span title="(x$1: String)Boolean">endsWith</span><span class="delimiter">(</span><span title="String(&quot;.msil&quot;)" class="string">&quot;.msil&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#751871" title="(x$1: String)Unit">assemName</a> = <a href="#751871" title="=&gt; String">assemName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#751871" title="=&gt; String">assemName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span><a href="../../../../Int.scala.html#57161" title="(x: Int)Int">-</a><span title="Int(5)" class="int">5</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751871" title="=&gt; String">assemName</a>.<span title="(x$1: String)Boolean">endsWith</span><span class="delimiter">(</span><span title="String(&quot;.il&quot;)" class="string">&quot;.il&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#751871" title="(x$1: String)Unit">assemName</a> = <a href="#751871" title="=&gt; String">assemName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#751871" title="=&gt; String">assemName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span><a href="../../../../Int.scala.html#57161" title="(x: Int)Int">-</a><span title="Int(3)" class="int">3</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="java.io.File" id="752807">f</a>: <span title="java.io.File">File</span> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#751871" title="=&gt; String">assemName</a><span class="delimiter">)</span>
        <a href="#751871" title="(x$1: String)Unit">assemName</a> = <a href="#752807" title="java.io.File">f</a>.<span title="()String">getName</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#751877" title="(x$1: java.io.File)Unit">outDir</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="../../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#540035" title="=&gt; scala.tools.nsc.Settings#OutputSetting">outdir</a>.<a href="../../../../reflect/internal/settings/MutableSettings.scala.html#423752" title="=&gt; String">value</a><span class="delimiter">)</span>

      <a href="#751880" title="(x$1: java.io.File)Unit">srcPath</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="../../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#539959" title="=&gt; scala.tools.nsc.Settings#StringSetting">sourcedir</a>.<a href="../../../../reflect/internal/settings/MutableSettings.scala.html#423752" title="=&gt; String">value</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.AssemblyName" id="752773">assemblyName</a> = <span title="ch.epfl.lamp.compiler.msil.AssemblyName" class="keyword">new</span> <span title="ch.epfl.lamp.compiler.msil.AssemblyName">AssemblyName</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#752773" title="ch.epfl.lamp.compiler.msil.AssemblyName">assemblyName</a>.<span title="String">Name</span> = <a href="#751871" title="=&gt; String">assemName</a>
      <a href="#751862" title="(x$1: ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder)Unit">massembly</a> = <span title="ch.epfl.lamp.compiler.msil.emit.AssemblyBuilderFactory.type">AssemblyBuilderFactory</span>.<span title="(name: ch.epfl.lamp.compiler.msil.AssemblyName)ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">DefineDynamicAssembly</span><span class="delimiter">(</span><a href="#752773" title="ch.epfl.lamp.compiler.msil.AssemblyName">assemblyName</a><span class="delimiter">)</span>

      <a href="#751883" title="(x$1: String)Unit">moduleName</a> = <a href="#751871" title="=&gt; String">assemName</a> // + (if (entryPoint == null) &quot;.dll&quot; else &quot;.exe&quot;)
      // filename here: .dll or .exe (in both parameters), second: give absolute-path
      <a href="#751865" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ModuleBuilder)Unit">mmodule</a> = <a href="#751862" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(name: String, fileName: String)ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">DefineDynamicModule</span><span class="delimiter">(</span><a href="#751883" title="=&gt; String">moduleName</a>,
                                              <span title="(x$1: java.io.File, x$2: String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#751877" title="=&gt; java.io.File">outDir</a>, <a href="#751883" title="=&gt; String">moduleName</a><span class="delimiter">)</span>.<span title="()String">getAbsolutePath</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../Global.scala.html#537498" title="(assertion: Boolean)Unit">assert</a> <span class="delimiter">(</span><a href="#751865" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>


    /**
     * Form of the custom Attribute parameter (Ecma-335.pdf)
     *      - p. 163 for CustomAttrib Form,
     *      - p. 164 for FixedArg Form (Array and Element) (if array or not is known!)
     *  !! least significant byte first if values longer than one byte !!
     *
     * 1: Prolog (unsigned int16, value 0x0001) -&gt; symtab[0] = 0x01, symtab[1] = 0x00
     * 2: FixedArgs (directly the data, get number and types from related constructor)
     *  2.1: length of the array (unsigned int32, 4 bytes, least significant first)
     *  2.2: the byte array data
     * 3: NumNamed (unsigned int16, number of named fields and properties, 0x0000)
     */
    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, tBuilder: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit" id="751886">addSymtabAttribute</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="752964">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="752965">tBuilder</a>: <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="752966">addMarker</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Array[Byte]" id="752967">markerSymtab</a> = <span title="Array[Byte]" class="keyword">new</span> <a href="../../../../Array.scala.html#174" title="Array[Byte]">Array</a><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span>
        <a href="../../../../Array.scala.html#56640" title="(i: Int, x: Byte)Unit">markerSymtab</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <span title="Int(1)" class="int">1</span>.<a href="../../../../Int.scala.html#57077" title="=&gt; Byte">toByte</a>
        <a href="#752965" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(constr: ch.epfl.lamp.compiler.msil.ConstructorInfo, value: Array[Byte])Unit">SetCustomAttribute</span><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#694086" title="=&gt; ch.epfl.lamp.compiler.msil.ConstructorInfo">SYMTAB_ATTRIBUTE_EMPTY_CONSTRUCTOR</a>, <a href="#752967" title="Array[Byte]">markerSymtab</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      // both conditions are needed (why exactly..?)
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#752965" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="String">Name</span>.<span title="(x$1: String)Boolean">endsWith</span><span class="delimiter">(</span><span title="String(&quot;$&quot;)" class="string">&quot;$&quot;</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#752964" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402404" title="=&gt; Boolean">isModuleClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#752966" title="()Unit">addMarker</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#537672" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#539345" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.internal.pickling.PickleBuffer]">symData</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88246" title="(key: GenMSIL.this.global.Symbol)Option[scala.reflect.internal.pickling.PickleBuffer]">get</a><span title="Unit" class="delimiter">(</span><a href="#752964" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Some<a href="#3318128" title="Unit" id="3318129" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="scala.reflect.internal.pickling.PickleBuffer" id="752982">pickle</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">var</span> <a title="Int" id="752983">size</a> = <a href="#752982" title="scala.reflect.internal.pickling.PickleBuffer">pickle</a>.<a href="../../../../reflect/internal/pickling/PickleBuffer.scala.html#508587" title="=&gt; Int">writeIndex</a>
            <span class="keyword">val</span> <a title="Array[Byte]" id="752984">symtab</a> = <span title="Array[Byte]" class="keyword">new</span> <a href="../../../../Array.scala.html#174" title="Array[Byte]">Array</a><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><a href="#752983" title="Int">size</a> <a href="../../../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>
            <a href="../../../../Array.scala.html#56640" title="(i: Int, x: Byte)Unit">symtab</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <span title="Int(1)" class="int">1</span>.<a href="../../../../Int.scala.html#57077" title="=&gt; Byte">toByte</a>
            <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="753122">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#7395" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">2</a> <a href="../../../../collection/immutable/Range.scala.html#81297" title="(f: Int =&gt; Unit)Unit">until</a> <span title="Int(6)" class="int">6</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="../../../../Array.scala.html#56640" title="(i: Int, x: Byte)Unit">symtab</a><span class="delimiter">(</span><a href="#753122" title="Int">i</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#752983" title="Int">size</a> <a href="../../../../Int.scala.html#57144" title="(x: Int)Int">&amp;</a> <span title="Int(255)" class="int">0xff</span><span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57077" title="=&gt; Byte">toByte</a>
              <a href="#752983" title="Int">size</a> = <a href="#752983" title="Int">size</a> <a href="../../../../Int.scala.html#57092" title="(x: Int)Int">&gt;&gt;</a> <span title="Int(8)" class="int">8</span>
            <span class="delimiter">}</span>
            java.lang.<span title="System.type">System</span>.<span title="(x$1: Any, x$2: Int, x$3: Any, x$4: Int, x$5: Int)Unit">arraycopy</span><span class="delimiter">(</span><a href="#752982" title="scala.reflect.internal.pickling.PickleBuffer">pickle</a>.<a href="../../../../reflect/internal/pickling/PickleBuffer.scala.html#508581" title="=&gt; Array[Byte]">bytes</a>, <span title="Int(0)" class="int">0</span>, <a href="#752984" title="Array[Byte]">symtab</a>, <span title="Int(6)" class="int">6</span>, <a href="#752982" title="scala.reflect.internal.pickling.PickleBuffer">pickle</a>.<a href="../../../../reflect/internal/pickling/PickleBuffer.scala.html#508587" title="=&gt; Int">writeIndex</a><span class="delimiter">)</span>

            <a href="#752965" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(constr: ch.epfl.lamp.compiler.msil.ConstructorInfo, value: Array[Byte])Unit">SetCustomAttribute</span><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#694083" title="=&gt; ch.epfl.lamp.compiler.msil.ConstructorInfo">SYMTAB_ATTRIBUTE_CONSTRUCTOR</a>, <a href="#752984" title="Array[Byte]">symtab</a><span class="delimiter">)</span>

            <a href="../../Global.scala.html#537672" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#539345" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.internal.pickling.PickleBuffer]">symData</a> <a href="../../../../collection/mutable/HashMap.scala.html#88251" title="(key: GenMSIL.this.global.Symbol)scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.internal.pickling.PickleBuffer]">-=</a> <a href="#752964" title="GenMSIL.this.global.Symbol">sym</a>
            <a href="../../Global.scala.html#537672" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#539345" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.internal.pickling.PickleBuffer]">symData</a> <a href="../../../../collection/mutable/HashMap.scala.html#88251" title="(key: GenMSIL.this.global.Symbol)scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.internal.pickling.PickleBuffer]">-=</a> <a href="#752964" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411455" title="=&gt; GenMSIL.this.global.Symbol">companionSymbol</a>

          <span class="keyword">case</span> _ =&gt;
            <a href="#752966" title="()Unit">addMarker</a><a href="#3318131" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /**
     * Mutates `member` adding CLR attributes (if any) based on sym.annotations.
     * Please notice that CLR custom modifiers are a different beast (see customModifiers below)
     * and thus shouldn't be added by this method.
     */
    <span class="keyword">def</span> <a title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit" id="751887">addAttributes</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter" id="753166">member</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter">ICustomAttributeSetter</span>, <a title="List[GenMSIL.this.global.AnnotationInfo]" id="753167">annotations</a>: <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[Null]" id="753168">attributes</a> = <a href="#753167" title="List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/TraversableLike.scala.html#58063" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; GenMSIL.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.AnnotationInfo],GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]])List[GenMSIL.this.global.Symbol]">map</a><a href="../../../../collection/immutable/List.scala.html#62442" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]]" class="delimiter">(</a><a href="#753185" title="GenMSIL.this.global.AnnotationInfo">_</a>.<a href="../../../../reflect/internal/AnnotationInfos.scala.html#409727" title="=&gt; GenMSIL.this.global.Type">atp</a>.<a href="../../../../reflect/internal/Types.scala.html#408407" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableLike.scala.html#58075" title="(pf: PartialFunction[GenMSIL.this.global.Symbol,Null])(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Symbol],Null,List[Null]])List[Null]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[GenMSIL.this.global.Symbol,Null] with Serializable" id="753240" class="delimiter">{</a>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409203" title="B1" id="3318152">TransientAttr</a> =&gt; <a href="#3318141" title="(x: B1)B1" class="keyword">null</a> // TODO this is just an example
      <span class="delimiter">}</span>
      <span title="Nothing" class="keyword">return</span> // TODO: implement at some point
    <span class="delimiter">}</span>

    /**
     * What's a CLR custom modifier? Intro available as source comments in compiler.msil.CustomModifier.
     * It's basically a marker associated with a location (think of FieldInfo, ParameterInfo, and PropertyInfo)
     * and thus that marker (be it optional or required) becomes part of the signature of that location.
     * Some annotations will become CLR attributes (see addAttributes above), others custom modifiers (this method).
     */
    <span class="keyword">def</span> <a title="(annotations: List[GenMSIL.this.global.AnnotationInfo])Array[ch.epfl.lamp.compiler.msil.CustomModifier]" id="751888">customModifiers</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.AnnotationInfo]" id="753293">annotations</a>: <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../Array.scala.html#174" title="Array[ch.epfl.lamp.compiler.msil.CustomModifier]">Array</a><span class="delimiter">[</span>CustomModifier<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#753293" title="List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/TraversableLike.scala.html#58063" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; GenMSIL.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.AnnotationInfo],GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]])List[GenMSIL.this.global.Symbol]">map</a><a href="../../../../collection/immutable/List.scala.html#62442" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]]" class="delimiter">(</a><a href="#753320" title="GenMSIL.this.global.AnnotationInfo">_</a>.<a href="../../../../reflect/internal/AnnotationInfos.scala.html#409727" title="=&gt; GenMSIL.this.global.Type">atp</a>.<a href="../../../../reflect/internal/Types.scala.html#408407" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableLike.scala.html#58075" title="(pf: PartialFunction[GenMSIL.this.global.Symbol,ch.epfl.lamp.compiler.msil.CustomModifier])(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Symbol],ch.epfl.lamp.compiler.msil.CustomModifier,List[ch.epfl.lamp.compiler.msil.CustomModifier]])List[ch.epfl.lamp.compiler.msil.CustomModifier]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[GenMSIL.this.global.Symbol,ch.epfl.lamp.compiler.msil.CustomModifier] with Serializable" id="753371" class="delimiter">{</a>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409209" title="B1" id="3318177">VolatileAttr</a>  =&gt; <a href="#3318166" title="(x: B1)B1" class="keyword">new</a> <span title="ch.epfl.lamp.compiler.msil.CustomModifier">CustomModifier</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="ch.epfl.lamp.compiler.msil.CustomModifier.type">CustomModifier</span>.<span title="()ch.epfl.lamp.compiler.msil.Type">VolatileMarker</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <a href="../../../../collection/TraversableOnce.scala.html#58259" title="(implicit evidence$1: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.CustomModifier])Array[ch.epfl.lamp.compiler.msil.CustomModifier]">toArray</a>
    <span class="delimiter">}</span>



    /*
      debuglog(&quot;creating annotations: &quot; + annotations + &quot; for member : &quot; + member)
      for (annot@ AnnotationInfo(typ, annArgs, nvPairs) &lt;- annotations ;
           if annot.isConstant)
           //!typ.typeSymbol.isJavaDefined
      {
//        assert(consts.length &lt;= 1,
//               &quot;too many constant arguments for annotations; &quot;+consts.toString())

        // Problem / TODO having the symbol of the annotations type would be nicer
        // (i hope that type.typeSymbol is the same as the one in types2create)
        // AND: this will crash if the annotations Type is already compiled (-&gt; not a typeBuilder)
        // when this is solved, types2create will be the same as icodes.classes, thus superfluous
        val annType: TypeBuilder = getType(typ.typeSymbol).asInstanceOf[TypeBuilder]
//        val annType: MsilType = getType(typ.typeSymbol)

        // Problem / TODO: i have no idea which constructor is used. This
        // information should be available in AnnotationInfo.
        annType.CreateType() // else, GetConstructors can't be used
        val constr: ConstructorInfo = annType.GetConstructors()(0)
        // prevent a second call of CreateType, only needed because there's no
        // other way than GetConstructors()(0) to get the constructor, if there's
        // no constructor symbol available.

        val args: Array[Byte] =
          getAttributeArgs(
            annArgs map (_.constant.get),
            (for((n,v) &lt;- nvPairs) yield (n, v.constant.get)))
        member.SetCustomAttribute(constr, args)
      }
    } */

/*    def getAttributeArgs(consts: List[Constant], nvPairs: List[(Name, Constant)]): Array[Byte] = {
      val buf = ByteBuffer.allocate(2048) // FIXME: this may be not enough!
      buf.order(ByteOrder.LITTLE_ENDIAN)
      buf.putShort(1.toShort) // signature

      def emitSerString(str: String) = {
          // this is wrong, it has to be the length of the UTF-8 byte array, which
          // may be longer (see clr-book on page 302)
//          val length: Int = str.length
            val strBytes: Array[Byte] = try {
              str.getBytes(&quot;UTF-8&quot;)
            } catch {
              case _: Error =&gt; abort(&quot;could not get byte-array for string: &quot; + str)
            }
            val length: Int = strBytes.length //this length is stored big-endian
            if (length &lt; 128)
              buf.put(length.toByte)
            else if (length &lt; (1&lt;&lt;14)) {
              buf.put(((length &gt;&gt; 8) | 0x80).toByte) // the bits 14 and 15 of length are '0'
              buf.put((length | 0xff).toByte)
            } else if (length &lt; (1 &lt;&lt; 29)) {
              buf.put(((length &gt;&gt; 24) | 0xc0).toByte)
              buf.put(((length &gt;&gt; 16) &amp; 0xff).toByte)
              buf.put(((length &gt;&gt;  8) &amp; 0xff).toByte)
              buf.put(((length      ) &amp; 0xff).toByte)
            } else
              abort(&quot;string too long for attribute parameter: &quot; + length)
            buf.put(strBytes)
      }

      def emitConst(const: Constant): Unit = const.tag match {
        case BooleanTag =&gt; buf.put((if (const.booleanValue) 1 else 0).toByte)
        case ByteTag =&gt; buf.put(const.byteValue)
        case ShortTag =&gt; buf.putShort(const.shortValue)
        case CharTag =&gt; buf.putChar(const.charValue)
        case IntTag =&gt; buf.putInt(const.intValue)
        case LongTag =&gt; buf.putLong(const.longValue)
        case FloatTag =&gt; buf.putFloat(const.floatValue)
        case DoubleTag =&gt; buf.putDouble(const.doubleValue)
        case StringTag =&gt;
          val str: String = const.stringValue
          if (str == null) {
            buf.put(0xff.toByte)
          } else {
            emitSerString(str)
          }
        case ArrayTag =&gt;
          val arr: Array[Constant] = const.arrayValue
          if (arr == null) {
            buf.putInt(0xffffffff)
          } else {
            buf.putInt(arr.length)
            arr.foreach(emitConst)
          }

        // TODO: other Tags: NoTag, UnitTag, ClazzTag, EnumTag, ArrayTag ???

        case _ =&gt; abort(&quot;could not handle attribute argument: &quot; + const)
      }

      consts foreach emitConst
      buf.putShort(nvPairs.length.toShort)
      def emitNamedArg(nvPair: (Name, Constant)) {
        // the named argument is a property of the attribute (it can't be a field, since
        //  all fields in scala are private)
        buf.put(0x54.toByte)

        def emitType(c: Constant) = c.tag match { // type of the constant, Ecma-335.pdf, page 151
          case BooleanTag =&gt; buf.put(0x02.toByte)
          case ByteTag =&gt;    buf.put(0x05.toByte)
          case ShortTag =&gt;   buf.put(0x06.toByte)
          case CharTag =&gt;    buf.put(0x07.toByte)
          case IntTag =&gt;     buf.put(0x08.toByte)
          case LongTag =&gt;    buf.put(0x0a.toByte)
          case FloatTag =&gt;   buf.put(0x0c.toByte)
          case DoubleTag =&gt;  buf.put(0x0d.toByte)
          case StringTag =&gt;  buf.put(0x0e.toByte)

          // TODO: other Tags: NoTag, UnitTag, ClazzTag, EnumTag ???

          // ArrayTag falls in here
          case _ =&gt; abort(&quot;could not handle attribute argument: &quot; + c)
        }

        val cnst: Constant = nvPair._2
        if (cnst.tag == ArrayTag) {
          buf.put(0x1d.toByte)
          emitType(cnst.arrayValue(0)) // FIXME: will crash if array length = 0
        } else if (cnst.tag == EnumTag) {
          buf.put(0x55.toByte)
          // TODO: put a SerString (don't know what exactly, names of the enums somehow..)
              } else {
          buf.put(0x51.toByte)
          emitType(cnst)
        }

        emitSerString(nvPair._1.toString)
        emitConst(nvPair._2)
      }

      val length = buf.position()
      buf.array().slice(0, length)
    } */

    <span class="keyword">def</span> <a title="()Unit" id="751889">writeAssembly</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751943" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#751943" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411422" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a>.<a href="../../../../reflect/api/Symbols.scala.html#402404" title="=&gt; Boolean">isModuleClass</a>, <a href="#751943" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411422" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="753447">mainMethod</a> = <a href="../../../../collection/MapLike.scala.html#87535" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">methods</a><span class="delimiter">(</span><a href="#751943" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="753448">stringArrayTypes</a>: <a href="../../../../Array.scala.html#174" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <a href="../../../../Array.scala.html#72260" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#694074" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_ARRAY</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="753449">globalMain</a> = <a href="#751865" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(name: String, attributes: Int, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineGlobalMethod</span><span class="delimiter">(</span>
          <span title="String(&quot;Main&quot;)" class="string">&quot;Main&quot;</span>, MethodAttributes.Public <span title="Int(22)">|</span> MethodAttributes.Static,
          <a href="../../symtab/clr/CLRTypes.scala.html#694059" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MVOID</a>, <a href="#753448" title="Array[ch.epfl.lamp.compiler.msil.Type]">stringArrayTypes</a><span class="delimiter">)</span>
        <a href="#753449" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">globalMain</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, ParameterAttributes.<span title="Int(0)">None</span>, <span title="String(&quot;args&quot;)" class="string">&quot;args&quot;</span><span class="delimiter">)</span>
        <a href="#751862" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(entryMethod: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">SetEntryPoint</span><span class="delimiter">(</span><a href="#753449" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">globalMain</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="753450">code</a> = <a href="#753449" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">globalMain</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="753451">moduleField</a> = <a href="#751963" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#751943" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411422" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
        <a href="#753450" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#753451" title="ch.epfl.lamp.compiler.msil.FieldInfo">moduleField</a><span class="delimiter">)</span>
        <a href="#753450" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
        <a href="#753450" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#753447" title="ch.epfl.lamp.compiler.msil.MethodInfo">mainMethod</a><span class="delimiter">)</span>
        <a href="#753450" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#751890" title="()Unit">createTypes</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">var</span> <a title="String" id="753441">outDirName</a>: <span title="String">String</span> = <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#540097" title="=&gt; scala.tools.nsc.Settings#StringSetting">Ygenjavap</a>.<a href="../../../../reflect/internal/settings/MutableSettings.scala.html#423750" title="=&gt; Boolean">isDefault</a><span class="delimiter">)</span> <span class="delimiter">{</span> // we reuse the JVM-sounding setting because it's conceptually similar
          <a href="#753441" title="String">outDirName</a> = <a href="#751877" title="=&gt; java.io.File">outDir</a>.<span title="()String">getPath</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#751862" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(fileName: String)Unit">Save</span><span class="delimiter">(</span><a href="#753441" title="String">outDirName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\\&quot;)" class="string">&quot;\\&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751871" title="=&gt; String">assemName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.msil&quot;)" class="string">&quot;.msil&quot;</span><span class="delimiter">)</span> /* use SingleFileILPrinterVisitor */
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#753441" title="String">outDirName</a> = <a href="#751880" title="=&gt; java.io.File">srcPath</a>.<span title="()String">getPath</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#751862" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(destPath: String, sourceFilesPath: String)Unit">Save</span><span class="delimiter">(</span><a href="../../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#540097" title="=&gt; scala.tools.nsc.Settings#StringSetting">Ygenjavap</a>.<a href="../../../../reflect/internal/settings/MutableSettings.scala.html#423752" title="=&gt; String">value</a>, <a href="#753441" title="String">outDirName</a><span class="delimiter">)</span>  /* use MultipleFilesILPrinterVisitor */
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Nothing" id="755254">e</a>:<span title="java.io.IOException">IOException</span> =&gt; <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="String(&quot;Could not write to &quot;)" class="string">&quot;Could not write to &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#753441" title="String">outDirName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755254" title="java.io.IOException">e</a>.<span title="()String">getMessage</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="751890">createTypes</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="755277">sym</a> &lt;- <a href="../icode/ICodes.scala.html#614876" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/IterableLike.scala.html#58562" title="(f: GenMSIL.this.global.icodes.global.Symbol =&gt; Unit)Unit">keys</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IClass" id="755278">iclass</a>   = <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.IClass">classes</a><span class="delimiter">(</span><a href="#755277" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="755279">tBuilder</a> = <a href="../../../../collection/MapLike.scala.html#87535" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#755277" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>

        <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Calling CreatType for &quot;)" class="string">&quot;Calling CreatType for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755277" title="GenMSIL.this.global.icodes.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755279" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="()String">toString</span><span class="delimiter">)</span>

        <a href="#755279" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="()ch.epfl.lamp.compiler.msil.Type">CreateType</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#755279" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(sourceFilepath: String)Unit">setSourceFilepath</span><span class="delimiter">(</span><a href="#755278" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615197" title="=&gt; GenMSIL.this.global.icodes.global.CompilationUnit">cunit</a>.<a href="../../CompilationUnits.scala.html#539270" title="=&gt; scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a>.<a href="../../../../reflect/io/AbstractFile.scala.html#404302" title="=&gt; String">path</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span><span class="delimiter">[</span>GenMSIL<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)String" id="751891">ilasmFileName</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="755322">iclass</a>: <a href="../icode/Members.scala.html#614923" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> : <span title="String">String</span> = <span class="delimiter">{</span>
      // method.sourceFile contains just the filename
      <a href="#755322" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615197" title="=&gt; GenMSIL.this.global.icodes.global.CompilationUnit">cunit</a>.<a href="../../CompilationUnits.scala.html#539270" title="=&gt; scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a>.<a href="../../../../reflect/io/AbstractFile.scala.html#404335" title="()String">toString</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;\\&quot;)" class="string">&quot;\\&quot;</span>, <span title="String(&quot;\\\\&quot;)" class="string">&quot;\\\\&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span><span class="delimiter">[</span>GenMSIL<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="751892">genClass</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="752135">iclass</a>: <a href="../icode/Members.scala.html#614923" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="755329">sym</a> = <a href="#752135" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
      <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Generating class &quot;)" class="string">&quot;Generating class &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; flags: &quot;)" class="string">&quot; flags: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#407114" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411241" title="=&gt; Long">flags</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#751856" title="(x$1: GenMSIL.this.global.icodes.IClass)Unit">clasz</a> = <a href="#752135" title="GenMSIL.this.global.icodes.IClass">iclass</a>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="755330">tBuilder</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751961" title="(sym: GenMSIL.this.global.Symbol)Boolean">isCloneable</a><span class="delimiter">(</span><a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        // FIXME: why there's no nme.clone_ ?
        // &quot;Clone&quot;: if the code is non-portable, &quot;Clone&quot; is defined, not &quot;clone&quot;
        // TODO: improve condition (should override AnyRef.clone)
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#752135" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615194" title="=&gt; List[GenMSIL.this.global.icodes.IMethod]">methods</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86378" title="(p: GenMSIL.this.global.icodes.IMethod =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="755357">m</a> =&gt; <span class="delimiter">{</span>
          <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#755357" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; m.symbol.NameType">name</a>.<span title="()String">toString</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;clone&quot;)" class="string">&quot;clone&quot;</span> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#755357" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; m.symbol.NameType">name</a>.<span title="()String">toString</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;Clone&quot;)" class="string">&quot;Clone&quot;</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
            <a href="#755357" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#408431" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">paramTypes</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57104" title="(x: Int)Boolean">!=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;auto-generating cloneable method for &quot;)" class="string">&quot;auto-generating cloneable method for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Short" id="755376">attrs</a>: <a href="../../../../Short.scala.html#810" title="Short">Short</a> = <span class="delimiter">(</span>MethodAttributes.Public | MethodAttributes.Virtual <span title="Int(198)">|</span>
                              MethodAttributes.HideBySig<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57078" title="=&gt; Short">toShort</a>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="755377">cloneMethod</a> = <a href="#755330" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span><span title="String(&quot;Clone&quot;)" class="string">&quot;Clone&quot;</span>, <a href="#755376" title="Short">attrs</a>, <a href="../../symtab/clr/CLRTypes.scala.html#694068" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>,
                                                  <span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="755378">clCode</a> = <a href="#755377" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">cloneMethod</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#755378" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">clCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
          <a href="#755378" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">clCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751802" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MEMBERWISE_CLONE</a><span class="delimiter">)</span>
          <a href="#755378" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">clCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="Int" id="755331">line</a> = <a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/StdAttachments.scala.html#409602" title="=&gt; GenMSIL.this.global.icodes.global.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409692" title="=&gt; Int">line</a>
      <a href="#755330" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(sourceLine: Int, sourceFilename: String)Unit">setPosition</span><span class="delimiter">(</span><a href="#755331" title="Int">line</a>, <a href="#751891" title="(iclass: GenMSIL.this.global.icodes.IClass)String">ilasmFileName</a><span class="delimiter">(</span><a href="#752135" title="GenMSIL.this.global.icodes.IClass">iclass</a><span class="delimiter">)</span><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751959" title="(sym: GenMSIL.this.global.Symbol)Boolean">isTopLevelModule</a><span class="delimiter">(</span><a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411453" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">companionClass</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; GenMSIL.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span>
          <a href="#751966" title="(sym: GenMSIL.this.global.Symbol)Unit">generateMirrorClass</a><span class="delimiter">(</span><a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="../../Global.scala.html#537516" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;No mirror class for module with linked class: &quot;)" class="string">&quot;No mirror class for module with linked class: &quot;</span> <span title="(x$1: Any)String">+</span>
              <a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411334" title="=&gt; String">fullName</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#751886" title="(sym: GenMSIL.this.global.Symbol, tBuilder: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit">addSymtabAttribute</a><span class="delimiter">(</span><a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#755330" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a><span class="delimiter">)</span>
      <a href="#751887" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#755330" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>, <a href="#755329" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411400" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#752135" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408861" title="=&gt; GenMSIL.this.global.ClassSymbol">ArrayClass</a><span class="delimiter">)</span>
        <a href="#752135" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615194" title="=&gt; List[GenMSIL.this.global.icodes.IMethod]">methods</a> <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.IMethod =&gt; Unit)Unit">foreach</a> <a href="#751893" title="(m: GenMSIL.this.global.icodes.IMethod)Unit">genMethod</a>

    <span class="delimiter">}</span> //genClass


    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(m: GenMSIL.this.global.icodes.IMethod)Unit" id="751893">genMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="755430">m</a>: <a href="../icode/Members.scala.html#614927" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Generating method &quot;)" class="string">&quot;Generating method &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; flags: &quot;)" class="string">&quot; flags: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#407114" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411241" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span>
            <span title="String(&quot; owner: &quot;)" class="string">&quot; owner: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>
      <a href="#751859" title="(x$1: GenMSIL.this.global.icodes.IMethod)Unit">method</a> = <a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>
      <a href="#751947" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]">localBuilders</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88240" title="()Unit">clear</a>
      <a href="#751937" title="(m: GenMSIL.this.global.icodes.IMethod)Unit">computeLocalVarsIndex</a><span class="delimiter">(</span><a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411200" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#751868" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">mcode</a> = <a href="../../../../collection/MapLike.scala.html#87535" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">constructors</a><span class="delimiter">(</span><a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">ConstructorBuilder</span><span class="delimiter">]</span>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="755474">mBuilder</a> = <a href="../../../../collection/MapLike.scala.html#87535" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">methods</a><span class="delimiter">(</span><a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">MethodBuilder</span><span class="delimiter">]</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755474" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="()Boolean">IsAbstract</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">try</span> <span class="delimiter">{</span>
            <a href="#751868" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">mcode</a> = <a href="#755474" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Nothing" id="755490">e</a>: <span title="Exception">Exception</span> =&gt;
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;m.symbol       = &quot;)" class="string">&quot;m.symbol       = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#407114" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411241" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;m.symbol.owner = &quot;)" class="string">&quot;m.symbol.owner = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#407114" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411241" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;mBuilder       = &quot;)" class="string">&quot;mBuilder       = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755474" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a><span class="delimiter">)</span>
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;mBuilder.DeclaringType = &quot;)" class="string">&quot;mBuilder.DeclaringType = &quot;</span> <span title="(x$1: Any)String">+</span>
                                 <span title="ch.epfl.lamp.compiler.msil.TypeAttributes.type">TypeAttributes</span>.<span title="(x$1: Int)String">toString</span><span class="delimiter">(</span><a href="#755474" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span>.<span title="Int">Attributes</span><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span>
                                 <span title="String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755474" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span><span class="delimiter">)</span>
              <span title="Nothing" class="keyword">throw</span> <a href="#755490" title="Exception">e</a>
          <span class="delimiter">}</span>
          <span class="keyword">else</span>
            <a href="#751868" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">mcode</a> = <span title="Null(null)" class="keyword">null</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="755566">local</a> &lt;- <a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: GenMSIL.this.global.icodes.Local =&gt; Unit)Unit">locals</a> ; <span class="keyword">if</span> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696024" title="=&gt; List[GenMSIL.this.global.icodes.Local]">params</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a> <a href="#755566" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;add local var: &quot;)" class="string">&quot;add local var: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755566" title="GenMSIL.this.global.icodes.Local">local</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, of kind &quot;)" class="string">&quot;, of kind &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755566" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#696352" title="=&gt; GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="755567">t</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#755566" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#696352" title="=&gt; GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="755568">localBuilder</a> = <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(localType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">DeclareLocal</span><span class="delimiter">(</span><a href="#755567" title="ch.epfl.lamp.compiler.msil.Type">t</a><span class="delimiter">)</span>
          <a href="#755568" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilder</a>.<span title="(name: String)Unit">SetLocalSymInfo</span><span class="delimiter">(</span><a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#755566" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#696350" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../../collection/mutable/HashMap.scala.html#88248" title="(key: GenMSIL.this.global.icodes.Local, value: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">localBuilders</a><span class="delimiter">(</span><a href="#755566" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span> = <a href="#755568" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilder</a>
        <span class="delimiter">}</span>
        <a href="#751901" title="(m: GenMSIL.this.global.icodes.IMethod)Unit">genCode</a><span class="delimiter">(</span><a href="#755430" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span>

    /** Special linearizer for methods with at least one exception handler. This
     *  linearizer brings all basic blocks in the right order so that nested
     *  try-catch and try-finally blocks can be emitted.
     */
    <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.MSILLinearizer" id="751894">msilLinearizer</a> = <span title="GenMSIL.this.global.icodes.MSILLinearizer" class="keyword">new</span> <a href="../icode/Linearizers.scala.html#615125" title="GenMSIL.this.global.icodes.MSILLinearizer">MSILLinearizer</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]" id="751896">labels</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#60744" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.BasicBlock, ch.epfl.lamp.compiler.msil.emit.Label)*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]" class="delimiter">[</span><a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    /* when emitting .line, it's enough to include the full filename just once per method, thus reducing filesize.
     * this scheme relies on the fact that the entry block is emitted first. */
    <span class="keyword">var</span> <a title="Boolean" id="751899">dbFilenameSeen</a> = <span title="Boolean(false)" class="keyword">false</span>

    <span class="keyword">def</span> <a title="(m: GenMSIL.this.global.icodes.IMethod)Unit" id="751901">genCode</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="755582">m</a>: <a href="../icode/Members.scala.html#614927" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">def</span> <a title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock])Unit" id="755583">makeLabels</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="755585">blocks</a>: <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Making labels for: &quot;)" class="string">&quot;Making labels for: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751859" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a><span class="delimiter">)</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="755606">bb</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.BasicBlock =&gt; Unit)Unit">blocks</a><span class="delimiter">)</span> <a href="../../../../collection/mutable/HashMap.scala.html#88248" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: ch.epfl.lamp.compiler.msil.emit.Label)Unit">labels</a><span class="delimiter">(</span><a href="#755606" title="GenMSIL.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span> = <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#751896" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]">labels</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88240" title="()Unit">clear</a>

      <span class="keyword">var</span> <a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="755584">linearization</a> = <span title="List[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">if</span><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755582" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696006" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">exh</a>.<a href="../../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#751894" title="=&gt; GenMSIL.this.global.icodes.MSILLinearizer">msilLinearizer</a>.<a href="../icode/Linearizers.scala.html#712753" title="(m: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]">linearize</a><span class="delimiter">(</span><a href="#755582" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
                          <span class="keyword">else</span> <a href="../icode/ICodes.scala.html#614880" title="=&gt; GenMSIL.this.global.icodes.Linearizer">linearizer</a>.<a href="../icode/Linearizers.scala.html#712012" title="(c: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]">linearize</a><span class="delimiter">(</span><a href="#755582" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755582" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696006" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">exh</a>.<a href="../../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
        <a href="#755584" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a> = <a href="#751927" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], m: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]">computeExceptionMaps</a><span class="delimiter">(</span><a href="#755584" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a>, <a href="#755582" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <a href="#755583" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock])Unit">makeLabels</a><span class="delimiter">(</span><a href="#755584" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a><span class="delimiter">)</span>

      // debug val blocksInM = m.code.blocks.toList.sortBy(bb =&gt; bb.label)
      // debug val blocksInL = linearization.sortBy(bb =&gt; bb.label)
      // debug val MButNotL  = (blocksInM.toSet) diff (blocksInL.toSet) // if non-empty, a jump to B fails to find a label for B (case CJUMP, case CZJUMP)
      // debug if(!MButNotL.isEmpty) { }

      <a href="#751899" title="(x$1: Boolean)Unit">dbFilenameSeen</a> = <span title="Boolean(false)" class="keyword">false</span>
      <a href="#751902" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], previous: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlocks</a><span class="delimiter">(</span><a href="#755584" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a><span class="delimiter">)</span>

      // RETURN inside exception blocks are replaced by Leave. The target of the
      // leave is a `Ret` outside any exception block (generated here).
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751913" title="=&gt; GenMSIL.this.global.icodes.IMethod">handlerReturnMethod</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#755582" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="#751919" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">handlerReturnLabel</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751922" title="=&gt; GenMSIL.this.global.icodes.TypeKind">handlerReturnKind</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../icode/TypeKinds.scala.html#614990" title="GenMSIL.this.global.icodes.UNIT.type">UNIT</a><span class="delimiter">)</span>
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc</span>, <a href="#751916" title="=&gt; ch.epfl.lamp.compiler.msil.emit.LocalBuilder">handlerReturnLocal</a><span class="delimiter">)</span>
        <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#751903" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">beginExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88240" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#751905" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]">beginCatchBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88240" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#751907" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">endExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88240" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#751925" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]">endFinallyLabels</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88240" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], previous: GenMSIL.this.global.icodes.BasicBlock)Unit" id="751902">genBlocks</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="755619">blocks</a>: <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="755621">previous</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a> = <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#755619" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../../collection/immutable/List.scala.html#11188" title="Unit" id="3318194">Nil</a> =&gt; <a href="#3318198" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../../../../collection/immutable/List.scala.html#206583" title="GenMSIL.this.global.icodes.BasicBlock" id="755642">x</a> <a href="#3318186" title="Boolean" id="3318189">::</a> <a href="../../../../collection/immutable/List.scala.html#206584" title="List[GenMSIL.this.global.icodes.BasicBlock]" id="3318195">Nil</a> =&gt; <a href="#751928" title="(block: GenMSIL.this.global.icodes.BasicBlock, prev: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlock</a><a href="#3318198" title="(x: Unit)Unit" class="delimiter">(</a><a href="#755642" title="GenMSIL.this.global.icodes.BasicBlock">x</a>, prev = <a href="#755621" title="GenMSIL.this.global.icodes.BasicBlock">previous</a>, next = <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../../../../collection/immutable/List.scala.html#206583" title="GenMSIL.this.global.icodes.BasicBlock" id="755648">x</a> :: <a href="../../../../collection/immutable/List.scala.html#206583" title="GenMSIL.this.global.icodes.BasicBlock" id="755651">y</a> <a href="../../../../collection/immutable/List.scala.html#206584" title="List[GenMSIL.this.global.icodes.BasicBlock]" id="3318193">::</a> <a href="../../../../collection/immutable/List.scala.html#206584" title="List[GenMSIL.this.global.icodes.BasicBlock]" id="755652">ys</a> =&gt; <a href="#751928" title="(block: GenMSIL.this.global.icodes.BasicBlock, prev: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlock</a><span class="delimiter">(</span><a href="#755648" title="GenMSIL.this.global.icodes.BasicBlock">x</a>, prev = <a href="#755621" title="GenMSIL.this.global.icodes.BasicBlock">previous</a>, next = <a href="#755651" title="GenMSIL.this.global.icodes.BasicBlock">y</a><span class="delimiter">)</span>; <a href="#751902" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], previous: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlocks</a><span class="delimiter">(</span><a href="#755651" title="GenMSIL.this.global.icodes.BasicBlock">y</a> <a href="../../../../collection/immutable/List.scala.html#62685" title="(x: GenMSIL.this.global.icodes.BasicBlock)List[GenMSIL.this.global.icodes.BasicBlock]">::</a> <a href="#755652" title="List[GenMSIL.this.global.icodes.BasicBlock]">ys</a>, previous = <a href="#755648" title="GenMSIL.this.global.icodes.BasicBlock">x</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    // the try blocks starting at a certain BasicBlock
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="751903">beginExBlock</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#60744" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.BasicBlock, List[GenMSIL.this.global.icodes.ExceptionHandler])*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="delimiter">[</span><a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">List</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    // the catch blocks starting / endling at a certain BasicBlock
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]" id="751905">beginCatchBlock</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#60744" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.BasicBlock, GenMSIL.this.global.icodes.ExceptionHandler)*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]" class="delimiter">[</span><a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a href="../icode/ExceptionHandlers.scala.html#615030" title="GenMSIL.this.global.icodes.ExceptionHandler">ExceptionHandler</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="751907">endExBlock</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#60744" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.BasicBlock, List[GenMSIL.this.global.icodes.ExceptionHandler])*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="delimiter">[</span><a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">List</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    /** When emitting the code (genBlock), the number of currently active try / catch
     *  blocks. When seeing a `RETURN` inside a try / catch, we need to
     *   - store the result in a local (if it's not UNIT)
     *   - emit `Leave handlerReturnLabel` instead of the Return
     *   - emit code at the end: load the local and return its value
     */
    <span class="keyword">var</span> <a title="scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]" id="751910">currentHandlers</a> = <a href="../../../../collection/mutable/Stack.scala.html#298117" title="()scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/Stack.scala.html#13293" title="scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">Stack</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span>
    // The IMethod the Local/Label/Kind below belong to
    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.IMethod" id="751913">handlerReturnMethod</a>: <a href="../icode/Members.scala.html#614927" title="GenMSIL.this.global.icodes.IMethod">IMethod</a> = _
    // Stores the result when returning inside an exception block
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="751916">handlerReturnLocal</a>: <span title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">LocalBuilder</span> = _
    // Label for a return instruction outside any exception block
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="751919">handlerReturnLabel</a>: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span> = _
    // The result kind.
    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.TypeKind" id="751922">handlerReturnKind</a>: <a href="../icode/TypeKinds.scala.html#614984" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a> = _
    <span class="keyword">def</span> <a title="(kind: GenMSIL.this.global.icodes.TypeKind)(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" id="751924">returnFromHandler</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="755659">kind</a>: <a href="../icode/TypeKinds.scala.html#614984" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span>: <a href="../../../../Tuple2.scala.html#783" title="(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" class="delimiter">(</a>LocalBuilder, Label<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751913" title="=&gt; GenMSIL.this.global.icodes.IMethod">handlerReturnMethod</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#751859" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#751913" title="(x$1: GenMSIL.this.global.icodes.IMethod)Unit">handlerReturnMethod</a> = <a href="#751859" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#755659" title="GenMSIL.this.global.icodes.TypeKind">kind</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../icode/TypeKinds.scala.html#614990" title="GenMSIL.this.global.icodes.UNIT.type">UNIT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#751916" title="(x$1: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">handlerReturnLocal</a> = <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(localType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">DeclareLocal</span><span class="delimiter">(</span><a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#755659" title="GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#751916" title="=&gt; ch.epfl.lamp.compiler.msil.emit.LocalBuilder">handlerReturnLocal</a>.<span title="(name: String)Unit">SetLocalSymInfo</span><span class="delimiter">(</span><span title="String(&quot;$handlerReturn&quot;)" class="string">&quot;$handlerReturn&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#751919" title="(x$1: ch.epfl.lamp.compiler.msil.emit.Label)Unit">handlerReturnLabel</a> = <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#751922" title="(x$1: GenMSIL.this.global.icodes.TypeKind)Unit">handlerReturnKind</a> = <a href="#755659" title="GenMSIL.this.global.icodes.TypeKind">kind</a>
      <span class="delimiter">}</span>
      <a href="../../../../Tuple2.scala.html#62849" title="(_1: ch.epfl.lamp.compiler.msil.emit.LocalBuilder, _2: ch.epfl.lamp.compiler.msil.emit.Label)(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" class="delimiter">(</a><a href="#751916" title="=&gt; ch.epfl.lamp.compiler.msil.emit.LocalBuilder">handlerReturnLocal</a>, <a href="#751919" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">handlerReturnLabel</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    /** For try/catch nested inside a finally, we can't use `Leave OutsideFinally`, the
     *  Leave target has to be inside the finally (and it has to be the `endfinally` instruction).
     *  So for every finalizer, we have a label which marks the place of the `endfinally`,
     *  nested try/catch blocks will leave there.
     */
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]" id="751925">endFinallyLabels</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#60744" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.ExceptionHandler, ch.epfl.lamp.compiler.msil.emit.Label)*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]" class="delimiter">[</span><a href="../icode/ExceptionHandlers.scala.html#615030" title="GenMSIL.this.global.icodes.ExceptionHandler">ExceptionHandler</a>, <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    /** Computes which blocks are the beginning / end of a try or catch block */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], m: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]" id="751927">computeExceptionMaps</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="755617">blocks</a>: <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span>, <a title="GenMSIL.this.global.icodes.IMethod" id="755618">m</a>: <a href="../icode/Members.scala.html#614927" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span>: <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]" id="755681">visitedBlocks</a> = <a href="../../../../collection/mutable/HashSet.scala.html#125959" title="()scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/HashSet.scala.html#13053" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">HashSet</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

      // handlers which have not been introduced so far
      <span class="keyword">var</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="755682">openHandlers</a> = <a href="#755618" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696006" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">exh</a>


      /** Example
       *   try {
       *     try {
       *         // *1*
       *     } catch {
       *       case h1 =&gt;
       *     }
       *   } catch {
       *     case h2 =&gt;
       *     case h3 =&gt;
       *       try {
       *
       *       } catch {
       *         case h4 =&gt;  // *2*
       *         case h5 =&gt;
       *       }
       *   }
       */

      // Stack of nested try blocks. Each bloc has a List of ExceptionHandler (multiple
      // catch statements). Example *1*: Stack(List(h2, h3), List(h1))
      <span class="keyword">val</span> <a title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="755683">currentTryHandlers</a> = <a href="../../../../collection/mutable/Stack.scala.html#298117" title="()scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/Stack.scala.html#13293" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">Stack</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

      // Stack of nested catch blocks. The head of the list is the current catch block. The
      // tail is all following catch blocks. Example *2*: Stack(List(h3), List(h4, h5))
      <span class="keyword">val</span> <a title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="755684">currentCatchHandlers</a> = <a href="../../../../collection/mutable/Stack.scala.html#298117" title="()scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/Stack.scala.html#13293" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">Stack</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="755710">b</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.BasicBlock =&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock])Unit">blocks</a><span class="delimiter">)</span> <span class="delimiter">{</span>

        // are we past the current catch blocks?
        <span class="keyword">def</span> <a title="()List[GenMSIL.this.global.icodes.ExceptionHandler]" id="755711">endHandlers</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">List</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span> = <span class="delimiter">{</span>
          <span class="keyword">var</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="755719">res</a>: <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">List</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span> = <a href="../../../../collection/immutable/List.scala.html#11188" title="scala.collection.immutable.Nil.type">Nil</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755684" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298119" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="755720">handler</a> = <a href="#755684" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298126" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">top</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755720" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#696231" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              // all blocks of the handler are either visited, or not part of the linearization (i.e. dead)
              <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#755720" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#696231" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86378" title="(p: GenMSIL.this.global.icodes.BasicBlock =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="755741">b</a> =&gt; <a href="#755681" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">visitedBlocks</a>.<a href="../../../../collection/mutable/HashSet.scala.html#125962" title="(elem: GenMSIL.this.global.icodes.BasicBlock)Boolean">contains</a><span class="delimiter">(</span><a href="#755741" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755617" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#755741" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span>,
                     <span title="String(&quot;Bad linearization of basic blocks inside catch. Found block not part of the handler\n&quot;)" class="string">&quot;Bad linearization of basic blocks inside catch. Found block not part of the handler\n&quot;</span><span title="(x$1: Any)String">+</span>
                     <a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#695979" title="=&gt; String">fullString</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\nwhile in catch-part of\n&quot;)" class="string">&quot;\nwhile in catch-part of\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#755720" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>

              <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="755727">rest</a> = <a href="#755684" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298127" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">pop</a>.<a href="../../../../collection/TraversableLike.scala.html#58104" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">tail</a>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#755727" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>.<a href="../../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                // all catch blocks of that exception handler are covered
                <a href="#755719" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">res</a> = <a href="#755720" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a> <a href="../../../../collection/immutable/List.scala.html#62685" title="(x: GenMSIL.this.global.icodes.ExceptionHandler)List[GenMSIL.this.global.icodes.ExceptionHandler]">::</a> <a href="#755711" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">endHandlers</a><span class="delimiter">(</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                // there are more catch blocks for that try (handlers covering the same)
                <a href="#755684" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298123" title="(elem: List[GenMSIL.this.global.icodes.ExceptionHandler])currentCatchHandlers.type">push</a><span class="delimiter">(</span><a href="#755727" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a><span class="delimiter">)</span>
                <a href="../../../../collection/mutable/HashMap.scala.html#88248" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: GenMSIL.this.global.icodes.ExceptionHandler)Unit">beginCatchBlock</a><span class="delimiter">(</span><a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#755727" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
          <a href="#755719" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">res</a>
        <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="755712">end</a> = <a href="#755711" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">endHandlers</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755712" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">end</a>.<a href="../../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../collection/mutable/HashMap.scala.html#88248" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: List[GenMSIL.this.global.icodes.ExceptionHandler])Unit">endExBlock</a><span class="delimiter">(</span><a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#755712" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">end</a>

        // are we past the current try block?
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755683" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298119" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="755766">handler</a> = <a href="#755683" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298126" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">top</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755766" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#696230" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            // all of the covered blocks are visited, or not part of the linearization
            <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#755766" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#696226" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>.<a href="../../../../collection/IterableLike.scala.html#58565" title="(p: GenMSIL.this.global.icodes.BasicBlock =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="755784">b</a> =&gt; <a href="#755681" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">visitedBlocks</a>.<a href="../../../../collection/mutable/HashSet.scala.html#125962" title="(elem: GenMSIL.this.global.icodes.BasicBlock)Boolean">contains</a><span class="delimiter">(</span><a href="#755784" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755617" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#755784" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span>,
                   <span title="String(&quot;Bad linearization of basic blocks inside try. Found non-covered block\n&quot;)" class="string">&quot;Bad linearization of basic blocks inside try. Found non-covered block\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#695979" title="=&gt; String">fullString</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\nwhile in try-part of\n&quot;)" class="string">&quot;\nwhile in try-part of\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#755766" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>

            <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#755766" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#696225" title="=&gt; GenMSIL.this.global.icodes.BasicBlock">startBlock</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a>,
                   <span title="String(&quot;Bad linearization of basic blocks. The entry block of a catch does not directly follow the try\n&quot;)" class="string">&quot;Bad linearization of basic blocks. The entry block of a catch does not directly follow the try\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#695979" title="=&gt; String">fullString</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#755766" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>

            <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="755769">handlers</a> = <a href="#755683" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298127" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">pop</a>
            <a href="#755684" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298123" title="(elem: List[GenMSIL.this.global.icodes.ExceptionHandler])currentCatchHandlers.type">push</a><span class="delimiter">(</span><a href="#755769" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a><span class="delimiter">)</span>
            <a href="../../../../collection/mutable/HashMap.scala.html#88248" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: GenMSIL.this.global.icodes.ExceptionHandler)Unit">beginCatchBlock</a><span class="delimiter">(</span><a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#755766" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        // are there try blocks starting at b?
        <span class="keyword">val</span> <a href="#3318212" title="(x: (List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler]))(List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler])" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#60635" title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="755714">newHandlers</a>, <a href="../../../../Tuple2.scala.html#60637" title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="755715">stillOpen</a><span class="delimiter">)</span> = <a href="#755682" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a>.<a href="../../../../collection/TraversableLike.scala.html#58080" title="(p: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Boolean)(List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler])">partition</a><a href="../../../../Tuple2.scala.html#783" title="(List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler]) @unchecked" class="delimiter">(</a><a href="#755804" title="GenMSIL.this.global.icodes.ExceptionHandler">_</a>.<a href="../icode/ExceptionHandlers.scala.html#696230" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#755682" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a> = <a href="#755715" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">stillOpen</a>

        <span class="keyword">val</span> <a title="scala.collection.immutable.Map[Int,List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="755716">newHandlersBySize</a> = <a href="#755714" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">newHandlers</a>.<a href="../../../../collection/TraversableLike.scala.html#58081" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Int)scala.collection.immutable.Map[Int,List[GenMSIL.this.global.icodes.ExceptionHandler]]">groupBy</a><span class="delimiter">(</span><a href="#755823" title="GenMSIL.this.global.icodes.ExceptionHandler">_</a>.<a href="../icode/ExceptionHandlers.scala.html#696226" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>.<a href="../../../../collection/TraversableOnce.scala.html#58190" title="=&gt; Int">size</a><span class="delimiter">)</span>
        // big handlers first, smaller ones are nested inside the try of the big one
        // (checked by the assertions below)
        <span class="keyword">val</span> <a title="List[Int]" id="755717">sizes</a> = <a href="#755716" title="scala.collection.immutable.Map[Int,List[GenMSIL.this.global.icodes.ExceptionHandler]]">newHandlersBySize</a>.<a href="../../../../collection/MapLike.scala.html#87541" title="=&gt; Iterable[Int]">keys</a>.<a href="../../../../collection/TraversableOnce.scala.html#58263" title="=&gt; List[Int]">toList</a>.<a href="../../../../collection/SeqLike.scala.html#58868" title="(lt: (Int, Int) =&gt; Boolean)List[Int]">sortWith</a><span class="delimiter">(</span><a href="#755829" title="Int">_</a> <a href="../../../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <a href="#755830" title="Int">_</a><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]" id="755718">beginHandlers</a> = <span title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]" class="keyword">new</span> mutable.<a href="../../../../collection/mutable/ListBuffer.scala.html#13347" title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]">ListBuffer</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="755855">s</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: Int =&gt; scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]])Unit">sizes</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="755856">sHandlers</a> = <a href="../../../../collection/MapLike.scala.html#87535" title="(key: Int)List[GenMSIL.this.global.icodes.ExceptionHandler]">newHandlersBySize</a><span class="delimiter">(</span><a href="#755855" title="Int">s</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="755898">h</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">sHandlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#755898" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#696226" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#755856" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>.<a href="../icode/ExceptionHandlers.scala.html#696226" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>,
                   <span title="String(&quot;bad nesting of exception handlers. same size, but not covering same blocks\n&quot;)" class="string">&quot;bad nesting of exception handlers. same size, but not covering same blocks\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#755898" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#755856" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a><span class="delimiter">)</span>
            <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#755898" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#696221" title="=&gt; GenMSIL.this.global.icodes.TypeKind">resultKind</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#755856" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>.<a href="../icode/ExceptionHandlers.scala.html#696221" title="=&gt; GenMSIL.this.global.icodes.TypeKind">resultKind</a>,
                   <span title="String(&quot;bad nesting of exception handlers. same size, but the same resultKind\n&quot;)" class="string">&quot;bad nesting of exception handlers. same size, but the same resultKind\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#755898" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#755856" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="755934">bigger</a> &lt;- <a href="../../../../collection/generic/TraversableForwarder.scala.html#79857" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">beginHandlers</a>; <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="755953">h</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">sHandlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#755953" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#696226" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>.<a href="../../../../collection/GenSetLike.scala.html#66410" title="(that: scala.collection.GenSet[GenMSIL.this.global.icodes.BasicBlock])Boolean">subsetOf</a><span class="delimiter">(</span><a href="#755934" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a>.<a href="../icode/ExceptionHandlers.scala.html#696226" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a><span class="delimiter">)</span>,
                   <span title="String(&quot;bad nesting of exception handlers. try blocks of smaller handler are not nested in bigger one.\n&quot;)" class="string">&quot;bad nesting of exception handlers. try blocks of smaller handler are not nested in bigger one.\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#755953" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#755934" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a><span class="delimiter">)</span>
            <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#755953" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#696231" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/TraversableOnce.scala.html#58270" title="scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">toSet</a>.<a href="../../../../collection/GenSetLike.scala.html#66410" title="(that: scala.collection.GenSet[GenMSIL.this.global.icodes.BasicBlock])Boolean">subsetOf</a><span class="delimiter">(</span><a href="#755934" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a>.<a href="../icode/ExceptionHandlers.scala.html#696226" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a><span class="delimiter">)</span>,
                   <span title="String(&quot;bad nesting of exception handlers. catch blocks of smaller handler are not nested in bigger one.\n&quot;)" class="string">&quot;bad nesting of exception handlers. catch blocks of smaller handler are not nested in bigger one.\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#755953" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#755934" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#755718" title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]">beginHandlers</a> <a href="../../../../collection/mutable/ListBuffer.scala.html#79765" title="(x: GenMSIL.this.global.icodes.ExceptionHandler)beginHandlers.type">+=</a> <a href="#755856" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
          <a href="#755683" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298123" title="(elem: List[GenMSIL.this.global.icodes.ExceptionHandler])currentTryHandlers.type">push</a><span class="delimiter">(</span><a href="#755856" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="../../../../collection/mutable/HashMap.scala.html#88248" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: List[GenMSIL.this.global.icodes.ExceptionHandler])Unit">beginExBlock</a><span class="delimiter">(</span><a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#755718" title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]">beginHandlers</a>.<a href="../../../../collection/mutable/ListBuffer.scala.html#79773" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">toList</a>
        <a href="#755681" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">visitedBlocks</a> <a href="../../../../collection/mutable/HashSet.scala.html#125963" title="(elem: GenMSIL.this.global.icodes.BasicBlock)visitedBlocks.type">+=</a> <a href="#755710" title="GenMSIL.this.global.icodes.BasicBlock">b</a>
      <span class="delimiter">}</span>

      // if there handlers left (i.e. handlers covering nothing, or a
      // non-existent (dead) block), remove their catch-blocks.
      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="755685">liveBlocks</a> = <span title="List[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">if</span> <span class="delimiter">(</span><a href="#755682" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a>.<a href="../../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#755617" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#755617" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/TraversableLike.scala.html#58073" title="(p: GenMSIL.this.global.icodes.BasicBlock =&gt; Boolean)List[GenMSIL.this.global.icodes.BasicBlock]">filter</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="756004">b</a> =&gt; <a href="#755682" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86378" title="(p: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="756013">h</a> =&gt; <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#756013" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#696231" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#756004" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      /** There might be open handlers, but no more blocks. happens when try/catch end
       *  with `throw` or `return`
       *     def foo() { try { .. throw } catch { _ =&gt; .. throw } }
       *
       *  In this case we need some code after the catch block for the auto-generated
       *  `leave` instruction. So we're adding a (dead) `throw new Exception`.
       */
      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="755686">rest</a> = <a href="#755684" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/TraversableLike.scala.html#58063" title="(f: List[GenMSIL.this.global.icodes.ExceptionHandler] =&gt; GenMSIL.this.global.icodes.ExceptionHandler)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]],GenMSIL.this.global.icodes.ExceptionHandler,scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]])scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">map</a><a href="../../../../collection/mutable/Stack.scala.html#298104" title="scala.collection.generic.CanBuildFrom[scala.collection.mutable.Stack.Coll,GenMSIL.this.global.icodes.ExceptionHandler,scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]]" class="delimiter">(</a><a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="756031">handlers</a> =&gt; <span class="delimiter">{</span>
        <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#756031" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span>, <a href="#756031" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a><span class="delimiter">)</span>
        <a href="#756031" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>.<a href="../../../../collection/mutable/Stack.scala.html#298130" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">toList</a>

      <span title="List[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">if</span> <span class="delimiter">(</span><a href="#755686" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>.<a href="../../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#755685" title="List[GenMSIL.this.global.icodes.BasicBlock]">liveBlocks</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.BasicBlock" id="756131">b</a> = <a href="#755618" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695989" title="=&gt; GenMSIL.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#696102" title="()GenMSIL.this.global.icodes.BasicBlock">newBlock</a>
        <a href="#756131" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#695949" title="(is: Seq[GenMSIL.this.global.icodes.Instruction])Unit">emit</a><span class="delimiter">(</span><a href="../../../../collection/generic/GenericCompanion.scala.html#59933" title="(elems: GenMSIL.this.global.icodes.Instruction with Product with Serializable*)Seq[GenMSIL.this.global.icodes.Instruction with Product with Serializable]">Seq</a><span class="delimiter">(</span>
          <a href="../icode/Opcodes.scala.html#705362" title="(kind: GenMSIL.this.global.icodes.REFERENCE)GenMSIL.this.global.icodes.opcodes.NEW">NEW</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#694620" title="(cls: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.REFERENCE">REFERENCE</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408712" title="=&gt; GenMSIL.this.global.ClassSymbol">ThrowableClass</a><span class="delimiter">)</span><span class="delimiter">)</span>,
          <a href="../icode/Opcodes.scala.html#703414" title="(typ: GenMSIL.this.global.icodes.TypeKind)GenMSIL.this.global.icodes.opcodes.DUP">DUP</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#694620" title="(cls: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.REFERENCE">REFERENCE</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408671" title="=&gt; GenMSIL.this.global.ClassSymbol">ObjectClass</a><span class="delimiter">)</span><span class="delimiter">)</span>,
          <a href="../icode/Opcodes.scala.html#705589" title="(method: GenMSIL.this.global.icodes.global.Symbol, style: GenMSIL.this.global.icodes.opcodes.InvokeStyle)GenMSIL.this.global.icodes.opcodes.CALL_METHOD">CALL_METHOD</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408712" title="=&gt; GenMSIL.this.global.ClassSymbol">ThrowableClass</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411710" title="=&gt; GenMSIL.this.global.Symbol">primaryConstructor</a>, <a href="../icode/Opcodes.scala.html#705891" title="(onInstance: Boolean)GenMSIL.this.global.icodes.opcodes.Static">Static</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span>,
          <a href="../icode/Opcodes.scala.html#700811" title="(clasz: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.opcodes.THROW">THROW</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408712" title="=&gt; GenMSIL.this.global.ClassSymbol">ThrowableClass</a><span class="delimiter">)</span>
        <span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#756131" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#695953" title="()Unit">close</a>
        <a href="../../../../collection/mutable/HashMap.scala.html#88248" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: List[GenMSIL.this.global.icodes.ExceptionHandler])Unit">endExBlock</a><span class="delimiter">(</span><a href="#756131" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#755686" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>
        <a href="#755685" title="List[GenMSIL.this.global.icodes.BasicBlock]">liveBlocks</a> <a href="../../../../collection/immutable/List.scala.html#62688" title="(prefix: List[GenMSIL.this.global.icodes.BasicBlock])List[GenMSIL.this.global.icodes.BasicBlock]">:::</a> <a href="../../../../collection/immutable/List.scala.html#62451" title="(xs: GenMSIL.this.global.icodes.BasicBlock*)List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">(</span><a href="#756131" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /**
     *  @param block the BasicBlock to emit code for
     *  @param next  the following BasicBlock, `null` if `block` is the last one
     */
    <span class="keyword">def</span> <a title="(block: GenMSIL.this.global.icodes.BasicBlock, prev: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock)Unit" id="751928">genBlock</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="755643">block</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="755644">prev</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="755645">next</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">def</span> <a title="(local: GenMSIL.this.global.icodes.Local, msg: String, loadAddr: Boolean)Unit" id="756193">loadLocalOrAddress</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="756198">local</a>: <a href="../icode/Members.scala.html#614928" title="GenMSIL.this.global.icodes.Local">Local</a>, <a title="String" id="756199">msg</a> : <span title="String">String</span> , <a title="Boolean" id="756200">loadAddr</a> : <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><a href="#756199" title="String">msg</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; for &quot;)" class="string">&quot; for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756198" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Boolean" id="756201">isArg</a> = <a href="#756198" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#696354" title="=&gt; Boolean">arg</a>
        <span class="keyword">val</span> <a title="Int" id="756202">i</a> = <a href="#756198" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#696357" title="=&gt; Int">index</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756201" title="Boolean">isArg</a><span class="delimiter">)</span>
          <a href="#751931" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit">loadArg</a><span class="delimiter">(</span><a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, <a href="#756200" title="Boolean">loadAddr</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#756202" title="Int">i</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#751932" title="(i: Int, local: GenMSIL.this.global.icodes.Local, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)Unit">loadLocal</a><span class="delimiter">(</span><a href="#756202" title="Int">i</a>, <a href="#756198" title="GenMSIL.this.global.icodes.Local">local</a>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, <a href="#756200" title="Boolean">loadAddr</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="(field: GenMSIL.this.global.Symbol, isStatic: Boolean, msg: String, loadAddr: Boolean)Unit" id="756194">loadFieldOrAddress</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="756372">field</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="Boolean" id="756373">isStatic</a>: <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a>, <a title="String" id="756374">msg</a>: <span title="String">String</span>, <a title="Boolean" id="756375">loadAddr</a> : <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><a href="#756374" title="String">msg</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; with owner: &quot;)" class="string">&quot; with owner: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756372" title="GenMSIL.this.global.Symbol">field</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: Any)String">+</span>
              <span title="String(&quot; flags: &quot;)" class="string">&quot; flags: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#407114" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#756372" title="GenMSIL.this.global.Symbol">field</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411241" title="=&gt; Long">flags</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="756376">fieldInfo</a> = <a href="../../symtab/clr/CLRTypes.scala.html#694101" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.FieldInfo]">fields</a>.<a href="../../../../collection/MapLike.scala.html#87525" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.FieldInfo]">get</a><a href="#3318221" title="(x: ch.epfl.lamp.compiler.msil.FieldInfo)ch.epfl.lamp.compiler.msil.FieldInfo" class="delimiter">(</a><a href="#756372" title="GenMSIL.this.global.Symbol">field</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Some<a href="#3318216" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="3318217" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="756383">fInfo</a><span class="delimiter">)</span> =&gt; <a href="#3318221" title="(x: ch.epfl.lamp.compiler.msil.FieldInfo)ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
          <span class="keyword">case</span> <a href="../../../../Option.scala.html#1585" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="3318219">None</a> =&gt;
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="756384">fInfo</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#756372" title="GenMSIL.this.global.Symbol">field</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="(x$1: String)ch.epfl.lamp.compiler.msil.FieldInfo">GetField</span><span class="delimiter">(</span><a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#756372" title="GenMSIL.this.global.Symbol">field</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#756372" title="GenMSIL.this.global.Symbol">field</a><span class="delimiter">)</span> = <a href="#756384" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
            <a href="#756384" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
        <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756376" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="()Boolean">IsVolatile</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Volatile</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#756376" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="()Boolean">IsLiteral</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756375" title="Boolean">loadAddr</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#756373" title="Boolean">isStatic</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsflda</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldflda</span>, <a href="#756376" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#756373" title="Boolean">isStatic</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldfld</span>, <a href="#756376" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#756375" title="Boolean">loadAddr</a>, <span title="String(&quot;can\'t take AddressOf a literal field (not even with readonly. prefix) because no memory was allocated to such field ...&quot;)" class="string">&quot;can't take AddressOf a literal field (not even with readonly. prefix) because no memory was allocated to such field ...&quot;</span><span class="delimiter">)</span>
          // TODO the above can be overcome by loading the value, boxing, and finally unboxing. An address to a copy of the raw value will be on the stack.
         /*  We perform `field inlining' as required by CLR.
          *  Emit as for a CONSTANT ICode stmt, with the twist that the constant value is available
          *  as a java.lang.Object and its .NET type allows constant initialization in CLR, i.e. that type
          *  is one of I1, I2, I4, I8, R4, R8, CHAR, BOOLEAN, STRING, or CLASS (in this last case,
          *  only accepting nullref as value). See Table 9-1 in Lidin's book on ILAsm. */
          <span class="keyword">val</span> <a title="Object" id="756399">value</a> = <a href="#756376" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="()Object">getValue</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756399" title="Object">value</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="756409">typ</a> = <span title="ch.epfl.lamp.compiler.msil.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#756376" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">FieldType</span>.<span title="()Boolean">IsEnum</span><span class="delimiter">)</span> <a href="#756376" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">FieldType</span>.<span title="()ch.epfl.lamp.compiler.msil.Type">getUnderlyingType</span>
                      <span class="keyword">else</span> <a href="#756376" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">FieldType</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694071" title="=&gt; ch.epfl.lamp.compiler.msil.Type">STRING</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: String)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldstr</span>, <a href="#756399" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="String" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694056" title="=&gt; ch.epfl.lamp.compiler.msil.Type">BOOLEAN</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#756399" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">]</span><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_1</span>
                           <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694023" title="=&gt; ch.epfl.lamp.compiler.msil.Type">BYTE</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694026" title="=&gt; ch.epfl.lamp.compiler.msil.Type">UBYTE</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#751930" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#756399" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><a href="../../../../Byte.scala.html#56757" title="=&gt; Int" class="delimiter">[</a><a href="../../../../Byte.scala.html#1380" title="Byte">Byte</a><span class="delimiter">]</span>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694029" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SHORT</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694032" title="=&gt; ch.epfl.lamp.compiler.msil.Type">USHORT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#751930" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#756399" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><a href="../../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">]</span>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694035" title="=&gt; ch.epfl.lamp.compiler.msil.Type">CHAR</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#751930" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#756399" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><a href="../../../../Char.scala.html#57230" title="=&gt; Int" class="delimiter">[</a><a href="../../../../Char.scala.html#822" title="Char">Char</a><span class="delimiter">]</span>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694038" title="=&gt; ch.epfl.lamp.compiler.msil.Type">INT</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694041" title="=&gt; ch.epfl.lamp.compiler.msil.Type">UINT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#751930" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#756399" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><a href="../../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">]</span>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694044" title="=&gt; ch.epfl.lamp.compiler.msil.Type">LONG</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694047" title="=&gt; ch.epfl.lamp.compiler.msil.Type">ULONG</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Long)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I8</span>, <a href="#756399" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Long" class="delimiter">[</span><a href="../../../../Long.scala.html#1293" title="Long">Long</a><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694050" title="=&gt; ch.epfl.lamp.compiler.msil.Type">FLOAT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Float)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R4</span>, <a href="#756399" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Float" class="delimiter">[</span><a href="../../../../Float.scala.html#1110" title="Float">Float</a><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756409" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694053" title="=&gt; ch.epfl.lamp.compiler.msil.Type">DOUBLE</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Double)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R8</span>, <a href="#756399" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Double" class="delimiter">[</span><a href="../../../../Double.scala.html#720" title="Double">Double</a><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              /* TODO one more case is described in Partition II, 16.2: bytearray(...) */
              <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="String(&quot;Unknown type for static literal field: &quot;)" class="string">&quot;Unknown type for static literal field: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756376" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      /** Creating objects works differently on .NET. On the JVM
       *  - NEW(type) =&gt; reference on Stack
       *  - DUP, load arguments, CALL_METHOD(constructor)
       *
       * On .NET, the NEW and DUP are ignored, but we emit a special method call
       *  - load arguments
       *  - NewObj(constructor) =&gt; reference on stack
       *
       * This variable tells whether the previous instruction was a NEW,
       * we expect a DUP which is not emitted. */
      <span class="keyword">var</span> <a title="Boolean" id="756195">previousWasNEW</a> = <span title="Boolean(false)" class="keyword">false</span>

      <span class="keyword">var</span> <a title="Int" id="756196">lastLineNr</a>: <a href="../../../../Int.scala.html#321" title="Int">Int</a> = <span title="Int(0)" class="int">0</span>
      <span class="keyword">var</span> <a title="GenMSIL.this.global.Position" id="756197">lastPos</a>: <a href="../../../../reflect/internal/util/Position.scala.html#22953" title="GenMSIL.this.global.Position">Position</a> = <a href="../../../../reflect/internal/Positions.scala.html#408302" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a>


      // EndExceptionBlock must happen before MarkLabel because it adds the
      // Leave instruction. Otherwise, labels(block) points to the Leave
      // (inside the catch) instead of the instruction afterwards.
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="756491">handlers</a> &lt;- <a href="#751907" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">endExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88246" title="(key: GenMSIL.this.global.icodes.BasicBlock)Option[List[GenMSIL.this.global.icodes.ExceptionHandler]]">get</a><a href="../../../../Option.scala.html#62884" title="(f: List[GenMSIL.this.global.icodes.ExceptionHandler] =&gt; Unit)Unit" class="delimiter">(</a><a href="#755643" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>; <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="756512">exh</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">handlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#751910" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298127" title="()GenMSIL.this.global.icodes.ExceptionHandler">pop</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.Label" id="756520">l</a> &lt;- <a href="#751925" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]">endFinallyLabels</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88246" title="(key: GenMSIL.this.global.icodes.ExceptionHandler)Option[ch.epfl.lamp.compiler.msil.emit.Label]">get</a><a href="../../../../Option.scala.html#62884" title="(f: ch.epfl.lamp.compiler.msil.emit.Label =&gt; Unit)Unit" class="delimiter">(</a><a href="#756512" title="GenMSIL.this.global.icodes.ExceptionHandler">exh</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="#756520" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a><span class="delimiter">)</span>
        <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Unit">EndExceptionBlock</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#755643" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Generating code for block: &quot;)" class="string">&quot;Generating code for block: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755643" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="756556">handler</a> &lt;- <a href="#751905" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]">beginCatchBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88246" title="(key: GenMSIL.this.global.icodes.BasicBlock)Option[GenMSIL.this.global.icodes.ExceptionHandler]">get</a><a href="../../../../Option.scala.html#62884" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit" class="delimiter">(</a><a href="#755643" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#751910" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298119" title="=&gt; Boolean">isEmpty</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#751910" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298126" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">top</a>.<a href="../icode/ExceptionHandlers.scala.html#696226" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#756556" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#696226" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#751910" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298127" title="()GenMSIL.this.global.icodes.ExceptionHandler">pop</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#751910" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298123" title="(elem: GenMSIL.this.global.icodes.ExceptionHandler)scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">push</a><span class="delimiter">(</span><a href="#756556" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756556" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#696209" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">cls</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; GenMSIL.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          // `finally` blocks are represented the same as `catch`, but with no catch-type
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Unit">BeginFinallyBlock</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="756589">t</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#756556" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#696209" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">cls</a><span class="delimiter">)</span>
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(exceptionType: ch.epfl.lamp.compiler.msil.Type)Unit">BeginCatchBlock</span><span class="delimiter">(</span><a href="#756589" title="ch.epfl.lamp.compiler.msil.Type">t</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="756598">handlers</a> &lt;- <a href="#751903" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">beginExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88246" title="(key: GenMSIL.this.global.icodes.BasicBlock)Option[List[GenMSIL.this.global.icodes.ExceptionHandler]]">get</a><a href="../../../../Option.scala.html#62884" title="(f: List[GenMSIL.this.global.icodes.ExceptionHandler] =&gt; Unit)Unit" class="delimiter">(</a><a href="#755643" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>; <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="756619">exh</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">handlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#751910" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298123" title="(elem: GenMSIL.this.global.icodes.ExceptionHandler)scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">push</a><span class="delimiter">(</span><a href="#756619" title="GenMSIL.this.global.icodes.ExceptionHandler">exh</a><span class="delimiter">)</span>
        <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Unit">BeginExceptionBlock</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Instruction" id="756628">instr</a> &lt;- <a href="../icode/BasicBlocks.scala.html#695934" title="(f: GenMSIL.this.global.icodes.Instruction =&gt; Unit)Unit">block</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Int" id="756629">currentLineNr</a> = <a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409692" title="=&gt; Int">line</a>
          <span class="keyword">val</span> <a title="Boolean" id="756630">skip</a> = <span title="Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409668" title="=&gt; Boolean">isRange</a><span class="delimiter">)</span> <a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409691" title="(pos: scala.reflect.internal.util.Position)Boolean">sameRange</a><span class="delimiter">(</span><a href="#756197" title="GenMSIL.this.global.Position">lastPos</a><span class="delimiter">)</span> <span class="keyword">else</span> <span class="delimiter">(</span><a href="#756629" title="Int">currentLineNr</a> <a href="../../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#756196" title="Int">lastLineNr</a><span class="delimiter">)</span>;
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#756630" title="Boolean">skip</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#751899" title="=&gt; Boolean">dbFilenameSeen</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="String" id="756639">fileName</a> = <span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#751899" title="=&gt; Boolean">dbFilenameSeen</a><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <span class="delimiter">{</span><a href="#751899" title="(x$1: Boolean)Unit">dbFilenameSeen</a> = <span title="Boolean(true)" class="keyword">true</span>; <a href="#751891" title="(iclass: GenMSIL.this.global.icodes.IClass)String">ilasmFileName</a><span class="delimiter">(</span><a href="#751856" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a><span class="delimiter">)</span><span class="delimiter">}</span>;
            <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409668" title="=&gt; Boolean">isRange</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="Int" id="756641">startLine</a> = <a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409683" title="=&gt; scala.reflect.internal.util.Position">focusStart</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409692" title="=&gt; Int">line</a>
              <span class="keyword">val</span> <a title="Int" id="756642">endLine</a>   = <a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409685" title="=&gt; scala.reflect.internal.util.Position">focusEnd</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409692" title="=&gt; Int">line</a>
              <span class="keyword">val</span> <a title="Int" id="756643">startCol</a>  = <a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409683" title="=&gt; scala.reflect.internal.util.Position">focusStart</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409693" title="=&gt; Int">column</a>
              <span class="keyword">val</span> <a title="Int" id="756644">endCol</a>    = <a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409685" title="=&gt; scala.reflect.internal.util.Position">focusEnd</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409693" title="=&gt; Int">column</a>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(startLine: Int, endLine: Int, startCol: Int, endCol: Int, filename: String)Unit">setPosition</span><span class="delimiter">(</span><a href="#756641" title="Int">startLine</a>, <a href="#756642" title="Int">endLine</a>, <a href="#756643" title="Int">startCol</a>, <a href="#756644" title="Int">endCol</a>, <a href="#756639" title="String">fileName</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(line: Int, filename: String)Unit">setPosition</span><span class="delimiter">(</span><a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409692" title="=&gt; Int">line</a>, <a href="#756639" title="String">fileName</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <a href="#756196" title="Int">lastLineNr</a> = <a href="#756629" title="Int">currentLineNr</a>
            <a href="#756197" title="GenMSIL.this.global.Position">lastPos</a> = <a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span> <span class="keyword">case</span> <span title="Unit">_</span>: <span title="UnsupportedOperationException">UnsupportedOperationException</span> =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756195" title="Boolean">previousWasNEW</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../icode/Opcodes.scala.html#624349" title="GenMSIL.this.global.icodes.opcodes.DUP">DUP</a><span class="delimiter">]</span>, <a href="#755643" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>

        <a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> THIS<a href="#3318489" title="Unit" id="3318491" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705567" title="GenMSIL.this.global.icodes.global.Symbol" id="756662">clasz</a><span class="delimiter">)</span> =&gt;
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CONSTANT<a href="#3318489" title="Unit" id="3318493" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#704290" title="GenMSIL.this.global.icodes.global.Constant" id="756666">const</a><span class="delimiter">)</span> =&gt;
            <a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="#3318571" title="(x: Unit)Unit">tag</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> UnitTag    =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
              <span class="keyword">case</span> BooleanTag =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/internal/Constants.scala.html#409779" title="=&gt; Boolean">booleanValue</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_1</span>
                                            <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
              <span class="keyword">case</span> ByteTag    =&gt; <a href="#751930" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../Byte.scala.html#56757" title="=&gt; Int">byteValue</a>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> ShortTag   =&gt; <a href="#751930" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../Short.scala.html#56944" title="=&gt; Int">shortValue</a>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> CharTag    =&gt; <a href="#751930" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../Char.scala.html#57230" title="=&gt; Int">charValue</a>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> IntTag     =&gt; <a href="#751930" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/internal/Constants.scala.html#409783" title="=&gt; Int">intValue</a>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> LongTag    =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Long)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I8</span>, <a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/internal/Constants.scala.html#409784" title="=&gt; Long">longValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> FloatTag   =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Float)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R4</span>, <a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/internal/Constants.scala.html#409785" title="=&gt; Float">floatValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> DoubleTag  =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Double)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R8</span>, <a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/internal/Constants.scala.html#409786" title="=&gt; Double">doubleValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> StringTag  =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: String)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldstr</span>, <a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/internal/Constants.scala.html#409788" title="=&gt; String">stringValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> NullTag    =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
              <span class="keyword">case</span> ClazzTag   =&gt;
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldtoken</span>, <a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/internal/Constants.scala.html#409791" title="=&gt; GenMSIL.this.global.icodes.global.Type">typeValue</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751816" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">TYPE_FROM_HANDLE</a><span class="delimiter">)</span>
              <span class="keyword">case</span> _          =&gt; <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><span title="Nothing" class="delimiter">(</span><span title="String(&quot;Unknown constant value: &quot;)" class="string">&quot;Unknown constant value: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756666" title="GenMSIL.this.global.icodes.global.Constant">const</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> LOAD_ARRAY_ITEM<a href="#3318489" title="Unit" id="3318495" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703309" title="GenMSIL.this.global.icodes.TypeKind" id="756704">kind</a><span class="delimiter">)</span> =&gt;
            <span class="delimiter">(</span><a href="#756704" title="GenMSIL.this.global.icodes.TypeKind">kind</a>: @<a href="#3318571" title="(x: Unit)Unit">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614992" title="Unit" id="3318280">BOOL</a>           =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318289" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I1</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614994" title="Unit" id="3318281">BYTE</a>           =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318289" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I1</span><span class="delimiter">)</span> // I1 for System.SByte, i.e. a scala.Byte
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614996" title="Unit" id="3318282">SHORT</a>          =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318289" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614998" title="Unit" id="3318283">CHAR</a>           =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318289" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_U2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615000" title="Unit" id="3318284">INT</a>            =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318289" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615002" title="Unit" id="3318285">LONG</a>           =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318289" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615004" title="Unit" id="3318286">FLOAT</a>          =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318289" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_R4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615006" title="Unit" id="3318287">DOUBLE</a>         =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318289" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_R8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> REFERENCE<a href="#3318267" title="Unit" id="3318277" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="GenMSIL.this.global.icodes.global.Symbol" id="756723">cls</a><span class="delimiter">)</span> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318289" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_Ref</span><span class="delimiter">)</span>
              <span class="keyword">case</span> ARRAY<a href="#3318267" title="Unit" id="3318279" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#695807" title="GenMSIL.this.global.icodes.TypeKind" id="756727">elem</a><span class="delimiter">)</span>    =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318289" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_Ref</span><span class="delimiter">)</span>

              // case UNIT is not possible: an Array[Unit] will be an
              //  Array[scala.runtime.BoxedUnit] (-&gt; case REFERENCE)
            <span class="delimiter">}</span>

          <span class="keyword">case</span> LOAD_LOCAL<a href="#3318489" title="Unit" id="3318497" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703703" title="GenMSIL.this.global.icodes.Local" id="756731">local</a><span class="delimiter">)</span> =&gt; <a href="#756193" title="(local: GenMSIL.this.global.icodes.Local, msg: String, loadAddr: Boolean)Unit">loadLocalOrAddress</a><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><a href="#756731" title="GenMSIL.this.global.icodes.Local">local</a>, <span title="String(&quot;load_local&quot;)" class="string">&quot;load_local&quot;</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_LOAD_LOCAL_ADDRESS<a href="#3318489" title="Unit" id="3318499" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#704493" title="GenMSIL.this.global.icodes.Local" id="756733">local</a><span class="delimiter">)</span> =&gt; <a href="#756193" title="(local: GenMSIL.this.global.icodes.Local, msg: String, loadAddr: Boolean)Unit">loadLocalOrAddress</a><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><a href="#756733" title="GenMSIL.this.global.icodes.Local">local</a>, <span title="String(&quot;cil_load_local_address&quot;)" class="string">&quot;cil_load_local_address&quot;</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

          <span class="keyword">case</span> LOAD_FIELD<a href="#3318489" title="Unit" id="3318501" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#706266" title="GenMSIL.this.global.icodes.global.Symbol" id="756736">field</a>, <a href="../icode/Opcodes.scala.html#706268" title="Boolean" id="756737">isStatic</a><span class="delimiter">)</span> =&gt; <a href="#756194" title="(field: GenMSIL.this.global.Symbol, isStatic: Boolean, msg: String, loadAddr: Boolean)Unit">loadFieldOrAddress</a><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><a href="#756736" title="GenMSIL.this.global.icodes.global.Symbol">field</a>, <a href="#756737" title="Boolean">isStatic</a>, <span title="String(&quot;load_field&quot;)" class="string">&quot;load_field&quot;</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_LOAD_FIELD_ADDRESS<a href="#3318489" title="Unit" id="3318503" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#704586" title="GenMSIL.this.global.icodes.global.Symbol" id="756740">field</a>, <a href="../icode/Opcodes.scala.html#704588" title="Boolean" id="756741">isStatic</a><span class="delimiter">)</span> =&gt; <a href="#756194" title="(field: GenMSIL.this.global.Symbol, isStatic: Boolean, msg: String, loadAddr: Boolean)Unit">loadFieldOrAddress</a><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><a href="#756740" title="GenMSIL.this.global.icodes.global.Symbol">field</a>, <a href="#756741" title="Boolean">isStatic</a>, <span title="String(&quot;cil_load_field_address&quot;)" class="string">&quot;cil_load_field_address&quot;</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_LOAD_ARRAY_ITEM_ADDRESS<a href="#3318489" title="Unit" id="3318505" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#704684" title="GenMSIL.this.global.icodes.TypeKind" id="756743">kind</a><span class="delimiter">)</span> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelema</span>, <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#756743" title="GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_NEWOBJ<a href="#3318489" title="Unit" id="3318507" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705858" title="GenMSIL.this.global.icodes.global.Symbol" id="756755">msym</a><span class="delimiter">)</span> =&gt;
            <a href="../../Global.scala.html#537498" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#756755" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411200" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="756756">constructorInfo</a>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span> = <a href="#751977" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">getConstructor</a><span class="delimiter">(</span><a href="#756755" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#756756" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>

          <span class="keyword">case</span> LOAD_MODULE<a href="#3318489" title="Unit" id="3318509" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#707054" title="GenMSIL.this.global.icodes.global.Symbol" id="756766">module</a><span class="delimiter">)</span> =&gt;
            <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Generating LOAD_MODULE for: &quot;)" class="string">&quot;Generating LOAD_MODULE for: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751986" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#756766" title="GenMSIL.this.global.icodes.global.Symbol">module</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#751963" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#756766" title="GenMSIL.this.global.icodes.global.Symbol">module</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> STORE_ARRAY_ITEM<a href="#3318489" title="Unit" id="3318511" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703339" title="GenMSIL.this.global.icodes.TypeKind" id="756772">kind</a><span class="delimiter">)</span> =&gt;
            <span class="delimiter">(</span><a href="#756772" title="GenMSIL.this.global.icodes.TypeKind">kind</a>: @<a href="#3318571" title="(x: Unit)Unit">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614992" title="Unit" id="3318339">BOOL</a>           =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318348" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I1</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614994" title="Unit" id="3318340">BYTE</a>           =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318348" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I1</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614996" title="Unit" id="3318341">SHORT</a>          =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318348" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614998" title="Unit" id="3318342">CHAR</a>           =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318348" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615000" title="Unit" id="3318343">INT</a>            =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318348" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615002" title="Unit" id="3318344">LONG</a>           =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318348" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615004" title="Unit" id="3318345">FLOAT</a>          =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318348" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_R4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615006" title="Unit" id="3318346">DOUBLE</a>         =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318348" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_R8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> REFERENCE<a href="#3318326" title="Unit" id="3318336" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="GenMSIL.this.global.icodes.global.Symbol" id="756791">cls</a><span class="delimiter">)</span> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318348" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_Ref</span><span class="delimiter">)</span>
              <span class="keyword">case</span> ARRAY<a href="#3318326" title="Unit" id="3318338" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#695807" title="GenMSIL.this.global.icodes.TypeKind" id="756795">elem</a><span class="delimiter">)</span>    =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318348" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_Ref</span><span class="delimiter">)</span> // @TODO: test this! (occurs when calling a Array[Object]* vararg param method)

              // case UNIT not possible (see comment at LOAD_ARRAY_ITEM)
            <span class="delimiter">}</span>

          <span class="keyword">case</span> STORE_LOCAL<a href="#3318489" title="Unit" id="3318513" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700872" title="GenMSIL.this.global.icodes.Local" id="756799">local</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="Boolean" id="756800">isArg</a> = <a href="#756799" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#696354" title="=&gt; Boolean">arg</a>
            <span class="keyword">val</span> <a title="Int" id="756801">i</a> = <a href="#756799" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#696357" title="=&gt; Int">index</a>
            <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;store_local for &quot;)" class="string">&quot;store_local for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756799" title="GenMSIL.this.global.icodes.Local">local</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, index &quot;)" class="string">&quot;, index &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756801" title="Int">i</a><span class="delimiter">)</span>

            // there are some locals defined by the compiler that
            // are isArg and are need to be stored.
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756800" title="Boolean">isArg</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756801" title="Int">i</a> <a href="../../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#756801" title="Int">i</a> <a href="../../../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Starg_S</span>, <a href="#756801" title="Int">i</a><span class="delimiter">)</span>
              <span class="keyword">else</span>
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Starg</span>, <a href="#756801" title="Int">i</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#756801" title="Int">i</a> <span class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span class="int">0</span> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_0</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span class="int">1</span> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_1</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span class="int">2</span> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_2</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span class="int">3</span> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_3</span><span class="delimiter">)</span>
                <span class="keyword">case</span> _      =&gt;
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756801" title="Int">i</a> <a href="../../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#756801" title="Int">i</a> <a href="../../../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
                    <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_S</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#756799" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
                  <span class="keyword">else</span>
                    <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#756799" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> STORE_THIS<a href="#3318489" title="Unit" id="3318516" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#706867" title="GenMSIL.this.global.icodes.TypeKind" id="3318514">_</a><span class="delimiter">)</span> =&gt;
            // this only works for impl classes because the self parameter comes first
            // in the method signature. If that changes, this code has to be revisited.
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Starg_S</span>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

          <span class="keyword">case</span> STORE_FIELD<a href="#3318489" title="Unit" id="3318518" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#702957" title="GenMSIL.this.global.icodes.global.Symbol" id="756887">field</a>, <a href="../icode/Opcodes.scala.html#702959" title="Boolean" id="756888">isStatic</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="756889">fieldInfo</a> = <a href="../../symtab/clr/CLRTypes.scala.html#694101" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.FieldInfo]">fields</a>.<a href="../../../../collection/MapLike.scala.html#87525" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.FieldInfo]">get</a><a href="#3318404" title="(x: ch.epfl.lamp.compiler.msil.FieldInfo)ch.epfl.lamp.compiler.msil.FieldInfo" class="delimiter">(</a><a href="#756887" title="GenMSIL.this.global.icodes.global.Symbol">field</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#3318399" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="3318400" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="756893">fInfo</a><span class="delimiter">)</span> =&gt; <a href="#3318404" title="(x: ch.epfl.lamp.compiler.msil.FieldInfo)ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
              <span class="keyword">case</span> <a href="../../../../Option.scala.html#1585" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="3318402">None</a> =&gt;
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="756894">fInfo</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#756887" title="GenMSIL.this.global.icodes.global.Symbol">field</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="(x$1: String)ch.epfl.lamp.compiler.msil.FieldInfo">GetField</span><span class="delimiter">(</span><a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#756887" title="GenMSIL.this.global.icodes.global.Symbol">field</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#756887" title="GenMSIL.this.global.icodes.global.Symbol">field</a><span class="delimiter">)</span> = <a href="#756894" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
                <a href="#756894" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
            <span class="delimiter">}</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#756888" title="Boolean">isStatic</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stsfld</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stfld</span>, <a href="#756889" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>

          <span class="keyword">case</span> CALL_PRIMITIVE<a href="#3318489" title="Unit" id="3318520" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703080" title="GenMSIL.this.global.icodes.Primitive" id="756902">primitive</a><span class="delimiter">)</span> =&gt;
            <a href="#751929" title="(primitive: GenMSIL.this.global.icodes.Primitive, pos: GenMSIL.this.global.Position)Unit">genPrimitive</a><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><a href="#756902" title="GenMSIL.this.global.icodes.Primitive">primitive</a>, <a href="#756628" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#695883" title="=&gt; scala.reflect.internal.util.Position">pos</a><span class="delimiter">)</span>

          <span class="keyword">case</span> CALL_METHOD<a href="#3318489" title="Unit" id="3318522" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705592" title="GenMSIL.this.global.icodes.global.Symbol" id="756907">msym</a>, <a href="../icode/Opcodes.scala.html#705594" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle" id="756908">style</a><span class="delimiter">)</span> =&gt;
            <a href="#3318571" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411200" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="756909">constructorInfo</a>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span> = <a href="#751977" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">getConstructor</a><span class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span>
              <span class="delimiter">(</span><a href="#756908" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle">style</a>: @<a href="../icode/Opcodes.scala.html#624367" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                // normal constructor calls are Static..
                <span class="keyword">case</span> Static<a href="#3318412" title="Unit" id="3318415" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705893" title="Boolean" id="3318413">_</a><span class="delimiter">)</span> =&gt;
                  <a href="#3318420" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#751859" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411200" title="=&gt; Boolean">isClassConstructor</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#751859" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>
                    // we're generating a constructor (method: IMethod is a constructor), and we're
                    // calling another constructor of the same class.

                    // @LUC TODO: this can probably break, namely when having: class A { def this() { new A() } }
                    // instead, we should instruct the CALL_METHOD with additional information, know whether it's
                    // an instance creation constructor call or not.
                    <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#756909" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>
                  <span class="keyword">else</span>
                    <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#756909" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>
                <span class="keyword">case</span> SuperCall<a href="#3318412" title="Unit" id="3318418" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705550" title="GenMSIL.this.global.icodes.global.Name" id="3318416">_</a><span class="delimiter">)</span> =&gt;
                  <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#756909" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751960" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#751856" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
                      <a href="#751945" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">notInitializedModules</a>.<a href="../../../../collection/mutable/HashSet.scala.html#125962" title="(elem: GenMSIL.this.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#751856" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
                      <a href="#751859" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411200" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span>
                    <span class="delimiter">{</span>
                      <a href="#751945" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">notInitializedModules</a> <a href="../../../../collection/mutable/HashSet.scala.html#125964" title="(elem: GenMSIL.this.global.Symbol)BytecodeGenerator.this.notInitializedModules.type">-=</a> <a href="#751856" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
                      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
                      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stsfld</span>, <a href="#751963" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#751856" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span>
                    <span class="delimiter">}</span>
              <span class="delimiter">}</span>

            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

              <span class="keyword">var</span> <a title="Boolean" id="756955">doEmit</a> = <span title="Boolean(true)" class="keyword">true</span>
              <a href="#751954" title="(sym: GenMSIL.this.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">getTypeOpt</a><span title="Unit" class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> Some<a href="#3318425" title="Unit" id="3318426" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="ch.epfl.lamp.compiler.msil.Type" id="756961">typ</a><span class="delimiter">)</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="#756961" title="ch.epfl.lamp.compiler.msil.Type">typ</a>.<span title="()Boolean">IsEnum</span><span class="delimiter">)</span> =&gt; <a href="#3318428" title="(x: Unit)Unit" class="delimiter">{</a>
                  <span class="keyword">def</span> <a title="()Unit" id="756962">negBool</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
                    <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
                    <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>
                  <span class="delimiter">}</span>
                  <a href="#756955" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                  <span class="keyword">val</span> <a title="msym.NameType" id="756963">name</a> = <a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; msym.NameType">name</a>
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756963" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414634" title="=&gt; GenMSIL.this.global.TermName">EQ</a><span class="delimiter">)</span>       <span class="delimiter">{</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756963" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414658" title="=&gt; GenMSIL.this.global.TermName">NE</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>; <a href="#756962" title="()Unit">negBool</a> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756963" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414650" title="=&gt; GenMSIL.this.global.TermName">LT</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Clt</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756963" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414644" title="=&gt; GenMSIL.this.global.TermName">LE</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Cgt</span><span class="delimiter">)</span>; <a href="#756962" title="()Unit">negBool</a> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756963" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414640" title="=&gt; GenMSIL.this.global.TermName">GT</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Cgt</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756963" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414638" title="=&gt; GenMSIL.this.global.TermName">GE</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Clt</span><span class="delimiter">)</span>; <a href="#756962" title="()Unit">negBool</a> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756963" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414660" title="=&gt; GenMSIL.this.global.TermName">OR</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Or</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756963" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414628" title="=&gt; GenMSIL.this.global.TermName">AND</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">And</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756963" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414666" title="=&gt; GenMSIL.this.global.TermName">XOR</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Xor</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span>
                    <a href="#756955" title="Boolean">doEmit</a> = <span title="Boolean(true)" class="keyword">true</span>
                <span class="delimiter">}</span>
                <span class="keyword">case</span> _ =&gt; <a href="#3318428" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              // method: implicit view(FunctionX[PType0, PType1, ...,PTypeN, ResType]):DelegateType
              <span class="keyword">val</span> <a href="#3318444" title="(x: (Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type))(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#60576" title="Boolean" id="756957">isDelegateView</a>, <a href="../../../../Tuple3.scala.html#60578" title="GenMSIL.this.global.Type" id="756958">paramType</a>, <a href="../../../../Tuple3.scala.html#60580" title="GenMSIL.this.global.Type" id="756959">resType</a><span class="delimiter">)</span> = <a href="../../Global.scala.html#537732" title="(op: =&gt; (Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type))(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)">beforeTyper</a> <a href="../../../../Tuple3.scala.html#126" title="(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type) @unchecked" class="delimiter">{</a>
                <a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a> <span class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> MethodType<a href="#3318433" title="(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" id="3318435" class="delimiter">(</a><a href="../../../../reflect/internal/Types.scala.html#410769" title="List[GenMSIL.this.global.Symbol]" id="756990">params</a>, <a href="../../../../reflect/internal/Types.scala.html#410771" title="GenMSIL.this.global.Type" id="756991">resultType</a><span class="delimiter">)</span>
                  <span class="keyword">if</span> <span class="delimiter">(</span><a href="#756990" title="List[GenMSIL.this.global.Symbol]">params</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414593" title="=&gt; GenMSIL.this.global.nme.NameType">view_</a><span class="delimiter">)</span> =&gt;
                    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="757002">paramType</a> = <a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.Symbol">params</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>
                    <span class="keyword">val</span> <a title="Boolean" id="757003">isDel</a> = <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409054" title="(delegateType: GenMSIL.this.global.Type, functionType: GenMSIL.this.global.Type)Boolean">isCorrespondingDelegate</a><span class="delimiter">(</span><a href="#756991" title="GenMSIL.this.global.Type">resultType</a>, <a href="#757002" title="GenMSIL.this.global.Type">paramType</a><span class="delimiter">)</span>
                    <a href="../../../../Tuple3.scala.html#63169" title="(_1: Boolean, _2: GenMSIL.this.global.Type, _3: GenMSIL.this.global.Type)(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" class="delimiter">(</a><a href="#757003" title="Boolean">isDel</a>, <a href="#757002" title="GenMSIL.this.global.Type">paramType</a>, <a href="#756991" title="GenMSIL.this.global.Type">resultType</a><span class="delimiter">)</span>
                  <span class="keyword">case</span> _ =&gt; <a href="#3318437" title="(x: (Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type))(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" class="delimiter">(</a><span title="Boolean(false)" class="keyword">false</span>, <span title="Null(null)" class="keyword">null</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756955" title="Boolean">doEmit</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#756957" title="Boolean">isDelegateView</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#756955" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                <a href="#751974" title="(functionType: GenMSIL.this.global.Type, delegateType: GenMSIL.this.global.Type)Unit">createDelegateCaller</a><span class="delimiter">(</span><a href="#756958" title="GenMSIL.this.global.Type">paramType</a>, <a href="#756959" title="GenMSIL.this.global.Type">resType</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756955" title="Boolean">doEmit</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
                  <span class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414662" title="=&gt; GenMSIL.this.global.TermName">PLUS</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414652" title="=&gt; GenMSIL.this.global.TermName">MINUS</a><span class="delimiter">)</span>
                  <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694116" title="(t: ch.epfl.lamp.compiler.msil.Type)Boolean">isDelegateType</a><span class="delimiter">(</span><a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">{</span>
                <a href="#756955" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="757724">methodInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751979" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span>
                // call it as a static method, even if the compiler (symbol) thinks it's virtual
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#757724" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Castclass</span>, <a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756955" title="Boolean">doEmit</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#409049" title="=&gt; List[GenMSIL.this.global.Symbol]">Delegate_scalaCallers</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#756955" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="757740">methodSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a> = <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol">Delegate_scalaCallerTargets</a><span class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span>
                <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="757741">delegateType</a>: <a href="../../../../reflect/internal/Types.scala.html#407270" title="GenMSIL.this.global.Type">Type</a> = <a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a> <span class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> MethodType<a href="#3318448" title="GenMSIL.this.global.Type" id="3318451" class="delimiter">(</a><a href="../../../../reflect/internal/Types.scala.html#410769" title="List[GenMSIL.this.global.Symbol]" id="3318449">_</a>, <a href="../../../../reflect/internal/Types.scala.html#410771" title="GenMSIL.this.global.Type" id="757771">retType</a><span class="delimiter">)</span> =&gt; <a href="#3318453" title="(x: GenMSIL.this.global.Type)GenMSIL.this.global.Type">retType</a>
                  <span class="keyword">case</span> _ =&gt; <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><a href="#3318453" title="(x: GenMSIL.this.global.Type)GenMSIL.this.global.Type" class="delimiter">(</a><span title="String(&quot;not a method type: &quot;)" class="string">&quot;not a method type: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span>
                <span class="delimiter">}</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="757742">methodInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751979" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#757740" title="GenMSIL.this.global.Symbol">methodSym</a><span class="delimiter">)</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="757743">delegCtor</a> = <a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757741" title="GenMSIL.this.global.Type">delegateType</a><span class="delimiter">)</span>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><a href="../../../../Array.scala.html#72260" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#694068" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>, <a href="#751818" title="=&gt; ch.epfl.lamp.compiler.msil.Type">INT_PTR</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#757740" title="GenMSIL.this.global.Symbol">methodSym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411293" title="=&gt; Boolean">isStatic</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldftn</span>, <a href="#757742" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                  <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Dup</span><span class="delimiter">)</span>
                  <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldvirtftn</span>, <a href="#757742" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                <span class="delimiter">}</span>
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#757743" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">delegCtor</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756955" title="Boolean">doEmit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="757813">methodInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751979" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span>
                <span class="delimiter">(</span><a href="#756908" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle">style</a>: @<a href="../icode/Opcodes.scala.html#624367" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> SuperCall<a href="#3318458" title="Unit" id="3318461" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705550" title="GenMSIL.this.global.icodes.global.Name" id="3318459">_</a><span class="delimiter">)</span> =&gt;
                    <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3318468" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                  <span class="keyword">case</span> <a href="../icode/Opcodes.scala.html#624368" title="Unit" id="3318466">Dynamic</a> =&gt;
                    // methodInfo.DeclaringType is null for global methods
                    <span class="keyword">val</span> <a title="Boolean" id="757820">isValuetypeMethod</a> = <span class="delimiter">(</span><a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span>.<span title="()Boolean">IsValueType</span><span class="delimiter">)</span>
                    <span class="keyword">val</span> <a title="Boolean" id="757821">isValuetypeVirtualMethod</a> = <a href="#757820" title="Boolean">isValuetypeMethod</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="()Boolean">IsVirtual</span><span class="delimiter">)</span>
                    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../collection/GenSetLike.scala.html#66403" title="(elem: GenMSIL.this.global.Symbol)Boolean">dynToStatMapped</a><span class="delimiter">(</span><a href="#756907" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#757821" title="Boolean">isValuetypeVirtualMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Constrained</span>, <a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span><span class="delimiter">)</span>
                      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#757820" title="Boolean">isValuetypeMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                      // otherwise error &quot;Callvirt on a value type method&quot; ensues
                      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span>
                  <span class="keyword">case</span> Static<a href="#3318458" title="Unit" id="3318465" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705893" title="Boolean" id="3318463">_</a><span class="delimiter">)</span> =&gt;
                    <a href="#3318468" title="(x: Unit)Unit" class="keyword">if</a><span class="delimiter">(</span><a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="()Boolean">IsVirtual</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Boolean">Ldarg0WasJustEmitted</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#757813" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> BOX<a href="#3318489" title="Unit" id="3318524" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#704712" title="GenMSIL.this.global.icodes.TypeKind" id="757868">boxType</a><span class="delimiter">)</span> =&gt;
            <a href="#751975" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitBox</a><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, <a href="#757868" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span>

          <span class="keyword">case</span> UNBOX<a href="#3318489" title="Unit" id="3318526" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#706007" title="GenMSIL.this.global.icodes.TypeKind" id="757870">boxType</a><span class="delimiter">)</span> =&gt;
            <a href="#751976" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitUnbox</a><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, <a href="#757870" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_UNBOX<a href="#3318489" title="Unit" id="3318528" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#704733" title="GenMSIL.this.global.icodes.TypeKind" id="757872">boxType</a><span class="delimiter">)</span> =&gt;
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Unbox</span>, <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757872" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_INITOBJ<a href="#3318489" title="Unit" id="3318530" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#704513" title="GenMSIL.this.global.icodes.TypeKind" id="757884">valueType</a><span class="delimiter">)</span> =&gt;
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Initobj</span>, <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757884" title="GenMSIL.this.global.icodes.TypeKind">valueType</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> NEW<a href="#3318489" title="Unit" id="3318533" class="delimiter">(</a>REFERENCE<a href="../icode/Opcodes.scala.html#705364" title="GenMSIL.this.global.icodes.REFERENCE" id="3318531" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="GenMSIL.this.global.icodes.global.Symbol" id="757897">cls</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            // the next instruction must be a DUP, see comment on `var previousWasNEW`
            <a href="#756195" title="Boolean">previousWasNEW</a> = <span title="Boolean(true)" class="keyword">true</span>

          // works also for arrays and reference-types
          <span class="keyword">case</span> CREATE_ARRAY<a href="#3318489" title="Unit" id="3318535" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705817" title="GenMSIL.this.global.icodes.TypeKind" id="757900">elem</a>, <a href="../icode/Opcodes.scala.html#705819" title="Int" id="757901">dims</a><span class="delimiter">)</span> =&gt;
            // TODO: handle multi dimensional arrays
            <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#757901" title="Int">dims</a> <a href="../../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span>, <span title="String(&quot;Can\'t handle multi dimensional arrays&quot;)" class="string">&quot;Can't handle multi dimensional arrays&quot;</span><span class="delimiter">)</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newarr</span>, <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757900" title="GenMSIL.this.global.icodes.TypeKind">elem</a><span class="delimiter">)</span><span class="delimiter">)</span>

          // works for arrays and reference-types
          <span class="keyword">case</span> IS_INSTANCE<a href="#3318489" title="Unit" id="3318537" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705413" title="GenMSIL.this.global.icodes.TypeKind" id="757920">tpe</a><span class="delimiter">)</span> =&gt;
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Isinst</span>, <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757920" title="GenMSIL.this.global.icodes.TypeKind">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>

          // works for arrays and reference-types
          // part from the scala reference: &quot;S &lt;: T does not imply
          //  Array[S] &lt;: Array[T] in Scala. However, it is possible
          //  to cast an array of S to an array of T if such a cast
          //  is permitted in the host environment.&quot;
          <span class="keyword">case</span> CHECK_CAST<a href="#3318489" title="Unit" id="3318539" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705467" title="GenMSIL.this.global.icodes.TypeKind" id="757940">tpknd</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="757941">tMSIL</a> = <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757940" title="GenMSIL.this.global.icodes.TypeKind">tpknd</a><span class="delimiter">)</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Castclass</span>, <a href="#757941" title="ch.epfl.lamp.compiler.msil.Type">tMSIL</a><span class="delimiter">)</span>

          // no SWITCH is generated when there's
          //  - a default case (&quot;case _ =&gt; ...&quot;) in the matching expr
          //  - OR is used (&quot;case 1 | 2 =&gt; ...&quot;)
          <span class="keyword">case</span> SWITCH<a href="#3318489" title="Unit" id="3318541" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#701271" title="List[List[Int]]" id="757954">tags</a>, <a href="../icode/Opcodes.scala.html#701273" title="List[GenMSIL.this.global.icodes.BasicBlock]" id="757955">branches</a><span class="delimiter">)</span> =&gt;
            // tags is List[List[Int]]; a list of integers for every label.
            //    if the int on stack is 4, and 4 is in the second list =&gt; jump
            //    to second label
            // branches is List[BasicBlock]
            //    the labels to jump to (the last one is the default one)

            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="757956">switchLocal</a> = <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(localType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">DeclareLocal</span><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#694038" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MINT</a><span class="delimiter">)</span>
            // several switch variables will appear with the same name in the
            //  assembly code, but this makes no truble
            <a href="#757956" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">switchLocal</a>.<span title="(name: String)Unit">SetLocalSymInfo</span><span class="delimiter">(</span><span title="String(&quot;$switch_var&quot;)" class="string">&quot;$switch_var&quot;</span><span class="delimiter">)</span>

            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc</span>, <a href="#757956" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">switchLocal</a><span class="delimiter">)</span>
            <span class="keyword">var</span> <a title="Int" id="757957">i</a> = <span title="Int(0)" class="int">0</span>
            <span class="keyword">for</span> <span class="delimiter">(</span><a title="List[Int]" id="757983">l</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: List[Int] =&gt; Unit)Unit">tags</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="757984">targetLabel</a> = <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.icodes.BasicBlock">branches</a><span class="delimiter">(</span><a href="#757957" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="758031">i</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: Int =&gt; Unit)Unit">l</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc</span>, <a href="#757956" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">switchLocal</a><span class="delimiter">)</span>
                <a href="#751930" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#758031" title="Int">i</a>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Beq</span>, <a href="#757984" title="ch.epfl.lamp.compiler.msil.emit.Label">targetLabel</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
              <a href="#757957" title="Int">i</a> <a href="../../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
            <span class="delimiter">}</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="757958">defaultTarget</a> = <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.icodes.BasicBlock">branches</a><span class="delimiter">(</span><a href="#757957" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#755645" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.icodes.BasicBlock">branches</a><span class="delimiter">(</span><a href="#757957" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="#757958" title="ch.epfl.lamp.compiler.msil.emit.Label">defaultTarget</a><span class="delimiter">)</span>

          <span class="keyword">case</span> JUMP<a href="#3318489" title="Unit" id="3318543" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700755" title="GenMSIL.this.global.icodes.BasicBlock" id="758090">whereto</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a href="#3318479" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#60576" title="Boolean" id="758092">leaveHandler</a>, <a href="../../../../Tuple3.scala.html#60578" title="Boolean" id="758093">leaveFinally</a>, <a href="../../../../Tuple3.scala.html#60580" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="758094">lfTarget</a><span class="delimiter">)</span> = <a href="#751933" title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])">leavesHandler</a><a href="../../../../Tuple3.scala.html#126" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]) @unchecked" class="delimiter">(</a><a href="#755643" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#758090" title="GenMSIL.this.global.icodes.BasicBlock">whereto</a><span class="delimiter">)</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758092" title="Boolean">leaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758093" title="Boolean">leaveFinally</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758094" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">lfTarget</a>.<a href="../../../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#758094" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">lfTarget</a>.<a href="../../../../Option.scala.html#62858" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">get</a><span class="delimiter">)</span>
                <span class="keyword">else</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Endfinally</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span>
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#758090" title="GenMSIL.this.global.icodes.BasicBlock">whereto</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#755645" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#758090" title="GenMSIL.this.global.icodes.BasicBlock">whereto</a><span class="delimiter">)</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#758090" title="GenMSIL.this.global.icodes.BasicBlock">whereto</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CJUMP<a href="#3318489" title="Unit" id="3318545" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#701128" title="GenMSIL.this.global.icodes.BasicBlock" id="758173">success</a>, <a href="../icode/Opcodes.scala.html#701130" title="GenMSIL.this.global.icodes.BasicBlock" id="758174">failure</a>, <a href="../icode/Opcodes.scala.html#701132" title="GenMSIL.this.global.icodes.TestOp" id="758175">cond</a>, <a href="../icode/Opcodes.scala.html#701134" title="GenMSIL.this.global.icodes.TypeKind" id="758176">kind</a><span class="delimiter">)</span> =&gt;
            // cond is TestOp (see Primitives.scala), and can take
            // values EQ, NE, LT, GE LE, GT
            // kind is TypeKind
            <span class="keyword">val</span> <a title="Boolean" id="758177">isFloat</a> = <a href="#758176" title="GenMSIL.this.global.icodes.TypeKind">kind</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../icode/TypeKinds.scala.html#615004" title="GenMSIL.this.global.icodes.FLOAT.type">FLOAT</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#758176" title="GenMSIL.this.global.icodes.TypeKind">kind</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../icode/TypeKinds.scala.html#615006" title="GenMSIL.this.global.icodes.DOUBLE.type">DOUBLE</a>
            <span class="keyword">val</span> <a title="(GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit" id="758178">emit</a> = <span class="delimiter">(</span>c: <a href="../icode/Primitives.scala.html#615076" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, l: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span><span class="delimiter">)</span> =&gt; <a href="#751935" title="(condition: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label, isFloat: Boolean)Unit">emitBr</a><span class="delimiter">(</span><a href="#758188" title="GenMSIL.this.global.icodes.TestOp">c</a>, <a href="#758189" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a>, <a href="#758177" title="Boolean">isFloat</a><span class="delimiter">)</span>
            <a href="#751934" title="(block: GenMSIL.this.global.icodes.BasicBlock, cond: GenMSIL.this.global.icodes.TestOp, success: GenMSIL.this.global.icodes.BasicBlock, failure: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock, emitBrFun: (GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit)Unit">emitCondBr</a><span class="delimiter">(</span><a href="#755643" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#758175" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="#758173" title="GenMSIL.this.global.icodes.BasicBlock">success</a>, <a href="#758174" title="GenMSIL.this.global.icodes.BasicBlock">failure</a>, <a href="#755645" title="GenMSIL.this.global.icodes.BasicBlock">next</a>, <a href="#758178" title="(GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit">emit</a><span class="delimiter">)</span>

          <span class="keyword">case</span> CZJUMP<a href="#3318489" title="Unit" id="3318547" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#701202" title="GenMSIL.this.global.icodes.BasicBlock" id="758203">success</a>, <a href="../icode/Opcodes.scala.html#701204" title="GenMSIL.this.global.icodes.BasicBlock" id="758204">failure</a>, <a href="../icode/Opcodes.scala.html#701206" title="GenMSIL.this.global.icodes.TestOp" id="758205">cond</a>, <a href="../icode/Opcodes.scala.html#701208" title="GenMSIL.this.global.icodes.TypeKind" id="758206">kind</a><span class="delimiter">)</span> =&gt;
            <a href="#751934" title="(block: GenMSIL.this.global.icodes.BasicBlock, cond: GenMSIL.this.global.icodes.TestOp, success: GenMSIL.this.global.icodes.BasicBlock, failure: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock, emitBrFun: (GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit)Unit">emitCondBr</a><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><a href="#755643" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#758205" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="#758203" title="GenMSIL.this.global.icodes.BasicBlock">success</a>, <a href="#758204" title="GenMSIL.this.global.icodes.BasicBlock">failure</a>, <a href="#755645" title="GenMSIL.this.global.icodes.BasicBlock">next</a>, <a href="#751936" title="(cond: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrBool</a><span class="delimiter">(</span><a href="#758208" title="GenMSIL.this.global.icodes.TestOp">_</a>, <a href="#758209" title="ch.epfl.lamp.compiler.msil.emit.Label">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> RETURN<a href="#3318489" title="Unit" id="3318549" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700784" title="GenMSIL.this.global.icodes.TypeKind" id="758213">kind</a><span class="delimiter">)</span> =&gt;
            <a href="#3318571" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#751910" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298119" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
            <span class="keyword">else</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a href="#3318485" title="(x: (ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label))(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#60635" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="758218">local</a>, <a href="../../../../Tuple2.scala.html#60637" title="ch.epfl.lamp.compiler.msil.emit.Label" id="758219">label</a><span class="delimiter">)</span> = <a href="#751924" title="(kind: GenMSIL.this.global.icodes.TypeKind)(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)">returnFromHandler</a><a href="../../../../Tuple2.scala.html#783" title="(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label) @unchecked" class="delimiter">(</a><a href="#758213" title="GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758213" title="GenMSIL.this.global.icodes.TypeKind">kind</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../icode/TypeKinds.scala.html#614990" title="GenMSIL.this.global.icodes.UNIT.type">UNIT</a><span class="delimiter">)</span>
                <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc</span>, <a href="#758218" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">local</a><span class="delimiter">)</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#758219" title="ch.epfl.lamp.compiler.msil.emit.Label">label</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> THROW<a href="#3318489" title="Unit" id="3318552" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700813" title="GenMSIL.this.global.icodes.global.Symbol" id="3318550">_</a><span class="delimiter">)</span> =&gt;
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Throw</span><span class="delimiter">)</span>

          <span class="keyword">case</span> DROP<a href="#3318489" title="Unit" id="3318554" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#704127" title="GenMSIL.this.global.icodes.TypeKind" id="758247">kind</a><span class="delimiter">)</span> =&gt;
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Pop</span><span class="delimiter">)</span>

          <span class="keyword">case</span> DUP<a href="#3318489" title="Unit" id="3318556" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703416" title="GenMSIL.this.global.icodes.TypeKind" id="758251">kind</a><span class="delimiter">)</span> =&gt;
            // see comment on `var previousWasNEW`
            <a href="#3318571" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#756195" title="Boolean">previousWasNEW</a><span class="delimiter">)</span>
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Dup</span><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="#756195" title="Boolean">previousWasNEW</a> = <span title="Boolean(false)" class="keyword">false</span>

          <span class="keyword">case</span> MONITOR_ENTER<a href="#3318489" title="Unit" id="3318558" class="delimiter">(</a><span class="delimiter">)</span> =&gt;
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751806" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MMONITOR_ENTER</a><span class="delimiter">)</span>

          <span class="keyword">case</span> MONITOR_EXIT<a href="#3318489" title="Unit" id="3318560" class="delimiter">(</a><span class="delimiter">)</span> =&gt;
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751808" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MMONITOR_EXIT</a><span class="delimiter">)</span>

          <span class="keyword">case</span> SCOPE_ENTER<a href="#3318489" title="Unit" id="3318563" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#705011" title="GenMSIL.this.global.icodes.Local" id="3318561">_</a><span class="delimiter">)</span> | SCOPE_EXIT<a href="#3318489" title="Boolean" id="3318566" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#700843" title="GenMSIL.this.global.icodes.Local" id="3318564">_</a><span class="delimiter">)</span> | LOAD_EXCEPTION<a href="#3318489" title="Boolean" id="3318569" class="delimiter">(</a><a href="../icode/Opcodes.scala.html#703522" title="GenMSIL.this.global.icodes.global.Symbol" id="3318567">_</a><span class="delimiter">)</span> =&gt;
            <a href="#3318571" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

      <span class="delimiter">}</span> // end for (instr &lt;- b) { .. }
    <span class="delimiter">}</span> // end genBlock

    <span class="keyword">def</span> <a title="(primitive: GenMSIL.this.global.icodes.Primitive, pos: GenMSIL.this.global.Position)Unit" id="751929">genPrimitive</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Primitive" id="756903">primitive</a>: <a href="../icode/Primitives.scala.html#615036" title="GenMSIL.this.global.icodes.Primitive">Primitive</a>, <a title="GenMSIL.this.global.Position" id="756904">pos</a>: <a href="../../../../reflect/internal/util/Position.scala.html#22953" title="GenMSIL.this.global.Position">Position</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#756903" title="GenMSIL.this.global.icodes.Primitive">primitive</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Negation<a href="#3318827" title="Unit" id="3318829" class="delimiter">(</a><a href="../icode/Primitives.scala.html#703099" title="GenMSIL.this.global.icodes.TypeKind" id="758267">kind</a><span class="delimiter">)</span> =&gt;
          <a href="#3318848" title="(x: Unit)Unit">kind</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            // CHECK: is ist possible to get this for BOOL? in this case, verify.
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614992" title="Unit" id="3318624">BOOL</a> | <a href="../icode/TypeKinds.scala.html#614994" title="Boolean" id="3318625">BYTE</a> | <a href="../icode/TypeKinds.scala.html#614998" title="Boolean" id="3318626">CHAR</a> | <a href="../icode/TypeKinds.scala.html#614996" title="Boolean" id="3318627">SHORT</a> | <a href="../icode/TypeKinds.scala.html#615000" title="Boolean" id="3318628">INT</a> | <a href="../icode/TypeKinds.scala.html#615002" title="Boolean" id="3318629">LONG</a> | <a href="../icode/TypeKinds.scala.html#615004" title="Boolean" id="3318630">FLOAT</a> | <a href="../icode/TypeKinds.scala.html#615006" title="Boolean" id="3318631">DOUBLE</a> =&gt;
              <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318633" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Neg</span><span class="delimiter">)</span>

            <span class="keyword">case</span> _ =&gt; <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><a href="#3318633" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;Impossible to negate a &quot;)" class="string">&quot;Impossible to negate a &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#758267" title="GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> Arithmetic<a href="#3318827" title="Unit" id="3318831" class="delimiter">(</a><a href="../icode/Primitives.scala.html#703116" title="GenMSIL.this.global.icodes.ArithmeticOp" id="758274">op</a>, <a href="../icode/Primitives.scala.html#703118" title="GenMSIL.this.global.icodes.TypeKind" id="758275">kind</a><span class="delimiter">)</span> =&gt;
          <a href="#3318848" title="(x: Unit)Unit">op</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615090" title="Unit" id="3318680">ADD</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318687" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Add</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615092" title="Unit" id="3318681">SUB</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318687" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Sub</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615094" title="Unit" id="3318682">MUL</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318687" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Mul</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615096" title="Unit" id="3318683">DIV</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318687" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Div</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615098" title="Unit" id="3318684">REM</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318687" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Rem</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615100" title="Unit" id="3318685">NOT</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318687" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Not</span><span class="delimiter">)</span> //bitwise complement (one's complement)
            <span class="keyword">case</span> _ =&gt; <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><a href="#3318687" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;Unknown arithmetic primitive &quot;)" class="string">&quot;Unknown arithmetic primitive &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756903" title="GenMSIL.this.global.icodes.Primitive">primitive</a> <span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> Logical<a href="#3318827" title="Unit" id="3318833" class="delimiter">(</a><a href="../icode/Primitives.scala.html#703177" title="GenMSIL.this.global.icodes.LogicalOp" id="758292">op</a>, <a href="../icode/Primitives.scala.html#703179" title="GenMSIL.this.global.icodes.TypeKind" id="758293">kind</a><span class="delimiter">)</span> =&gt; <a href="#3318848" title="(x: Unit)Unit">op</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615110" title="Unit" id="3318719">AND</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318723" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">And</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615112" title="Unit" id="3318720">OR</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318723" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Or</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615114" title="Unit" id="3318721">XOR</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318723" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Xor</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">case</span> Shift<a href="#3318827" title="Unit" id="3318835" class="delimiter">(</a><a href="../icode/Primitives.scala.html#703202" title="GenMSIL.this.global.icodes.ShiftOp" id="758302">op</a>, <a href="../icode/Primitives.scala.html#703204" title="GenMSIL.this.global.icodes.TypeKind" id="758303">kind</a><span class="delimiter">)</span> =&gt; <a href="#3318848" title="(x: Unit)Unit">op</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615103" title="Unit" id="3318742">LSL</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318746" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Shl</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615105" title="Unit" id="3318743">ASR</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318746" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Shr</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615107" title="Unit" id="3318744">LSR</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318746" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Shr_Un</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">case</span> Conversion<a href="#3318827" title="Unit" id="3318837" class="delimiter">(</a><a href="../icode/Primitives.scala.html#704333" title="GenMSIL.this.global.icodes.TypeKind" id="758312">src</a>, <a href="../icode/Primitives.scala.html#704335" title="GenMSIL.this.global.icodes.TypeKind" id="758313">dst</a><span class="delimiter">)</span> =&gt;
          <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Converting from: &quot;)" class="string">&quot;Converting from: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#758312" title="GenMSIL.this.global.icodes.TypeKind">src</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; to: &quot;)" class="string">&quot; to: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#758313" title="GenMSIL.this.global.icodes.TypeKind">dst</a><span class="delimiter">)</span>

          <a href="#758313" title="GenMSIL.this.global.icodes.TypeKind">dst</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614994" title="Unit" id="3318769">BYTE</a> =&gt;   <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318777" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I1</span><span class="delimiter">)</span> // I1 for System.SByte, i.e. a scala.Byte
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614996" title="Unit" id="3318770">SHORT</a> =&gt;  <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318777" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I2</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614998" title="Unit" id="3318771">CHAR</a> =&gt;   <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318777" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_U2</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615000" title="Unit" id="3318772">INT</a> =&gt;    <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318777" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I4</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615002" title="Unit" id="3318773">LONG</a> =&gt;   <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318777" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I8</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615004" title="Unit" id="3318774">FLOAT</a> =&gt;  <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318777" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_R4</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615006" title="Unit" id="3318775">DOUBLE</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318777" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_R8</span><span class="delimiter">)</span>
            <span class="keyword">case</span> _ =&gt;
              <a href="../../../../Console.scala.html#136" title="Console.type">Console</a>.<a href="../../../../Console.scala.html#63314" title="(x: Any)Unit">println</a><a href="#3318777" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;Illegal conversion at: &quot;)" class="string">&quot;Illegal conversion at: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751856" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a> <span title="(x$1: Any)String">+</span>
                              <span title="String(&quot; at: &quot;)" class="string">&quot; at: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756904" title="GenMSIL.this.global.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409665" title="=&gt; scala.reflect.internal.util.SourceFile">source</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;:&quot;)" class="string">&quot;:&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756904" title="GenMSIL.this.global.Position">pos</a>.<a href="../../../../reflect/internal/util/Position.scala.html#409692" title="=&gt; Int">line</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> ArrayLength<a href="#3318827" title="Unit" id="3318840" class="delimiter">(</a><a href="../icode/Primitives.scala.html#703359" title="GenMSIL.this.global.icodes.TypeKind" id="3318838">_</a><span class="delimiter">)</span> =&gt;
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3318848" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldlen</span><span class="delimiter">)</span>

        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615064" title="Unit" id="3318845">StartConcat</a> =&gt;
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><a href="#3318848" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#751812" title="=&gt; ch.epfl.lamp.compiler.msil.ConstructorInfo">MSTRING_BUILDER_CONSTR</a><span class="delimiter">)</span>


        <span class="keyword">case</span> StringConcat<a href="#3318827" title="Unit" id="3318843" class="delimiter">(</a><a href="../icode/Primitives.scala.html#707189" title="GenMSIL.this.global.icodes.TypeKind" id="758338">el</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="758339">elemType</a> : <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#758338" title="GenMSIL.this.global.icodes.TypeKind">el</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> REFERENCE<a href="#3318809" title="ch.epfl.lamp.compiler.msil.Type" id="3318812" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="GenMSIL.this.global.icodes.global.Symbol" id="3318810">_</a><span class="delimiter">)</span> | ARRAY<a href="#3318809" title="Boolean" id="3318815" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#695807" title="GenMSIL.this.global.icodes.TypeKind" id="3318813">_</a><span class="delimiter">)</span> =&gt; <a href="#3318817" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>
            <span class="keyword">case</span> _ =&gt; <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><a href="#3318817" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><a href="#758338" title="GenMSIL.this.global.icodes.TypeKind">el</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="758340">argTypes</a>:<a href="../../../../Array.scala.html#174" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <a href="../../../../Array.scala.html#72260" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="#758339" title="ch.epfl.lamp.compiler.msil.Type">elemType</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="758341">stringBuilderAppend</a> = <a href="#751810" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_BUILDER</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;Append&quot;)" class="string">&quot;Append&quot;</span>, <a href="#758340" title="Array[ch.epfl.lamp.compiler.msil.Type]">argTypes</a> <span class="delimiter">)</span>
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>,  <a href="#758341" title="ch.epfl.lamp.compiler.msil.MethodInfo">stringBuilderAppend</a><span class="delimiter">)</span>

        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615066" title="Unit" id="3318846">EndConcat</a> =&gt;
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3318848" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#751814" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MSTRING_BUILDER_TOSTRING</a><span class="delimiter">)</span>

        <span class="keyword">case</span> _ =&gt;
          <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><a href="#3318848" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;Unimplemented primitive &quot;)" class="string">&quot;Unimplemented primitive &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756903" title="GenMSIL.this.global.icodes.Primitive">primitive</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> // end genPrimitive


    ////////////////////// loading ///////////////////////

    <span class="keyword">def</span> <a title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit" id="751930">loadI4</a><span class="delimiter">(</span><a title="Int" id="756432">value</a>: <a href="../../../../Int.scala.html#321" title="Int">Int</a>, <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="756433">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span><span class="delimiter">)</span>: <a href="../../../../Unit.scala.html#1515" title="Unit">Unit</a> = <a href="#756432" title="Int">value</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> -<span class="int">1</span> =&gt; <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_M1</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">0</span>  =&gt; <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">1</span>  =&gt; <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_1</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">2</span>  =&gt; <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_2</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">3</span>  =&gt; <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_3</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">4</span>  =&gt; <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_4</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">5</span>  =&gt; <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_5</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">6</span>  =&gt; <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_6</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">7</span>  =&gt; <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_7</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">8</span>  =&gt; <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_8</span><span class="delimiter">)</span>
      <span class="keyword">case</span> _  =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756432" title="Int">value</a> <a href="../../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#756432" title="Int">value</a> <a href="../../../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
          <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_S</span>, <a href="#756432" title="Int">value</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#756433" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4</span>, <a href="#756432" title="Int">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit" id="751931">loadArg</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="756203">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="Boolean" id="756204">loadAddr</a>: <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="Int" id="756205">i</a>: <a href="../../../../Int.scala.html#321" title="Int">Int</a><span class="delimiter">)</span> =
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756204" title="Boolean">loadAddr</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756205" title="Int">i</a> <a href="../../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#756205" title="Int">i</a> <a href="../../../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
          <a href="#756203" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarga_S</span>, <a href="#756205" title="Int">i</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#756203" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarga</span>, <a href="#756205" title="Int">i</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#756205" title="Int">i</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span class="int">0</span> =&gt; <a href="#756203" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">1</span> =&gt; <a href="#756203" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_1</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">2</span> =&gt; <a href="#756203" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_2</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">3</span> =&gt; <a href="#756203" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_3</span><span class="delimiter">)</span>
          <span class="keyword">case</span> _      =&gt;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756205" title="Int">i</a> <a href="../../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#756205" title="Int">i</a> <a href="../../../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
              <a href="#756203" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_S</span>, <a href="#756205" title="Int">i</a><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="#756203" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg</span>, <a href="#756205" title="Int">i</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(i: Int, local: GenMSIL.this.global.icodes.Local, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)Unit" id="751932">loadLocal</a><span class="delimiter">(</span><a title="Int" id="756246">i</a>: <a href="../../../../Int.scala.html#321" title="Int">Int</a>, <a title="GenMSIL.this.global.icodes.Local" id="756247">local</a>: <a href="../icode/Members.scala.html#614928" title="GenMSIL.this.global.icodes.Local">Local</a>, <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="756248">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="Boolean" id="756249">loadAddr</a>: <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> =
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756249" title="Boolean">loadAddr</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756246" title="Int">i</a> <a href="../../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#756246" title="Int">i</a> <a href="../../../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
          <a href="#756248" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloca_S</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#756247" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#756248" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloca</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#756247" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#756246" title="Int">i</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span class="int">0</span> =&gt; <a href="#756248" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_0</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">1</span> =&gt; <a href="#756248" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_1</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">2</span> =&gt; <a href="#756248" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_2</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">3</span> =&gt; <a href="#756248" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_3</span><span class="delimiter">)</span>
          <span class="keyword">case</span> _      =&gt;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#756246" title="Int">i</a> <a href="../../../../Int.scala.html#57132" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#756246" title="Int">i</a> <a href="../../../../Int.scala.html#57118" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
              <a href="#756248" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_S</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#756247" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="#756248" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#756247" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    ////////////////////// branches ///////////////////////

    /** Returns a Triple (Boolean, Boolean, Option[Label])
     *   - whether the jump leaves some exception block (try / catch / finally)
     *   - whether it leaves a finally handler (finally block, but not it's try / catch)
     *   - a label where to jump for leaving the finally handler
     *     . None to leave directly using `endfinally`
     *     . Some(label) to emit `leave label` (for try / catch inside a finally handler)
     */
    <span class="keyword">def</span> <a title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" id="751933">leavesHandler</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="758095">from</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="758096">to</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a><span class="delimiter">)</span>: <a href="../../../../Tuple3.scala.html#126" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a>Boolean, Boolean, Option<span class="delimiter">[</span>Label<span class="delimiter">]</span><span class="delimiter">)</span> =
      <span title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="keyword">if</span> <span class="delimiter">(</span><a href="#751910" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#298119" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../Tuple3.scala.html#63169" title="(_1: Boolean, _2: Boolean, _3: None.type)(Boolean, Boolean, None.type)" class="delimiter">(</a><span title="Boolean(false)" class="keyword">false</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="../../../../Option.scala.html#1585" title="None.type">None</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="758427">h</a> = <a href="#751910" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
        <span class="keyword">val</span> <a title="Boolean" id="758428">leaveHead</a> = <span class="delimiter">{</span> <a href="#758427" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#696230" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#758095" title="GenMSIL.this.global.icodes.BasicBlock">from</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57824" title="(x: Boolean)Boolean">!=</a> <a href="#758427" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#696230" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#758096" title="GenMSIL.this.global.icodes.BasicBlock">to</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a>
                          <a href="#758427" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#696231" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#758095" title="GenMSIL.this.global.icodes.BasicBlock">from</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57824" title="(x: Boolean)Boolean">!=</a> <a href="#758427" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#696231" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#758096" title="GenMSIL.this.global.icodes.BasicBlock">to</a><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="keyword">if</span> <span class="delimiter">(</span><a href="#758428" title="Boolean">leaveHead</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          // we leave the innermost exception block.
          // find out if we also leave som e `finally` handler
          <a href="#751910" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#58567" title="(p: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Boolean)Option[GenMSIL.this.global.icodes.ExceptionHandler]">find</a><a href="#3318932" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="758450">e</a> =&gt; <span class="delimiter">{</span>
            <a href="#758450" title="GenMSIL.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#696209" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">cls</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Symbols.scala.html#407184" title="=&gt; GenMSIL.this.global.NoSymbol">NoSymbol</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#758450" title="GenMSIL.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#696231" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#758095" title="GenMSIL.this.global.icodes.BasicBlock">from</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57824" title="(x: Boolean)Boolean">!=</a> <a href="#758450" title="GenMSIL.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#696231" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#758096" title="GenMSIL.this.global.icodes.BasicBlock">to</a><span class="delimiter">)</span>
          <span class="delimiter">}</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> Some<a href="#3318927" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" id="3318928" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="GenMSIL.this.global.icodes.ExceptionHandler" id="758463">finallyHandler</a><span class="delimiter">)</span> =&gt;
              <a href="#3318932" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="keyword">if</a> <span class="delimiter">(</span><a href="#758427" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#758463" title="GenMSIL.this.global.icodes.ExceptionHandler">finallyHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                // the finally handler is the innermost, so we can emit `endfinally` directly
                <a href="../../../../Tuple3.scala.html#63169" title="(_1: Boolean, _2: Boolean, _3: None.type)(Boolean, Boolean, None.type)" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(true)" class="keyword">true</span>, <a href="../../../../Option.scala.html#1585" title="None.type">None</a><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                // we need to `Leave` to the `endfinally` of the next outer finally handler
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="758477">l</a> = <a href="#751925" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]">endFinallyLabels</a>.<a href="../../../../collection/mutable/MapLike.scala.html#87629" title="(key: GenMSIL.this.global.icodes.ExceptionHandler, op: =&gt; ch.epfl.lamp.compiler.msil.emit.Label)ch.epfl.lamp.compiler.msil.emit.Label">getOrElseUpdate</a><span class="delimiter">(</span><a href="#758463" title="GenMSIL.this.global.icodes.ExceptionHandler">finallyHandler</a>, <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="../../../../Tuple3.scala.html#63169" title="(_1: Boolean, _2: Boolean, _3: Some[ch.epfl.lamp.compiler.msil.emit.Label])(Boolean, Boolean, Some[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(true)" class="keyword">true</span>, <a href="../../../../Option.scala.html#63128" title="(x: ch.epfl.lamp.compiler.msil.emit.Label)Some[ch.epfl.lamp.compiler.msil.emit.Label]">Some</a><span class="delimiter">(</span><a href="#758477" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="keyword">case</span> <a href="../../../../Option.scala.html#1585" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" id="3318930">None</a> =&gt;
              <a href="#3318932" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="../../../../Option.scala.html#1585" title="None.type">None</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <a href="../../../../Tuple3.scala.html#63169" title="(_1: Boolean, _2: Boolean, _3: None.type)(Boolean, Boolean, None.type)" class="delimiter">(</a><span title="Boolean(false)" class="keyword">false</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="../../../../Option.scala.html#1585" title="None.type">None</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(block: GenMSIL.this.global.icodes.BasicBlock, cond: GenMSIL.this.global.icodes.TestOp, success: GenMSIL.this.global.icodes.BasicBlock, failure: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock, emitBrFun: (GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit)Unit" id="751934">emitCondBr</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="758193">block</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.TestOp" id="758194">cond</a>: <a href="../icode/Primitives.scala.html#615076" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="758195">success</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="758196">failure</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>,
                   <a title="GenMSIL.this.global.icodes.BasicBlock" id="758197">next</a>: <a href="../icode/BasicBlocks.scala.html#614938" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="(GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit" id="758198">emitBrFun</a>: <span class="delimiter">(</span>TestOp, Label<span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a href="#3318942" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#60576" title="Boolean" id="758511">sLeaveHandler</a>, <a href="../../../../Tuple3.scala.html#60578" title="Boolean" id="758512">sLeaveFinally</a>, <a href="../../../../Tuple3.scala.html#60580" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="758513">slfTarget</a><span class="delimiter">)</span> = <a href="#751933" title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])">leavesHandler</a><a href="../../../../Tuple3.scala.html#126" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]) @unchecked" class="delimiter">(</a><a href="#758193" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#758195" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a href="#3318948" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#60576" title="Boolean" id="758515">fLeaveHandler</a>, <a href="../../../../Tuple3.scala.html#60578" title="Boolean" id="758516">fLeaveFinally</a>, <a href="../../../../Tuple3.scala.html#60580" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="758517">flfTarget</a><span class="delimiter">)</span> = <a href="#751933" title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])">leavesHandler</a><a href="../../../../Tuple3.scala.html#126" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]) @unchecked" class="delimiter">(</a><a href="#758193" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#758196" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758511" title="Boolean">sLeaveHandler</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#758515" title="Boolean">fLeaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="758550">sLabelOpt</a> = <span title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" class="keyword">if</span> <span class="delimiter">(</span><a href="#758511" title="Boolean">sLeaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="758551">leaveSLabel</a> = <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="../../../../Function2.scala.html#65848" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#758194" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="#758551" title="ch.epfl.lamp.compiler.msil.emit.Label">leaveSLabel</a><span class="delimiter">)</span>
          <a href="../../../../Option.scala.html#63128" title="(x: ch.epfl.lamp.compiler.msil.emit.Label)Some[ch.epfl.lamp.compiler.msil.emit.Label]">Some</a><span class="delimiter">(</span><a href="#758551" title="ch.epfl.lamp.compiler.msil.emit.Label">leaveSLabel</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="../../../../Function2.scala.html#65848" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#758194" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#758195" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../../Option.scala.html#1585" title="None.type">None</a>
        <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758515" title="Boolean">fLeaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758516" title="Boolean">fLeaveFinally</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758517" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">flfTarget</a>.<a href="../../../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#758517" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">flfTarget</a>.<a href="../../../../Option.scala.html#62858" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">get</a><span class="delimiter">)</span>
            <span class="keyword">else</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Endfinally</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#758196" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span>
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#758196" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <a href="#758550" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">sLabelOpt</a>.<a href="../../../../Option.scala.html#62865" title="(f: ch.epfl.lamp.compiler.msil.emit.Label =&gt; Unit)Option[Unit]">map</a><span title="Unit" class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.Label" id="758642">l</a> =&gt; <span class="delimiter">{</span>
          <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="#758642" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758512" title="Boolean">sLeaveFinally</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758513" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">slfTarget</a>.<a href="../../../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#758513" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">slfTarget</a>.<a href="../../../../Option.scala.html#62858" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">get</a><span class="delimiter">)</span>
            <span class="keyword">else</span> <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Endfinally</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#758195" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758197" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#758195" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../../../Function2.scala.html#65848" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#758194" title="GenMSIL.this.global.icodes.TestOp">cond</a>.<a href="../icode/Primitives.scala.html#701156" title="()GenMSIL.this.global.icodes.TestOp">negate</a>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#758196" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="../../../../Function2.scala.html#65848" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#758194" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#758195" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758197" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#758196" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#758196" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(condition: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label, isFloat: Boolean)Unit" id="751935">emitBr</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TestOp" id="758190">condition</a>: <a href="../icode/Primitives.scala.html#615076" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="758191">dest</a>: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span>, <a title="Boolean" id="758192">isFloat</a>: <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#758190" title="GenMSIL.this.global.icodes.TestOp">condition</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615077" title="Unit" id="3318959">EQ</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#3318966" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Beq</span>, <a href="#758191" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615079" title="Unit" id="3318960">NE</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#3318966" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bne_Un</span>, <a href="#758191" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615081" title="Unit" id="3318961">LT</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#3318966" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#758192" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Blt_Un</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Blt</span>, <a href="#758191" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615083" title="Unit" id="3318962">GE</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#3318966" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#758192" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bge_Un</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bge</span>, <a href="#758191" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615085" title="Unit" id="3318963">LE</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#3318966" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#758192" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ble_Un</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ble</span>, <a href="#758191" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615087" title="Unit" id="3318964">GT</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#3318966" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#758192" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bgt_Un</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bgt</span>, <a href="#758191" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(cond: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label)Unit" id="751936">emitBrBool</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TestOp" id="758210">cond</a>: <a href="../icode/Primitives.scala.html#615076" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="758211">dest</a>: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="delimiter">(</span><a href="#758210" title="GenMSIL.this.global.icodes.TestOp">cond</a>: @<a href="../icode/Primitives.scala.html#615076" title="GenMSIL.this.global.icodes.TestOp @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        // EQ -&gt; Brfalse, NE -&gt; Brtrue; this is because we come from
        // a CZJUMP. If the value on the stack is 0 (e.g. a boolean
        // method returned false), and we are in the case EQ, then
        // we need to emit Brfalse (EQ Zero means false). vice versa
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615077" title="Unit" id="3318996">EQ</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#3318999" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Brfalse</span>, <a href="#758211" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#615079" title="Unit" id="3318997">NE</a> =&gt; <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#3318999" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Brtrue</span>, <a href="#758211" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    ////////////////////// local vars ///////////////////////

    /**
     * Compute the indexes of each local variable of the given
     * method.
     */
    <span class="keyword">def</span> <a title="(m: GenMSIL.this.global.icodes.IMethod)Unit" id="751937">computeLocalVarsIndex</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="755436">m</a>: <a href="../icode/Members.scala.html#614927" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="758775">idx</a> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#755436" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411295" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> <span class="keyword">else</span> <span title="Int(1)" class="int">1</span>

      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.Local]" id="758776">params</a> = <a href="#755436" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696024" title="=&gt; List[GenMSIL.this.global.icodes.Local]">params</a>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="758798">l</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.Local =&gt; Unit)Unit">params</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Index value for parameter &quot;)" class="string">&quot;Index value for parameter &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#758798" title="GenMSIL.this.global.icodes.Local">l</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#758775" title="Int">idx</a><span class="delimiter">)</span>
        <a href="#758798" title="GenMSIL.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#696358" title="(x$1: Int)Unit">index</a> = <a href="#758775" title="Int">idx</a>
        <a href="#758775" title="Int">idx</a> <a href="../../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span> // sizeOf(l.kind)
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.Local]" id="758777">locvars</a> = <a href="#755436" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696021" title="=&gt; List[GenMSIL.this.global.icodes.Local]">locals</a> <a href="../../../../collection/TraversableLike.scala.html#58074" title="(p: GenMSIL.this.global.icodes.Local =&gt; Boolean)List[GenMSIL.this.global.icodes.Local]">filterNot</a> <span class="delimiter">(</span><a href="#758776" title="List[GenMSIL.this.global.icodes.Local]">params</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#86380" title="(elem: Any)Boolean">contains</a><span class="delimiter">)</span>
      <a href="#758775" title="Int">idx</a> = <span title="Int(0)" class="int">0</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="758832">l</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.Local =&gt; Unit)Unit">locvars</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Index value for local variable &quot;)" class="string">&quot;Index value for local variable &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#758832" title="GenMSIL.this.global.icodes.Local">l</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#758775" title="Int">idx</a><span class="delimiter">)</span>
        <a href="#758832" title="GenMSIL.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#696358" title="(x$1: Int)Unit">index</a> = <a href="#758775" title="Int">idx</a>
        <a href="#758775" title="Int">idx</a> <a href="../../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span> // sizeOf(l.kind)
      <span class="delimiter">}</span>

    <span class="delimiter">}</span>

    ////////////////////// Utilities ////////////////////////

    /** Return the a name of this symbol that can be used on the .NET
     * platform. It removes spaces from names.
     *
     * Special handling: scala.All and scala.AllRef are 'erased' to
     * scala.All$ and scala.AllRef$. This is needed because they are
     * not real classes, and they mean 'abrupt termination upon evaluation
     * of that expression' or 'null' respectively. This handling is
     * done already in GenICode, but here we need to remove references
     * from method signatures to these types, because such classes can
     * not exist in the classpath: the type checker will be very confused.
     */
    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)String" id="751938">msilName</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="752789">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="758840">suffix</a> = <a href="#752789" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411326" title="=&gt; String">moduleSuffix</a>
      // Flags.JAVA: &quot;symbol was not defined by a scala-class&quot; (java, or .net-class)

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#752789" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408692" title="GenMSIL.this.global.definitions.NothingClass.type">NothingClass</a><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <span title="String(&quot;scala.runtime.Nothing$&quot;)" class="string">&quot;scala.runtime.Nothing$&quot;</span>
      <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#752789" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408694" title="GenMSIL.this.global.definitions.NullClass.type">NullClass</a><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <span title="String(&quot;scala.runtime.Null$&quot;)" class="string">&quot;scala.runtime.Null$&quot;</span>

      <span class="delimiter">(</span><a href="../../../../Predef.scala.html#7605" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd" class="keyword">if</a> <span class="delimiter">(</span><a href="#752789" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402403" title="=&gt; Boolean">isClass</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#752789" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402401" title="=&gt; Boolean">isModule</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#752789" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402398" title="=&gt; Boolean">isMethod</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Object" class="keyword">if</span> <span class="delimiter">(</span><a href="#752789" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411301" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <a href="#752789" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411492" title="=&gt; GenMSIL.this.global.Name">simpleName</a>
        <span class="keyword">else</span> <a href="#752789" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411334" title="=&gt; String">fullName</a>
       <span class="delimiter">}</span> <span class="keyword">else</span>
         <a href="#752789" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411492" title="=&gt; GenMSIL.this.global.Name">simpleName</a>.<span title="()String">toString</span>.<span title="()String">trim</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../runtime/StringAdd.scala.html#60046" title="(other: String)String">+</a> <a href="#758840" title="String">suffix</a>
    <span class="delimiter">}</span>


    ////////////////////// flags ///////////////////////

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Int" id="751939">msilTypeFlags</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="758865">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Int.scala.html#321" title="Int">Int</a> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="758866">mf</a>: <a href="../../../../Int.scala.html#321" title="Int">Int</a> = TypeAttributes.AutoLayout <span title="Int(0)">|</span> TypeAttributes.AnsiClass

      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#758865" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411301" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#758866" title="Int">mf</a> = <a href="#758866" title="Int">mf</a> <a href="../../../../Int.scala.html#57139" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#758865" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#411234" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> TypeAttributes.<span title="Int(3)">NestedPrivate</span> <span class="keyword">else</span> TypeAttributes.<span title="Int(2)">NestedPublic</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#758866" title="Int">mf</a> = <a href="#758866" title="Int">mf</a> <a href="../../../../Int.scala.html#57139" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#758865" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#411234" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> TypeAttributes.<span title="Int(0)">NotPublic</span> <span class="keyword">else</span> TypeAttributes.<span title="Int(1)">Public</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#758866" title="Int">mf</a> = <a href="#758866" title="Int">mf</a> <a href="../../../../Int.scala.html#57139" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#758865" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#411234" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(8L)">ABSTRACT</span><span class="delimiter">)</span> TypeAttributes.<span title="Int(128)">Abstract</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#758866" title="Int">mf</a> = <a href="#758866" title="Int">mf</a> <a href="../../../../Int.scala.html#57139" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#758865" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411185" title="=&gt; Boolean">isTrait</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#758865" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411180" title="=&gt; Boolean">isImplClass</a><span class="delimiter">)</span> TypeAttributes.<span title="Int(32)">Interface</span> <span class="keyword">else</span> TypeAttributes.<span title="Int(0)">Class</span><span class="delimiter">)</span>
      <a href="#758866" title="Int">mf</a> = <a href="#758866" title="Int">mf</a> <a href="../../../../Int.scala.html#57139" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#758865" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/HasFlags.scala.html#409851" title="=&gt; Boolean">isFinal</a><span class="delimiter">)</span> TypeAttributes.<span title="Int(256)">Sealed</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

      <a href="#758865" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411400" title="=&gt; List[GenMSIL.this.global.AnnotationInfo]">annotations</a> <a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; Unit)Unit">foreach</a> <span class="delimiter">{</span> <a title="GenMSIL.this.global.AnnotationInfo" id="758917">a</a> =&gt; <a href="#758917" title="GenMSIL.this.global.AnnotationInfo">a</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/AnnotationInfos.scala.html#411922" title="Option[(GenMSIL.this.global.Type, List[GenMSIL.this.global.Tree], List[(GenMSIL.this.global.Name, GenMSIL.this.global.ClassfileAnnotArg)])]" id="3319024">AnnotationInfo</a><span class="delimiter">(</span><a href="../../../../Tuple3.scala.html#60576" title="GenMSIL.this.global.Type" id="3319017">SerializableAttr</a>, <a href="../../../../Tuple3.scala.html#60578" title="List[GenMSIL.this.global.Tree]" id="3319012">_</a>, <a href="../../../../Tuple3.scala.html#60580" title="List[(GenMSIL.this.global.Name, GenMSIL.this.global.ClassfileAnnotArg)]" id="3319013">_</a><span class="delimiter">)</span> =&gt;
          // TODO: add the Serializable TypeAttribute also if the annotation
          // System.SerializableAttribute is present (.net annotation, not scala)
          //  Best way to do it: compare with
          //  definitions.getClass(&quot;System.SerializableAttribute&quot;).tpe
          //  when frontend available
          <a href="#758866" title="Int">mf</a> = <a href="#758866" title="Int">mf</a> <a href="../../../../Int.scala.html#57139" title="(x: Int)Int">|</a> TypeAttributes.<span title="Int(8192)">Serializable</span>
        <span class="keyword">case</span> _ =&gt; <a href="#3319020" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">}</span>

      <a href="#758866" title="Int">mf</a>
      // static: not possible (or?)
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Short" id="751940">msilMethodFlags</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="758926">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Short.scala.html#810" title="Short">Short</a> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="758927">mf</a>: <a href="../../../../Int.scala.html#321" title="Int">Int</a> = MethodAttributes.<span title="Short(128)">HideBySig</span> <a href="../../../../Short.scala.html#57001" title="(x: Short)Int">|</a>
        <span class="delimiter">(</span><span title="Short" class="keyword">if</span> <span class="delimiter">(</span><a href="#758926" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#411234" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> MethodAttributes.<span title="Short(1)">Private</span>
         <span class="keyword">else</span> MethodAttributes.<span title="Short(6)">Public</span><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#758926" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411200" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758926" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411295" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span>
          <a href="#758927" title="Int">mf</a> = <a href="#758927" title="Int">mf</a> <a href="../../../../Int.scala.html#57137" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(16)">Static</span> // coincidentally, same value as for MethodAttributes.Static ...
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#758927" title="Int">mf</a> = <a href="#758927" title="Int">mf</a> <a href="../../../../Int.scala.html#57137" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(64)">Virtual</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758926" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#409851" title="=&gt; Boolean">isFinal</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#758926" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="()Boolean">IsInterface</span><span class="delimiter">)</span>
            <a href="#758927" title="Int">mf</a> = <a href="#758927" title="Int">mf</a> <a href="../../../../Int.scala.html#57137" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(32)">Final</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758926" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#409850" title="=&gt; Boolean">isDeferred</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#758926" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="()Boolean">IsInterface</span><span class="delimiter">)</span>
            <a href="#758927" title="Int">mf</a> = <a href="#758927" title="Int">mf</a> <a href="../../../../Int.scala.html#57137" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(1024)">Abstract</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758926" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411295" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#758927" title="Int">mf</a> = <a href="#758927" title="Int">mf</a> <a href="../../../../Int.scala.html#57137" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(16)">Static</span>
      <span class="delimiter">}</span>

      // constructors of module classes should be private
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758926" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411287" title="=&gt; Boolean">isPrimaryConstructor</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#751959" title="(sym: GenMSIL.this.global.Symbol)Boolean">isTopLevelModule</a><span class="delimiter">(</span><a href="#758926" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#758927" title="Int">mf</a> <a href="../../../../Int.scala.html#57137" title="(x: Short)Int">|=</a> MethodAttributes.<span title="Short(1)">Private</span>
        <a href="#758927" title="Int">mf</a> <a href="../../../../Int.scala.html#57144" title="(x: Int)Int">&amp;=</a> <a href="../../../../Short.scala.html#56948" title="=&gt; Int">~</a><span class="delimiter">(</span>MethodAttributes.<span title="Short(6)">Public</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#758927" title="Int">mf</a>.<a href="../../../../Int.scala.html#57078" title="=&gt; Short">toShort</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Short" id="751941">msilFieldFlags</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="758964">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Short.scala.html#810" title="Short">Short</a> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="758965">mf</a>: <a href="../../../../Int.scala.html#321" title="Int">Int</a> =
        <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#758964" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#411234" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> FieldAttributes.<span title="Int(1)">Private</span>
        <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#758964" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#411234" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(1L)">PROTECTED</span><span class="delimiter">)</span> FieldAttributes.<span title="Int(5)">FamORAssem</span>
        <span class="keyword">else</span> FieldAttributes.<span title="Int(6)">Public</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758964" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#411234" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(32L)">FINAL</span><span class="delimiter">)</span>
        <a href="#758965" title="Int">mf</a> = <a href="#758965" title="Int">mf</a> <a href="../../../../Int.scala.html#57137" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(32)">InitOnly</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#758964" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411295" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span>
        <a href="#758965" title="Int">mf</a> = <a href="#758965" title="Int">mf</a> <a href="../../../../Int.scala.html#57137" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(16)">Static</span>

      // TRANSIENT: &quot;not serialized&quot;, VOLATILE: doesn't exist on .net
      // TODO: add this annotation also if the class has the custom attribute
      // System.NotSerializedAttribute
      <a href="#758964" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411400" title="=&gt; List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; Unit)Unit">foreach</a><span class="delimiter">(</span> <a title="GenMSIL.this.global.AnnotationInfo" id="758996">a</a> =&gt; <a href="#758996" title="GenMSIL.this.global.AnnotationInfo">a</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/AnnotationInfos.scala.html#411922" title="Option[(GenMSIL.this.global.Type, List[GenMSIL.this.global.Tree], List[(GenMSIL.this.global.Name, GenMSIL.this.global.ClassfileAnnotArg)])]" id="3319046">AnnotationInfo</a><span class="delimiter">(</span><a href="../../../../Tuple3.scala.html#60576" title="GenMSIL.this.global.Type" id="3319039">TransientAtt</a>, <a href="../../../../Tuple3.scala.html#60578" title="List[GenMSIL.this.global.Tree]" id="3319034">_</a>, <a href="../../../../Tuple3.scala.html#60580" title="List[(GenMSIL.this.global.Name, GenMSIL.this.global.ClassfileAnnotArg)]" id="3319035">_</a><span class="delimiter">)</span> =&gt;
          <a href="#758965" title="Int">mf</a> = <a href="#758965" title="Int">mf</a> <a href="../../../../Int.scala.html#57137" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(128)">NotSerialized</span>
        <span class="keyword">case</span> _ =&gt; <a href="#3319042" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>

      <a href="#758965" title="Int">mf</a>.<a href="../../../../Int.scala.html#57078" title="=&gt; Short">toShort</a>
    <span class="delimiter">}</span>

    ////////////////////// builders, types ///////////////////////

    <span class="keyword">var</span> <a title="GenMSIL.this.global.Symbol" id="751943">entryPoint</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a> = _

    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" id="751945">notInitializedModules</a> = mutable.<a href="../../../../collection/generic/GenericCompanion.scala.html#59933" title="[A](elems: A*)scala.collection.mutable.HashSet[A]">HashSet</a><span title="(elems: GenMSIL.this.global.Symbol*)scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" class="delimiter">[</span><a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    // TODO: create fields also in def createType, and not in genClass,
    // add a getField method (it only works as it is because fields never
    // accessed from outside a class)

    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]" id="751947">localBuilders</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#60744" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.Local, ch.epfl.lamp.compiler.msil.emit.LocalBuilder)*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]" class="delimiter">[</span><a href="../icode/Members.scala.html#614928" title="GenMSIL.this.global.icodes.Local">Local</a>, <span title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">LocalBuilder</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">private</span><span class="delimiter">[</span>GenMSIL<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(cls: GenMSIL.this.global.icodes.IClass)Unit" id="751949">findEntryPoint</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="752006">cls</a>: <a href="../icode/Members.scala.html#614923" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="759005">isEntryPoint</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759006">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>:<a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751960" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#759006" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#759006" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;main&quot;)" class="string">&quot;main&quot;</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#759006" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#408431" title="=&gt; List[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../icode/TypeKinds.scala.html#615020" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span title="Unit" class="delimiter">(</span><a href="#759006" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.Type">paramTypes</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> ARRAY<a href="#3319054" title="Unit" id="3319056" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#695807" title="GenMSIL.this.global.icodes.TypeKind" id="759027">elem</a><span class="delimiter">)</span> =&gt;
                <a href="#3319058" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#759027" title="GenMSIL.this.global.icodes.TypeKind">elem</a>.<a href="../icode/TypeKinds.scala.html#694375" title="=&gt; GenMSIL.this.global.icodes.global.Type">toType</a>.<a href="../../../../reflect/internal/Types.scala.html#408407" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408722" title="=&gt; GenMSIL.this.global.ClassSymbol">StringClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <span title="Nothing" class="keyword">return</span> <span title="Boolean(true)" class="keyword">true</span>
                <span class="delimiter">}</span>
              <span class="keyword">case</span> _ =&gt; <a href="#3319058" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#751943" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Global.scala.html#537522" title="GenMSIL.this.global.opt.type">opt</a>.<a href="../../Global.scala.html#545441" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>  // TODO introduce dedicated setting instead
        <span class="keyword">val</span> <a title="String" id="759039">entryclass</a> = <a href="../../Global.scala.html#537522" title="GenMSIL.this.global.opt.type">opt</a>.<a href="../../Global.scala.html#545441" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#62858" title="=&gt; GenMSIL.this.global.Name">get</a>.<span title="()String">toString</span>
        <span class="keyword">val</span> <a title="String" id="759040">cfn</a> = <a href="#752006" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411334" title="=&gt; String">fullName</a>
        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#759040" title="String">cfn</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#759039" title="String">entryclass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="759058">m</a> &lt;- <a href="#752006" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: GenMSIL.this.global.icodes.IMethod =&gt; Unit)Unit">methods</a>; <span class="keyword">if</span> <a href="#759005" title="(sym: GenMSIL.this.global.Symbol)Boolean">isEntryPoint</a><span class="delimiter">(</span><a href="#759058" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#751943" title="(x$1: GenMSIL.this.global.Symbol)Unit">entryPoint</a> = <a href="#759058" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span class="delimiter">}</span>
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#751943" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="../../Global.scala.html#537496" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="String(&quot;Couldn\'t find main method in class &quot;)" class="string">&quot;Couldn't find main method in class &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759040" title="String">cfn</a><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751874" title="=&gt; String">firstSourceName</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#752006" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411483" title="=&gt; scala.reflect.io.AbstractFile">sourceFile</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> // is null for nested classes
          <a href="#751874" title="(x$1: String)Unit">firstSourceName</a> = <a href="#752006" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411483" title="=&gt; scala.reflect.io.AbstractFile">sourceFile</a>.<a href="../../../../reflect/io/AbstractFile.scala.html#404301" title="=&gt; String">name</a>
    <span class="delimiter">}</span>

    // #####################################################################
    // get and create types

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type" id="751950">msilType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="755574">t</a>: <a href="../icode/TypeKinds.scala.html#614984" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <span class="delimiter">(</span><a href="#755574" title="GenMSIL.this.global.icodes.TypeKind">t</a>: @<a href="../icode/TypeKinds.scala.html#614984" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614990" title="ch.epfl.lamp.compiler.msil.Type" id="3319086">UNIT</a>           =&gt; <a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MVOID</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614992" title="ch.epfl.lamp.compiler.msil.Type" id="3319087">BOOL</a>           =&gt; <a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MBOOL</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614994" title="ch.epfl.lamp.compiler.msil.Type" id="3319088">BYTE</a>           =&gt; <a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MBYTE</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614996" title="ch.epfl.lamp.compiler.msil.Type" id="3319089">SHORT</a>          =&gt; <a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MSHORT</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614998" title="ch.epfl.lamp.compiler.msil.Type" id="3319090">CHAR</a>           =&gt; <a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MCHAR</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615000" title="ch.epfl.lamp.compiler.msil.Type" id="3319091">INT</a>            =&gt; <a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MINT</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615002" title="ch.epfl.lamp.compiler.msil.Type" id="3319092">LONG</a>           =&gt; <a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MLONG</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615004" title="ch.epfl.lamp.compiler.msil.Type" id="3319093">FLOAT</a>          =&gt; <a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MFLOAT</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615006" title="ch.epfl.lamp.compiler.msil.Type" id="3319094">DOUBLE</a>         =&gt; <a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MDOUBLE</a>
      <span class="keyword">case</span> REFERENCE<a href="#3319072" title="ch.epfl.lamp.compiler.msil.Type" id="3319083" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="GenMSIL.this.global.icodes.global.Symbol" id="759077">cls</a><span class="delimiter">)</span> =&gt; <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><a href="#759077" title="GenMSIL.this.global.icodes.global.Symbol">cls</a><span class="delimiter">)</span>
      <span class="keyword">case</span> ARRAY<a href="#3319072" title="ch.epfl.lamp.compiler.msil.Type" id="3319085" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#695807" title="GenMSIL.this.global.icodes.TypeKind" id="759079">elem</a><span class="delimiter">)</span>    =&gt;
        <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><a href="#3319096" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><a href="#759079" title="GenMSIL.this.global.icodes.TypeKind">elem</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          // For type builders, cannot call &quot;clrTypes.mkArrayType&quot; because this looks up
          // the type &quot;tp&quot; in the assembly (not in the HashMap &quot;types&quot; of the backend).
          // This can fail for nested types because the builders are not complete yet.
          <span class="keyword">case</span> <a href="#3319063" title="ch.epfl.lamp.compiler.msil.Type" id="3319064">tb</a>: TypeBuilder =&gt; tb.<span title="()ch.epfl.lamp.compiler.msil.Type">MakeArrayType</span><a href="#3319067" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="#3319063" title="ch.epfl.lamp.compiler.msil.Type" id="3319065">tp</a>: MsilType =&gt; <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694115" title="(elemType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">mkArrayType</a><a href="#3319067" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a>tp<span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type" id="751951">msilType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Type" id="755573">tpe</a>: <a href="../../../../reflect/internal/Types.scala.html#407270" title="GenMSIL.this.global.Type">Type</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#615020" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="#755573" title="GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]" id="751952">msilParamTypes</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759094">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Array.scala.html#174" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#759094" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#408431" title="=&gt; List[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../collection/TraversableLike.scala.html#58063" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]])List[ch.epfl.lamp.compiler.msil.Type]">map</a><a href="../../../../collection/immutable/List.scala.html#62442" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]]" class="delimiter">(</a><a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableOnce.scala.html#58259" title="(implicit evidence$1: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">toArray</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type" id="751953">getType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="755334">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#751954" title="(sym: GenMSIL.this.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">getTypeOpt</a><span class="delimiter">(</span><a href="#755334" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<a href="../../../../Option.scala.html#62859" title="(default: =&gt; ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">getOrElse</a><span class="delimiter">(</span><a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><a href="#751986" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#755334" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

    /**
     * Get an MSIL type from a symbol. First look in the clrTypes.types map, then
     * lookup the name using clrTypes.getType
     */
    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]" id="751954">getTypeOpt</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="755335">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#978" title="Option[ch.epfl.lamp.compiler.msil.Type]">Option</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Option[ch.epfl.lamp.compiler.msil.Type]" id="759164">tmp</a> = <a href="../../symtab/clr/CLRTypes.scala.html#694095" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#87525" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">get</a><span class="delimiter">(</span><a href="#755335" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <a href="#759164" title="Option[ch.epfl.lamp.compiler.msil.Type]">tmp</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> typ @ Some<a href="#3319137" title="Option[ch.epfl.lamp.compiler.msil.Type]" id="3319139" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="ch.epfl.lamp.compiler.msil.Type" id="3319138">_</a><span class="delimiter">)</span> =&gt; <a href="#3319143" title="(x: Option[ch.epfl.lamp.compiler.msil.Type])Option[ch.epfl.lamp.compiler.msil.Type]">typ</a>
        <span class="keyword">case</span> <a href="../../../../Option.scala.html#1585" title="Option[ch.epfl.lamp.compiler.msil.Type]" id="3319141">None</a> =&gt;
          <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)String" id="759169">typeString</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759172">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="String" id="759173">s</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#759172" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411301" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <a href="#759169" title="(sym: GenMSIL.this.global.Symbol)String">typeString</a><span class="delimiter">(</span><a href="#759172" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span><span title="String(&quot;+&quot;)" class="string">&quot;+&quot;</span><span title="(x$1: Any)String">+</span> <a href="#759172" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411492" title="=&gt; GenMSIL.this.global.Name">simpleName</a>
                    <span class="keyword">else</span> <a href="#759172" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411334" title="=&gt; String">fullName</a>
            <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#759172" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402404" title="=&gt; Boolean">isModuleClass</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#759172" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411185" title="=&gt; Boolean">isTrait</a><span class="delimiter">)</span> <a href="#759173" title="String">s</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;$&quot;)" class="string">&quot;$&quot;</span> <span class="keyword">else</span> <a href="#759173" title="String">s</a>
          <span class="delimiter">}</span>
          <span class="keyword">val</span> <a title="String" id="759170">name</a> = <a href="#759169" title="(sym: GenMSIL.this.global.Symbol)String">typeString</a><span class="delimiter">(</span><a href="#755335" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="759171">typ</a> = <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694113" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#759170" title="String">name</a><span class="delimiter">)</span>
          <span title="Option[ch.epfl.lamp.compiler.msil.Type]" class="keyword">if</span> <span class="delimiter">(</span><a href="#759171" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
            <a href="../../../../Option.scala.html#1585" title="None.type">None</a>
          <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.Type)Unit">types</a><span class="delimiter">(</span><a href="#755335" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#759171" title="ch.epfl.lamp.compiler.msil.Type">typ</a>
            <a href="../../../../Option.scala.html#63128" title="(x: ch.epfl.lamp.compiler.msil.Type)Some[ch.epfl.lamp.compiler.msil.Type]">Some</a><span class="delimiter">(</span><a href="#759171" title="ch.epfl.lamp.compiler.msil.Type">typ</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit" id="751955">mapType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="752771">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.Type" id="752772">mType</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#752772" title="ch.epfl.lamp.compiler.msil.Type">mType</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <a href="#751986" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#752771" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.Type)Unit">types</a><span class="delimiter">(</span><a href="#752771" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#752772" title="ch.epfl.lamp.compiler.msil.Type">mType</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="751956">createTypeBuilder</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="752107">iclass</a>: <a href="../icode/Members.scala.html#614923" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      /**
       * First look in the clrTypes.types map, if that fails check if it's a class being compiled, otherwise
       * lookup by name (clrTypes.getType calls the static method msil.Type.GetType(fullname)).
       */
      <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type" id="759192">msilTypeFromSym</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759200">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <span class="delimiter">{</span>
        <a href="../../symtab/clr/CLRTypes.scala.html#694095" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#87525" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">get</a><span class="delimiter">(</span><a href="#759200" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<a href="../../../../Option.scala.html#62859" title="(default: =&gt; ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">getOrElse</a> <span class="delimiter">{</span>
          <a href="../icode/ICodes.scala.html#614876" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/mutable/HashMap.scala.html#88246" title="(key: GenMSIL.this.global.icodes.global.Symbol)Option[GenMSIL.this.global.icodes.IClass]">get</a><a href="#3319156" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><a href="#759200" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> Some<a href="#3319151" title="ch.epfl.lamp.compiler.msil.Type" id="3319152" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="GenMSIL.this.global.icodes.IClass" id="759207">iclass</a><span class="delimiter">)</span> =&gt;
	              <a href="#759193" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.emit.TypeBuilder">msilTypeBuilderFromSym</a><a href="#3319156" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><a href="#759200" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../../../../Option.scala.html#1585" title="ch.epfl.lamp.compiler.msil.Type" id="3319154">None</a> =&gt;
              <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><a href="#3319156" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><a href="#759200" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="759193">msilTypeBuilderFromSym</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759208">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span> = <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#694095" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#87536" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#759208" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../collection/MapLike.scala.html#87535" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#759208" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IClass" id="759227">iclass</a> = <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.IClass">classes</a><span class="delimiter">(</span><a href="#759208" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#537498" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#759227" title="GenMSIL.this.global.icodes.IClass">iclass</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
          <a href="#751956" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createTypeBuilder</a><span class="delimiter">(</span><a href="#759227" title="GenMSIL.this.global.icodes.IClass">iclass</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="../../../../collection/MapLike.scala.html#87535" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#759208" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="759194">sym</a> = <a href="#752107" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#694095" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#87536" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../collection/MapLike.scala.html#87535" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span>

      <span class="keyword">def</span> <a title="(s: GenMSIL.this.global.Symbol)Boolean" id="759195">isInterface</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759284">s</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#759284" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411185" title="=&gt; Boolean">isTrait</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#759284" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411180" title="=&gt; Boolean">isImplClass</a>
      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.Type]" id="759196">parents</a>: <a href="../../../../collection/immutable/List.scala.html#11952" title="List[GenMSIL.this.global.Type]">List</a><span class="delimiter">[</span>Type<span class="delimiter">]</span> =
        <span title="List[GenMSIL.this.global.Type]" class="keyword">if</span> <span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411367" title="=&gt; GenMSIL.this.global.icodes.global.Type">info</a>.<a href="../../../../reflect/internal/Types.scala.html#408416" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">parents</a>.<a href="../../../../collection/SeqLike.scala.html#58787" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../collection/immutable/List.scala.html#62451" title="(xs: GenMSIL.this.global.Type*)List[GenMSIL.this.global.Type]">List</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408671" title="=&gt; GenMSIL.this.global.ClassSymbol">ObjectClass</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411559" title="=&gt; GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411367" title="=&gt; GenMSIL.this.global.icodes.global.Type">info</a>.<a href="../../../../reflect/internal/Types.scala.html#408416" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">parents</a>.<a href="../../../../collection/SeqLike.scala.html#58839" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">distinct</a>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="759197">superType</a> : <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <span title="ch.epfl.lamp.compiler.msil.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#759195" title="(s: GenMSIL.this.global.Symbol)Boolean">isInterface</a><span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Null(null)" class="keyword">null</span> <span class="keyword">else</span> <a href="#759192" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">msilTypeFromSym</a><span class="delimiter">(</span><a href="#759196" title="List[GenMSIL.this.global.Type]">parents</a>.<a href="../../../../collection/IterableLike.scala.html#58577" title="=&gt; GenMSIL.this.global.Type">head</a>.<a href="../../../../reflect/internal/Types.scala.html#408407" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>
      <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;super type: &quot;)" class="string">&quot;super type: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.Type">parents</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Types.scala.html#408407" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, msil type: &quot;)" class="string">&quot;, msil type: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759197" title="ch.epfl.lamp.compiler.msil.Type">superType</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="759198">interfaces</a>: <a href="../../../../Array.scala.html#174" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> =
	<a href="#759196" title="List[GenMSIL.this.global.Type]">parents</a>.<a href="../../../../collection/TraversableLike.scala.html#58104" title="=&gt; List[GenMSIL.this.global.Type]">tail</a>.<a href="../../../../collection/TraversableLike.scala.html#58063" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]])List[ch.epfl.lamp.compiler.msil.Type]">map</a><a href="../../../../collection/immutable/List.scala.html#62442" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]]" class="delimiter">(</a><a title="GenMSIL.this.global.Type" id="759326">p</a> =&gt; <a href="#759192" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">msilTypeFromSym</a><span class="delimiter">(</span><a href="#759326" title="GenMSIL.this.global.Type">p</a>.<a href="../../../../reflect/internal/Types.scala.html#408407" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../collection/TraversableOnce.scala.html#58259" title="(implicit evidence$1: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">toArray</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#759196" title="List[GenMSIL.this.global.Type]">parents</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57125" title="(x: Int)Boolean">&gt;</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#537448" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#540057" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#541066" title="=&gt; Boolean">value</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../Global.scala.html#537516" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;interfaces:&quot;)" class="string">&quot;interfaces:&quot;</span><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="759474">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#7395" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#57060" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#81297" title="(f: Int =&gt; Unit)Unit" class="delimiter">(</a><a href="#759198" title="Array[ch.epfl.lamp.compiler.msil.Type]">interfaces</a>.<a href="../../../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../Global.scala.html#537516" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;  type: &quot;)" class="string">&quot;  type: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.Type">parents</a><span class="delimiter">(</span><a href="#759474" title="Int">i</a> <a href="../../../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Types.scala.html#408407" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, msil type: &quot;)" class="string">&quot;, msil type: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../../../Array.scala.html#56639" title="(i: Int)ch.epfl.lamp.compiler.msil.Type">interfaces</a><span class="delimiter">(</span><a href="#759474" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="759199">tBuilder</a> = <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411301" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="759488">ownerT</a> = <a href="#759193" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.emit.TypeBuilder">msilTypeBuilderFromSym</a><span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
        <a href="#759488" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerT</a>.<span title="(name: String, attributes: Int, baseType: ch.epfl.lamp.compiler.msil.Type, interfaces: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineNestedType</span><span class="delimiter">(</span><a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#751939" title="(sym: GenMSIL.this.global.Symbol)Int">msilTypeFlags</a><span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#759197" title="ch.epfl.lamp.compiler.msil.Type">superType</a>, <a href="#759198" title="Array[ch.epfl.lamp.compiler.msil.Type]">interfaces</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#751865" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(typeName: String, attributes: Int, baseType: ch.epfl.lamp.compiler.msil.Type, interfaces: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineType</span><span class="delimiter">(</span><a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#751939" title="(sym: GenMSIL.this.global.Symbol)Int">msilTypeFlags</a><span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#759197" title="ch.epfl.lamp.compiler.msil.Type">superType</a>, <a href="#759198" title="Array[ch.epfl.lamp.compiler.msil.Type]">interfaces</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#751955" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="#759194" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#759199" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> // createTypeBuilder

    <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="751957">createClassMembers</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="752121">iclass</a>: <a href="../icode/Members.scala.html#614923" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="#751958" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createClassMembers0</a><span class="delimiter">(</span><a href="#752121" title="GenMSIL.this.global.icodes.IClass">iclass</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Nothing" id="759492">e</a>: <span title="Throwable">Throwable</span> =&gt;
          java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><a href="#751986" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#752121" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span>
          java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;with methods = &quot;)" class="string">&quot;with methods = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#752121" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615194" title="=&gt; List[GenMSIL.this.global.icodes.IMethod]">methods</a><span class="delimiter">)</span>
          <span title="Nothing" class="keyword">throw</span> <a href="#759492" title="Throwable">e</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="751958">createClassMembers0</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="759491">iclass</a>: <a href="../icode/Members.scala.html#614923" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="759501">mtype</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IField" id="759528">ifield</a> &lt;- <a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.icodes.IField =&gt; Unit)Unit">fields</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="759529">sym</a> = <a href="#759528" title="GenMSIL.this.global.icodes.IField">ifield</a>.<a href="../icode/Members.scala.html#707745" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
        <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Adding field: &quot;)" class="string">&quot;Adding field: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759529" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411334" title="=&gt; String">fullName</a><span class="delimiter">)</span>

        <span class="keyword">var</span> <a title="Short" id="759530">attributes</a> = <a href="#751941" title="(sym: GenMSIL.this.global.Symbol)Short">msilFieldFlags</a><span class="delimiter">(</span><a href="#759529" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.util.PECustomMod" id="759531">fieldTypeWithCustomMods</a> =
          <span title="ch.epfl.lamp.compiler.msil.util.PECustomMod" class="keyword">new</span> <span title="ch.epfl.lamp.compiler.msil.util.PECustomMod">PECustomMod</span><span class="delimiter">(</span><a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#759529" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span>,
                          <a href="#751888" title="(annotations: List[GenMSIL.this.global.AnnotationInfo])Array[ch.epfl.lamp.compiler.msil.CustomModifier]">customModifiers</a><span class="delimiter">(</span><a href="#759529" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411400" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder" id="759532">fBuilder</a> = <a href="#759501" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mtype</a>.<span title="(name: String, fieldTypeWithMods: ch.epfl.lamp.compiler.msil.util.PECustomMod, attrs: Short)ch.epfl.lamp.compiler.msil.emit.FieldBuilder">DefineField</span><span class="delimiter">(</span><a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#759529" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>,
                                         <a href="#759531" title="ch.epfl.lamp.compiler.msil.util.PECustomMod">fieldTypeWithCustomMods</a>,
                                         <a href="#759530" title="Short">attributes</a><span class="delimiter">)</span>
        <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#759529" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#759532" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">fBuilder</a>
        <a href="#751887" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#759532" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">fBuilder</a>, <a href="#759529" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411400" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> // all iclass.fields iterated over

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751960" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Option[GenMSIL.this.global.icodes.IMethod]" id="759548">sc</a> = <a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615207" title="=&gt; Option[GenMSIL.this.global.icodes.IMethod]">lookupStaticCtor</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#759548" title="Option[GenMSIL.this.global.icodes.IMethod]">sc</a>.<a href="../../../../Option.scala.html#62857" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IMethod" id="759549">m</a> = <a href="#759548" title="Option[GenMSIL.this.global.icodes.IMethod]">sc</a>.<a href="../../../../Option.scala.html#62858" title="=&gt; GenMSIL.this.global.icodes.IMethod">get</a>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.BasicBlock" id="759550">oldLastBlock</a> = <a href="#759549" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695994" title="=&gt; GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.BasicBlock" id="759551">lastBlock</a> = <a href="#759549" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695992" title="()GenMSIL.this.global.icodes.BasicBlock">newBlock</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#759550" title="GenMSIL.this.global.icodes.BasicBlock">oldLastBlock</a>.<a href="../icode/BasicBlocks.scala.html#695940" title="(pos: Int, instr: GenMSIL.this.global.icodes.Instruction)Boolean">replaceInstruction</a><span class="delimiter">(</span><a href="#759550" title="GenMSIL.this.global.icodes.BasicBlock">oldLastBlock</a>.<a href="../icode/BasicBlocks.scala.html#695937" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>, <a href="../icode/Opcodes.scala.html#700753" title="(whereto: GenMSIL.this.global.icodes.BasicBlock)GenMSIL.this.global.icodes.opcodes.JUMP">JUMP</a><span class="delimiter">(</span><a href="#759551" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a><span class="delimiter">)</span><span class="delimiter">)</span>
          // call object's private ctor from static ctor
          <a href="#759551" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>.<a href="../icode/BasicBlocks.scala.html#695947" title="(instr: GenMSIL.this.global.icodes.Instruction)Unit">emit</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#705856" title="(method: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.opcodes.CIL_NEWOBJ">CIL_NEWOBJ</a><span class="delimiter">(</span><a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411424" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">primaryConstructor</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#759551" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>.<a href="../icode/BasicBlocks.scala.html#695947" title="(instr: GenMSIL.this.global.icodes.Instruction)Unit">emit</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#704125" title="(typ: GenMSIL.this.global.icodes.TypeKind)GenMSIL.this.global.icodes.opcodes.DROP">DROP</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#615020" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#759551" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a> <a href="../icode/BasicBlocks.scala.html#695947" title="(instr: GenMSIL.this.global.icodes.Instruction)Unit">emit</a> <a href="../icode/Opcodes.scala.html#700782" title="(kind: GenMSIL.this.global.icodes.TypeKind)GenMSIL.this.global.icodes.opcodes.RETURN">RETURN</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#614990" title="GenMSIL.this.global.icodes.UNIT.type">UNIT</a><span class="delimiter">)</span>
          <a href="#759551" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>.<a href="../icode/BasicBlocks.scala.html#695953" title="()Unit">close</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408861" title="=&gt; GenMSIL.this.global.ClassSymbol">ArrayClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a href="#3319164" title="Boolean" id="759606">m</a>: <a href="../icode/Members.scala.html#614927" title="GenMSIL.this.global.icodes.IMethod">IMethod</a> &lt;- <a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: GenMSIL.this.global.icodes.IMethod =&gt; Unit)Unit">methods</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="759607">sym</a> = <a href="#759606" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
        <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Creating MethodBuilder for &quot;)" class="string">&quot;Creating MethodBuilder for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#407114" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411241" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span>
              <a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411334" title="=&gt; String">fullName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="759608">ownerType</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411422" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">enclClass</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
        <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#759501" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mtype</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#759608" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a>, <span title="String(&quot;mtype = &quot;)" class="string">&quot;mtype = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759501" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mtype</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;; ownerType = &quot;)" class="string">&quot;; ownerType = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759608" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a><span class="delimiter">)</span>
        <span class="keyword">var</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="759609">paramTypes</a> = <a href="#751952" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Short" id="759610">attr</a> = <a href="#751940" title="(sym: GenMSIL.this.global.Symbol)Short">msilMethodFlags</a><span class="delimiter">(</span><a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#759606" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#695986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411200" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder" id="759623">constr</a> =
            <a href="#759608" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a>.<span title="(attrs: Short, callingConvention: Short, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">DefineConstructor</span><span class="delimiter">(</span><a href="#759610" title="Short">attr</a>, CallingConventions.<span title="Short(1)">Standard</span>, <a href="#759609" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="759729">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#7395" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#57060" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#81297" title="(f: Int =&gt; ch.epfl.lamp.compiler.msil.emit.ParameterBuilder)Unit" class="delimiter">(</a><a href="#759609" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#759623" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">constr</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#759729" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#759606" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.icodes.Local">params</a><span class="delimiter">(</span><a href="#759729" title="Int">i</a><span class="delimiter">)</span>.<a href="../icode/Members.scala.html#696350" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#751978" title="(sym: GenMSIL.this.global.Symbol, cInfo: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">mapConstructor</a><span class="delimiter">(</span><a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#759623" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">constr</a><span class="delimiter">)</span>
          <a href="#751887" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#759623" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">constr</a>, <a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411400" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="759743">resType</a> = <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#759606" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#696012" title="=&gt; GenMSIL.this.global.icodes.TypeKind">returnType</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="759744">method</a> =
            <a href="#759608" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span><a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#759610" title="Short">attr</a>, <a href="#759743" title="ch.epfl.lamp.compiler.msil.Type">resType</a>, <a href="#759609" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="759849">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#7395" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#57060" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#81297" title="(f: Int =&gt; ch.epfl.lamp.compiler.msil.emit.ParameterBuilder)Unit" class="delimiter">(</a><a href="#759609" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#759744" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#759849" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#759606" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.icodes.Local">params</a><span class="delimiter">(</span><a href="#759849" title="Int">i</a><span class="delimiter">)</span>.<a href="../icode/Members.scala.html#696350" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="../../symtab/clr/CLRTypes.scala.html#694099" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.MethodInfo]">methods</a>.<a href="../../../../collection/MapLike.scala.html#87536" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#751980" title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">mapMethod</a><span class="delimiter">(</span><a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#759744" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a><span class="delimiter">)</span>
          <a href="#751887" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#759744" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a>, <a href="#759607" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411400" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;\t created MethodBuilder &quot;)" class="string">&quot;\t created MethodBuilder &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759744" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="delimiter">}</span> // method builders created for non-array iclass

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751960" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#751962" title="(sym: GenMSIL.this.global.Symbol)Unit">addModuleInstanceField</a><span class="delimiter">(</span><a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>
        <a href="#751945" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">notInitializedModules</a> <a href="../../../../collection/mutable/HashSet.scala.html#125963" title="(elem: GenMSIL.this.global.Symbol)BytecodeGenerator.this.notInitializedModules.type">+=</a> <a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615207" title="=&gt; Option[GenMSIL.this.global.icodes.IMethod]">lookupStaticCtor</a>.<a href="../../../../Option.scala.html#62856" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#751965" title="(sym: GenMSIL.this.global.Symbol)Unit">addStaticInit</a><span class="delimiter">(</span><a href="#759491" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615188" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span> // createClassMembers0

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="751959">isTopLevelModule</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="755396">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> =
      <a href="../../Global.scala.html#537726" title="(op: =&gt; Boolean)Boolean">beforeRefchecks</a> <span class="delimiter">{</span>
        <a href="#755396" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402404" title="=&gt; Boolean">isModuleClass</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755396" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411180" title="=&gt; Boolean">isImplClass</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755396" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411301" title="=&gt; Boolean">isNestedClass</a>
      <span class="delimiter">}</span>

    // if the module is lifted it does not need to be initialized in
    // its static constructor, and the MODULE$ field is not required.
    // the outer class will care about it.
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="751960">isStaticModule</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="756932">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
      // .net inner classes: removed '!sym.hasFlag(Flags.LIFTED)', added
      // 'sym.isStatic'. -&gt; no longer compatible without skipping flatten!
      <a href="#756932" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402404" title="=&gt; Boolean">isModuleClass</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#756932" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411293" title="=&gt; Boolean">isStatic</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#756932" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411180" title="=&gt; Boolean">isImplClass</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="751961">isCloneable</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="755344">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
      <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#755344" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411400" title="=&gt; List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86378" title="(p: GenMSIL.this.global.AnnotationInfo =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span> <a title="GenMSIL.this.global.AnnotationInfo" id="759909">a</a> =&gt; <a href="#759909" title="GenMSIL.this.global.AnnotationInfo">a</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/AnnotationInfos.scala.html#411922" title="Option[(GenMSIL.this.global.Type, List[GenMSIL.this.global.Tree], List[(GenMSIL.this.global.Name, GenMSIL.this.global.ClassfileAnnotArg)])]" id="3319187">AnnotationInfo</a><span class="delimiter">(</span><a href="../../../../Tuple3.scala.html#60576" title="GenMSIL.this.global.Type" id="3319180">CloneableAttr</a>, <a href="../../../../Tuple3.scala.html#60578" title="List[GenMSIL.this.global.Tree]" id="3319175">_</a>, <a href="../../../../Tuple3.scala.html#60580" title="List[(GenMSIL.this.global.Name, GenMSIL.this.global.ClassfileAnnotArg)]" id="3319176">_</a><span class="delimiter">)</span> =&gt; <a href="#3319183" title="(x: Boolean)Boolean" class="keyword">false</a>
        <span class="keyword">case</span> _ =&gt; <a href="#3319183" title="(x: Boolean)Boolean" class="keyword">true</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Unit" id="751962">addModuleInstanceField</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759887">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Adding Module-Instance Field for &quot;)" class="string">&quot;Adding Module-Instance Field for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751986" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#759887" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="759913">tBuilder</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#759887" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder" id="759914">fb</a> = <a href="#759913" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(name: String, fieldType: ch.epfl.lamp.compiler.msil.Type, attrs: Short)ch.epfl.lamp.compiler.msil.emit.FieldBuilder">DefineField</span><span class="delimiter">(</span><a href="#751793" title="=&gt; String">MODULE_INSTANCE_NAME</a>,
                           <a href="#759913" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>,
                           <span class="delimiter">(</span>FieldAttributes.Public <span title="Int(22)">|</span>
                            //FieldAttributes.InitOnly |
                            FieldAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57078" title="=&gt; Short">toShort</a><span class="delimiter">)</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#759887" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#759914" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">fb</a>
    <span class="delimiter">}</span>


    // the symbol may be a object-symbol (module-symbol), or a module-class-symbol
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo" id="751963">getModuleInstanceField</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="753573">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.FieldInfo">FieldInfo</span> = <span class="delimiter">{</span>
      <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#753573" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402401" title="=&gt; Boolean">isModule</a> <a href="../../../../Boolean.scala.html#57825" title="(x: Boolean)Boolean">||</a> <a href="#753573" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402404" title="=&gt; Boolean">isModuleClass</a>, <span title="String(&quot;Expected module: &quot;)" class="string">&quot;Expected module: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751986" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#753573" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>

      // when called by LOAD_MODULE, the corresponding type maybe doesn't
      // exist yet -&gt; make a getType
      <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="759925">moduleClassSym</a> = <span title="GenMSIL.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#753573" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402401" title="=&gt; Boolean">isModule</a><span class="delimiter">)</span> <a href="#753573" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411459" title="=&gt; GenMSIL.this.global.Symbol">moduleClass</a> <span class="keyword">else</span> <a href="#753573" title="GenMSIL.this.global.Symbol">sym</a>

      // TODO: get module field for modules not defined in the
      // source currently compiling (e.g. Console)

      <a href="../../symtab/clr/CLRTypes.scala.html#694101" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.FieldInfo]">fields</a> <a href="../../../../collection/MapLike.scala.html#87525" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.FieldInfo]">get</a> <a href="#759925" title="GenMSIL.this.global.Symbol">moduleClassSym</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#3319195" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="3319196" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="759932">sym</a><span class="delimiter">)</span> =&gt; <a href="#3319200" title="(x: ch.epfl.lamp.compiler.msil.FieldInfo)ch.epfl.lamp.compiler.msil.FieldInfo">sym</a>
        <span class="keyword">case</span> <a href="../../../../Option.scala.html#1585" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="3319198">None</a> =&gt;
          //val mclass = types(moduleClassSym)
          <span class="keyword">val</span> <a title="String" id="759933">nameInMetadata</a> = <a href="#751964" title="(csym: GenMSIL.this.global.Symbol)String">nestingAwareFullClassname</a><span class="delimiter">(</span><a href="#759925" title="GenMSIL.this.global.Symbol">moduleClassSym</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="759934">mClass</a> = <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694113" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#759933" title="String">nameInMetadata</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="759935">mfield</a> = <a href="#759934" title="ch.epfl.lamp.compiler.msil.Type">mClass</a>.<span title="(x$1: String)ch.epfl.lamp.compiler.msil.FieldInfo">GetField</span><span class="delimiter">(</span><span title="String(&quot;MODULE$&quot;)" class="string">&quot;MODULE$&quot;</span><span class="delimiter">)</span>
          <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#759935" title="ch.epfl.lamp.compiler.msil.FieldInfo">mfield</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span>, <span title="String(&quot;module not found &quot;)" class="string">&quot;module not found &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751986" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#759925" title="GenMSIL.this.global.Symbol">moduleClassSym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#759925" title="GenMSIL.this.global.Symbol">moduleClassSym</a><span class="delimiter">)</span> = <a href="#759935" title="ch.epfl.lamp.compiler.msil.FieldInfo">mfield</a>
          <a href="#759935" title="ch.epfl.lamp.compiler.msil.FieldInfo">mfield</a>
      <span class="delimiter">}</span>

      //fields(moduleClassSym)
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(csym: GenMSIL.this.global.Symbol)String" id="751964">nestingAwareFullClassname</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759936">csym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> : <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="759942">suffix</a> = <a href="#759936" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411326" title="=&gt; String">moduleSuffix</a>
      <span class="keyword">val</span> <a title="String" id="759943">res</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#759936" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411301" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span>
        <a href="#751964" title="(csym: GenMSIL.this.global.Symbol)String">nestingAwareFullClassname</a><span class="delimiter">(</span><a href="#759936" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;+&quot;)" class="string">&quot;+&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759936" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411323" title="=&gt; String">encodedName</a>
      <span class="keyword">else</span>
        <a href="#759936" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411334" title="=&gt; String">fullName</a>
      <a href="#759943" title="String">res</a> <span title="(x$1: Any)String">+</span> <a href="#759942" title="String">suffix</a>
    <span class="delimiter">}</span>

    /** Adds a static initializer which creates an instance of the module
     *  class (calls the primary constructor). A special primary constructor
     *  will be generated (notInitializedModules) which stores the new instance
     *  in the MODULE$ field right after the super call.
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Unit" id="751965">addStaticInit</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759897">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="759946">tBuilder</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#759897" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder" id="759947">staticInit</a> = <a href="#759946" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(attrs: Short, callingConvention: Short, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">DefineConstructor</span><span class="delimiter">(</span>
        <span class="delimiter">(</span>MethodAttributes.Static <span title="Int(22)">|</span> MethodAttributes.Public<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57078" title="=&gt; Short">toShort</a>,
        CallingConventions.<span title="Short(1)">Standard</span>,
        <span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="759948">sicode</a> = <a href="#759947" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">staticInit</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="759949">instanceConstructor</a> = <a href="../../../../collection/MapLike.scala.html#87535" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">constructors</a><span class="delimiter">(</span><a href="#759897" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411424" title="=&gt; GenMSIL.this.global.Symbol">primaryConstructor</a><span class="delimiter">)</span>

      // there are no constructor parameters. assuming the constructor takes no parameter
      // is fine: we call (in the static constructor) the constructor of the module class,
      // which takes no arguments - an object definition cannot take constructor arguments.
      <a href="#759948" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">sicode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#759949" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">instanceConstructor</a><span class="delimiter">)</span>
      // the stsfld is done in the instance constructor, just after the super call.
      <a href="#759948" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">sicode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Pop</span><span class="delimiter">)</span>

      <a href="#759948" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">sicode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Unit" id="751966">generateMirrorClass</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="755402">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="759977">tBuilder</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#755402" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#755402" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/api/Symbols.scala.html#402404" title="=&gt; Boolean">isModuleClass</a>, <span title="String(&quot;Can\'t generate Mirror-Class for the Non-Module class &quot;)" class="string">&quot;Can't generate Mirror-Class for the Non-Module class &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755402" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Dumping mirror class for object: &quot;)" class="string">&quot;Dumping mirror class for object: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755402" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="String" id="759978">moduleName</a> = <a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#755402" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="String" id="759979">mirrorName</a> = <a href="#759978" title="String">moduleName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#759978" title="String">moduleName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../../Int.scala.html#57161" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="759980">mirrorTypeBuilder</a> = <a href="#751865" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(typeName: String, attributes: Int, baseType: ch.epfl.lamp.compiler.msil.Type, interfaces: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineType</span><span class="delimiter">(</span><a href="#759979" title="String">mirrorName</a>,
                                                 TypeAttributes.Class |
                                                 TypeAttributes.Public <span title="Int(257)">|</span>
                                                 TypeAttributes.Sealed,
                                                 <a href="../../symtab/clr/CLRTypes.scala.html#694068" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>,
                                                 <span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IClass" id="759981">iclass</a> = <a href="../../../../collection/mutable/HashMap.scala.html#88245" title="(key: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.IClass">classes</a><span class="delimiter">(</span><a href="#755402" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="760035">m</a> &lt;- <a href="#755402" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#58171" title="(f: GenMSIL.this.global.Symbol =&gt; Unit)Unit">nonPrivateMembers</a>
           <span class="keyword">if</span> <a href="#760035" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../../reflect/internal/Definitions.scala.html#407777" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#408671" title="=&gt; GenMSIL.this.global.ClassSymbol">ObjectClass</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#760035" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#409866" title="=&gt; Boolean">isProtected</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
           <a href="#760035" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/api/Symbols.scala.html#402398" title="=&gt; Boolean">isMethod</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#760035" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411200" title="=&gt; Boolean">isClassConstructor</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#760035" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411295" title="=&gt; Boolean">isStaticMember</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#760035" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#409848" title="=&gt; Boolean">isCase</a> <a href="../../../../Boolean.scala.html#57826" title="(x: Boolean)Boolean">&amp;&amp;</a>
           <a href="../../../../Boolean.scala.html#57822" title="=&gt; Boolean">!</a><a href="#760035" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#409850" title="=&gt; Boolean">isDeferred</a><span class="delimiter">)</span>
        <span class="delimiter">{</span>
          <a href="../../Global.scala.html#537517" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;   Mirroring method: &quot;)" class="string">&quot;   Mirroring method: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#760035" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="760036">paramTypes</a> = <a href="#751952" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#760035" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Array[String]" id="760037">paramNames</a>: <a href="../../../../Array.scala.html#174" title="Array[String]">Array</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="Array[String]" class="keyword">new</span> <a href="../../../../Array.scala.html#174" title="Array[String]">Array</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">(</span><a href="#760036" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="760141">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#7395" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a> <a href="../../../../collection/immutable/Range.scala.html#81297" title="(f: Int =&gt; Unit)Unit">until</a> <a href="#760036" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span>
            <a href="../../../../Array.scala.html#56640" title="(i: Int, x: String)Unit">paramNames</a><span class="delimiter">(</span><a href="#760141" title="Int">i</a><span class="delimiter">)</span> = <span title="String(&quot;x_&quot;)" class="string">&quot;x_&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#760141" title="Int">i</a>

          // CHECK: verify if getMethodName is better than msilName
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="760038">mirrorMethod</a> = <a href="#759980" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span><a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#760035" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>,
                                                            <span class="delimiter">(</span>MethodAttributes.Public <span title="Int(22)">|</span>
                                                            MethodAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57078" title="=&gt; Short">toShort</a>,
                                                            <a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#760035" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#408423" title="=&gt; GenMSIL.this.global.Type">resultType</a><span class="delimiter">)</span>,
                                                            <a href="#760036" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>

          <span class="keyword">var</span> <a title="Int" id="760039">i</a> = <span title="Int(0)" class="int">0</span>
          <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#760039" title="Int">i</a> <a href="../../../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="#760036" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span> <a href="#760042" title="()Unit" class="delimiter">{</a>
            <a href="#760038" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mirrorMethod</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#760039" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <a href="../../../../Array.scala.html#56639" title="(i: Int)String">paramNames</a><span class="delimiter">(</span><a href="#760039" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#760039" title="Int">i</a> <a href="../../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
          <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="760040">mirrorCode</a> = <a href="#760038" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mirrorMethod</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#760040" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#751963" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#755402" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="760041">mInfo</a> = <a href="#751979" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#760035" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="760270">paramidx</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#7395" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#57060" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#81297" title="(f: Int =&gt; Unit)Unit" class="delimiter">(</a><a href="#760036" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.ParameterInfo]" id="760271">mInfoParams</a> = <a href="#760041" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a>.<span title="()Array[ch.epfl.lamp.compiler.msil.ParameterInfo]">GetParameters</span>
            <span class="keyword">val</span> <a title="Boolean" id="760272">loadAddr</a> = <a href="../../../../Array.scala.html#56639" title="(i: Int)ch.epfl.lamp.compiler.msil.ParameterInfo">mInfoParams</a><span class="delimiter">(</span><a href="#760270" title="Int">paramidx</a><span class="delimiter">)</span>.<span title="ch.epfl.lamp.compiler.msil.Type">ParameterType</span>.<span title="()Boolean">IsByRef</span>
            <a href="#751931" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit">loadArg</a><span class="delimiter">(</span><a href="#760040" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>, <a href="#760272" title="Boolean">loadAddr</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#760270" title="Int">paramidx</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <a href="#760040" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#751979" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#760035" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#760040" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

      <a href="#751886" title="(sym: GenMSIL.this.global.Symbol, tBuilder: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit">addSymtabAttribute</a><span class="delimiter">(</span><a href="#755402" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411432" title="=&gt; GenMSIL.this.global.Symbol">sourceModule</a>, <a href="#759980" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a><span class="delimiter">)</span>

      <a href="#759980" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a>.<span title="()ch.epfl.lamp.compiler.msil.Type">CreateType</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#759980" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a>.<span title="(sourceFilepath: String)Unit">setSourceFilepath</span><span class="delimiter">(</span><a href="#759981" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#615197" title="=&gt; GenMSIL.this.global.icodes.global.CompilationUnit">cunit</a>.<a href="../../CompilationUnits.scala.html#539270" title="=&gt; scala.reflect.internal.util.SourceFile">source</a>.<a href="../../../../reflect/internal/util/SourceFile.scala.html#403754" title="=&gt; scala.reflect.io.AbstractFile">file</a>.<a href="../../../../reflect/io/AbstractFile.scala.html#404302" title="=&gt; String">path</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>


    // #####################################################################
    // delegate callers

    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="751968">delegateCallers</a>: <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span> = _
    <span class="keyword">var</span> <a title="Int" id="751971">nbDelegateCallers</a>: <a href="../../../../Int.scala.html#321" title="Int">Int</a> = <span title="Int(0)" class="int">0</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="751973">initDelegateCallers</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#751968" title="(x$1: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit">delegateCallers</a> = <a href="#751865" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(typeName: String, attributes: Int)ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineType</span><span class="delimiter">(</span><span title="String(&quot;$DelegateCallers&quot;)" class="string">&quot;$DelegateCallers&quot;</span>, TypeAttributes.Public <span title="Int(257)">|</span>
                                          TypeAttributes.Sealed<span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(functionType: GenMSIL.this.global.Type, delegateType: GenMSIL.this.global.Type)Unit" id="751974">createDelegateCaller</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Type" id="757048">functionType</a>: <a href="../../../../reflect/internal/Types.scala.html#407270" title="GenMSIL.this.global.Type">Type</a>, <a title="GenMSIL.this.global.Type" id="757049">delegateType</a>: <a href="../../../../reflect/internal/Types.scala.html#407270" title="GenMSIL.this.global.Type">Type</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#751968" title="=&gt; ch.epfl.lamp.compiler.msil.emit.TypeBuilder">delegateCallers</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
        <a href="#751973" title="()Unit">initDelegateCallers</a><span class="delimiter">(</span><span class="delimiter">)</span>
      // create a field an store the function-object
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="757050">mFunctionType</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757048" title="GenMSIL.this.global.Type">functionType</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder" id="757051">anonfunField</a>: <span title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">FieldBuilder</span> = <a href="#751968" title="=&gt; ch.epfl.lamp.compiler.msil.emit.TypeBuilder">delegateCallers</a>.<span title="(name: String, fieldType: ch.epfl.lamp.compiler.msil.Type, attrs: Short)ch.epfl.lamp.compiler.msil.emit.FieldBuilder">DefineField</span><span class="delimiter">(</span>
        <span title="String(&quot;$anonfunField$$&quot;)" class="string">&quot;$anonfunField$$&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751971" title="=&gt; Int">nbDelegateCallers</a>, <a href="#757050" title="ch.epfl.lamp.compiler.msil.Type">mFunctionType</a>,
        <span class="delimiter">(</span>FieldAttributes.InitOnly | FieldAttributes.Public <span title="Int(54)">|</span> FieldAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57078" title="=&gt; Short">toShort</a><span class="delimiter">)</span>
      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stsfld</span>, <a href="#757051" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">anonfunField</a><span class="delimiter">)</span>


      // create the static caller method and the delegate object
      <span class="keyword">val</span> <a href="#3319219" title="(x: (List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type))(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#60635" title="List[GenMSIL.this.global.Symbol]" id="757053">params</a>, <a href="../../../../Tuple2.scala.html#60637" title="GenMSIL.this.global.Type" id="757054">returnType</a><span class="delimiter">)</span> = <a href="#757049" title="GenMSIL.this.global.Type">delegateType</a>.<a href="../../../../reflect/internal/Types.scala.html#408451" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414263" title="=&gt; GenMSIL.this.global.nme.NameType">apply</a><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a> <a href="../../../../Tuple2.scala.html#783" title="(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type) @unchecked" class="keyword">match</a> <span class="delimiter">{</span>
        <span class="keyword">case</span> MethodType<a href="#3319208" title="(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" id="3319210" class="delimiter">(</a><a href="../../../../reflect/internal/Types.scala.html#410769" title="List[GenMSIL.this.global.Symbol]" id="757144">delParams</a>, <a href="../../../../reflect/internal/Types.scala.html#410771" title="GenMSIL.this.global.Type" id="757145">delReturn</a><span class="delimiter">)</span> =&gt; <a href="#3319212" title="(x: (List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type))(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" class="delimiter">(</a><a href="#757144" title="List[GenMSIL.this.global.Symbol]">delParams</a>, <a href="#757145" title="GenMSIL.this.global.Type">delReturn</a><span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt; <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><a href="#3319212" title="(x: (List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type))(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" class="delimiter">(</a><span title="String(&quot;not a delegate type: &quot;)" class="string">&quot;not a delegate type: &quot;</span>  <span title="(x$1: Any)String">+</span> <a href="#757049" title="GenMSIL.this.global.Type">delegateType</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="757055">caller</a>: <span title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">MethodBuilder</span> = <a href="#751968" title="=&gt; ch.epfl.lamp.compiler.msil.emit.TypeBuilder">delegateCallers</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span>
        <span title="String(&quot;$delegateCaller$$&quot;)" class="string">&quot;$delegateCaller$$&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751971" title="=&gt; Int">nbDelegateCallers</a>,
        <span class="delimiter">(</span>MethodAttributes.Final | MethodAttributes.Public <span title="Int(54)">|</span> MethodAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57078" title="=&gt; Short">toShort</a>,
        <a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757054" title="GenMSIL.this.global.Type">returnType</a><span class="delimiter">)</span>, <span class="delimiter">(</span><a href="#757053" title="List[GenMSIL.this.global.Symbol]">params</a> <a href="../../../../collection/TraversableLike.scala.html#58063" title="(f: GenMSIL.this.global.Symbol =&gt; GenMSIL.this.global.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Symbol],GenMSIL.this.global.Type,List[GenMSIL.this.global.Type]])List[GenMSIL.this.global.Type]">map</a> <span class="delimiter">(</span><a href="#757199" title="GenMSIL.this.global.Symbol">_</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../collection/TraversableLike.scala.html#58063" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]])List[ch.epfl.lamp.compiler.msil.Type]">map</a><a href="../../../../collection/immutable/List.scala.html#62442" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]]" class="delimiter">(</a><a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableOnce.scala.html#58259" title="(implicit evidence$1: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">toArray</a><span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="757436">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#7395" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a> <a href="../../../../collection/immutable/Range.scala.html#81297" title="(f: Int =&gt; ch.epfl.lamp.compiler.msil.emit.ParameterBuilder)Unit">until</a> <a href="#757053" title="List[GenMSIL.this.global.Symbol]">params</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a><span class="delimiter">)</span>
        <a href="#757055" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">caller</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#757436" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <span title="String(&quot;arg&quot;)" class="string">&quot;arg&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#757436" title="Int">i</a><span class="delimiter">)</span> // FIXME: use name of parameter symbol
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="757056">delegCtor</a> = <a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757049" title="GenMSIL.this.global.Type">delegateType</a><span class="delimiter">)</span>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><a href="../../../../Array.scala.html#72260" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#81051" title="(runtimeClass1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#694068" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>, <a href="#751818" title="=&gt; ch.epfl.lamp.compiler.msil.Type">INT_PTR</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldftn</span>, <a href="#757055" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">caller</a><span class="delimiter">)</span>
      <a href="#751868" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#757056" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">delegCtor</a><span class="delimiter">)</span>


      // create the static caller method body
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="757057">functionApply</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#751979" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#757048" title="GenMSIL.this.global.Type">functionType</a>.<a href="../../../../reflect/internal/Types.scala.html#408451" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#407871" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#414263" title="=&gt; GenMSIL.this.global.nme.NameType">apply</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="757058">dcode</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span> = <a href="#757055" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">caller</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#757058" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#757051" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">anonfunField</a><span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="757593">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#7395" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a> <a href="../../../../collection/immutable/Range.scala.html#81297" title="(f: Int =&gt; Unit)Unit">until</a> <a href="#757053" title="List[GenMSIL.this.global.Symbol]">params</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#751931" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit">loadArg</a><span class="delimiter">(</span><a href="#757058" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>, <span title="Boolean(false)" class="keyword">false</span> /* TODO confirm whether passing actual as-is to formal is correct wrt the ByRef attribute of the param */<span class="delimiter">)</span><span class="delimiter">(</span><a href="#757593" title="Int">i</a><span class="delimiter">)</span>
        <a href="#751975" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitBox</a><span class="delimiter">(</span><a href="#757058" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>, <a href="../icode/TypeKinds.scala.html#615020" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.Symbol">params</a><span class="delimiter">(</span><a href="#757593" title="Int">i</a><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#757058" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#757057" title="ch.epfl.lamp.compiler.msil.MethodInfo">functionApply</a><span class="delimiter">)</span>
      <a href="#751976" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitUnbox</a><span class="delimiter">(</span><a href="#757058" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>, <a href="../icode/TypeKinds.scala.html#615020" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="#757054" title="GenMSIL.this.global.Type">returnType</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#757058" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>

      <a href="#751971" title="(x$1: Int)Unit">nbDelegateCallers</a> = <a href="#751971" title="=&gt; Int">nbDelegateCallers</a> <a href="../../../../Int.scala.html#57154" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>

    <span class="delimiter">}</span> //def createDelegateCaller

    <span class="keyword">def</span> <a title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit" id="751975">emitBox</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="757594">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="GenMSIL.this.global.icodes.TypeKind" id="757595">boxType</a>: <a href="../icode/TypeKinds.scala.html#614984" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#757595" title="GenMSIL.this.global.icodes.TypeKind">boxType</a>: @<a href="../icode/TypeKinds.scala.html#614984" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      // doesn't make sense, unit as parameter..
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614990" title="Unit" id="3319241">UNIT</a>   =&gt; <a href="#757594" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><a href="#3319251" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#751844" title="=&gt; ch.epfl.lamp.compiler.msil.FieldInfo">boxedUnit</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614992" title="Unit" id="3319242">BOOL</a> | <a href="../icode/TypeKinds.scala.html#614994" title="Boolean" id="3319243">BYTE</a> | <a href="../icode/TypeKinds.scala.html#614996" title="Boolean" id="3319244">SHORT</a> | <a href="../icode/TypeKinds.scala.html#614998" title="Boolean" id="3319245">CHAR</a> | <a href="../icode/TypeKinds.scala.html#615000" title="Boolean" id="3319246">INT</a> | <a href="../icode/TypeKinds.scala.html#615002" title="Boolean" id="3319247">LONG</a> | <a href="../icode/TypeKinds.scala.html#615004" title="Boolean" id="3319248">FLOAT</a> | <a href="../icode/TypeKinds.scala.html#615006" title="Boolean" id="3319249">DOUBLE</a> =&gt;
        <a href="#757594" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><a href="#3319251" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Box</span>, <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757595" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> REFERENCE<a href="#3319223" title="Unit" id="3319234" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="GenMSIL.this.global.icodes.global.Symbol" id="757612">cls</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694111" title="(cls: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">isValueType</a><span class="delimiter">(</span><a href="#757612" title="GenMSIL.this.global.icodes.global.Symbol">cls</a><span class="delimiter">)</span> =&gt;
        <a href="#757594" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><a href="#3319251" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Box</span>, <span class="delimiter">(</span><a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757595" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> REFERENCE<a href="#3319223" title="Unit" id="3319237" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="GenMSIL.this.global.icodes.global.Symbol" id="3319235">_</a><span class="delimiter">)</span> | ARRAY<a href="#3319223" title="Boolean" id="3319240" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#695807" title="GenMSIL.this.global.icodes.TypeKind" id="3319238">_</a><span class="delimiter">)</span> =&gt;
        <a href="../../Global.scala.html#537496" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="String(&quot;Tried to BOX a non-valuetype.&quot;)" class="string">&quot;Tried to BOX a non-valuetype.&quot;</span><span class="delimiter">)</span>
        <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit" id="751976">emitUnbox</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="757640">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="GenMSIL.this.global.icodes.TypeKind" id="757641">boxType</a>: <a href="../icode/TypeKinds.scala.html#614984" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#757641" title="GenMSIL.this.global.icodes.TypeKind">boxType</a>: @<a href="../icode/TypeKinds.scala.html#614984" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614990" title="Unit" id="3319319">UNIT</a>   =&gt; <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#3319329" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Pop</span><span class="delimiter">)</span>
      /* (1) it's essential to keep the code emitted here (as of now plain calls to System.Convert.ToBlaBla methods)
             behaviorally.equiv.wrt. BoxesRunTime.unboxToBlaBla methods
             (case null: that's easy, case boxed: track changes to unboxBlaBla)
         (2) See also: asInstanceOf to cast from Any to number,
             tracked in http://lampsvn.epfl.ch/trac/scala/ticket/4437  */
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614992" title="Unit" id="3319320">BOOL</a>   =&gt; <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3319329" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751828" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toBool</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614994" title="Unit" id="3319321">BYTE</a>   =&gt; <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3319329" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751830" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toSByte</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614996" title="Unit" id="3319322">SHORT</a>  =&gt; <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3319329" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751832" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toShort</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#614998" title="Unit" id="3319323">CHAR</a>   =&gt; <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3319329" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751834" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toChar</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615000" title="Unit" id="3319324">INT</a>    =&gt; <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3319329" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751836" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toInt</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615002" title="Unit" id="3319325">LONG</a>   =&gt; <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3319329" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751838" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toLong</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615004" title="Unit" id="3319326">FLOAT</a>  =&gt; <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3319329" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751840" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toFloat</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#615006" title="Unit" id="3319327">DOUBLE</a> =&gt; <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#3319329" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#751842" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toDouble</a><span class="delimiter">)</span>
      <span class="keyword">case</span> REFERENCE<a href="#3319301" title="Unit" id="3319312" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="GenMSIL.this.global.icodes.global.Symbol" id="757678">cls</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../symtab/SymbolLoaders.scala.html#620828" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#694111" title="(cls: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">isValueType</a><span class="delimiter">(</span><a href="#757678" title="GenMSIL.this.global.icodes.global.Symbol">cls</a><span class="delimiter">)</span> =&gt;
        <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Unbox</span>, <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757641" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#757640" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldobj</span>, <a href="#751950" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757641" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> REFERENCE<a href="#3319301" title="Unit" id="3319315" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#694622" title="GenMSIL.this.global.icodes.global.Symbol" id="3319313">_</a><span class="delimiter">)</span> | ARRAY<a href="#3319301" title="Boolean" id="3319318" class="delimiter">(</a><a href="../icode/TypeKinds.scala.html#695807" title="GenMSIL.this.global.icodes.TypeKind" id="3319316">_</a><span class="delimiter">)</span> =&gt;
        <a href="../../Global.scala.html#537496" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="String(&quot;Tried to UNBOX a non-valuetype.&quot;)" class="string">&quot;Tried to UNBOX a non-valuetype.&quot;</span><span class="delimiter">)</span>
        <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    // #####################################################################
    // get and create methods / constructors

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo" id="751977">getConstructor</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="756760">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span> = <a href="../../symtab/clr/CLRTypes.scala.html#694097" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.ConstructorInfo]">constructors</a>.<a href="../../../../collection/MapLike.scala.html#87525" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.ConstructorInfo]">get</a><a href="#3319380" title="(x: ch.epfl.lamp.compiler.msil.ConstructorInfo)ch.epfl.lamp.compiler.msil.ConstructorInfo" class="delimiter">(</a><a href="#756760" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<a href="#3319375" title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="3319376" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="760285">constr</a><span class="delimiter">)</span> =&gt; <a href="#3319380" title="(x: ch.epfl.lamp.compiler.msil.ConstructorInfo)ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a>
      <span class="keyword">case</span> <a href="../../../../Option.scala.html#1585" title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="3319378">None</a> =&gt;
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="760286">mClass</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#756760" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="760287">constr</a> = <a href="#760286" title="ch.epfl.lamp.compiler.msil.Type">mClass</a>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><a href="#751952" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#756760" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo" class="keyword">if</span> <span class="delimiter">(</span><a href="#760287" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;Cannot find constructor &quot;)" class="string">&quot;Cannot find constructor &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756760" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756760" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411087" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span>
          java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;scope = &quot;)" class="string">&quot;scope = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#756760" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#408442" title="=&gt; GenMSIL.this.global.Scope">decls</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><a href="#756760" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411334" title="=&gt; String">fullName</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#751978" title="(sym: GenMSIL.this.global.Symbol, cInfo: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">mapConstructor</a><span class="delimiter">(</span><a href="#756760" title="GenMSIL.this.global.Symbol">sym</a>, <a href="#760287" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a><span class="delimiter">)</span>
          <a href="#760287" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, cInfo: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit" id="751978">mapConstructor</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759739">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="759740">cInfo</a>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">constructors</a><span class="delimiter">(</span><a href="#759739" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#759740" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">cInfo</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo" id="751979">getMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="757488">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <span class="delimiter">{</span>

        <a href="../../symtab/clr/CLRTypes.scala.html#694099" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.MethodInfo]">methods</a>.<a href="../../../../collection/MapLike.scala.html#87525" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.MethodInfo]">get</a><a href="#3319393" title="(x: ch.epfl.lamp.compiler.msil.MethodInfo)ch.epfl.lamp.compiler.msil.MethodInfo" class="delimiter">(</a><a href="#757488" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#3319388" title="ch.epfl.lamp.compiler.msil.MethodInfo" id="3319389" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="ch.epfl.lamp.compiler.msil.MethodInfo" id="760303">method</a><span class="delimiter">)</span> =&gt; <a href="#3319393" title="(x: ch.epfl.lamp.compiler.msil.MethodInfo)ch.epfl.lamp.compiler.msil.MethodInfo">method</a>
        <span class="keyword">case</span> <a href="../../../../Option.scala.html#1585" title="ch.epfl.lamp.compiler.msil.MethodInfo" id="3319391">None</a> =&gt;
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="760304">mClass</a> = <a href="#751953" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#757488" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>
          <span class="keyword">try</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="760305">method</a> = <a href="#760304" title="ch.epfl.lamp.compiler.msil.Type">mClass</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type], x$3: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#757488" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#751952" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#757488" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>,
                                          <a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#757488" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#408423" title="=&gt; GenMSIL.this.global.Type">resultType</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="ch.epfl.lamp.compiler.msil.MethodInfo" class="keyword">if</span> <span class="delimiter">(</span><a href="#760305" title="ch.epfl.lamp.compiler.msil.MethodInfo">method</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;Cannot find method &quot;)" class="string">&quot;Cannot find method &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#757488" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751938" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#757488" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;scope = &quot;)" class="string">&quot;scope = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#757488" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#408442" title="=&gt; GenMSIL.this.global.Scope">decls</a><span class="delimiter">)</span>
              <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><a href="#757488" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411334" title="=&gt; String">fullName</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#751980" title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">mapMethod</a><span class="delimiter">(</span><a href="#757488" title="GenMSIL.this.global.Symbol">sym</a>, <a href="#760305" title="ch.epfl.lamp.compiler.msil.MethodInfo">method</a><span class="delimiter">)</span>
              <a href="#760305" title="ch.epfl.lamp.compiler.msil.MethodInfo">method</a>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
          <span class="keyword">catch</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Nothing" id="760334">e</a>: <span title="Exception">Exception</span> =&gt;
              <a href="../../../../Console.scala.html#136" title="Console.type">Console</a>.<a href="../../../../Console.scala.html#63314" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;While looking up &quot;)" class="string">&quot;While looking up &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#760304" title="ch.epfl.lamp.compiler.msil.Type">mClass</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#757488" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411504" title="=&gt; String">nameString</a><span class="delimiter">)</span>
            <a href="../../../../Console.scala.html#136" title="Console.type">Console</a>.<a href="../../../../Console.scala.html#63314" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;\t&quot;)" class="string">&quot;\t&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#751986" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#757488" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="Nothing" class="keyword">throw</span> <a href="#760334" title="Exception">e</a>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /*
     * add a mapping between sym and mInfo
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit" id="751980">mapMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759884">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="759885">mInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a> <span class="delimiter">(</span><a href="#759885" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <a href="#759885" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a><span class="delimiter">)</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#87611" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">methods</a><span class="delimiter">(</span><a href="#759884" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#759885" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a>
    <span class="delimiter">}</span>

    /*
     * add mapping between sym and method with newName, paramTypes of newClass
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit" id="751981">mapMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="759880">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.Type" id="759881">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="759882">newName</a>: <span title="String">String</span>, <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="759883">paramTypes</a>: <a href="../../../../Array.scala.html#174" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="760348">methodInfo</a> = <a href="#759881" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><a href="#759882" title="String">newName</a>, <a href="#759883" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>
      <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#760348" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <span title="String(&quot;Can\'t find mapping for &quot;)" class="string">&quot;Can't find mapping for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759880" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span> <span title="(x$1: Any)String">+</span>
             <a href="#759882" title="String">newName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759883" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
      <a href="#751980" title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">mapMethod</a><span class="delimiter">(</span><a href="#759880" title="GenMSIL.this.global.Symbol">sym</a>, <a href="#760348" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#760348" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="()Boolean">IsStatic</span><span class="delimiter">)</span>
        <a href="#751852" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">dynToStatMapped</a> <a href="../../../../collection/mutable/HashSet.scala.html#125963" title="(elem: GenMSIL.this.global.Symbol)BytecodeGenerator.this.dynToStatMapped.type">+=</a> <a href="#759880" title="GenMSIL.this.global.Symbol">sym</a>
    <span class="delimiter">}</span>

    /*
     * add mapping between method with name and paramTypes of clazz to
     * method with newName and newParamTypes of newClass (used for instance
     * for &quot;wait&quot;)
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type], newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, newParamTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit" id="751982">mapMethod</a><span class="delimiter">(</span>
      <a title="GenMSIL.this.global.Symbol" id="759874">clazz</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="759875">name</a>: <a href="../../../../reflect/internal/Names.scala.html#406868" title="GenMSIL.this.global.Name">Name</a>, <a title="Array[GenMSIL.this.global.Type]" id="759876">paramTypes</a>: <a href="../../../../Array.scala.html#174" title="Array[GenMSIL.this.global.Type]">Array</a><span class="delimiter">[</span>Type<span class="delimiter">]</span>,
      <a title="ch.epfl.lamp.compiler.msil.Type" id="759877">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="759878">newName</a>: <span title="String">String</span>, <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="759879">newParamTypes</a>: <a href="../../../../Array.scala.html#174" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="760371">methodSym</a> = <a href="#751985" title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type])GenMSIL.this.global.Symbol">lookupMethod</a><span class="delimiter">(</span><a href="#759874" title="GenMSIL.this.global.Symbol">clazz</a>, <a href="#759875" title="GenMSIL.this.global.Name">name</a>, <a href="#759876" title="Array[GenMSIL.this.global.Type]">paramTypes</a><span class="delimiter">)</span>
        <a href="../../Global.scala.html#537497" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#760371" title="GenMSIL.this.global.Symbol">methodSym</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <span title="String(&quot;cannot find method &quot;)" class="string">&quot;cannot find method &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759875" title="GenMSIL.this.global.Name">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)String">+</span>
               <a href="#759876" title="Array[GenMSIL.this.global.Type]">paramTypes</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; in class &quot;)" class="string">&quot; in class &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759874" title="GenMSIL.this.global.Symbol">clazz</a><span class="delimiter">)</span>
        <a href="#751981" title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><span class="delimiter">(</span><a href="#760371" title="GenMSIL.this.global.Symbol">methodSym</a>, <a href="#759877" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#759878" title="String">newName</a>, <a href="#759879" title="Array[ch.epfl.lamp.compiler.msil.Type]">newParamTypes</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    /*
     * add mapping for member with name and paramTypes to member
     * newName of newClass (same parameters)
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type], newClass: ch.epfl.lamp.compiler.msil.Type, newName: String)Unit" id="751983">mapMethod</a><span class="delimiter">(</span>
      <a title="GenMSIL.this.global.Symbol" id="759869">clazz</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="759870">name</a>: <a href="../../../../reflect/internal/Names.scala.html#406868" title="GenMSIL.this.global.Name">Name</a>, <a title="Array[GenMSIL.this.global.Type]" id="759871">paramTypes</a>: <a href="../../../../Array.scala.html#174" title="Array[GenMSIL.this.global.Type]">Array</a><span class="delimiter">[</span>Type<span class="delimiter">]</span>,
      <a title="ch.epfl.lamp.compiler.msil.Type" id="759872">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="759873">newName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#751982" title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type], newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, newParamTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><span class="delimiter">(</span><a href="#759869" title="GenMSIL.this.global.Symbol">clazz</a>, <a href="#759870" title="GenMSIL.this.global.Name">name</a>, <a href="#759871" title="Array[GenMSIL.this.global.Type]">paramTypes</a>, <a href="#759872" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#759873" title="String">newName</a>, <a href="../../../../Predef.scala.html#7555" title="(xs: Array[GenMSIL.this.global.Type])scala.collection.mutable.ArrayOps[GenMSIL.this.global.Type]">paramTypes</a> <a href="../../../../collection/TraversableLike.scala.html#58063" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[Array[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,Array[ch.epfl.lamp.compiler.msil.Type]])Array[ch.epfl.lamp.compiler.msil.Type]">map</a> <a href="#751951" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    /*
     * add mapping for all methods with name of clazz to the corresponding
     * method (same parameters) with newName of newClass
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String)Unit" id="751984">mapMethod</a><span class="delimiter">(</span>
      <a title="GenMSIL.this.global.Symbol" id="759865">clazz</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="759866">name</a>: <a href="../../../../reflect/internal/Names.scala.html#406868" title="GenMSIL.this.global.Name">Name</a>,
      <a title="ch.epfl.lamp.compiler.msil.Type" id="759867">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="759868">newName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="760803">memberSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a> = <a href="#759865" title="GenMSIL.this.global.Symbol">clazz</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#408451" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="#759866" title="GenMSIL.this.global.Name">name</a><span class="delimiter">)</span>
        <a href="#760803" title="GenMSIL.this.global.Symbol">memberSym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          // alternatives: List[Symbol]
          <span class="keyword">case</span> OverloadedType<a href="#3319401" title="Unit" id="3319404" class="delimiter">(</a><a href="../../../../reflect/internal/Types.scala.html#450705" title="GenMSIL.this.global.Type" id="3319402">_</a>, <a href="../../../../reflect/internal/Types.scala.html#450707" title="List[GenMSIL.this.global.Symbol]" id="760810">alternatives</a><span class="delimiter">)</span> =&gt;
            <a href="#760810" title="List[GenMSIL.this.global.Symbol]">alternatives</a>.<a href="../../../../collection/immutable/List.scala.html#62719" title="(f: GenMSIL.this.global.Symbol =&gt; Unit)Unit">foreach</a><a href="#3319408" title="(x: Unit)Unit" class="delimiter">(</a><a title="GenMSIL.this.global.Symbol" id="760831">s</a> =&gt; <a href="#751981" title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><span class="delimiter">(</span><a href="#760831" title="GenMSIL.this.global.Symbol">s</a>, <a href="#759867" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#759868" title="String">newName</a>, <a href="#751952" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#760831" title="GenMSIL.this.global.Symbol">s</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

          // paramTypes: List[Type], resType: Type
          <span class="keyword">case</span> MethodType<a href="#3319401" title="Unit" id="3319406" class="delimiter">(</a><a href="../../../../reflect/internal/Types.scala.html#410769" title="List[GenMSIL.this.global.Symbol]" id="760841">params</a>, <a href="../../../../reflect/internal/Types.scala.html#410771" title="GenMSIL.this.global.Type" id="760842">resType</a><span class="delimiter">)</span> =&gt;
            <a href="#751981" title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><a href="#3319408" title="(x: Unit)Unit" class="delimiter">(</a><a href="#760803" title="GenMSIL.this.global.Symbol">memberSym</a>, <a href="#759867" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#759868" title="String">newName</a>, <a href="#751952" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#760803" title="GenMSIL.this.global.Symbol">memberSym</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> _ =&gt;
            <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><a href="#3319408" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;member not found: &quot;)" class="string">&quot;member not found: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759865" title="GenMSIL.this.global.Symbol">clazz</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#759866" title="GenMSIL.this.global.Name">name</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>


    /*
     * find the method in clazz with name and paramTypes
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type])GenMSIL.this.global.Symbol" id="751985">lookupMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="760372">clazz</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="760373">name</a>: <a href="../../../../reflect/internal/Names.scala.html#406868" title="GenMSIL.this.global.Name">Name</a>, <a title="Array[GenMSIL.this.global.Type]" id="760374">paramTypes</a>: <a href="../../../../Array.scala.html#174" title="Array[GenMSIL.this.global.Type]">Array</a><span class="delimiter">[</span>Type<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="760851">memberSym</a> = <a href="#760372" title="GenMSIL.this.global.Symbol">clazz</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#408451" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="#760373" title="GenMSIL.this.global.Name">name</a><span class="delimiter">)</span>
      <a href="#760851" title="GenMSIL.this.global.Symbol">memberSym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> OverloadedType<a href="#3319427" title="GenMSIL.this.global.Symbol" id="3319430" class="delimiter">(</a><a href="../../../../reflect/internal/Types.scala.html#450705" title="GenMSIL.this.global.Type" id="3319428">_</a>, <a href="../../../../reflect/internal/Types.scala.html#450707" title="List[GenMSIL.this.global.Symbol]" id="760858">alternatives</a><span class="delimiter">)</span> =&gt;
          <a href="#760858" title="List[GenMSIL.this.global.Symbol]">alternatives</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86381" title="(p: GenMSIL.this.global.Symbol =&gt; Boolean)Option[GenMSIL.this.global.Symbol]">find</a><a href="#3319436" title="(x: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol" class="delimiter">(</a><a title="GenMSIL.this.global.Symbol" id="760865">s</a> =&gt; <span class="delimiter">{</span>
            <span class="keyword">var</span> <a title="Int" id="760866">i</a>: <a href="../../../../Int.scala.html#321" title="Int">Int</a> = <span title="Int(0)" class="int">0</span>
            <span class="keyword">var</span> <a title="Boolean" id="760867">typesOK</a>: <a href="../../../../Boolean.scala.html#1425" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#760374" title="Array[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#56638" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57097" title="(x: Int)Boolean">==</a> <a href="#760865" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#408431" title="=&gt; List[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86373" title="=&gt; Int">length</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span title="Unit" class="keyword">while</span><span class="delimiter">(</span><a href="#760866" title="Int">i</a> <a href="../../../../Int.scala.html#57111" title="(x: Int)Boolean">&lt;</a> <a href="#760374" title="Array[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#56638" title="=&gt; Int">length</a><span class="delimiter">)</span> <a href="#760874" title="()Unit" class="delimiter">{</a>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Array.scala.html#56639" title="(i: Int)GenMSIL.this.global.Type">paramTypes</a><span class="delimiter">(</span><a href="#760866" title="Int">i</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#760865" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411365" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#86374" title="(n: Int)GenMSIL.this.global.Type">paramTypes</a><span class="delimiter">(</span><a href="#760866" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
                  <a href="#760867" title="Boolean">typesOK</a> = <span title="Boolean(false)" class="keyword">false</span>
                <a href="#760866" title="Int">i</a> <a href="../../../../Int.scala.html#57154" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#760867" title="Boolean">typesOK</a> = <span title="Boolean(false)" class="keyword">false</span>
            <span class="delimiter">}</span>
            <a href="#760867" title="Boolean">typesOK</a>
          <span class="delimiter">}</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> Some<a href="#3319414" title="GenMSIL.this.global.Symbol" id="3319415" class="delimiter">(</a><a href="../../../../Option.scala.html#63132" title="GenMSIL.this.global.Symbol" id="760899">sym</a><span class="delimiter">)</span> =&gt; <a href="#3319419" title="(x: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol">sym</a>
            <span class="keyword">case</span> <a href="../../../../Option.scala.html#1585" title="GenMSIL.this.global.Symbol" id="3319417">None</a> =&gt; <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><a href="#3319419" title="(x: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol" class="delimiter">(</a><span title="String(&quot;member of &quot;)" class="string">&quot;member of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#760372" title="GenMSIL.this.global.Symbol">clazz</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#760373" title="GenMSIL.this.global.Name">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)String">+</span>
                               <a href="#760374" title="Array[GenMSIL.this.global.Type]">paramTypes</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;) not found&quot;)" class="string">&quot;) not found&quot;</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> MethodType<a href="#3319427" title="GenMSIL.this.global.Symbol" id="3319434" class="delimiter">(</a><a href="../../../../reflect/internal/Types.scala.html#410769" title="List[GenMSIL.this.global.Symbol]" id="3319431">_</a>, <a href="../../../../reflect/internal/Types.scala.html#410771" title="GenMSIL.this.global.Type" id="3319432">_</a><span class="delimiter">)</span> =&gt; <a href="#3319436" title="(x: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol">memberSym</a>

        <span class="keyword">case</span> _ =&gt; <a href="../../Global.scala.html#537501" title="(msg: String)Nothing">abort</a><a href="#3319436" title="(x: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol" class="delimiter">(</a><span title="String(&quot;member not found: &quot;)" class="string">&quot;member not found: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#760373" title="GenMSIL.this.global.Name">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; of &quot;)" class="string">&quot; of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#760372" title="GenMSIL.this.global.Symbol">clazz</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)String" id="751986">showsym</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="755342">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#407146" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">(</span><a href="#755342" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411507" title="()String">toString</a> <span title="(x$1: Any)String">+</span>
      <span title="String(&quot;\n  symbol = &quot;)" class="string">&quot;\n  symbol = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#407114" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#755342" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411241" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755342" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span>
      <span title="String(&quot;\n  owner  = &quot;)" class="string">&quot;\n  owner  = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#55820" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#407114" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#755342" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411241" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#755342" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#411315" title="=&gt; GenMSIL.this.global.Symbol">owner</a>
    <span class="delimiter">)</span>

  <span class="delimiter">}</span> // class BytecodeGenerator

<span title="Object" class="delimiter">}</span> // class GenMSIL

        </pre>
    </body>
</html>
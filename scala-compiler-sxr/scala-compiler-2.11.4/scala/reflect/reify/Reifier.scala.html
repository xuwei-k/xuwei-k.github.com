<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scala/reflect/reify/Reifier.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
package scala.reflect.reify

import scala.tools.nsc.Global
import scala.reflect.macros.ReificationException
import scala.reflect.macros.UnexpectedReificationException
import scala.reflect.reify.utils.Utils

<span class="comment">/** Given a tree or a type, generate a tree that when executed at runtime produces the original tree or type.
 *  See more info in the comments to `reify` in scala.reflect.api.Universe.
 *
 *  @author   Martin Odersky
 *  @version  2.10
 *  @since    2.10
 */</span>
abstract class <a title="class Reifier extends AnyRef with scala.reflect.reify.States with scala.reflect.reify.Phases with scala.reflect.reify.Errors with scala.reflect.reify.utils.Utils" id="scala.reflect.reify;Reifier">Reifier</a> extends <a href="States.scala.html#scala.reflect.reify;States" title="scala.reflect.reify.States">States</a>
                          with <a href="Phases.scala.html#scala.reflect.reify;Phases" title="scala.reflect.reify.Phases">Phases</a>
                          with <a href="Errors.scala.html#scala.reflect.reify;Errors" title="scala.reflect.reify.Errors">Errors</a>
                          with <a href="utils/Utils.scala.html#scala.reflect.reify.utils;Utils" title="scala.reflect.reify.utils.Utils">Utils</a> <span class="delimiter">{</span>

  val <a title="=&gt; scala.tools.nsc.Global" id="scala.reflect.reify;Reifier.global">global</a>: <a href="../../tools/nsc/Global.scala.html#scala.tools.nsc;Global" title="scala.tools.nsc.Global">Global</a>
  import <a href="#scala.reflect.reify;Reifier.global" title="=&gt; scala.tools.nsc.Global">global</a>._
  import <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions.definitions" title="Reifier.this.global.definitions.type">definitions</a>._
  private val <a title="Reifier.this.global.definitions.RunDefinitions" id="scala.reflect.reify;Reifier.runDefinitions">runDefinitions</a> = <a href="../../tools/nsc/Global.scala.html#scala.tools.nsc;Global.currentRun" title="=&gt; Reifier.this.global.Run">currentRun</a>.<a href="../../tools/nsc/Global.scala.html#scala.tools.nsc;Global;Run.runDefinitions" title="=&gt; Reifier.this.global.definitions.RunDefinitions">runDefinitions</a>
  import <a href="#scala.reflect.reify;Reifier.runDefinitions" title="=&gt; Reifier.this.global.definitions.RunDefinitions">runDefinitions</a>._

  val <a title="=&gt; Reifier.this.global.analyzer.Typer" id="scala.reflect.reify;Reifier.typer">typer</a>: global.analyzer.<a href="../../tools/nsc/typechecker/Typers.scala.html#scala.tools.nsc.typechecker;Typers;Typer" title="Reifier.this.global.analyzer.Typer">Typer</a>
  val <a title="=&gt; Reifier.this.global.Tree" id="scala.reflect.reify;Reifier.universe">universe</a>: <a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="Reifier.this.global.Tree">Tree</a>
  val <a title="=&gt; Reifier.this.global.Tree" id="scala.reflect.reify;Reifier.mirror">mirror</a>: <a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="Reifier.this.global.Tree">Tree</a>
  val <a title="=&gt; Any" id="scala.reflect.reify;Reifier.reifee">reifee</a>: <span title="Any">Any</span>
  val <a title="=&gt; Boolean" id="scala.reflect.reify;Reifier.concrete">concrete</a>: <a href="../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a>

  <span class="comment">// needed to seamlessly integrate with standalone utils</span>
  override def <a title="=&gt; scala.reflect.reify.Reifier{val global: Reifier.this.global.type}" id="scala.reflect.reify;Reifier.getReifier">getReifier</a>: <a href="#scala.reflect.reify;Reifier;<refinement>" title="&lt;refinement of scala.reflect.reify.Reifier&gt; extends scala.reflect.reify.Reifier">Reifier</a> <span class="delimiter">{</span> val global: Reifier.this.global.type <span class="delimiter">}</span> =
    this.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="&lt;refinement of scala.reflect.reify.Reifier&gt; extends scala.reflect.reify.Reifier" class="delimiter">[</span><a href="#scala.reflect.reify;Reifier;<refinement>" title="&lt;refinement of scala.reflect.reify.Reifier&gt; extends scala.reflect.reify.Reifier">Reifier</a> <span class="delimiter">{</span> val global: Reifier.this.global.type <span class="delimiter">}</span><span class="delimiter">]</span>
  override def <a title="=&gt; Boolean" id="scala.reflect.reify;Reifier.hasReifier">hasReifier</a> = true

  <span class="comment">/** For `reifee` and other reification parameters, generate a tree of the form
   *  {{{
   *    {
   *      val \$u: universe.type = &lt;[ universe ]&gt;
   *      val \$m: \$u.Mirror = &lt;[ mirror ]&gt;
   *      \$u.Expr[T](rtree)       // if data is a Tree
   *      \$u.TypeTag[T](rtree)    // if data is a Type
   *    }
   *  }}}
   *
   *  where
   *
   *    - `universe` is the tree that represents the universe the result will be bound to.
   *    - `mirror` is the tree that represents the mirror the result will be initially bound to.
   *    - `rtree` is code that generates `reifee` at runtime.
   *    - `T` is the type that corresponds to `data`.
   *
   *  This is not a method, but a value to indicate the fact that Reifier instances are a one-off.
   */</span>
  lazy val <a title="Reifier.this.global.Tree" id="scala.reflect.reify;Reifier.reification">reification</a>: <a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="Reifier.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.universe" title="=&gt; Reifier.this.global.Tree">universe</a> <a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.exists" title="(p: Reifier.this.global.Tree =&gt; Boolean)Boolean">exists</a> <span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.$anonfun.x$1" title="Reifier.this.global.Tree">_</a>.<a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.isErroneous" title="=&gt; Boolean">isErroneous</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="Errors.scala.html#scala.reflect.reify;Errors.CannotReifyErroneousPrefix" title="(prefix: Reifier.this.global.Tree)Nothing">CannotReifyErroneousPrefix</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.universe" title="=&gt; Reifier.this.global.Tree">universe</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.universe" title="=&gt; Reifier.this.global.Tree">universe</a>.<a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; Reifier.this.global.Type">tpe</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span> <a href="Errors.scala.html#scala.reflect.reify;Errors.CannotReifyUntypedPrefix" title="(prefix: Reifier.this.global.Tree)Nothing">CannotReifyUntypedPrefix</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.universe" title="=&gt; Reifier.this.global.Tree">universe</a><span class="delimiter">)</span>

      val <a title="Reifier.this.global.Tree" id="scala.reflect.reify;Reifier.reification.result">result</a> = <a href="#scala.reflect.reify;Reifier.reifee" title="=&gt; Any">reifee</a> match <span class="delimiter">{</span>
        case <a title="Reifier.this.global.Tree" id="scala.reflect.reify;Reifier.reification.result.tree">tree</a>: <a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="Reifier.this.global.Tree">Tree</a> =&gt;
          <a href="../../tools/nsc/util/SimpleTracer.scala.html#scala.tools.nsc.util;SimpleTracer.apply" title="(msg: =&gt; String)(value: String)String">reifyTrace</a><span class="delimiter">(</span><span title="String(&quot;reifying = &quot;)" class="string">&quot;reifying = &quot;</span><span class="delimiter">)</span><span class="delimiter">(</span>if <span class="delimiter">(</span><a href="../../tools/nsc/Global.scala.html#scala.tools.nsc;Global.settings" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../internal/settings/MutableSettings.scala.html#scala.reflect.internal.settings.MutableSettings.reflectSettingToBoolean" title="implicit scala.reflect.internal.settings.MutableSettings.reflectSettingToBoolean : (s: scala.reflect.internal.settings.MutableSettings#BooleanSetting)Boolean">Xshowtrees</a> <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="../../tools/nsc/Global.scala.html#scala.tools.nsc;Global.settings" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../internal/settings/MutableSettings.scala.html#scala.reflect.internal.settings.MutableSettings.reflectSettingToBoolean" title="implicit scala.reflect.internal.settings.MutableSettings.reflectSettingToBoolean : (s: scala.reflect.internal.settings.MutableSettings#BooleanSetting)Boolean">XshowtreesCompact</a> <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="../../tools/nsc/Global.scala.html#scala.tools.nsc;Global.settings" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../internal/settings/MutableSettings.scala.html#scala.reflect.internal.settings.MutableSettings.reflectSettingToBoolean" title="implicit scala.reflect.internal.settings.MutableSettings.reflectSettingToBoolean : (s: scala.reflect.internal.settings.MutableSettings#BooleanSetting)Boolean">XshowtreesStringified</a><span class="delimiter">)</span> <span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../tools/nsc/Global.scala.html#scala.tools.nsc;Global.nodePrinters" title="Reifier.this.global.nodePrinters.type">nodePrinters</a>.<a href="../../Function1.scala.html#scala;Function1.apply" title="(v1: Reifier.this.global.nodePrinters.global.Tree)String">nodeToString</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.result.tree" title="Reifier.this.global.Tree">tree</a><span class="delimiter">)</span>.<span title="()String">trim</span> else <a href="#scala.reflect.reify;Reifier.reification.result.tree" title="Reifier.this.global.Tree">tree</a>.<a href="../api/Trees.scala.html#scala.reflect.api;Trees;TreeApi.toString" title="()String">toString</a><span class="delimiter">)</span>
          <a href="../../tools/nsc/util/SimpleTracer.scala.html#scala.tools.nsc.util;SimpleTracer.apply" title="(msg: =&gt; String)(value: Reifier.this.global.Position)Reifier.this.global.Position">reifyTrace</a><span class="delimiter">(</span><span title="String(&quot;reifee is located at: &quot;)" class="string">&quot;reifee is located at: &quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.result.tree" title="Reifier.this.global.Tree">tree</a>.<a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; Reifier.this.global.Position">pos</a><span class="delimiter">)</span>
          <a href="../../tools/nsc/util/SimpleTracer.scala.html#scala.tools.nsc.util;SimpleTracer.apply" title="(msg: =&gt; String)(value: Reifier.this.global.Tree)Reifier.this.global.Tree">reifyTrace</a><span class="delimiter">(</span><span title="String(&quot;universe = &quot;)" class="string">&quot;universe = &quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.universe" title="=&gt; Reifier.this.global.Tree">universe</a><span class="delimiter">)</span>
          <a href="../../tools/nsc/util/SimpleTracer.scala.html#scala.tools.nsc.util;SimpleTracer.apply" title="(msg: =&gt; String)(value: Reifier.this.global.Tree)Reifier.this.global.Tree">reifyTrace</a><span class="delimiter">(</span><span title="String(&quot;mirror = &quot;)" class="string">&quot;mirror = &quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.mirror" title="=&gt; Reifier.this.global.Tree">mirror</a><span class="delimiter">)</span>
          if <span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.result.tree" title="Reifier.this.global.Tree">tree</a> <a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.exists" title="(p: Reifier.this.global.Tree =&gt; Boolean)Boolean">exists</a> <span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.result.$anonfun.x$2" title="Reifier.this.global.Tree">_</a>.<a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.isErroneous" title="=&gt; Boolean">isErroneous</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="Errors.scala.html#scala.reflect.reify;Errors.CannotReifyErroneousReifee" title="(reifee: Any)Nothing">CannotReifyErroneousReifee</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.result.tree" title="Reifier.this.global.Tree">tree</a><span class="delimiter">)</span>
          if <span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.result.tree" title="Reifier.this.global.Tree">tree</a>.<a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; Reifier.this.global.Type">tpe</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span> <a href="Errors.scala.html#scala.reflect.reify;Errors.CannotReifyUntypedReifee" title="(reifee: Any)Nothing">CannotReifyUntypedReifee</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.result.tree" title="Reifier.this.global.Tree">tree</a><span class="delimiter">)</span>
          val <a title="Reifier.this.global.Tree =&gt; Reifier.this.global.Tree" id="scala.reflect.reify;Reifier.reification.result.pipeline">pipeline</a> = <a href="Phases.scala.html#scala.reflect.reify;Phases.mkReificationPipeline" title="=&gt; Reifier.this.global.Tree =&gt; Reifier.this.global.Tree">mkReificationPipeline</a>
          val <span title="Reifier.this.global.Tree">rtree</span> = <a href="../../Function1.scala.html#scala;Function1.apply" title="(v1: Reifier.this.global.Tree)Reifier.this.global.Tree">pipeline</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.result.tree" title="Reifier.this.global.Tree">tree</a><span class="delimiter">)</span>

          val <span title="Reifier.this.global.analyzer.global.Type">tpe</span> = <a href="#scala.reflect.reify;Reifier.typer" title="=&gt; Reifier.this.global.analyzer.Typer">typer</a>.<a href="../../tools/nsc/typechecker/Typers.scala.html#scala.tools.nsc.typechecker;Typers;Typer.packedType" title="(tree: Reifier.this.global.analyzer.global.Tree, owner: Reifier.this.global.analyzer.global.Symbol)Reifier.this.global.analyzer.global.Type">packedType</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.result.tree" title="Reifier.this.global.Tree">tree</a>, <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols.NoSymbol" title="=&gt; Reifier.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span>
          val <a href="utils/Extractors.scala.html#scala.reflect.reify.utils;Extractors.ReifiedType.unapply" title="(tree: Reifier.this.global.Tree)Option[(Reifier.this.global.Tree, Reifier.this.global.Tree, Reifier.this.SymbolTable, Reifier.this.global.Type, Reifier.this.global.Tree, Boolean)]">ReifiedType</a><a href="../../Tuple3.scala.html#scala;Tuple3" title="(Reifier.this.SymbolTable, Reifier.this.global.Tree, Boolean)" class="delimiter">(</a>_, _, <a href="../../Tuple3.scala.html#scala;Tuple3._1" title="Reifier.this.SymbolTable" id="scala.reflect.reify;Reifier.reification.result.tpeSymtab">tpeSymtab</a>, _, <a href="../../Tuple3.scala.html#scala;Tuple3._2" title="Reifier.this.global.Tree" id="scala.reflect.reify;Reifier.reification.result.rtpe">rtpe</a>, <a href="../../Tuple3.scala.html#scala;Tuple3._3" title="Boolean" id="scala.reflect.reify;Reifier.reification.result.tpeReificationIsConcrete">tpeReificationIsConcrete</a><span class="delimiter">)</span> = <a href="package.scala.html#scala.reflect.reify.package" title="scala.reflect.reify.package.type">`package`</a>.<a href="package.scala.html#scala.reflect.reify.package.reifyType" title="(global: scala.tools.nsc.Global)(typer: global.analyzer.Typer, universe: global.Tree, mirror: global.Tree, tpe: global.Type, concrete: Boolean)global.Tree">reifyType</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.global" title="=&gt; scala.tools.nsc.Global">global</a><span class="delimiter">)</span><a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="Reifier.this.global.Tree @unchecked" class="delimiter">(</a><a href="#scala.reflect.reify;Reifier.typer" title="=&gt; Reifier.this.global.analyzer.Typer">typer</a>, <a href="#scala.reflect.reify;Reifier.universe" title="=&gt; Reifier.this.global.Tree">universe</a>, <a href="#scala.reflect.reify;Reifier.mirror" title="=&gt; Reifier.this.global.Tree">mirror</a>, <span title="Reifier.this.global.analyzer.global.Type">tpe</span>, concrete = false<span class="delimiter">)</span>
          <a href="States.scala.html#scala.reflect.reify;States.state" title="=&gt; Reifier.this.State">state</a>.<a href="States.scala.html#scala.reflect.reify;States;State.reificationIsConcrete_=" title="(value: Boolean)Unit">reificationIsConcrete</a> <a href="../../Boolean.scala.html#scala;Boolean.&" title="(x: Boolean)Boolean">&amp;=</a> <a href="#scala.reflect.reify;Reifier.reification.result.tpeReificationIsConcrete" title="Boolean">tpeReificationIsConcrete</a>
          <a href="States.scala.html#scala.reflect.reify;States.state" title="=&gt; Reifier.this.State">state</a>.<a href="States.scala.html#scala.reflect.reify;States;State.symtab_=" title="(x$1: Reifier.this.SymbolTable)Unit">symtab</a> <a href="utils/SymbolTables.scala.html#scala.reflect.reify.utils;SymbolTables;SymbolTable.++(b14ed598a6)" title="(symtab: Reifier.this.SymbolTable)Reifier.this.SymbolTable">++=</a> <a href="#scala.reflect.reify;Reifier.reification.result.tpeSymtab" title="Reifier.this.SymbolTable">tpeSymtab</a>
          <a href="utils/Extractors.scala.html#scala.reflect.reify.utils;Extractors.ReifiedTree.apply" title="(universe: Reifier.this.global.Tree, mirror: Reifier.this.global.Tree, symtab: Reifier.this.SymbolTable, rtree: Reifier.this.global.Tree, tpe: Reifier.this.global.Type, rtpe: Reifier.this.global.Tree, concrete: Boolean)Reifier.this.global.Tree">ReifiedTree</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.universe" title="=&gt; Reifier.this.global.Tree">universe</a>, <a href="#scala.reflect.reify;Reifier.mirror" title="=&gt; Reifier.this.global.Tree">mirror</a>, <a href="codegen/GenSymbols.scala.html#scala.reflect.reify.codegen;GenSymbols.symtab" title="=&gt; Reifier.this.SymbolTable">symtab</a>, <span title="Reifier.this.global.Tree">rtree</span>, <span title="Reifier.this.global.analyzer.global.Type">tpe</span>, <a href="#scala.reflect.reify;Reifier.reification.result.rtpe" title="Reifier.this.global.Tree">rtpe</a>, <a href="codegen/GenTypes.scala.html#scala.reflect.reify.codegen;GenTypes.reificationIsConcrete" title="=&gt; Boolean">reificationIsConcrete</a><span class="delimiter">)</span>

        case <span title="Reifier.this.global.Type">tpe</span>: <a href="../internal/Types.scala.html#scala.reflect.internal;Types;Type" title="Reifier.this.global.Type">Type</a> =&gt;
          <a href="../../tools/nsc/util/SimpleTracer.scala.html#scala.tools.nsc.util;SimpleTracer.apply" title="(msg: =&gt; String)(value: String)String">reifyTrace</a><span class="delimiter">(</span><span title="String(&quot;reifying = &quot;)" class="string">&quot;reifying = &quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><span title="Reifier.this.global.Type">tpe</span>.<a href="../internal/Types.scala.html#scala.reflect.internal;Types;Type.toString" title="()String">toString</a><span class="delimiter">)</span>
          <a href="../../tools/nsc/util/SimpleTracer.scala.html#scala.tools.nsc.util;SimpleTracer.apply" title="(msg: =&gt; String)(value: Reifier.this.global.Tree)Reifier.this.global.Tree">reifyTrace</a><span class="delimiter">(</span><span title="String(&quot;universe = &quot;)" class="string">&quot;universe = &quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.universe" title="=&gt; Reifier.this.global.Tree">universe</a><span class="delimiter">)</span>
          <a href="../../tools/nsc/util/SimpleTracer.scala.html#scala.tools.nsc.util;SimpleTracer.apply" title="(msg: =&gt; String)(value: Reifier.this.global.Tree)Reifier.this.global.Tree">reifyTrace</a><span class="delimiter">(</span><span title="String(&quot;mirror = &quot;)" class="string">&quot;mirror = &quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.mirror" title="=&gt; Reifier.this.global.Tree">mirror</a><span class="delimiter">)</span>
          val <span title="Reifier.this.global.Tree">rtree</span> = <a href="phases/Reify.scala.html#scala.reflect.reify.phases;Reify.reify" title="(reifee: Any)Reifier.this.global.Tree">reify</a><span class="delimiter">(</span><span title="Reifier.this.global.Type">tpe</span><span class="delimiter">)</span>
          <a href="utils/Extractors.scala.html#scala.reflect.reify.utils;Extractors.ReifiedType.apply" title="(universe: Reifier.this.global.Tree, mirror: Reifier.this.global.Tree, symtab: Reifier.this.SymbolTable, tpe: Reifier.this.global.Type, rtpe: Reifier.this.global.Tree, concrete: Boolean)Reifier.this.global.Tree">ReifiedType</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.universe" title="=&gt; Reifier.this.global.Tree">universe</a>, <a href="#scala.reflect.reify;Reifier.mirror" title="=&gt; Reifier.this.global.Tree">mirror</a>, <a href="codegen/GenSymbols.scala.html#scala.reflect.reify.codegen;GenSymbols.symtab" title="=&gt; Reifier.this.SymbolTable">symtab</a>, <span title="Reifier.this.global.Type">tpe</span>, <span title="Reifier.this.global.Tree">rtree</span>, <a href="codegen/GenTypes.scala.html#scala.reflect.reify.codegen;GenTypes.reificationIsConcrete" title="=&gt; Boolean">reificationIsConcrete</a><span class="delimiter">)</span>

        case _ =&gt;
          throw new <a href="../../package.scala.html#scala.package;Error" title="Error">Error</a><span class="delimiter">(</span><a href="../../Predef.scala.html#scala.Predef.augmentString" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;reifee %s of type %s is not supported&quot;</a>.<a href="../../collection/immutable/StringLike.scala.html#scala.collection.immutable;StringLike.format" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reifee" title="=&gt; Any">reifee</a>, if <span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reifee" title="=&gt; Any">reifee</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span> <span title="String(&quot;null&quot;)" class="string">&quot;null&quot;</span> else <a href="#scala.reflect.reify;Reifier.reifee" title="=&gt; Any">reifee</a>.<span title="()Class[_]">getClass</span>.<span title="()String">toString</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="comment">// todo. why do we reset attrs?</span>
      <span class="comment">//</span>
      <span class="comment">// typically we do some preprocessing before reification and</span>
      <span class="comment">// the code emitted/moved around during preprocessing is very hard to typecheck, so we leave it as it is</span>
      <span class="comment">// however this &quot;as it is&quot; sometimes doesn't make any sense</span>
      <span class="comment">//</span>
      <span class="comment">// ===example 1===</span>
      <span class="comment">// we move a freevar from a nested symbol table to a top-level symbol table,</span>
      <span class="comment">// and then the reference to $u becomes screwed up, because nested symbol tables are already typechecked,</span>
      <span class="comment">// so we have an $u symbol that points to the nested $u rather than to the top-level one.</span>
      <span class="comment">//</span>
      <span class="comment">// ===example 2===</span>
      <span class="comment">// we inline a freevar by replacing a reference to it, e.g. $u.Apply($u.Select($u.Ident($u.newTermName(&quot;$u&quot;)), $u.newTermName(&quot;Ident&quot;)), List($u.Ident($u.newTermName(&quot;free$x&quot;))))</span>
      <span class="comment">// with its original binding (e.g. $u.Ident(&quot;x&quot;))</span>
      <span class="comment">// we'd love to typecheck the result, but we cannot do this easily, because $u is external to this tree</span>
      <span class="comment">// what's even worse, sometimes $u can point to the top-level symbol table's $u, which doesn't have any symbol/type yet -</span>
      <span class="comment">// it's just a ValDef that will be emitted only after the reification is completed</span>
      <span class="comment">//</span>
      <span class="comment">// hence, the simplest solution is to erase all attrs so that invalid (as well as non-existent) bindings get rebound correctly</span>
      <span class="comment">// this is ugly, but it's the best we can do</span>
      <span class="comment">//</span>
      <span class="comment">// todo. this is a common problem with non-trivial macros in our current macro system</span>
      <span class="comment">// needs to be solved some day</span>
      <span class="comment">// upd. a new hope: https://groups.google.com/forum/#!topic/scala-internals/TtCTPlj_qcQ</span>
      var <a title="scala.collection.immutable.Set[Reifier.this.global.Symbol]" id="scala.reflect.reify;Reifier.reification.importantSymbols">importantSymbols</a> = <a href="../../collection/generic/GenericCompanion.scala.html#scala.collection.generic;GenericCompanion.apply" title="[A](elems: A*)scala.collection.immutable.Set[A]">Set</a><span title="(elems: Reifier.this.global.Symbol*)scala.collection.immutable.Set[Reifier.this.global.Symbol]" class="delimiter">[</span><a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="Reifier.this.global.Symbol">Symbol</a><span class="delimiter">]</span><span class="delimiter">(</span>
        <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.NothingClass" title="Reifier.this.global.definitions.NothingClass.type">NothingClass</a>, <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.AnyClass" title="=&gt; Reifier.this.global.ClassSymbol">AnyClass</a>, <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.SingletonClass" title="=&gt; Reifier.this.global.ClassSymbol">SingletonClass</a>, <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.PredefModule" title="=&gt; Reifier.this.global.ModuleSymbol">PredefModule</a>, <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ScalaRunTimeModule" title="=&gt; Reifier.this.global.ModuleSymbol">ScalaRunTimeModule</a>, <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.TypeCreatorClass" title="=&gt; Reifier.this.global.Symbol">TypeCreatorClass</a>, <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.TreeCreatorClass" title="=&gt; Reifier.this.global.Symbol">TreeCreatorClass</a>, <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.MirrorClass" title="=&gt; Reifier.this.global.Symbol">MirrorClass</a>,
        <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ApiUniverseClass" title="=&gt; Reifier.this.global.Symbol">ApiUniverseClass</a>, <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.JavaUniverseClass" title="=&gt; Reifier.this.global.Symbol">JavaUniverseClass</a>, <a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ReflectRuntimePackage" title="=&gt; Reifier.this.global.Symbol">ReflectRuntimePackage</a>, <a href="#scala.reflect.reify;Reifier.runDefinitions" title="=&gt; Reifier.this.global.definitions.RunDefinitions">runDefinitions</a>.<a href="../internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass;RunDefinitions.ReflectRuntimeCurrentMirror" title="=&gt; Reifier.this.global.Symbol">ReflectRuntimeCurrentMirror</a><span class="delimiter">)</span>
      <a href="#scala.reflect.reify;Reifier.reification.importantSymbols" title="scala.collection.immutable.Set[Reifier.this.global.Symbol]">importantSymbols</a> <a href="../../collection/SetLike.scala.html#scala.collection;SetLike.++(07e1553119)" title="(elems: scala.collection.GenTraversableOnce[Reifier.this.global.Symbol])scala.collection.immutable.Set[Reifier.this.global.Symbol]">++=</a> <a href="#scala.reflect.reify;Reifier.reification.importantSymbols" title="scala.collection.immutable.Set[Reifier.this.global.Symbol]">importantSymbols</a> <a href="../../collection/SetLike.scala.html#scala.collection;SetLike.map" title="(f: Reifier.this.global.Symbol =&gt; Reifier.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[Reifier.this.global.Symbol],Reifier.this.global.Symbol,scala.collection.immutable.Set[Reifier.this.global.Symbol]])scala.collection.immutable.Set[Reifier.this.global.Symbol]">map</a> <span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.$anonfun.x$4" title="Reifier.this.global.Symbol">_</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.companionSymbol" title="=&gt; Reifier.this.global.Symbol">companionSymbol</a><span class="delimiter">)</span>
      <a href="#scala.reflect.reify;Reifier.reification.importantSymbols" title="scala.collection.immutable.Set[Reifier.this.global.Symbol]">importantSymbols</a> <a href="../../collection/SetLike.scala.html#scala.collection;SetLike.++(07e1553119)" title="(elems: scala.collection.GenTraversableOnce[Reifier.this.global.Symbol])scala.collection.immutable.Set[Reifier.this.global.Symbol]">++=</a> <a href="#scala.reflect.reify;Reifier.reification.importantSymbols" title="scala.collection.immutable.Set[Reifier.this.global.Symbol]">importantSymbols</a> <a href="../../collection/SetLike.scala.html#scala.collection;SetLike.map" title="(f: Reifier.this.global.Symbol =&gt; Reifier.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[Reifier.this.global.Symbol],Reifier.this.global.Symbol,scala.collection.immutable.Set[Reifier.this.global.Symbol]])scala.collection.immutable.Set[Reifier.this.global.Symbol]">map</a> <span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.$anonfun.x$5" title="Reifier.this.global.Symbol">_</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.moduleClass" title="=&gt; Reifier.this.global.Symbol">moduleClass</a><span class="delimiter">)</span>
      <a href="#scala.reflect.reify;Reifier.reification.importantSymbols" title="scala.collection.immutable.Set[Reifier.this.global.Symbol]">importantSymbols</a> <a href="../../collection/SetLike.scala.html#scala.collection;SetLike.++(07e1553119)" title="(elems: scala.collection.GenTraversableOnce[Reifier.this.global.Symbol])scala.collection.immutable.Set[Reifier.this.global.Symbol]">++=</a> <a href="#scala.reflect.reify;Reifier.reification.importantSymbols" title="scala.collection.immutable.Set[Reifier.this.global.Symbol]">importantSymbols</a> <a href="../../collection/SetLike.scala.html#scala.collection;SetLike.map" title="(f: Reifier.this.global.Symbol =&gt; Reifier.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[Reifier.this.global.Symbol],Reifier.this.global.Symbol,scala.collection.immutable.Set[Reifier.this.global.Symbol]])scala.collection.immutable.Set[Reifier.this.global.Symbol]">map</a> <span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.$anonfun.x$6" title="Reifier.this.global.Symbol">_</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.linkedClassOfClass" title="=&gt; Reifier.this.global.Symbol">linkedClassOfClass</a><span class="delimiter">)</span>
      def <a title="(sym: Reifier.this.global.Symbol)Boolean" id="scala.reflect.reify;Reifier.reification.isImportantSymbol">isImportantSymbol</a><span class="delimiter">(</span><a title="Reifier.this.global.Symbol" id="scala.reflect.reify;Reifier.reification.isImportantSymbol.sym">sym</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="Reifier.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <a href="#scala.reflect.reify;Reifier.reification.isImportantSymbol.sym" title="Reifier.this.global.Symbol">sym</a> <span title="(x$1: Any)Boolean">!=</span> null <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.reflect.reify;Reifier.reification.isImportantSymbol.sym" title="Reifier.this.global.Symbol">sym</a> <span title="(x$1: Any)Boolean">!=</span> <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols.NoSymbol" title="=&gt; Reifier.this.global.NoSymbol">NoSymbol</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../collection/GenSetLike.scala.html#scala.collection;GenSetLike.apply" title="(elem: Reifier.this.global.Symbol)Boolean">importantSymbols</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.isImportantSymbol.sym" title="Reifier.this.global.Symbol">sym</a><span class="delimiter">)</span>
      val <a title="Reifier.this.global.Tree" id="scala.reflect.reify;Reifier.reification.untyped">untyped</a> = <a href="../../tools/nsc/ast/Trees.scala.html#scala.tools.nsc.ast;Trees.brutallyResetAttrs" title="(x: Reifier.this.global.Tree, leaveAlone: Reifier.this.global.Tree =&gt; Boolean)Reifier.this.global.Tree">brutallyResetAttrs</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.result" title="Reifier.this.global.Tree">result</a>, leaveAlone = <a href="#scala.reflect.reify;Reifier.reification.untyped.$anonfun.x0$1" title="Boolean" class="delimiter">{</a>
        case ValDef<span class="delimiter">(</span>_, <a title="Reifier.this.global.TermName" id="scala.reflect.reify;Reifier.reification.untyped.$anonfun.u">u</a>, _, _<span class="delimiter">)</span> if <a href="#scala.reflect.reify;Reifier.reification.untyped.$anonfun.u" title="Reifier.this.global.TermName">u</a> <span title="(x$1: Any)Boolean">==</span> <a href="../internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="Reifier.this.global.nme.type">nme</a>.<a href="../internal/StdNames.scala.html#scala.reflect.internal;StdNames;TermNames.UNIVERSE_SHORT" title="=&gt; Reifier.this.global.nme.NameType">UNIVERSE_SHORT</a> =&gt; true
        case ValDef<span class="delimiter">(</span>_, <a title="Reifier.this.global.TermName" id="scala.reflect.reify;Reifier.reification.untyped.$anonfun.m">m</a>, _, _<span class="delimiter">)</span> if <a href="#scala.reflect.reify;Reifier.reification.untyped.$anonfun.m" title="Reifier.this.global.TermName">m</a> <span title="(x$1: Any)Boolean">==</span> <a href="../internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="Reifier.this.global.nme.type">nme</a>.<a href="../internal/StdNames.scala.html#scala.reflect.internal;StdNames;TermNames.MIRROR_SHORT" title="=&gt; Reifier.this.global.nme.NameType">MIRROR_SHORT</a> =&gt; true
        case <span title="Reifier.this.global.Tree">tree</span> if <a href="codegen/GenSymbols.scala.html#scala.reflect.reify.codegen;GenSymbols.symtab" title="=&gt; Reifier.this.SymbolTable">symtab</a>.<a href="utils/SymbolTables.scala.html#scala.reflect.reify.utils;SymbolTables;SymbolTable.syms" title="=&gt; List[Reifier.this.global.Symbol]">syms</a> <a href="../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.contains" title="(elem: Reifier.this.global.Symbol)Boolean">contains</a> <span title="Reifier.this.global.Tree">tree</span>.<a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.symbol" title="=&gt; Reifier.this.global.Symbol">symbol</a> =&gt; true
        case <span title="Reifier.this.global.Tree">tree</span> if <a href="#scala.reflect.reify;Reifier.reification.isImportantSymbol" title="(sym: Reifier.this.global.Symbol)Boolean">isImportantSymbol</a><span class="delimiter">(</span><span title="Reifier.this.global.Tree">tree</span>.<a href="../internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.symbol" title="=&gt; Reifier.this.global.Symbol">symbol</a><span class="delimiter">)</span> =&gt; true
        case _ =&gt; false
      <span class="delimiter">}</span><span class="delimiter">)</span>

      if <span class="delimiter">(</span><a href="utils/Utils.scala.html#scala.reflect.reify.utils;Utils.reifyCopypaste" title="=&gt; Boolean">reifyCopypaste</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        if <span class="delimiter">(</span><a href="utils/Utils.scala.html#scala.reflect.reify.utils;Utils.reifyDebug" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../Predef.scala.html#scala.Predef.println(b0c81b2e65)" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;=============================&quot;)" class="string">&quot;=============================&quot;</span><span class="delimiter">)</span>
        <a href="../../Predef.scala.html#scala.Predef.println(b0c81b2e65)" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="utils/NodePrinters.scala.html#scala.reflect.reify.utils;NodePrinters.reifiedNodeToString.apply" title="(tree: Reifier.this.global.Tree)String">reifiedNodeToString</a><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.untyped" title="Reifier.this.global.Tree">untyped</a><span class="delimiter">)</span><span class="delimiter">)</span>
        if <span class="delimiter">(</span><a href="utils/Utils.scala.html#scala.reflect.reify.utils;Utils.reifyDebug" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../Predef.scala.html#scala.Predef.println(b0c81b2e65)" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;=============================&quot;)" class="string">&quot;=============================&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> else <span class="delimiter">{</span>
        <a href="../../tools/nsc/util/SimpleTracer.scala.html#scala.tools.nsc.util;SimpleTracer.apply" title="(msg: =&gt; String)(value: Reifier.this.global.Tree)Reifier.this.global.Tree">reifyTrace</a><span class="delimiter">(</span><span title="String(&quot;reification = &quot;)" class="string">&quot;reification = &quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.reflect.reify;Reifier.reification.untyped" title="Reifier.this.global.Tree">untyped</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#scala.reflect.reify;Reifier.reification.untyped" title="Reifier.this.global.Tree">untyped</a>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <span title="scala.reflect.macros.ReificationException">ex</span>: <a href="../macros/Reifiers.scala.html#scala.reflect.macros;ReificationException" title="scala.reflect.macros.ReificationException">ReificationException</a> =&gt;
        throw <span title="scala.reflect.macros.ReificationException">ex</span>
      case <span title="scala.reflect.macros.UnexpectedReificationException">ex</span>: <a href="../macros/Reifiers.scala.html#scala.reflect.macros;UnexpectedReificationException" title="scala.reflect.macros.UnexpectedReificationException">UnexpectedReificationException</a> =&gt;
        throw <span title="scala.reflect.macros.UnexpectedReificationException">ex</span>
      case <span title="Throwable">ex</span>: <span title="Throwable">Throwable</span> =&gt;
        throw new <a href="../macros/Reifiers.scala.html#scala.reflect.macros;UnexpectedReificationException" title="scala.reflect.macros.UnexpectedReificationException">UnexpectedReificationException</a><span class="delimiter">(</span><a href="Errors.scala.html#scala.reflect.reify;Errors.defaultErrorPosition" title="=&gt; Reifier.this.global.Position">defaultErrorPosition</a>, <span title="String(&quot;reification crashed&quot;)" class="string">&quot;reification crashed&quot;</span>, <span title="Throwable">ex</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

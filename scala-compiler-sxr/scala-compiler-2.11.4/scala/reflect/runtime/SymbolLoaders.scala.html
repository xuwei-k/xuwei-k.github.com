<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scala/reflect/runtime/SymbolLoaders.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
package scala
package reflect
package runtime

import internal.Flags
import java.lang.<span class="delimiter">{</span>Class =&gt; jClass, Package =&gt; jPackage<span class="delimiter">}</span>
import scala.collection.mutable
import scala.reflect.runtime.<a href="ReflectionUtils.scala.html#scala.reflect.runtime.ReflectionUtils" title="scala.reflect.runtime.ReflectionUtils.type">ReflectionUtils</a>.scalacShouldntLoadClass
import scala.reflect.internal.<a href="../internal/Flags.scala.html#scala.reflect.internal.Flags" title="scala.reflect.internal.Flags.type">Flags</a>._

private<span class="delimiter">[</span>reflect<span class="delimiter">]</span> trait <a title="trait SymbolLoaders extends AnyRef" id="scala.reflect.runtime;SymbolLoaders">SymbolLoaders</a> <a href="../../Unit.scala.html#scala;Unit" title="Unit" class="delimiter">{</a> self: SymbolTable =&gt;

  <span class="comment">/** The standard completer for top-level classes
   *  @param clazz   The top-level class
   *  @param module  The companion object of `clazz`
   *  Calling `complete` on this type will assign the infos of `clazz` and `module`
   *  by unpickling information from the corresponding Java class. If no Java class
   *  is found, a package is created instead.
   */</span>
  class <a title="class TopClassCompleter extends SymbolLoaders.this.SymLoader with SymbolLoaders.this.FlagAssigningCompleter" id="scala.reflect.runtime;SymbolLoaders;TopClassCompleter">TopClassCompleter</a><a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter" title="SymbolLoaders.this.TopClassCompleter" class="delimiter">(</a><a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders;TopClassCompleter.clazz">clazz</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a>, <a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders;TopClassCompleter.module">module</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a><span class="delimiter">)</span> extends <a href="../internal/SymbolTable.scala.html#scala.reflect.internal;SymbolTable;SymLoader" title="SymbolLoaders.this.SymLoader">SymLoader</a> with <a href="../internal/Types.scala.html#scala.reflect.internal;Types;FlagAssigningCompleter" title="SymbolLoaders.this.FlagAssigningCompleter">FlagAssigningCompleter</a> <span class="delimiter">{</span>
    <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols.markFlagsCompleted" title="(syms: SymbolLoaders.this.Symbol*)(mask: Long)Unit">markFlagsCompleted</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.clazz" title="SymbolLoaders.this.Symbol">clazz</a>, <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.module" title="SymbolLoaders.this.Symbol">module</a><span class="delimiter">)</span><span class="delimiter">(</span>mask = <a href="../../Long.scala.html#scala;Long.unary_~" title="=&gt; Long">~</a><a href="../internal/Flags.scala.html#scala.reflect.internal;Flags.TopLevelPickledFlags" title="=&gt; Long">TopLevelPickledFlags</a><span class="delimiter">)</span>
    override def <a title="(sym: SymbolLoaders.this.Symbol)Unit" id="scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete">complete</a><span class="delimiter">(</span><a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.sym">sym</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="SymbolTable.scala.html#scala.reflect.runtime;SymbolTable.debugInfo" title="(msg: =&gt; String)Unit">debugInfo</a><span class="delimiter">(</span><span title="String(&quot;completing &quot;)" class="string">&quot;completing &quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.sym" title="SymbolLoaders.this.Symbol">sym</a><span title="(x$1: Any)String">+</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.clazz" title="SymbolLoaders.this.Symbol">clazz</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.fullName(3bf7c90be7)" title="=&gt; String">fullName</a><span class="delimiter">)</span>
      <a href="../../Predef.scala.html#scala.Predef.assert(65d7b4917f)" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.sym" title="SymbolLoaders.this.Symbol">sym</a> <span title="(x$1: Any)Boolean">==</span> <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.clazz" title="SymbolLoaders.this.Symbol">clazz</a> <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.sym" title="SymbolLoaders.this.Symbol">sym</a> <span title="(x$1: Any)Boolean">==</span> <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.module" title="SymbolLoaders.this.Symbol">module</a> <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.sym" title="SymbolLoaders.this.Symbol">sym</a> <span title="(x$1: Any)Boolean">==</span> <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.module" title="SymbolLoaders.this.Symbol">module</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.moduleClass" title="=&gt; SymbolLoaders.this.Symbol">moduleClass</a><span class="delimiter">)</span>
      <a href="../internal/SymbolTable.scala.html#scala.reflect.internal;SymbolTable.slowButSafeEnteringPhaseNotLaterThan" title="(target: scala.reflect.internal.Phase)(op: =&gt; Unit)Unit">slowButSafeEnteringPhaseNotLaterThan</a><span class="delimiter">(</span><a href="../internal/Required.scala.html#scala.reflect.internal;Required.picklerPhase" title="=&gt; scala.reflect.internal.Phase">picklerPhase</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        val <a title="SymbolLoaders.this.Mirror" id="scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.loadingMirror">loadingMirror</a> = <a href="JavaMirrors.scala.html#scala.reflect.runtime;JavaMirrors.mirrorThatLoaded" title="(sym: SymbolLoaders.this.Symbol)SymbolLoaders.this.Mirror">mirrorThatLoaded</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.sym" title="SymbolLoaders.this.Symbol">sym</a><span class="delimiter">)</span>
        val <a title="Class[_]" id="scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.javaClass">javaClass</a> = <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.loadingMirror" title="SymbolLoaders.this.Mirror">loadingMirror</a>.<a href="JavaMirrors.scala.html#scala.reflect.runtime;JavaMirrors;JavaMirror.javaClass" title="(path: String)Class[_]">javaClass</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.clazz" title="SymbolLoaders.this.Symbol">clazz</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.javaClassName" title="=&gt; String">javaClassName</a><span class="delimiter">)</span>
        <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.loadingMirror" title="SymbolLoaders.this.Mirror">loadingMirror</a>.<a href="JavaMirrors.scala.html#scala.reflect.runtime;JavaMirrors;JavaMirror.unpickleClass" title="(clazz: SymbolLoaders.this.Symbol, module: SymbolLoaders.this.Symbol, jclazz: Class[_])Unit">unpickleClass</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.clazz" title="SymbolLoaders.this.Symbol">clazz</a>, <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.module" title="SymbolLoaders.this.Symbol">module</a>, <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete.javaClass" title="Class[_]">javaClass</a><span class="delimiter">)</span>
        <span class="comment">// NOTE: can't mark as thread-safe here, because unpickleClass might decide to delegate to FromJavaClassCompleter</span>
        <span class="comment">// if (!isCompilerUniverse) markAllCompleted(clazz, module)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    override def <a title="(sym: SymbolLoaders.this.Symbol)Unit" id="scala.reflect.runtime;SymbolLoaders;TopClassCompleter.load">load</a><span class="delimiter">(</span><a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders;TopClassCompleter.load.sym">sym</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.complete" title="(sym: SymbolLoaders.this.Symbol)Unit">complete</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter.load.sym" title="SymbolLoaders.this.Symbol">sym</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Create a class and a companion object, enter in enclosing scope,
   *  and initialize with a lazy type completer.
   *  @param owner   The owner of the newly created class and object
   *  @param name    The simple name of the newly created class
   *  @param completer  The completer to be used to set the info of the class and the module
   */</span>
  protected def <a title="(owner: SymbolLoaders.this.Symbol, name: SymbolLoaders.this.TypeName, completer: (SymbolLoaders.this.Symbol, SymbolLoaders.this.Symbol) =&gt; SymbolLoaders.this.LazyType)(SymbolLoaders.this.ClassSymbol, SymbolLoaders.this.ModuleSymbol)" id="scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule">initAndEnterClassAndModule</a><span class="delimiter">(</span><a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.owner">owner</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a>, <a title="SymbolLoaders.this.TypeName" id="scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.name">name</a>: <a href="../internal/Names.scala.html#scala.reflect.internal;Names;TypeName" title="SymbolLoaders.this.TypeName">TypeName</a>, <a title="(SymbolLoaders.this.Symbol, SymbolLoaders.this.Symbol) =&gt; SymbolLoaders.this.LazyType" id="scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.completer">completer</a>: <span class="delimiter">(</span>Symbol, Symbol<span class="delimiter">)</span> =&gt; LazyType<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="../../Predef.scala.html#scala.Predef.assert(0f40bc559c)" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.name" title="SymbolLoaders.this.TypeName">name</a>.<span title="()String">toString</span> <span title="(x$1: String)Boolean">endsWith</span> <span title="String(&quot;[]&quot;)" class="string">&quot;[]&quot;</span><span class="delimiter">)</span>, <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.name" title="SymbolLoaders.this.TypeName">name</a><span class="delimiter">)</span>
    val <a title="SymbolLoaders.this.ClassSymbol" id="scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.clazz">clazz</a> = <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.owner" title="SymbolLoaders.this.Symbol">owner</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.newClass" title="(name: SymbolLoaders.this.TypeName, pos: SymbolLoaders.this.Position, newFlags: Long)SymbolLoaders.this.ClassSymbol">newClass</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.name" title="SymbolLoaders.this.TypeName">name</a><span class="delimiter">)</span>
    val <a title="SymbolLoaders.this.ModuleSymbol" id="scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.module">module</a> = <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.owner" title="SymbolLoaders.this.Symbol">owner</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.newModule" title="(name: SymbolLoaders.this.TermName, pos: SymbolLoaders.this.Position, newFlags0: Long)SymbolLoaders.this.ModuleSymbol">newModule</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.name" title="SymbolLoaders.this.TypeName">name</a>.<a href="../internal/Names.scala.html#scala.reflect.internal;Names;TypeName.toTermName" title="=&gt; SymbolLoaders.this.TermName">toTermName</a><span class="delimiter">)</span>
    <span class="comment">// without this check test/files/run/t5256g and test/files/run/t5256h will crash</span>
    <span class="comment">// todo. reflection meeting verdict: need to enter the symbols into the first symbol in the owner chain that has a non-empty scope</span>
    if <span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.owner" title="SymbolLoaders.this.Symbol">owner</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.info" title="=&gt; SymbolLoaders.this.Type">info</a>.<a href="../internal/Types.scala.html#scala.reflect.internal;Types;Type.decls" title="=&gt; SymbolLoaders.this.Scope">decls</a> <span title="(x$1: Any)Boolean">!=</span> <a href="../internal/Scopes.scala.html#scala.reflect.internal;Scopes.EmptyScope" title="SymbolLoaders.this.EmptyScope.type">EmptyScope</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.owner" title="SymbolLoaders.this.Symbol">owner</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.info" title="=&gt; SymbolLoaders.this.Type">info</a>.<a href="../internal/Types.scala.html#scala.reflect.internal;Types;Type.decls" title="=&gt; SymbolLoaders.this.Scope">decls</a> <a href="../internal/Scopes.scala.html#scala.reflect.internal;Scopes;Scope.enter" title="(sym: SymbolLoaders.this.ClassSymbol)SymbolLoaders.this.ClassSymbol">enter</a> <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.clazz" title="SymbolLoaders.this.ClassSymbol">clazz</a>
      <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.owner" title="SymbolLoaders.this.Symbol">owner</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.info" title="=&gt; SymbolLoaders.this.Type">info</a>.<a href="../internal/Types.scala.html#scala.reflect.internal;Types;Type.decls" title="=&gt; SymbolLoaders.this.Scope">decls</a> <a href="../internal/Scopes.scala.html#scala.reflect.internal;Scopes;Scope.enter" title="(sym: SymbolLoaders.this.ModuleSymbol)SymbolLoaders.this.ModuleSymbol">enter</a> <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.module" title="SymbolLoaders.this.ModuleSymbol">module</a>
    <span class="delimiter">}</span>
    <a href="#scala.reflect.runtime;SymbolLoaders.initClassAndModule" title="(clazz: SymbolLoaders.this.Symbol, module: SymbolLoaders.this.Symbol, completer: SymbolLoaders.this.LazyType)Unit">initClassAndModule</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.clazz" title="SymbolLoaders.this.ClassSymbol">clazz</a>, <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.module" title="SymbolLoaders.this.ModuleSymbol">module</a>, <a href="../../Function2.scala.html#scala;Function2.apply" title="(v1: SymbolLoaders.this.Symbol, v2: SymbolLoaders.this.Symbol)SymbolLoaders.this.LazyType">completer</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.clazz" title="SymbolLoaders.this.ClassSymbol">clazz</a>, <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.module" title="SymbolLoaders.this.ModuleSymbol">module</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="../../Tuple2.scala.html#scala;Tuple2" title="(_1: SymbolLoaders.this.ClassSymbol, _2: SymbolLoaders.this.ModuleSymbol)(SymbolLoaders.this.ClassSymbol, SymbolLoaders.this.ModuleSymbol)" class="delimiter">(</a><a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.clazz" title="SymbolLoaders.this.ClassSymbol">clazz</a>, <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule.module" title="SymbolLoaders.this.ModuleSymbol">module</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  protected def <a title="(clazz: SymbolLoaders.this.Symbol, module: SymbolLoaders.this.Symbol, info: SymbolLoaders.this.Type)Unit" id="scala.reflect.runtime;SymbolLoaders.setAllInfos">setAllInfos</a><span class="delimiter">(</span><a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders.setAllInfos.clazz">clazz</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a>, <a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders.setAllInfos.module">module</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a>, <a title="SymbolLoaders.this.Type" id="scala.reflect.runtime;SymbolLoaders.setAllInfos.info">info</a>: <a href="../internal/Types.scala.html#scala.reflect.internal;Types;Type" title="SymbolLoaders.this.Type">Type</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: SymbolLoaders.this.Symbol*)List[SymbolLoaders.this.Symbol]">List</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.setAllInfos.clazz" title="SymbolLoaders.this.Symbol">clazz</a>, <a href="#scala.reflect.runtime;SymbolLoaders.setAllInfos.module" title="SymbolLoaders.this.Symbol">module</a>, <a href="#scala.reflect.runtime;SymbolLoaders.setAllInfos.module" title="SymbolLoaders.this.Symbol">module</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.moduleClass" title="=&gt; SymbolLoaders.this.Symbol">moduleClass</a><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.foreach" title="(f: SymbolLoaders.this.Symbol =&gt; SymbolLoaders.this.Symbol)Unit">foreach</a> <span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.setAllInfos.$anonfun.x$1" title="SymbolLoaders.this.Symbol">_</a> <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.setInfo" title="(info: SymbolLoaders.this.Type)x$1.type">setInfo</a> <a href="#scala.reflect.runtime;SymbolLoaders.setAllInfos.info" title="SymbolLoaders.this.Type">info</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  protected def <a title="(clazz: SymbolLoaders.this.Symbol, module: SymbolLoaders.this.Symbol, completer: SymbolLoaders.this.LazyType)Unit" id="scala.reflect.runtime;SymbolLoaders.initClassAndModule">initClassAndModule</a><span class="delimiter">(</span><a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders.initClassAndModule.clazz">clazz</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a>, <a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders.initClassAndModule.module">module</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a>, <a title="SymbolLoaders.this.LazyType" id="scala.reflect.runtime;SymbolLoaders.initClassAndModule.completer">completer</a>: <a href="../internal/Types.scala.html#scala.reflect.internal;Types;LazyType" title="SymbolLoaders.this.LazyType">LazyType</a><span class="delimiter">)</span> =
    <a href="#scala.reflect.runtime;SymbolLoaders.setAllInfos" title="(clazz: SymbolLoaders.this.Symbol, module: SymbolLoaders.this.Symbol, info: SymbolLoaders.this.Type)Unit">setAllInfos</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.initClassAndModule.clazz" title="SymbolLoaders.this.Symbol">clazz</a>, <a href="#scala.reflect.runtime;SymbolLoaders.initClassAndModule.module" title="SymbolLoaders.this.Symbol">module</a>, <a href="#scala.reflect.runtime;SymbolLoaders.initClassAndModule.completer" title="SymbolLoaders.this.LazyType">completer</a><span class="delimiter">)</span>

  <span class="comment">/** The type completer for packages.
   */</span>
  class <a title="class LazyPackageType extends SymbolLoaders.this.LazyType with SymbolLoaders.this.FlagAgnosticCompleter" id="scala.reflect.runtime;SymbolLoaders;LazyPackageType">LazyPackageType</a> extends <a href="../internal/Types.scala.html#scala.reflect.internal;Types;LazyType" title="SymbolLoaders.this.LazyType">LazyType</a> with <a href="../internal/Types.scala.html#scala.reflect.internal;Types;FlagAgnosticCompleter" title="SymbolLoaders.this.FlagAgnosticCompleter">FlagAgnosticCompleter</a> <span class="delimiter">{</span>
    override def <a title="(sym: SymbolLoaders.this.Symbol)Unit" id="scala.reflect.runtime;SymbolLoaders;LazyPackageType.complete">complete</a><span class="delimiter">(</span><a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders;LazyPackageType.complete.sym">sym</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Predef.scala.html#scala.Predef.assert(65d7b4917f)" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;LazyPackageType.complete.sym" title="SymbolLoaders.this.Symbol">sym</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.isPackageClass" title="=&gt; Boolean">isPackageClass</a><span class="delimiter">)</span>
      <span class="comment">// Time travel to a phase before refchecks avoids an initialization issue. `openPackageModule`</span>
      <span class="comment">// creates a module symbol and invokes invokes `companionModule` while the `infos` field is</span>
      <span class="comment">// still null. This calls `isModuleNotMethod`, which forces the `info` if run after refchecks.</span>
      <a href="../internal/SymbolTable.scala.html#scala.reflect.internal;SymbolTable.slowButSafeEnteringPhaseNotLaterThan" title="(target: scala.reflect.internal.Phase)(op: =&gt; Unit)Unit">slowButSafeEnteringPhaseNotLaterThan</a><span class="delimiter">(</span><a href="../internal/Required.scala.html#scala.reflect.internal;Required.picklerPhase" title="=&gt; scala.reflect.internal.Phase">picklerPhase</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#scala.reflect.runtime;SymbolLoaders;LazyPackageType.complete.sym" title="SymbolLoaders.this.Symbol">sym</a> <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.setInfo" title="(info: SymbolLoaders.this.Type)sym.type">setInfo</a> new <a href="../internal/Types.scala.html#scala.reflect.internal;Types;ClassInfoType" title="SymbolLoaders.this.ClassInfoType">ClassInfoType</a><span class="delimiter">(</span>List<a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type" class="delimiter">(</a><span class="delimiter">)</span>, new <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope" title="SymbolLoaders.this.PackageScope">PackageScope</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;LazyPackageType.complete.sym" title="SymbolLoaders.this.Symbol">sym</a><span class="delimiter">)</span>, <a href="#scala.reflect.runtime;SymbolLoaders;LazyPackageType.complete.sym" title="SymbolLoaders.this.Symbol">sym</a><span class="delimiter">)</span>
        <span class="comment">// override def safeToString = pkgClass.toString</span>
        <a href="../internal/SymbolTable.scala.html#scala.reflect.internal;SymbolTable.openPackageModule(c32bd0254d)" title="(pkgClass: SymbolLoaders.this.Symbol)Unit">openPackageModule</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;LazyPackageType.complete.sym" title="SymbolLoaders.this.Symbol">sym</a><span class="delimiter">)</span>
        <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols.markAllCompleted" title="(syms: SymbolLoaders.this.Symbol*)Unit">markAllCompleted</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;LazyPackageType.complete.sym" title="SymbolLoaders.this.Symbol">sym</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>


  <span class="comment">// Since runtime reflection doesn't have a luxury of enumerating all classes</span>
  <span class="comment">// on the classpath, it has to materialize symbols for top-level definitions</span>
  <span class="comment">// (packages, classes, objects) on demand.</span>
  <span class="comment">//</span>
  <span class="comment">// Someone asks us for a class named `foo.Bar`? Easy. Let's speculatively create</span>
  <span class="comment">// a package named `foo` and then look up `newTypeName(&quot;bar&quot;)` in its decls.</span>
  <span class="comment">// This lookup, implemented in `SymbolLoaders.PackageScope` tests the waters by</span>
  <span class="comment">// trying to to `Class.forName(&quot;foo.Bar&quot;)` and then creates a ClassSymbol upon</span>
  <span class="comment">// success (the whole story is a bit longer, but the rest is irrelevant here).</span>
  <span class="comment">//</span>
  <span class="comment">// That's all neat, but these non-deterministic mutations of the global symbol</span>
  <span class="comment">// table give a lot of trouble in multi-threaded setting. One of the popular</span>
  <span class="comment">// reflection crashes happens when multiple threads happen to trigger symbol</span>
  <span class="comment">// materialization multiple times for the same symbol, making subsequent</span>
  <span class="comment">// reflective operations stumble upon outrageous stuff like overloaded packages.</span>
  <span class="comment">//</span>
  <span class="comment">// Short of significantly changing SymbolLoaders I see no other way than just</span>
  <span class="comment">// to slap a global lock on materialization in runtime reflection.</span>
  class <a title="class PackageScope extends SymbolLoaders.this.Scope with SymbolLoaders.this.SynchronizedScope" id="scala.reflect.runtime;SymbolLoaders;PackageScope">PackageScope</a><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope" title="SymbolLoaders.this.PackageScope" class="delimiter">(</a><a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders;PackageScope.pkgClass">pkgClass</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a><span class="delimiter">)</span> extends <a href="../internal/Scopes.scala.html#scala.reflect.internal;Scopes;Scope" title="SymbolLoaders.this.Scope">Scope</a>
      with <a href="SynchronizedOps.scala.html#scala.reflect.runtime;SynchronizedOps;SynchronizedScope" title="SymbolLoaders.this.SynchronizedScope">SynchronizedScope</a> <span class="delimiter">{</span>
    <a href="../../Predef.scala.html#scala.Predef.assert(65d7b4917f)" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.pkgClass" title="SymbolLoaders.this.Symbol">pkgClass</a>.<a href="../api/Symbols.scala.html#scala.reflect.api;Symbols;SymbolApi.isType" title="=&gt; Boolean">isType</a><span class="delimiter">)</span>

    <span class="comment">// materializing multiple copies of the same symbol in PackageScope is a very popular bug</span>
    <span class="comment">// this override does its best to guard against it</span>
    override def <a title="[T &lt;: SymbolLoaders.this.Symbol](sym: T)T" id="scala.reflect.runtime;SymbolLoaders;PackageScope.enter">enter</a><span class="delimiter">[</span><a title=" &lt;: SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders;PackageScope.enter;T">T</a> &lt;: Symbol<span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="scala.reflect.runtime;SymbolLoaders;PackageScope.enter.sym">sym</a>: <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enter;T" title="T">T</a><span class="delimiter">)</span>: <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enter;T" title="T">T</a> = <span class="delimiter">{</span>
      <span class="comment">// workaround for SI-7728</span>
      if <span class="delimiter">(</span><a href="SymbolTable.scala.html#scala.reflect.runtime;SymbolTable.isCompilerUniverse" title="=&gt; Boolean">isCompilerUniverse</a><span class="delimiter">)</span> super.<a href="SynchronizedOps.scala.html#scala.reflect.runtime;SynchronizedOps;SynchronizedScope.enter" title="(sym: T)T">enter</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enter.sym" title="T">sym</a><span class="delimiter">)</span>
      else <span class="delimiter">{</span>
        val <a title="SymbolLoaders.this.ScopeEntry" id="scala.reflect.runtime;SymbolLoaders;PackageScope.enter.existing">existing</a> = super.<a href="SynchronizedOps.scala.html#scala.reflect.runtime;SynchronizedOps;SynchronizedScope.lookupEntry" title="(name: SymbolLoaders.this.Name)SymbolLoaders.this.ScopeEntry">lookupEntry</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enter.sym" title="T">sym</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.name" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span>
        <a href="../../Predef.scala.html#scala.Predef.assert(0f40bc559c)" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enter.existing" title="SymbolLoaders.this.ScopeEntry">existing</a> <span title="(x$1: Any)Boolean">==</span> null <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enter.existing" title="SymbolLoaders.this.ScopeEntry">existing</a>.<a href="../internal/Scopes.scala.html#scala.reflect.internal;Scopes;ScopeEntry.sym" title="=&gt; SymbolLoaders.this.Symbol">sym</a>.<a href="../api/Symbols.scala.html#scala.reflect.api;Symbols;SymbolApi.isMethod" title="=&gt; Boolean">isMethod</a>, <a href="../../StringContext.scala.html#scala;StringContext.s" title="(args: Any*)String">s</a>&quot;<span title="String(&quot;pkgClass = &quot;)">pkgClass = $</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.pkgClass" title="SymbolLoaders.this.Symbol">pkgClass</a><span title="String(&quot;, sym = &quot;)">, sym = $</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enter.sym" title="T">sym</a><span title="String(&quot;, existing = &quot;)">, existing = $</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enter.existing" title="SymbolLoaders.this.ScopeEntry">existing</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
        super.<a href="SynchronizedOps.scala.html#scala.reflect.runtime;SynchronizedOps;SynchronizedScope.enter" title="(sym: T)T">enter</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enter.sym" title="T">sym</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    override def <a title="[T &lt;: SymbolLoaders.this.Symbol](sym: T)T" id="scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew">enterIfNew</a><span class="delimiter">[</span><a title=" &lt;: SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew;T">T</a> &lt;: Symbol<span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew.sym">sym</a>: <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew;T" title="T">T</a><span class="delimiter">)</span>: <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew;T" title="T">T</a> = <span class="delimiter">{</span>
      val <a title="SymbolLoaders.this.ScopeEntry" id="scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew.existing">existing</a> = super.<a href="SynchronizedOps.scala.html#scala.reflect.runtime;SynchronizedOps;SynchronizedScope.lookupEntry" title="(name: SymbolLoaders.this.Name)SymbolLoaders.this.ScopeEntry">lookupEntry</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew.sym" title="T">sym</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.name" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew.existing" title="SymbolLoaders.this.ScopeEntry">existing</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span> <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enter" title="(sym: T)T">enter</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew.sym" title="T">sym</a><span class="delimiter">)</span>
      else <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew.existing" title="SymbolLoaders.this.ScopeEntry">existing</a>.<a href="../internal/Scopes.scala.html#scala.reflect.internal;Scopes;ScopeEntry.sym" title="=&gt; SymbolLoaders.this.Symbol">sym</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="T" class="delimiter">[</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew;T" title="T">T</a><span class="delimiter">]</span>
    <span class="delimiter">}</span>

    <span class="comment">// package scopes need to synchronize on the GIL</span>
    <span class="comment">// because lookupEntry might cause changes to the global symbol table</span>
    override def <a title="[T](body: =&gt; T)T" id="scala.reflect.runtime;SymbolLoaders;PackageScope.syncLockSynchronized">syncLockSynchronized</a><span class="delimiter">[</span><a title="" id="scala.reflect.runtime;SymbolLoaders;PackageScope.syncLockSynchronized;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; T" id="scala.reflect.runtime;SymbolLoaders;PackageScope.syncLockSynchronized.body">body</a>: =&gt; T<span class="delimiter">)</span>: <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.syncLockSynchronized;T" title="T">T</a> = <a href="Gil.scala.html#scala.reflect.runtime;Gil.gilSynchronized" title="(body: =&gt; T)T">gilSynchronized</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.syncLockSynchronized.body" title="=&gt; T">body</a><span class="delimiter">)</span>
    private val <a title="scala.collection.mutable.HashSet[SymbolLoaders.this.Name]" id="scala.reflect.runtime;SymbolLoaders;PackageScope.negatives">negatives</a> = new mutable.<a href="../../collection/mutable/HashSet.scala.html#scala.collection.mutable;HashSet" title="scala.collection.mutable.HashSet[SymbolLoaders.this.Name]">HashSet</a><span class="delimiter">[</span>Name<span class="delimiter">]</span>
    override def <a title="(name: SymbolLoaders.this.Name)SymbolLoaders.this.ScopeEntry" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry">lookupEntry</a><span class="delimiter">(</span><a title="SymbolLoaders.this.Name" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name">name</a>: <a href="../internal/Names.scala.html#scala.reflect.internal;Names;Name" title="SymbolLoaders.this.Name">Name</a><span class="delimiter">)</span>: <a href="../internal/Scopes.scala.html#scala.reflect.internal;Scopes;ScopeEntry" title="SymbolLoaders.this.ScopeEntry">ScopeEntry</a> = <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.syncLockSynchronized" title="(body: =&gt; SymbolLoaders.this.ScopeEntry)SymbolLoaders.this.ScopeEntry">syncLockSynchronized</a> <span class="delimiter">{</span>
      val <a title="SymbolLoaders.this.ScopeEntry" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.e">e</a> = super.<a href="SynchronizedOps.scala.html#scala.reflect.runtime;SynchronizedOps;SynchronizedScope.lookupEntry" title="(name: SymbolLoaders.this.Name)SymbolLoaders.this.ScopeEntry">lookupEntry</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name" title="SymbolLoaders.this.Name">name</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.e" title="SymbolLoaders.this.ScopeEntry">e</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span>
        <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.e" title="SymbolLoaders.this.ScopeEntry">e</a>
      else if <span class="delimiter">(</span><a href="ReflectionUtils.scala.html#scala.reflect.runtime.ReflectionUtils.scalacShouldntLoadClass" title="(name: scala.reflect.internal.SymbolTable#Name)Boolean">scalacShouldntLoadClass</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name" title="SymbolLoaders.this.Name">name</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.negatives" title="=&gt; scala.collection.mutable.HashSet[SymbolLoaders.this.Name]">negatives</a> <a href="../../collection/mutable/HashSet.scala.html#scala.collection.mutable;HashSet.contains" title="(elem: SymbolLoaders.this.Name)Boolean">contains</a> <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name" title="SymbolLoaders.this.Name">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
        null
      else <span class="delimiter">{</span>
        val <a title="String" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.path">path</a> =
          if <span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.pkgClass" title="SymbolLoaders.this.Symbol">pkgClass</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.isEmptyPackageClass" title="=&gt; Boolean">isEmptyPackageClass</a><span class="delimiter">)</span> <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name" title="SymbolLoaders.this.Name">name</a>.<span title="()String">toString</span>
          else <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.pkgClass" title="SymbolLoaders.this.Symbol">pkgClass</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.fullName(3bf7c90be7)" title="=&gt; String">fullName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.&quot;)" class="string">&quot;.&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name" title="SymbolLoaders.this.Name">name</a>
        val <a title="SymbolLoaders.this.Mirror" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.currentMirror">currentMirror</a> = <a href="JavaMirrors.scala.html#scala.reflect.runtime;JavaMirrors.mirrorThatLoaded" title="(sym: SymbolLoaders.this.Symbol)SymbolLoaders.this.Mirror">mirrorThatLoaded</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.pkgClass" title="SymbolLoaders.this.Symbol">pkgClass</a><span class="delimiter">)</span>
        <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.currentMirror" title="SymbolLoaders.this.Mirror">currentMirror</a>.<a href="JavaMirrors.scala.html#scala.reflect.runtime;JavaMirrors;JavaMirror.tryJavaClass" title="(path: String)Option[Class[_]]">tryJavaClass</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.path" title="String">path</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
          case Some<span class="delimiter">(</span><a title="Class[_]" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.cls">cls</a><span class="delimiter">)</span> =&gt;
            val <a title="SymbolLoaders.this.JavaMirror" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.loadingMirror">loadingMirror</a> = <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.currentMirror" title="SymbolLoaders.this.Mirror">currentMirror</a>.<a href="JavaMirrors.scala.html#scala.reflect.runtime;JavaMirrors;JavaMirror.mirrorDefining" title="(jclazz: Class[_])SymbolLoaders.this.JavaMirror">mirrorDefining</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.cls" title="Class[_]">cls</a><span class="delimiter">)</span>
            val <a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module" class="delimiter">(</a>_, <span title="SymbolLoaders.this.Symbol">module</span><span class="delimiter">)</span> =
              if <span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.loadingMirror" title="SymbolLoaders.this.JavaMirror">loadingMirror</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.currentMirror" title="SymbolLoaders.this.Mirror">currentMirror</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#scala.reflect.runtime;SymbolLoaders.initAndEnterClassAndModule" title="(owner: SymbolLoaders.this.Symbol, name: SymbolLoaders.this.TypeName, completer: (SymbolLoaders.this.Symbol, SymbolLoaders.this.Symbol) =&gt; SymbolLoaders.this.LazyType)(SymbolLoaders.this.ClassSymbol, SymbolLoaders.this.ModuleSymbol)">initAndEnterClassAndModule</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.pkgClass" title="SymbolLoaders.this.Symbol">pkgClass</a>, <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name" title="SymbolLoaders.this.Name">name</a>.<a href="../internal/Names.scala.html#scala.reflect.internal;Names;Name.toTypeName" title="=&gt; SymbolLoaders.this.TypeName">toTypeName</a>, new <a href="#scala.reflect.runtime;SymbolLoaders;TopClassCompleter" title="SymbolLoaders.this.TopClassCompleter">TopClassCompleter</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module.$anonfun.x$2" title="SymbolLoaders.this.Symbol">_</a>, <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module.$anonfun.x$3" title="SymbolLoaders.this.Symbol">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> else <span class="delimiter">{</span>
                val <a title="SymbolLoaders.this.ModuleSymbol" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module.origOwner">origOwner</a> = <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.loadingMirror" title="SymbolLoaders.this.JavaMirror">loadingMirror</a>.<a href="JavaMirrors.scala.html#scala.reflect.runtime;JavaMirrors;JavaMirror.packageNameToScala" title="(fullname: String)SymbolLoaders.this.ModuleSymbol">packageNameToScala</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.pkgClass" title="SymbolLoaders.this.Symbol">pkgClass</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.fullName(3bf7c90be7)" title="=&gt; String">fullName</a><span class="delimiter">)</span>
                val clazz = <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module.origOwner" title="SymbolLoaders.this.ModuleSymbol">origOwner</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.info" title="=&gt; SymbolLoaders.this.Type">info</a> <a href="../internal/Types.scala.html#scala.reflect.internal;Types;Type.decl" title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module.clazz">decl</a> <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name" title="SymbolLoaders.this.Name">name</a>.<a href="../internal/Names.scala.html#scala.reflect.internal;Names;Name.toTypeName" title="=&gt; SymbolLoaders.this.TypeName">toTypeName</a>
                val module = <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module.origOwner" title="SymbolLoaders.this.ModuleSymbol">origOwner</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.info" title="=&gt; SymbolLoaders.this.Type">info</a> <a href="../internal/Types.scala.html#scala.reflect.internal;Types;Type.decl" title="SymbolLoaders.this.Symbol">decl</a> <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name" title="SymbolLoaders.this.Name">name</a>.<a href="../internal/Names.scala.html#scala.reflect.internal;Names;Name.toTermName" title="=&gt; SymbolLoaders.this.TermName">toTermName</a>
                <a href="../../Predef.scala.html#scala.Predef.assert(65d7b4917f)" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module.clazz" title="SymbolLoaders.this.Symbol">clazz</a> <span title="(x$1: Any)Boolean">!=</span> <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols.NoSymbol" title="=&gt; SymbolLoaders.this.NoSymbol">NoSymbol</a><span class="delimiter">)</span>
                <a href="../../Predef.scala.html#scala.Predef.assert(65d7b4917f)" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><span title="SymbolLoaders.this.Symbol">module</span> <span title="(x$1: Any)Boolean">!=</span> <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols.NoSymbol" title="=&gt; SymbolLoaders.this.NoSymbol">NoSymbol</a><span class="delimiter">)</span>
                <span class="comment">// currentMirror.mirrorDefining(cls) might side effect by entering symbols into pkgClass.info.decls</span>
                <span class="comment">// therefore, even though in the beginning of this method, super.lookupEntry(name) returned null</span>
                <span class="comment">// entering clazz/module now will result in a double-enter assertion in PackageScope.enter</span>
                <span class="comment">// here's how it might happen</span>
                <span class="comment">// 1) we are the rootMirror</span>
                <span class="comment">// 2) cls.getClassLoader is different from our classloader</span>
                <span class="comment">// 3) mirrorDefining(cls) looks up a mirror corresponding to that classloader and cannot find it</span>
                <span class="comment">// 4) mirrorDefining creates a new mirror</span>
                <span class="comment">// 5) that triggers Mirror.init() of the new mirror</span>
                <span class="comment">// 6) that triggers definitions.syntheticCoreClasses</span>
                <span class="comment">// 7) that might materialize symbols and enter them into our scope (because syntheticCoreClasses live in rootMirror)</span>
                <span class="comment">// 8) now we come back here and try to enter one of the now entered symbols =&gt; BAM!</span>
                <span class="comment">// therefore we use enterIfNew rather than just enter</span>
                <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew" title="(sym: SymbolLoaders.this.Symbol)SymbolLoaders.this.Symbol">enterIfNew</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module.clazz" title="SymbolLoaders.this.Symbol">clazz</a><span class="delimiter">)</span>
                <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.enterIfNew" title="(sym: SymbolLoaders.this.Symbol)SymbolLoaders.this.Symbol">enterIfNew</a><span class="delimiter">(</span><span title="SymbolLoaders.this.Symbol">module</span><span class="delimiter">)</span>
                <a href="../../Tuple2.scala.html#scala;Tuple2" title="(_1: SymbolLoaders.this.Symbol, _2: SymbolLoaders.this.Symbol)(SymbolLoaders.this.Symbol, SymbolLoaders.this.Symbol)" class="delimiter">(</a><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module.clazz" title="SymbolLoaders.this.Symbol">clazz</a>, <span title="SymbolLoaders.this.Symbol">module</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <a href="SymbolTable.scala.html#scala.reflect.runtime;SymbolTable.debugInfo" title="(msg: =&gt; String)Unit">debugInfo</a><span class="delimiter">(</span><a href="../../StringContext.scala.html#scala;StringContext.s" title="(args: Any*)String">s</a>&quot;<span title="String(&quot;created &quot;)">created $</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module" title="SymbolLoaders.this.Symbol">module</a><span title="String(&quot;/&quot;)">/$</span><span class="delimiter">{</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.module" title="SymbolLoaders.this.Symbol">module</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.moduleClass" title="=&gt; SymbolLoaders.this.Symbol">moduleClass</a><span class="delimiter">}</span><span title="String(&quot; in &quot;)"> in $</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.pkgClass" title="SymbolLoaders.this.Symbol">pkgClass</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
            <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry" title="(name: SymbolLoaders.this.Name)SymbolLoaders.this.ScopeEntry">lookupEntry</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name" title="SymbolLoaders.this.Name">name</a><span class="delimiter">)</span>
          case <a title="Option[Class[_]]" id="scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.none">none</a> =&gt;
            <a href="SymbolTable.scala.html#scala.reflect.runtime;SymbolTable.debugInfo" title="(msg: =&gt; String)Unit">debugInfo</a><span class="delimiter">(</span><span title="String(&quot;*** not found : &quot;)" class="string">&quot;*** not found : &quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.path" title="String">path</a><span class="delimiter">)</span>
            <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.negatives" title="=&gt; scala.collection.mutable.HashSet[SymbolLoaders.this.Name]">negatives</a> <a href="../../collection/mutable/HashSet.scala.html#scala.collection.mutable;HashSet.+=(53f2a8289f)" title="(elem: SymbolLoaders.this.Name)PackageScope.this.negatives.type">+=</a> <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope.lookupEntry.name" title="SymbolLoaders.this.Name">name</a>
            null
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Assert that packages have package scopes */</span>
  override def <a title="(tp: SymbolLoaders.this.ClassInfoType)Unit" id="scala.reflect.runtime;SymbolLoaders.validateClassInfo">validateClassInfo</a><span class="delimiter">(</span><a title="SymbolLoaders.this.ClassInfoType" id="scala.reflect.runtime;SymbolLoaders.validateClassInfo.tp">tp</a>: <a href="../internal/Types.scala.html#scala.reflect.internal;Types;ClassInfoType" title="SymbolLoaders.this.ClassInfoType">ClassInfoType</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="../../Predef.scala.html#scala.Predef.assert(65d7b4917f)" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.reflect.runtime;SymbolLoaders.validateClassInfo.tp" title="SymbolLoaders.this.ClassInfoType">tp</a>.<a href="../internal/Types.scala.html#scala.reflect.internal;Types;ClassInfoType.typeSymbol" title="=&gt; SymbolLoaders.this.Symbol">typeSymbol</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.isPackageClass" title="=&gt; Boolean">isPackageClass</a> <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="#scala.reflect.runtime;SymbolLoaders.validateClassInfo.tp" title="SymbolLoaders.this.ClassInfoType">tp</a>.<a href="../internal/Types.scala.html#scala.reflect.internal;Types;ClassInfoType.decls" title="=&gt; SymbolLoaders.this.Scope">decls</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="#scala.reflect.runtime;SymbolLoaders;PackageScope" title="SymbolLoaders.this.PackageScope">PackageScope</a><span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="(pkgClass: SymbolLoaders.this.Symbol)SymbolLoaders.this.PackageScope" id="scala.reflect.runtime;SymbolLoaders.newPackageScope">newPackageScope</a><span class="delimiter">(</span><a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders.newPackageScope.pkgClass">pkgClass</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a><span class="delimiter">)</span> = new <a href="#scala.reflect.runtime;SymbolLoaders;PackageScope" title="SymbolLoaders.this.PackageScope">PackageScope</a><span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.newPackageScope.pkgClass" title="SymbolLoaders.this.Symbol">pkgClass</a><span class="delimiter">)</span>

  override def <a title="(owner: SymbolLoaders.this.Symbol)(op: =&gt; SymbolLoaders.this.Scope)SymbolLoaders.this.Scope" id="scala.reflect.runtime;SymbolLoaders.scopeTransform">scopeTransform</a><span class="delimiter">(</span><a title="SymbolLoaders.this.Symbol" id="scala.reflect.runtime;SymbolLoaders.scopeTransform.owner">owner</a>: <a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="SymbolLoaders.this.Symbol">Symbol</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; SymbolLoaders.this.Scope" id="scala.reflect.runtime;SymbolLoaders.scopeTransform.op">op</a>: =&gt; Scope<span class="delimiter">)</span>: <a href="../internal/Scopes.scala.html#scala.reflect.internal;Scopes;Scope" title="SymbolLoaders.this.Scope">Scope</a> =
    if <span class="delimiter">(</span><a href="#scala.reflect.runtime;SymbolLoaders.scopeTransform.owner" title="SymbolLoaders.this.Symbol">owner</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.isPackageClass" title="=&gt; Boolean">isPackageClass</a><span class="delimiter">)</span> <a href="#scala.reflect.runtime;SymbolLoaders.scopeTransform.owner" title="SymbolLoaders.this.Symbol">owner</a>.<a href="../internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.info" title="=&gt; SymbolLoaders.this.Type">info</a>.<a href="../internal/Types.scala.html#scala.reflect.internal;Types;Type.decls" title="=&gt; SymbolLoaders.this.Scope">decls</a> else <a href="#scala.reflect.runtime;SymbolLoaders.scopeTransform.op" title="=&gt; SymbolLoaders.this.Scope">op</a>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

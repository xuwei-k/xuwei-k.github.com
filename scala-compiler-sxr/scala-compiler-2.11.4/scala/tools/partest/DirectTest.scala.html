<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scala/tools/partest/DirectTest.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2013 LAMP/EPFL
 * @author Paul Phillips
 */</span>

package scala.tools.partest

import scala.tools.nsc._
import settings.ScalaVersion
import scala.reflect.internal.util.<span class="delimiter">{</span> SourceFile, BatchSourceFile <span class="delimiter">}</span>
import reporters.<span class="delimiter">{</span>Reporter, ConsoleReporter<span class="delimiter">}</span>
import scala.tools.cmd.CommandLineParser

<span class="comment">/** A class for testing code which is embedded as a string.
 *  It allows for more complete control over settings, compiler
 *  configuration, sequence of events, etc. than does partest.
 */</span>
abstract class <a title="class DirectTest extends AnyRef with App" id="scala.tools.partest;DirectTest">DirectTest</a> extends <a href="../../App.scala.html#scala;App" title="App">App</a> <span class="delimiter">{</span>
  <span class="comment">// The program being tested in some fashion</span>
  def <a title="=&gt; String" id="scala.tools.partest;DirectTest.code">code</a>: <span title="String">String</span>
  <span class="comment">// produce the output to be compared against a checkfile</span>
  def <a title="()Unit" id="scala.tools.partest;DirectTest.show">show</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#scala;Unit" title="Unit">Unit</a>

  <span class="comment">// the test file or dir, and output directory</span>
  def <a title="=&gt; scala.reflect.io.File" id="scala.tools.partest;DirectTest.testPath">testPath</a>   = <a href="../../reflect/io/File.scala.html#scala.reflect.io.File.apply" title="(path: scala.reflect.io.Path)(implicit codec: scala.io.Codec)scala.reflect.io.File">SFile</a><a href="package.scala.html#scala.tools.partest.package.codec" title="=&gt; scala.io.Codec" class="delimiter">(</a>sys.<a href="../../collection/MapLike.scala.html#scala.collection;MapLike.apply" title="(key: String)String">props</a><a href="../../reflect/io/Path.scala.html#scala.reflect.io.Path.string2path" title="implicit scala.reflect.io.Path.string2path : (s: String)scala.reflect.io.Path" class="delimiter">(</a><span title="String(&quot;partest.test-path&quot;)" class="string">&quot;partest.test-path&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  def <a title="=&gt; scala.reflect.io.Directory" id="scala.tools.partest;DirectTest.testOutput">testOutput</a> = <a href="../../reflect/io/Directory.scala.html#scala.reflect.io.Directory.apply" title="(path: scala.reflect.io.Path)scala.reflect.io.Directory">Directory</a><span class="delimiter">(</span>sys.<a href="../../collection/MapLike.scala.html#scala.collection;MapLike.apply" title="(key: String)String">props</a><a href="../../reflect/io/Path.scala.html#scala.reflect.io.Path.string2path" title="implicit scala.reflect.io.Path.string2path : (s: String)scala.reflect.io.Path" class="delimiter">(</a><span title="String(&quot;partest.output&quot;)" class="string">&quot;partest.output&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">// override to add additional settings with strings</span>
  def <a title="=&gt; String" id="scala.tools.partest;DirectTest.extraSettings">extraSettings</a>: <span title="String">String</span> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
  <span class="comment">// a default Settings object</span>
  def <a title="=&gt; scala.tools.nsc.Settings" id="scala.tools.partest;DirectTest.settings">settings</a>: <a href="../nsc/Settings.scala.html#scala.tools.nsc;Settings" title="scala.tools.nsc.Settings">Settings</a> = <a href="#scala.tools.partest;DirectTest.newSettings" title="(args: List[String])scala.tools.nsc.Settings">newSettings</a><span class="delimiter">(</span><a href="../cmd/CommandLineParser.scala.html#scala.tools.cmd.CommandLineParser" title="scala.tools.cmd.CommandLineParser.type">CommandLineParser</a> <a href="../cmd/CommandLineParser.scala.html#scala.tools.cmd.CommandLineParser.tokenize(124e6ae60f)" title="(line: String)List[String]">tokenize</a> <a href="#scala.tools.partest;DirectTest.extraSettings" title="=&gt; String">extraSettings</a><span class="delimiter">)</span>
  <span class="comment">// a custom Settings object</span>
  def <a title="(args: List[String])scala.tools.nsc.Settings" id="scala.tools.partest;DirectTest.newSettings">newSettings</a><span class="delimiter">(</span><a title="List[String]" id="scala.tools.partest;DirectTest.newSettings.args">args</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[String]">List</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    val <a title="scala.tools.nsc.Settings" id="scala.tools.partest;DirectTest.newSettings.s">s</a> = new <a href="../nsc/Settings.scala.html#scala.tools.nsc;Settings" title="scala.tools.nsc.Settings">Settings</a>
    val allArgs = <a href="#scala.tools.partest;DirectTest.newSettings.args" title="List[String]">args</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.++" title="List[String]" id="scala.tools.partest;DirectTest.newSettings.allArgs">++</a> <span class="delimiter">(</span><a href="../cmd/CommandLineParser.scala.html#scala.tools.cmd.CommandLineParser" title="scala.tools.cmd.CommandLineParser.type">CommandLineParser</a> <a href="../cmd/CommandLineParser.scala.html#scala.tools.cmd.CommandLineParser.tokenize(124e6ae60f)" title="(line: String)List[String]">tokenize</a> <a href="#scala.tools.partest;DirectTest.debugSettings" title="=&gt; String">debugSettings</a><span class="delimiter">)</span>
    <a href="#scala.tools.partest;DirectTest.log" title="(msg: =&gt; Any)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;newSettings: allArgs = &quot;)" class="string">&quot;newSettings: allArgs = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.partest;DirectTest.newSettings.allArgs" title="List[String]">allArgs</a><span class="delimiter">)</span>
    <a href="#scala.tools.partest;DirectTest.newSettings.s" title="scala.tools.nsc.Settings">s</a> <a href="../nsc/settings/MutableSettings.scala.html#scala.tools.nsc.settings;MutableSettings.processArguments" title="(arguments: List[String], processAll: Boolean)(Boolean, List[String])">processArguments</a> <span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.newSettings.allArgs" title="List[String]">allArgs</a>, true<span class="delimiter">)</span>
    <a href="#scala.tools.partest;DirectTest.newSettings.s" title="scala.tools.nsc.Settings">s</a>
  <span class="delimiter">}</span>
  <span class="comment">// new compiler</span>
  def <a title="(args: String*)scala.tools.nsc.Global" id="scala.tools.partest;DirectTest.newCompiler(36c1b0e7cb)">newCompiler</a><span class="delimiter">(</span><a title="String*" id="scala.tools.partest;DirectTest.newCompiler(36c1b0e7cb).args">args</a>: <span title="String*">String</span>*<span class="delimiter">)</span>: <a href="../nsc/Global.scala.html#scala.tools.nsc;Global" title="scala.tools.nsc.Global">Global</a> = <span class="delimiter">{</span>
    val <a title="scala.tools.nsc.Settings" id="scala.tools.partest;DirectTest.newCompiler(36c1b0e7cb).settings">settings</a> = <a href="#scala.tools.partest;DirectTest.newSettings" title="(args: List[String])scala.tools.nsc.Settings">newSettings</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="../cmd/CommandLineParser.scala.html#scala.tools.cmd.CommandLineParser" title="scala.tools.cmd.CommandLineParser.type">CommandLineParser</a> <a href="../cmd/CommandLineParser.scala.html#scala.tools.cmd.CommandLineParser.tokenize(124e6ae60f)" title="(line: String)List[String]">tokenize</a> <span class="delimiter">(</span><span title="String(&quot;-d \&quot;&quot;)" class="string">&quot;-d \&quot;&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.partest;DirectTest.testOutput" title="=&gt; scala.reflect.io.Directory">testOutput</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.path" title="=&gt; String">path</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\&quot; &quot;)" class="string">&quot;\&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.partest;DirectTest.extraSettings" title="=&gt; String">extraSettings</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.++" title="(that: scala.collection.GenTraversableOnce[String])(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">++</a> <a href="#scala.tools.partest;DirectTest.newCompiler(36c1b0e7cb).args" title="String*">args</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[String]">toList</a><span class="delimiter">)</span>
    <a href="#scala.tools.partest;DirectTest.newCompiler(cffc607a20)" title="(settings: scala.tools.nsc.Settings)scala.tools.nsc.Global">newCompiler</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.newCompiler(36c1b0e7cb).settings" title="scala.tools.nsc.Settings">settings</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(settings: scala.tools.nsc.Settings)scala.tools.nsc.Global" id="scala.tools.partest;DirectTest.newCompiler(cffc607a20)">newCompiler</a><span class="delimiter">(</span><a title="scala.tools.nsc.Settings" id="scala.tools.partest;DirectTest.newCompiler(cffc607a20).settings">settings</a>: <a href="../nsc/Settings.scala.html#scala.tools.nsc;Settings" title="scala.tools.nsc.Settings">Settings</a><span class="delimiter">)</span>: <a href="../nsc/Global.scala.html#scala.tools.nsc;Global" title="scala.tools.nsc.Global">Global</a> = <a href="../nsc/Global.scala.html#scala.tools.nsc.Global.apply" title="(settings: scala.tools.nsc.Settings, reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global">Global</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.newCompiler(cffc607a20).settings" title="scala.tools.nsc.Settings">settings</a>, <a href="#scala.tools.partest;DirectTest.reporter" title="(settings: scala.tools.nsc.Settings)scala.tools.nsc.reporters.Reporter">reporter</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.newCompiler(cffc607a20).settings" title="scala.tools.nsc.Settings">settings</a><span class="delimiter">)</span><span class="delimiter">)</span>

  def <a title="(settings: scala.tools.nsc.Settings)scala.tools.nsc.reporters.Reporter" id="scala.tools.partest;DirectTest.reporter">reporter</a><span class="delimiter">(</span><a title="scala.tools.nsc.Settings" id="scala.tools.partest;DirectTest.reporter.settings">settings</a>: <a href="../nsc/Settings.scala.html#scala.tools.nsc;Settings" title="scala.tools.nsc.Settings">Settings</a><span class="delimiter">)</span>: <a href="../nsc/reporters/Reporter.scala.html#scala.tools.nsc.reporters;Reporter" title="scala.tools.nsc.reporters.Reporter">Reporter</a> = new <a href="../nsc/reporters/ConsoleReporter.scala.html#scala.tools.nsc.reporters;ConsoleReporter" title="scala.tools.nsc.reporters.ConsoleReporter">ConsoleReporter</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.reporter.settings" title="scala.tools.nsc.Settings">settings</a><span class="delimiter">)</span>

  private def <a title="(ext: String)(codes: String*)List[scala.reflect.internal.util.BatchSourceFile]" id="scala.tools.partest;DirectTest.newSourcesWithExtension">newSourcesWithExtension</a><span class="delimiter">(</span><a title="String" id="scala.tools.partest;DirectTest.newSourcesWithExtension.ext">ext</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="String*" id="scala.tools.partest;DirectTest.newSourcesWithExtension.codes">codes</a>: <span title="String*">String</span>*<span class="delimiter">)</span>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[scala.reflect.internal.util.BatchSourceFile]">List</a><span class="delimiter">[</span>BatchSourceFile<span class="delimiter">]</span> =
    <a href="#scala.tools.partest;DirectTest.newSourcesWithExtension.codes" title="String*">codes</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[String]">toList</a>.<a href="../../collection/IterableLike.scala.html#scala.collection;IterableLike.zipWithIndex" title="(implicit bf: scala.collection.generic.CanBuildFrom[List[String],(String, Int),List[(String, Int)]])List[(String, Int)]">zipWithIndex</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: ((String, Int)) =&gt; scala.reflect.internal.util.BatchSourceFile)(implicit bf: scala.collection.generic.CanBuildFrom[List[(String, Int)],scala.reflect.internal.util.BatchSourceFile,List[scala.reflect.internal.util.BatchSourceFile]])List[scala.reflect.internal.util.BatchSourceFile]">map</a> <a href="#scala.tools.partest;DirectTest.newSourcesWithExtension.$anonfun.x0$1" title="scala.reflect.internal.util.BatchSourceFile" class="delimiter">{</a>
      case <span class="delimiter">(</span><a title="String" id="scala.tools.partest;DirectTest.newSourcesWithExtension.$anonfun.src">src</a>, <a title="Int" id="scala.tools.partest;DirectTest.newSourcesWithExtension.$anonfun.idx">idx</a><span class="delimiter">)</span> =&gt; new <a href="../../reflect/internal/util/SourceFile.scala.html#scala.reflect.internal.util;BatchSourceFile" title="scala.reflect.internal.util.BatchSourceFile">BatchSourceFile</a><span class="delimiter">(</span><a href="../../StringContext.scala.html#scala;StringContext.s" title="(args: Any*)String">s</a>&quot;<span title="String(&quot;newSource&quot;)">newSource$</span><span class="delimiter">{</span><a href="#scala.tools.partest;DirectTest.newSourcesWithExtension.$anonfun.idx" title="Int">idx</a> <a href="../../Int.scala.html#scala;Int.+(1409840560)" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">}</span><span title="String(&quot;.&quot;)">.$</span><a href="#scala.tools.partest;DirectTest.newSourcesWithExtension.ext" title="String">ext</a><span title="String(&quot;&quot;)" class="string">&quot;</span>, <a href="../../Predef.scala.html#scala;LowPriorityImplicits.wrapString" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString">src</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  def <a title="(codes: String*)List[scala.reflect.internal.util.BatchSourceFile]" id="scala.tools.partest;DirectTest.newJavaSources">newJavaSources</a><span class="delimiter">(</span><a title="String*" id="scala.tools.partest;DirectTest.newJavaSources.codes">codes</a>: <span title="String*">String</span>*<span class="delimiter">)</span> = <a href="#scala.tools.partest;DirectTest.newSourcesWithExtension" title="(ext: String)(codes: String*)List[scala.reflect.internal.util.BatchSourceFile]">newSourcesWithExtension</a><span class="delimiter">(</span><span title="String(&quot;java&quot;)" class="string">&quot;java&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.newJavaSources.codes" title="String*">codes</a>: _*<span class="delimiter">)</span>
  def <a title="(codes: String*)List[scala.reflect.internal.util.BatchSourceFile]" id="scala.tools.partest;DirectTest.newSources">newSources</a><span class="delimiter">(</span><a title="String*" id="scala.tools.partest;DirectTest.newSources.codes">codes</a>: <span title="String*">String</span>*<span class="delimiter">)</span>     = <a href="#scala.tools.partest;DirectTest.newSourcesWithExtension" title="(ext: String)(codes: String*)List[scala.reflect.internal.util.BatchSourceFile]">newSourcesWithExtension</a><span class="delimiter">(</span><span title="String(&quot;scala&quot;)" class="string">&quot;scala&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.newSources.codes" title="String*">codes</a>: _*<span class="delimiter">)</span>

  def <a title="(global: scala.tools.nsc.Global)(sourceCode: String)Boolean" id="scala.tools.partest;DirectTest.compileString">compileString</a><span class="delimiter">(</span><a title="scala.tools.nsc.Global" id="scala.tools.partest;DirectTest.compileString.global">global</a>: <a href="../nsc/Global.scala.html#scala.tools.nsc;Global" title="scala.tools.nsc.Global">Global</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="String" id="scala.tools.partest;DirectTest.compileString.sourceCode">sourceCode</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
    <a href="#scala.tools.partest;DirectTest.withRun" title="(global: scala.tools.nsc.Global)(f: global.Run =&gt; Unit)Unit">withRun</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.compileString.global" title="scala.tools.nsc.Global">global</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.compileString.$anonfun.x$1" title="global.Run">_</a> <a href="../nsc/Global.scala.html#scala.tools.nsc;Global;Run.compileSources" title="(sources: List[scala.reflect.internal.util.SourceFile])Unit">compileSources</a> <a href="#scala.tools.partest;DirectTest.newSources" title="(codes: String*)List[scala.reflect.internal.util.BatchSourceFile]">newSources</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.compileString.sourceCode" title="String">sourceCode</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.partest;DirectTest.compileString.global" title="scala.tools.nsc.Global">global</a>.<a href="../nsc/Global.scala.html#scala.tools.nsc;Global.reporter" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="../nsc/reporters/Reporter.scala.html#scala.tools.nsc.reporters;Reporter.hasErrors" title="=&gt; Boolean">hasErrors</a>
  <span class="delimiter">}</span>

  def <a title="(global: scala.tools.nsc.Global)(sourceCodes: String*)List[global.CompilationUnit]" id="scala.tools.partest;DirectTest.javaCompilationUnits">javaCompilationUnits</a><span class="delimiter">(</span><a title="scala.tools.nsc.Global" id="scala.tools.partest;DirectTest.javaCompilationUnits.global">global</a>: <a href="../nsc/Global.scala.html#scala.tools.nsc;Global" title="scala.tools.nsc.Global">Global</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="String*" id="scala.tools.partest;DirectTest.javaCompilationUnits.sourceCodes">sourceCodes</a>: <span title="String*">String</span>*<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#scala.tools.partest;DirectTest.sourceFilesToCompiledUnits" title="(global: scala.tools.nsc.Global)(files: List[scala.reflect.internal.util.SourceFile])List[global.CompilationUnit]">sourceFilesToCompiledUnits</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.javaCompilationUnits.global" title="scala.tools.nsc.Global">global</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.newJavaSources" title="(codes: String*)List[scala.reflect.internal.util.BatchSourceFile]">newJavaSources</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.javaCompilationUnits.sourceCodes" title="String*">sourceCodes</a>: _*<span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(global: scala.tools.nsc.Global)(files: List[scala.reflect.internal.util.SourceFile])List[global.CompilationUnit]" id="scala.tools.partest;DirectTest.sourceFilesToCompiledUnits">sourceFilesToCompiledUnits</a><span class="delimiter">(</span><a title="scala.tools.nsc.Global" id="scala.tools.partest;DirectTest.sourceFilesToCompiledUnits.global">global</a>: <a href="../nsc/Global.scala.html#scala.tools.nsc;Global" title="scala.tools.nsc.Global">Global</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="List[scala.reflect.internal.util.SourceFile]" id="scala.tools.partest;DirectTest.sourceFilesToCompiledUnits.files">files</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[scala.reflect.internal.util.SourceFile]">List</a><span class="delimiter">[</span>SourceFile<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#scala.tools.partest;DirectTest.withRun" title="(global: scala.tools.nsc.Global)(f: global.Run =&gt; List[global.CompilationUnit])List[global.CompilationUnit]">withRun</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.sourceFilesToCompiledUnits.global" title="scala.tools.nsc.Global">global</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="global.Run" id="scala.tools.partest;DirectTest.sourceFilesToCompiledUnits.$anonfun.run">run</a> =&gt;
      <a href="#scala.tools.partest;DirectTest.sourceFilesToCompiledUnits.$anonfun.run" title="global.Run">run</a> <a href="../nsc/Global.scala.html#scala.tools.nsc;Global;Run.compileSources" title="(sources: List[scala.reflect.internal.util.SourceFile])Unit">compileSources</a> <a href="#scala.tools.partest;DirectTest.sourceFilesToCompiledUnits.files" title="List[scala.reflect.internal.util.SourceFile]">files</a>
      <a href="#scala.tools.partest;DirectTest.sourceFilesToCompiledUnits.$anonfun.run" title="global.Run">run</a>.<a href="../nsc/Global.scala.html#scala.tools.nsc;Global;Run.units" title="=&gt; Iterator[global.CompilationUnit]">units</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[global.CompilationUnit]">toList</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(global: scala.tools.nsc.Global)(sourceCodes: String*)List[global.CompilationUnit]" id="scala.tools.partest;DirectTest.compilationUnits">compilationUnits</a><span class="delimiter">(</span><a title="scala.tools.nsc.Global" id="scala.tools.partest;DirectTest.compilationUnits.global">global</a>: <a href="../nsc/Global.scala.html#scala.tools.nsc;Global" title="scala.tools.nsc.Global">Global</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="String*" id="scala.tools.partest;DirectTest.compilationUnits.sourceCodes">sourceCodes</a>: <span title="String*">String</span>*<span class="delimiter">)</span>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[global.CompilationUnit]">List</a><span class="delimiter">[</span>global.CompilationUnit<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="List[global.CompilationUnit]" id="scala.tools.partest;DirectTest.compilationUnits.units">units</a> = <a href="#scala.tools.partest;DirectTest.sourceFilesToCompiledUnits" title="(global: scala.tools.nsc.Global)(files: List[scala.reflect.internal.util.SourceFile])List[global.CompilationUnit]">sourceFilesToCompiledUnits</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.compilationUnits.global" title="scala.tools.nsc.Global">global</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.newSources" title="(codes: String*)List[scala.reflect.internal.util.BatchSourceFile]">newSources</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.compilationUnits.sourceCodes" title="String*">sourceCodes</a>: _*<span class="delimiter">)</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.compilationUnits.global" title="scala.tools.nsc.Global">global</a>.<a href="../nsc/Global.scala.html#scala.tools.nsc;Global.reporter" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="../nsc/reporters/Reporter.scala.html#scala.tools.nsc.reporters;Reporter.hasErrors" title="=&gt; Boolean">hasErrors</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#scala.tools.partest;DirectTest.compilationUnits.global" title="scala.tools.nsc.Global">global</a>.<a href="../nsc/Global.scala.html#scala.tools.nsc;Global.reporter" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="../../reflect/internal/Reporting.scala.html#scala.reflect.internal;Reporter.flush" title="()Unit">flush</a><span class="delimiter">(</span><span class="delimiter">)</span>
      sys.<a href="../../sys/package.scala.html#scala.sys.package.error" title="(message: String)Nothing">error</a><span class="delimiter">(</span><span title="String(&quot;Compilation failure.&quot;)" class="string">&quot;Compilation failure.&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#scala.tools.partest;DirectTest.compilationUnits.units" title="List[global.CompilationUnit]">units</a>
  <span class="delimiter">}</span>

  def <a title="[T](global: scala.tools.nsc.Global)(f: global.Run =&gt; T)T" id="scala.tools.partest;DirectTest.withRun">withRun</a><span class="delimiter">[</span><a title="" id="scala.tools.partest;DirectTest.withRun;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.tools.nsc.Global" id="scala.tools.partest;DirectTest.withRun.global">global</a>: <a href="../nsc/Global.scala.html#scala.tools.nsc;Global" title="scala.tools.nsc.Global">Global</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="global.Run =&gt; T" id="scala.tools.partest;DirectTest.withRun.f">f</a>: global.Run =&gt; T<span class="delimiter">)</span>: <a href="#scala.tools.partest;DirectTest.withRun;T" title="T">T</a> = <span class="delimiter">{</span>
    <a href="#scala.tools.partest;DirectTest.withRun.global" title="scala.tools.nsc.Global">global</a>.<a href="../nsc/Global.scala.html#scala.tools.nsc;Global.reporter" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="../nsc/reporters/Reporter.scala.html#scala.tools.nsc.reporters;Reporter.reset" title="()Unit">reset</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="../../Function1.scala.html#scala;Function1.apply" title="(v1: global.Run)T">f</a><span class="delimiter">(</span>new <a href="#scala.tools.partest;DirectTest.withRun.global" title="scala.tools.nsc.Global">global</a>.<a href="../nsc/Global.scala.html#scala.tools.nsc;Global;Run" title="global.Run">Run</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">// compile the code, optionally first adding to the settings</span>
  def <a title="(args: String*)Boolean" id="scala.tools.partest;DirectTest.compile">compile</a><span class="delimiter">(</span><a title="String*" id="scala.tools.partest;DirectTest.compile.args">args</a>: <span title="String*">String</span>*<span class="delimiter">)</span> = <a href="#scala.tools.partest;DirectTest.compileString" title="(global: scala.tools.nsc.Global)(sourceCode: String)Boolean">compileString</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.newCompiler(36c1b0e7cb)" title="(args: String*)scala.tools.nsc.Global">newCompiler</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.compile.args" title="String*">args</a>: _*<span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.code" title="=&gt; String">code</a><span class="delimiter">)</span>

  <span class="comment">/**  Constructor/main body  **/</span>
  try <a href="#scala.tools.partest;DirectTest.show" title="()Unit">show</a><span class="delimiter">(</span><span class="delimiter">)</span>
  catch <span class="delimiter">{</span> case <a title="Exception" id="scala.tools.partest;DirectTest.<local DirectTest>.t">t</a>: <span title="Exception">Exception</span> =&gt; <a href="../../Predef.scala.html#scala.Predef.println(b0c81b2e65)" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.<local DirectTest>.t" title="Exception">t</a>.<span title="()String">getMessage</span><span class="delimiter">)</span> ; <a href="#scala.tools.partest;DirectTest.<local DirectTest>.t" title="Exception">t</a>.<span title="()Unit">printStackTrace</span> ; sys.<a href="../../sys/package.scala.html#scala.sys.package.exit(5279cf6f06)" title="(status: Int)Nothing">exit</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">}</span>

  <span class="comment">/** Debugger interest only below this line **/</span>
  protected def <a title="=&gt; Boolean" id="scala.tools.partest;DirectTest.isDebug">isDebug</a>       = <span class="delimiter">(</span>sys.<a href="../../sys/package.scala.html#scala.sys.package.props" title="=&gt; scala.sys.SystemProperties">props</a> <a href="../../sys/SystemProperties.scala.html#scala.sys;SystemProperties.contains" title="(key: String)Boolean">contains</a> <span title="String(&quot;partest.debug&quot;)" class="string">&quot;partest.debug&quot;</span><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span>sys.<a href="../../sys/package.scala.html#scala.sys.package.env" title="=&gt; scala.collection.immutable.Map[String,String]">env</a> <a href="../../collection/MapLike.scala.html#scala.collection;MapLike.contains" title="(key: String)Boolean">contains</a> <span title="String(&quot;PARTEST_DEBUG&quot;)" class="string">&quot;PARTEST_DEBUG&quot;</span><span class="delimiter">)</span>
  protected def <a title="=&gt; String" id="scala.tools.partest;DirectTest.debugSettings">debugSettings</a> = sys.<a href="../../sys/package.scala.html#scala.sys.package.props" title="=&gt; scala.sys.SystemProperties">props</a>.<a href="../../collection/MapLike.scala.html#scala.collection;MapLike.getOrElse" title="(key: String, default: =&gt; String)String">getOrElse</a><span class="delimiter">(</span><span title="String(&quot;partest.debug.settings&quot;)" class="string">&quot;partest.debug.settings&quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>

  final def <a title="(msg: =&gt; Any)Unit" id="scala.tools.partest;DirectTest.log">log</a><span class="delimiter">(</span><a title="=&gt; Any" id="scala.tools.partest;DirectTest.log.msg">msg</a>: =&gt; Any<span class="delimiter">)</span> <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.isDebug" title="=&gt; Boolean">isDebug</a><span class="delimiter">)</span> <a href="../../Console.scala.html#scala.Console" title="Console.type">Console</a>.<a href="../../Console.scala.html#scala.Console.err" title="=&gt; java.io.PrintStream">err</a> <span title="(x$1: Any)Unit">println</span> <a href="#scala.tools.partest;DirectTest.log.msg" title="=&gt; Any">msg</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Run a test only if the current java version is at least the version specified.
   */</span>
  def <a title="[A](version: String)(yesRun: =&gt; A)DirectTest.this.TestUnderJavaAtLeast[A]" id="scala.tools.partest;DirectTest.testUnderJavaAtLeast">testUnderJavaAtLeast</a><span class="delimiter">[</span><a title="" id="scala.tools.partest;DirectTest.testUnderJavaAtLeast;A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="scala.tools.partest;DirectTest.testUnderJavaAtLeast.version">version</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; A" id="scala.tools.partest;DirectTest.testUnderJavaAtLeast.yesRun">yesRun</a>: =&gt;A<span class="delimiter">)</span> = new <a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast" title="DirectTest.this.TestUnderJavaAtLeast[A]">TestUnderJavaAtLeast</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest.testUnderJavaAtLeast.version" title="String">version</a>, <span class="delimiter">{</span> <a href="#scala.tools.partest;DirectTest.testUnderJavaAtLeast.yesRun" title="=&gt; A">yesRun</a> <span class="delimiter">}</span><span class="delimiter">)</span>

  class <a title="class TestUnderJavaAtLeast[A] extends AnyRef" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast">TestUnderJavaAtLeast</a><span class="delimiter">[</span><a title="" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast;A">A</a><span class="delimiter">]</span><a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast" title="DirectTest.this.TestUnderJavaAtLeast[A]" class="delimiter">(</a><a title="String" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast.version">version</a>: <span title="String">String</span>, <a title="=&gt; A" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast.yesRun">yesRun</a>: =&gt; A<span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="String" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast.javaVersion">javaVersion</a> = <span title="System.type">System</span>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;java.specification.version&quot;)" class="string">&quot;java.specification.version&quot;</span><span class="delimiter">)</span>

    <span class="comment">// the &quot;ScalaVersion&quot; class parses Java specification versions just fine</span>
    val <a title="scala.tools.nsc.settings.ScalaVersion" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast.requiredJavaVersion">requiredJavaVersion</a> = <a href="../nsc/settings/ScalaVersion.scala.html#scala.tools.nsc.settings.ScalaVersion.apply(0eebc9c633)" title="(versionString: String)scala.tools.nsc.settings.ScalaVersion">ScalaVersion</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.version" title="String">version</a><span class="delimiter">)</span>
    val <a title="scala.tools.nsc.settings.ScalaVersion" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast.executingJavaVersion">executingJavaVersion</a> = <a href="../nsc/settings/ScalaVersion.scala.html#scala.tools.nsc.settings.ScalaVersion.apply(0eebc9c633)" title="(versionString: String)scala.tools.nsc.settings.ScalaVersion">ScalaVersion</a><span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.javaVersion" title="=&gt; String">javaVersion</a><span class="delimiter">)</span>
    val shouldRun = <a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.executingJavaVersion" title="=&gt; scala.tools.nsc.settings.ScalaVersion">executingJavaVersion</a> <a href="../../math/Ordered.scala.html#scala.math;Ordered.>=" title="Boolean" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast.shouldRun">&gt;=</a> <a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.requiredJavaVersion" title="=&gt; scala.tools.nsc.settings.ScalaVersion">requiredJavaVersion</a>
    val <a title="String" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast.preamble">preamble</a> = if <span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.shouldRun" title="=&gt; Boolean">shouldRun</a><span class="delimiter">)</span> <span title="String(&quot;Attempting&quot;)" class="string">&quot;Attempting&quot;</span> else <span title="String(&quot;Doing fallback for&quot;)" class="string">&quot;Doing fallback for&quot;</span>

    def <a title="()Unit" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast.logInfo">logInfo</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#scala.tools.partest;DirectTest.log" title="(msg: =&gt; Any)Unit">log</a><span class="delimiter">(</span><a href="../../StringContext.scala.html#scala;StringContext.s" title="(args: Any*)String">s</a>&quot;<span title="String(&quot;&quot;)">$</span><a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.preamble" title="=&gt; String">preamble</a><span title="String(&quot; java &quot;)"> java $</span><a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.version" title="String">version</a><span title="String(&quot; specific test under java version &quot;)"> specific test under java version $</span><a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.javaVersion" title="=&gt; String">javaVersion</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
 
   <span class="comment">/*
    * If the current java version is at least 'version' then 'yesRun' is evaluated
    * otherwise 'fallback' is 
    */</span>
    def <a title="(fallback: =&gt; A)A" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast.otherwise">otherwise</a><span class="delimiter">(</span><a title="=&gt; A" id="scala.tools.partest;DirectTest;TestUnderJavaAtLeast.otherwise.fallback">fallback</a>: =&gt;A<span class="delimiter">)</span>: <a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast;A" title="A">A</a> = <span class="delimiter">{</span>
      <a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.logInfo" title="()Unit">logInfo</a><span class="delimiter">(</span><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.shouldRun" title="=&gt; Boolean">shouldRun</a><span class="delimiter">)</span> <a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.yesRun" title="=&gt; A">yesRun</a> else <a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast.otherwise.fallback" title="=&gt; A">fallback</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<a href="#scala.tools.partest;DirectTest;TestUnderJavaAtLeast" title="AnyRef" class="delimiter">}</a>

        </pre>
    </body>
</html>

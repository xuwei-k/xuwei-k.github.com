<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scala/tools/partest/nest/FileManager.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* NEST (New Scala Test)
 * Copyright 2007-2013 LAMP/EPFL
 * @author Philipp Haller
 */</span>

<span class="comment">// $Id$</span>

package scala.tools.partest
package nest

import java.io.<span class="delimiter">{</span>
  File,
  FilenameFilter,
  IOException,
  StringWriter,
  FileInputStream,
  FileOutputStream,
  BufferedReader,
  FileReader,
  PrintWriter,
  FileWriter
<span class="delimiter">}</span>
import java.net.URI
import scala.reflect.io.AbstractFile
import scala.collection.mutable
import scala.reflect.internal.util.ScalaClassLoader
import java.net.URLClassLoader

object <a title="scala.tools.partest.nest.FileManager.type" id="scala.tools.partest.nest.FileManager">FileManager</a> <a href="#scala.tools.partest.nest.FileManager" title="scala.tools.partest.nest.FileManager.type" class="delimiter">{</a>
  def <a title="(dir: java.io.File, fileBase: String, kind: String)java.io.File" id="scala.tools.partest.nest.FileManager.getLogFile(7297e9de46)">getLogFile</a><span class="delimiter">(</span><a title="java.io.File" id="scala.tools.partest.nest.FileManager.getLogFile(7297e9de46).dir">dir</a>: <span title="java.io.File">File</span>, <a title="String" id="scala.tools.partest.nest.FileManager.getLogFile(7297e9de46).fileBase">fileBase</a>: <span title="String">String</span>, <a title="String" id="scala.tools.partest.nest.FileManager.getLogFile(7297e9de46).kind">kind</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="java.io.File">File</span> =
    new <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.getLogFile(7297e9de46).dir" title="java.io.File">dir</a>, <a href="#scala.tools.partest.nest.FileManager.getLogFile(7297e9de46).fileBase" title="String">fileBase</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;-&quot;)" class="string">&quot;-&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.partest.nest.FileManager.getLogFile(7297e9de46).kind" title="String">kind</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.log&quot;)" class="string">&quot;.log&quot;</span><span class="delimiter">)</span>

  def <a title="(file: java.io.File, kind: String)java.io.File" id="scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a)">getLogFile</a><span class="delimiter">(</span><a title="java.io.File" id="scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a).file">file</a>: <span title="java.io.File">File</span>, <a title="String" id="scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a).kind">kind</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="java.io.File">File</span> = <span class="delimiter">{</span>
    val <a title="java.io.File" id="scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a).dir">dir</a> = <a href="#scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a).file" title="java.io.File">file</a>.<span title="()java.io.File">getParentFile</span>
    val <a title="String" id="scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a).fileBase">fileBase</a> = <a href="../package.scala.html#scala.tools.partest.package.basename" title="(name: String)String">basename</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a).file" title="java.io.File">file</a>.<span title="()String">getName</span><span class="delimiter">)</span>

    <a href="#scala.tools.partest.nest.FileManager.getLogFile(7297e9de46)" title="(dir: java.io.File, fileBase: String, kind: String)java.io.File">getLogFile</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a).dir" title="java.io.File">dir</a>, <a href="#scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a).fileBase" title="String">fileBase</a>, <a href="#scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a).kind" title="String">kind</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(file: java.io.File, kind: String)Boolean" id="scala.tools.partest.nest.FileManager.logFileExists">logFileExists</a><span class="delimiter">(</span><a title="java.io.File" id="scala.tools.partest.nest.FileManager.logFileExists.file">file</a>: <span title="java.io.File">File</span>, <a title="String" id="scala.tools.partest.nest.FileManager.logFileExists.kind">kind</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#scala.tools.partest.nest.FileManager.getLogFile(d09ff8570a)" title="(file: java.io.File, kind: String)java.io.File">getLogFile</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.logFileExists.file" title="java.io.File">file</a>, <a href="#scala.tools.partest.nest.FileManager.logFileExists.kind" title="String">kind</a><span class="delimiter">)</span>.<span title="()Boolean">canRead</span>

  def <a title="(dest: java.io.File, file: java.io.File)Boolean" id="scala.tools.partest.nest.FileManager.overwriteFileWith">overwriteFileWith</a><span class="delimiter">(</span><a title="java.io.File" id="scala.tools.partest.nest.FileManager.overwriteFileWith.dest">dest</a>: <span title="java.io.File">File</span>, <a title="java.io.File" id="scala.tools.partest.nest.FileManager.overwriteFileWith.file">file</a>: <span title="java.io.File">File</span><span class="delimiter">)</span> =
    <a href="#scala.tools.partest.nest.FileManager.overwriteFileWith.dest" title="java.io.File">dest</a>.<span title="()Boolean">isFile</span> <a href="../../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.partest.nest.FileManager.copyFile" title="(from: java.io.File, dest: java.io.File)Boolean">copyFile</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.overwriteFileWith.file" title="java.io.File">file</a>, <a href="#scala.tools.partest.nest.FileManager.overwriteFileWith.dest" title="java.io.File">dest</a><span class="delimiter">)</span>

  def <a title="(from: java.io.File, dest: java.io.File)Boolean" id="scala.tools.partest.nest.FileManager.copyFile">copyFile</a><span class="delimiter">(</span><a title="java.io.File" id="scala.tools.partest.nest.FileManager.copyFile.from">from</a>: <span title="java.io.File">File</span>, <a title="java.io.File" id="scala.tools.partest.nest.FileManager.copyFile.dest">dest</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <a href="../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.copyFile.from" title="java.io.File">from</a>.<span title="()Boolean">isDirectory</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../../Predef.scala.html#scala.Predef.assert(0f40bc559c)" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.copyFile.dest" title="java.io.File">dest</a>.<span title="()Boolean">isDirectory</span>, <span title="String(&quot;cannot copy directory to file&quot;)" class="string">&quot;cannot copy directory to file&quot;</span><span class="delimiter">)</span>
      val subDir: <a href="../../../reflect/io/Directory.scala.html#scala.reflect.io;Directory" title="scala.tools.partest.Directory">Directory</a> = <a href="../../../reflect/io/Path.scala.html#scala.reflect.io.Path.apply(2128a15a87)" title="(jfile: java.io.File)scala.reflect.io.Path">Path</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.copyFile.dest" title="java.io.File">dest</a><span class="delimiter">)</span> <a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path./(f58dde77dc)" title="scala.tools.partest.Directory" id="scala.tools.partest.nest.FileManager.copyFile.subDir">/</a> <a href="../../../reflect/io/Directory.scala.html#scala.reflect.io.Directory.apply" title="(path: scala.reflect.io.Path)scala.reflect.io.Directory">Directory</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.copyFile.from" title="java.io.File">from</a>.<a href="../../../reflect/io/Path.scala.html#scala.reflect.io.Path.string2path" title="implicit scala.reflect.io.Path.string2path : (s: String)scala.reflect.io.Path">getName</a><span class="delimiter">)</span>
      <a href="#scala.tools.partest.nest.FileManager.copyFile.subDir" title="scala.tools.partest.Directory">subDir</a>.<a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path.createDirectory" title="(force: Boolean, failIfExists: Boolean)scala.reflect.io.Directory">createDirectory</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#scala.tools.partest.nest.FileManager.copyFile.from" title="java.io.File">from</a>.<a href="../../../Predef.scala.html#scala.Predef.refArrayOps" title="(xs: Array[java.io.File])scala.collection.mutable.ArrayOps[java.io.File]">listFiles</a>.<a href="../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[java.io.File]">toList</a> <a href="../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.forall" title="(p: java.io.File =&gt; Boolean)Boolean">forall</a> <span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.copyFile" title="(from: java.io.File, dest: java.io.File)Boolean">copyFile</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.copyFile.$anonfun.x$1" title="java.io.File">_</a>, <a href="../package.scala.html#scala.tools.partest.package.temporaryPath2File" title="implicit scala.tools.partest.package.temporaryPath2File : (x: scala.tools.partest.Path)scala.tools.partest.File">subDir</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> else <span class="delimiter">{</span>
      val <a title="java.io.File" id="scala.tools.partest.nest.FileManager.copyFile.to">to</a> = if <span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.copyFile.dest" title="java.io.File">dest</a>.<span title="()Boolean">isDirectory</span><span class="delimiter">)</span> new <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.copyFile.dest" title="java.io.File">dest</a>, <a href="#scala.tools.partest.nest.FileManager.copyFile.from" title="java.io.File">from</a>.<span title="()String">getName</span><span class="delimiter">)</span> else <a href="#scala.tools.partest.nest.FileManager.copyFile.dest" title="java.io.File">dest</a>

      try <span class="delimiter">{</span>
        <a href="../../../reflect/io/File.scala.html#scala.reflect.io.File.apply" title="(path: scala.reflect.io.Path)(implicit codec: scala.io.Codec)scala.reflect.io.File">SFile</a><a href="../package.scala.html#scala.tools.partest.package.codec" title="=&gt; scala.io.Codec" class="delimiter">(</a><a href="../../../reflect/io/Path.scala.html#scala.reflect.io.Path.jfile2path" title="implicit scala.reflect.io.Path.jfile2path : (jfile: java.io.File)scala.reflect.io.Path">to</a><span class="delimiter">)</span> <a href="../../../reflect/io/File.scala.html#scala.reflect.io;File.writeAll" title="(strings: String*)Unit">writeAll</a> <a href="../../../reflect/io/File.scala.html#scala.reflect.io.File.apply" title="(path: scala.reflect.io.Path)(implicit codec: scala.io.Codec)scala.reflect.io.File">SFile</a><a href="../package.scala.html#scala.tools.partest.package.codec" title="=&gt; scala.io.Codec" class="delimiter">(</a><a href="../../../reflect/io/Path.scala.html#scala.reflect.io.Path.jfile2path" title="implicit scala.reflect.io.Path.jfile2path : (jfile: java.io.File)scala.reflect.io.Path">from</a><span class="delimiter">)</span>.<a href="../../../reflect/io/Streamable.scala.html#scala.reflect.io.Streamable;Chars.slurp(612e557918)" title="()String">slurp</a><span class="delimiter">(</span><span class="delimiter">)</span>
        true
      <span class="delimiter">}</span> catch <span class="delimiter">{</span> case _: <span title="java.io.IOException">IOException</span> =&gt; false <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(file: java.io.File, replace: String =&gt; String)Unit" id="scala.tools.partest.nest.FileManager.mapFile">mapFile</a><span class="delimiter">(</span><a title="java.io.File" id="scala.tools.partest.nest.FileManager.mapFile.file">file</a>: <span title="java.io.File">File</span>, <a title="String =&gt; String" id="scala.tools.partest.nest.FileManager.mapFile.replace">replace</a>: String =&gt; String<span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="scala.reflect.io.File" id="scala.tools.partest.nest.FileManager.mapFile.f">f</a> = <a href="../../../reflect/io/File.scala.html#scala.reflect.io.File.apply" title="(path: scala.reflect.io.Path)(implicit codec: scala.io.Codec)scala.reflect.io.File">SFile</a><a href="../package.scala.html#scala.tools.partest.package.codec" title="=&gt; scala.io.Codec" class="delimiter">(</a><a href="../../../reflect/io/Path.scala.html#scala.reflect.io.Path.jfile2path" title="implicit scala.reflect.io.Path.jfile2path : (jfile: java.io.File)scala.reflect.io.Path">file</a><span class="delimiter">)</span>

    <a href="#scala.tools.partest.nest.FileManager.mapFile.f" title="scala.reflect.io.File">f</a>.<a href="../../../reflect/io/File.scala.html#scala.reflect.io;File.printlnAll" title="(strings: String*)Unit">printlnAll</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.mapFile.f" title="scala.reflect.io.File">f</a>.<a href="../../../reflect/io/Streamable.scala.html#scala.reflect.io.Streamable;Chars.lines(7e2512e485)" title="()Iterator[String]">lines</a>.<a href="../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[String]">toList</a> <a href="../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: String =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">map</a> <a href="#scala.tools.partest.nest.FileManager.mapFile.replace" title="String =&gt; String">replace</a>: _*<span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(dir: scala.tools.partest.Directory, name: String)Iterator[scala.tools.partest.SFile]" id="scala.tools.partest.nest.FileManager.jarsWithPrefix">jarsWithPrefix</a><span class="delimiter">(</span><a title="scala.tools.partest.Directory" id="scala.tools.partest.nest.FileManager.jarsWithPrefix.dir">dir</a>: <a href="../../../reflect/io/Directory.scala.html#scala.reflect.io;Directory" title="scala.tools.partest.Directory">Directory</a>, <a title="String" id="scala.tools.partest.nest.FileManager.jarsWithPrefix.name">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../collection/Iterator.scala.html#scala.collection;Iterator" title="Iterator[scala.tools.partest.SFile]">Iterator</a><span class="delimiter">[</span>SFile<span class="delimiter">]</span> =
    <a href="#scala.tools.partest.nest.FileManager.jarsWithPrefix.dir" title="scala.tools.partest.Directory">dir</a>.<a href="../../../reflect/io/Directory.scala.html#scala.reflect.io;Directory.files" title="=&gt; Iterator[scala.reflect.io.File]">files</a> <a href="../../../collection/Iterator.scala.html#scala.collection;Iterator.filter" title="(p: scala.reflect.io.File =&gt; Boolean)Iterator[scala.reflect.io.File]">filter</a> <span class="delimiter">(</span><a title="scala.reflect.io.File" id="scala.tools.partest.nest.FileManager.jarsWithPrefix.$anonfun.f">f</a> =&gt; <span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.jarsWithPrefix.$anonfun.f" title="scala.reflect.io.File">f</a> <a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path.hasExtension" title="(ext: String, exts: String*)Boolean">hasExtension</a> <span title="String(&quot;jar&quot;)" class="string">&quot;jar&quot;</span><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.jarsWithPrefix.$anonfun.f" title="scala.reflect.io.File">f</a>.<a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path.name" title="=&gt; String">name</a> <span title="(x$1: String)Boolean">startsWith</span> <a href="#scala.tools.partest.nest.FileManager.jarsWithPrefix.name" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>

  def <a title="(dir: scala.tools.partest.Directory, name: String)Iterator[scala.tools.partest.Directory]" id="scala.tools.partest.nest.FileManager.dirsWithPrefix">dirsWithPrefix</a><span class="delimiter">(</span><a title="scala.tools.partest.Directory" id="scala.tools.partest.nest.FileManager.dirsWithPrefix.dir">dir</a>: <a href="../../../reflect/io/Directory.scala.html#scala.reflect.io;Directory" title="scala.tools.partest.Directory">Directory</a>, <a title="String" id="scala.tools.partest.nest.FileManager.dirsWithPrefix.name">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../collection/Iterator.scala.html#scala.collection;Iterator" title="Iterator[scala.tools.partest.Directory]">Iterator</a><span class="delimiter">[</span>Directory<span class="delimiter">]</span> =
    <a href="#scala.tools.partest.nest.FileManager.dirsWithPrefix.dir" title="scala.tools.partest.Directory">dir</a>.<a href="../../../reflect/io/Directory.scala.html#scala.reflect.io;Directory.dirs" title="=&gt; Iterator[scala.reflect.io.Directory]">dirs</a> <a href="../../../collection/Iterator.scala.html#scala.collection;Iterator.filter" title="(p: scala.reflect.io.Directory =&gt; Boolean)Iterator[scala.reflect.io.Directory]">filter</a> <span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.dirsWithPrefix.$anonfun.x$2" title="scala.reflect.io.Directory">_</a>.<a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path.name" title="=&gt; String">name</a> <span title="(x$1: String)Boolean">startsWith</span> <a href="#scala.tools.partest.nest.FileManager.dirsWithPrefix.name" title="String">name</a><span class="delimiter">)</span>

  def <a title="(paths: List[scala.tools.partest.Path])String" id="scala.tools.partest.nest.FileManager.joinPaths">joinPaths</a><span class="delimiter">(</span><a title="List[scala.tools.partest.Path]" id="scala.tools.partest.nest.FileManager.joinPaths.paths">paths</a>: <a href="../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[scala.tools.partest.Path]">List</a><span class="delimiter">[</span>Path<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="../package.scala.html#scala.tools.partest.package.ClassPath" title="=&gt; tools.nsc.util.ClassPath.type">ClassPath</a>.<a href="../../nsc/util/ClassPath.scala.html#scala.tools.nsc.util.ClassPath.join" title="(paths: String*)String">join</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.joinPaths.paths" title="List[scala.tools.partest.Path]">paths</a>.<a href="../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: scala.tools.partest.Path =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.tools.partest.Path],String,List[String]])List[String]">map</a><a href="../../../collection/immutable/List.scala.html#scala.collection.immutable.List.canBuildFrom" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">(</a><a href="../package.scala.html#scala.tools.partest.package.temporaryPath2File" title="implicit scala.tools.partest.package.temporaryPath2File : (x: scala.tools.partest.Path)scala.tools.partest.File">_</a>.<span title="()String">getAbsolutePath</span><span class="delimiter">)</span>.<a href="../../../collection/SeqLike.scala.html#scala.collection;SeqLike.distinct" title="=&gt; List[String]">distinct</a>: _*<span class="delimiter">)</span>

  <span class="comment">/** Compares two files using difflib to produce a unified diff.
   *
   *  @param  original  the first file to be compared
   *  @param  revised  the second file to be compared
   *  @return the unified diff of the compared files or the empty string if they're equal
   */</span>
  def <a title="(original: java.io.File, revised: java.io.File)String" id="scala.tools.partest.nest.FileManager.compareFiles">compareFiles</a><span class="delimiter">(</span><a title="java.io.File" id="scala.tools.partest.nest.FileManager.compareFiles.original">original</a>: <span title="java.io.File">File</span>, <a title="java.io.File" id="scala.tools.partest.nest.FileManager.compareFiles.revised">revised</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <a href="#scala.tools.partest.nest.FileManager.compareContents" title="(original: Seq[String], revised: Seq[String], originalName: String, revisedName: String)String">compareContents</a><span class="delimiter">(</span>io.<a href="../../../io/Source.scala.html#scala.io.Source" title="scala.io.Source.type">Source</a>.<a href="../../../io/Source.scala.html#scala.io.Source.fromFile(2fb853ae40)" title="(file: java.io.File)(implicit codec: scala.io.Codec)scala.io.BufferedSource">fromFile</a><a href="../package.scala.html#scala.tools.partest.package.codec" title="=&gt; scala.io.Codec" class="delimiter">(</a><a href="#scala.tools.partest.nest.FileManager.compareFiles.original" title="java.io.File">original</a><span class="delimiter">)</span>.<a href="../../../io/BufferedSource.scala.html#scala.io;BufferedSource.getLines" title="()Iterator[String]">getLines</a>.<a href="../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toSeq" title="=&gt; Seq[String]">toSeq</a>, io.<a href="../../../io/Source.scala.html#scala.io.Source" title="scala.io.Source.type">Source</a>.<a href="../../../io/Source.scala.html#scala.io.Source.fromFile(2fb853ae40)" title="(file: java.io.File)(implicit codec: scala.io.Codec)scala.io.BufferedSource">fromFile</a><a href="../package.scala.html#scala.tools.partest.package.codec" title="=&gt; scala.io.Codec" class="delimiter">(</a><a href="#scala.tools.partest.nest.FileManager.compareFiles.revised" title="java.io.File">revised</a><span class="delimiter">)</span>.<a href="../../../io/BufferedSource.scala.html#scala.io;BufferedSource.getLines" title="()Iterator[String]">getLines</a>.<a href="../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toSeq" title="=&gt; Seq[String]">toSeq</a>, <a href="#scala.tools.partest.nest.FileManager.compareFiles.original" title="java.io.File">original</a>.<span title="()String">getName</span>, <a href="#scala.tools.partest.nest.FileManager.compareFiles.revised" title="java.io.File">revised</a>.<span title="()String">getName</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Compares two lists of lines using difflib to produce a unified diff.
   *
   *  @param  origLines  the first seq of lines to be compared
   *  @param  newLines   the second seq of lines to be compared
   *  @param  origName   file name to be used in unified diff for `origLines`
   *  @param  newName    file name to be used in unified diff for `newLines`
   *  @return the unified diff of the `origLines` and `newLines` or the empty string if they're equal
   */</span>
  def <a title="(original: Seq[String], revised: Seq[String], originalName: String, revisedName: String)String" id="scala.tools.partest.nest.FileManager.compareContents">compareContents</a><span class="delimiter">(</span><a title="Seq[String]" id="scala.tools.partest.nest.FileManager.compareContents.original">original</a>: <a href="../../../collection/Seq.scala.html#scala.collection;Seq" title="Seq[String]">Seq</a><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="Seq[String]" id="scala.tools.partest.nest.FileManager.compareContents.revised">revised</a>: <a href="../../../collection/Seq.scala.html#scala.collection;Seq" title="Seq[String]">Seq</a><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="String" id="scala.tools.partest.nest.FileManager.compareContents$default$3">originalName</a>: <span title="String">String</span> = <span title="String(&quot;a&quot;)" class="string">&quot;a&quot;</span>, <a title="String" id="scala.tools.partest.nest.FileManager.compareContents$default$4">revisedName</a>: <span title="String">String</span> = <span title="String(&quot;b&quot;)" class="string">&quot;b&quot;</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    import collection.<a href="../../../collection/JavaConverters.scala.html#scala.collection.JavaConverters" title="scala.collection.JavaConverters.type">JavaConverters</a>._

    val <a title="difflib.Patch[String]" id="scala.tools.partest.nest.FileManager.compareContents.diff">diff</a> = difflib.<span title="difflib.DiffUtils.type">DiffUtils</span>.<span title="(x$1: java.util.List[String], x$2: java.util.List[String])difflib.Patch[String]">diff</span><span class="delimiter">(</span><a href="../../../collection/convert/DecorateAsJava.scala.html#scala.collection.convert;DecorateAsJava.seqAsJavaListConverter" title="(b: Seq[String])scala.collection.convert.Decorators.AsJava[java.util.List[String]]">original</a>.<a href="../../../collection/convert/Decorators.scala.html#scala.collection.convert;Decorators;AsJava.asJava" title="=&gt; java.util.List[String]">asJava</a>, <a href="../../../collection/convert/DecorateAsJava.scala.html#scala.collection.convert;DecorateAsJava.seqAsJavaListConverter" title="(b: Seq[String])scala.collection.convert.Decorators.AsJava[java.util.List[String]]">revised</a>.<a href="../../../collection/convert/Decorators.scala.html#scala.collection.convert;Decorators;AsJava.asJava" title="=&gt; java.util.List[String]">asJava</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#scala.tools.partest.nest.FileManager.compareContents.diff" title="difflib.Patch[String]">diff</a>.<span title="()java.util.List[difflib.Delta[String]]">getDeltas</span>.<span title="()Boolean">isEmpty</span><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
    else difflib.<span title="difflib.DiffUtils.type">DiffUtils</span>.<span title="(x$1: String, x$2: String, x$3: java.util.List[String], x$4: difflib.Patch[String], x$5: Int)java.util.List[String]">generateUnifiedDiff</span><a href="../../../collection/convert/DecorateAsScala.scala.html#scala.collection.convert;DecorateAsScala.asScalaBufferConverter" title="(l: java.util.List[String])scala.collection.convert.Decorators.AsScala[scala.collection.mutable.Buffer[String]]" class="delimiter">(</a><a href="#scala.tools.partest.nest.FileManager.compareContents$default$3" title="String">originalName</a>, <a href="#scala.tools.partest.nest.FileManager.compareContents$default$4" title="String">revisedName</a>, <a href="../../../collection/convert/DecorateAsJava.scala.html#scala.collection.convert;DecorateAsJava.seqAsJavaListConverter" title="(b: Seq[String])scala.collection.convert.Decorators.AsJava[java.util.List[String]]">original</a>.<a href="../../../collection/convert/Decorators.scala.html#scala.collection.convert;Decorators;AsJava.asJava" title="=&gt; java.util.List[String]">asJava</a>, <a href="#scala.tools.partest.nest.FileManager.compareContents.diff" title="difflib.Patch[String]">diff</a>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<a href="../../../collection/convert/Decorators.scala.html#scala.collection.convert;Decorators;AsScala.asScala" title="=&gt; scala.collection.mutable.Buffer[String]">asScala</a>.<a href="../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.mkString(f5d728d244)" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

class <a title="class FileManager extends AnyRef" id="scala.tools.partest.nest;FileManager">FileManager</a><a href="#scala.tools.partest.nest;FileManager" title="scala.tools.partest.nest.FileManager" class="delimiter">(</a>val <a title="java.net.URLClassLoader" id="scala.tools.partest.nest;FileManager.testClassLoader">testClassLoader</a>: <span title="java.net.URLClassLoader">URLClassLoader</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  lazy val <a title="scala.tools.partest.Path" id="scala.tools.partest.nest;FileManager.libraryUnderTest">libraryUnderTest</a>: <a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path" title="scala.tools.partest.Path">Path</a>  = <a href="#scala.tools.partest.nest;FileManager.findArtifact" title="(name: String)scala.tools.partest.Path">findArtifact</a><span class="delimiter">(</span><span title="String(&quot;library&quot;)" class="string">&quot;library&quot;</span><span class="delimiter">)</span>
  lazy val <a title="scala.tools.partest.Path" id="scala.tools.partest.nest;FileManager.reflectUnderTest">reflectUnderTest</a>: <a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path" title="scala.tools.partest.Path">Path</a>  = <a href="#scala.tools.partest.nest;FileManager.findArtifact" title="(name: String)scala.tools.partest.Path">findArtifact</a><span class="delimiter">(</span><span title="String(&quot;reflect&quot;)" class="string">&quot;reflect&quot;</span><span class="delimiter">)</span>
  lazy val <a title="scala.tools.partest.Path" id="scala.tools.partest.nest;FileManager.compilerUnderTest">compilerUnderTest</a>: <a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path" title="scala.tools.partest.Path">Path</a> = <a href="#scala.tools.partest.nest;FileManager.findArtifact" title="(name: String)scala.tools.partest.Path">findArtifact</a><span class="delimiter">(</span><span title="String(&quot;compiler&quot;)" class="string">&quot;compiler&quot;</span><span class="delimiter">)</span>

  lazy val <a title="List[scala.reflect.io.Path]" id="scala.tools.partest.nest;FileManager.testClassPath">testClassPath</a> = <a href="#scala.tools.partest.nest;FileManager.testClassLoader" title="=&gt; java.net.URLClassLoader">testClassLoader</a>.<span title="()Array[java.net.URL]">getURLs</span><a href="../../../Predef.scala.html#scala.Predef.refArrayOps" title="(xs: Array[java.net.URL])scala.collection.mutable.ArrayOps[java.net.URL]" class="delimiter">(</a><span class="delimiter">)</span>.<a href="../../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.map" title="(f: java.net.URL =&gt; scala.reflect.io.Path)(implicit bf: scala.collection.generic.CanBuildFrom[Array[java.net.URL],scala.reflect.io.Path,Array[scala.reflect.io.Path]])Array[scala.reflect.io.Path]">map</a><a href="../../../Predef.scala.html#scala.Predef.refArrayOps" title="(xs: Array[scala.reflect.io.Path])scala.collection.mutable.ArrayOps[scala.reflect.io.Path]" class="delimiter">(</a><a title="java.net.URL" id="scala.tools.partest.nest;FileManager.testClassPath.$anonfun.url">url</a> =&gt; <a href="../../../reflect/io/Path.scala.html#scala.reflect.io.Path.apply(2128a15a87)" title="(jfile: java.io.File)scala.reflect.io.Path">Path</a><span class="delimiter">(</span>new <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#scala.tools.partest.nest;FileManager.testClassPath.$anonfun.url" title="java.net.URL">url</a>.<span title="()java.net.URI">toURI</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[scala.reflect.io.Path]">toList</a>

  def this<span class="delimiter">(</span><a title="List[scala.tools.partest.Path]" id="scala.tools.partest.nest;FileManager.<init>(c67accee0f).testClassPath">testClassPath</a>: <a href="../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[scala.tools.partest.Path]">List</a><span class="delimiter">[</span>Path<span class="delimiter">]</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span>
    this<span class="delimiter">(</span>new <span title="java.net.URLClassLoader">URLClassLoader</span><span class="delimiter">(</span><a href="#scala.tools.partest.nest;FileManager.<init>(c67accee0f).testClassPath" title="List[scala.tools.partest.Path]">testClassPath</a>.<a href="../../../Predef.scala.html#scala.Predef.refArrayOps" title="(xs: Array[scala.tools.partest.Path])scala.collection.mutable.ArrayOps[scala.tools.partest.Path]">toArray</a> <a href="../../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.map" title="(f: scala.tools.partest.Path =&gt; java.net.URL)(implicit bf: scala.collection.generic.CanBuildFrom[Array[scala.tools.partest.Path],java.net.URL,Array[java.net.URL]])Array[java.net.URL]">map</a> <span class="delimiter">(</span><a href="#scala.tools.partest.nest;FileManager.<init>(c67accee0f).$anonfun.x$4" title="scala.tools.partest.Path">_</a>.<a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path.toURI" title="=&gt; java.net.URI">toURI</a>.<span title="()java.net.URL">toURL</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="=&gt; String" id="scala.tools.partest.nest;FileManager.distKind">distKind</a> = <span class="delimiter">{</span>
    val <a title="String" id="scala.tools.partest.nest;FileManager.distKind.p">p</a> = <a href="../package.scala.html#scala.tools.partest.package.temporaryPath2File" title="implicit scala.tools.partest.package.temporaryPath2File : (x: scala.tools.partest.Path)scala.tools.partest.File">libraryUnderTest</a>.<span title="()String">getAbsolutePath</span>
    if <span class="delimiter">(</span><a href="#scala.tools.partest.nest;FileManager.distKind.p" title="String">p</a> <span title="(x$1: String)Boolean">endsWith</span> <span title="String(&quot;build/quick/classes/library&quot;)" class="string">&quot;build/quick/classes/library&quot;</span><span class="delimiter">)</span> <span title="String(&quot;quick&quot;)" class="string">&quot;quick&quot;</span>
    else if <span class="delimiter">(</span><a href="#scala.tools.partest.nest;FileManager.distKind.p" title="String">p</a> <span title="(x$1: String)Boolean">endsWith</span> <span title="String(&quot;build/pack/lib/scala-library.jar&quot;)" class="string">&quot;build/pack/lib/scala-library.jar&quot;</span><span class="delimiter">)</span> <span title="String(&quot;pack&quot;)" class="string">&quot;pack&quot;</span>
    else if <span class="delimiter">(</span><a href="#scala.tools.partest.nest;FileManager.distKind.p" title="String">p</a> <span title="(x$1: String)Boolean">endsWith</span> <span title="String(&quot;dists/latest/lib/scala-library.jar&quot;)" class="string">&quot;dists/latest/lib/scala-library.jar&quot;</span><span class="delimiter">)</span> <span title="String(&quot;latest&quot;)" class="string">&quot;latest&quot;</span>
    else <span title="String(&quot;installed&quot;)" class="string">&quot;installed&quot;</span>
  <span class="delimiter">}</span>

  <span class="comment">// find library/reflect/compiler jar or subdir under build/$stage/classes/</span>
  private def <a title="(name: String)scala.tools.partest.Path" id="scala.tools.partest.nest;FileManager.findArtifact">findArtifact</a><span class="delimiter">(</span><a title="String" id="scala.tools.partest.nest;FileManager.findArtifact.name">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path" title="scala.tools.partest.Path">Path</a> = <span class="delimiter">{</span>
    val <a title="Class[_]" id="scala.tools.partest.nest;FileManager.findArtifact.canaryClass">canaryClass</a> =
      <a href="#scala.tools.partest.nest;FileManager.findArtifact.name" title="String">name</a> match <span class="delimiter">{</span>
        case <span title="String(&quot;library&quot;)" class="string">&quot;library&quot;</span>  =&gt; <span title="Class.type">Class</span>.<span title="(x$1: String, x$2: Boolean, x$3: ClassLoader)Class[_]">forName</span><span class="delimiter">(</span><span title="String(&quot;scala.Unit&quot;)" class="string">&quot;scala.Unit&quot;</span>, false, <a href="#scala.tools.partest.nest;FileManager.testClassLoader" title="=&gt; java.net.URLClassLoader">testClassLoader</a><span class="delimiter">)</span>
        case <span title="String(&quot;reflect&quot;)" class="string">&quot;reflect&quot;</span>  =&gt; <span title="Class.type">Class</span>.<span title="(x$1: String, x$2: Boolean, x$3: ClassLoader)Class[_]">forName</span><span class="delimiter">(</span><span title="String(&quot;scala.reflect.api.Symbols&quot;)" class="string">&quot;scala.reflect.api.Symbols&quot;</span>, false, <a href="#scala.tools.partest.nest;FileManager.testClassLoader" title="=&gt; java.net.URLClassLoader">testClassLoader</a><span class="delimiter">)</span>
        case <span title="String(&quot;compiler&quot;)" class="string">&quot;compiler&quot;</span> =&gt; <span title="Class.type">Class</span>.<span title="(x$1: String, x$2: Boolean, x$3: ClassLoader)Class[_]">forName</span><span class="delimiter">(</span><span title="String(&quot;scala.tools.nsc.Main&quot;)" class="string">&quot;scala.tools.nsc.Main&quot;</span>, false, <a href="#scala.tools.partest.nest;FileManager.testClassLoader" title="=&gt; java.net.URLClassLoader">testClassLoader</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    val <a title="scala.reflect.io.Path" id="scala.tools.partest.nest;FileManager.findArtifact.path">path</a> = <a href="../../../reflect/io/Path.scala.html#scala.reflect.io.Path.apply(b8c32fbd51)" title="(path: String)scala.reflect.io.Path">Path</a><span class="delimiter">(</span><a href="#scala.tools.partest.nest;FileManager.findArtifact.canaryClass" title="Class[_]">canaryClass</a>.<span title="()java.security.ProtectionDomain">getProtectionDomain</span>.<span title="()java.security.CodeSource">getCodeSource</span>.<span title="()java.net.URL">getLocation</span>.<span title="()String">getPath</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#scala.tools.partest.nest;FileManager.findArtifact.path" title="scala.reflect.io.Path">path</a>.<a href="../../../reflect/io/Path.scala.html#scala.reflect.io;Path.extension" title="=&gt; String">extension</a> <span title="(x$1: Any)Boolean">==</span> <span title="String(&quot;jar&quot;)" class="string">&quot;jar&quot;</span>
      <a href="../../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="../package.scala.html#scala.tools.partest.package.PathOps" title="implicit scala.tools.partest.package.PathOps : (p: scala.tools.partest.Path)scala.tools.partest.PathOps">path</a>.<a href="../package.scala.html#scala.tools.partest.package;FileOps.absolutePathSegments" title="=&gt; List[String]">absolutePathSegments</a>.<a href="../../../collection/SeqLike.scala.html#scala.collection;SeqLike.endsWith" title="(that: scala.collection.GenSeq[String])Boolean">endsWith</a><span class="delimiter">(</span><a href="../../../collection/generic/GenericCompanion.scala.html#scala.collection.generic;GenericCompanion.apply" title="(elems: String*)Seq[String]">Seq</a><span class="delimiter">(</span><span title="String(&quot;classes&quot;)" class="string">&quot;classes&quot;</span>, <a href="#scala.tools.partest.nest;FileManager.findArtifact.name" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#scala.tools.partest.nest;FileManager.findArtifact.path" title="scala.reflect.io.Path">path</a>
    else sys.<a href="../../../sys/package.scala.html#scala.sys.package.error" title="(message: String)Nothing">error</a><span class="delimiter">(</span>
      <a href="../../../StringContext.scala.html#scala;StringContext.s" title="(args: Any*)String">s</a>&quot;&quot;&quot;<span title="String(&quot;Test Classloader does not contain a &quot;)">Test Classloader does not contain a $</span><a href="#scala.tools.partest.nest;FileManager.findArtifact.name" title="String">name</a><span title="String(&quot; jar or classes/&quot;)"> jar or classes/$</span><a href="#scala.tools.partest.nest;FileManager.findArtifact.name" title="String">name</a><span title="String(&quot; directory.\n           |Looked in: &quot;)"> directory.
           |Looked in: $</span><a href="#scala.tools.partest.nest;FileManager.testClassPath" title="=&gt; List[scala.reflect.io.Path]">testClassPath</a><span title="String(&quot;&quot;)" class="string">&quot;&quot;&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

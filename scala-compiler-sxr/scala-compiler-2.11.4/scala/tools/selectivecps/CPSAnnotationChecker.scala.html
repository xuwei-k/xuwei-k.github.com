<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scala/tools/selectivecps/CPSAnnotationChecker.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">// $Id$</span>

package scala.tools.selectivecps

import scala.tools.nsc.<span class="delimiter">{</span> Global, Mode <span class="delimiter">}</span>
import scala.tools.nsc.MissingRequirementError

abstract class <a title="class CPSAnnotationChecker extends AnyRef with scala.tools.selectivecps.CPSUtils" id="scala.tools.selectivecps;CPSAnnotationChecker">CPSAnnotationChecker</a> extends <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils" title="scala.tools.selectivecps.CPSUtils">CPSUtils</a> <span class="delimiter">{</span>
  val <a title="=&gt; scala.tools.nsc.Global" id="scala.tools.selectivecps;CPSAnnotationChecker.global">global</a>: <a href="../nsc/Global.scala.html#scala.tools.nsc;Global" title="scala.tools.nsc.Global">Global</a>
  import <a href="#scala.tools.selectivecps;CPSAnnotationChecker.global" title="=&gt; scala.tools.nsc.Global">global</a>._
  import <a href="../nsc/Global.scala.html#scala.tools.nsc;Global.analyzer" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: CPSAnnotationChecker.this.global.type}">analyzer</a>.<span class="delimiter">{</span>AnalyzerPlugin, Typer<span class="delimiter">}</span>
  import <a href="../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions.definitions" title="CPSAnnotationChecker.this.global.definitions.type">definitions</a>._

  <span class="comment">//override val verbose = true</span>
  @inline override final def <a title="(x: =&gt; Any)Unit" id="scala.tools.selectivecps;CPSAnnotationChecker.vprintln">vprintln</a><span class="delimiter">(</span><a title="=&gt; Any" id="scala.tools.selectivecps;CPSAnnotationChecker.vprintln.x">x</a>: =&gt;Any<span class="delimiter">)</span>: <a href="../../Unit.scala.html#scala;Unit" title="Unit">Unit</a> = if <span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.verbose" title="=&gt; Boolean">verbose</a><span class="delimiter">)</span> <a href="../../Predef.scala.html#scala.Predef.println(b0c81b2e65)" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln.x" title="=&gt; Any">x</a><span class="delimiter">)</span>

  <span class="comment">/**
   *  Checks whether @cps annotations conform
   */</span>
  object <a title="CPSAnnotationChecker.this.checker.type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker">checker</a> extends <a href="../../reflect/internal/AnnotationCheckers.scala.html#scala.reflect.internal;AnnotationCheckers;AnnotationChecker" title="CPSAnnotationChecker.this.global.AnnotationChecker">AnnotationChecker</a> <span class="delimiter">{</span>
    private<span class="delimiter">[</span>CPSAnnotationChecker<span class="delimiter">]</span> def <a title="(tp: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.addPlusMarker">addPlusMarker</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.addPlusMarker.tp">tp</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a><span class="delimiter">)</span>  = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.addPlusMarker.tp" title="CPSAnnotationChecker.this.global.Type">tp</a> <a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;Annotatable.withAnnotation" title="(annot: CPSAnnotationChecker.this.global.AnnotationInfo)CPSAnnotationChecker.this.global.Type">withAnnotation</a> <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.newPlusMarker" title="()CPSAnnotationChecker.this.global.AnnotationInfo">newPlusMarker</a><span class="delimiter">(</span><span class="delimiter">)</span>
    private<span class="delimiter">[</span>CPSAnnotationChecker<span class="delimiter">]</span> def <a title="(tp: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.addMinusMarker">addMinusMarker</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.addMinusMarker.tp">tp</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a><span class="delimiter">)</span> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.addMinusMarker.tp" title="CPSAnnotationChecker.this.global.Type">tp</a> <a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;Annotatable.withAnnotation" title="(annot: CPSAnnotationChecker.this.global.AnnotationInfo)CPSAnnotationChecker.this.global.Type">withAnnotation</a> <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.newMinusMarker" title="()CPSAnnotationChecker.this.global.AnnotationInfo">newMinusMarker</a><span class="delimiter">(</span><span class="delimiter">)</span>

    private<span class="delimiter">[</span>CPSAnnotationChecker<span class="delimiter">]</span> def <a title="(tp: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlus">cleanPlus</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlus.tp">tp</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a><span class="delimiter">)</span> =
      <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.removeAttribs" title="(tpe: CPSAnnotationChecker.this.global.Type, classes: CPSAnnotationChecker.this.global.Symbol*)CPSAnnotationChecker.this.global.Type">removeAttribs</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlus.tp" title="CPSAnnotationChecker.this.global.Type">tp</a>, <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.MarkerCPSAdaptPlus" title="=&gt; CPSAnnotationChecker.this.global.ClassSymbol">MarkerCPSAdaptPlus</a>, <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.MarkerCPSTypes" title="=&gt; CPSAnnotationChecker.this.global.ClassSymbol">MarkerCPSTypes</a><span class="delimiter">)</span>
    private<span class="delimiter">[</span>CPSAnnotationChecker<span class="delimiter">]</span> def <a title="(tp: CPSAnnotationChecker.this.global.Type)(newAnnots: CPSAnnotationChecker.this.global.AnnotationInfo*)CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlusWith">cleanPlusWith</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlusWith.tp">tp</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.AnnotationInfo*" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlusWith.newAnnots">newAnnots</a>: <span title="CPSAnnotationChecker.this.global.AnnotationInfo*">AnnotationInfo</span>*<span class="delimiter">)</span> =
      <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlus" title="(tp: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type">cleanPlus</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlusWith.tp" title="CPSAnnotationChecker.this.global.Type">tp</a><span class="delimiter">)</span> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.withAnnotations" title="(annots: List[CPSAnnotationChecker.this.global.AnnotationInfo])CPSAnnotationChecker.this.global.Type">withAnnotations</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlusWith.newAnnots" title="CPSAnnotationChecker.this.global.AnnotationInfo*">newAnnots</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[CPSAnnotationChecker.this.global.AnnotationInfo]">toList</a>

    <span class="comment">/** Check annotations to decide whether tpe1 &lt;:&lt; tpe2 */</span>
    def <a title="(tpe1: CPSAnnotationChecker.this.global.Type, tpe2: CPSAnnotationChecker.this.global.Type)Boolean" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform">annotationsConform</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe1">tpe1</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a>, <a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe2">tpe2</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsEnabled" title="=&gt; Boolean">cpsEnabled</a><span class="delimiter">)</span> return true

      <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;check annotations: &quot;)" class="string">&quot;check annotations: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &lt;:&lt; &quot;)" class="string">&quot; &lt;:&lt; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe2" title="CPSAnnotationChecker.this.global.Type">tpe2</a><span class="delimiter">)</span>

      <span class="comment">// Nothing is least element, but Any is not the greatest</span>
      if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a>.<a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.typeSymbol" title="=&gt; CPSAnnotationChecker.this.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.NothingClass" title="CPSAnnotationChecker.this.global.definitions.NothingClass.type">NothingClass</a><span class="delimiter">)</span>
        return true

      val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.annots1">annots1</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a><span class="delimiter">)</span>
      val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.annots2">annots2</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe2" title="CPSAnnotationChecker.this.global.Type">tpe2</a><span class="delimiter">)</span>

      <span class="comment">// @plus and @minus should only occur at the left, and never together</span>
      <span class="comment">// TODO: insert check</span>

      <span class="comment">// @minus @cps is the same as no annotations</span>
      if <span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasMinusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasMinusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a><span class="delimiter">)</span><span class="delimiter">)</span>
        return <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.annots2" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots2</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a>

      <span class="comment">// to handle answer type modification, we must make @plus &lt;:&lt; @cps</span>
      if <span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasPlusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasPlusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
        return true

      <span class="comment">// @plus @cps will fall through and compare the @cps type args</span>
      <span class="comment">// @cps parameters must match exactly</span>
      if <span class="delimiter">(</span><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a> <a href="../../collection/LinearSeqLike.scala.html#scala.collection;LinearSeqLike.corresponds" title="(that: scala.collection.GenSeq[CPSAnnotationChecker.this.global.AnnotationInfo])(p: (CPSAnnotationChecker.this.global.AnnotationInfo, CPSAnnotationChecker.this.global.AnnotationInfo) =&gt; Boolean)Boolean">corresponds</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.annots2" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots2</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.$anonfun.x$1" title="CPSAnnotationChecker.this.global.AnnotationInfo">_</a>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;AnnotationInfo.atp" title="=&gt; CPSAnnotationChecker.this.global.Type">atp</a> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.<:<" title="(that: CPSAnnotationChecker.this.global.Type)Boolean">&lt;:&lt;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.$anonfun.x$2" title="CPSAnnotationChecker.this.global.AnnotationInfo">_</a>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;AnnotationInfo.atp" title="=&gt; CPSAnnotationChecker.this.global.Type">atp</a><span class="delimiter">)</span><span class="delimiter">)</span>
        return true

      <span class="comment">// Need to handle uninstantiated type vars specially:</span>

      <span class="comment">// g map (x =&gt; x)  with expected type List[Int] @cps</span>
      <span class="comment">// results in comparison ?That &lt;:&lt; List[Int] @cps</span>

      <span class="comment">// Instantiating ?That to an annotated type would fail during</span>
      <span class="comment">// transformation.</span>

      <span class="comment">// Instead we force-compare tpe1 &lt;:&lt; tpe2.withoutAnnotations</span>
      <span class="comment">// to trigger instantiation of the TypeVar to the base type</span>

      <span class="comment">// This is a bit unorthodox (we're only supposed to look at</span>
      <span class="comment">// annotations here) but seems to work.</span>

      if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.annots2" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots2</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a>.<a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.isGround" title="=&gt; Boolean">isGround</a><span class="delimiter">)</span>
        return <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.<:<" title="(that: CPSAnnotationChecker.this.global.Type)Boolean">&lt;:&lt;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsConform.tpe2" title="CPSAnnotationChecker.this.global.Type">tpe2</a>.<a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.withoutAnnotations" title="=&gt; CPSAnnotationChecker.this.global.Type">withoutAnnotations</a>

      false
    <span class="delimiter">}</span>

    <span class="comment">/** Refine the computed least upper bound of a list of types.
     *  All this should do is add annotations. */</span>
    override def <a title="(tpe: CPSAnnotationChecker.this.global.Type, ts: List[CPSAnnotationChecker.this.global.Type])CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub">annotationsLub</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.tpe">tpe</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a>, <a title="List[CPSAnnotationChecker.this.global.Type]" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.ts">ts</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.Type]">List</a><span class="delimiter">[</span>Type<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a> = <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsEnabled" title="=&gt; Boolean">cpsEnabled</a><span class="delimiter">)</span> return <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>

      val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.annots1">annots1</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
      val annots2 = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.ts" title="List[CPSAnnotationChecker.this.global.Type]">ts</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.flatMap" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.annots2">flatMap</a> <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a>

      if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.annots2" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots2</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.nonEmpty" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        val <a title="CPSAnnotationChecker.this.global.AnnotationInfo" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.cpsLub">cpsLub</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.newMarker(72877829cc)" title="(tpe: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.AnnotationInfo">newMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.global" title="=&gt; scala.tools.nsc.Global">global</a>.<a href="../../reflect/internal/tpe/GlbLubs.scala.html#scala.reflect.internal.tpe;GlbLubs.lub(d5711a700e)" title="(ts: List[CPSAnnotationChecker.this.global.Type])CPSAnnotationChecker.this.global.Type">lub</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.:::" title="(prefix: List[CPSAnnotationChecker.this.global.AnnotationInfo])List[CPSAnnotationChecker.this.global.AnnotationInfo]">:::</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.annots2" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots2</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: CPSAnnotationChecker.this.global.AnnotationInfo =&gt; CPSAnnotationChecker.this.global.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[CPSAnnotationChecker.this.global.AnnotationInfo],CPSAnnotationChecker.this.global.Type,List[CPSAnnotationChecker.this.global.Type]])List[CPSAnnotationChecker.this.global.Type]">map</a> <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.cpsLub.$anonfun.x$4" title="CPSAnnotationChecker.this.global.AnnotationInfo">_</a>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;AnnotationInfo.atp" title="=&gt; CPSAnnotationChecker.this.global.Type">atp</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        val <a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.tpe1">tpe1</a> = if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.nonEmpty" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.removeAttribs" title="(tpe: CPSAnnotationChecker.this.global.Type, classes: CPSAnnotationChecker.this.global.Symbol*)CPSAnnotationChecker.this.global.Type">removeAttribs</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.MarkerCPSTypes" title="=&gt; CPSAnnotationChecker.this.global.ClassSymbol">MarkerCPSTypes</a><span class="delimiter">)</span> else <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;Annotatable.withAnnotation" title="(annot: CPSAnnotationChecker.this.global.AnnotationInfo)CPSAnnotationChecker.this.global.Type">withAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.cpsLub" title="CPSAnnotationChecker.this.global.AnnotationInfo">cpsLub</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      else <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.annotationsLub.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>
    <span class="delimiter">}</span>

    <span class="comment">/** Refine the bounds on type parameters to the given type arguments. */</span>
    override def <a title="(bounds: List[CPSAnnotationChecker.this.global.TypeBounds], tparams: List[CPSAnnotationChecker.this.global.Symbol], targs: List[CPSAnnotationChecker.this.global.Type])List[CPSAnnotationChecker.this.global.TypeBounds]" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations">adaptBoundsToAnnotations</a><span class="delimiter">(</span><a title="List[CPSAnnotationChecker.this.global.TypeBounds]" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.bounds">bounds</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.TypeBounds]">List</a><span class="delimiter">[</span>TypeBounds<span class="delimiter">]</span>, <a title="List[CPSAnnotationChecker.this.global.Symbol]" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.tparams">tparams</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.Symbol]">List</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span>, <a title="List[CPSAnnotationChecker.this.global.Type]" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.targs">targs</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.Type]">List</a><span class="delimiter">[</span>Type<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.TypeBounds]">List</a><span class="delimiter">[</span>TypeBounds<span class="delimiter">]</span> = <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsEnabled" title="=&gt; Boolean">cpsEnabled</a><span class="delimiter">)</span> return <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.bounds" title="List[CPSAnnotationChecker.this.global.TypeBounds]">bounds</a>

      val <a title="CPSAnnotationChecker.this.global.AnnotationInfo" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.anyAtCPS">anyAtCPS</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.newCpsParamsMarker" title="(tp1: CPSAnnotationChecker.this.global.Type, tp2: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.AnnotationInfo">newCpsParamsMarker</a><span class="delimiter">(</span><a href="../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.NothingTpe" title="=&gt; CPSAnnotationChecker.this.global.Type">NothingTpe</a>, <a href="../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.AnyTpe" title="=&gt; CPSAnnotationChecker.this.global.Type">AnyTpe</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.isFunctionType" title="(tp: CPSAnnotationChecker.this.global.Type)Boolean">isFunctionType</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.tparams" title="List[CPSAnnotationChecker.this.global.Symbol]">tparams</a>.<a href="../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; CPSAnnotationChecker.this.global.Symbol">head</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.owner" title="=&gt; CPSAnnotationChecker.this.global.Symbol">owner</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.tpe_*" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe_*</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.isPartialFunctionType" title="(tp: CPSAnnotationChecker.this.global.Type)Boolean">isPartialFunctionType</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.tparams" title="List[CPSAnnotationChecker.this.global.Symbol]">tparams</a>.<a href="../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; CPSAnnotationChecker.this.global.Symbol">head</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.owner" title="=&gt; CPSAnnotationChecker.this.global.Symbol">owner</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.tpe_*" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe_*</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;function bound: &quot;)" class="string">&quot;function bound: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.tparams" title="List[CPSAnnotationChecker.this.global.Symbol]">tparams</a>.<a href="../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; CPSAnnotationChecker.this.global.Symbol">head</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.owner" title="=&gt; CPSAnnotationChecker.this.global.Symbol">owner</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.bounds" title="List[CPSAnnotationChecker.this.global.TypeBounds]">bounds</a><span title="(x$1: Any)String">+</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.targs" title="List[CPSAnnotationChecker.this.global.Type]">targs</a><span class="delimiter">)</span>
        if <span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasCpsParamTypes" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasCpsParamTypes</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.targs" title="List[CPSAnnotationChecker.this.global.Type]">targs</a>.<a href="../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.last" title="=&gt; CPSAnnotationChecker.this.global.Type">last</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.bounds" title="List[CPSAnnotationChecker.this.global.TypeBounds]">bounds</a>.<a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.reverse" title="=&gt; List[CPSAnnotationChecker.this.global.TypeBounds]">reverse</a> match <span class="delimiter">{</span>
            case <a title="CPSAnnotationChecker.this.global.TypeBounds" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.res">res</a>::<a title="List[CPSAnnotationChecker.this.global.TypeBounds]" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.b">b</a> if <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasCpsParamTypes" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasCpsParamTypes</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.res" title="CPSAnnotationChecker.this.global.TypeBounds">res</a>.<a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;TypeBounds.hi" title="=&gt; CPSAnnotationChecker.this.global.Type">hi</a><span class="delimiter">)</span> =&gt;
              <span class="delimiter">(</span><a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types.TypeBounds.apply(e5f6c793f3)" title="(lo: CPSAnnotationChecker.this.global.Type, hi: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.TypeBounds">TypeBounds</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.res" title="CPSAnnotationChecker.this.global.TypeBounds">res</a>.<a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;TypeBounds.lo" title="=&gt; CPSAnnotationChecker.this.global.Type">lo</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.res" title="CPSAnnotationChecker.this.global.TypeBounds">res</a>.<a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;TypeBounds.hi" title="=&gt; CPSAnnotationChecker.this.global.Type">hi</a>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;Annotatable.withAnnotation" title="(annot: CPSAnnotationChecker.this.global.AnnotationInfo)CPSAnnotationChecker.this.global.Type">withAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.anyAtCPS" title="CPSAnnotationChecker.this.global.AnnotationInfo">anyAtCPS</a><span class="delimiter">)</span><span class="delimiter">)</span><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.TypeBounds)List[CPSAnnotationChecker.this.global.TypeBounds]">::</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.b" title="List[CPSAnnotationChecker.this.global.TypeBounds]">b</a><span class="delimiter">)</span>.<a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.reverse" title="=&gt; List[CPSAnnotationChecker.this.global.TypeBounds]">reverse</a>
            case _ =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.bounds" title="List[CPSAnnotationChecker.this.global.TypeBounds]">bounds</a>
          <span class="delimiter">}</span>
        else
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.bounds" title="List[CPSAnnotationChecker.this.global.TypeBounds]">bounds</a>
      <span class="delimiter">}</span>
      else if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.tparams" title="List[CPSAnnotationChecker.this.global.Symbol]">tparams</a>.<a href="../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; CPSAnnotationChecker.this.global.Symbol">head</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.owner" title="=&gt; CPSAnnotationChecker.this.global.Symbol">owner</a> <span title="(x$1: Any)Boolean">==</span> <a href="../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ByNameParamClass" title="=&gt; CPSAnnotationChecker.this.global.ClassSymbol">ByNameParamClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;byname bound: &quot;)" class="string">&quot;byname bound: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.tparams" title="List[CPSAnnotationChecker.this.global.Symbol]">tparams</a>.<a href="../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; CPSAnnotationChecker.this.global.Symbol">head</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.owner" title="=&gt; CPSAnnotationChecker.this.global.Symbol">owner</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.bounds" title="List[CPSAnnotationChecker.this.global.TypeBounds]">bounds</a><span title="(x$1: Any)String">+</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.targs" title="List[CPSAnnotationChecker.this.global.Type]">targs</a><span class="delimiter">)</span>
        val TypeBounds<a href="../../Tuple2.scala.html#scala;Tuple2" title="(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)" class="delimiter">(</a><a href="../../Tuple2.scala.html#scala;Tuple2._1" title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.lo">lo</a>, <a href="../../Tuple2.scala.html#scala;Tuple2._2" title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.hi">hi</a><span class="delimiter">)</span> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.bounds" title="List[CPSAnnotationChecker.this.global.TypeBounds]">bounds</a>.<a href="../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; CPSAnnotationChecker.this.global.TypeBounds">head</a>
        if <span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasCpsParamTypes" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasCpsParamTypes</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.targs" title="List[CPSAnnotationChecker.this.global.Type]">targs</a>.<a href="../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; CPSAnnotationChecker.this.global.Type">head</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasCpsParamTypes" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasCpsParamTypes</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.hi" title="CPSAnnotationChecker.this.global.Type">hi</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types.TypeBounds.apply(e5f6c793f3)" title="(lo: CPSAnnotationChecker.this.global.Type, hi: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.TypeBounds">TypeBounds</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.lo" title="CPSAnnotationChecker.this.global.Type">lo</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.hi" title="CPSAnnotationChecker.this.global.Type">hi</a> <a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;Annotatable.withAnnotation" title="(annot: CPSAnnotationChecker.this.global.AnnotationInfo)CPSAnnotationChecker.this.global.Type">withAnnotation</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.anyAtCPS" title="CPSAnnotationChecker.this.global.AnnotationInfo">anyAtCPS</a><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.TypeBounds)List[CPSAnnotationChecker.this.global.TypeBounds]">::</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>
        else <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.bounds" title="List[CPSAnnotationChecker.this.global.TypeBounds]">bounds</a>
      <span class="delimiter">}</span> else
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.adaptBoundsToAnnotations.bounds" title="List[CPSAnnotationChecker.this.global.TypeBounds]">bounds</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  object <a title="CPSAnnotationChecker.this.plugin.type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin">plugin</a> extends <a href="../nsc/typechecker/AnalyzerPlugins.scala.html#scala.tools.nsc.typechecker;AnalyzerPlugins;AnalyzerPlugin" title="CPSAnnotationChecker.this.global.analyzer.AnalyzerPlugin">AnalyzerPlugin</a> <span class="delimiter">{</span>

    import <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker" title="CPSAnnotationChecker.this.checker.type">checker</a>._

    override def <a title="(tree: CPSAnnotationChecker.this.global.Tree, typer: CPSAnnotationChecker.this.global.analyzer.Typer, mode: tools.nsc.Mode, pt: CPSAnnotationChecker.this.global.Type)Boolean" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations">canAdaptAnnotations</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.tree">tree</a>: <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CPSAnnotationChecker.this.global.Tree">Tree</a>, <a title="CPSAnnotationChecker.this.global.analyzer.Typer" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.typer">typer</a>: <a href="../nsc/typechecker/Typers.scala.html#scala.tools.nsc.typechecker;Typers;Typer" title="CPSAnnotationChecker.this.global.analyzer.Typer">Typer</a>, <a title="tools.nsc.Mode" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.mode">mode</a>: <a href="../../reflect/internal/Mode.scala.html#scala.reflect.internal;Mode" title="tools.nsc.Mode">Mode</a>, <a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.pt">pt</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsEnabled" title="=&gt; Boolean">cpsEnabled</a><span class="delimiter">)</span> return false
      <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;can adapt annotations? &quot;)" class="string">&quot;can adapt annotations? &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; / &quot;)" class="string">&quot; / &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; / &quot;)" class="string">&quot; / &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.mode" title="tools.nsc.Mode">mode</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; / &quot;)" class="string">&quot; / &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.pt" title="CPSAnnotationChecker.this.global.Type">pt</a><span class="delimiter">)</span>

      val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.annots1">annots1</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
      val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.annots2">annots2</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.pt" title="CPSAnnotationChecker.this.global.Type">pt</a><span class="delimiter">)</span>

      if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.mode" title="tools.nsc.Mode">mode</a>.<a href="../../reflect/internal/Mode.scala.html#scala.reflect.internal;Mode.inPatternMode" title="=&gt; Boolean">inPatternMode</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">//println(&quot;can adapt pattern annotations? &quot; + tree + &quot; / &quot; + tree.tpe + &quot; / &quot; + Integer.toHexString(mode) + &quot; / &quot; + pt)</span>
        if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          return true
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

<span class="comment">/*
      // not precise enough -- still relying on addAnnotations to remove things from ValDef symbols
      if (mode.inAllModes(TYPEmode | BYVALmode)) {
        if (!annots1.isEmpty) {
          return true
        }
      }
*/</span>

<span class="comment">/*
      this interferes with overloading resolution
      if (mode.inByValMode &amp;&amp; tree.tpe &lt;:&lt; pt) {
        vprintln(&quot;already compatible, can't adapt further&quot;)
        return false
      }
*/</span>
      if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.mode" title="tools.nsc.Mode">mode</a>.<a href="../../reflect/internal/Mode.scala.html#scala.reflect.internal;Mode.inExprMode" title="=&gt; Boolean">inExprMode</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        if <span class="delimiter">(</span><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a> <a href="../../collection/LinearSeqLike.scala.html#scala.collection;LinearSeqLike.corresponds" title="(that: scala.collection.GenSeq[CPSAnnotationChecker.this.global.AnnotationInfo])(p: (CPSAnnotationChecker.this.global.AnnotationInfo, CPSAnnotationChecker.this.global.AnnotationInfo) =&gt; Boolean)Boolean">corresponds</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.annots2" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots2</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.$anonfun.x$8" title="CPSAnnotationChecker.this.global.AnnotationInfo">_</a>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;AnnotationInfo.atp" title="=&gt; CPSAnnotationChecker.this.global.Type">atp</a> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.<:<" title="(that: CPSAnnotationChecker.this.global.Type)Boolean">&lt;:&lt;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.$anonfun.x$9" title="CPSAnnotationChecker.this.global.AnnotationInfo">_</a>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;AnnotationInfo.atp" title="=&gt; CPSAnnotationChecker.this.global.Type">atp</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;already same, can\'t adapt further&quot;)" class="string">&quot;already same, can't adapt further&quot;</span><span class="delimiter">)</span>
          false
        <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.annots2" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots2</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.mode" title="tools.nsc.Mode">mode</a>.<a href="../../reflect/internal/Mode.scala.html#scala.reflect.internal;Mode.inByValMode" title="=&gt; Boolean">inByValMode</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="comment">//println(&quot;can adapt annotations? &quot; + tree + &quot; / &quot; + tree.tpe + &quot; / &quot; + Integer.toHexString(mode) + &quot; / &quot; + pt)</span>
          if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasPlusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasPlusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="comment">//          val base = tree.tpe &lt;:&lt; removeAllCPSAnnotations(pt)</span>
  <span class="comment">//          val known = global.analyzer.isFullyDefined(pt)</span>
  <span class="comment">//          println(same + &quot;/&quot; + base + &quot;/&quot; + known)</span>
            <span class="comment">//val same = annots2 forall { case AnnotationInfo(atp: TypeRef, _, _) =&gt; atp.typeArgs(0) =:= atp.typeArgs(1) }</span>
            <span class="comment">// TBD: use same or not?</span>
            <span class="comment">//if (same) {</span>
              <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;yes we can!! (unit)&quot;)" class="string">&quot;yes we can!! (unit)&quot;</span><span class="delimiter">)</span>
              true
            <span class="comment">//}</span>
          <span class="delimiter">}</span> else false
        <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasPlusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasPlusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.annots2" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots2</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.typer" title="CPSAnnotationChecker.this.global.analyzer.Typer">typer</a>.<a href="../nsc/typechecker/Typers.scala.html#scala.tools.nsc.typechecker;Typers;Typer.context" title="=&gt; CPSAnnotationChecker.this.global.analyzer.Context">context</a>.<a href="../nsc/typechecker/Contexts.scala.html#scala.tools.nsc.typechecker;Contexts;Context.inReturnExpr" title="=&gt; Boolean">inReturnExpr</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;checking enclosing method\'s result type without annotations&quot;)" class="string">&quot;checking enclosing method's result type without annotations&quot;</span><span class="delimiter">)</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.<:<" title="(that: CPSAnnotationChecker.this.global.Type)Boolean">&lt;:&lt;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.pt" title="CPSAnnotationChecker.this.global.Type">pt</a>.<a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.withoutAnnotations" title="=&gt; CPSAnnotationChecker.this.global.Type">withoutAnnotations</a>
        <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasMinusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasMinusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.mode" title="tools.nsc.Mode">mode</a>.<a href="../../reflect/internal/Mode.scala.html#scala.reflect.internal;Mode.inByValMode" title="=&gt; Boolean">inByValMode</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          val <a title="Option[(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.optCpsTypes">optCpsTypes</a>: <a href="../../Option.scala.html#scala;Option" title="Option[(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)]">Option</a><span class="delimiter">[</span><span class="delimiter">(</span>Type, Type<span class="delimiter">)</span><span class="delimiter">]</span>         = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamTypes" title="(tpe: CPSAnnotationChecker.this.global.Type)Option[(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)]">cpsParamTypes</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
          val <a title="Option[(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.optExpectedCpsTypes">optExpectedCpsTypes</a>: <a href="../../Option.scala.html#scala;Option" title="Option[(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)]">Option</a><span class="delimiter">[</span><span class="delimiter">(</span>Type, Type<span class="delimiter">)</span><span class="delimiter">]</span> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamTypes" title="(tpe: CPSAnnotationChecker.this.global.Type)Option[(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)]">cpsParamTypes</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.pt" title="CPSAnnotationChecker.this.global.Type">pt</a><span class="delimiter">)</span>
          if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.optCpsTypes" title="Option[(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)]">optCpsTypes</a>.<a href="../../Option.scala.html#scala;Option.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.optExpectedCpsTypes" title="Option[(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)]">optExpectedCpsTypes</a>.<a href="../../Option.scala.html#scala;Option.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;yes we can!! (byval)&quot;)" class="string">&quot;yes we can!! (byval)&quot;</span><span class="delimiter">)</span>
            true
          <span class="delimiter">}</span> else <span class="delimiter">{</span> <span class="comment">// check cps param types</span>
            val <a title="(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.cpsTpes">cpsTpes</a> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.optCpsTypes" title="Option[(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)]">optCpsTypes</a>.<a href="../../Option.scala.html#scala;Option.get" title="=&gt; (CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)">get</a>
            val <a title="(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.cpsPts">cpsPts</a>  = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.optExpectedCpsTypes" title="Option[(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)]">optExpectedCpsTypes</a>.<a href="../../Option.scala.html#scala;Option.get" title="=&gt; (CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)">get</a>
            <span class="comment">// class cpsParam[-B,+C], therefore:</span>
            <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.cpsPts" title="(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)">cpsPts</a>.<a href="../../Tuple2.scala.html#scala;Tuple2._1" title="=&gt; CPSAnnotationChecker.this.global.Type">_1</a> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.<:<" title="(that: CPSAnnotationChecker.this.global.Type)Boolean">&lt;:&lt;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.cpsTpes" title="(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)">cpsTpes</a>.<a href="../../Tuple2.scala.html#scala;Tuple2._1" title="=&gt; CPSAnnotationChecker.this.global.Type">_1</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.cpsTpes" title="(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)">cpsTpes</a>.<a href="../../Tuple2.scala.html#scala;Tuple2._2" title="=&gt; CPSAnnotationChecker.this.global.Type">_2</a> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.<:<" title="(that: CPSAnnotationChecker.this.global.Type)Boolean">&lt;:&lt;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.canAdaptAnnotations.cpsPts" title="(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)">cpsPts</a>.<a href="../../Tuple2.scala.html#scala;Tuple2._2" title="=&gt; CPSAnnotationChecker.this.global.Type">_2</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> else false
      <span class="delimiter">}</span> else false
    <span class="delimiter">}</span>

    override def <a title="(tree: CPSAnnotationChecker.this.global.Tree, typer: CPSAnnotationChecker.this.global.analyzer.Typer, mode: tools.nsc.Mode, pt: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations">adaptAnnotations</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree">tree</a>: <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CPSAnnotationChecker.this.global.Tree">Tree</a>, <a title="CPSAnnotationChecker.this.global.analyzer.Typer" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.typer">typer</a>: <a href="../nsc/typechecker/Typers.scala.html#scala.tools.nsc.typechecker;Typers;Typer" title="CPSAnnotationChecker.this.global.analyzer.Typer">Typer</a>, <a title="tools.nsc.Mode" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.mode">mode</a>: <a href="../../reflect/internal/Mode.scala.html#scala.reflect.internal;Mode" title="tools.nsc.Mode">Mode</a>, <a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.pt">pt</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CPSAnnotationChecker.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsEnabled" title="=&gt; Boolean">cpsEnabled</a><span class="delimiter">)</span> return <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>

      <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;adapt annotations &quot;)" class="string">&quot;adapt annotations &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; / &quot;)" class="string">&quot; / &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; / &quot;)" class="string">&quot; / &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.mode" title="tools.nsc.Mode">mode</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; / &quot;)" class="string">&quot; / &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.pt" title="CPSAnnotationChecker.this.global.Type">pt</a><span class="delimiter">)</span>

      val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.annotsTree">annotsTree</a>              = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
      val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.annotsExpected">annotsExpected</a>          = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.pt" title="CPSAnnotationChecker.this.global.Type">pt</a><span class="delimiter">)</span>
      def <a title="=&gt; Boolean" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.isMissingExpectedAnnots">isMissingExpectedAnnots</a> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.annotsTree" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annotsTree</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.annotsExpected" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annotsExpected</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.nonEmpty" title="=&gt; Boolean">nonEmpty</a>

      <span class="comment">// not sure I rephrased this comment correctly:</span>
      <span class="comment">// replacing `mode.inPatternMode` in the condition below by `mode.inPatternMode || mode.inAllModes(TYPEmode | BYVALmode)`</span>
      <span class="comment">// doesn't work correctly -- still relying on addAnnotations to remove things from ValDef symbols</span>
      if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.mode" title="tools.nsc.Mode">mode</a>.<a href="../../reflect/internal/Mode.scala.html#scala.reflect.internal;Mode.inPatternMode" title="=&gt; Boolean">inPatternMode</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.annotsTree" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annotsTree</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.nonEmpty" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.modifyType" title="(f: CPSAnnotationChecker.this.global.Type =&gt; CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Tree">modifyType</a> <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.removeAllCPSAnnotations" title="(tpe: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type">removeAllCPSAnnotations</a>
      else if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.mode" title="tools.nsc.Mode">mode</a>.<a href="../../reflect/internal/Mode.scala.html#scala.reflect.internal;Mode.typingExprNotValue" title="=&gt; Boolean">typingExprNotValue</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasPlusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasPlusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.isMissingExpectedAnnots" title="=&gt; Boolean">isMissingExpectedAnnots</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// shiftUnit</span>
        <span class="comment">// add a marker annotation that will make tree.tpe behave as pt, subtyping wise</span>
        <span class="comment">// tree will look like having any possible annotation</span>
        <span class="comment">//println(&quot;adapt annotations &quot; + tree + &quot; / &quot; + tree.tpe + &quot; / &quot; + Integer.toHexString(mode) + &quot; / &quot; + pt)</span>

        <span class="comment">// CAVEAT:</span>
        <span class="comment">//  for monomorphic answer types we want to have @plus @cps (for better checking)</span>
        <span class="comment">//  for answer type modification we want to have only @plus (because actual answer type may differ from pt)</span>

        val res = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.modifyType" title="CPSAnnotationChecker.this.global.Tree">modifyType</a> <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.res.$anonfun.x$10" title="CPSAnnotationChecker.this.global.Type">_</a> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.withAnnotations" title="(annots: List[CPSAnnotationChecker.this.global.AnnotationInfo])CPSAnnotationChecker.this.global.Type">withAnnotations</a> <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.newPlusMarker" title="()CPSAnnotationChecker.this.global.AnnotationInfo">newPlusMarker</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.AnnotationInfo)List[CPSAnnotationChecker.this.global.AnnotationInfo]">::</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.annotsExpected" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annotsExpected</a><span class="delimiter">)</span> <span class="comment">// needed for #1807</span>
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;adapted annotations (not by val) of &quot;)" class="string">&quot;adapted annotations (not by val) of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; to &quot;)" class="string">&quot; to &quot;</span> <span title="(x$1: Any)String">+</span> <span title="CPSAnnotationChecker.this.global.Tree">res</span>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
        <span title="CPSAnnotationChecker.this.global.Tree">res</span>
      <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.mode" title="tools.nsc.Mode">mode</a>.<a href="../../reflect/internal/Mode.scala.html#scala.reflect.internal;Mode.typingExprByValue" title="=&gt; Boolean">typingExprByValue</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasMinusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasMinusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.annotsTree" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annotsTree</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.nonEmpty" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// dropping annotation</span>
        <span class="comment">// add a marker annotation that will make tree.tpe behave as pt, subtyping wise</span>
        <span class="comment">// tree will look like having no annotation</span>
        val res = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.modifyType" title="CPSAnnotationChecker.this.global.Tree">modifyType</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.addMinusMarker" title="(tp: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type">addMinusMarker</a>
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;adapted annotations (by val) of &quot;)" class="string">&quot;adapted annotations (by val) of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; to &quot;)" class="string">&quot; to &quot;</span> <span title="(x$1: Any)String">+</span> <span title="CPSAnnotationChecker.this.global.Tree">res</span>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
        <span title="CPSAnnotationChecker.this.global.Tree">res</span>
      <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.typer" title="CPSAnnotationChecker.this.global.analyzer.Typer">typer</a>.<a href="../nsc/typechecker/Typers.scala.html#scala.tools.nsc.typechecker;Typers;Typer.context" title="=&gt; CPSAnnotationChecker.this.global.analyzer.Context">context</a>.<a href="../nsc/typechecker/Contexts.scala.html#scala.tools.nsc.typechecker;Contexts;Context.inReturnExpr" title="=&gt; Boolean">inReturnExpr</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasPlusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasPlusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.isMissingExpectedAnnots" title="=&gt; Boolean">isMissingExpectedAnnots</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// add a marker annotation that will make tree.tpe behave as pt, subtyping wise</span>
        <span class="comment">// tree will look like having any possible annotation</span>

        <span class="comment">// note 1: we are only adding a plus marker if the method's result type is a cps type</span>
        <span class="comment">//         (annotsExpected.nonEmpty == cpsParamAnnotation(pt).nonEmpty)</span>
        <span class="comment">// note 2: we are not adding the expected cps annotations, since they will be added</span>
        <span class="comment">//         by adaptTypeOfReturn (see below).</span>
        val res = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.modifyType" title="CPSAnnotationChecker.this.global.Tree">modifyType</a> <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.res.$anonfun.x$12" title="CPSAnnotationChecker.this.global.Type">_</a> <a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;Annotatable.withAnnotation" title="(annot: CPSAnnotationChecker.this.global.AnnotationInfo)CPSAnnotationChecker.this.global.Type">withAnnotation</a> <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.newPlusMarker" title="()CPSAnnotationChecker.this.global.AnnotationInfo">newPlusMarker</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;adapted annotations (return) of &quot;)" class="string">&quot;adapted annotations (return) of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; to &quot;)" class="string">&quot; to &quot;</span> <span title="(x$1: Any)String">+</span> <span title="CPSAnnotationChecker.this.global.Tree">res</span>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
        <span title="CPSAnnotationChecker.this.global.Tree">res</span>
      <span class="delimiter">}</span> else <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.adaptAnnotations.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>
    <span class="delimiter">}</span>

    <span class="comment">/** Returns an adapted type for a return expression if the method's result type (pt) is a CPS type.
     *  Otherwise, it returns the `default` type (`typedReturn` passes `NothingTpe`).
     *
     *  A return expression in a method that has a CPS result type is an error unless the return
     *  is in tail position. Therefore, we are making sure that only the types of return expressions
     *  are adapted which will either be removed, or lead to an error.
     */</span>
    override def <a title="(default: CPSAnnotationChecker.this.global.Type, typer: CPSAnnotationChecker.this.global.analyzer.Typer, tree: CPSAnnotationChecker.this.global.Return, pt: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn">pluginsTypedReturn</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.default">default</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a>, <a title="CPSAnnotationChecker.this.global.analyzer.Typer" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.typer">typer</a>: <a href="../nsc/typechecker/Typers.scala.html#scala.tools.nsc.typechecker;Typers;Typer" title="CPSAnnotationChecker.this.global.analyzer.Typer">Typer</a>, <a title="CPSAnnotationChecker.this.global.Return" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.tree">tree</a>: <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Return" title="CPSAnnotationChecker.this.global.Return">Return</a>, <a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.pt">pt</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a> = <span class="delimiter">{</span>
      val <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.expr">expr</a> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.tree" title="CPSAnnotationChecker.this.global.Return">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Return.expr" title="=&gt; CPSAnnotationChecker.this.global.Tree">expr</a>
      <span class="comment">// only adapt if method's result type (pt) is cps type</span>
      val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.annots">annots</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.pt" title="CPSAnnotationChecker.this.global.Type">pt</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.annots" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.nonEmpty" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// return type of `expr` without plus marker, but only if it doesn't have other cps annots</span>
        if <span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasPlusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasPlusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.expr" title="CPSAnnotationChecker.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasCpsParamTypes" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasCpsParamTypes</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.expr" title="CPSAnnotationChecker.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.expr" title="CPSAnnotationChecker.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.setType" title="(tp: CPSAnnotationChecker.this.global.Type)expr.type">setType</a><span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.removeAttribs" title="(tpe: CPSAnnotationChecker.this.global.Type, classes: CPSAnnotationChecker.this.global.Symbol*)CPSAnnotationChecker.this.global.Type">removeAttribs</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.expr" title="CPSAnnotationChecker.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a>, <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.MarkerCPSAdaptPlus" title="=&gt; CPSAnnotationChecker.this.global.ClassSymbol">MarkerCPSAdaptPlus</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.expr" title="CPSAnnotationChecker.this.global.Tree">expr</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a>
      <span class="delimiter">}</span> else <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTypedReturn.default" title="CPSAnnotationChecker.this.global.Type">default</a>
    <span class="delimiter">}</span>

    def <a title="(tpe: CPSAnnotationChecker.this.global.Type, childAnnots: List[CPSAnnotationChecker.this.global.AnnotationInfo], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren">updateAttributesFromChildren</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe">tpe</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a>, <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.childAnnots">childAnnots</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span>, <a title="List[CPSAnnotationChecker.this.global.Tree]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.byName">byName</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a> = <span class="delimiter">{</span>
      <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a> match <span class="delimiter">{</span>
        <span class="comment">// Would need to push annots into each alternative of overloaded type</span>
        <span class="comment">// But we can't, since alternatives aren't types but symbols, which we</span>
        <span class="comment">// can't change (we'd be affecting symbols globally)</span>
        <span class="comment">/*
        case OverloadedType(pre, alts) =&gt;
          OverloadedType(pre, alts.map((sym: Symbol) =&gt; updateAttributes(pre.memberType(sym), annots)))
        */</span>
        case OverloadedType<span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.pre">pre</a>, <a title="List[CPSAnnotationChecker.this.global.Symbol]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.alts">alts</a><span class="delimiter">)</span> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>   <span class="comment">//reconstruct correct annotations later</span>
        case MethodType<span class="delimiter">(</span><span title="List[CPSAnnotationChecker.this.global.Symbol]">params</span>, <span title="CPSAnnotationChecker.this.global.Type">restpe</span><span class="delimiter">)</span> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>
        case PolyType<span class="delimiter">(</span><span title="List[CPSAnnotationChecker.this.global.Symbol]">params</span>, <span title="CPSAnnotationChecker.this.global.Type">restpe</span><span class="delimiter">)</span> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>
        case _ =&gt;
          <a href="../nsc/Global.scala.html#scala.tools.nsc;Global.assert(0f40bc559c)" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.childAnnots" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">childAnnots</a> <a href="../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.forall" title="(p: CPSAnnotationChecker.this.global.AnnotationInfo =&gt; Boolean)Boolean">forall</a> <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.$anonfun.x$13" title="CPSAnnotationChecker.this.global.AnnotationInfo">_</a> <a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;AnnotationInfo.matches" title="(clazz: CPSAnnotationChecker.this.global.Symbol)Boolean">matches</a> <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.MarkerCPSTypes" title="=&gt; CPSAnnotationChecker.this.global.ClassSymbol">MarkerCPSTypes</a><span class="delimiter">)</span>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.childAnnots" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">childAnnots</a><span class="delimiter">)</span>
          <span class="comment">/*
            [] + [] = []
            plus + [] = plus
            cps + [] = cps
            plus cps + [] = plus cps
            minus cps + [] = minus cps
            synth cps + [] = synth cps // &lt;- synth on left - does it happen?

            [] + cps = cps
            plus + cps = synth cps
            cps + cps = cps! &lt;- lin
            plus cps + cps = synth cps! &lt;- unify
            minus cps + cps = minus cps! &lt;- lin
            synth cps + cps = synth cps! &lt;- unify
          */</span>

          val plus = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasPlusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasPlusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.||" title="Boolean" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.plus">||</a> <span class="delimiter">(</span>
               <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasCpsParamTypes" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasCpsParamTypes</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
            <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.byName" title="List[CPSAnnotationChecker.this.global.Tree]">byName</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.nonEmpty" title="=&gt; Boolean">nonEmpty</a>
            <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.byName" title="List[CPSAnnotationChecker.this.global.Tree]">byName</a> <a href="../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.forall" title="(p: CPSAnnotationChecker.this.global.Tree =&gt; Boolean)Boolean">forall</a> <span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.plus.$anonfun.t">t</a> =&gt; <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasPlusMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasPlusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.plus.$anonfun.t" title="CPSAnnotationChecker.this.global.Tree">t</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">)</span>

          <span class="comment">// move @plus annotations outward from by-name children</span>
          if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.childAnnots" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">childAnnots</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> return <span class="delimiter">{</span>
            if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.plus" title="Boolean">plus</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// @plus or @plus @cps</span>
              <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.byName" title="List[CPSAnnotationChecker.this.global.Tree]">byName</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.foreach" title="(f: CPSAnnotationChecker.this.global.Tree =&gt; CPSAnnotationChecker.this.global.Tree)Unit">foreach</a> <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.$anonfun.x$14" title="CPSAnnotationChecker.this.global.Tree">_</a> <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.modifyType" title="(f: CPSAnnotationChecker.this.global.Type =&gt; CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Tree">modifyType</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlus" title="(tp: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type">cleanPlus</a><span class="delimiter">)</span>
              <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.addPlusMarker" title="(tp: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type">addPlusMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            else <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>
          <span class="delimiter">}</span>

          val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.annots1">annots1</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>

          if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// nothing or @plus</span>
            <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlusWith" title="(tp: CPSAnnotationChecker.this.global.Type)(newAnnots: CPSAnnotationChecker.this.global.AnnotationInfo*)CPSAnnotationChecker.this.global.Type">cleanPlusWith</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.newSynthMarker" title="()CPSAnnotationChecker.this.global.AnnotationInfo">newSynthMarker</a><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.linearize(b9d9e727fb)" title="(ann: List[CPSAnnotationChecker.this.global.AnnotationInfo])CPSAnnotationChecker.this.global.AnnotationInfo">linearize</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.childAnnots" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">childAnnots</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          else <span class="delimiter">{</span>
            val <a title="CPSAnnotationChecker.this.global.AnnotationInfo" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.annot1">annot1</a> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.single" title="(xs: List[CPSAnnotationChecker.this.global.AnnotationInfo])CPSAnnotationChecker.this.global.AnnotationInfo">single</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a><span class="delimiter">)</span>
            if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.plus" title="Boolean">plus</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// @plus @cps</span>
              val <span title="CPSAnnotationChecker.this.global.AnnotationInfo">annot2</span> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.linearize(b9d9e727fb)" title="(ann: List[CPSAnnotationChecker.this.global.AnnotationInfo])CPSAnnotationChecker.this.global.AnnotationInfo">linearize</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.childAnnots" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">childAnnots</a><span class="delimiter">)</span>

              if <span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.AnnotationInfo">annot2</span>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;AnnotationInfo.atp" title="=&gt; CPSAnnotationChecker.this.global.Type">atp</a> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.<:<" title="(that: CPSAnnotationChecker.this.global.Type)Boolean">&lt;:&lt;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.annot1" title="CPSAnnotationChecker.this.global.AnnotationInfo">annot1</a>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;AnnotationInfo.atp" title="=&gt; CPSAnnotationChecker.this.global.Type">atp</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                try <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlusWith" title="(tp: CPSAnnotationChecker.this.global.Type)(newAnnots: CPSAnnotationChecker.this.global.AnnotationInfo*)CPSAnnotationChecker.this.global.Type">cleanPlusWith</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.newSynthMarker" title="()CPSAnnotationChecker.this.global.AnnotationInfo">newSynthMarker</a><span class="delimiter">(</span><span class="delimiter">)</span>, <span title="CPSAnnotationChecker.this.global.AnnotationInfo">annot2</span><span class="delimiter">)</span>
                finally <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.byName" title="List[CPSAnnotationChecker.this.global.Tree]">byName</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.foreach" title="(f: CPSAnnotationChecker.this.global.Tree =&gt; CPSAnnotationChecker.this.global.Tree)Unit">foreach</a> <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.$anonfun.x$15" title="CPSAnnotationChecker.this.global.Tree">_</a> <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.modifyType" title="(f: CPSAnnotationChecker.this.global.Type =&gt; CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Tree">modifyType</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlus" title="(tp: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type">cleanPlus</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
              else throw new <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;TypeError" title="CPSAnnotationChecker.this.global.TypeError">TypeError</a><span class="delimiter">(</span><a href="../../Predef.scala.html#scala.Predef.any2stringadd(6b32434ac5)" title="(self: CPSAnnotationChecker.this.global.AnnotationInfo)any2stringadd[CPSAnnotationChecker.this.global.AnnotationInfo]">annot2</a> <a href="../../Predef.scala.html#scala.Predef;any2stringadd.+" title="(other: String)String">+</a> <span title="String(&quot; is not a subtype of &quot;)" class="string">&quot; is not a subtype of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.annot1" title="CPSAnnotationChecker.this.global.AnnotationInfo">annot1</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            else if <span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasSynthMarker" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasSynthMarker</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// @synth @cps</span>
              val <span title="CPSAnnotationChecker.this.global.AnnotationInfo">annot2</span> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.linearize(b9d9e727fb)" title="(ann: List[CPSAnnotationChecker.this.global.AnnotationInfo])CPSAnnotationChecker.this.global.AnnotationInfo">linearize</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.childAnnots" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">childAnnots</a><span class="delimiter">)</span>
              if <span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.AnnotationInfo">annot2</span>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;AnnotationInfo.atp" title="=&gt; CPSAnnotationChecker.this.global.Type">atp</a> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.<:<" title="(that: CPSAnnotationChecker.this.global.Type)Boolean">&lt;:&lt;</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.annot1" title="CPSAnnotationChecker.this.global.AnnotationInfo">annot1</a>.<a href="../../reflect/internal/AnnotationInfos.scala.html#scala.reflect.internal;AnnotationInfos;AnnotationInfo.atp" title="=&gt; CPSAnnotationChecker.this.global.Type">atp</a><span class="delimiter">)</span>
                <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlusWith" title="(tp: CPSAnnotationChecker.this.global.Type)(newAnnots: CPSAnnotationChecker.this.global.AnnotationInfo*)CPSAnnotationChecker.this.global.Type">cleanPlusWith</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.AnnotationInfo">annot2</span><span class="delimiter">)</span>
              else
                throw new <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;TypeError" title="CPSAnnotationChecker.this.global.TypeError">TypeError</a><span class="delimiter">(</span><a href="../../Predef.scala.html#scala.Predef.any2stringadd(6b32434ac5)" title="(self: CPSAnnotationChecker.this.global.AnnotationInfo)any2stringadd[CPSAnnotationChecker.this.global.AnnotationInfo]">annot2</a> <a href="../../Predef.scala.html#scala.Predef;any2stringadd.+" title="(other: String)String">+</a> <span title="String(&quot; is not a subtype of &quot;)" class="string">&quot; is not a subtype of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.annot1" title="CPSAnnotationChecker.this.global.AnnotationInfo">annot1</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            else <span class="comment">// @cps</span>
              <a href="#scala.tools.selectivecps;CPSAnnotationChecker.checker.cleanPlusWith" title="(tp: CPSAnnotationChecker.this.global.Type)(newAnnots: CPSAnnotationChecker.this.global.AnnotationInfo*)CPSAnnotationChecker.this.global.Type">cleanPlusWith</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.linearize(b9d9e727fb)" title="(ann: List[CPSAnnotationChecker.this.global.AnnotationInfo])CPSAnnotationChecker.this.global.AnnotationInfo">linearize</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.childAnnots" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">childAnnots</a><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.:::" title="(prefix: List[CPSAnnotationChecker.this.global.AnnotationInfo])List[CPSAnnotationChecker.this.global.AnnotationInfo]">:::</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren.annots1" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots1</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    def <a title="(fun: CPSAnnotationChecker.this.global.Tree, args: List[CPSAnnotationChecker.this.global.Tree])List[List[CPSAnnotationChecker.this.global.Tree]]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList">transArgList</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.fun">fun</a>: <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CPSAnnotationChecker.this.global.Tree">Tree</a>, <a title="List[CPSAnnotationChecker.this.global.Tree]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.args">args</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[List[CPSAnnotationChecker.this.global.Tree]]">List</a><span class="delimiter">[</span>List<span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
      val <a title="List[CPSAnnotationChecker.this.global.Type]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.formals">formals</a> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.fun" title="CPSAnnotationChecker.this.global.Tree">fun</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a>.<a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.paramTypes" title="=&gt; List[CPSAnnotationChecker.this.global.Type]">paramTypes</a>
      val overshoot = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.args" title="List[CPSAnnotationChecker.this.global.Tree]">args</a>.<a href="../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.length" title="=&gt; Int">length</a> <a href="../../Int.scala.html#scala;Int.-(1409840560)" title="Int" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.overshoot">-</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.formals" title="List[CPSAnnotationChecker.this.global.Type]">formals</a>.<a href="../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.length" title="=&gt; Int">length</a>

      for <span class="delimiter">(</span><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.$anonfun.a">a</a>,<a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.$anonfun.tp">tp</a><span class="delimiter">)</span> &lt;- <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.args" title="List[CPSAnnotationChecker.this.global.Tree]">args</a>.<a href="../../collection/IterableLike.scala.html#scala.collection;IterableLike.zip" title="(that: scala.collection.GenIterable[CPSAnnotationChecker.this.global.Type])(implicit bf: scala.collection.generic.CanBuildFrom[List[CPSAnnotationChecker.this.global.Tree],(CPSAnnotationChecker.this.global.Tree, CPSAnnotationChecker.this.global.Type),List[(CPSAnnotationChecker.this.global.Tree, CPSAnnotationChecker.this.global.Type)]])List[(CPSAnnotationChecker.this.global.Tree, CPSAnnotationChecker.this.global.Type)]">zip</a><a href="../../collection/generic/FilterMonadic.scala.html#scala.collection.generic;FilterMonadic.map" title="(f: ((CPSAnnotationChecker.this.global.Tree, CPSAnnotationChecker.this.global.Type)) =&gt; List[CPSAnnotationChecker.this.global.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[(CPSAnnotationChecker.this.global.Tree, CPSAnnotationChecker.this.global.Type)],List[CPSAnnotationChecker.this.global.Tree],List[List[CPSAnnotationChecker.this.global.Tree]]])List[List[CPSAnnotationChecker.this.global.Tree]]" class="delimiter">(</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.formals" title="List[CPSAnnotationChecker.this.global.Type]">formals</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.:::" title="(prefix: List[CPSAnnotationChecker.this.global.Type])List[CPSAnnotationChecker.this.global.Type]">:::</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List" title="scala.collection.immutable.List.type">List</a>.<a href="../../collection/generic/GenTraversableFactory.scala.html#scala.collection.generic;GenTraversableFactory.fill(7c98e57083)" title="(n: Int)(elem: =&gt; CPSAnnotationChecker.this.global.NoType.type)List[CPSAnnotationChecker.this.global.NoType.type]">fill</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.overshoot" title="Int">overshoot</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types.NoType" title="CPSAnnotationChecker.this.global.NoType.type">NoType</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> yield <span class="delimiter">{</span>
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.$anonfun.tp" title="CPSAnnotationChecker.this.global.Type">tp</a> match <span class="delimiter">{</span>
          case TypeRef<span class="delimiter">(</span>_, <a href="../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ByNameParamClass" title="=&gt; CPSAnnotationChecker.this.global.ClassSymbol">ByNameParamClass</a>, <a href="../../collection/generic/SeqFactory.scala.html#scala.collection.generic;SeqFactory.unapplySeq" title="(x: List[CPSAnnotationChecker.this.global.Type])Some[List[CPSAnnotationChecker.this.global.Type]]">List</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.$anonfun.elemtp">elemtp</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a> <span class="comment">// TODO: check conformance??</span>
          case _ =&gt;
            <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: CPSAnnotationChecker.this.global.Tree*)List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList.$anonfun.a" title="CPSAnnotationChecker.this.global.Tree">a</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>


    def <a title="(stms: List[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms">transStms</a><span class="delimiter">(</span><a title="List[CPSAnnotationChecker.this.global.Tree]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms.stms">stms</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms.stms" title="List[CPSAnnotationChecker.this.global.Tree]">stms</a> match <span class="delimiter">{</span>
      case ValDef<span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Modifiers" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms.mods">mods</a>, <a title="CPSAnnotationChecker.this.global.TermName" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms.name">name</a>, <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms.tpt">tpt</a>, <span title="CPSAnnotationChecker.this.global.Tree">rhs</span><span class="delimiter">)</span>::<span title="List[CPSAnnotationChecker.this.global.Tree]">xs</span> =&gt;
        <span title="CPSAnnotationChecker.this.global.Tree">rhs</span><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.Tree]">::</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms" title="(stms: List[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">transStms</a><span class="delimiter">(</span><span title="List[CPSAnnotationChecker.this.global.Tree]">xs</span><span class="delimiter">)</span>
      case Assign<span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms.lhs">lhs</a>, <span title="CPSAnnotationChecker.this.global.Tree">rhs</span><span class="delimiter">)</span>::<span title="List[CPSAnnotationChecker.this.global.Tree]">xs</span> =&gt;
        <span title="CPSAnnotationChecker.this.global.Tree">rhs</span><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.Tree]">::</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms" title="(stms: List[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">transStms</a><span class="delimiter">(</span><span title="List[CPSAnnotationChecker.this.global.Tree]">xs</span><span class="delimiter">)</span>
      case <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms.x">x</a>::<span title="List[CPSAnnotationChecker.this.global.Tree]">xs</span> =&gt;
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms.x" title="CPSAnnotationChecker.this.global.Tree">x</a><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.Tree]">::</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms" title="(stms: List[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">transStms</a><span class="delimiter">(</span><span title="List[CPSAnnotationChecker.this.global.Tree]">xs</span><span class="delimiter">)</span>
      case <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a> =&gt;
        <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>
    <span class="delimiter">}</span>

    def <a title="(xs: List[CPSAnnotationChecker.this.global.AnnotationInfo])CPSAnnotationChecker.this.global.AnnotationInfo" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.single">single</a><span class="delimiter">(</span><a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.single.xs">xs</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.single.xs" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">xs</a> match <span class="delimiter">{</span>
      case <a href="../../collection/generic/SeqFactory.scala.html#scala.collection.generic;SeqFactory.unapplySeq" title="(x: List[CPSAnnotationChecker.this.global.AnnotationInfo])Some[List[CPSAnnotationChecker.this.global.AnnotationInfo]]">List</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.AnnotationInfo" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.single.x">x</a><span class="delimiter">)</span> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.single.x" title="CPSAnnotationChecker.this.global.AnnotationInfo">x</a>
      case _ =&gt;
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.global" title="=&gt; scala.tools.nsc.Global">global</a>.<a href="../../reflect/internal/Reporting.scala.html#scala.reflect.internal;Reporting.globalError(7fc9e56e07)" title="(msg: String)Unit">globalError</a><span class="delimiter">(</span><span title="String(&quot;not a single cps annotation: &quot;)" class="string">&quot;not a single cps annotation: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.single.xs" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">xs</a><span class="delimiter">)</span>
        <a href="../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.apply" title="(n: Int)CPSAnnotationChecker.this.global.AnnotationInfo">xs</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    def <a title="(xs: List[CPSAnnotationChecker.this.global.AnnotationInfo])List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.emptyOrSingleList">emptyOrSingleList</a><span class="delimiter">(</span><a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.emptyOrSingleList.xs">xs</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span><span class="delimiter">)</span> = if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.emptyOrSingleList.xs" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">xs</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a> else <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: CPSAnnotationChecker.this.global.AnnotationInfo*)List[CPSAnnotationChecker.this.global.AnnotationInfo]">List</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.single" title="(xs: List[CPSAnnotationChecker.this.global.AnnotationInfo])CPSAnnotationChecker.this.global.AnnotationInfo">single</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.emptyOrSingleList.xs" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">xs</a><span class="delimiter">)</span><span class="delimiter">)</span>

    def <a title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder">transChildrenInOrder</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.tree">tree</a>: <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CPSAnnotationChecker.this.global.Tree">Tree</a>, <a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.tpe">tpe</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a>, <a title="List[CPSAnnotationChecker.this.global.Tree]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.childTrees">childTrees</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="List[CPSAnnotationChecker.this.global.Tree]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.byName">byName</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      def <a title="(t: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect">inspect</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.t">t</a>: <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CPSAnnotationChecker.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span> = <span class="delimiter">{</span>
        if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.t" title="CPSAnnotationChecker.this.global.Tree">t</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a> <span title="(x$1: AnyRef)Boolean">eq</span> null<span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a> else <span class="delimiter">{</span>
          val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.extra">extra</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.t" title="CPSAnnotationChecker.this.global.Tree">t</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a> match <span class="delimiter">{</span>
            case _: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;MethodType" title="CPSAnnotationChecker.this.global.MethodType">MethodType</a> | _: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;PolyType" title="CPSAnnotationChecker.this.global.PolyType">PolyType</a> | _: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;OverloadedType" title="CPSAnnotationChecker.this.global.OverloadedType">OverloadedType</a> =&gt;
              <span class="comment">// method types, poly types and overloaded types do not obtain cps annotions by propagation</span>
              <span class="comment">// need to reconstruct transitively from their children.</span>
              <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.t" title="CPSAnnotationChecker.this.global.Tree">t</a> match <span class="delimiter">{</span>
                case Select<span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.extra.qual">qual</a>, <a title="CPSAnnotationChecker.this.global.Name" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.extra.name">name</a><span class="delimiter">)</span> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect" title="(t: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.AnnotationInfo]">inspect</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.extra.qual" title="CPSAnnotationChecker.this.global.Tree">qual</a><span class="delimiter">)</span>
                case Apply<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">fun</span>, <span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span> =&gt; <span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">fun</span><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.Tree]">::</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList" title="(fun: CPSAnnotationChecker.this.global.Tree, args: List[CPSAnnotationChecker.this.global.Tree])List[List[CPSAnnotationChecker.this.global.Tree]]">transArgList</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">fun</span>,<span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span>.<a href="../../collection/generic/GenericTraversableTemplate.scala.html#scala.collection.generic;GenericTraversableTemplate.flatten" title="(implicit asTraversable: List[CPSAnnotationChecker.this.global.Tree] =&gt; scala.collection.GenTraversableOnce[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">flatten</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.flatMap" title="(f: CPSAnnotationChecker.this.global.Tree =&gt; scala.collection.GenTraversableOnce[CPSAnnotationChecker.this.global.AnnotationInfo])(implicit bf: scala.collection.generic.CanBuildFrom[List[CPSAnnotationChecker.this.global.Tree],CPSAnnotationChecker.this.global.AnnotationInfo,List[CPSAnnotationChecker.this.global.AnnotationInfo]])List[CPSAnnotationChecker.this.global.AnnotationInfo]">flatMap</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect" title="(t: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.AnnotationInfo]">inspect</a>
                case TypeApply<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">fun</span>, <span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span> =&gt; <span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">fun</span><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.Tree]">::</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList" title="(fun: CPSAnnotationChecker.this.global.Tree, args: List[CPSAnnotationChecker.this.global.Tree])List[List[CPSAnnotationChecker.this.global.Tree]]">transArgList</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">fun</span>,<span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span>.<a href="../../collection/generic/GenericTraversableTemplate.scala.html#scala.collection.generic;GenericTraversableTemplate.flatten" title="(implicit asTraversable: List[CPSAnnotationChecker.this.global.Tree] =&gt; scala.collection.GenTraversableOnce[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">flatten</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.flatMap" title="(f: CPSAnnotationChecker.this.global.Tree =&gt; scala.collection.GenTraversableOnce[CPSAnnotationChecker.this.global.AnnotationInfo])(implicit bf: scala.collection.generic.CanBuildFrom[List[CPSAnnotationChecker.this.global.Tree],CPSAnnotationChecker.this.global.AnnotationInfo,List[CPSAnnotationChecker.this.global.AnnotationInfo]])List[CPSAnnotationChecker.this.global.AnnotationInfo]">flatMap</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect" title="(t: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.AnnotationInfo]">inspect</a>
                case _ =&gt; <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>
              <span class="delimiter">}</span>
            case _ =&gt; <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>
          <span class="delimiter">}</span>

          val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.types">types</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.t" title="CPSAnnotationChecker.this.global.Tree">t</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
          <span class="comment">// TODO: check that it has been adapted and if so correctly</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.extra" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">extra</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.++" title="(that: scala.collection.GenTraversableOnce[CPSAnnotationChecker.this.global.AnnotationInfo])(implicit bf: scala.collection.generic.CanBuildFrom[List[CPSAnnotationChecker.this.global.AnnotationInfo],CPSAnnotationChecker.this.global.AnnotationInfo,List[CPSAnnotationChecker.this.global.AnnotationInfo]])List[CPSAnnotationChecker.this.global.AnnotationInfo]">++</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.emptyOrSingleList" title="(xs: List[CPSAnnotationChecker.this.global.AnnotationInfo])List[CPSAnnotationChecker.this.global.AnnotationInfo]">emptyOrSingleList</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect.types" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">types</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      val children = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.childTrees" title="List[CPSAnnotationChecker.this.global.Tree]">childTrees</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.flatMap" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.children">flatMap</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.inspect" title="(t: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.AnnotationInfo]">inspect</a>

      val <a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.newtpe">newtpe</a> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.updateAttributesFromChildren" title="(tpe: CPSAnnotationChecker.this.global.Type, childAnnots: List[CPSAnnotationChecker.this.global.AnnotationInfo], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">updateAttributesFromChildren</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.children" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">children</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.byName" title="List[CPSAnnotationChecker.this.global.Tree]">byName</a><span class="delimiter">)</span>

      if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.newtpe" title="CPSAnnotationChecker.this.global.Type">newtpe</a>.<a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.annotations" title="=&gt; List[CPSAnnotationChecker.this.global.AnnotationInfo]">annotations</a>.<a href="../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
        <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;[checker] inferred &quot;)" class="string">&quot;[checker] inferred &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; / &quot;)" class="string">&quot; / &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; ===&gt; &quot;)" class="string">&quot; ===&gt; &quot;</span><span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.newtpe" title="CPSAnnotationChecker.this.global.Type">newtpe</a><span class="delimiter">)</span>

      <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder.newtpe" title="CPSAnnotationChecker.this.global.Type">newtpe</a>
    <span class="delimiter">}</span>

    <span class="comment">/** Modify the type that has thus far been inferred
     *  for a tree.  All this should do is add annotations. */</span>

    override def <a title="(tpe: CPSAnnotationChecker.this.global.Type, typer: CPSAnnotationChecker.this.global.analyzer.Typer, tree: CPSAnnotationChecker.this.global.Tree, mode: tools.nsc.Mode, pt: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped">pluginsTyped</a><span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe">tpe</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a>, <a title="CPSAnnotationChecker.this.global.analyzer.Typer" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.typer">typer</a>: <a href="../nsc/typechecker/Typers.scala.html#scala.tools.nsc.typechecker;Typers;Typer" title="CPSAnnotationChecker.this.global.analyzer.Typer">Typer</a>, <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree">tree</a>: <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CPSAnnotationChecker.this.global.Tree">Tree</a>, <a title="tools.nsc.Mode" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.mode">mode</a>: <a href="../../reflect/internal/Mode.scala.html#scala.reflect.internal;Mode" title="tools.nsc.Mode">Mode</a>, <a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.pt">pt</a>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a> = <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsEnabled" title="=&gt; Boolean">cpsEnabled</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        val <a title="Boolean" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.report">report</a> = try <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasCpsParamTypes" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasCpsParamTypes</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span> catch <span class="delimiter">{</span> case _: <a href="../../reflect/internal/MissingRequirementError.scala.html#scala.reflect.internal;MissingRequirementError" title="tools.nsc.MissingRequirementError">MissingRequirementError</a> =&gt; false <span class="delimiter">}</span>
        if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.report" title="Boolean">report</a><span class="delimiter">)</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.global" title="=&gt; scala.tools.nsc.Global">global</a>.<a href="../nsc/Global.scala.html#scala.tools.nsc;Global.reporter" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="../../reflect/internal/Reporting.scala.html#scala.reflect.internal;Reporter.error" title="(pos: scala.reflect.internal.util.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; CPSAnnotationChecker.this.global.Position">pos</a>, <span title="String(&quot;this code must be compiled with the Scala continuations plugin enabled&quot;)" class="string">&quot;this code must be compiled with the Scala continuations plugin enabled&quot;</span><span class="delimiter">)</span>

        return <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>
      <span class="delimiter">}</span>

<span class="comment">//      if (tree.tpe.hasAnnotation(MarkerCPSAdaptPlus))</span>
<span class="comment">//        println(&quot;addAnnotation &quot; + tree + &quot;/&quot; + tpe)</span>

      <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> match <span class="delimiter">{</span>

        case Apply<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Select">fun</span> @ Select<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">qual</span>, <span title="CPSAnnotationChecker.this.global.Name">name</span><span class="delimiter">)</span>, <span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span> if <span title="CPSAnnotationChecker.this.global.Select">fun</span>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.isTyped" title="=&gt; Boolean">isTyped</a> =&gt;

          <span class="comment">// HACK: With overloaded methods, fun will never get annotated. This is because</span>
          <span class="comment">// the 'overloaded' type gets annotated, but not the alternatives (among which</span>
          <span class="comment">// fun's type is chosen)</span>

          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;[checker] checking select apply &quot;)" class="string">&quot;[checker] checking select apply &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>

          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <span title="CPSAnnotationChecker.this.global.Tree">qual</span><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.Tree]">::</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList" title="(fun: CPSAnnotationChecker.this.global.Tree, args: List[CPSAnnotationChecker.this.global.Tree])List[List[CPSAnnotationChecker.this.global.Tree]]">transArgList</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Select">fun</span>, <span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span>.<a href="../../collection/generic/GenericTraversableTemplate.scala.html#scala.collection.generic;GenericTraversableTemplate.flatten" title="(implicit asTraversable: List[CPSAnnotationChecker.this.global.Tree] =&gt; scala.collection.GenTraversableOnce[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">flatten</a><span class="delimiter">)</span>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>

        case Apply<span class="delimiter">(</span>TypeApply<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Select">fun</span> @ Select<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">qual</span>, <span title="CPSAnnotationChecker.this.global.Name">name</span><span class="delimiter">)</span>, <a title="List[CPSAnnotationChecker.this.global.Tree]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.targs">targs</a><span class="delimiter">)</span>, <span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span> if <span title="CPSAnnotationChecker.this.global.Select">fun</span>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.isTyped" title="=&gt; Boolean">isTyped</a> =&gt; <span class="comment">// not trigge</span>

          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;[checker] checking select apply type-apply &quot;)" class="string">&quot;[checker] checking select apply type-apply &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>

          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <span title="CPSAnnotationChecker.this.global.Tree">qual</span><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.Tree]">::</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList" title="(fun: CPSAnnotationChecker.this.global.Tree, args: List[CPSAnnotationChecker.this.global.Tree])List[List[CPSAnnotationChecker.this.global.Tree]]">transArgList</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Select">fun</span>, <span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span>.<a href="../../collection/generic/GenericTraversableTemplate.scala.html#scala.collection.generic;GenericTraversableTemplate.flatten" title="(implicit asTraversable: List[CPSAnnotationChecker.this.global.Tree] =&gt; scala.collection.GenTraversableOnce[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">flatten</a><span class="delimiter">)</span>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>

        case TypeApply<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Select">fun</span> @ Select<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">qual</span>, <span title="CPSAnnotationChecker.this.global.Name">name</span><span class="delimiter">)</span>, <span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span> if <span title="CPSAnnotationChecker.this.global.Select">fun</span>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.isTyped" title="=&gt; Boolean">isTyped</a> =&gt;
          def <a title="(tp: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.stripNullaryMethodType">stripNullaryMethodType</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Type">tp</span>: <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CPSAnnotationChecker.this.global.Type">Type</a><span class="delimiter">)</span> = <span title="CPSAnnotationChecker.this.global.Type">tp</span> match <span class="delimiter">{</span> case NullaryMethodType<span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.stripNullaryMethodType.restpe">restpe</a><span class="delimiter">)</span> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.stripNullaryMethodType.restpe" title="CPSAnnotationChecker.this.global.Type">restpe</a> case <span title="CPSAnnotationChecker.this.global.Type">tp</span> =&gt; <span title="CPSAnnotationChecker.this.global.Type">tp</span> <span class="delimiter">}</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;[checker] checking select type-apply &quot;)" class="string">&quot;[checker] checking select type-apply &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>

          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.stripNullaryMethodType" title="(tp: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type">stripNullaryMethodType</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: CPSAnnotationChecker.this.global.Tree*)List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">qual</span>, <span title="CPSAnnotationChecker.this.global.Select">fun</span><span class="delimiter">)</span>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>

        case Apply<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">fun</span>, <span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span> if <span title="CPSAnnotationChecker.this.global.Tree">fun</span>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.isTyped" title="=&gt; Boolean">isTyped</a> =&gt;

          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;[checker] checking unknown apply &quot;)" class="string">&quot;[checker] checking unknown apply &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>

          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <span title="CPSAnnotationChecker.this.global.Tree">fun</span><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.Tree]">::</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transArgList" title="(fun: CPSAnnotationChecker.this.global.Tree, args: List[CPSAnnotationChecker.this.global.Tree])List[List[CPSAnnotationChecker.this.global.Tree]]">transArgList</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">fun</span>, <span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span>.<a href="../../collection/generic/GenericTraversableTemplate.scala.html#scala.collection.generic;GenericTraversableTemplate.flatten" title="(implicit asTraversable: List[CPSAnnotationChecker.this.global.Tree] =&gt; scala.collection.GenTraversableOnce[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">flatten</a><span class="delimiter">)</span>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>

        case TypeApply<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">fun</span>, <span title="List[CPSAnnotationChecker.this.global.Tree]">args</span><span class="delimiter">)</span> =&gt;

          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;[checker] checking unknown type apply &quot;)" class="string">&quot;[checker] checking unknown type apply &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>

          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: CPSAnnotationChecker.this.global.Tree*)List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">fun</span><span class="delimiter">)</span>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>

        case Select<span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">qual</span>, <span title="CPSAnnotationChecker.this.global.Name">name</span><span class="delimiter">)</span> if <span title="CPSAnnotationChecker.this.global.Tree">qual</span>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.isTyped" title="=&gt; Boolean">isTyped</a> =&gt;

          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;[checker] checking select &quot;)" class="string">&quot;[checker] checking select &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>

          <span class="comment">// straightforward way is problematic (see select.scala and Test2.scala)</span>
          <span class="comment">// transChildrenInOrder(tree, tpe, List(qual), Nil)</span>

          <span class="comment">// the problem is that qual may be of type OverloadedType (or MethodType) and</span>
          <span class="comment">// we cannot safely annotate these. so we just ignore these cases and</span>
          <span class="comment">// clean up later in the Apply/TypeApply trees.</span>

          if <span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasCpsParamTypes" title="(tpe: CPSAnnotationChecker.this.global.Type)Boolean">hasCpsParamTypes</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">qual</span>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="comment">// however there is one special case:</span>
            <span class="comment">// if it's a method without parameters, just apply it. normally done in adapt, but</span>
            <span class="comment">// we have to do it here so we don't lose the cps information (wouldn't trigger our</span>
            <span class="comment">// adapt and there is no Apply/TypeApply created)</span>
            <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a> match <span class="delimiter">{</span>
              case NullaryMethodType<span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.restpe">restpe</a><span class="delimiter">)</span> =&gt;
                <span class="comment">//println(&quot;yep: &quot; + restpe + &quot;,&quot; + restpe.getClass)</span>
                <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.restpe" title="CPSAnnotationChecker.this.global.Type">restpe</a>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: CPSAnnotationChecker.this.global.Tree*)List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">qual</span><span class="delimiter">)</span>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>
              case _ : <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;PolyType" title="CPSAnnotationChecker.this.global.PolyType">PolyType</a> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>
              case _ : <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;MethodType" title="CPSAnnotationChecker.this.global.MethodType">MethodType</a> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>
              case _ : <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;OverloadedType" title="CPSAnnotationChecker.this.global.OverloadedType">OverloadedType</a> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>
              case _ =&gt;
                <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: CPSAnnotationChecker.this.global.Tree*)List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">(</span><span title="CPSAnnotationChecker.this.global.Tree">qual</span><span class="delimiter">)</span>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span> else
            <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>

        case If<span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.cond">cond</a>, <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.thenp">thenp</a>, <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.elsep">elsep</a><span class="delimiter">)</span> =&gt;
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: CPSAnnotationChecker.this.global.Tree*)List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.cond" title="CPSAnnotationChecker.this.global.Tree">cond</a><span class="delimiter">)</span>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: CPSAnnotationChecker.this.global.Tree*)List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.thenp" title="CPSAnnotationChecker.this.global.Tree">thenp</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.elsep" title="CPSAnnotationChecker.this.global.Tree">elsep</a><span class="delimiter">)</span><span class="delimiter">)</span>

        case Match<span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.select">select</a>, <a title="List[CPSAnnotationChecker.this.global.CaseDef]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.cases">cases</a><span class="delimiter">)</span> =&gt;
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: CPSAnnotationChecker.this.global.Tree*)List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.select" title="CPSAnnotationChecker.this.global.Tree">select</a><span class="delimiter">)</span>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.cases" title="List[CPSAnnotationChecker.this.global.CaseDef]">cases</a><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.:::" title="(prefix: List[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">:::</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.cases" title="List[CPSAnnotationChecker.this.global.CaseDef]">cases</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: CPSAnnotationChecker.this.global.CaseDef =&gt; CPSAnnotationChecker.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[CPSAnnotationChecker.this.global.CaseDef],CPSAnnotationChecker.this.global.Tree,List[CPSAnnotationChecker.this.global.Tree]])List[CPSAnnotationChecker.this.global.Tree]">map</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.$anonfun.x0$1" title="CPSAnnotationChecker.this.global.Tree" class="delimiter">{</a> case CaseDef<span class="delimiter">(</span>_, _, <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.$anonfun.body">body</a><span class="delimiter">)</span> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.$anonfun.body" title="CPSAnnotationChecker.this.global.Tree">body</a> <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>

        case Try<span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.block">block</a>, <a title="List[CPSAnnotationChecker.this.global.CaseDef]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.catches">catches</a>, <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.finalizer">finalizer</a><span class="delimiter">)</span> =&gt;
          val <a title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe1">tpe1</a> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.block" title="CPSAnnotationChecker.this.global.Tree">block</a><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CPSAnnotationChecker.this.global.Tree)List[CPSAnnotationChecker.this.global.Tree]">::</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.catches" title="List[CPSAnnotationChecker.this.global.CaseDef]">catches</a><a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.:::" title="(prefix: List[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">:::</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.catches" title="List[CPSAnnotationChecker.this.global.CaseDef]">catches</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: CPSAnnotationChecker.this.global.CaseDef =&gt; CPSAnnotationChecker.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[CPSAnnotationChecker.this.global.CaseDef],CPSAnnotationChecker.this.global.Tree,List[CPSAnnotationChecker.this.global.Tree]])List[CPSAnnotationChecker.this.global.Tree]">map</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe1.$anonfun.x0$2" title="CPSAnnotationChecker.this.global.Tree" class="delimiter">{</a> case CaseDef<span class="delimiter">(</span>_, _, <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe1.$anonfun.body">body</a><span class="delimiter">)</span> =&gt; <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe1.$anonfun.body" title="CPSAnnotationChecker.this.global.Tree">body</a> <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>

          val <a title="List[CPSAnnotationChecker.this.global.AnnotationInfo]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.annots">annots</a> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.cpsParamAnnotation" title="(tpe: CPSAnnotationChecker.this.global.Type)List[CPSAnnotationChecker.this.global.AnnotationInfo]">cpsParamAnnotation</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a><span class="delimiter">)</span>
          if <span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.annots" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.nonEmpty" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            val <a title="CPSAnnotationChecker.this.global.AnnotationInfo" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.ann">ann</a> = <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.single" title="(xs: List[CPSAnnotationChecker.this.global.AnnotationInfo])CPSAnnotationChecker.this.global.AnnotationInfo">single</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.annots" title="List[CPSAnnotationChecker.this.global.AnnotationInfo]">annots</a><span class="delimiter">)</span>
            val <a href="../../Tuple2.scala.html#scala;Tuple2" title="(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)" class="delimiter">(</a><a href="../../Tuple2.scala.html#scala;Tuple2._1" title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.atp0">atp0</a>, <a href="../../Tuple2.scala.html#scala;Tuple2._2" title="CPSAnnotationChecker.this.global.Type" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.atp1">atp1</a><span class="delimiter">)</span> = <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.annTypes" title="(ann: CPSAnnotationChecker.this.global.AnnotationInfo)(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type)">annTypes</a><a href="../../Tuple2.scala.html#scala;Tuple2" title="(CPSAnnotationChecker.this.global.Type, CPSAnnotationChecker.this.global.Type) @unchecked" class="delimiter">(</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.ann" title="CPSAnnotationChecker.this.global.AnnotationInfo">ann</a><span class="delimiter">)</span>
            if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.atp0" title="CPSAnnotationChecker.this.global.Type">atp0</a> <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.=:=" title="(that: CPSAnnotationChecker.this.global.Type)Boolean">=:=</a> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.atp1" title="CPSAnnotationChecker.this.global.Type">atp1</a><span class="delimiter">)</span><span class="delimiter">)</span>
              throw new <a href="../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;TypeError" title="CPSAnnotationChecker.this.global.TypeError">TypeError</a><span class="delimiter">(</span><span title="String(&quot;only simple cps types allowed in try/catch blocks (found: &quot;)" class="string">&quot;only simple cps types allowed in try/catch blocks (found: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
            if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.finalizer" title="CPSAnnotationChecker.this.global.Tree">finalizer</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="comment">// no finalizers allowed. see explanation in SelectiveCPSTransform</span>
              <a href="../nsc/Global.scala.html#scala.tools.nsc;Global.reporter" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="../../reflect/internal/Reporting.scala.html#scala.reflect.internal;Reporter.error" title="(pos: scala.reflect.internal.util.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; CPSAnnotationChecker.this.global.Position">pos</a>, <span title="String(&quot;try/catch blocks that use continuations cannot have finalizers&quot;)" class="string">&quot;try/catch blocks that use continuations cannot have finalizers&quot;</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe1" title="CPSAnnotationChecker.this.global.Type">tpe1</a>

        case Block<span class="delimiter">(</span><a title="List[CPSAnnotationChecker.this.global.Tree]" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.stms">stms</a>, <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.expr">expr</a><span class="delimiter">)</span> =&gt;
          <span class="comment">// if any stm has annotation, so does block</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transChildrenInOrder" title="(tree: CPSAnnotationChecker.this.global.Tree, tpe: CPSAnnotationChecker.this.global.Type, childTrees: List[CPSAnnotationChecker.this.global.Tree], byName: List[CPSAnnotationChecker.this.global.Tree])CPSAnnotationChecker.this.global.Type">transChildrenInOrder</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>, <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.transStms" title="(stms: List[CPSAnnotationChecker.this.global.Tree])List[CPSAnnotationChecker.this.global.Tree]">transStms</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.stms" title="List[CPSAnnotationChecker.this.global.Tree]">stms</a><span class="delimiter">)</span>, <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: CPSAnnotationChecker.this.global.Tree*)List[CPSAnnotationChecker.this.global.Tree]">List</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.expr" title="CPSAnnotationChecker.this.global.Tree">expr</a><span class="delimiter">)</span><span class="delimiter">)</span>

        case ValDef<span class="delimiter">(</span><a title="CPSAnnotationChecker.this.global.Modifiers" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.mods">mods</a>, <span title="CPSAnnotationChecker.this.global.TermName">name</span>, <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpt">tpt</a>, <a title="CPSAnnotationChecker.this.global.Tree" id="scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.rhs">rhs</a><span class="delimiter">)</span> =&gt;
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;[checker] checking valdef &quot;)" class="string">&quot;[checker] checking valdef &quot;</span> <span title="(x$1: Any)String">+</span> <span title="CPSAnnotationChecker.this.global.TermName">name</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a><span title="(x$1: Any)String">+</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpt" title="CPSAnnotationChecker.this.global.Tree">tpt</a><span title="(x$1: Any)String">+</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.symbol" title="=&gt; CPSAnnotationChecker.this.global.Symbol">symbol</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a><span class="delimiter">)</span>
          <span class="comment">// ValDef symbols must *not* have annotations!</span>
          <span class="comment">// lazy vals are currently not supported</span>
          <span class="comment">// but if we erase here all annotations, compiler will complain only</span>
          <span class="comment">// when generating bytecode.</span>
          <span class="comment">// This way lazy vals will be reported as unsupported feature later rather than weird type error.</span>
          if <span class="delimiter">(</span><a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.hasAnswerTypeAnn" title="(tp: CPSAnnotationChecker.this.global.Type)Boolean">hasAnswerTypeAnn</a><span class="delimiter">(</span><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.symbol" title="=&gt; CPSAnnotationChecker.this.global.Symbol">symbol</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.info" title="=&gt; CPSAnnotationChecker.this.global.Type">info</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.mods" title="CPSAnnotationChecker.this.global.Modifiers">mods</a>.<a href="../../reflect/internal/HasFlags.scala.html#scala.reflect.internal;HasFlags.isLazy" title="=&gt; Boolean">isLazy</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// is it okay to modify sym here?</span>
            <a href="#scala.tools.selectivecps;CPSAnnotationChecker.vprintln" title="(x: =&gt; Any)Unit">vprintln</a><span class="delimiter">(</span><span title="String(&quot;removing annotation from sym &quot;)" class="string">&quot;removing annotation from sym &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.symbol" title="=&gt; CPSAnnotationChecker.this.global.Symbol">symbol</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.symbol" title="=&gt; CPSAnnotationChecker.this.global.Symbol">symbol</a>.<a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.tpe" title="=&gt; CPSAnnotationChecker.this.global.Type">tpe</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpt" title="CPSAnnotationChecker.this.global.Tree">tpt</a><span class="delimiter">)</span>
            <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpt" title="CPSAnnotationChecker.this.global.Tree">tpt</a> <a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.modifyType" title="(f: CPSAnnotationChecker.this.global.Type =&gt; CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Tree">modifyType</a> <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.removeAllCPSAnnotations" title="(tpe: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type">removeAllCPSAnnotations</a>
            <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tree" title="CPSAnnotationChecker.this.global.Tree">tree</a>.<a href="../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.symbol" title="=&gt; CPSAnnotationChecker.this.global.Symbol">symbol</a> <a href="../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.modifyInfo" title="(f: CPSAnnotationChecker.this.global.Type =&gt; CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Symbol">modifyInfo</a> <a href="CPSUtils.scala.html#scala.tools.selectivecps;CPSUtils.removeAllCPSAnnotations" title="(tpe: CPSAnnotationChecker.this.global.Type)CPSAnnotationChecker.this.global.Type">removeAllCPSAnnotations</a>
          <span class="delimiter">}</span>
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>

        case _ =&gt;
          <a href="#scala.tools.selectivecps;CPSAnnotationChecker.plugin.pluginsTyped.tpe" title="CPSAnnotationChecker.this.global.Type">tpe</a>
      <span class="delimiter">}</span>


    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scala/tools/nsc/transform/Statics.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
package scala.tools.nsc
package transform

import symtab._
import <a href="../symtab/package.scala.html#scala.tools.nsc.symtab.package.Flags" title="=&gt; reflect.internal.Flags.type">Flags</a>._

import collection.mutable.Buffer

abstract class <a title="class Statics extends scala.tools.nsc.SubComponent with scala.tools.nsc.transform.Transform with scala.tools.nsc.ast.TreeDSL" id="scala.tools.nsc.transform;Statics">Statics</a> extends <a href="Transform.scala.html#scala.tools.nsc.transform;Transform" title="scala.tools.nsc.transform.Transform">Transform</a> with ast.<a href="../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL" title="scala.tools.nsc.ast.TreeDSL">TreeDSL</a> <span class="delimiter">{</span>
  import <a href="../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.global" title="=&gt; scala.tools.nsc.Global">global</a>._

  class <a title="class StaticsTransformer extends Statics.this.global.Transformer" id="scala.tools.nsc.transform;Statics;StaticsTransformer">StaticsTransformer</a> extends <a href="../ast/Trees.scala.html#scala.tools.nsc.ast;Trees;Transformer" title="Statics.this.global.Transformer">Transformer</a> <span class="delimiter">{</span>

    <span class="comment">/** finds the static ctor DefDef tree within the template if it exists. */</span>
    def <a title="(template: Statics.this.global.Template)Option[Statics.this.global.Tree]" id="scala.tools.nsc.transform;Statics;StaticsTransformer.findStaticCtor">findStaticCtor</a><span class="delimiter">(</span><a title="Statics.this.global.Template" id="scala.tools.nsc.transform;Statics;StaticsTransformer.findStaticCtor.template">template</a>: <a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Template" title="Statics.this.global.Template">Template</a><span class="delimiter">)</span>: <a href="../../../Option.scala.html#scala;Option" title="Option[Statics.this.global.Tree]">Option</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> =
      <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.findStaticCtor.template" title="Statics.this.global.Template">template</a>.<a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Template.body" title="=&gt; List[Statics.this.global.Tree]">body</a> <a href="../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.find" title="(p: Statics.this.global.Tree =&gt; Boolean)Option[Statics.this.global.Tree]">find</a> <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.findStaticCtor.$anonfun.x0$1" title="Boolean" class="delimiter">{</a>
        case <a title="Statics.this.global.DefDef" id="scala.tools.nsc.transform;Statics;StaticsTransformer.findStaticCtor.$anonfun.defdef">defdef</a> @ DefDef<span class="delimiter">(</span>_, <a href="../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="Statics.this.global.nme.type">nme</a>.<a href="../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;TermNames.CONSTRUCTOR" title="=&gt; Statics.this.global.nme.NameType">CONSTRUCTOR</a>, _, _, _, _<span class="delimiter">)</span> =&gt; <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.findStaticCtor.$anonfun.defdef" title="Statics.this.global.DefDef">defdef</a>.<a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;SymTree.symbol" title="=&gt; Statics.this.global.Symbol">symbol</a>.<a href="../../../reflect/internal/HasFlags.scala.html#scala.reflect.internal;HasFlags.hasStaticFlag" title="=&gt; Boolean">hasStaticFlag</a>
        case _ =&gt; false
      <span class="delimiter">}</span>

    <span class="comment">/** changes the template for the class so that it contains a static constructor with symbol fields inits,
      * augments an existing static ctor if one already existed.
      */</span>
    def <a title="(template: Statics.this.global.Template, newStaticInits: scala.collection.mutable.Buffer[Statics.this.global.Tree], localTyper: Statics.this.global.analyzer.Typer)Statics.this.global.Template" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits">addStaticInits</a><span class="delimiter">(</span><a title="Statics.this.global.Template" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.template">template</a>: <a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Template" title="Statics.this.global.Template">Template</a>, <a title="scala.collection.mutable.Buffer[Statics.this.global.Tree]" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newStaticInits">newStaticInits</a>: <a href="../../../collection/mutable/Buffer.scala.html#scala.collection.mutable;Buffer" title="scala.collection.mutable.Buffer[Statics.this.global.Tree]">Buffer</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="Statics.this.global.analyzer.Typer" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.localTyper">localTyper</a>: analyzer.<a href="../typechecker/Typers.scala.html#scala.tools.nsc.typechecker;Typers;Typer" title="Statics.this.global.analyzer.Typer">Typer</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Template" title="Statics.this.global.Template">Template</a> = <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newStaticInits" title="scala.collection.mutable.Buffer[Statics.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
        <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.template" title="Statics.this.global.Template">template</a>
      else <span class="delimiter">{</span>
        val <a title="Statics.this.global.analyzer.global.Tree" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor">newCtor</a> = <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.findStaticCtor" title="(template: Statics.this.global.Template)Option[Statics.this.global.Tree]">findStaticCtor</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.template" title="Statics.this.global.Template">template</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
          <span class="comment">// in case there already were static ctors - augment existing ones</span>
          <span class="comment">// currently, however, static ctors aren't being generated anywhere else</span>
          case Some<span class="delimiter">(</span><a title="Statics.this.global.DefDef" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.ctor">ctor</a> @ DefDef<span class="delimiter">(</span>_,_,_,_,_,_<span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            <span class="comment">// modify existing static ctor</span>
            <a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.deriveDefDef" title="(ddef: Statics.this.global.Tree)(applyToRhs: Statics.this.global.Tree =&gt; Statics.this.global.Tree)Statics.this.global.DefDef">deriveDefDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.ctor" title="Statics.this.global.DefDef">ctor</a><span class="delimiter">)</span> <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.$anonfun.x0$2" title="Statics.this.global.Tree" class="delimiter">{</a>
              case <a title="Statics.this.global.Block" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.$anonfun.block">block</a> @ Block<span class="delimiter">(</span><a title="List[Statics.this.global.Tree]" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.$anonfun.stats">stats</a>, <a title="Statics.this.global.Tree" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.$anonfun.expr">expr</a><span class="delimiter">)</span> =&gt;
                <span class="comment">// need to add inits to existing block</span>
                <a href="../../../reflect/api/Trees.scala.html#scala.reflect.api;Trees;Transformer.treeCopy" title="=&gt; Statics.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#scala.reflect.api;Trees;TreeCopierOps.Block" title="(tree: Statics.this.global.Tree, stats: List[Statics.this.global.Tree], expr: Statics.this.global.Tree)Statics.this.global.Block">Block</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.$anonfun.block" title="Statics.this.global.Block">block</a>, <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newStaticInits" title="scala.collection.mutable.Buffer[Statics.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[Statics.this.global.Tree]">toList</a> <a href="../../../collection/immutable/List.scala.html#scala.collection.immutable;List.:::" title="(prefix: List[Statics.this.global.Tree])List[Statics.this.global.Tree]">:::</a> <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.$anonfun.stats" title="List[Statics.this.global.Tree]">stats</a>, <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.$anonfun.expr" title="Statics.this.global.Tree">expr</a><span class="delimiter">)</span>
              case <a title="Statics.this.global.TermTree" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.$anonfun.term">term</a>: <a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TermTree" title="Statics.this.global.TermTree">TermTree</a> =&gt;
                <span class="comment">// need to create a new block with inits and the old term</span>
                <a href="../../../reflect/api/Trees.scala.html#scala.reflect.api;Trees;Transformer.treeCopy" title="=&gt; Statics.this.global.TreeCopier">treeCopy</a>.<a href="../../../reflect/api/Trees.scala.html#scala.reflect.api;Trees;TreeCopierOps.Block" title="(tree: Statics.this.global.Tree, stats: List[Statics.this.global.Tree], expr: Statics.this.global.Tree)Statics.this.global.Block">Block</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.$anonfun.term" title="Statics.this.global.TermTree">term</a>, <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newStaticInits" title="scala.collection.mutable.Buffer[Statics.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[Statics.this.global.Tree]">toList</a>, <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.$anonfun.term" title="Statics.this.global.TermTree">term</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          case _ =&gt;
            <span class="comment">// create new static ctor</span>
            val <a title="Statics.this.global.MethodSymbol" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.staticCtorSym">staticCtorSym</a>  = <a href="../../../reflect/api/Trees.scala.html#scala.reflect.api;Trees;Transformer.currentClass" title="=&gt; Statics.this.global.Symbol">currentClass</a>.<a href="../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.newStaticConstructor" title="(pos: Statics.this.global.Position)Statics.this.global.MethodSymbol">newStaticConstructor</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.template" title="Statics.this.global.Template">template</a>.<a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; Statics.this.global.Position">pos</a><span class="delimiter">)</span>
            val <a title="Statics.this.global.Block" id="scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.rhs">rhs</a>            = <a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Block" title="(stats: List[Statics.this.global.Tree], expr: Statics.this.global.Tree)Statics.this.global.Block">Block</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newStaticInits" title="scala.collection.mutable.Buffer[Statics.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[Statics.this.global.Tree]">toList</a>, <a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Literal" title="(value: Statics.this.global.Constant)Statics.this.global.Literal">Literal</a><span class="delimiter">(</span><a href="../../../reflect/internal/Constants.scala.html#scala.reflect.internal;Constants;Constant" title="(value: Any)Statics.this.global.Constant">Constant</a><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

            <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.localTyper" title="Statics.this.global.analyzer.Typer">localTyper</a>.<a href="../typechecker/Typers.scala.html#scala.tools.nsc.typechecker;Typers;Typer.typedPos(b526320510)" title="(pos: Statics.this.global.analyzer.global.Position)(tree: Statics.this.global.analyzer.global.Tree)Statics.this.global.analyzer.global.Tree">typedPos</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.template" title="Statics.this.global.Template">template</a>.<a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; Statics.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.DefDef.apply(ebb67886c8)" title="(sym: Statics.this.global.Symbol, rhs: Statics.this.global.Tree)Statics.this.global.DefDef">DefDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.staticCtorSym" title="Statics.this.global.MethodSymbol">staticCtorSym</a>, <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor.rhs" title="Statics.this.global.Block">rhs</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.deriveTemplate" title="(templ: Statics.this.global.Tree)(applyToBody: List[Statics.this.global.Tree] =&gt; List[Statics.this.global.Tree])Statics.this.global.Template">deriveTemplate</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.template" title="Statics.this.global.Template">template</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.newCtor" title="Statics.this.global.analyzer.global.Tree">newCtor</a> <a href="../../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: Statics.this.global.Tree)List[Statics.this.global.Tree]">::</a> <a href="#scala.tools.nsc.transform;Statics;StaticsTransformer.addStaticInits.$anonfun.x$2" title="List[Statics.this.global.Tree]">_</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

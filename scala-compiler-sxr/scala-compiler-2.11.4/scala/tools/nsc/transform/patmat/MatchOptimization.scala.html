<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scala/tools/nsc/transform/patmat/MatchOptimization.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 *
 * Copyright 2011-2013 LAMP/EPFL
 * @author Adriaan Moors
 */</span>

package scala.tools.nsc.transform.patmat

import scala.tools.nsc.symtab.<a href="../../symtab/package.scala.html#scala.tools.nsc.symtab.package.Flags" title="=&gt; reflect.internal.Flags.type">Flags</a>.MUTABLE
import scala.<a href="../../../../language.scala.html#scala.language" title="language.type">language</a>.postfixOps
import scala.collection.mutable
import scala.reflect.internal.util.Statistics
import scala.reflect.internal.util.Position

<span class="comment">/** Optimize and analyze matches based on their TreeMaker-representation.
 *
 * The patmat translation doesn't rely on this, so it could be disabled in principle.
 *  - well, not quite: the backend crashes if we emit duplicates in switches (e.g. SI-7290)
 */</span>
<span class="comment">// TODO: split out match analysis</span>
trait <a title="trait MatchOptimization extends AnyRef with scala.tools.nsc.transform.patmat.MatchTreeMaking with scala.tools.nsc.transform.patmat.MatchAnalysis" id="scala.tools.nsc.transform.patmat;MatchOptimization">MatchOptimization</a> extends <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking" title="scala.tools.nsc.transform.patmat.MatchTreeMaking">MatchTreeMaking</a> with <a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchAnalysis" title="scala.tools.nsc.transform.patmat.MatchAnalysis">MatchAnalysis</a> <span class="delimiter">{</span>
  import <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.global" title="=&gt; scala.tools.nsc.Global">global</a>._
  import <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.global" title="=&gt; scala.tools.nsc.Global">global</a>.<a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions.definitions" title="MatchOptimization.this.global.definitions.type">definitions</a>._

  <span class="comment">////</span>
  trait <a title="trait CommonSubconditionElimination extends AnyRef with MatchOptimization.this.OptimizedCodegen with MatchOptimization.this.MatchApproximator" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination">CommonSubconditionElimination</a> extends <a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;OptimizedCodegen" title="MatchOptimization.this.OptimizedCodegen">OptimizedCodegen</a> with <a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator" title="MatchOptimization.this.MatchApproximator">MatchApproximator</a> <span class="delimiter">{</span>
    <span class="comment">/** a flow-sensitive, generalised, common sub-expression elimination
     * reuse knowledge from performed tests
     * the only sub-expressions we consider are the conditions and results of the three tests (type, type&amp;equality, equality)
     * when a sub-expression is shared, it is stored in a mutable variable
     * the variable is floated up so that its scope includes all of the program that shares it
     * we generalize sharing to implication, where b reuses a if a =&gt; b and priors(a) =&gt; priors(b) (the priors of a sub expression form the path through the decision tree)
     */</span>
    def <a title="(prevBinder: MatchOptimization.this.global.Symbol, cases: List[List[CommonSubconditionElimination.this.TreeMaker]], pt: CommonSubconditionElimination.this.Type)List[List[CommonSubconditionElimination.this.TreeMaker]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE">doCSE</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.prevBinder">prevBinder</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a>, <a title="List[List[CommonSubconditionElimination.this.TreeMaker]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.cases">cases</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[List[CommonSubconditionElimination.this.TreeMaker]]">List</a><span class="delimiter">[</span>List<span class="delimiter">[</span>TreeMaker<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="CommonSubconditionElimination.this.Type" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.pt">pt</a>: <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="CommonSubconditionElimination.this.Type">Type</a><span class="delimiter">)</span>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[List[CommonSubconditionElimination.this.TreeMaker]]">List</a><span class="delimiter">[</span>List<span class="delimiter">[</span>TreeMaker<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.debug" title="MatchOptimization.this.debug.type">debug</a>.<a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.debug.patmat" title="(s: =&gt; String)Unit">patmat</a><span class="delimiter">(</span><span title="String(&quot;before CSE:&quot;)" class="string">&quot;before CSE:&quot;</span><span class="delimiter">)</span>
      <a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator.showTreeMakers" title="(cases: List[List[CommonSubconditionElimination.this.TreeMaker]])Unit">showTreeMakers</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.cases" title="List[List[CommonSubconditionElimination.this.TreeMaker]]">cases</a><span class="delimiter">)</span>

      val <a title="List[List[CommonSubconditionElimination.this.Test]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.testss">testss</a> = <a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator.approximateMatchConservative" title="(root: MatchOptimization.this.global.Symbol, cases: List[List[CommonSubconditionElimination.this.TreeMaker]])List[List[CommonSubconditionElimination.this.Test]]">approximateMatchConservative</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.prevBinder" title="MatchOptimization.this.global.Symbol">prevBinder</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.cases" title="List[List[CommonSubconditionElimination.this.TreeMaker]]">cases</a><span class="delimiter">)</span>

      <span class="comment">// interpret:</span>
      val <a title="scala.collection.mutable.LinkedHashMap[CommonSubconditionElimination.this.Test,Set[CommonSubconditionElimination.this.Prop]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.dependencies">dependencies</a> = new mutable.<a href="../../../../collection/mutable/LinkedHashMap.scala.html#scala.collection.mutable;LinkedHashMap" title="scala.collection.mutable.LinkedHashMap[CommonSubconditionElimination.this.Test,Set[CommonSubconditionElimination.this.Prop]]">LinkedHashMap</a><span class="delimiter">[</span>Test, Set<span class="delimiter">[</span>Prop<span class="delimiter">]</span><span class="delimiter">]</span>
      val <a title="scala.collection.mutable.HashSet[CommonSubconditionElimination.this.Prop]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.tested">tested</a> = new mutable.<a href="../../../../collection/mutable/HashSet.scala.html#scala.collection.mutable;HashSet" title="scala.collection.mutable.HashSet[CommonSubconditionElimination.this.Prop]">HashSet</a><span class="delimiter">[</span>Prop<span class="delimiter">]</span>

      <span class="comment">// TODO: use SAT solver instead of hashconsing props and approximating implication by subset/equality</span>
      def <a title="(test: CommonSubconditionElimination.this.Test)Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies">storeDependencies</a><span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.test">test</a>: <a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test" title="CommonSubconditionElimination.this.Test">Test</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
        val <a title="CommonSubconditionElimination.this.Prop" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.cond">cond</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.test" title="CommonSubconditionElimination.this.Test">test</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.prop" title="=&gt; CommonSubconditionElimination.this.Prop">prop</a>

        def <a title="(c: CommonSubconditionElimination.this.Prop)Set[CommonSubconditionElimination.this.Prop]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify">simplify</a><span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Prop" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify.c">c</a>: <a href="Logic.scala.html#scala.tools.nsc.transform.patmat;Logic;PropositionalLogic;Prop" title="CommonSubconditionElimination.this.Prop">Prop</a><span class="delimiter">)</span>: <a href="../../../../collection/immutable/Set.scala.html#scala.collection.immutable;Set" title="Set[CommonSubconditionElimination.this.Prop]">Set</a><span class="delimiter">[</span>Prop<span class="delimiter">]</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify.c" title="CommonSubconditionElimination.this.Prop">c</a> match <span class="delimiter">{</span>
          case And<span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Prop" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify.a">a</a>, <a title="CommonSubconditionElimination.this.Prop" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify.b">b</a><span class="delimiter">)</span>                  =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify" title="(c: CommonSubconditionElimination.this.Prop)Set[CommonSubconditionElimination.this.Prop]">simplify</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify.a" title="CommonSubconditionElimination.this.Prop">a</a><span class="delimiter">)</span> <a href="../../../../collection/SetLike.scala.html#scala.collection;SetLike.++(07e1553119)" title="(elems: scala.collection.GenTraversableOnce[CommonSubconditionElimination.this.Prop])scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">++</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify" title="(c: CommonSubconditionElimination.this.Prop)Set[CommonSubconditionElimination.this.Prop]">simplify</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify.b" title="CommonSubconditionElimination.this.Prop">b</a><span class="delimiter">)</span>
          case Or<span class="delimiter">(</span>_, _<span class="delimiter">)</span>                   =&gt; <a href="../../../../collection/generic/GenericCompanion.scala.html#scala.collection.generic;GenericCompanion.apply" title="(elems: CommonSubconditionElimination.this.Prop*)scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">Set</a><span class="delimiter">(</span><a href="Logic.scala.html#scala.tools.nsc.transform.patmat;Logic;PropositionalLogic.False" title="CommonSubconditionElimination.this.False.type">False</a><span class="delimiter">)</span> <span class="comment">// TODO: make more precise</span>
          case Not<span class="delimiter">(</span>Eq<span class="delimiter">(</span><a href="Logic.scala.html#scala.tools.nsc.transform.patmat;ScalaLogic;TreesAndTypesDomain.Var.unapply" title="(v: CommonSubconditionElimination.this.Var)Some[CommonSubconditionElimination.this.Tree]">Var</a><span class="delimiter">(</span>_<span class="delimiter">)</span>, <a href="Logic.scala.html#scala.tools.nsc.transform.patmat;ScalaLogic;TreesAndTypesDomain.NullConst" title="CommonSubconditionElimination.this.NullConst.type">NullConst</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="../../../../collection/generic/GenericCompanion.scala.html#scala.collection.generic;GenericCompanion.apply" title="(elems: CommonSubconditionElimination.this.Prop*)scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">Set</a><span class="delimiter">(</span><a href="Logic.scala.html#scala.tools.nsc.transform.patmat;Logic;PropositionalLogic.True" title="CommonSubconditionElimination.this.True.type">True</a><span class="delimiter">)</span>  <span class="comment">// not worth remembering</span>
          case _                          =&gt; <a href="../../../../collection/generic/GenericCompanion.scala.html#scala.collection.generic;GenericCompanion.apply" title="(elems: CommonSubconditionElimination.this.Prop*)scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">Set</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify.c" title="CommonSubconditionElimination.this.Prop">c</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        val <a title="Set[CommonSubconditionElimination.this.Prop]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.conds">conds</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify" title="(c: CommonSubconditionElimination.this.Prop)Set[CommonSubconditionElimination.this.Prop]">simplify</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.cond" title="CommonSubconditionElimination.this.Prop">cond</a><span class="delimiter">)</span>

        if <span class="delimiter">(</span><a href="../../../../collection/GenSetLike.scala.html#scala.collection;GenSetLike.apply" title="(elem: CommonSubconditionElimination.this.Prop)Boolean">conds</a><span class="delimiter">(</span><a href="Logic.scala.html#scala.tools.nsc.transform.patmat;Logic;PropositionalLogic.False" title="CommonSubconditionElimination.this.False.type">False</a><span class="delimiter">)</span><span class="delimiter">)</span> false <span class="comment">// stop when we encounter a definite &quot;no&quot; or a &quot;not sure&quot;</span>
        else <span class="delimiter">{</span>
          val nonTrivial = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.conds" title="Set[CommonSubconditionElimination.this.Prop]">conds</a> <a href="../../../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.filterNot" title="scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.nonTrivial">filterNot</a> <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.nonTrivial.$anonfun.x$1" title="CommonSubconditionElimination.this.Prop">_</a> <span title="(x$1: Any)Boolean">==</span> <a href="Logic.scala.html#scala.tools.nsc.transform.patmat;Logic;PropositionalLogic.True" title="CommonSubconditionElimination.this.True.type">True</a><span class="delimiter">)</span>
          if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.nonTrivial" title="scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">nonTrivial</a> <a href="../../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.nonEmpty" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.tested" title="scala.collection.mutable.HashSet[CommonSubconditionElimination.this.Prop]">tested</a> <a href="../../../../collection/generic/Growable.scala.html#scala.collection.generic;Growable.++=" title="(xs: scala.collection.TraversableOnce[CommonSubconditionElimination.this.Prop])tested.type">++=</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.nonTrivial" title="scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">nonTrivial</a>

            <span class="comment">// is there an earlier test that checks our condition and whose dependencies are implied by ours?</span>
            <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.dependencies" title="scala.collection.mutable.LinkedHashMap[CommonSubconditionElimination.this.Test,Set[CommonSubconditionElimination.this.Prop]]">dependencies</a> <a href="../../../../collection/IterableLike.scala.html#scala.collection;IterableLike.find" title="(p: ((CommonSubconditionElimination.this.Test, Set[CommonSubconditionElimination.this.Prop])) =&gt; Boolean)Option[(CommonSubconditionElimination.this.Test, Set[CommonSubconditionElimination.this.Prop])]">find</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.$anonfun.x0$1" title="Boolean" class="delimiter">{</a>
              case <span class="delimiter">(</span><span title="CommonSubconditionElimination.this.Test">priorTest</span>, <a title="Set[CommonSubconditionElimination.this.Prop]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.$anonfun.deps">deps</a><span class="delimiter">)</span> =&gt;
                <span class="delimiter">(</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.simplify" title="(c: CommonSubconditionElimination.this.Prop)Set[CommonSubconditionElimination.this.Prop]">simplify</a><span class="delimiter">(</span><span title="CommonSubconditionElimination.this.Test">priorTest</span>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.prop" title="=&gt; CommonSubconditionElimination.this.Prop">prop</a><span class="delimiter">)</span> <span title="(x$1: Any)Boolean">==</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.nonTrivial" title="scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">nonTrivial</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <span class="comment">// our conditions are implied by priorTest if it checks the same thing directly</span>
                 <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.nonTrivial" title="scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">nonTrivial</a> <a href="../../../../collection/GenSetLike.scala.html#scala.collection;GenSetLike.subsetOf" title="(that: scala.collection.GenSet[CommonSubconditionElimination.this.Prop])Boolean">subsetOf</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.$anonfun.deps" title="Set[CommonSubconditionElimination.this.Prop]">deps</a><span class="delimiter">)</span>                  <span class="comment">// or if it depends on a superset of our conditions</span>
                <span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.$anonfun.deps" title="Set[CommonSubconditionElimination.this.Prop]">deps</a> <a href="../../../../collection/GenSetLike.scala.html#scala.collection;GenSetLike.subsetOf" title="(that: scala.collection.GenSet[CommonSubconditionElimination.this.Prop])Boolean">subsetOf</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.tested" title="scala.collection.mutable.HashSet[CommonSubconditionElimination.this.Prop]">tested</a><span class="delimiter">)</span>                 <span class="comment">// the conditions we've tested when we are here in the match satisfy the prior test, and hence what it tested</span>
            <span class="delimiter">}</span> <a href="../../../../Option.scala.html#scala;Option.foreach" title="(f: ((CommonSubconditionElimination.this.Test, Set[CommonSubconditionElimination.this.Prop])) =&gt; Unit)Unit">foreach</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.$anonfun.x0$2" title="Unit" class="delimiter">{</a>
              case <span class="delimiter">(</span><span title="CommonSubconditionElimination.this.Test">priorTest</span>, _<span class="delimiter">)</span> =&gt;
                <span class="comment">// if so, note the dependency in both tests</span>
                <span title="CommonSubconditionElimination.this.Test">priorTest</span> <a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.registerReuseBy" title="(later: CommonSubconditionElimination.this.Test)Unit">registerReuseBy</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.test" title="CommonSubconditionElimination.this.Test">test</a>
            <span class="delimiter">}</span>

            <a href="../../../../collection/mutable/MapLike.scala.html#scala.collection.mutable;MapLike.update" title="(key: CommonSubconditionElimination.this.Test, value: Set[CommonSubconditionElimination.this.Prop])Unit">dependencies</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies.test" title="CommonSubconditionElimination.this.Test">test</a><span class="delimiter">)</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.tested" title="scala.collection.mutable.HashSet[CommonSubconditionElimination.this.Prop]">tested</a>.<a href="../../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toSet" title="scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">toSet</a> <span class="comment">// copies</span>
          <span class="delimiter">}</span>
          true
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>


      <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.testss" title="List[List[CommonSubconditionElimination.this.Test]]">testss</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.foreach" title="(f: List[CommonSubconditionElimination.this.Test] =&gt; List[CommonSubconditionElimination.this.Test])Unit">foreach</a> <span class="delimiter">{</span> <a title="List[CommonSubconditionElimination.this.Test]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.$anonfun.tests">tests</a> =&gt;
        <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.tested" title="scala.collection.mutable.HashSet[CommonSubconditionElimination.this.Prop]">tested</a>.<a href="../../../../collection/mutable/HashSet.scala.html#scala.collection.mutable;HashSet.clear" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.$anonfun.tests" title="List[CommonSubconditionElimination.this.Test]">tests</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.dropWhile" title="(p: CommonSubconditionElimination.this.Test =&gt; Boolean)List[CommonSubconditionElimination.this.Test]">dropWhile</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.storeDependencies" title="(test: CommonSubconditionElimination.this.Test)Boolean">storeDependencies</a>
      <span class="delimiter">}</span>
      <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.debug" title="MatchOptimization.this.debug.type">debug</a>.<a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.debug.patmat" title="(s: =&gt; String)Unit">patmat</a><span class="delimiter">(</span><span title="String(&quot;dependencies: &quot;)" class="string">&quot;dependencies: &quot;</span><span title="(x$1: Any)String">+</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.dependencies" title="scala.collection.mutable.LinkedHashMap[CommonSubconditionElimination.this.Test,Set[CommonSubconditionElimination.this.Prop]]">dependencies</a><span class="delimiter">)</span>

      <span class="comment">// find longest prefix of tests that reuse a prior test, and whose dependent conditions monotonically increase</span>
      <span class="comment">// then, collapse these contiguous sequences of reusing tests</span>
      <span class="comment">// store the result of the final test and the intermediate results in hoisted mutable variables (TODO: optimize: don't store intermediate results that aren't used)</span>
      <span class="comment">// replace each reference to a variable originally bound by a collapsed test by a reference to the hoisted variable</span>
      val <a title="scala.collection.mutable.HashMap[CommonSubconditionElimination.this.TreeMaker,CommonSubconditionElimination.this.ReusedCondTreeMaker]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reused">reused</a> = new mutable.<a href="../../../../collection/mutable/HashMap.scala.html#scala.collection.mutable;HashMap" title="scala.collection.mutable.HashMap[CommonSubconditionElimination.this.TreeMaker,CommonSubconditionElimination.this.ReusedCondTreeMaker]">HashMap</a><span class="delimiter">[</span>TreeMaker, ReusedCondTreeMaker<span class="delimiter">]</span>
      var <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.okToCall">okToCall</a> = false
      val <a title="CommonSubconditionElimination.this.TreeMaker =&gt; CommonSubconditionElimination.this.TreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reusedOrOrig">reusedOrOrig</a> = <span class="delimiter">(</span>tm: <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TreeMaker" title="CommonSubconditionElimination.this.TreeMaker">TreeMaker</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span><a href="../../Global.scala.html#scala.tools.nsc;Global.assert(65d7b4917f)" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.okToCall" title="Boolean">okToCall</a><span class="delimiter">)</span>; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reused" title="scala.collection.mutable.HashMap[CommonSubconditionElimination.this.TreeMaker,CommonSubconditionElimination.this.ReusedCondTreeMaker]">reused</a>.<a href="../../../../collection/MapLike.scala.html#scala.collection;MapLike.getOrElse" title="(key: CommonSubconditionElimination.this.TreeMaker, default: =&gt; CommonSubconditionElimination.this.TreeMaker)CommonSubconditionElimination.this.TreeMaker">getOrElse</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reusedOrOrig.$anonfun.tm" title="CommonSubconditionElimination.this.TreeMaker">tm</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reusedOrOrig.$anonfun.tm" title="CommonSubconditionElimination.this.TreeMaker">tm</a><span class="delimiter">)</span><span class="delimiter">}</span>

      <span class="comment">// maybe collapse: replace shared prefix of tree makers by a ReusingCondTreeMaker</span>
      <span class="comment">// once this has been computed, we'll know which tree makers are reused,</span>
      <span class="comment">// and we'll replace those by the ReusedCondTreeMakers we've constructed (and stored in the reused map)</span>
      val collapsed = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.testss" title="List[List[CommonSubconditionElimination.this.Test]]">testss</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="List[List[CommonSubconditionElimination.this.TreeMaker]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed">map</a> <span class="delimiter">{</span> <a title="List[CommonSubconditionElimination.this.Test]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.tests">tests</a> =&gt;
        <span class="comment">// map tests to the equivalent list of treemakers, replacing shared prefixes by a reusing treemaker</span>
        <span class="comment">// if there's no sharing, simply map to the tree makers corresponding to the tests</span>
        var <a title="scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.currDeps">currDeps</a> = <a href="../../../../collection/generic/GenericCompanion.scala.html#scala.collection.generic;GenericCompanion.apply" title="[A](elems: A*)scala.collection.immutable.Set[A]">Set</a><span title="(elems: CommonSubconditionElimination.this.Prop*)scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]" class="delimiter">[</span><a href="Logic.scala.html#scala.tools.nsc.transform.patmat;Logic;PropositionalLogic;Prop" title="CommonSubconditionElimination.this.Prop">Prop</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
        val <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: List[CommonSubconditionElimination.this.Test], _2: List[CommonSubconditionElimination.this.Test])(List[CommonSubconditionElimination.this.Test], List[CommonSubconditionElimination.this.Test])" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#scala;Tuple2._1" title="List[CommonSubconditionElimination.this.Test]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.sharedPrefix">sharedPrefix</a>, <a href="../../../../Tuple2.scala.html#scala;Tuple2._2" title="List[CommonSubconditionElimination.this.Test]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.suffix">suffix</a><span class="delimiter">)</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.tests" title="List[CommonSubconditionElimination.this.Test]">tests</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.span" title="(List[CommonSubconditionElimination.this.Test], List[CommonSubconditionElimination.this.Test])">span</a> <span class="delimiter">{</span> <a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.test">test</a> =&gt;
          <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.test" title="CommonSubconditionElimination.this.Test">test</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.prop" title="=&gt; CommonSubconditionElimination.this.Prop">prop</a> <span title="(x$1: Any)Boolean">==</span> <a href="Logic.scala.html#scala.tools.nsc.transform.patmat;Logic;PropositionalLogic.True" title="CommonSubconditionElimination.this.True.type">True</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span>for<span class="delimiter">(</span>
              <a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.$anonfun.reusedTest">reusedTest</a> &lt;- <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.test" title="CommonSubconditionElimination.this.Test">test</a>.<a href="../../../../Option.scala.html#scala;Option.flatMap" title="(f: CommonSubconditionElimination.this.Test =&gt; Option[CommonSubconditionElimination.this.Prop])Option[CommonSubconditionElimination.this.Prop]">reuses</a>;
              <a title="Set[CommonSubconditionElimination.this.Prop]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.$anonfun.$anonfun.nextDeps">nextDeps</a> &lt;- <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.dependencies" title="scala.collection.mutable.LinkedHashMap[CommonSubconditionElimination.this.Test,Set[CommonSubconditionElimination.this.Prop]]">dependencies</a>.<a href="../../../../collection/mutable/LinkedHashMap.scala.html#scala.collection.mutable;LinkedHashMap.get" title="(key: CommonSubconditionElimination.this.Test)Option[Set[CommonSubconditionElimination.this.Prop]]">get</a><a href="../../../../Option.scala.html#scala;Option.flatMap" title="(f: Set[CommonSubconditionElimination.this.Prop] =&gt; Option[CommonSubconditionElimination.this.Prop])Option[CommonSubconditionElimination.this.Prop]" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.$anonfun.reusedTest" title="CommonSubconditionElimination.this.Test">reusedTest</a><span class="delimiter">)</span>;
              <a title="CommonSubconditionElimination.this.Prop" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.$anonfun.$anonfun.$anonfun.diff">diff</a> &lt;- <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.$anonfun.$anonfun.nextDeps" title="Set[CommonSubconditionElimination.this.Prop]">nextDeps</a> <a href="../../../../collection/generic/Subtractable.scala.html#scala.collection.generic;Subtractable.--" title="(xs: scala.collection.GenTraversableOnce[CommonSubconditionElimination.this.Prop])scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">--</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.currDeps" title="scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">currDeps</a><span class="delimiter">)</span>.<a href="../../../../Option.scala.html#scala;Option.flatMap" title="(f: CommonSubconditionElimination.this.Prop =&gt; Option[CommonSubconditionElimination.this.Prop])Option[CommonSubconditionElimination.this.Prop]">headOption</a>;
              <a title="Unit" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.$anonfun.$anonfun.$anonfun.$anonfun._">_</a> &lt;- <a href="../../../../Option.scala.html#scala;Some" title="(x: Unit)Some[Unit]">Some</a><a href="../../../../Option.scala.html#scala;Option.map" title="(f: Unit =&gt; CommonSubconditionElimination.this.Prop)Option[CommonSubconditionElimination.this.Prop]" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.currDeps" title="scala.collection.immutable.Set[CommonSubconditionElimination.this.Prop]">currDeps</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.$anonfun.$anonfun.nextDeps" title="Set[CommonSubconditionElimination.this.Prop]">nextDeps</a><span class="delimiter">)</span><span class="delimiter">)</span>
                yield <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.x$2.$anonfun.$anonfun.$anonfun.$anonfun.diff" title="CommonSubconditionElimination.this.Prop">diff</a><span class="delimiter">)</span>.<a href="../../../../Option.scala.html#scala;Option.nonEmpty" title="=&gt; Boolean">nonEmpty</a>
        <span class="delimiter">}</span>

        val <a title="Option[List[CommonSubconditionElimination.this.TreeMaker]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers">collapsedTreeMakers</a> =
          if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.sharedPrefix" title="List[CommonSubconditionElimination.this.Test]">sharedPrefix</a>.<a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a>
          else <span class="delimiter">{</span> <span class="comment">// even sharing prefixes of length 1 brings some benefit (overhead-percentage for compiler: 26-&gt;24%, lib: 19-&gt;16%)</span>
            for <span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.test">test</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.foreach" title="(f: CommonSubconditionElimination.this.Test =&gt; Unit)Unit">sharedPrefix</a>; <a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.$anonfun.reusedTest">reusedTest</a> &lt;- <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.test" title="CommonSubconditionElimination.this.Test">test</a>.<a href="../../../../Option.scala.html#scala;Option.foreach" title="(f: CommonSubconditionElimination.this.Test =&gt; Unit)Unit">reuses</a><span class="delimiter">)</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.$anonfun.reusedTest" title="CommonSubconditionElimination.this.Test">reusedTest</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.treeMaker" title="=&gt; CommonSubconditionElimination.this.TreeMaker">treeMaker</a> match <span class="delimiter">{</span>
              case <a title="CommonSubconditionElimination.this.CondTreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.$anonfun.reusedCTM">reusedCTM</a>: <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;CondTreeMaker" title="CommonSubconditionElimination.this.CondTreeMaker">CondTreeMaker</a> =&gt; <a href="../../../../collection/mutable/HashMap.scala.html#scala.collection.mutable;HashMap.update" title="(key: CommonSubconditionElimination.this.TreeMaker, value: CommonSubconditionElimination.this.ReusedCondTreeMaker)Unit">reused</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.$anonfun.reusedCTM" title="CommonSubconditionElimination.this.CondTreeMaker">reusedCTM</a><span class="delimiter">)</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusedCondTreeMaker.apply" title="(orig: CommonSubconditionElimination.this.CondTreeMaker)CommonSubconditionElimination.this.ReusedCondTreeMaker">ReusedCondTreeMaker</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.$anonfun.reusedCTM" title="CommonSubconditionElimination.this.CondTreeMaker">reusedCTM</a><span class="delimiter">)</span>
              case _ =&gt;
            <span class="delimiter">}</span>

            <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.debug" title="MatchOptimization.this.debug.type">debug</a>.<a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.debug.patmat" title="(s: =&gt; String)Unit">patmat</a><span class="delimiter">(</span><span title="String(&quot;sharedPrefix: &quot;)" class="string">&quot;sharedPrefix: &quot;</span><span title="(x$1: Any)String">+</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.sharedPrefix" title="List[CommonSubconditionElimination.this.Test]">sharedPrefix</a><span class="delimiter">)</span>
            <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.debug" title="MatchOptimization.this.debug.type">debug</a>.<a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.debug.patmat" title="(s: =&gt; String)Unit">patmat</a><span class="delimiter">(</span><span title="String(&quot;suffix: &quot;)" class="string">&quot;suffix: &quot;</span><span title="(x$1: Any)String">+</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.sharedPrefix" title="List[CommonSubconditionElimination.this.Test]">sharedPrefix</a><span class="delimiter">)</span>
            <span class="comment">// if the shared prefix contains interesting conditions (!= True)</span>
            <span class="comment">// and the last of such interesting shared conditions reuses another treemaker's test</span>
            <span class="comment">// replace the whole sharedPrefix by a ReusingCondTreeMaker</span>
            for <span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.lastShared">lastShared</a> &lt;- <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.sharedPrefix" title="List[CommonSubconditionElimination.this.Test]">sharedPrefix</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.reverse" title="=&gt; List[CommonSubconditionElimination.this.Test]">reverse</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.dropWhile" title="(p: CommonSubconditionElimination.this.Test =&gt; Boolean)List[CommonSubconditionElimination.this.Test]">dropWhile</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.x$3" title="CommonSubconditionElimination.this.Test">_</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.prop" title="=&gt; CommonSubconditionElimination.this.Prop">prop</a> <span title="(x$1: Any)Boolean">==</span> <a href="Logic.scala.html#scala.tools.nsc.transform.patmat;Logic;PropositionalLogic.True" title="CommonSubconditionElimination.this.True.type">True</a><span class="delimiter">)</span>.<a href="../../../../Option.scala.html#scala;Option.flatMap" title="(f: CommonSubconditionElimination.this.Test =&gt; Option[List[CommonSubconditionElimination.this.TreeMaker]])Option[List[CommonSubconditionElimination.this.TreeMaker]]">headOption</a>;
                 <a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.$anonfun.lastReused">lastReused</a> &lt;- <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.lastShared" title="CommonSubconditionElimination.this.Test">lastShared</a>.<a href="../../../../Option.scala.html#scala;Option.map" title="(f: CommonSubconditionElimination.this.Test =&gt; List[CommonSubconditionElimination.this.TreeMaker])Option[List[CommonSubconditionElimination.this.TreeMaker]]">reuses</a><span class="delimiter">)</span>
              yield <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusingCondTreeMaker.readResolve" title="(sharedPrefix: List[CommonSubconditionElimination.this.Test], toReused: CommonSubconditionElimination.this.TreeMaker =&gt; CommonSubconditionElimination.this.TreeMaker)CommonSubconditionElimination.this.ReusingCondTreeMaker">ReusingCondTreeMaker</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.sharedPrefix" title="List[CommonSubconditionElimination.this.Test]">sharedPrefix</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reusedOrOrig" title="CommonSubconditionElimination.this.TreeMaker =&gt; CommonSubconditionElimination.this.TreeMaker">reusedOrOrig</a><span class="delimiter">)</span> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: CommonSubconditionElimination.this.TreeMaker)List[CommonSubconditionElimination.this.TreeMaker]">::</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.suffix" title="List[CommonSubconditionElimination.this.Test]">suffix</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: CommonSubconditionElimination.this.Test =&gt; CommonSubconditionElimination.this.TreeMaker)(implicit bf: scala.collection.generic.CanBuildFrom[List[CommonSubconditionElimination.this.Test],CommonSubconditionElimination.this.TreeMaker,List[CommonSubconditionElimination.this.TreeMaker]])List[CommonSubconditionElimination.this.TreeMaker]">map</a><a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.List.canBuildFrom" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,CommonSubconditionElimination.this.TreeMaker,List[CommonSubconditionElimination.this.TreeMaker]]" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers.$anonfun.$anonfun.$anonfun.x$4" title="CommonSubconditionElimination.this.Test">_</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.treeMaker" title="=&gt; CommonSubconditionElimination.this.TreeMaker">treeMaker</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.collapsedTreeMakers" title="Option[List[CommonSubconditionElimination.this.TreeMaker]]">collapsedTreeMakers</a> <a href="../../../../Option.scala.html#scala;Option.getOrElse" title="(default: =&gt; List[CommonSubconditionElimination.this.TreeMaker])List[CommonSubconditionElimination.this.TreeMaker]">getOrElse</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.tests" title="List[CommonSubconditionElimination.this.Test]">tests</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: CommonSubconditionElimination.this.Test =&gt; CommonSubconditionElimination.this.TreeMaker)(implicit bf: scala.collection.generic.CanBuildFrom[List[CommonSubconditionElimination.this.Test],CommonSubconditionElimination.this.TreeMaker,List[CommonSubconditionElimination.this.TreeMaker]])List[CommonSubconditionElimination.this.TreeMaker]">map</a><a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.List.canBuildFrom" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,CommonSubconditionElimination.this.TreeMaker,List[CommonSubconditionElimination.this.TreeMaker]]" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed.$anonfun.$anonfun.x$6" title="CommonSubconditionElimination.this.Test">_</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.treeMaker" title="=&gt; CommonSubconditionElimination.this.TreeMaker">treeMaker</a><span class="delimiter">)</span> <span class="comment">// sharedPrefix need not be empty (but it only contains True-tests, which are dropped above)</span>
      <span class="delimiter">}</span>
      <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.okToCall" title="Boolean">okToCall</a> = true <span class="comment">// TODO: remove (debugging)</span>

      <span class="comment">// replace original treemakers that are reused (as determined when computing collapsed),</span>
      <span class="comment">// by ReusedCondTreeMakers</span>
      val reusedMakers = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.collapsed" title="List[List[CommonSubconditionElimination.this.TreeMaker]]">collapsed</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.mapConserve" title="List[List[CommonSubconditionElimination.this.TreeMaker]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reusedMakers">mapConserve</a> <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reusedMakers.$anonfun.x$7" title="List[CommonSubconditionElimination.this.TreeMaker]">_</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.mapConserve" title="(f: CommonSubconditionElimination.this.TreeMaker =&gt; CommonSubconditionElimination.this.TreeMaker)List[CommonSubconditionElimination.this.TreeMaker]">mapConserve</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reusedOrOrig" title="CommonSubconditionElimination.this.TreeMaker =&gt; CommonSubconditionElimination.this.TreeMaker">reusedOrOrig</a><span class="delimiter">)</span>
      <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.debug" title="MatchOptimization.this.debug.type">debug</a>.<a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Debugging.debug.patmat" title="(s: =&gt; String)Unit">patmat</a><span class="delimiter">(</span><span title="String(&quot;after CSE:&quot;)" class="string">&quot;after CSE:&quot;</span><span class="delimiter">)</span>
      <a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator.showTreeMakers" title="(cases: List[List[CommonSubconditionElimination.this.TreeMaker]])Unit">showTreeMakers</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reusedMakers" title="List[List[CommonSubconditionElimination.this.TreeMaker]]">reusedMakers</a><span class="delimiter">)</span>
      <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE.reusedMakers" title="List[List[CommonSubconditionElimination.this.TreeMaker]]">reusedMakers</a>
    <span class="delimiter">}</span>

    object <a title="CommonSubconditionElimination.this.ReusedCondTreeMaker.type" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusedCondTreeMaker">ReusedCondTreeMaker</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusedCondTreeMaker" title="CommonSubconditionElimination.this.ReusedCondTreeMaker.type" class="delimiter">{</a>
      def <a title="(orig: CommonSubconditionElimination.this.CondTreeMaker)CommonSubconditionElimination.this.ReusedCondTreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusedCondTreeMaker.apply">apply</a><span class="delimiter">(</span><a title="CommonSubconditionElimination.this.CondTreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusedCondTreeMaker.apply.orig">orig</a>: <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;CondTreeMaker" title="CommonSubconditionElimination.this.CondTreeMaker">CondTreeMaker</a><span class="delimiter">)</span> = new <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker" title="CommonSubconditionElimination.this.ReusedCondTreeMaker">ReusedCondTreeMaker</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusedCondTreeMaker.apply.orig" title="CommonSubconditionElimination.this.CondTreeMaker">orig</a>.<a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;CondTreeMaker.prevBinder" title="=&gt; MatchOptimization.this.global.Symbol">prevBinder</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusedCondTreeMaker.apply.orig" title="CommonSubconditionElimination.this.CondTreeMaker">orig</a>.<a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;CondTreeMaker.nextBinder" title="=&gt; MatchOptimization.this.global.TermSymbol">nextBinder</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusedCondTreeMaker.apply.orig" title="CommonSubconditionElimination.this.CondTreeMaker">orig</a>.<a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;CondTreeMaker.cond" title="=&gt; MatchOptimization.this.global.Tree">cond</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusedCondTreeMaker.apply.orig" title="CommonSubconditionElimination.this.CondTreeMaker">orig</a>.<a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;CondTreeMaker.res" title="=&gt; MatchOptimization.this.global.Tree">res</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusedCondTreeMaker.apply.orig" title="CommonSubconditionElimination.this.CondTreeMaker">orig</a>.<a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;FunTreeMaker.pos" title="=&gt; MatchOptimization.this.global.Position">pos</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    class <a title="class ReusedCondTreeMaker extends CommonSubconditionElimination.this.TreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker">ReusedCondTreeMaker</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker" title="CommonSubconditionElimination.this.ReusedCondTreeMaker" class="delimiter">(</a><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.prevBinder">prevBinder</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a>, val <a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.nextBinder">nextBinder</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a>, <a title="CommonSubconditionElimination.this.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.cond">cond</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CommonSubconditionElimination.this.Tree">Tree</a>, <a title="CommonSubconditionElimination.this.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.res">res</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CommonSubconditionElimination.this.Tree">Tree</a>, val <a title="MatchOptimization.this.global.Position" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.pos">pos</a>: <a href="../../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;Position" title="MatchOptimization.this.global.Position">Position</a><span class="delimiter">)</span> extends <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TreeMaker" title="CommonSubconditionElimination.this.TreeMaker">TreeMaker</a> <span class="delimiter">{</span>
      lazy val <a title="CommonSubconditionElimination.this.Substitution" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.localSubstitution">localSubstitution</a>        = <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface;TypedSubstitution.Substitution.apply(3d78526d98)" title="(from: List[MatchOptimization.this.global.Symbol], to: List[MatchOptimization.this.global.Tree])CommonSubconditionElimination.this.Substitution">Substitution</a><span class="delimiter">(</span><a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: MatchOptimization.this.global.Symbol*)List[MatchOptimization.this.global.Symbol]">List</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.prevBinder" title="MatchOptimization.this.global.Symbol">prevBinder</a><span class="delimiter">)</span>, <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: MatchOptimization.this.global.gen.global.RefTree*)List[MatchOptimization.this.global.gen.global.RefTree]">List</a><span class="delimiter">(</span><a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE" title="MatchOptimization.this.CODE.type">CODE</a>.<a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.REF(aa0d4af395)" title="(sym: MatchOptimization.this.global.Symbol)MatchOptimization.this.global.gen.global.RefTree">REF</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.nextBinder" title="=&gt; MatchOptimization.this.global.Symbol">nextBinder</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      lazy val storedCond               = <a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;CodegenCore.freshSym" title="(pos: MatchOptimization.this.global.Position, tp: MatchOptimization.this.global.Type, prefix: String)MatchOptimization.this.global.TermSymbol">freshSym</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.pos" title="=&gt; MatchOptimization.this.global.Position">pos</a>, <a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;ValueClassDefinitions.BooleanTpe" title="=&gt; MatchOptimization.this.global.Type">BooleanTpe</a>, <span title="String(&quot;rc&quot;)" class="string">&quot;rc&quot;</span><span class="delimiter">)</span> <a title="MatchOptimization.this.global.TermSymbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.storedCond">setFlag</a> <span title="Long(4096L)">MUTABLE</span>
      lazy val <a title="List[CommonSubconditionElimination.this.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.treesToHoist">treesToHoist</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CommonSubconditionElimination.this.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <span class="delimiter">{</span>
        <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.nextBinder" title="=&gt; MatchOptimization.this.global.Symbol">nextBinder</a> <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.setFlag" title="(mask: Long)ReusedCondTreeMaker.this.nextBinder.type">setFlag</a> <span title="Long(4096L)">MUTABLE</span>
        <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: MatchOptimization.this.global.Symbol*)List[MatchOptimization.this.global.Symbol]">List</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.storedCond" title="=&gt; MatchOptimization.this.global.TermSymbol">storedCond</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.nextBinder" title="=&gt; MatchOptimization.this.global.Symbol">nextBinder</a><span class="delimiter">)</span> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: MatchOptimization.this.global.Symbol =&gt; MatchOptimization.this.global.ValDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatchOptimization.this.global.Symbol],MatchOptimization.this.global.ValDef,List[CommonSubconditionElimination.this.Tree]])List[CommonSubconditionElimination.this.Tree]">map</a> <span class="delimiter">(</span><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.treesToHoist.$anonfun.b">b</a> =&gt; <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.ValDef.apply(9493665b33)" title="(sym: MatchOptimization.this.global.Symbol, rhs: MatchOptimization.this.global.Tree)MatchOptimization.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.treesToHoist.$anonfun.b" title="MatchOptimization.this.global.Symbol">b</a>, <a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;OptimizedCodegen.codegen" title="=&gt; CommonSubconditionElimination.this.AbsCodegen">codegen</a>.<a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;CodegenCore;AbsCodegen.mkZero" title="(tp: MatchOptimization.this.global.Type)MatchOptimization.this.global.Tree">mkZero</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.treesToHoist.$anonfun.b" title="MatchOptimization.this.global.Symbol">b</a>.<a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.info" title="=&gt; MatchOptimization.this.global.Type">info</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="comment">// TODO: finer-grained duplication</span>
      def <a title="(next: CommonSubconditionElimination.this.Tree)(casegen: CommonSubconditionElimination.this.Casegen)CommonSubconditionElimination.this.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.chainBefore">chainBefore</a><span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.chainBefore.next">next</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CommonSubconditionElimination.this.Tree">Tree</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Casegen" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.chainBefore.casegen">casegen</a>: <a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;CodegenCore;Casegen" title="CommonSubconditionElimination.this.Casegen">Casegen</a><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CommonSubconditionElimination.this.Tree">Tree</a> = <span class="comment">// assert(codegen eq optimizedCodegen)</span>
        <a href="../../../../reflect/internal/Positions.scala.html#scala.reflect.internal;Positions.atPos" title="(pos: MatchOptimization.this.global.Position)(tree: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">atPos</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.pos" title="=&gt; MatchOptimization.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.chainBefore.casegen" title="CommonSubconditionElimination.this.Casegen">casegen</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="CommonSubconditionElimination.this.optimizedCodegen.OptimizedCasegen" class="delimiter">[</span>optimizedCodegen.<a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;OptimizedCodegen.optimizedCodegen;OptimizedCasegen" title="CommonSubconditionElimination.this.optimizedCodegen.OptimizedCasegen">OptimizedCasegen</a><span class="delimiter">]</span>.<a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;OptimizedCodegen.optimizedCodegen;OptimizedCasegen.flatMapCondStored" title="(cond: MatchOptimization.this.global.Tree, condSym: MatchOptimization.this.global.Symbol, res: MatchOptimization.this.global.Tree, nextBinder: MatchOptimization.this.global.Symbol, next: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">flatMapCondStored</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.cond" title="CommonSubconditionElimination.this.Tree">cond</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.storedCond" title="=&gt; MatchOptimization.this.global.TermSymbol">storedCond</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.res" title="CommonSubconditionElimination.this.Tree">res</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.nextBinder" title="=&gt; MatchOptimization.this.global.Symbol">nextBinder</a>, <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface;TypedSubstitution;Substitution.apply" title="(tree: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">substitution</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.chainBefore.next" title="CommonSubconditionElimination.this.Tree">next</a><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.duplicate" title="=&gt; MatchOptimization.this.global.Tree">duplicate</a><span class="delimiter">)</span><span class="delimiter">)</span>

      override def <a title="()String" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.toString">toString</a> = <span title="String(&quot;Memo&quot;)" class="string">&quot;Memo&quot;</span><span title="(x$1: Any)String">+</span><span class="delimiter">(</span><a href="../../../../Tuple5.scala.html#scala;Tuple5" title="(_1: ReusedCondTreeMaker.this.nextBinder.NameType, _2: MatchOptimization.this.global.TermName, _3: CommonSubconditionElimination.this.Tree, _4: CommonSubconditionElimination.this.Tree, _5: CommonSubconditionElimination.this.Substitution)(ReusedCondTreeMaker.this.nextBinder.NameType, MatchOptimization.this.global.TermName, CommonSubconditionElimination.this.Tree, CommonSubconditionElimination.this.Tree, CommonSubconditionElimination.this.Substitution)" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.nextBinder" title="=&gt; MatchOptimization.this.global.Symbol">nextBinder</a>.<a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.name" title="=&gt; ReusedCondTreeMaker.this.nextBinder.NameType">name</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.storedCond" title="=&gt; MatchOptimization.this.global.TermSymbol">storedCond</a>.<a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;TermSymbol.name" title="=&gt; MatchOptimization.this.global.TermName">name</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.cond" title="CommonSubconditionElimination.this.Tree">cond</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.res" title="CommonSubconditionElimination.this.Tree">res</a>, <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TreeMaker.substitution" title="=&gt; CommonSubconditionElimination.this.Substitution">substitution</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    case class <a title="class ReusingCondTreeMaker extends CommonSubconditionElimination.this.TreeMaker with Product with Serializable" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.ReusingCondTreeMaker.readResolve">ReusingCondTreeMaker</a><a href="../../../../Product.scala.html#scala;Product" title="Product" class="delimiter">(</a><a title="List[CommonSubconditionElimination.this.Test]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.sharedPrefix">sharedPrefix</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[CommonSubconditionElimination.this.Test]">List</a><span class="delimiter">[</span>Test<span class="delimiter">]</span>, <a title="CommonSubconditionElimination.this.TreeMaker =&gt; CommonSubconditionElimination.this.TreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.toReused">toReused</a>: TreeMaker =&gt; TreeMaker<span class="delimiter">)</span> extends <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TreeMaker" title="CommonSubconditionElimination.this.TreeMaker">TreeMaker</a> <span class="delimiter">{</span> import <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE" title="MatchOptimization.this.CODE.type">CODE</a>._
      val <a title="MatchOptimization.this.global.Position" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.pos">pos</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.sharedPrefix" title="=&gt; List[CommonSubconditionElimination.this.Test]">sharedPrefix</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.last" title="=&gt; CommonSubconditionElimination.this.Test">last</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.treeMaker" title="=&gt; CommonSubconditionElimination.this.TreeMaker">treeMaker</a>.<a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TreeMaker.pos" title="=&gt; MatchOptimization.this.global.Position">pos</a>

      lazy val <a title="CommonSubconditionElimination.this.Substitution" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution">localSubstitution</a> = <span class="delimiter">{</span>
        <span class="comment">// replace binder of each dropped treemaker by corresponding binder bound by the most recent reused treemaker</span>
        var <a title="CommonSubconditionElimination.this.ReusedCondTreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.mostRecentReusedMaker">mostRecentReusedMaker</a>: <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker" title="CommonSubconditionElimination.this.ReusedCondTreeMaker">ReusedCondTreeMaker</a> = null
        def <a title="(droppedBinder: MatchOptimization.this.global.Symbol)List[(MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree)]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.mapToStored">mapToStored</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.mapToStored.droppedBinder">droppedBinder</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.mostRecentReusedMaker" title="CommonSubconditionElimination.this.ReusedCondTreeMaker">mostRecentReusedMaker</a> <span title="(x$1: AnyRef)Boolean">eq</span> null<span class="delimiter">)</span> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a> else <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: (MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree)*)List[(MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree)]">List</a><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: MatchOptimization.this.global.Symbol, _2: MatchOptimization.this.global.gen.global.RefTree)(MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree)" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.mapToStored.droppedBinder" title="MatchOptimization.this.global.Symbol">droppedBinder</a>, <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.REF(aa0d4af395)" title="(sym: MatchOptimization.this.global.Symbol)MatchOptimization.this.global.gen.global.RefTree">REF</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.mostRecentReusedMaker" title="CommonSubconditionElimination.this.ReusedCondTreeMaker">mostRecentReusedMaker</a>.<a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.nextBinder" title="=&gt; MatchOptimization.this.global.Symbol">nextBinder</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        val <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(List[MatchOptimization.this.global.Symbol], List[MatchOptimization.this.global.gen.global.RefTree])" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#scala;Tuple2._1" title="List[MatchOptimization.this.global.Symbol]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.from">from</a>, <a href="../../../../Tuple2.scala.html#scala;Tuple2._2" title="List[MatchOptimization.this.global.gen.global.RefTree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.to">to</a><span class="delimiter">)</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.sharedPrefix" title="=&gt; List[CommonSubconditionElimination.this.Test]">sharedPrefix</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.flatMap" title="(f: CommonSubconditionElimination.this.Test =&gt; scala.collection.GenTraversableOnce[(MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree)])(implicit bf: scala.collection.generic.CanBuildFrom[List[CommonSubconditionElimination.this.Test],(MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree),List[(MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree)]])List[(MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree)]">flatMap</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.List.canBuildFrom" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,(MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree),List[(MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree)]]" class="delimiter">{</a> <span title="CommonSubconditionElimination.this.Test">dropped</span> =&gt;
          <span title="CommonSubconditionElimination.this.Test">dropped</span>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.reuses" title="=&gt; Option[CommonSubconditionElimination.this.Test]">reuses</a>.<a href="../../../../Option.scala.html#scala;Option.map" title="(f: CommonSubconditionElimination.this.Test =&gt; CommonSubconditionElimination.this.TreeMaker)Option[CommonSubconditionElimination.this.TreeMaker]">map</a><span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.x$8.$anonfun.$anonfun.test">test</a> =&gt; <a href="../../../../Function1.scala.html#scala;Function1.apply" title="(v1: CommonSubconditionElimination.this.TreeMaker)CommonSubconditionElimination.this.TreeMaker">toReused</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.x$8.$anonfun.$anonfun.test" title="CommonSubconditionElimination.this.Test">test</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.treeMaker" title="=&gt; CommonSubconditionElimination.this.TreeMaker">treeMaker</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../Option.scala.html#scala;Option.foreach" title="(f: CommonSubconditionElimination.this.TreeMaker =&gt; Unit)Unit">foreach</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.x$8.$anonfun.$anonfun.x0$3" title="Unit" class="delimiter">{</a>
            case <a title="CommonSubconditionElimination.this.ReusedCondTreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.x$8.$anonfun.$anonfun.reusedMaker">reusedMaker</a>: <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker" title="CommonSubconditionElimination.this.ReusedCondTreeMaker">ReusedCondTreeMaker</a> =&gt;
              <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.mostRecentReusedMaker" title="CommonSubconditionElimination.this.ReusedCondTreeMaker">mostRecentReusedMaker</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.x$8.$anonfun.$anonfun.reusedMaker" title="CommonSubconditionElimination.this.ReusedCondTreeMaker">reusedMaker</a>
            case _ =&gt;
          <span class="delimiter">}</span>

          <span class="comment">// TODO: have super-trait for retrieving the variable that's operated on by a tree maker</span>
          <span class="comment">// and thus assumed in scope, either because it binds it or because it refers to it</span>
          <span title="CommonSubconditionElimination.this.Test">dropped</span>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.treeMaker" title="=&gt; CommonSubconditionElimination.this.TreeMaker">treeMaker</a> match <span class="delimiter">{</span>
            case <span title="CommonSubconditionElimination.this.FunTreeMaker">dropped</span>: <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;FunTreeMaker" title="CommonSubconditionElimination.this.FunTreeMaker">FunTreeMaker</a> =&gt;
              <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.mapToStored" title="(droppedBinder: MatchOptimization.this.global.Symbol)List[(MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree)]">mapToStored</a><span class="delimiter">(</span><span title="CommonSubconditionElimination.this.FunTreeMaker">dropped</span>.<a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;FunTreeMaker.nextBinder" title="=&gt; MatchOptimization.this.global.Symbol">nextBinder</a><span class="delimiter">)</span>
            case _ =&gt; <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>.<a href="../../../../collection/generic/GenericTraversableTemplate.scala.html#scala.collection.generic;GenericTraversableTemplate.unzip" title="(implicit asPair: ((MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree)) =&gt; (MatchOptimization.this.global.Symbol, MatchOptimization.this.global.gen.global.RefTree))(List[MatchOptimization.this.global.Symbol], List[MatchOptimization.this.global.gen.global.RefTree])">unzip</a>
        val <a title="CommonSubconditionElimination.this.Substitution" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.rerouteToReusedBinders">rerouteToReusedBinders</a> = <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface;TypedSubstitution.Substitution.apply(3d78526d98)" title="(from: List[MatchOptimization.this.global.Symbol], to: List[MatchOptimization.this.global.Tree])CommonSubconditionElimination.this.Substitution">Substitution</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.from" title="List[MatchOptimization.this.global.Symbol]">from</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.to" title="List[MatchOptimization.this.global.gen.global.RefTree]">to</a><span class="delimiter">)</span>

        val collapsedDroppedSubst = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.sharedPrefix" title="=&gt; List[CommonSubconditionElimination.this.Test]">sharedPrefix</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="List[CommonSubconditionElimination.this.Substitution]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.collapsedDroppedSubst">map</a> <span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.collapsedDroppedSubst.$anonfun.t">t</a> =&gt; <span class="delimiter">(</span><a href="../../../../Function1.scala.html#scala;Function1.apply" title="(v1: CommonSubconditionElimination.this.TreeMaker)CommonSubconditionElimination.this.TreeMaker">toReused</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.collapsedDroppedSubst.$anonfun.t" title="CommonSubconditionElimination.this.Test">t</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.treeMaker" title="=&gt; CommonSubconditionElimination.this.TreeMaker">treeMaker</a><span class="delimiter">)</span>.<a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TreeMaker.substitution" title="=&gt; CommonSubconditionElimination.this.Substitution">substitution</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.collapsedDroppedSubst" title="List[CommonSubconditionElimination.this.Substitution]">collapsedDroppedSubst</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.foldLeft" title="(z: CommonSubconditionElimination.this.Substitution)(f: (CommonSubconditionElimination.this.Substitution, CommonSubconditionElimination.this.Substitution) =&gt; CommonSubconditionElimination.this.Substitution)CommonSubconditionElimination.this.Substitution">foldLeft</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.rerouteToReusedBinders" title="CommonSubconditionElimination.this.Substitution">rerouteToReusedBinders</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.$anonfun.x$9" title="CommonSubconditionElimination.this.Substitution">_</a> <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface;TypedSubstitution;Substitution.>>" title="(other: CommonSubconditionElimination.this.Substitution)CommonSubconditionElimination.this.Substitution">&gt;&gt;</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.localSubstitution.$anonfun.x$10" title="CommonSubconditionElimination.this.Substitution">_</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      lazy val <a title="CommonSubconditionElimination.this.ReusedCondTreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.lastReusedTreeMaker">lastReusedTreeMaker</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.sharedPrefix" title="=&gt; List[CommonSubconditionElimination.this.Test]">sharedPrefix</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.reverse" title="=&gt; List[CommonSubconditionElimination.this.Test]">reverse</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.flatMap" title="(f: CommonSubconditionElimination.this.Test =&gt; scala.collection.GenTraversableOnce[CommonSubconditionElimination.this.TreeMaker])(implicit bf: scala.collection.generic.CanBuildFrom[List[CommonSubconditionElimination.this.Test],CommonSubconditionElimination.this.TreeMaker,List[CommonSubconditionElimination.this.TreeMaker]])List[CommonSubconditionElimination.this.TreeMaker]">flatMap</a><a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.List.canBuildFrom" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,CommonSubconditionElimination.this.TreeMaker,List[CommonSubconditionElimination.this.TreeMaker]]" class="delimiter">(</a><a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.lastReusedTreeMaker.$anonfun.tm">tm</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.lastReusedTreeMaker.$anonfun.tm" title="CommonSubconditionElimination.this.Test">tm</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.reuses" title="=&gt; Option[CommonSubconditionElimination.this.Test]">reuses</a> <a href="../../../../Option.scala.html#scala.Option.option2Iterable" title="(xo: Option[CommonSubconditionElimination.this.TreeMaker])Iterable[CommonSubconditionElimination.this.TreeMaker]">map</a> <span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Test" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.lastReusedTreeMaker.$anonfun.$anonfun.test">test</a> =&gt; <a href="../../../../Function1.scala.html#scala;Function1.apply" title="(v1: CommonSubconditionElimination.this.TreeMaker)CommonSubconditionElimination.this.TreeMaker">toReused</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.lastReusedTreeMaker.$anonfun.$anonfun.test" title="CommonSubconditionElimination.this.Test">test</a>.<a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;MatchApproximation;MatchApproximator;Test.treeMaker" title="=&gt; CommonSubconditionElimination.this.TreeMaker">treeMaker</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.collectFirst" title="(pf: PartialFunction[CommonSubconditionElimination.this.TreeMaker,CommonSubconditionElimination.this.ReusedCondTreeMaker])Option[CommonSubconditionElimination.this.ReusedCondTreeMaker]">collectFirst</a><a href="../../../../Option.scala.html#scala.Option.option2Iterable" title="(xo: Option[CommonSubconditionElimination.this.ReusedCondTreeMaker])Iterable[CommonSubconditionElimination.this.ReusedCondTreeMaker]" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.lastReusedTreeMaker;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>case <a title="CommonSubconditionElimination.this.ReusedCondTreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.lastReusedTreeMaker;$anonfun.isDefinedAt.x">x</a>: <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker" title="CommonSubconditionElimination.this.ReusedCondTreeMaker">ReusedCondTreeMaker</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.lastReusedTreeMaker;$anonfun.isDefinedAt.x" title="CommonSubconditionElimination.this.ReusedCondTreeMaker">x</a><span class="delimiter">}</span>.<a href="../../../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; CommonSubconditionElimination.this.ReusedCondTreeMaker">head</a>

      def <a title="(next: CommonSubconditionElimination.this.Tree)(casegen: CommonSubconditionElimination.this.Casegen)CommonSubconditionElimination.this.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.chainBefore">chainBefore</a><span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.chainBefore.next">next</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CommonSubconditionElimination.this.Tree">Tree</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="CommonSubconditionElimination.this.Casegen" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.chainBefore.casegen">casegen</a>: <a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;CodegenCore;Casegen" title="CommonSubconditionElimination.this.Casegen">Casegen</a><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="CommonSubconditionElimination.this.Tree">Tree</a> = <span class="delimiter">{</span>
        <span class="comment">// TODO: finer-grained duplication -- MUST duplicate though, or we'll get VerifyErrors since sharing trees confuses lambdalift,</span>
        <span class="comment">// and in its confusion it emits illegal casts (diagnosed by Grzegorz: checkcast T ; invokevirtual S.m, where T not a subtype of S)</span>
        <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.chainBefore.casegen" title="CommonSubconditionElimination.this.Casegen">casegen</a>.<a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;CodegenCore;Casegen.ifThenElseZero" title="(c: MatchOptimization.this.global.Tree, thenp: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">ifThenElseZero</a><span class="delimiter">(</span><a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.REF(aa0d4af395)" title="(sym: MatchOptimization.this.global.Symbol)MatchOptimization.this.global.gen.global.RefTree">REF</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.lastReusedTreeMaker" title="=&gt; CommonSubconditionElimination.this.ReusedCondTreeMaker">lastReusedTreeMaker</a>.<a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.storedCond" title="=&gt; MatchOptimization.this.global.TermSymbol">storedCond</a><span class="delimiter">)</span>, <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface;TypedSubstitution;Substitution.apply" title="(tree: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">substitution</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.chainBefore.next" title="CommonSubconditionElimination.this.Tree">next</a><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.duplicate" title="=&gt; MatchOptimization.this.global.Tree">duplicate</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      override def <a title="()String" id="scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.toString">toString</a> = <span title="String(&quot;R&quot;)" class="string">&quot;R&quot;</span><span title="(x$1: Any)String">+</span><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: MatchOptimization.this.global.TermName, _2: CommonSubconditionElimination.this.Substitution)(MatchOptimization.this.global.TermName, CommonSubconditionElimination.this.Substitution)" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusingCondTreeMaker.lastReusedTreeMaker" title="=&gt; CommonSubconditionElimination.this.ReusedCondTreeMaker">lastReusedTreeMaker</a>.<a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.storedCond" title="=&gt; MatchOptimization.this.global.TermSymbol">storedCond</a>.<a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;TermSymbol.name" title="=&gt; MatchOptimization.this.global.TermName">name</a>, <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TreeMaker.substitution" title="=&gt; CommonSubconditionElimination.this.Substitution">substitution</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>


  <span class="comment">//// DCE</span>
<span class="comment">//  trait DeadCodeElimination extends TreeMakers {</span>
<span class="comment">//    // TODO: non-trivial dead-code elimination</span>
<span class="comment">//    // e.g., the following match should compile to a simple instanceof:</span>
<span class="comment">//    //   case class Ident(name: String)</span>
<span class="comment">//    //   for (Ident(name) &lt;- ts) println(name)</span>
<span class="comment">//    def doDCE(prevBinder: Symbol, cases: List[List[TreeMaker]], pt: Type): List[List[TreeMaker]] = {</span>
<span class="comment">//      // do minimal DCE</span>
<span class="comment">//      cases</span>
<span class="comment">//    }</span>
<span class="comment">//  }</span>

  <span class="comment">//// SWITCHES -- TODO: operate on Tests rather than TreeMakers</span>
  trait <a title="trait SwitchEmission extends AnyRef with MatchOptimization.this.TreeMakers with MatchOptimization.this.MatchMonadInterface" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission">SwitchEmission</a> extends <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers" title="MatchOptimization.this.TreeMakers">TreeMakers</a> with <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface;MatchMonadInterface" title="MatchOptimization.this.MatchMonadInterface">MatchMonadInterface</a> <span class="delimiter">{</span>
    import <a href="../../ast/Trees.scala.html#scala.tools.nsc.ast;Trees.treeInfo" title="MatchOptimization.this.global.treeInfo.type">treeInfo</a>.isGuardedCase

    abstract class <a title="class SwitchMaker extends AnyRef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker">SwitchMaker</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker" title="SwitchEmission.this.SwitchMaker" class="delimiter">{</a>
      abstract class <a title="class SwitchableTreeMakerExtractor extends AnyRef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker;SwitchableTreeMakerExtractor">SwitchableTreeMakerExtractor</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker;SwitchableTreeMakerExtractor" title="SwitchMaker.this.SwitchableTreeMakerExtractor" class="delimiter">{</a> def <a title="(x: SwitchEmission.this.TreeMaker)Option[MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker;SwitchableTreeMakerExtractor.unapply">unapply</a><span class="delimiter">(</span><a title="SwitchEmission.this.TreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker;SwitchableTreeMakerExtractor.unapply.x">x</a>: <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TreeMaker" title="SwitchEmission.this.TreeMaker">TreeMaker</a><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#scala;Option" title="Option[MatchOptimization.this.global.Tree]">Option</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> <span class="delimiter">}</span>
      val <a title="=&gt; SwitchMaker.this.SwitchableTreeMakerExtractor" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.SwitchableTreeMaker">SwitchableTreeMaker</a>: <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker;SwitchableTreeMakerExtractor" title="SwitchMaker.this.SwitchableTreeMakerExtractor">SwitchableTreeMakerExtractor</a>

      def <a title="=&gt; Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.alternativesSupported">alternativesSupported</a>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a>

      <span class="comment">// when collapsing guarded switch cases we may sometimes need to jump to the default case</span>
      <span class="comment">// however, that's not supported in exception handlers, so when we can't jump when we need it, don't emit a switch</span>
      <span class="comment">// TODO: make more fine-grained, as we don't always need to jump</span>
      def <a title="=&gt; Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.canJump">canJump</a>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a>

      <span class="comment">/** Should exhaustivity analysis be skipped? */</span>
      def <a title="=&gt; Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unchecked">unchecked</a>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a>


      def <a title="(x: MatchOptimization.this.global.CaseDef)Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.isDefault">isDefault</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.isDefault.x">x</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a>
      def <a title="=&gt; MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultSym">defaultSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a>
      def <a title="=&gt; MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultBody">defaultBody</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a>
      def <a title="(scrutSym: MatchOptimization.this.global.Symbol, guard: MatchOptimization.this.global.Tree, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultCase">defaultCase</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultCase$default$1">scrutSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultSym" title="=&gt; MatchOptimization.this.global.Symbol">defaultSym</a>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultCase$default$2">guard</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a> = <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultCase$default$3">body</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultBody" title="=&gt; MatchOptimization.this.global.Tree">defaultBody</a><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a>

      object <a title="SwitchMaker.this.GuardAndBodyTreeMakers.type" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers">GuardAndBodyTreeMakers</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers" title="SwitchMaker.this.GuardAndBodyTreeMakers.type" class="delimiter">{</a>
          def <a title="(tms: List[SwitchEmission.this.TreeMaker])Option[(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers.unapply">unapply</a><span class="delimiter">(</span><a title="List[SwitchEmission.this.TreeMaker]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers.unapply.tms">tms</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[SwitchEmission.this.TreeMaker]">List</a><span class="delimiter">[</span>TreeMaker<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#scala;Option" title="Option[(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)]">Option</a><span class="delimiter">[</span><span class="delimiter">(</span>Tree, Tree<span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
            <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers.unapply.tms" title="List[SwitchEmission.this.TreeMaker]">tms</a> match <span class="delimiter">{</span>
              case <span class="delimiter">(</span><span title="SwitchEmission.this.BodyTreeMaker">btm</span>@BodyTreeMaker<span class="delimiter">(</span><span title="MatchOptimization.this.global.Tree">body</span>, _<span class="delimiter">)</span><span class="delimiter">)</span> :: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a> =&gt; <a href="../../../../Option.scala.html#scala;Some" title="(x: (MatchOptimization.this.global.EmptyTree.type, MatchOptimization.this.global.Tree))Some[(MatchOptimization.this.global.EmptyTree.type, MatchOptimization.this.global.Tree)]">Some</a><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: MatchOptimization.this.global.EmptyTree.type, _2: MatchOptimization.this.global.Tree)(MatchOptimization.this.global.EmptyTree.type, MatchOptimization.this.global.Tree)" class="delimiter">(</a><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, <span title="SwitchEmission.this.BodyTreeMaker">btm</span>.<a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface;TypedSubstitution;Substitution.apply" title="(tree: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">substitution</a><span class="delimiter">(</span><span title="MatchOptimization.this.global.Tree">body</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              case <span class="delimiter">(</span><a title="SwitchEmission.this.GuardTreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers.unapply.gtm">gtm</a>@GuardTreeMaker<span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers.unapply.guard">guard</a><span class="delimiter">)</span><span class="delimiter">)</span> :: <span class="delimiter">(</span><span title="SwitchEmission.this.BodyTreeMaker">btm</span>@BodyTreeMaker<span class="delimiter">(</span><span title="MatchOptimization.this.global.Tree">body</span>, _<span class="delimiter">)</span><span class="delimiter">)</span> :: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a> =&gt; <a href="../../../../Option.scala.html#scala;Some" title="(x: (MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree))Some[(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)]">Some</a><span class="delimiter">(</span><a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: MatchOptimization.this.global.Tree, _2: MatchOptimization.this.global.Tree)(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers.unapply.gtm" title="SwitchEmission.this.GuardTreeMaker">gtm</a>.<a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface;TypedSubstitution;Substitution.apply" title="(tree: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">substitution</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers.unapply.guard" title="MatchOptimization.this.global.Tree">guard</a><span class="delimiter">)</span>, <span title="SwitchEmission.this.BodyTreeMaker">btm</span>.<a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface;TypedSubstitution;Substitution.apply" title="(tree: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">substitution</a><span class="delimiter">(</span><span title="MatchOptimization.this.global.Tree">body</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              case _ =&gt; <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      private val <a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultLabel">defaultLabel</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a> =  <a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;CodegenCore.newSynthCaseLabel" title="(name: String)MatchOptimization.this.global.MethodSymbol">newSynthCaseLabel</a><span class="delimiter">(</span><span title="String(&quot;default&quot;)" class="string">&quot;default&quot;</span><span class="delimiter">)</span>

      <span class="comment">/** Collapse guarded cases that switch on the same constant (the last case may be unguarded).
       *
       * Cases with patterns A and B switch on the same constant iff for all values x that match A also match B and vice versa.
       * (This roughly corresponds to equality on trees modulo alpha renaming and reordering of alternatives.)
       *
       * The rewrite only applies if some of the cases are guarded (this must be checked before invoking this method).
       *
       * The rewrite goes through the switch top-down and merges each case with the subsequent cases it is implied by
       * (i.e. it matches if they match, not taking guards into account)
       *
       * If there are no unreachable cases, all cases can be uniquely assigned to a partition of such 'overlapping' cases,
       * save for the default case (thus we jump to it rather than copying it several times).
       * (The cases in a partition are implied by the principal element of the partition.)
       *
       * The overlapping cases are merged into one case with their guards pushed into the body as follows
       * (with P the principal element of the overlapping patterns Pi):
       *
       *    `{case Pi if(G_i) =&gt; B_i }*` is rewritten to `case P =&gt; {if(G_i) B_i}*`
       *
       * The rewrite fails (and returns Nil) when:
       *   (1) there is a subsequence of overlapping cases that has an unguarded case in the middle;
       *       only the last case of each subsequence of overlapping cases may be unguarded (this is implied by unreachability)
       *
       *   (2) there are overlapping cases that differ (tested by `caseImpliedBy`)
       *       cases with patterns A and B are overlapping if for SOME value x, A matches x implies B matches y OR vice versa  &lt;-- note the difference with case equality defined above
       *       for example `case 'a' | 'b' =&gt;` and `case 'b' =&gt;` are different and overlapping (overlapping and equality disregard guards)
       *
       * The second component of the returned tuple indicates whether we'll need to emit a labeldef to jump to the default case.
       */</span>
      private def <a title="(cases: List[MatchOptimization.this.global.CaseDef])(List[MatchOptimization.this.global.CaseDef], Boolean)" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases">collapseGuardedCases</a><span class="delimiter">(</span><a title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.cases">cases</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[MatchOptimization.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(List[MatchOptimization.this.global.CaseDef], Boolean)" class="delimiter">(</a>List<span class="delimiter">[</span>CaseDef<span class="delimiter">]</span>, Boolean<span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="comment">// requires(same.forall(caseEquals(same.head)))</span>
        <span class="comment">// requires(same.nonEmpty, same)</span>
        def <a title="(same: List[MatchOptimization.this.global.CaseDef], isDefault: Boolean)MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse">collapse</a><span class="delimiter">(</span><a title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.same">same</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[MatchOptimization.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span>, <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.isDefault">isDefault</a>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a> = <span class="delimiter">{</span>
          val <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.commonPattern">commonPattern</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.same" title="List[MatchOptimization.this.global.CaseDef]">same</a>.<a href="../../../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; MatchOptimization.this.global.CaseDef">head</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef.pat" title="=&gt; MatchOptimization.this.global.Tree">pat</a>
          <span class="comment">// jump to default case (either the user-supplied one or the synthetic one)</span>
          <span class="comment">// unless we're collapsing the default case: then we re-use the same body as the synthetic catchall (throwing a matcherror, rethrowing the exception)</span>
          val <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.jumpToDefault">jumpToDefault</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a> =
            if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.isDefault" title="Boolean">isDefault</a> <a href="../../../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="../../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.canJump" title="=&gt; Boolean">canJump</a><span class="delimiter">)</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultBody" title="=&gt; MatchOptimization.this.global.Tree">defaultBody</a>
            else <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Apply" title="(fun: MatchOptimization.this.global.Tree, args: List[MatchOptimization.this.global.Tree])MatchOptimization.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.Ident(e8c336bf3b)" title="(sym: MatchOptimization.this.global.Symbol)MatchOptimization.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultLabel" title="=&gt; MatchOptimization.this.global.Symbol">defaultLabel</a><span class="delimiter">)</span>, <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>

          val <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBody">guardedBody</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.same" title="List[MatchOptimization.this.global.CaseDef]">same</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.foldRight" title="(z: MatchOptimization.this.global.Tree)(op: (MatchOptimization.this.global.CaseDef, MatchOptimization.this.global.Tree) =&gt; MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">foldRight</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.jumpToDefault" title="MatchOptimization.this.global.Tree">jumpToDefault</a><span class="delimiter">)</span><a href="../../../../Tuple2.scala.html#scala;Tuple2" title="MatchOptimization.this.global.Tree" class="delimiter">{</a>
            <span class="comment">// the last case may be un-guarded (we know it's the last one since fold's accum == jumpToDefault)</span>
            <span class="comment">// --&gt; replace jumpToDefault by the un-guarded case's body</span>
            case <span class="delimiter">(</span>CaseDef<span class="delimiter">(</span>_, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, <span title="MatchOptimization.this.global.Tree">b</span><span class="delimiter">)</span>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.jumpToDefault" title="MatchOptimization.this.global.Tree">`jumpToDefault`</a><span class="delimiter">)</span>     =&gt; <span title="MatchOptimization.this.global.Tree">b</span>
            case <span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBody.$anonfun.cd">cd</a>@CaseDef<span class="delimiter">(</span>_, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBody.$anonfun.g">g</a>, <span title="MatchOptimization.this.global.Tree">b</span><span class="delimiter">)</span>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBody.$anonfun.els">els</a><span class="delimiter">)</span> if <a href="../../../../reflect/internal/TreeInfo.scala.html#scala.reflect.internal;TreeInfo.isGuardedCase" title="(cdef: MatchOptimization.this.global.treeInfo.global.CaseDef)Boolean">isGuardedCase</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBody.$anonfun.cd" title="MatchOptimization.this.global.CaseDef">cd</a><span class="delimiter">)</span> =&gt; <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;If" title="(cond: MatchOptimization.this.global.Tree, thenp: MatchOptimization.this.global.Tree, elsep: MatchOptimization.this.global.Tree)MatchOptimization.this.global.If">If</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBody.$anonfun.g" title="MatchOptimization.this.global.Tree">g</a>, <span title="MatchOptimization.this.global.Tree">b</span>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBody.$anonfun.els" title="MatchOptimization.this.global.Tree">els</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="comment">// if the cases that we're going to collapse bind variables,</span>
          <span class="comment">// must replace them by the single binder introduced by the collapsed case</span>
          val <a title="List[MatchOptimization.this.global.Symbol]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders">binders</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.same" title="List[MatchOptimization.this.global.CaseDef]">same</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.collect" title="(pf: PartialFunction[MatchOptimization.this.global.CaseDef,MatchOptimization.this.global.Symbol])(implicit bf: scala.collection.generic.CanBuildFrom[List[MatchOptimization.this.global.CaseDef],MatchOptimization.this.global.Symbol,List[MatchOptimization.this.global.Symbol]])List[MatchOptimization.this.global.Symbol]">collect</a><a title="&lt;$anon: MatchOptimization.this.global.CaseDef =&gt; MatchOptimization.this.global.Symbol&gt; extends scala.runtime.AbstractPartialFunction[MatchOptimization.this.global.CaseDef,MatchOptimization.this.global.Symbol] with Serializable" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>case CaseDef<span class="delimiter">(</span><a title="MatchOptimization.this.global.Bind" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders;$anonfun.isDefinedAt.x">x</a>@Bind<span class="delimiter">(</span>_, _<span class="delimiter">)</span>, _, _<span class="delimiter">)</span> if <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders;$anonfun.isDefinedAt.x" title="MatchOptimization.this.global.Bind">x</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;SymTree.symbol" title="=&gt; MatchOptimization.this.global.Symbol">symbol</a> <span title="(x$1: Any)Boolean">!=</span> <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols.NoSymbol" title="=&gt; MatchOptimization.this.global.NoSymbol">NoSymbol</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders;$anonfun.isDefinedAt.x" title="MatchOptimization.this.global.Bind">x</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;SymTree.symbol" title="=&gt; MatchOptimization.this.global.Symbol">symbol</a><span class="delimiter">}</span>
          val <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#scala;Tuple2._1" title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.pat">pat</a>, <a href="../../../../Tuple2.scala.html#scala;Tuple2._2" title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBodySubst">guardedBodySubst</a><span class="delimiter">)</span> =
            if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders" title="List[MatchOptimization.this.global.Symbol]">binders</a>.<a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: MatchOptimization.this.global.Tree, _2: MatchOptimization.this.global.Tree)(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.commonPattern" title="MatchOptimization.this.global.Tree">commonPattern</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBody" title="MatchOptimization.this.global.Tree">guardedBody</a><span class="delimiter">)</span>
            else <span class="delimiter">{</span>
              <span class="comment">// create a single fresh binder to subsume the old binders (and their types)</span>
              <span class="comment">// TODO: I don't think the binder's types can actually be different (due to checks in caseEquals)</span>
              <span class="comment">// if they do somehow manage to diverge, the lub might not be precise enough and we could get a type error</span>
              <span class="comment">// TODO: reuse name exactly if there's only one binder in binders</span>
              val <a title="MatchOptimization.this.global.TermSymbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.binder">binder</a> = <a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;CodegenCore.freshSym" title="(pos: MatchOptimization.this.global.Position, tp: MatchOptimization.this.global.Type, prefix: String)MatchOptimization.this.global.TermSymbol">freshSym</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders" title="List[MatchOptimization.this.global.Symbol]">binders</a>.<a href="../../../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; MatchOptimization.this.global.Symbol">head</a>.<a href="../../../../reflect/internal/StdAttachments.scala.html#scala.reflect.internal;StdAttachments;Attachable.pos" title="=&gt; MatchOptimization.this.global.Position">pos</a>, <a href="../../../../reflect/internal/tpe/GlbLubs.scala.html#scala.reflect.internal.tpe;GlbLubs.lub(d5711a700e)" title="(ts: List[MatchOptimization.this.global.Type])MatchOptimization.this.global.Type">lub</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders" title="List[MatchOptimization.this.global.Symbol]">binders</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: MatchOptimization.this.global.Symbol =&gt; MatchOptimization.this.global.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatchOptimization.this.global.Symbol],MatchOptimization.this.global.Type,List[MatchOptimization.this.global.Type]])List[MatchOptimization.this.global.Type]">map</a><a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.List.canBuildFrom" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,MatchOptimization.this.global.Type,List[MatchOptimization.this.global.Type]]" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.binder.$anonfun.x$11" title="MatchOptimization.this.global.Symbol">_</a>.<a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders" title="List[MatchOptimization.this.global.Symbol]">binders</a>.<a href="../../../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; MatchOptimization.this.global.Symbol">head</a>.<a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.name" title="=&gt; MatchOptimization.this.global.Symbol#NameType">name</a>.<span title="()String">toString</span><span class="delimiter">)</span>

              <span class="comment">// the patterns in same are equal (according to caseEquals)</span>
              <span class="comment">// we can thus safely pick the first one arbitrarily, provided we correct binding</span>
              val <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.origPatWithoutBind">origPatWithoutBind</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.commonPattern" title="MatchOptimization.this.global.Tree">commonPattern</a> match <span class="delimiter">{</span>
                case Bind<span class="delimiter">(</span><a title="MatchOptimization.this.global.Name" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.origPatWithoutBind.b">b</a>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.origPatWithoutBind.orig">orig</a><span class="delimiter">)</span> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.origPatWithoutBind.orig" title="MatchOptimization.this.global.Tree">orig</a>
                case <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.origPatWithoutBind.o">o</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.origPatWithoutBind.o" title="MatchOptimization.this.global.Tree">o</a>
              <span class="delimiter">}</span>
              <span class="comment">// need to replace `defaultSym` as well -- it's used in `defaultBody` (see `jumpToDefault` above)</span>
              val <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.unifiedBody">unifiedBody</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBody" title="MatchOptimization.this.global.Tree">guardedBody</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.substituteSymbols" title="(from: List[MatchOptimization.this.global.Symbol], to: List[MatchOptimization.this.global.Symbol])MatchOptimization.this.global.Tree">substituteSymbols</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultSym" title="=&gt; MatchOptimization.this.global.Symbol">defaultSym</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: MatchOptimization.this.global.Symbol)List[MatchOptimization.this.global.Symbol]">::</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders" title="List[MatchOptimization.this.global.Symbol]">binders</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.binder" title="MatchOptimization.this.global.TermSymbol">binder</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: MatchOptimization.this.global.TermSymbol)List[MatchOptimization.this.global.TermSymbol]">::</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.binders" title="List[MatchOptimization.this.global.Symbol]">binders</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: MatchOptimization.this.global.Symbol =&gt; MatchOptimization.this.global.TermSymbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatchOptimization.this.global.Symbol],MatchOptimization.this.global.TermSymbol,List[MatchOptimization.this.global.TermSymbol]])List[MatchOptimization.this.global.TermSymbol]">map</a><a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.List.canBuildFrom" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,MatchOptimization.this.global.TermSymbol,List[MatchOptimization.this.global.TermSymbol]]" class="delimiter">(</a><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.unifiedBody.$anonfun.x$13">_</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.binder" title="MatchOptimization.this.global.TermSymbol">binder</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: MatchOptimization.this.global.Bind, _2: MatchOptimization.this.global.Tree)(MatchOptimization.this.global.Bind, MatchOptimization.this.global.Tree)" class="delimiter">(</a><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.Bind(deb2955bab)" title="(sym: MatchOptimization.this.global.Symbol, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Bind">Bind</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.binder" title="MatchOptimization.this.global.TermSymbol">binder</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.origPatWithoutBind" title="MatchOptimization.this.global.Tree">origPatWithoutBind</a><span class="delimiter">)</span>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.x$15.unifiedBody" title="MatchOptimization.this.global.Tree">unifiedBody</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <a href="../../../../reflect/internal/Positions.scala.html#scala.reflect.internal;Positions.atPos" title="(pos: MatchOptimization.this.global.Position)(tree: MatchOptimization.this.global.CaseDef)MatchOptimization.this.global.CaseDef">atPos</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.commonPattern" title="MatchOptimization.this.global.Tree">commonPattern</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; MatchOptimization.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="(pat: MatchOptimization.this.global.Tree, guard: MatchOptimization.this.global.Tree, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.pat" title="MatchOptimization.this.global.Tree">pat</a>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse.guardedBodySubst" title="MatchOptimization.this.global.Tree">guardedBodySubst</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="comment">// requires cases.exists(isGuardedCase) (otherwise the rewrite is pointless)</span>
        var <a title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.remainingCases">remainingCases</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.cases" title="List[MatchOptimization.this.global.CaseDef]">cases</a>
        val <a title="scala.collection.mutable.ListBuffer[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapsed">collapsed</a>      = scala.collection.mutable.<a href="../../../../collection/mutable/ListBuffer.scala.html#scala.collection.mutable.ListBuffer" title="scala.collection.mutable.ListBuffer.type">ListBuffer</a>.<a href="../../../../collection/generic/GenericCompanion.scala.html#scala.collection.generic;GenericCompanion.empty" title="[A]=&gt; scala.collection.mutable.ListBuffer[A]">empty</a><span title="scala.collection.mutable.ListBuffer[MatchOptimization.this.global.CaseDef]" class="delimiter">[</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">]</span>

        <span class="comment">// when some of collapsed cases (except for the default case itself) did not include an un-guarded case</span>
        <span class="comment">// we'll need to emit a labeldef for the default case</span>
        var <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.needDefault">needDefault</a>  = false

        while <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.remainingCases" title="List[MatchOptimization.this.global.CaseDef]">remainingCases</a>.<a href="../../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.nonEmpty" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.while$1" title="()Unit" class="delimiter">{</a>
          val <a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currCase">currCase</a>              = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.remainingCases" title="List[MatchOptimization.this.global.CaseDef]">remainingCases</a>.<a href="../../../../collection/IterableLike.scala.html#scala.collection;IterableLike.head" title="=&gt; MatchOptimization.this.global.CaseDef">head</a>
          val <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currIsDefault">currIsDefault</a>         = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.isDefault" title="(x: MatchOptimization.this.global.CaseDef)Boolean">isDefault</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="(pat: MatchOptimization.this.global.Tree, guard: MatchOptimization.this.global.Tree, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currCase" title="MatchOptimization.this.global.CaseDef">currCase</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef.pat" title="=&gt; MatchOptimization.this.global.Tree">pat</a>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span><span class="delimiter">)</span>
          val <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(List[MatchOptimization.this.global.CaseDef], List[MatchOptimization.this.global.CaseDef])" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#scala;Tuple2._1" title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.impliesCurr">impliesCurr</a>, <a href="../../../../Tuple2.scala.html#scala;Tuple2._2" title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.others">others</a><span class="delimiter">)</span> =
            <span class="comment">// the default case is implied by all cases, no need to partition (and remainingCases better all be default cases as well)</span>
            if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currIsDefault" title="Boolean">currIsDefault</a><span class="delimiter">)</span> <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: List[MatchOptimization.this.global.CaseDef], _2: scala.collection.immutable.Nil.type)(List[MatchOptimization.this.global.CaseDef], scala.collection.immutable.Nil.type)" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.remainingCases" title="List[MatchOptimization.this.global.CaseDef]">remainingCases</a>.<a href="../../../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.tail" title="=&gt; List[MatchOptimization.this.global.CaseDef]">tail</a>, <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>
            else <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.remainingCases" title="List[MatchOptimization.this.global.CaseDef]">remainingCases</a>.<a href="../../../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.tail" title="=&gt; List[MatchOptimization.this.global.CaseDef]">tail</a> <a href="../../../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.partition" title="(p: MatchOptimization.this.global.CaseDef =&gt; Boolean)(List[MatchOptimization.this.global.CaseDef], List[MatchOptimization.this.global.CaseDef])">partition</a> <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseImplies" title="(x: MatchOptimization.this.global.CaseDef)(y: MatchOptimization.this.global.CaseDef)Boolean">caseImplies</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.x$16.$anonfun.y" title="MatchOptimization.this.global.CaseDef" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currCase" title="MatchOptimization.this.global.CaseDef">currCase</a><span class="delimiter">)</span><span class="delimiter">)</span>

          val unguardedComesLastOrAbsent =
            <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="../../../../reflect/internal/TreeInfo.scala.html#scala.reflect.internal;TreeInfo.isGuardedCase" title="(cdef: MatchOptimization.this.global.treeInfo.global.CaseDef)Boolean">isGuardedCase</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currCase" title="MatchOptimization.this.global.CaseDef">currCase</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.impliesCurr" title="List[MatchOptimization.this.global.CaseDef]">impliesCurr</a>.<a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#scala;Boolean.||" title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.unguardedComesLastOrAbsent">||</a> <span class="delimiter">{</span> val LastImpliesCurr = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.impliesCurr" title="List[MatchOptimization.this.global.CaseDef]">impliesCurr</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.length" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#scala;Int.-(1409840560)" title="Int" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.unguardedComesLastOrAbsent.LastImpliesCurr">-</a> <span title="Int(1)" class="int">1</span>
            <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.impliesCurr" title="List[MatchOptimization.this.global.CaseDef]">impliesCurr</a>.<a href="../../../../collection/GenSeqLike.scala.html#scala.collection;GenSeqLike.indexWhere(654a5f82d5)" title="(p: MatchOptimization.this.global.CaseDef =&gt; Boolean)Int">indexWhere</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.unguardedComesLastOrAbsent.$anonfun.oc">oc</a> =&gt; <a href="../../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="../../../../reflect/internal/TreeInfo.scala.html#scala.reflect.internal;TreeInfo.isGuardedCase" title="(cdef: MatchOptimization.this.global.treeInfo.global.CaseDef)Boolean">isGuardedCase</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.unguardedComesLastOrAbsent.$anonfun.oc" title="MatchOptimization.this.global.CaseDef">oc</a><span class="delimiter">)</span><span class="delimiter">)</span> match <span class="delimiter">{</span>
              <span class="comment">// if all cases are guarded we will have to jump to the default case in the final else</span>
              <span class="comment">// (except if we're collapsing the default case itself)</span>
              case <span title="Int(-1)">-</span><span class="int">1</span> =&gt;
                if <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currIsDefault" title="Boolean">currIsDefault</a><span class="delimiter">)</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.needDefault" title="Boolean">needDefault</a> = true
                true

              <span class="comment">// last case is not guarded, no need to jump to the default here</span>
              <span class="comment">// note: must come after case -1 =&gt; (since LastImpliesCurr may be -1)</span>
              case <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.unguardedComesLastOrAbsent.LastImpliesCurr" title="Int">LastImpliesCurr</a> =&gt; true

              case _ =&gt; false
            <span class="delimiter">}</span><span class="delimiter">}</span>

          if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.unguardedComesLastOrAbsent" title="Boolean">unguardedComesLastOrAbsent</a> <span class="comment">/*(1)*/</span> <a href="../../../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.impliesCurr" title="List[MatchOptimization.this.global.CaseDef]">impliesCurr</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.forall" title="(p: MatchOptimization.this.global.CaseDef =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseEquals" title="(x: MatchOptimization.this.global.CaseDef)(y: MatchOptimization.this.global.CaseDef)Boolean">caseEquals</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.$anonfun.y" title="MatchOptimization.this.global.CaseDef" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currCase" title="MatchOptimization.this.global.CaseDef">currCase</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="comment">/*(2)*/</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapsed" title="scala.collection.mutable.ListBuffer[MatchOptimization.this.global.CaseDef]">collapsed</a> <a href="../../../../collection/mutable/ListBuffer.scala.html#scala.collection.mutable;ListBuffer.+=(f93df146a4)" title="(x: MatchOptimization.this.global.CaseDef)collapsed.type">+=</a> <span class="delimiter">(</span>
              if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.impliesCurr" title="List[MatchOptimization.this.global.CaseDef]">impliesCurr</a>.<a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="../../../../reflect/internal/TreeInfo.scala.html#scala.reflect.internal;TreeInfo.isGuardedCase" title="(cdef: MatchOptimization.this.global.treeInfo.global.CaseDef)Boolean">isGuardedCase</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currCase" title="MatchOptimization.this.global.CaseDef">currCase</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currCase" title="MatchOptimization.this.global.CaseDef">currCase</a>
              else <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapse" title="(same: List[MatchOptimization.this.global.CaseDef], isDefault: Boolean)MatchOptimization.this.global.CaseDef">collapse</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currCase" title="MatchOptimization.this.global.CaseDef">currCase</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.::" title="(x: MatchOptimization.this.global.CaseDef)List[MatchOptimization.this.global.CaseDef]">::</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.impliesCurr" title="List[MatchOptimization.this.global.CaseDef]">impliesCurr</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.currIsDefault" title="Boolean">currIsDefault</a><span class="delimiter">)</span>
            <span class="delimiter">)</span>

            <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.remainingCases" title="List[MatchOptimization.this.global.CaseDef]">remainingCases</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.others" title="List[MatchOptimization.this.global.CaseDef]">others</a>
          <span class="delimiter">}</span> else <span class="delimiter">{</span> <span class="comment">// fail</span>
            <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapsed" title="scala.collection.mutable.ListBuffer[MatchOptimization.this.global.CaseDef]">collapsed</a>.<a href="../../../../collection/mutable/ListBuffer.scala.html#scala.collection.mutable;ListBuffer.clear" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
            <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.remainingCases" title="List[MatchOptimization.this.global.CaseDef]">remainingCases</a> = <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: List[MatchOptimization.this.global.CaseDef], _2: Boolean)(List[MatchOptimization.this.global.CaseDef], Boolean)" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.collapsed" title="scala.collection.mutable.ListBuffer[MatchOptimization.this.global.CaseDef]">collapsed</a>.<a href="../../../../collection/mutable/ListBuffer.scala.html#scala.collection.mutable;ListBuffer.toList" title="=&gt; List[MatchOptimization.this.global.CaseDef]">toList</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases.needDefault" title="Boolean">needDefault</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      private def <a title="(x: MatchOptimization.this.global.CaseDef)(y: MatchOptimization.this.global.CaseDef)Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseEquals">caseEquals</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseEquals.x">x</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseEquals.y">y</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">)</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals" title="(x: MatchOptimization.this.global.Tree)(y: MatchOptimization.this.global.Tree)Boolean">patternEquals</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseEquals.x" title="MatchOptimization.this.global.CaseDef">x</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef.pat" title="=&gt; MatchOptimization.this.global.Tree">pat</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseEquals.y" title="MatchOptimization.this.global.CaseDef">y</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef.pat" title="=&gt; MatchOptimization.this.global.Tree">pat</a><span class="delimiter">)</span>
      private def <a title="(x: MatchOptimization.this.global.Tree)(y: MatchOptimization.this.global.Tree)Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals">patternEquals</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.x">x</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.y">y</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: MatchOptimization.this.global.Tree, _2: MatchOptimization.this.global.Tree)(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.x" title="MatchOptimization.this.global.Tree">x</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.y" title="MatchOptimization.this.global.Tree">y</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
        case <span class="delimiter">(</span>Alternative<span class="delimiter">(</span><a title="List[MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.xs">xs</a><span class="delimiter">)</span>, Alternative<span class="delimiter">(</span><a title="List[MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.ys">ys</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.xs" title="List[MatchOptimization.this.global.Tree]">xs</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.forall" title="(p: MatchOptimization.this.global.Tree =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.$anonfun.x">x</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.ys" title="List[MatchOptimization.this.global.Tree]">ys</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.exists" title="(p: MatchOptimization.this.global.Tree =&gt; Boolean)Boolean">exists</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals" title="(x: MatchOptimization.this.global.Tree)(y: MatchOptimization.this.global.Tree)Boolean">patternEquals</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.$anonfun.$anonfun.y" title="MatchOptimization.this.global.Tree" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.$anonfun.x" title="MatchOptimization.this.global.Tree">x</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a>
          <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.ys" title="List[MatchOptimization.this.global.Tree]">ys</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.forall" title="(p: MatchOptimization.this.global.Tree =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.$anonfun.y">y</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.xs" title="List[MatchOptimization.this.global.Tree]">xs</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.exists" title="(p: MatchOptimization.this.global.Tree =&gt; Boolean)Boolean">exists</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals" title="(x: MatchOptimization.this.global.Tree)(y: MatchOptimization.this.global.Tree)Boolean">patternEquals</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.$anonfun.$anonfun.y" title="MatchOptimization.this.global.Tree" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.$anonfun.y" title="MatchOptimization.this.global.Tree">y</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        case <span class="delimiter">(</span>Alternative<span class="delimiter">(</span><span title="List[MatchOptimization.this.global.Tree]">pats</span><span class="delimiter">)</span>, _<span class="delimiter">)</span> =&gt; <span title="List[MatchOptimization.this.global.Tree]">pats</span>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.forall" title="(p: MatchOptimization.this.global.Tree =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.$anonfun.p">p</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals" title="(x: MatchOptimization.this.global.Tree)(y: MatchOptimization.this.global.Tree)Boolean">patternEquals</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.$anonfun.p" title="MatchOptimization.this.global.Tree">p</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.y" title="MatchOptimization.this.global.Tree">y</a><span class="delimiter">)</span><span class="delimiter">)</span>
        case <span class="delimiter">(</span>_, Alternative<span class="delimiter">(</span><span title="List[MatchOptimization.this.global.Tree]">pats</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <span title="List[MatchOptimization.this.global.Tree]">pats</span>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.forall" title="(p: MatchOptimization.this.global.Tree =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.$anonfun.q">q</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals" title="(x: MatchOptimization.this.global.Tree)(y: MatchOptimization.this.global.Tree)Boolean">patternEquals</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.x" title="MatchOptimization.this.global.Tree">x</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.$anonfun.q" title="MatchOptimization.this.global.Tree">q</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="comment">// regular switch</span>
        case <span class="delimiter">(</span>Literal<span class="delimiter">(</span>Constant<span class="delimiter">(</span><a title="Any" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.cx">cx</a><span class="delimiter">)</span><span class="delimiter">)</span>, Literal<span class="delimiter">(</span>Constant<span class="delimiter">(</span><a title="Any" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.cy">cy</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.cx" title="Any">cx</a> <span title="(x$1: Any)Boolean">==</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.cy" title="Any">cy</a>
        case <span class="delimiter">(</span>Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span><span class="delimiter">)</span>     =&gt; true
        <span class="comment">// type-switch for catch</span>
        case <span class="delimiter">(</span>Bind<span class="delimiter">(</span>_, Typed<span class="delimiter">(</span>Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.tpX">tpX</a><span class="delimiter">)</span><span class="delimiter">)</span>, Bind<span class="delimiter">(</span>_, Typed<span class="delimiter">(</span>Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.tpY">tpY</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.tpX" title="MatchOptimization.this.global.Tree">tpX</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a> <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.=:=" title="(that: MatchOptimization.this.global.Type)Boolean">=:=</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternEquals.tpY" title="MatchOptimization.this.global.Tree">tpY</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a>
        case _ =&gt; false
      <span class="delimiter">}</span>

      <span class="comment">// if y matches then x matches for sure (thus, if x comes before y, y is unreachable)</span>
      private def <a title="(x: MatchOptimization.this.global.CaseDef)(y: MatchOptimization.this.global.CaseDef)Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseImplies">caseImplies</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseImplies.x">x</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseImplies.y">y</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">)</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies" title="(x: MatchOptimization.this.global.Tree)(y: MatchOptimization.this.global.Tree)Boolean">patternImplies</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseImplies.x" title="MatchOptimization.this.global.CaseDef">x</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef.pat" title="=&gt; MatchOptimization.this.global.Tree">pat</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseImplies.y" title="MatchOptimization.this.global.CaseDef">y</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef.pat" title="=&gt; MatchOptimization.this.global.Tree">pat</a><span class="delimiter">)</span>
      private def <a title="(x: MatchOptimization.this.global.Tree)(y: MatchOptimization.this.global.Tree)Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies">patternImplies</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.x">x</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.y">y</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: MatchOptimization.this.global.Tree, _2: MatchOptimization.this.global.Tree)(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.x" title="MatchOptimization.this.global.Tree">x</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.y" title="MatchOptimization.this.global.Tree">y</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
        <span class="comment">// since alternatives are flattened, must treat them as separate cases</span>
        case <span class="delimiter">(</span>Alternative<span class="delimiter">(</span><span title="List[MatchOptimization.this.global.Tree]">pats</span><span class="delimiter">)</span>, _<span class="delimiter">)</span> =&gt; <span title="List[MatchOptimization.this.global.Tree]">pats</span>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.exists" title="(p: MatchOptimization.this.global.Tree =&gt; Boolean)Boolean">exists</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.$anonfun.p">p</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies" title="(x: MatchOptimization.this.global.Tree)(y: MatchOptimization.this.global.Tree)Boolean">patternImplies</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.$anonfun.p" title="MatchOptimization.this.global.Tree">p</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.y" title="MatchOptimization.this.global.Tree">y</a><span class="delimiter">)</span><span class="delimiter">)</span>
        case <span class="delimiter">(</span>_, Alternative<span class="delimiter">(</span><span title="List[MatchOptimization.this.global.Tree]">pats</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <span title="List[MatchOptimization.this.global.Tree]">pats</span>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.exists" title="(p: MatchOptimization.this.global.Tree =&gt; Boolean)Boolean">exists</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.$anonfun.q">q</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies" title="(x: MatchOptimization.this.global.Tree)(y: MatchOptimization.this.global.Tree)Boolean">patternImplies</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.x" title="MatchOptimization.this.global.Tree">x</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.$anonfun.q" title="MatchOptimization.this.global.Tree">q</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="comment">// regular switch</span>
        case <span class="delimiter">(</span>Literal<span class="delimiter">(</span>Constant<span class="delimiter">(</span><a title="Any" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.cx">cx</a><span class="delimiter">)</span><span class="delimiter">)</span>, Literal<span class="delimiter">(</span>Constant<span class="delimiter">(</span><a title="Any" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.cy">cy</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.cx" title="Any">cx</a> <span title="(x$1: Any)Boolean">==</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.cy" title="Any">cy</a>
        case <span class="delimiter">(</span>Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, _<span class="delimiter">)</span>                       =&gt; true
        <span class="comment">// type-switch for catch</span>
        case <span class="delimiter">(</span>Bind<span class="delimiter">(</span>_, Typed<span class="delimiter">(</span>Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.tpX">tpX</a><span class="delimiter">)</span><span class="delimiter">)</span>,
              Bind<span class="delimiter">(</span>_, Typed<span class="delimiter">(</span>Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.tpY">tpY</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>     =&gt; <a href="MatchAnalysis.scala.html#scala.tools.nsc.transform.patmat;TreeAndTypeAnalysis.instanceOfTpImplies" title="(tp: MatchOptimization.this.global.Type, tpImplied: MatchOptimization.this.global.Type)Boolean">instanceOfTpImplies</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.tpY" title="MatchOptimization.this.global.Tree">tpY</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.patternImplies.tpX" title="MatchOptimization.this.global.Tree">tpX</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a><span class="delimiter">)</span>
        case _ =&gt; false
      <span class="delimiter">}</span>

      private def <a title="(cs: List[MatchOptimization.this.global.CaseDef])Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.noGuards">noGuards</a><span class="delimiter">(</span><a title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.noGuards.cs">cs</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[MatchOptimization.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <a href="../../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.noGuards.cs" title="List[MatchOptimization.this.global.CaseDef]">cs</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.exists" title="(p: MatchOptimization.this.global.CaseDef =&gt; Boolean)Boolean">exists</a><span class="delimiter">(</span><a href="../../../../reflect/internal/TreeInfo.scala.html#scala.reflect.internal;TreeInfo.isGuardedCase" title="(cdef: MatchOptimization.this.global.treeInfo.global.CaseDef)Boolean">isGuardedCase</a><span class="delimiter">)</span>

      <span class="comment">// must do this before removing guards from cases and collapsing (SI-6011, SI-6048)</span>
      private def <a title="(cases: List[MatchOptimization.this.global.CaseDef])Option[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase">unreachableCase</a><span class="delimiter">(</span><a title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.cases">cases</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[MatchOptimization.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#scala;Option" title="Option[MatchOptimization.this.global.CaseDef]">Option</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span> = <span class="delimiter">{</span>
        def <a title="(cases: List[MatchOptimization.this.global.CaseDef])Option[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.loop">loop</a><span class="delimiter">(</span><a title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.loop.cases">cases</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[MatchOptimization.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#scala;Option" title="Option[MatchOptimization.this.global.CaseDef]">Option</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.loop.cases" title="List[MatchOptimization.this.global.CaseDef]">cases</a> match <span class="delimiter">{</span>
          case <span title="MatchOptimization.this.global.CaseDef">head</span> :: <a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.loop.next">next</a> :: _ if <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.isDefault" title="(x: MatchOptimization.this.global.CaseDef)Boolean">isDefault</a><span class="delimiter">(</span><span title="MatchOptimization.this.global.CaseDef">head</span><span class="delimiter">)</span>                                    =&gt; <a href="../../../../Option.scala.html#scala;Some" title="(x: MatchOptimization.this.global.CaseDef)Some[MatchOptimization.this.global.CaseDef]">Some</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.loop.next" title="MatchOptimization.this.global.CaseDef">next</a><span class="delimiter">)</span> <span class="comment">// subsumed by the next case, but faster</span>
          case <span title="MatchOptimization.this.global.CaseDef">head</span> :: <span title="List[MatchOptimization.this.global.CaseDef]">rest</span> if <a href="../../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="../../../../reflect/internal/TreeInfo.scala.html#scala.reflect.internal;TreeInfo.isGuardedCase" title="(cdef: MatchOptimization.this.global.treeInfo.global.CaseDef)Boolean">isGuardedCase</a><span class="delimiter">(</span><span title="MatchOptimization.this.global.CaseDef">head</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <span title="MatchOptimization.this.global.CaseDef">head</span>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef.guard" title="=&gt; MatchOptimization.this.global.Tree">guard</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a> <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.=:=" title="(that: MatchOptimization.this.global.Type)Boolean">=:=</a> <a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ConstantTrue" title="=&gt; MatchOptimization.this.global.UniqueConstantType">ConstantTrue</a> =&gt; <span title="List[MatchOptimization.this.global.CaseDef]">rest</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.find" title="(p: MatchOptimization.this.global.CaseDef =&gt; Boolean)Option[MatchOptimization.this.global.CaseDef]">find</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.caseImplies" title="(x: MatchOptimization.this.global.CaseDef)(y: MatchOptimization.this.global.CaseDef)Boolean">caseImplies</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.loop.$anonfun.y" title="MatchOptimization.this.global.CaseDef" class="delimiter">(</a><span title="MatchOptimization.this.global.CaseDef">head</span><span class="delimiter">)</span> <a href="../../../../Option.scala.html#scala;Option.orElse" title="(alternative: =&gt; Option[MatchOptimization.this.global.CaseDef])Option[MatchOptimization.this.global.CaseDef]">orElse</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.loop" title="(cases: List[MatchOptimization.this.global.CaseDef])Option[MatchOptimization.this.global.CaseDef]">loop</a><span class="delimiter">(</span><span title="List[MatchOptimization.this.global.CaseDef]">rest</span><span class="delimiter">)</span>
          case <span title="MatchOptimization.this.global.CaseDef">head</span> :: _ if <span title="MatchOptimization.this.global.CaseDef">head</span>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef.guard" title="=&gt; MatchOptimization.this.global.Tree">guard</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a> <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.=:=" title="(that: MatchOptimization.this.global.Type)Boolean">=:=</a> <a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ConstantFalse" title="=&gt; MatchOptimization.this.global.UniqueConstantType">ConstantFalse</a>                           =&gt; <a href="../../../../Option.scala.html#scala;Some" title="(x: MatchOptimization.this.global.CaseDef)Some[MatchOptimization.this.global.CaseDef]">Some</a><span class="delimiter">(</span><span title="MatchOptimization.this.global.CaseDef">head</span><span class="delimiter">)</span>
          case _ :: <span title="List[MatchOptimization.this.global.CaseDef]">rest</span>                                                               =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.loop" title="(cases: List[MatchOptimization.this.global.CaseDef])Option[MatchOptimization.this.global.CaseDef]">loop</a><span class="delimiter">(</span><span title="List[MatchOptimization.this.global.CaseDef]">rest</span><span class="delimiter">)</span>
          case _                                                                       =&gt; <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a>
        <span class="delimiter">}</span>
        <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.loop" title="(cases: List[MatchOptimization.this.global.CaseDef])Option[MatchOptimization.this.global.CaseDef]">loop</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase.cases" title="List[MatchOptimization.this.global.CaseDef]">cases</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="comment">// empty list ==&gt; failure</span>
      def <a title="(cases: List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])], pt: MatchOptimization.this.global.Type)List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply">apply</a><span class="delimiter">(</span><a title="List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.cases">cases</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]">List</a><span class="delimiter">[</span><span class="delimiter">(</span>Symbol, List<span class="delimiter">[</span>TreeMaker<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span>, <a title="MatchOptimization.this.global.Type" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.pt">pt</a>: <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="MatchOptimization.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[MatchOptimization.this.global.CaseDef]">List</a><span class="delimiter">[</span>CaseDef<span class="delimiter">]</span> =
        <span class="comment">// generate if-then-else for 1 case switch (avoids verify error... can't imagine a one-case switch being faster than if-then-else anyway)</span>
        if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.cases" title="List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]">cases</a>.<a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.cases" title="List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]">cases</a>.<a href="../../../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.tail" title="=&gt; List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]">tail</a>.<a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>
        else <span class="delimiter">{</span>
          val caseDefs = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.cases" title="List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]">cases</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="List[Option[MatchOptimization.this.global.CaseDef]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs">map</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.x0$5" title="Option[MatchOptimization.this.global.CaseDef]" class="delimiter">{</a> case <span class="delimiter">(</span><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.scrutSym">scrutSym</a>, <a title="List[SwitchEmission.this.TreeMaker]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.makers">makers</a><span class="delimiter">)</span> =&gt;
            <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.makers" title="List[SwitchEmission.this.TreeMaker]">makers</a> match <span class="delimiter">{</span>
              <span class="comment">// default case</span>
              case <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers.unapply" title="(tms: List[SwitchEmission.this.TreeMaker])Option[(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)]">GuardAndBodyTreeMakers</a><span class="delimiter">(</span><span title="MatchOptimization.this.global.Tree">guard</span>, <span title="MatchOptimization.this.global.Tree">body</span><span class="delimiter">)</span> =&gt;
                <a href="../../../../Option.scala.html#scala;Some" title="(x: MatchOptimization.this.global.CaseDef)Some[MatchOptimization.this.global.CaseDef]">Some</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultCase" title="(scrutSym: MatchOptimization.this.global.Symbol, guard: MatchOptimization.this.global.Tree, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef">defaultCase</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a>, <span title="MatchOptimization.this.global.Tree">guard</span>, <span title="MatchOptimization.this.global.Tree">body</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="comment">// constant (or typetest for typeSwitch)</span>
              case <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker;SwitchableTreeMakerExtractor.unapply" title="(x: SwitchEmission.this.TreeMaker)Option[MatchOptimization.this.global.Tree]">SwitchableTreeMaker</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.pattern">pattern</a><span class="delimiter">)</span> :: <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers.unapply" title="(tms: List[SwitchEmission.this.TreeMaker])Option[(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)]">GuardAndBodyTreeMakers</a><span class="delimiter">(</span><span title="MatchOptimization.this.global.Tree">guard</span>, <span title="MatchOptimization.this.global.Tree">body</span><span class="delimiter">)</span> =&gt;
                <a href="../../../../Option.scala.html#scala;Some" title="(x: MatchOptimization.this.global.CaseDef)Some[MatchOptimization.this.global.CaseDef]">Some</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="(pat: MatchOptimization.this.global.Tree, guard: MatchOptimization.this.global.Tree, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.pattern" title="MatchOptimization.this.global.Tree">pattern</a>, <span title="MatchOptimization.this.global.Tree">guard</span>, <span title="MatchOptimization.this.global.Tree">body</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="comment">// alternatives</span>
              case AlternativesTreeMaker<span class="delimiter">(</span>_, <a title="List[List[SwitchEmission.this.TreeMaker]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.altss">altss</a>, <a title="MatchOptimization.this.global.Position" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.pos">pos</a><span class="delimiter">)</span> :: <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.GuardAndBodyTreeMakers.unapply" title="(tms: List[SwitchEmission.this.TreeMaker])Option[(MatchOptimization.this.global.Tree, MatchOptimization.this.global.Tree)]">GuardAndBodyTreeMakers</a><span class="delimiter">(</span><span title="MatchOptimization.this.global.Tree">guard</span>, <span title="MatchOptimization.this.global.Tree">body</span><span class="delimiter">)</span> if <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.alternativesSupported" title="=&gt; Boolean">alternativesSupported</a> =&gt;
                val switchableAlts = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.altss" title="List[List[SwitchEmission.this.TreeMaker]]">altss</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="List[Option[MatchOptimization.this.global.Tree]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.switchableAlts">map</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.switchableAlts.$anonfun.x0$6" title="Option[MatchOptimization.this.global.Tree]" class="delimiter">{</a>
                  case <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker;SwitchableTreeMakerExtractor.unapply" title="(x: SwitchEmission.this.TreeMaker)Option[MatchOptimization.this.global.Tree]">SwitchableTreeMaker</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.switchableAlts.$anonfun.pattern">pattern</a><span class="delimiter">)</span> :: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a> =&gt;
                    <a href="../../../../Option.scala.html#scala;Some" title="(x: MatchOptimization.this.global.Tree)Some[MatchOptimization.this.global.Tree]">Some</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.switchableAlts.$anonfun.pattern" title="MatchOptimization.this.global.Tree">pattern</a><span class="delimiter">)</span>
                  case _ =&gt;
                    <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a>
                <span class="delimiter">}</span>

                <span class="comment">// succeed if they were all switchable</span>
                <a href="../../../../reflect/internal/util/Collections.scala.html#scala.reflect.internal.util;Collections.sequence" title="(as: List[Option[MatchOptimization.this.global.Tree]])Option[List[MatchOptimization.this.global.Tree]]">sequence</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.switchableAlts" title="List[Option[MatchOptimization.this.global.Tree]]">switchableAlts</a><span class="delimiter">)</span> <a href="../../../../Option.scala.html#scala;Option.map" title="(f: List[MatchOptimization.this.global.Tree] =&gt; MatchOptimization.this.global.CaseDef)Option[MatchOptimization.this.global.CaseDef]">map</a> <span class="delimiter">{</span> <a title="List[MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.switchableAlts">switchableAlts</a> =&gt;
                  def <a title="(t: MatchOptimization.this.global.Tree)Product" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.extractConst">extractConst</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.extractConst.t">t</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a><span class="delimiter">)</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.extractConst.t" title="MatchOptimization.this.global.Tree">t</a> match <span class="delimiter">{</span>
                    case Literal<span class="delimiter">(</span><a title="MatchOptimization.this.global.Constant" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.extractConst.const">const</a><span class="delimiter">)</span> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.extractConst.const" title="MatchOptimization.this.global.Constant">const</a>
                    case _              =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.extractConst.t" title="MatchOptimization.this.global.Tree">t</a>
                  <span class="delimiter">}</span>
                  <span class="comment">// SI-7290 Discard duplicate alternatives that would crash the backend</span>
                  val <a title="List[MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.distinctAlts">distinctAlts</a> = <a href="../../../../reflect/internal/util/Collections.scala.html#scala.reflect.internal.util;Collections.distinctBy" title="(xs: List[MatchOptimization.this.global.Tree])(f: MatchOptimization.this.global.Tree =&gt; Product)List[MatchOptimization.this.global.Tree]">distinctBy</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.switchableAlts" title="List[MatchOptimization.this.global.Tree]">switchableAlts</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.extractConst" title="(t: MatchOptimization.this.global.Tree)Product">extractConst</a><span class="delimiter">)</span>
                  if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.distinctAlts" title="List[MatchOptimization.this.global.Tree]">distinctAlts</a>.<a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.size" title="=&gt; Int">size</a> <a href="../../../../Int.scala.html#scala;Int.<(5f58a84eb3)" title="(x: Int)Boolean">&lt;</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.switchableAlts" title="List[MatchOptimization.this.global.Tree]">switchableAlts</a>.<a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.size" title="=&gt; Int">size</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                    val <a title="scala.collection.immutable.Iterable[MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.duplicated">duplicated</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.switchableAlts" title="List[MatchOptimization.this.global.Tree]">switchableAlts</a>.<a href="../../../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.groupBy" title="(f: MatchOptimization.this.global.Tree =&gt; Product)scala.collection.immutable.Map[Product,List[MatchOptimization.this.global.Tree]]">groupBy</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.extractConst" title="(t: MatchOptimization.this.global.Tree)Product">extractConst</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.flatMap" title="(f: ((Product, List[MatchOptimization.this.global.Tree])) =&gt; scala.collection.GenTraversableOnce[MatchOptimization.this.global.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map[Product,List[MatchOptimization.this.global.Tree]],MatchOptimization.this.global.Tree,scala.collection.immutable.Iterable[MatchOptimization.this.global.Tree]])scala.collection.immutable.Iterable[MatchOptimization.this.global.Tree]">flatMap</a><a href="../../../../collection/immutable/Iterable.scala.html#scala.collection.immutable.Iterable.canBuildFrom" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Iterable.Coll,MatchOptimization.this.global.Tree,scala.collection.immutable.Iterable[MatchOptimization.this.global.Tree]]" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.duplicated.$anonfun.x$18" title="(Product, List[MatchOptimization.this.global.Tree])">_</a>.<a href="../../../../Tuple2.scala.html#scala;Tuple2._2" title="=&gt; List[MatchOptimization.this.global.Tree]">_2</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.drop" title="(n: Int)List[MatchOptimization.this.global.Tree]">drop</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.take" title="(n: Int)List[MatchOptimization.this.global.Tree]">take</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="comment">// report the first duplicated</span>
                    <a href="../../Global.scala.html#scala.tools.nsc;Global.reporter" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="../../../../reflect/internal/Reporting.scala.html#scala.reflect.internal;Reporter.warning" title="(pos: scala.reflect.internal.util.Position, msg: String)Unit">warning</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.pos" title="MatchOptimization.this.global.Position">pos</a>, <a href="../../../../StringContext.scala.html#scala;StringContext.s" title="(args: Any*)String">s</a>&quot;<span title="String(&quot;Pattern contains duplicate alternatives: &quot;)">Pattern contains duplicate alternatives: $</span><span class="delimiter">{</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.duplicated" title="scala.collection.immutable.Iterable[MatchOptimization.this.global.Tree]">duplicated</a>.<a href="../../../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.mkString(f5d728d244)" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
                  <span class="delimiter">}</span>
                  <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="(pat: MatchOptimization.this.global.Tree, guard: MatchOptimization.this.global.Tree, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Alternative" title="(trees: List[MatchOptimization.this.global.Tree])MatchOptimization.this.global.Alternative">Alternative</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs.$anonfun.$anonfun.distinctAlts" title="List[MatchOptimization.this.global.Tree]">distinctAlts</a><span class="delimiter">)</span>, <span title="MatchOptimization.this.global.Tree">guard</span>, <span title="MatchOptimization.this.global.Tree">body</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              case _ =&gt;
                <span class="comment">// debug.patmat(&quot;can't emit switch for &quot;+ makers)</span>
                <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a> <span class="comment">//failure (can't translate pattern to a switch)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>

          val <a title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefsWithGuards">caseDefsWithGuards</a> = <a href="../../../../reflect/internal/util/Collections.scala.html#scala.reflect.internal.util;Collections.sequence" title="(as: List[Option[MatchOptimization.this.global.CaseDef]])Option[List[MatchOptimization.this.global.CaseDef]]">sequence</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefs" title="List[Option[MatchOptimization.this.global.CaseDef]]">caseDefs</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
            case <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a>      =&gt; return <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>
            case Some<span class="delimiter">(</span><a title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefsWithGuards.cds">cds</a><span class="delimiter">)</span> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefsWithGuards.cds" title="List[MatchOptimization.this.global.CaseDef]">cds</a>
          <span class="delimiter">}</span>

          <span class="comment">// a switch with duplicate cases yields a verify error,</span>
          <span class="comment">// and a switch with duplicate cases and guards cannot soundly be rewritten to an unguarded switch</span>
          <span class="comment">// (even though the verify error would disappear, the behaviour would change)</span>
          val <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.allReachable">allReachable</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.unreachableCase" title="(cases: List[MatchOptimization.this.global.CaseDef])Option[MatchOptimization.this.global.CaseDef]">unreachableCase</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefsWithGuards" title="List[MatchOptimization.this.global.CaseDef]">caseDefsWithGuards</a><span class="delimiter">)</span> <a href="../../../../Option.scala.html#scala;Option.map" title="(f: MatchOptimization.this.global.CaseDef =&gt; Unit)Option[Unit]">map</a> <span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.allReachable.$anonfun.cd">cd</a> =&gt; <a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface;MatchMonadInterface.reportUnreachable" title="(pos: MatchOptimization.this.global.Position)Unit">reportUnreachable</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.allReachable.$anonfun.cd" title="MatchOptimization.this.global.CaseDef">cd</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef.body" title="=&gt; MatchOptimization.this.global.Tree">body</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; MatchOptimization.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../Option.scala.html#scala;Option.isEmpty" title="=&gt; Boolean">isEmpty</a>

          if <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.allReachable" title="Boolean">allReachable</a><span class="delimiter">)</span> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>
          else if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.noGuards" title="(cs: List[MatchOptimization.this.global.CaseDef])Boolean">noGuards</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefsWithGuards" title="List[MatchOptimization.this.global.CaseDef]">caseDefsWithGuards</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.isDefault" title="(x: MatchOptimization.this.global.CaseDef)Boolean">isDefault</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefsWithGuards" title="List[MatchOptimization.this.global.CaseDef]">caseDefsWithGuards</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.last" title="=&gt; MatchOptimization.this.global.CaseDef">last</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefsWithGuards" title="List[MatchOptimization.this.global.CaseDef]">caseDefsWithGuards</a>
            else <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefsWithGuards" title="List[MatchOptimization.this.global.CaseDef]">caseDefsWithGuards</a> <a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.:+" title="(elem: MatchOptimization.this.global.CaseDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatchOptimization.this.global.CaseDef],MatchOptimization.this.global.CaseDef,List[MatchOptimization.this.global.CaseDef]])List[MatchOptimization.this.global.CaseDef]">:+</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultCase" title="(scrutSym: MatchOptimization.this.global.Symbol, guard: MatchOptimization.this.global.Tree, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef">defaultCase</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> else <span class="delimiter">{</span>
            <span class="comment">// collapse identical cases with different guards, push guards into body for all guarded cases</span>
            <span class="comment">// this translation is only sound if there are no unreachable (duplicate) cases</span>
            <span class="comment">// it should only be run if there are guarded cases, and on failure it returns Nil</span>
            val <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(List[MatchOptimization.this.global.CaseDef], Boolean)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#scala;Tuple2._1" title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.collapsed">collapsed</a>, <a href="../../../../Tuple2.scala.html#scala;Tuple2._2" title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.needDefaultLabel">needDefaultLabel</a><span class="delimiter">)</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.collapseGuardedCases" title="(cases: List[MatchOptimization.this.global.CaseDef])(List[MatchOptimization.this.global.CaseDef], Boolean)">collapseGuardedCases</a><a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(List[MatchOptimization.this.global.CaseDef], Boolean) @unchecked" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.caseDefsWithGuards" title="List[MatchOptimization.this.global.CaseDef]">caseDefsWithGuards</a><span class="delimiter">)</span>

            if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.collapsed" title="List[MatchOptimization.this.global.CaseDef]">collapsed</a>.<a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a> <a href="../../../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.needDefaultLabel" title="Boolean">needDefaultLabel</a> <a href="../../../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.canJump" title="=&gt; Boolean">canJump</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>
            else <span class="delimiter">{</span>
              def <a title="(cd: MatchOptimization.this.global.CaseDef)MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.wrapInDefaultLabelDef">wrapInDefaultLabelDef</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.wrapInDefaultLabelDef.cd">cd</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a> =
                if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.needDefaultLabel" title="Boolean">needDefaultLabel</a><span class="delimiter">)</span> <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.deriveCaseDef" title="(cdef: MatchOptimization.this.global.Tree)(applyToBody: MatchOptimization.this.global.Tree =&gt; MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef">deriveCaseDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.wrapInDefaultLabelDef.cd" title="MatchOptimization.this.global.CaseDef">cd</a><span class="delimiter">)</span><span class="delimiter">{</span> <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.wrapInDefaultLabelDef.$anonfun.b">b</a> =&gt;
                  <span class="comment">// TODO: can b.tpe ever be null? can't really use pt, see e.g. pos/t2683 or cps/match1.scala</span>
                  <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultLabel" title="=&gt; MatchOptimization.this.global.Symbol">defaultLabel</a> <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.setInfo" title="(info: MatchOptimization.this.global.Type)SwitchMaker.this.defaultLabel.type">setInfo</a> <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;MethodType" title="(params: List[MatchOptimization.this.global.Symbol], resultType: MatchOptimization.this.global.Type)MatchOptimization.this.global.MethodType">MethodType</a><span class="delimiter">(</span><a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>, if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.wrapInDefaultLabelDef.$anonfun.b" title="MatchOptimization.this.global.Tree">b</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.wrapInDefaultLabelDef.$anonfun.b" title="MatchOptimization.this.global.Tree">b</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a> else <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.pt" title="MatchOptimization.this.global.Type">pt</a><span class="delimiter">)</span>
                  <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.LabelDef.apply(f96b919e6a)" title="(sym: MatchOptimization.this.global.Symbol, params: List[MatchOptimization.this.global.Symbol], rhs: MatchOptimization.this.global.Tree)MatchOptimization.this.global.LabelDef">LabelDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultLabel" title="=&gt; MatchOptimization.this.global.Symbol">defaultLabel</a>, <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable.Nil" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.wrapInDefaultLabelDef.$anonfun.b" title="MatchOptimization.this.global.Tree">b</a><span class="delimiter">)</span>
                <span class="delimiter">}</span> else <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.wrapInDefaultLabelDef.cd" title="MatchOptimization.this.global.CaseDef">cd</a>

              val <a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.last">last</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.collapsed" title="List[MatchOptimization.this.global.CaseDef]">collapsed</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.last" title="=&gt; MatchOptimization.this.global.CaseDef">last</a>
              if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.isDefault" title="(x: MatchOptimization.this.global.CaseDef)Boolean">isDefault</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.last" title="MatchOptimization.this.global.CaseDef">last</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                if <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.needDefaultLabel" title="Boolean">needDefaultLabel</a><span class="delimiter">)</span> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.collapsed" title="List[MatchOptimization.this.global.CaseDef]">collapsed</a>
                else <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.collapsed" title="List[MatchOptimization.this.global.CaseDef]">collapsed</a>.<a href="../../../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.init" title="=&gt; List[MatchOptimization.this.global.CaseDef]">init</a> <a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.:+" title="(elem: MatchOptimization.this.global.CaseDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatchOptimization.this.global.CaseDef],MatchOptimization.this.global.CaseDef,List[MatchOptimization.this.global.CaseDef]])List[MatchOptimization.this.global.CaseDef]">:+</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.wrapInDefaultLabelDef" title="(cd: MatchOptimization.this.global.CaseDef)MatchOptimization.this.global.CaseDef">wrapInDefaultLabelDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.last" title="MatchOptimization.this.global.CaseDef">last</a><span class="delimiter">)</span>
              <span class="delimiter">}</span> else <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.collapsed" title="List[MatchOptimization.this.global.CaseDef]">collapsed</a> <a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.:+" title="(elem: MatchOptimization.this.global.CaseDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[MatchOptimization.this.global.CaseDef],MatchOptimization.this.global.CaseDef,List[MatchOptimization.this.global.CaseDef]])List[MatchOptimization.this.global.CaseDef]">:+</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply.wrapInDefaultLabelDef" title="(cd: MatchOptimization.this.global.CaseDef)MatchOptimization.this.global.CaseDef">wrapInDefaultLabelDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.defaultCase" title="(scrutSym: MatchOptimization.this.global.Symbol, guard: MatchOptimization.this.global.Tree, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef">defaultCase</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    class <a title="class RegularSwitchMaker extends SwitchEmission.this.SwitchMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker">RegularSwitchMaker</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker" title="SwitchEmission.this.RegularSwitchMaker" class="delimiter">(</a><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.scrutSym">scrutSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a>, <a title="Option[MatchOptimization.this.global.Tree =&gt; MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.matchFailGenOverride">matchFailGenOverride</a>: <a href="../../../../Option.scala.html#scala;Option" title="Option[MatchOptimization.this.global.Tree =&gt; MatchOptimization.this.global.Tree]">Option</a><span class="delimiter">[</span>Tree =&gt; Tree<span class="delimiter">]</span>, val <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.unchecked">unchecked</a>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a><span class="delimiter">)</span> extends <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker" title="SwitchEmission.this.SwitchMaker">SwitchMaker</a> <span class="delimiter">{</span>
      val <a title="scala.collection.immutable.Set[MatchOptimization.this.global.Type]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.switchableTpe">switchableTpe</a> = <a href="../../../../collection/generic/GenericCompanion.scala.html#scala.collection.generic;GenericCompanion.apply" title="(elems: MatchOptimization.this.global.Type*)scala.collection.immutable.Set[MatchOptimization.this.global.Type]">Set</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;ValueClassDefinitions.ByteTpe" title="=&gt; MatchOptimization.this.global.Type">ByteTpe</a>, <a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;ValueClassDefinitions.ShortTpe" title="=&gt; MatchOptimization.this.global.Type">ShortTpe</a>, <a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;ValueClassDefinitions.IntTpe" title="=&gt; MatchOptimization.this.global.Type">IntTpe</a>, <a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;ValueClassDefinitions.CharTpe" title="=&gt; MatchOptimization.this.global.Type">CharTpe</a><span class="delimiter">)</span>
      val <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.alternativesSupported">alternativesSupported</a> = true
      val <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.canJump">canJump</a> = true

      <span class="comment">// Constant folding sets the type of a constant tree to `ConstantType(Constant(folded))`</span>
      <span class="comment">// The tree itself can be a literal, an ident, a selection, ...</span>
      object <a title="RegularSwitchMaker.this.SwitchablePattern.type" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchablePattern">SwitchablePattern</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchablePattern" title="RegularSwitchMaker.this.SwitchablePattern.type" class="delimiter">{</a> def <a title="(pat: MatchOptimization.this.global.Tree)Option[MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchablePattern.unapply">unapply</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchablePattern.unapply.pat">pat</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#scala;Option" title="Option[MatchOptimization.this.global.Tree]">Option</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchablePattern.unapply.pat" title="MatchOptimization.this.global.Tree">pat</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a> match <span class="delimiter">{</span>
        case ConstantType<span class="delimiter">(</span><a title="MatchOptimization.this.global.Constant" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchablePattern.unapply.const">const</a><span class="delimiter">)</span> if <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchablePattern.unapply.const" title="MatchOptimization.this.global.Constant">const</a>.<a href="../../../../reflect/internal/Constants.scala.html#scala.reflect.internal;Constants;Constant.isIntRange" title="=&gt; Boolean">isIntRange</a> =&gt;
          <a href="../../../../Option.scala.html#scala;Some" title="(x: MatchOptimization.this.global.Literal)Some[MatchOptimization.this.global.Literal]">Some</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Literal" title="(value: MatchOptimization.this.global.Constant)MatchOptimization.this.global.Literal">Literal</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Constants.scala.html#scala.reflect.internal;Constants;Constant" title="(value: Any)MatchOptimization.this.global.Constant">Constant</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchablePattern.unapply.const" title="MatchOptimization.this.global.Constant">const</a>.<a href="../../../../reflect/internal/Constants.scala.html#scala.reflect.internal;Constants;Constant.intValue" title="=&gt; Int">intValue</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="comment">// TODO: Java 7 allows strings in switches</span>
        case _ =&gt; <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a>
      <span class="delimiter">}</span><span class="delimiter">}</span>

      object <a title="RegularSwitchMaker.this.SwitchableTreeMaker.type" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchableTreeMaker">SwitchableTreeMaker</a> extends <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker;SwitchableTreeMakerExtractor" title="RegularSwitchMaker.this.SwitchableTreeMakerExtractor">SwitchableTreeMakerExtractor</a> <span class="delimiter">{</span>
        def <a title="(x: SwitchEmission.this.TreeMaker)Option[MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchableTreeMaker.unapply">unapply</a><span class="delimiter">(</span><a title="SwitchEmission.this.TreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchableTreeMaker.unapply.x">x</a>: <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TreeMaker" title="SwitchEmission.this.TreeMaker">TreeMaker</a><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#scala;Option" title="Option[MatchOptimization.this.global.Tree]">Option</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchableTreeMaker.unapply.x" title="SwitchEmission.this.TreeMaker">x</a> match <span class="delimiter">{</span>
          case EqualityTestTreeMaker<span class="delimiter">(</span>_, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchablePattern.unapply" title="(pat: MatchOptimization.this.global.Tree)Option[MatchOptimization.this.global.Tree]">SwitchablePattern</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchableTreeMaker.unapply.const">const</a><span class="delimiter">)</span>, _<span class="delimiter">)</span> =&gt; <a href="../../../../Option.scala.html#scala;Some" title="(x: MatchOptimization.this.global.Tree)Some[MatchOptimization.this.global.Tree]">Some</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.SwitchableTreeMaker.unapply.const" title="MatchOptimization.this.global.Tree">const</a><span class="delimiter">)</span>
          case _ =&gt; <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      def <a title="(x: MatchOptimization.this.global.CaseDef)Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.isDefault">isDefault</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.isDefault.x">x</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.isDefault.x" title="MatchOptimization.this.global.CaseDef">x</a> match <span class="delimiter">{</span>
        case CaseDef<span class="delimiter">(</span>Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, _<span class="delimiter">)</span> =&gt; true
        case _ =&gt; false
      <span class="delimiter">}</span>

      def <a title="=&gt; MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultSym">defaultSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a>
      def <a title="=&gt; MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultBody">defaultBody</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a>  = <span class="delimiter">{</span> import <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE" title="MatchOptimization.this.CODE.type">CODE</a>._; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.matchFailGenOverride" title="Option[MatchOptimization.this.global.Tree =&gt; MatchOptimization.this.global.Tree]">matchFailGenOverride</a> <a href="../../../../Option.scala.html#scala;Option.map" title="(f: (MatchOptimization.this.global.Tree =&gt; MatchOptimization.this.global.Tree) =&gt; MatchOptimization.this.global.Tree)Option[MatchOptimization.this.global.Tree]">map</a> <span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree =&gt; MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultBody.$anonfun.gen">gen</a> =&gt; <a href="../../../../Function1.scala.html#scala;Function1.apply" title="(v1: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">gen</a><span class="delimiter">(</span><a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.REF(aa0d4af395)" title="(sym: MatchOptimization.this.global.Symbol)MatchOptimization.this.global.gen.global.RefTree">REF</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../Option.scala.html#scala;Option.getOrElse" title="(default: =&gt; MatchOptimization.this.global.Tree)MatchOptimization.this.global.Tree">getOrElse</a> <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.Throw(7ab2c72ed6)" title="(tpe: MatchOptimization.this.global.Type, args: MatchOptimization.this.global.Tree*)MatchOptimization.this.global.Throw">Throw</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.MatchErrorClass" title="=&gt; MatchOptimization.this.global.ClassSymbol">MatchErrorClass</a>.<a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a>, <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.REF(aa0d4af395)" title="(sym: MatchOptimization.this.global.Symbol)MatchOptimization.this.global.gen.global.RefTree">REF</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span>
      def <a title="(scrutSym: MatchOptimization.this.global.Symbol, guard: MatchOptimization.this.global.Tree, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultCase">defaultCase</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultCase$default$1">scrutSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultSym" title="=&gt; MatchOptimization.this.global.Symbol">defaultSym</a>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultCase$default$2">guard</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a> = <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultCase$default$3">body</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultBody" title="=&gt; MatchOptimization.this.global.Tree">defaultBody</a><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a> = <span class="delimiter">{</span> import <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE" title="MatchOptimization.this.CODE.type">CODE</a>._; <a href="../../../../reflect/internal/Positions.scala.html#scala.reflect.internal;Positions.atPos" title="(pos: MatchOptimization.this.global.Position)(tree: MatchOptimization.this.global.CaseDef)MatchOptimization.this.global.CaseDef">atPos</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultCase$default$3" title="MatchOptimization.this.global.Tree">body</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; MatchOptimization.this.global.Position">pos</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="delimiter">(</span><a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.DEFAULT" title="=&gt; MatchOptimization.this.CODE.CaseStart">DEFAULT</a> <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE;CaseStart.IF" title="(g: MatchOptimization.this.global.Tree)MatchOptimization.this.CODE.CaseStart">IF</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultCase$default$2" title="MatchOptimization.this.global.Tree">guard</a><span class="delimiter">)</span> <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE;CaseStart.==>" title="(body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef">==&gt;</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker.defaultCase$default$3" title="MatchOptimization.this.global.Tree">body</a>
      <span class="delimiter">}</span><span class="delimiter">}</span>
    <span class="delimiter">}</span>

    override def <a title="(scrut: MatchOptimization.this.global.Tree, scrutSym: MatchOptimization.this.global.Symbol, cases: List[List[SwitchEmission.this.TreeMaker]], pt: MatchOptimization.this.global.Type, matchFailGenOverride: Option[MatchOptimization.this.global.Tree =&gt; MatchOptimization.this.global.Tree], unchecked: Boolean)Option[MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch">emitSwitch</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrut">scrut</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a>, <a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrutSym">scrutSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a>, <a title="List[List[SwitchEmission.this.TreeMaker]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.cases">cases</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[List[SwitchEmission.this.TreeMaker]]">List</a><span class="delimiter">[</span>List<span class="delimiter">[</span>TreeMaker<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="MatchOptimization.this.global.Type" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.pt">pt</a>: <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="MatchOptimization.this.global.Type">Type</a>, <a title="Option[MatchOptimization.this.global.Tree =&gt; MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.matchFailGenOverride">matchFailGenOverride</a>: <a href="../../../../Option.scala.html#scala;Option" title="Option[MatchOptimization.this.global.Tree =&gt; MatchOptimization.this.global.Tree]">Option</a><span class="delimiter">[</span>Tree =&gt; Tree<span class="delimiter">]</span>, <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.unchecked">unchecked</a>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#scala;Option" title="Option[MatchOptimization.this.global.Tree]">Option</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <span class="delimiter">{</span> import <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE" title="MatchOptimization.this.CODE.type">CODE</a>._
      val <a title="SwitchEmission.this.RegularSwitchMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.regularSwitchMaker">regularSwitchMaker</a> = new <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;RegularSwitchMaker" title="SwitchEmission.this.RegularSwitchMaker">RegularSwitchMaker</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.matchFailGenOverride" title="Option[MatchOptimization.this.global.Tree =&gt; MatchOptimization.this.global.Tree]">matchFailGenOverride</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.unchecked" title="Boolean">unchecked</a><span class="delimiter">)</span>
      <span class="comment">// TODO: if patterns allow switch but the type of the scrutinee doesn't, cast (type-test) the scrutinee to the corresponding switchable type and switch on the result</span>
      if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.regularSwitchMaker" title="SwitchEmission.this.RegularSwitchMaker">regularSwitchMaker</a>.<a href="../../../../collection/GenSetLike.scala.html#scala.collection;GenSetLike.apply" title="(elem: MatchOptimization.this.global.Type)Boolean">switchableTpe</a><span class="delimiter">(</span><a href="PatternMatching.scala.html#scala.tools.nsc.transform.patmat;Interface.dealiasWiden" title="(tp: MatchOptimization.this.global.Type)MatchOptimization.this.global.Type">dealiasWiden</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        val <a title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.caseDefsWithDefault">caseDefsWithDefault</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply" title="(cases: List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])], pt: MatchOptimization.this.global.Type)List[MatchOptimization.this.global.CaseDef]">regularSwitchMaker</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.cases" title="List[List[SwitchEmission.this.TreeMaker]]">cases</a> <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: List[SwitchEmission.this.TreeMaker] =&gt; (MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker]))(implicit bf: scala.collection.generic.CanBuildFrom[List[List[SwitchEmission.this.TreeMaker]],(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker]),List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]])List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]">map</a> <span class="delimiter">{</span><a title="List[SwitchEmission.this.TreeMaker]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.caseDefsWithDefault.$anonfun.c">c</a> =&gt; <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: MatchOptimization.this.global.Symbol, _2: List[SwitchEmission.this.TreeMaker])(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.caseDefsWithDefault.$anonfun.c" title="List[SwitchEmission.this.TreeMaker]">c</a><span class="delimiter">)</span><span class="delimiter">}</span>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.pt" title="MatchOptimization.this.global.Type">pt</a><span class="delimiter">)</span>
        if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.caseDefsWithDefault" title="List[MatchOptimization.this.global.CaseDef]">caseDefsWithDefault</a> <a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a> <span class="comment">// not worth emitting a switch.</span>
        else <span class="delimiter">{</span>
          <span class="comment">// match on scrutSym -- converted to an int if necessary -- not on scrut directly (to avoid duplicating scrut)</span>
          val <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrutToInt">scrutToInt</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a> =
            if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a> <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.=:=" title="(that: MatchOptimization.this.global.Type)Boolean">=:=</a> <a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;ValueClassDefinitions.IntTpe" title="=&gt; MatchOptimization.this.global.Type">IntTpe</a><span class="delimiter">)</span> <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.REF(aa0d4af395)" title="(sym: MatchOptimization.this.global.Symbol)MatchOptimization.this.global.gen.global.RefTree">REF</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a><span class="delimiter">)</span>
            else <span class="delimiter">(</span><a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.REF(aa0d4af395)" title="(sym: MatchOptimization.this.global.Symbol)MatchOptimization.this.global.gen.global.RefTree">REF</a><a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.mkTreeMethods" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: MatchOptimization.this.global.Tree)MatchOptimization.this.CODE.TreeMethods" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a><span class="delimiter">)</span> <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.mkTreeFromSelectStart" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeFromSelectStart : (ss: MatchOptimization.this.CODE.SelectStart)MatchOptimization.this.global.Select">DOT</a> <span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;TermNames.toInt" title="=&gt; MatchOptimization.this.global.nme.NameType">toInt</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../../Option.scala.html#scala;Some" title="(x: MatchOptimization.this.global.Block)Some[MatchOptimization.this.global.Block]">Some</a><span class="delimiter">(</span><a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.BLOCK" title="(xs: MatchOptimization.this.global.Tree*)MatchOptimization.this.global.Block">BLOCK</a><span class="delimiter">(</span>
            <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.ValDef.apply(9493665b33)" title="(sym: MatchOptimization.this.global.Symbol, rhs: MatchOptimization.this.global.Tree)MatchOptimization.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrutSym" title="MatchOptimization.this.global.Symbol">scrutSym</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrut" title="MatchOptimization.this.global.Tree">scrut</a><span class="delimiter">)</span>,
            <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Match" title="(selector: MatchOptimization.this.global.Tree, cases: List[MatchOptimization.this.global.CaseDef])MatchOptimization.this.global.Match">Match</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.scrutToInt" title="MatchOptimization.this.global.Tree">scrutToInt</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitSwitch.caseDefsWithDefault" title="List[MatchOptimization.this.global.CaseDef]">caseDefsWithDefault</a><span class="delimiter">)</span> <span class="comment">// a switch</span>
          <span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> else <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a>
    <span class="delimiter">}</span>

    <span class="comment">// for the catch-cases in a try/catch</span>
    private object <a title="SwitchEmission.this.typeSwitchMaker.type" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker">typeSwitchMaker</a> extends <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker" title="SwitchEmission.this.SwitchMaker">SwitchMaker</a> <span class="delimiter">{</span>
      val <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.unchecked">unchecked</a> = false
      val <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.alternativesSupported">alternativesSupported</a> = false <span class="comment">// TODO: needs either back-end support of flattening of alternatives during typers</span>
      val <a title="Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.canJump">canJump</a> = false

      <span class="comment">// TODO: there are more treemaker-sequences that can be handled by type tests</span>
      <span class="comment">// analyze the result of approximateTreeMaker rather than the TreeMaker itself</span>
      object <a title="scala.tools.nsc.transform.patmat.MatchOptimization.SwitchEmission.typeSwitchMaker.SwitchableTreeMaker.type" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.SwitchableTreeMaker">SwitchableTreeMaker</a> extends <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker;SwitchableTreeMakerExtractor" title="scala.tools.nsc.transform.patmat.MatchOptimization.SwitchEmission.typeSwitchMaker.SwitchableTreeMakerExtractor">SwitchableTreeMakerExtractor</a> <span class="delimiter">{</span>
        def <a title="(x: SwitchEmission.this.TreeMaker)Option[MatchOptimization.this.global.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.SwitchableTreeMaker.unapply">unapply</a><span class="delimiter">(</span><a title="SwitchEmission.this.TreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.SwitchableTreeMaker.unapply.x">x</a>: <a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TreeMaker" title="SwitchEmission.this.TreeMaker">TreeMaker</a><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#scala;Option" title="Option[MatchOptimization.this.global.Tree]">Option</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.SwitchableTreeMaker.unapply.x" title="SwitchEmission.this.TreeMaker">x</a> match <span class="delimiter">{</span>
          case <a title="SwitchEmission.this.TypeTestTreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.SwitchableTreeMaker.unapply.tm">tm</a>@TypeTestTreeMaker<span class="delimiter">(</span>_, _, <a title="MatchOptimization.this.global.Type" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.SwitchableTreeMaker.unapply.pt">pt</a>, _<span class="delimiter">)</span> if <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.SwitchableTreeMaker.unapply.tm" title="SwitchEmission.this.TypeTestTreeMaker">tm</a>.<a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;TypeTestTreeMaker.isPureTypeTest" title="=&gt; SwitchEmission.this.TypeTestTreeMaker.pureTypeTestChecker.Result">isPureTypeTest</a> =&gt; <span class="comment">//  -- TODO: use this if binder does not occur in the body</span>
            <a href="../../../../Option.scala.html#scala;Some" title="(x: MatchOptimization.this.global.Bind)Some[MatchOptimization.this.global.Bind]">Some</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.Bind(deb2955bab)" title="(sym: MatchOptimization.this.global.Symbol, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Bind">Bind</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.SwitchableTreeMaker.unapply.tm" title="SwitchEmission.this.TypeTestTreeMaker">tm</a>.<a href="MatchTreeMaking.scala.html#scala.tools.nsc.transform.patmat;MatchTreeMaking;TreeMakers;CondTreeMaker.nextBinder" title="=&gt; MatchOptimization.this.global.TermSymbol">nextBinder</a>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Typed" title="(expr: MatchOptimization.this.global.Tree, tpt: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Typed">Typed</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Ident" title="(name: MatchOptimization.this.global.Name)MatchOptimization.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.TypeTree(559e7d9959)" title="(tp: MatchOptimization.this.global.Type)MatchOptimization.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.SwitchableTreeMaker.unapply.pt" title="MatchOptimization.this.global.Type">pt</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="comment">/* not used by back-end */</span><span class="delimiter">)</span><span class="delimiter">)</span>
          case _ =&gt;
            <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      def <a title="(x: MatchOptimization.this.global.CaseDef)Boolean" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.isDefault">isDefault</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.isDefault.x">x</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.isDefault.x" title="MatchOptimization.this.global.CaseDef">x</a> match <span class="delimiter">{</span>
        case CaseDef<span class="delimiter">(</span>Typed<span class="delimiter">(</span>Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <span title="MatchOptimization.this.global.Tree">tpt</span><span class="delimiter">)</span>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, _<span class="delimiter">)</span> if <span class="delimiter">(</span><span title="MatchOptimization.this.global.Tree">tpt</span>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a> <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.=:=" title="(that: MatchOptimization.this.global.Type)Boolean">=:=</a> <a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ThrowableTpe" title="=&gt; MatchOptimization.this.global.Type">ThrowableTpe</a><span class="delimiter">)</span>          =&gt; true
        case CaseDef<span class="delimiter">(</span>Bind<span class="delimiter">(</span>_, Typed<span class="delimiter">(</span>Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <span title="MatchOptimization.this.global.Tree">tpt</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, _<span class="delimiter">)</span> if <span class="delimiter">(</span><span title="MatchOptimization.this.global.Tree">tpt</span>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.tpe" title="=&gt; MatchOptimization.this.global.Type">tpe</a> <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type.=:=" title="(that: MatchOptimization.this.global.Type)Boolean">=:=</a> <a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ThrowableTpe" title="=&gt; MatchOptimization.this.global.Type">ThrowableTpe</a><span class="delimiter">)</span> =&gt; true
        case CaseDef<span class="delimiter">(</span>Ident<span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, _<span class="delimiter">)</span>                                                          =&gt; true
        case _ =&gt; false
      <span class="delimiter">}</span>

      lazy val <a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultSym">defaultSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a> = <a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;CodegenCore.freshSym" title="(pos: MatchOptimization.this.global.Position, tp: MatchOptimization.this.global.Type, prefix: String)MatchOptimization.this.global.TermSymbol">freshSym</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Positions.scala.html#scala.reflect.internal;Positions.NoPosition" title="=&gt; reflect.internal.util.NoPosition.type">NoPosition</a>, <a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ThrowableTpe" title="=&gt; MatchOptimization.this.global.Type">ThrowableTpe</a><span class="delimiter">)</span>
      def <a title="=&gt; MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultBody">defaultBody</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a>       = <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Throw" title="(expr: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Throw">Throw</a><span class="delimiter">(</span><a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE" title="MatchOptimization.this.CODE.type">CODE</a>.<a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.REF(aa0d4af395)" title="(sym: MatchOptimization.this.global.Symbol)MatchOptimization.this.global.gen.global.RefTree">REF</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultSym" title="=&gt; MatchOptimization.this.global.Symbol">defaultSym</a><span class="delimiter">)</span><span class="delimiter">)</span>
      def <a title="(scrutSym: MatchOptimization.this.global.Symbol, guard: MatchOptimization.this.global.Tree, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultCase">defaultCase</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultCase$default$1">scrutSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultSym" title="=&gt; MatchOptimization.this.global.Symbol">defaultSym</a>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultCase$default$2">guard</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a> = <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.EmptyTree" title="MatchOptimization.this.global.EmptyTree.type">EmptyTree</a>, <a title="MatchOptimization.this.global.Tree" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultCase$default$3">body</a>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree" title="MatchOptimization.this.global.Tree">Tree</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultBody" title="=&gt; MatchOptimization.this.global.Tree">defaultBody</a><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;CaseDef" title="MatchOptimization.this.global.CaseDef">CaseDef</a> = <span class="delimiter">{</span> import <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE" title="MatchOptimization.this.CODE.type">CODE</a>._; <a href="../../../../reflect/internal/Positions.scala.html#scala.reflect.internal;Positions.atPos" title="(pos: MatchOptimization.this.global.Position)(tree: MatchOptimization.this.global.CaseDef)MatchOptimization.this.global.CaseDef">atPos</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultCase$default$3" title="MatchOptimization.this.global.Tree">body</a>.<a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; MatchOptimization.this.global.Position">pos</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="delimiter">(</span><a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE.CASE" title="(pat: MatchOptimization.this.global.Tree)MatchOptimization.this.CODE.CaseStart">CASE</a> <span class="delimiter">(</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.Bind(deb2955bab)" title="(sym: MatchOptimization.this.global.Symbol, body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Bind">Bind</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultCase$default$1" title="MatchOptimization.this.global.Symbol">scrutSym</a>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Typed" title="(expr: MatchOptimization.this.global.Tree, tpt: MatchOptimization.this.global.Tree)MatchOptimization.this.global.Typed">Typed</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Ident" title="(name: MatchOptimization.this.global.Name)MatchOptimization.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames.nme" title="MatchOptimization.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#scala.reflect.internal;StdNames;CommonNames.WILDCARD" title="=&gt; MatchOptimization.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <a href="../../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees.TypeTree(559e7d9959)" title="(tp: MatchOptimization.this.global.Type)MatchOptimization.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#scala.reflect.internal;Definitions;DefinitionsClass.ThrowableTpe" title="=&gt; MatchOptimization.this.global.Type">ThrowableTpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE;CaseStart.IF" title="(g: MatchOptimization.this.global.Tree)MatchOptimization.this.CODE.CaseStart">IF</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultCase$default$2" title="MatchOptimization.this.global.Tree">guard</a><span class="delimiter">)</span> <a href="../../ast/TreeDSL.scala.html#scala.tools.nsc.ast;TreeDSL.CODE;CaseStart.==>" title="(body: MatchOptimization.this.global.Tree)MatchOptimization.this.global.CaseDef">==&gt;</a> <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.typeSwitchMaker.defaultCase$default$3" title="MatchOptimization.this.global.Tree">body</a>
      <span class="delimiter">}</span><span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">// TODO: drop null checks</span>
    override def <a title="(bindersAndCases: List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])], pt: MatchOptimization.this.global.Type)Option[List[MatchOptimization.this.global.CaseDef]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitTypeSwitch">emitTypeSwitch</a><span class="delimiter">(</span><a title="List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitTypeSwitch.bindersAndCases">bindersAndCases</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]">List</a><span class="delimiter">[</span><span class="delimiter">(</span>Symbol, List<span class="delimiter">[</span>TreeMaker<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span>, <a title="MatchOptimization.this.global.Type" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitTypeSwitch.pt">pt</a>: <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="MatchOptimization.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#scala;Option" title="Option[List[MatchOptimization.this.global.CaseDef]]">Option</a><span class="delimiter">[</span>List<span class="delimiter">[</span>CaseDef<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
      val <a title="List[MatchOptimization.this.global.CaseDef]" id="scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitTypeSwitch.caseDefsWithDefault">caseDefsWithDefault</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission;SwitchMaker.apply" title="(cases: List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])], pt: MatchOptimization.this.global.Type)List[MatchOptimization.this.global.CaseDef]">typeSwitchMaker</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitTypeSwitch.bindersAndCases" title="List[(MatchOptimization.this.global.Symbol, List[SwitchEmission.this.TreeMaker])]">bindersAndCases</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitTypeSwitch.pt" title="MatchOptimization.this.global.Type">pt</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitTypeSwitch.caseDefsWithDefault" title="List[MatchOptimization.this.global.CaseDef]">caseDefsWithDefault</a> <a href="../../../../collection/SeqLike.scala.html#scala.collection;SeqLike.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../Option.scala.html#scala.None" title="None.type">None</a>
      else <a href="../../../../Option.scala.html#scala;Some" title="(x: List[MatchOptimization.this.global.CaseDef])Some[List[MatchOptimization.this.global.CaseDef]]">Some</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission.emitTypeSwitch.caseDefsWithDefault" title="List[MatchOptimization.this.global.CaseDef]">caseDefsWithDefault</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  trait <a title="trait MatchOptimizer extends AnyRef with MatchOptimization.this.OptimizedCodegen with MatchOptimization.this.SwitchEmission with MatchOptimization.this.CommonSubconditionElimination" id="scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer">MatchOptimizer</a> extends <a href="MatchCodeGen.scala.html#scala.tools.nsc.transform.patmat;MatchCodeGen;OptimizedCodegen" title="MatchOptimization.this.OptimizedCodegen">OptimizedCodegen</a>
                          with <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;SwitchEmission" title="MatchOptimization.this.SwitchEmission">SwitchEmission</a>
                          with <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination" title="MatchOptimization.this.CommonSubconditionElimination">CommonSubconditionElimination</a> <span class="delimiter">{</span>
    override def <a title="(prevBinder: MatchOptimization.this.global.Symbol, cases: List[List[MatchOptimizer.this.TreeMaker]], pt: MatchOptimizer.this.Type)(List[List[MatchOptimizer.this.TreeMaker]], List[MatchOptimizer.this.Tree])" id="scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases">optimizeCases</a><span class="delimiter">(</span><a title="MatchOptimization.this.global.Symbol" id="scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.prevBinder">prevBinder</a>: <a href="../../../../reflect/internal/Symbols.scala.html#scala.reflect.internal;Symbols;Symbol" title="MatchOptimization.this.global.Symbol">Symbol</a>, <a title="List[List[MatchOptimizer.this.TreeMaker]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.cases">cases</a>: <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[List[MatchOptimizer.this.TreeMaker]]">List</a><span class="delimiter">[</span>List<span class="delimiter">[</span>TreeMaker<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="MatchOptimizer.this.Type" id="scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.pt">pt</a>: <a href="../../../../reflect/internal/Types.scala.html#scala.reflect.internal;Types;Type" title="MatchOptimizer.this.Type">Type</a><span class="delimiter">)</span>: <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(List[List[MatchOptimizer.this.TreeMaker]], List[MatchOptimizer.this.Tree])" class="delimiter">(</a>List<span class="delimiter">[</span>List<span class="delimiter">[</span>TreeMaker<span class="delimiter">]</span><span class="delimiter">]</span>, List<span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="comment">// TODO: do CSE on result of doDCE(prevBinder, cases, pt)</span>
      val <a title="List[List[MatchOptimizer.this.TreeMaker]]" id="scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.optCases">optCases</a> = <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination.doCSE" title="(prevBinder: MatchOptimization.this.global.Symbol, cases: List[List[MatchOptimizer.this.TreeMaker]], pt: MatchOptimizer.this.Type)List[List[MatchOptimizer.this.TreeMaker]]">doCSE</a><span class="delimiter">(</span><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.prevBinder" title="MatchOptimization.this.global.Symbol">prevBinder</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.cases" title="List[List[MatchOptimizer.this.TreeMaker]]">cases</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.pt" title="MatchOptimizer.this.Type">pt</a><span class="delimiter">)</span>
      val <a title="List[MatchOptimizer.this.Tree]" id="scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.toHoist">toHoist</a> = <span class="delimiter">(</span>
        for <span class="delimiter">(</span><a title="List[MatchOptimizer.this.TreeMaker]" id="scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.toHoist.$anonfun.treeMakers">treeMakers</a> &lt;- <a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="(f: List[MatchOptimizer.this.TreeMaker] =&gt; List[List[MatchOptimizer.this.Tree]])(implicit bf: scala.collection.generic.CanBuildFrom[List[List[MatchOptimizer.this.TreeMaker]],List[List[MatchOptimizer.this.Tree]],List[List[List[MatchOptimizer.this.Tree]]]])List[List[List[MatchOptimizer.this.Tree]]]">optCases</a><span class="delimiter">)</span>
          yield <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.toHoist.$anonfun.treeMakers" title="List[MatchOptimizer.this.TreeMaker]">treeMakers</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.collect" title="(pf: PartialFunction[MatchOptimizer.this.TreeMaker,List[MatchOptimizer.this.Tree]])(implicit bf: scala.collection.generic.CanBuildFrom[List[MatchOptimizer.this.TreeMaker],List[MatchOptimizer.this.Tree],List[List[MatchOptimizer.this.Tree]]])List[List[MatchOptimizer.this.Tree]]">collect</a><a title="&lt;$anon: MatchOptimizer.this.TreeMaker =&gt; List[MatchOptimizer.this.Tree]&gt; extends scala.runtime.AbstractPartialFunction[MatchOptimizer.this.TreeMaker,List[MatchOptimizer.this.Tree]] with Serializable" id="scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.toHoist.$anonfun;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>case <a title="MatchOptimizer.this.ReusedCondTreeMaker" id="scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.toHoist.$anonfun;$anonfun.isDefinedAt.tm">tm</a>: <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker" title="MatchOptimizer.this.ReusedCondTreeMaker">ReusedCondTreeMaker</a> =&gt; <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.toHoist.$anonfun;$anonfun.isDefinedAt.tm" title="MatchOptimizer.this.ReusedCondTreeMaker">tm</a>.<a href="#scala.tools.nsc.transform.patmat;MatchOptimization;CommonSubconditionElimination;ReusedCondTreeMaker.treesToHoist" title="=&gt; List[MatchOptimizer.this.Tree]">treesToHoist</a><span class="delimiter">}</span>
        <span class="delimiter">)</span>.<a href="../../../../collection/generic/GenericTraversableTemplate.scala.html#scala.collection.generic;GenericTraversableTemplate.flatten" title="(implicit asTraversable: List[List[MatchOptimizer.this.Tree]] =&gt; scala.collection.GenTraversableOnce[List[MatchOptimizer.this.Tree]])List[List[MatchOptimizer.this.Tree]]">flatten</a>.<a href="../../../../collection/generic/GenericTraversableTemplate.scala.html#scala.collection.generic;GenericTraversableTemplate.flatten" title="(implicit asTraversable: List[MatchOptimizer.this.Tree] =&gt; scala.collection.GenTraversableOnce[MatchOptimizer.this.Tree])List[MatchOptimizer.this.Tree]">flatten</a>.<a href="../../../../collection/immutable/List.scala.html#scala.collection.immutable;List.toList" title="=&gt; List[MatchOptimizer.this.Tree]">toList</a>
      <a href="../../../../Tuple2.scala.html#scala;Tuple2" title="(_1: List[List[MatchOptimizer.this.TreeMaker]], _2: List[MatchOptimizer.this.Tree])(List[List[MatchOptimizer.this.TreeMaker]], List[MatchOptimizer.this.Tree])" class="delimiter">(</a><a href="#scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.optCases" title="List[List[MatchOptimizer.this.TreeMaker]]">optCases</a>, <a href="#scala.tools.nsc.transform.patmat;MatchOptimization;MatchOptimizer.optimizeCases.toHoist" title="List[MatchOptimizer.this.Tree]">toHoist</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

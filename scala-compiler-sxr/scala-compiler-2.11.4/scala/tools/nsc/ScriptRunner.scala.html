<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scala/tools/nsc/ScriptRunner.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2013 LAMP/EPFL
 * @author  Martin Odersky
 */</span>

package scala
package tools.nsc

import io.<span class="delimiter">{</span> AbstractFile, Directory, File, Path <span class="delimiter">}</span>
import java.io.IOException
import scala.tools.nsc.reporters.<span class="delimiter">{</span>Reporter,ConsoleReporter<span class="delimiter">}</span>
import util.<a href="util/Exceptional.scala.html#scala.tools.nsc.util.Exceptional" title="scala.tools.nsc.util.Exceptional.type">Exceptional</a>.unwrap

<span class="comment">/** An object that runs Scala code in script files.
 *
 *  &lt;p&gt;For example, here is a complete Scala script on Unix:&lt;/pre&gt;
 *  &lt;pre&gt;
 *    #!/bin/sh
 *    exec scala &quot;$0&quot; &quot;$@&quot;
 *    !#
 *    Console.println(&quot;Hello, world!&quot;)
 *    args.toList foreach Console.println
 *  &lt;/pre&gt;
 *  &lt;p&gt;And here is a batch file example on Windows XP:&lt;/p&gt;
 *  &lt;pre&gt;
 *    ::#!
 *    @echo off
 *    call scala %0 %*
 *    goto :eof
 *    ::!#
 *    Console.println(&quot;Hello, world!&quot;)
 *    args.toList foreach Console.println
 *  &lt;/pre&gt;
 *
 *  @author  Lex Spoon
 *  @version 1.0, 15/05/2006
 *  @todo    It would be better if error output went to stderr instead
 *           of stdout...
 */</span>
class <a title="class ScriptRunner extends AnyRef with scala.tools.nsc.HasCompileSocket" id="scala.tools.nsc;ScriptRunner">ScriptRunner</a> extends <a href="CompileSocket.scala.html#scala.tools.nsc;HasCompileSocket" title="scala.tools.nsc.HasCompileSocket">HasCompileSocket</a> <span class="delimiter">{</span>
  lazy val <a title="scala.tools.nsc.CompileSocket.type" id="scala.tools.nsc;ScriptRunner.compileSocket">compileSocket</a> = <a href="CompileSocket.scala.html#scala.tools.nsc.CompileSocket" title="scala.tools.nsc.CompileSocket.type">CompileSocket</a>

  <span class="comment">/** Default name to use for the wrapped script */</span>
  val <a title="String" id="scala.tools.nsc;ScriptRunner.defaultScriptMain">defaultScriptMain</a> = <span title="String(&quot;Main&quot;)" class="string">&quot;Main&quot;</span>

  <span class="comment">/** Pick a main object name from the specified settings */</span>
  def <a title="(settings: scala.tools.nsc.Settings)String" id="scala.tools.nsc;ScriptRunner.scriptMain">scriptMain</a><span class="delimiter">(</span><a title="scala.tools.nsc.Settings" id="scala.tools.nsc;ScriptRunner.scriptMain.settings">settings</a>: <a href="Settings.scala.html#scala.tools.nsc;Settings" title="scala.tools.nsc.Settings">Settings</a><span class="delimiter">)</span> = <a href="#scala.tools.nsc;ScriptRunner.scriptMain.settings" title="scala.tools.nsc.Settings">settings</a>.<a href="settings/ScalaSettings.scala.html#scala.tools.nsc.settings;ScalaSettings.script" title="=&gt; settings.StringSetting">script</a>.<a href="../../reflect/internal/settings/MutableSettings.scala.html#scala.reflect.internal.settings;MutableSettings;SettingValue.value" title="=&gt; settings.script.T">value</a> match <span class="delimiter">{</span>
    case <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> =&gt; <a href="#scala.tools.nsc;ScriptRunner.defaultScriptMain" title="=&gt; String">defaultScriptMain</a>
    case <a title="settings.script.T" id="scala.tools.nsc;ScriptRunner.scriptMain.x">x</a>  =&gt; <a href="#scala.tools.nsc;ScriptRunner.scriptMain.x" title="settings.script.T">x</a>
  <span class="delimiter">}</span>

  <span class="comment">/** Choose a jar filename to hold the compiled version of a script. */</span>
  private def <a title="(scriptFile: String)scala.reflect.io.File" id="scala.tools.nsc;ScriptRunner.jarFileFor">jarFileFor</a><span class="delimiter">(</span><a title="String" id="scala.tools.nsc;ScriptRunner.jarFileFor.scriptFile">scriptFile</a>: <span title="String">String</span><span class="delimiter">)</span>= <a href="../../reflect/io/File.scala.html#scala.reflect.io.File.apply" title="(path: scala.reflect.io.Path)(implicit codec: scala.io.Codec)scala.reflect.io.File">File</a><a href="../../io/Codec.scala.html#scala.io;LowPriorityCodecImplicits.fallbackSystemCodec" title="=&gt; scala.io.Codec" class="delimiter">(</a>
    if <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.jarFileFor.scriptFile" title="String">scriptFile</a> <span title="(x$1: String)Boolean">endsWith</span> <span title="String(&quot;.jar&quot;)" class="string">&quot;.jar&quot;</span><span class="delimiter">)</span> <a href="../../reflect/io/Path.scala.html#scala.reflect.io.Path.string2path" title="implicit scala.reflect.io.Path.string2path : (s: String)scala.reflect.io.Path">scriptFile</a>
    else <a href="../../Predef.scala.html#scala.Predef.augmentString" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">scriptFile</a>.<a href="../../collection/immutable/StringLike.scala.html#scala.collection.immutable;StringLike.stripSuffix" title="(suffix: String)String">stripSuffix</a><span class="delimiter">(</span><span title="String(&quot;.scala&quot;)" class="string">&quot;.scala&quot;</span><span class="delimiter">)</span> <a href="../../reflect/io/Path.scala.html#scala.reflect.io.Path.string2path" title="implicit scala.reflect.io.Path.string2path : (s: String)scala.reflect.io.Path">+</a> <span title="String(&quot;.jar&quot;)" class="string">&quot;.jar&quot;</span>
  <span class="delimiter">)</span>

  <span class="comment">/** Compile a script using the fsc compilation daemon.
   */</span>
  private def <a title="(settings: scala.tools.nsc.GenericRunnerSettings, scriptFileIn: String)Boolean" id="scala.tools.nsc;ScriptRunner.compileWithDaemon">compileWithDaemon</a><span class="delimiter">(</span><a title="scala.tools.nsc.GenericRunnerSettings" id="scala.tools.nsc;ScriptRunner.compileWithDaemon.settings">settings</a>: <a href="GenericRunnerSettings.scala.html#scala.tools.nsc;GenericRunnerSettings" title="scala.tools.nsc.GenericRunnerSettings">GenericRunnerSettings</a>, <a title="String" id="scala.tools.nsc;ScriptRunner.compileWithDaemon.scriptFileIn">scriptFileIn</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    val <a title="String" id="scala.tools.nsc;ScriptRunner.compileWithDaemon.scriptFile">scriptFile</a>       = <a href="../../reflect/io/Path.scala.html#scala.reflect.io.Path.apply(b8c32fbd51)" title="(path: String)scala.reflect.io.Path">Path</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.scriptFileIn" title="String">scriptFileIn</a><span class="delimiter">)</span>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.toAbsolute" title="=&gt; scala.reflect.io.Path">toAbsolute</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.path" title="=&gt; String">path</a>
    val compSettingNames = new <a href="Settings.scala.html#scala.tools.nsc;Settings" title="scala.tools.nsc.Settings">Settings</a><span class="delimiter">(</span>sys.<a href="../../sys/package.scala.html#scala.sys.package.error" title="(message: String)Nothing">error</a><span class="delimiter">)</span>.<a href="settings/AbsSettings.scala.html#scala.tools.nsc.settings;AbsSettings.visibleSettings" title="(=&gt; scala.collection.Set[_4525.Setting]) forSome { val _4525: scala.tools.nsc.Settings }">visibleSettings</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[_1780.Setting]">toList</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.map" title="List[String]" id="scala.tools.nsc;ScriptRunner.compileWithDaemon.compSettingNames">map</a> <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.compSettingNames.$anonfun.x$1" title="_1780.Setting">_</a>.<a href="settings/MutableSettings.scala.html#scala.tools.nsc.settings;MutableSettings;Setting.name" title="=&gt; String">name</a><span class="delimiter">)</span>
    val compSettings     = <a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a href="settings/AbsSettings.scala.html#scala.tools.nsc.settings;AbsSettings.visibleSettings" title="=&gt; scala.collection.Set[settings.Setting]">visibleSettings</a>.<a href="../../collection/TraversableOnce.scala.html#scala.collection;TraversableOnce.toList" title="=&gt; List[settings.Setting]">toList</a> <a href="../../collection/TraversableLike.scala.html#scala.collection;TraversableLike.filter" title="List[settings.Setting]" id="scala.tools.nsc;ScriptRunner.compileWithDaemon.compSettings">filter</a> <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.compSettingNames" title="List[String]">compSettingNames</a> <a href="../../collection/LinearSeqOptimized.scala.html#scala.collection;LinearSeqOptimized.contains" title="(elem: String)Boolean">contains</a> <a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.compSettings.$anonfun.x$2" title="settings.Setting">_</a>.<a href="settings/MutableSettings.scala.html#scala.tools.nsc.settings;MutableSettings;Setting.name" title="=&gt; String">name</a><span class="delimiter">)</span>
    val coreCompArgs     = <a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.compSettings" title="List[settings.Setting]">compSettings</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.flatMap" title="List[String]" id="scala.tools.nsc;ScriptRunner.compileWithDaemon.coreCompArgs">flatMap</a> <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.coreCompArgs.$anonfun.x$3" title="settings.Setting">_</a>.<a href="settings/AbsSettings.scala.html#scala.tools.nsc.settings;AbsSettings;AbsSetting.unparse" title="=&gt; List[String]">unparse</a><span class="delimiter">)</span>
    val compArgs         = <a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.coreCompArgs" title="List[String]">coreCompArgs</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.++" title="List[String]" id="scala.tools.nsc;ScriptRunner.compileWithDaemon.compArgs">++</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: String*)List[String]">List</a><span class="delimiter">(</span><span title="String(&quot;-Xscript&quot;)" class="string">&quot;-Xscript&quot;</span>, <a href="#scala.tools.nsc;ScriptRunner.scriptMain" title="(settings: scala.tools.nsc.Settings)String">scriptMain</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a><span class="delimiter">)</span>, <a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.scriptFile" title="String">scriptFile</a><span class="delimiter">)</span>

    <a href="CompileSocket.scala.html#scala.tools.nsc.CompileSocket" title="scala.tools.nsc.CompileSocket.type">CompileSocket</a> <a href="CompileSocket.scala.html#scala.tools.nsc;CompileSocket.getOrCreateSocket" title="(vmArgs: String, create: Boolean)Option[scala.tools.nsc.io.Socket]">getOrCreateSocket</a> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="scala.tools.nsc.io.Socket" id="scala.tools.nsc;ScriptRunner.compileWithDaemon.sock">sock</a><span class="delimiter">)</span> =&gt; <a href="CompileSocket.scala.html#scala.tools.nsc;HasCompileSocket.compileOnServer" title="(sock: scala.tools.nsc.io.Socket, args: Seq[String])Boolean">compileOnServer</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.sock" title="scala.tools.nsc.io.Socket">sock</a>, <a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon.compArgs" title="List[String]">compArgs</a><span class="delimiter">)</span>
      case _          =&gt; false
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  protected def <a title="(settings: scala.tools.nsc.Settings, reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global" id="scala.tools.nsc;ScriptRunner.newGlobal">newGlobal</a><span class="delimiter">(</span><a title="scala.tools.nsc.Settings" id="scala.tools.nsc;ScriptRunner.newGlobal.settings">settings</a>: <a href="Settings.scala.html#scala.tools.nsc;Settings" title="scala.tools.nsc.Settings">Settings</a>, <a title="scala.tools.nsc.reporters.Reporter" id="scala.tools.nsc;ScriptRunner.newGlobal.reporter">reporter</a>: <a href="reporters/Reporter.scala.html#scala.tools.nsc.reporters;Reporter" title="scala.tools.nsc.reporters.Reporter">Reporter</a><span class="delimiter">)</span> =
    <a href="Global.scala.html#scala.tools.nsc.Global.apply" title="(settings: scala.tools.nsc.Settings, reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global">Global</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.newGlobal.settings" title="scala.tools.nsc.Settings">settings</a>, <a href="#scala.tools.nsc;ScriptRunner.newGlobal.reporter" title="scala.tools.nsc.reporters.Reporter">reporter</a><span class="delimiter">)</span>

  <span class="comment">/** Compile a script and then run the specified closure with
    * a classpath for the compiled script.
    *
    * @return true if compilation and the handler succeeds, false otherwise.
    */</span>
  private def <a title="(settings: scala.tools.nsc.GenericRunnerSettings, scriptFile: String)(handler: String =&gt; Boolean)Boolean" id="scala.tools.nsc;ScriptRunner.withCompiledScript">withCompiledScript</a><span class="delimiter">(</span>
    <a title="scala.tools.nsc.GenericRunnerSettings" id="scala.tools.nsc;ScriptRunner.withCompiledScript.settings">settings</a>: <a href="GenericRunnerSettings.scala.html#scala.tools.nsc;GenericRunnerSettings" title="scala.tools.nsc.GenericRunnerSettings">GenericRunnerSettings</a>,
    <a title="String" id="scala.tools.nsc;ScriptRunner.withCompiledScript.scriptFile">scriptFile</a>: <span title="String">String</span><span class="delimiter">)</span>
    <span class="delimiter">(</span><a title="String =&gt; Boolean" id="scala.tools.nsc;ScriptRunner.withCompiledScript.handler">handler</a>: String =&gt; Boolean<span class="delimiter">)</span>: <a href="../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> =
  <span class="delimiter">{</span>
    def <a title="=&gt; String" id="scala.tools.nsc;ScriptRunner.withCompiledScript.mainClass">mainClass</a> = <a href="#scala.tools.nsc;ScriptRunner.scriptMain" title="(settings: scala.tools.nsc.Settings)String">scriptMain</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a><span class="delimiter">)</span>

    <span class="comment">/* Compiles the script file, and returns the directory with the compiled
     * class files, if the compilation succeeded.
     */</span>
    def <a title="=&gt; Option[scala.tools.nsc.io.Directory]" id="scala.tools.nsc;ScriptRunner.withCompiledScript.compile">compile</a>: <a href="../../Option.scala.html#scala;Option" title="Option[scala.tools.nsc.io.Directory]">Option</a><span class="delimiter">[</span>Directory<span class="delimiter">]</span> = <span class="delimiter">{</span>
      val compiledPath = <a href="io/package.scala.html#scala.tools.nsc.io.package.Directory" title="=&gt; reflect.io.Directory.type">Directory</a> <a href="../../reflect/io/Directory.scala.html#scala.reflect.io.Directory.makeTemp" title="scala.reflect.io.Directory" id="scala.tools.nsc;ScriptRunner.withCompiledScript.compile.compiledPath">makeTemp</a> <span title="String(&quot;scalascript&quot;)" class="string">&quot;scalascript&quot;</span>

      <span class="comment">// delete the directory after the user code has finished</span>
      sys.<a href="../../sys/package.scala.html#scala.sys.package.addShutdownHook" title="(body: =&gt; Unit)scala.sys.ShutdownHookThread">addShutdownHook</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.compile.compiledPath" title="scala.reflect.io.Directory">compiledPath</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.deleteRecursively(f32ef3bcdd)" title="()Boolean">deleteRecursively</a><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

      <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a href="settings/ScalaSettings.scala.html#scala.tools.nsc.settings;ScalaSettings.outdir" title="=&gt; settings.OutputSetting">outdir</a>.<a href="settings/MutableSettings.scala.html#scala.tools.nsc.settings;MutableSettings;OutputSetting.value_=" title="(str: String)Unit">value</a> = <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.compile.compiledPath" title="scala.reflect.io.Directory">compiledPath</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.path" title="=&gt; String">path</a>

      if <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a href="../../reflect/internal/settings/MutableSettings.scala.html#scala.reflect.internal.settings.MutableSettings.reflectSettingToBoolean" title="implicit scala.reflect.internal.settings.MutableSettings.reflectSettingToBoolean : (s: scala.reflect.internal.settings.MutableSettings#BooleanSetting)Boolean">nc</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">/* Setting settings.script.value informs the compiler this is not a
         * self contained compilation unit.
         */</span>
        <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a href="settings/ScalaSettings.scala.html#scala.tools.nsc.settings;ScalaSettings.script" title="=&gt; settings.StringSetting">script</a>.<a href="../../reflect/internal/settings/MutableSettings.scala.html#scala.reflect.internal.settings;MutableSettings;SettingValue.value_=" title="(arg: settings.script.T)Unit">value</a> = <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.mainClass" title="=&gt; String">mainClass</a>
        val <a title="scala.tools.nsc.reporters.ConsoleReporter" id="scala.tools.nsc;ScriptRunner.withCompiledScript.compile.reporter">reporter</a> = new <a href="reporters/ConsoleReporter.scala.html#scala.tools.nsc.reporters;ConsoleReporter" title="scala.tools.nsc.reporters.ConsoleReporter">ConsoleReporter</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a><span class="delimiter">)</span>
        val <a title="scala.tools.nsc.Global" id="scala.tools.nsc;ScriptRunner.withCompiledScript.compile.compiler">compiler</a> = <a href="#scala.tools.nsc;ScriptRunner.newGlobal" title="(settings: scala.tools.nsc.Settings, reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global">newGlobal</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>, <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.compile.reporter" title="scala.tools.nsc.reporters.ConsoleReporter">reporter</a><span class="delimiter">)</span>

        new <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.compile.compiler" title="scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#scala.tools.nsc;Global;Run" title="compiler.Run">Run</a> <a href="Global.scala.html#scala.tools.nsc;Global;Run.compile" title="(filenames: List[String])Unit">compile</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable.List.apply" title="(xs: String*)List[String]">List</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.scriptFile" title="String">scriptFile</a><span class="delimiter">)</span>
        if <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.compile.reporter" title="scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/Reporter.scala.html#scala.tools.nsc.reporters;Reporter.hasErrors" title="=&gt; Boolean">hasErrors</a><span class="delimiter">)</span> <a href="../../Option.scala.html#scala.None" title="None.type">None</a> else <a href="../../Option.scala.html#scala;Some" title="(x: scala.reflect.io.Directory)Some[scala.reflect.io.Directory]">Some</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.compile.compiledPath" title="scala.reflect.io.Directory">compiledPath</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      else if <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.compileWithDaemon" title="(settings: scala.tools.nsc.GenericRunnerSettings, scriptFileIn: String)Boolean">compileWithDaemon</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>, <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.scriptFile" title="String">scriptFile</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Option.scala.html#scala;Some" title="(x: scala.reflect.io.Directory)Some[scala.reflect.io.Directory]">Some</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.compile.compiledPath" title="scala.reflect.io.Directory">compiledPath</a><span class="delimiter">)</span>
      else <a href="../../Option.scala.html#scala.None" title="None.type">None</a>
    <span class="delimiter">}</span>

    def <a title="(d: scala.tools.nsc.io.Directory)Boolean" id="scala.tools.nsc;ScriptRunner.withCompiledScript.hasClassToRun">hasClassToRun</a><span class="delimiter">(</span><a title="scala.tools.nsc.io.Directory" id="scala.tools.nsc;ScriptRunner.withCompiledScript.hasClassToRun.d">d</a>: <a href="../../reflect/io/Directory.scala.html#scala.reflect.io;Directory" title="scala.tools.nsc.io.Directory">Directory</a><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
      import util.<a href="util/ClassPath.scala.html#scala.tools.nsc.util.ClassPath" title="scala.tools.nsc.util.ClassPath.type">ClassPath</a>.<span class="delimiter">{</span> DefaultJavaContext =&gt; ctx <span class="delimiter">}</span>
      val <a title="scala.tools.nsc.util.DirectoryClassPath" id="scala.tools.nsc;ScriptRunner.withCompiledScript.hasClassToRun.cp">cp</a> = <a href="util/ClassPath.scala.html#scala.tools.nsc.util.ClassPath.DefaultJavaContext" title="scala.tools.nsc.util.ClassPath.DefaultJavaContext.type">ctx</a>.<a href="util/ClassPath.scala.html#scala.tools.nsc.util.ClassPath;JavaContext.newClassPath" title="(dir: scala.tools.nsc.io.AbstractFile)scala.tools.nsc.util.DirectoryClassPath">newClassPath</a><span class="delimiter">(</span><a href="io/package.scala.html#scala.tools.nsc.io.package.AbstractFile" title="=&gt; reflect.io.AbstractFile.type">AbstractFile</a>.<a href="../../reflect/io/AbstractFile.scala.html#scala.reflect.io.AbstractFile.getDirectory(0d7ce10967)" title="(path: scala.reflect.io.Path)scala.reflect.io.AbstractFile">getDirectory</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.hasClassToRun.d" title="scala.tools.nsc.io.Directory">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.hasClassToRun.cp" title="scala.tools.nsc.util.DirectoryClassPath">cp</a>.<a href="util/ClassPath.scala.html#scala.tools.nsc.util;ClassPath.findClass" title="(name: String)Option[cp.AnyClassRep]">findClass</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.mainClass" title="=&gt; String">mainClass</a><span class="delimiter">)</span>.<a href="../../Option.scala.html#scala;Option.isDefined" title="=&gt; Boolean">isDefined</a>
    <span class="delimiter">}</span>

    <span class="comment">/* The script runner calls sys.exit to communicate a return value, but this must
     * not take place until there are no non-daemon threads running.  Tickets #1955, #2006.
     */</span>
    util.<a href="util/package.scala.html#scala.tools.nsc.util.package.waitingForThreads" title="(body: =&gt; Boolean)Boolean">waitingForThreads</a> <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a href="../../reflect/internal/settings/MutableSettings.scala.html#scala.reflect.internal.settings.MutableSettings.reflectSettingToBoolean" title="implicit scala.reflect.internal.settings.MutableSettings.reflectSettingToBoolean : (s: scala.reflect.internal.settings.MutableSettings#BooleanSetting)Boolean">save</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        val <a title="scala.reflect.io.File" id="scala.tools.nsc;ScriptRunner.withCompiledScript.jarFile">jarFile</a> = <a href="#scala.tools.nsc;ScriptRunner.jarFileFor" title="(scriptFile: String)scala.reflect.io.File">jarFileFor</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.scriptFile" title="String">scriptFile</a><span class="delimiter">)</span>
        def <a title="=&gt; Boolean" id="scala.tools.nsc;ScriptRunner.withCompiledScript.jarOK">jarOK</a>   = <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.jarFile" title="scala.reflect.io.File">jarFile</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.canRead" title="=&gt; Boolean">canRead</a> <a href="../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.jarFile" title="scala.reflect.io.File">jarFile</a> <a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.isFresher" title="(other: scala.reflect.io.Path)Boolean">isFresher</a> <a href="../../reflect/io/File.scala.html#scala.reflect.io.File.apply" title="(path: scala.reflect.io.Path)(implicit codec: scala.io.Codec)scala.reflect.io.File">File</a><a href="../../io/Codec.scala.html#scala.io;LowPriorityCodecImplicits.fallbackSystemCodec" title="=&gt; scala.io.Codec" class="delimiter">(</a><a href="../../reflect/io/Path.scala.html#scala.reflect.io.Path.string2path" title="implicit scala.reflect.io.Path.string2path : (s: String)scala.reflect.io.Path">scriptFile</a><span class="delimiter">)</span><span class="delimiter">)</span>

        def <a title="()Boolean" id="scala.tools.nsc;ScriptRunner.withCompiledScript.recompile">recompile</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
          <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.jarFile" title="scala.reflect.io.File">jarFile</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.delete" title="()Boolean">delete</a><span class="delimiter">(</span><span class="delimiter">)</span>

          <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.compile" title="=&gt; Option[scala.tools.nsc.io.Directory]">compile</a> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><a title="scala.tools.nsc.io.Directory" id="scala.tools.nsc;ScriptRunner.withCompiledScript.recompile.compiledPath">compiledPath</a><span class="delimiter">)</span> =&gt;
              if <span class="delimiter">(</span><a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.hasClassToRun" title="(d: scala.tools.nsc.io.Directory)Boolean">hasClassToRun</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.recompile.compiledPath" title="scala.tools.nsc.io.Directory">compiledPath</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="comment">// it compiled ok, but there is nothing to run;</span>
                <span class="comment">// running an empty script should succeed</span>
                true
              <span class="delimiter">}</span> else <span class="delimiter">{</span>
                try io.<a href="io/Jar.scala.html#scala.tools.nsc.io.Jar" title="scala.tools.nsc.io.Jar.type">Jar</a>.<a href="io/Jar.scala.html#scala.tools.nsc.io.Jar.create" title="(file: scala.tools.nsc.io.File, sourceDir: scala.tools.nsc.io.Directory, mainClass: String)Unit">create</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.jarFile" title="scala.reflect.io.File">jarFile</a>, <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.recompile.compiledPath" title="scala.tools.nsc.io.Directory">compiledPath</a>, <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.mainClass" title="=&gt; String">mainClass</a><span class="delimiter">)</span>
                catch <span class="delimiter">{</span> case _: <span title="Exception">Exception</span> =&gt; <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.jarFile" title="scala.reflect.io.File">jarFile</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.delete" title="()Boolean">delete</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">}</span>

                if <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.jarOK" title="=&gt; Boolean">jarOK</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.recompile.compiledPath" title="scala.tools.nsc.io.Directory">compiledPath</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.deleteRecursively(f32ef3bcdd)" title="()Boolean">deleteRecursively</a><span class="delimiter">(</span><span class="delimiter">)</span>
                  <a href="../../Function1.scala.html#scala;Function1.apply" title="(v1: String)Boolean">handler</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.jarFile" title="scala.reflect.io.File">jarFile</a>.<a href="../../reflect/io/File.scala.html#scala.reflect.io;File.toAbsolute" title="=&gt; scala.reflect.io.File">toAbsolute</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.path" title="=&gt; String">path</a><span class="delimiter">)</span>
                <span class="delimiter">}</span>
                <span class="comment">// jar failed; run directly from the class files</span>
                else <a href="../../Function1.scala.html#scala;Function1.apply" title="(v1: String)Boolean">handler</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.recompile.compiledPath" title="scala.tools.nsc.io.Directory">compiledPath</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.path" title="=&gt; String">path</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            case _  =&gt; false
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        if <span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.jarOK" title="=&gt; Boolean">jarOK</a><span class="delimiter">)</span> <a href="../../Function1.scala.html#scala;Function1.apply" title="(v1: String)Boolean">handler</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.jarFile" title="scala.reflect.io.File">jarFile</a>.<a href="../../reflect/io/File.scala.html#scala.reflect.io;File.toAbsolute" title="=&gt; scala.reflect.io.File">toAbsolute</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.path" title="=&gt; String">path</a><span class="delimiter">)</span> <span class="comment">// pre-compiled jar is current</span>
        else <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.recompile" title="()Boolean">recompile</a><span class="delimiter">(</span><span class="delimiter">)</span>                            <span class="comment">// jar old - recompile the script.</span>
      <span class="delimiter">}</span>
      <span class="comment">// don't use a cache jar at all--just use the class files, if they exist</span>
      else <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.compile" title="=&gt; Option[scala.tools.nsc.io.Directory]">compile</a> <a href="../../Option.scala.html#scala;Option.exists" title="(p: scala.tools.nsc.io.Directory =&gt; Boolean)Boolean">exists</a> <span class="delimiter">(</span><a title="scala.tools.nsc.io.Directory" id="scala.tools.nsc;ScriptRunner.withCompiledScript.$anonfun.cp">cp</a> =&gt; <a href="../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.hasClassToRun" title="(d: scala.tools.nsc.io.Directory)Boolean">hasClassToRun</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.$anonfun.cp" title="scala.tools.nsc.io.Directory">cp</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#scala;Boolean.||" title="(x: Boolean)Boolean">||</a> <a href="../../Function1.scala.html#scala;Function1.apply" title="(v1: String)Boolean">handler</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.withCompiledScript.$anonfun.cp" title="scala.tools.nsc.io.Directory">cp</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.path" title="=&gt; String">path</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Run a script after it has been compiled
   *
   * @return true if execution succeeded, false otherwise
   */</span>
  private def <a title="(settings: scala.tools.nsc.GenericRunnerSettings, compiledLocation: String, scriptArgs: List[String])Boolean" id="scala.tools.nsc;ScriptRunner.runCompiled">runCompiled</a><span class="delimiter">(</span>
    <a title="scala.tools.nsc.GenericRunnerSettings" id="scala.tools.nsc;ScriptRunner.runCompiled.settings">settings</a>: <a href="GenericRunnerSettings.scala.html#scala.tools.nsc;GenericRunnerSettings" title="scala.tools.nsc.GenericRunnerSettings">GenericRunnerSettings</a>,
    <a title="String" id="scala.tools.nsc;ScriptRunner.runCompiled.compiledLocation">compiledLocation</a>: <span title="String">String</span>,
    <a title="List[String]" id="scala.tools.nsc;ScriptRunner.runCompiled.scriptArgs">scriptArgs</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[String]">List</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> =
  <span class="delimiter">{</span>
    val cp = <a href="../../reflect/io/File.scala.html#scala.reflect.io.File.apply" title="(path: scala.reflect.io.Path)(implicit codec: scala.io.Codec)scala.reflect.io.File">File</a><a href="../../io/Codec.scala.html#scala.io;LowPriorityCodecImplicits.fallbackSystemCodec" title="=&gt; scala.io.Codec" class="delimiter">(</a><a href="../../reflect/io/Path.scala.html#scala.reflect.io.Path.string2path" title="implicit scala.reflect.io.Path.string2path : (s: String)scala.reflect.io.Path">compiledLocation</a><span class="delimiter">)</span>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.toURL" title="=&gt; java.net.URL">toURL</a> <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List.+:" title="List[java.net.URL]" id="scala.tools.nsc;ScriptRunner.runCompiled.cp">+:</a> <a href="#scala.tools.nsc;ScriptRunner.runCompiled.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a href="GenericRunnerSettings.scala.html#scala.tools.nsc;GenericRunnerSettings.classpathURLs" title="=&gt; List[java.net.URL]">classpathURLs</a>
    <a href="ObjectRunner.scala.html#scala.tools.nsc.ObjectRunner" title="scala.tools.nsc.ObjectRunner.type">ObjectRunner</a>.<a href="ObjectRunner.scala.html#scala.tools.nsc;CommonRunner.runAndCatch" title="(urls: List[java.net.URL], objectName: String, arguments: Seq[String])Either[Throwable,Boolean]">runAndCatch</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.runCompiled.cp" title="List[java.net.URL]">cp</a>, <a href="#scala.tools.nsc;ScriptRunner.scriptMain" title="(settings: scala.tools.nsc.Settings)String">scriptMain</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.runCompiled.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a><span class="delimiter">)</span>, <a href="#scala.tools.nsc;ScriptRunner.runCompiled.scriptArgs" title="List[String]">scriptArgs</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
      case Left<span class="delimiter">(</span><a title="Throwable" id="scala.tools.nsc;ScriptRunner.runCompiled.ex">ex</a><span class="delimiter">)</span> =&gt; <a href="#scala.tools.nsc;ScriptRunner.runCompiled.ex" title="Throwable">ex</a>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span> ; false
      case _        =&gt; true
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Run a script file with the specified arguments and compilation
   *  settings.
   *
   * @return true if compilation and execution succeeded, false otherwise.
   */</span>
  def <a title="(settings: scala.tools.nsc.GenericRunnerSettings, scriptFile: String, scriptArgs: List[String])Boolean" id="scala.tools.nsc;ScriptRunner.runScript">runScript</a><span class="delimiter">(</span>
    <a title="scala.tools.nsc.GenericRunnerSettings" id="scala.tools.nsc;ScriptRunner.runScript.settings">settings</a>: <a href="GenericRunnerSettings.scala.html#scala.tools.nsc;GenericRunnerSettings" title="scala.tools.nsc.GenericRunnerSettings">GenericRunnerSettings</a>,
    <a title="String" id="scala.tools.nsc;ScriptRunner.runScript.scriptFile">scriptFile</a>: <span title="String">String</span>,
    <a title="List[String]" id="scala.tools.nsc;ScriptRunner.runScript.scriptArgs">scriptArgs</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[String]">List</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> =
  <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="../../reflect/io/File.scala.html#scala.reflect.io.File.apply" title="(path: scala.reflect.io.Path)(implicit codec: scala.io.Codec)scala.reflect.io.File">File</a><a href="../../io/Codec.scala.html#scala.io;LowPriorityCodecImplicits.fallbackSystemCodec" title="=&gt; scala.io.Codec" class="delimiter">(</a><a href="../../reflect/io/Path.scala.html#scala.reflect.io.Path.string2path" title="implicit scala.reflect.io.Path.string2path : (s: String)scala.reflect.io.Path">scriptFile</a><span class="delimiter">)</span>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.isFile" title="=&gt; Boolean">isFile</a><span class="delimiter">)</span>
      <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript" title="(settings: scala.tools.nsc.GenericRunnerSettings, scriptFile: String)(handler: String =&gt; Boolean)Boolean">withCompiledScript</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.runScript.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>, <a href="#scala.tools.nsc;ScriptRunner.runScript.scriptFile" title="String">scriptFile</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#scala.tools.nsc;ScriptRunner.runCompiled" title="(settings: scala.tools.nsc.GenericRunnerSettings, compiledLocation: String, scriptArgs: List[String])Boolean">runCompiled</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.runScript.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>, <a href="#scala.tools.nsc;ScriptRunner.runScript.$anonfun.x$5" title="String">_</a>, <a href="#scala.tools.nsc;ScriptRunner.runScript.scriptArgs" title="List[String]">scriptArgs</a><span class="delimiter">)</span> <span class="delimiter">}</span>
    else
      throw new <span title="java.io.IOException">IOException</span><span class="delimiter">(</span><span title="String(&quot;no such file: &quot;)" class="string">&quot;no such file: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#scala.tools.nsc;ScriptRunner.runScript.scriptFile" title="String">scriptFile</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Calls runScript and catches the enumerated exceptions, routing
   *  them to Left(ex) if thrown.
   */</span>
  def <a title="(settings: scala.tools.nsc.GenericRunnerSettings, scriptFile: String, scriptArgs: List[String])Either[Throwable,Boolean]" id="scala.tools.nsc;ScriptRunner.runScriptAndCatch">runScriptAndCatch</a><span class="delimiter">(</span>
    <a title="scala.tools.nsc.GenericRunnerSettings" id="scala.tools.nsc;ScriptRunner.runScriptAndCatch.settings">settings</a>: <a href="GenericRunnerSettings.scala.html#scala.tools.nsc;GenericRunnerSettings" title="scala.tools.nsc.GenericRunnerSettings">GenericRunnerSettings</a>,
    <a title="String" id="scala.tools.nsc;ScriptRunner.runScriptAndCatch.scriptFile">scriptFile</a>: <span title="String">String</span>,
    <a title="List[String]" id="scala.tools.nsc;ScriptRunner.runScriptAndCatch.scriptArgs">scriptArgs</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[String]">List</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../util/Either.scala.html#scala.util;Either" title="Either[Throwable,Boolean]">Either</a><span class="delimiter">[</span>Throwable, Boolean<span class="delimiter">]</span> =
  <span class="delimiter">{</span>
    try <a href="../../util/Either.scala.html#scala.util;Right" title="(b: Boolean)scala.util.Right[Nothing,Boolean]">Right</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.runScript" title="(settings: scala.tools.nsc.GenericRunnerSettings, scriptFile: String, scriptArgs: List[String])Boolean">runScript</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.runScriptAndCatch.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>, <a href="#scala.tools.nsc;ScriptRunner.runScriptAndCatch.scriptFile" title="String">scriptFile</a>, <a href="#scala.tools.nsc;ScriptRunner.runScriptAndCatch.scriptArgs" title="List[String]">scriptArgs</a><span class="delimiter">)</span><span class="delimiter">)</span>
    catch <span class="delimiter">{</span> case <a title="Throwable" id="scala.tools.nsc;ScriptRunner.runScriptAndCatch.e">e</a>: <span title="Throwable">Throwable</span> =&gt; <a href="../../util/Either.scala.html#scala.util;Left" title="(a: Throwable)scala.util.Left[Throwable,Nothing]">Left</a><span class="delimiter">(</span><a href="util/Exceptional.scala.html#scala.tools.nsc.util.Exceptional.unwrap" title="(x: Throwable)Throwable">unwrap</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.runScriptAndCatch.e" title="Throwable">e</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Run a command
   *
   * @return true if compilation and execution succeeded, false otherwise.
   */</span>
  def <a title="(settings: scala.tools.nsc.GenericRunnerSettings, command: String, scriptArgs: List[String])Boolean" id="scala.tools.nsc;ScriptRunner.runCommand">runCommand</a><span class="delimiter">(</span>
    <a title="scala.tools.nsc.GenericRunnerSettings" id="scala.tools.nsc;ScriptRunner.runCommand.settings">settings</a>: <a href="GenericRunnerSettings.scala.html#scala.tools.nsc;GenericRunnerSettings" title="scala.tools.nsc.GenericRunnerSettings">GenericRunnerSettings</a>,
    <a title="String" id="scala.tools.nsc;ScriptRunner.runCommand.command">command</a>: <span title="String">String</span>,
    <a title="List[String]" id="scala.tools.nsc;ScriptRunner.runCommand.scriptArgs">scriptArgs</a>: <a href="../../collection/immutable/List.scala.html#scala.collection.immutable;List" title="List[String]">List</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> =
  <span class="delimiter">{</span>
    val <a title="scala.reflect.io.File" id="scala.tools.nsc;ScriptRunner.runCommand.scriptFile">scriptFile</a> = <a href="io/package.scala.html#scala.tools.nsc.io.package.File" title="=&gt; reflect.io.File.type">File</a>.<a href="../../reflect/io/File.scala.html#scala.reflect.io.File.makeTemp" title="(prefix: String, suffix: String, dir: java.io.File)scala.reflect.io.File">makeTemp</a><span class="delimiter">(</span><span title="String(&quot;scalacmd&quot;)" class="string">&quot;scalacmd&quot;</span>, <span title="String(&quot;.scala&quot;)" class="string">&quot;.scala&quot;</span><span class="delimiter">)</span>
    <span class="comment">// save the command to the file</span>
    <a href="#scala.tools.nsc;ScriptRunner.runCommand.scriptFile" title="scala.reflect.io.File">scriptFile</a> <a href="../../reflect/io/File.scala.html#scala.reflect.io;File.writeAll" title="(strings: String*)Unit">writeAll</a> <a href="#scala.tools.nsc;ScriptRunner.runCommand.command" title="String">command</a>

    try <a href="#scala.tools.nsc;ScriptRunner.withCompiledScript" title="(settings: scala.tools.nsc.GenericRunnerSettings, scriptFile: String)(handler: String =&gt; Boolean)Boolean">withCompiledScript</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.runCommand.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>, <a href="#scala.tools.nsc;ScriptRunner.runCommand.scriptFile" title="scala.reflect.io.File">scriptFile</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.path" title="=&gt; String">path</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#scala.tools.nsc;ScriptRunner.runCompiled" title="(settings: scala.tools.nsc.GenericRunnerSettings, compiledLocation: String, scriptArgs: List[String])Boolean">runCompiled</a><span class="delimiter">(</span><a href="#scala.tools.nsc;ScriptRunner.runCommand.settings" title="scala.tools.nsc.GenericRunnerSettings">settings</a>, <a href="#scala.tools.nsc;ScriptRunner.runCommand.$anonfun.x$6" title="String">_</a>, <a href="#scala.tools.nsc;ScriptRunner.runCommand.scriptArgs" title="List[String]">scriptArgs</a><span class="delimiter">)</span> <span class="delimiter">}</span>
    finally <a href="#scala.tools.nsc;ScriptRunner.runCommand.scriptFile" title="scala.reflect.io.File">scriptFile</a>.<a href="../../reflect/io/Path.scala.html#scala.reflect.io;Path.delete" title="()Boolean">delete</a><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>  <span class="comment">// in case there was a compilation error</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

object <a title="scala.tools.nsc.ScriptRunner.type" id="scala.tools.nsc.ScriptRunner">ScriptRunner</a> extends <a href="#scala.tools.nsc;ScriptRunner" title="scala.tools.nsc.ScriptRunner">ScriptRunner</a> <span class="delimiter">{</span> <span class="delimiter">}</span>

        </pre>
    </body>
</html>

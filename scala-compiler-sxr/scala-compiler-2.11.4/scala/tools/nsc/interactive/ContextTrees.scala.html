<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scala/tools/nsc/interactive/ContextTrees.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2009-2013 Typesafe/Scala Solutions and LAMP/EPFL
 * @author Martin Odersky
 */</span>
package scala.tools.nsc
package interactive

import scala.collection.mutable.ArrayBuffer
import scala.annotation.tailrec

trait <a title="trait ContextTrees extends AnyRef" id="scala.tools.nsc.interactive;ContextTrees">ContextTrees</a> <a href="../../../Unit.scala.html#scala;Unit" title="Unit" class="delimiter">{</a> self: Global =&gt;

  type <a title="ContextTrees.this.analyzer.Context" id="scala.tools.nsc.interactive;ContextTrees;Context">Context</a> = analyzer.<a href="../typechecker/Contexts.scala.html#scala.tools.nsc.typechecker;Contexts;Context" title="ContextTrees.this.analyzer.Context">Context</a>
  lazy val <a title="ContextTrees.this.analyzer.NoContext.type" id="scala.tools.nsc.interactive;ContextTrees.NoContext">NoContext</a> = <a href="Global.scala.html#scala.tools.nsc.interactive;Global.analyzer" title="=&gt; scala.tools.nsc.interactive.InteractiveAnalyzer{val global: ContextTrees.this.type}">analyzer</a>.<a href="../typechecker/Contexts.scala.html#scala.tools.nsc.typechecker;Contexts.NoContext" title="ContextTrees.this.analyzer.NoContext.type">NoContext</a>
  type <a title="scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]" id="scala.tools.nsc.interactive;ContextTrees;Contexts">Contexts</a> = <a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer" title="scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]">ArrayBuffer</a><span class="delimiter">[</span>ContextTree<span class="delimiter">]</span>

  <span class="comment">/** A context tree contains contexts that are indexed by positions.
   *  It satisfies the following properties:
   *  1. All context come from compiling the same unit.
   *  2. Child contexts have parent contexts in their outer chain.
   *  3. The `pos` field of a context is the same as `context.tree.pos`, unless that
   *     position is transparent. In that case, `pos` equals the position of
   *     one of the solid descendants of `context.tree`.
   *  4. Children of a context have non-overlapping increasing positions.
   *  5. No context in the tree has a transparent position.
   */</span>
  class <a title="class ContextTree extends AnyRef" id="scala.tools.nsc.interactive;ContextTrees;ContextTree">ContextTree</a><a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree" title="ContextTrees.this.ContextTree" class="delimiter">(</a>val <a title="ContextTrees.this.Position" id="scala.tools.nsc.interactive;ContextTrees;ContextTree.pos">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;Position" title="ContextTrees.this.Position">Position</a>, val <a title="ContextTrees.this.Context" id="scala.tools.nsc.interactive;ContextTrees;ContextTree.context">context</a>: <a href="../typechecker/Contexts.scala.html#scala.tools.nsc.typechecker;Contexts;Context" title="ContextTrees.this.Context">Context</a>, val <a title="scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]" id="scala.tools.nsc.interactive;ContextTrees;ContextTree.children">children</a>: <a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer" title="scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]">ArrayBuffer</a><span class="delimiter">[</span>ContextTree<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    def this<span class="delimiter">(</span><a title="ContextTrees.this.Position" id="scala.tools.nsc.interactive;ContextTrees;ContextTree.<init>(63cc63021f).pos">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;Position" title="ContextTrees.this.Position">Position</a>, <a title="ContextTrees.this.Context" id="scala.tools.nsc.interactive;ContextTrees;ContextTree.<init>(63cc63021f).context">context</a>: <a href="../typechecker/Contexts.scala.html#scala.tools.nsc.typechecker;Contexts;Context" title="ContextTrees.this.Context">Context</a><span class="delimiter">)</span> = this<span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.<init>(63cc63021f).pos" title="ContextTrees.this.Position">pos</a>, <a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.<init>(63cc63021f).context" title="ContextTrees.this.Context">context</a>, new <a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer" title="scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]">ArrayBuffer</a><span class="delimiter">[</span>ContextTree<span class="delimiter">]</span><span class="delimiter">)</span>
    override def <a title="()String" id="scala.tools.nsc.interactive;ContextTrees;ContextTree.toString">toString</a> = <span title="String(&quot;ContextTree(&quot;)" class="string">&quot;ContextTree(&quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a><span title="(x$1: Any)String">+</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.children" title="=&gt; scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]">children</a><span title="(x$1: Any)String">+</span><span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Returns the most precise context possible for the given `pos`.
   *
   *  It looks for the finest ContextTree containing `pos`, and then look inside
   *  this ContextTree for a child ContextTree located immediately before `pos`.
   *  If such a child exists, returns its context, otherwise returns the context of
   *  the parent ContextTree.
   *
   *  This is required to always return a context which contains the all the imports
   *  declared up to `pos` (see SI-7280 for a test case).
   *
   *  Can return None if `pos` is before any valid Scala code.
   */</span>
  def <a title="(contexts: ContextTrees.this.Contexts, pos: ContextTrees.this.Position)Option[ContextTrees.this.Context]" id="scala.tools.nsc.interactive;ContextTrees.locateContext">locateContext</a><span class="delimiter">(</span><a title="ContextTrees.this.Contexts" id="scala.tools.nsc.interactive;ContextTrees.locateContext.contexts">contexts</a>: <a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer" title="ContextTrees.this.Contexts">Contexts</a>, <a title="ContextTrees.this.Position" id="scala.tools.nsc.interactive;ContextTrees.locateContext.pos">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;Position" title="ContextTrees.this.Position">Position</a><span class="delimiter">)</span>: <a href="../../../Option.scala.html#scala;Option" title="Option[ContextTrees.this.Context]">Option</a><span class="delimiter">[</span>Context<span class="delimiter">]</span> = <a href="#scala.tools.nsc.interactive;ContextTrees" title="(x$1: Option[ContextTrees.this.Context])Option[ContextTrees.this.Context]">synchronized</a> <span class="delimiter">{</span>
    @tailrec
    def <a title="(context: ContextTrees.this.ContextTree)ContextTrees.this.ContextTree" id="scala.tools.nsc.interactive;ContextTrees.locateContext.locateFinestContextTree">locateFinestContextTree</a><span class="delimiter">(</span><a title="ContextTrees.this.ContextTree" id="scala.tools.nsc.interactive;ContextTrees.locateContext.locateFinestContextTree.context">context</a>: <a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree" title="ContextTrees.this.ContextTree">ContextTree</a><span class="delimiter">)</span>: <a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree" title="ContextTrees.this.ContextTree">ContextTree</a> = <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.locateFinestContextTree.context" title="ContextTrees.this.ContextTree">context</a>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.includes" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.pos" title="ContextTrees.this.Position">pos</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree" title="(contexts: ContextTrees.this.Contexts, pos: ContextTrees.this.Position)Option[ContextTrees.this.ContextTree]">locateContextTree</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.locateFinestContextTree.context" title="ContextTrees.this.ContextTree">context</a>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.children" title="=&gt; scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]">children</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.pos" title="ContextTrees.this.Position">pos</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
          case Some<span class="delimiter">(</span><a title="ContextTrees.this.ContextTree" id="scala.tools.nsc.interactive;ContextTrees.locateContext.locateFinestContextTree.x">x</a><span class="delimiter">)</span> =&gt;
            <a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.locateFinestContextTree" title="(context: ContextTrees.this.ContextTree)ContextTrees.this.ContextTree">locateFinestContextTree</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.locateFinestContextTree.x" title="ContextTrees.this.ContextTree">x</a><span class="delimiter">)</span>
          case <a href="../../../Option.scala.html#scala.None" title="None.type">None</a> =&gt;
            <a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.locateFinestContextTree.context" title="ContextTrees.this.ContextTree">context</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> else <span class="delimiter">{</span>
        <a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.locateFinestContextTree.context" title="ContextTrees.this.ContextTree">context</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree" title="(contexts: ContextTrees.this.Contexts, pos: ContextTrees.this.Position)Option[ContextTrees.this.ContextTree]">locateContextTree</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.contexts" title="ContextTrees.this.Contexts">contexts</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.pos" title="ContextTrees.this.Position">pos</a><span class="delimiter">)</span> <a href="../../../Option.scala.html#scala;Option.map" title="(f: ContextTrees.this.ContextTree =&gt; ContextTrees.this.ContextTree)Option[ContextTrees.this.ContextTree]">map</a> <a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.locateFinestContextTree" title="(context: ContextTrees.this.ContextTree)ContextTrees.this.ContextTree">locateFinestContextTree</a> <a href="../../../Option.scala.html#scala;Option.map" title="(f: ContextTrees.this.ContextTree =&gt; ContextTrees.this.Context)Option[ContextTrees.this.Context]">map</a> <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContext.$anonfun.x$1" title="ContextTrees.this.ContextTree">_</a>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.context" title="=&gt; ContextTrees.this.Context">context</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Returns the ContextTree containing `pos`, or the ContextTree positioned just before `pos`,
   *  or None if `pos` is located before all ContextTrees.
   */</span> 
  def <a title="(contexts: ContextTrees.this.Contexts, pos: ContextTrees.this.Position)Option[ContextTrees.this.ContextTree]" id="scala.tools.nsc.interactive;ContextTrees.locateContextTree">locateContextTree</a><span class="delimiter">(</span><a title="ContextTrees.this.Contexts" id="scala.tools.nsc.interactive;ContextTrees.locateContextTree.contexts">contexts</a>: <a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer" title="ContextTrees.this.Contexts">Contexts</a>, <a title="ContextTrees.this.Position" id="scala.tools.nsc.interactive;ContextTrees.locateContextTree.pos">pos</a>: <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;Position" title="ContextTrees.this.Position">Position</a><span class="delimiter">)</span>: <a href="../../../Option.scala.html#scala;Option" title="Option[ContextTrees.this.ContextTree]">Option</a><span class="delimiter">[</span>ContextTree<span class="delimiter">]</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/IndexedSeqOptimized.scala.html#scala.collection;IndexedSeqOptimized.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../Option.scala.html#scala.None" title="None.type">None</a>
    else <span class="delimiter">{</span>
      <span class="comment">// binary search on contexts, loop invar: lo &lt;= hi, recursion metric: `hi - lo`</span>
      @tailrec
      def <a title="(lo: Int, hi: Int, previousSibling: Option[ContextTrees.this.ContextTree])Option[ContextTrees.this.ContextTree]" id="scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop">loop</a><span class="delimiter">(</span><a title="Int" id="scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.lo">lo</a>: <a href="../../../Int.scala.html#scala;Int" title="Int">Int</a>, <a title="Int" id="scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.hi">hi</a>: <a href="../../../Int.scala.html#scala;Int" title="Int">Int</a>, <a title="Option[ContextTrees.this.ContextTree]" id="scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.previousSibling">previousSibling</a>: <a href="../../../Option.scala.html#scala;Option" title="Option[ContextTrees.this.ContextTree]">Option</a><span class="delimiter">[</span>ContextTree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../Option.scala.html#scala;Option" title="Option[ContextTrees.this.ContextTree]">Option</a><span class="delimiter">[</span>ContextTree<span class="delimiter">]</span> = <span class="delimiter">{</span>
        <span class="comment">// [SI-8239] enforce loop invariant &amp; ensure recursion metric decreases monotonically on every recursion</span>
        if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.lo" title="Int">lo</a> <a href="../../../Int.scala.html#scala;Int.>(5f58a84eb3)" title="(x: Int)Boolean">&gt;</a> <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.hi" title="Int">hi</a><span class="delimiter">)</span> <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.previousSibling" title="Option[ContextTrees.this.ContextTree]">previousSibling</a>
        else if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.pos" title="ContextTrees.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.properlyPrecedes" title="(pos: scala.reflect.internal.util.Position)Boolean">properlyPrecedes</a> <a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.lo" title="Int">lo</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a><span class="delimiter">)</span>
          <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.previousSibling" title="Option[ContextTrees.this.ContextTree]">previousSibling</a>
        else if <span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.hi" title="Int">hi</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.properlyPrecedes" title="(pos: scala.reflect.internal.util.Position)Boolean">properlyPrecedes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.pos" title="ContextTrees.this.Position">pos</a><span class="delimiter">)</span>
          <a href="../../../Option.scala.html#scala;Some" title="(x: ContextTrees.this.ContextTree)Some[ContextTrees.this.ContextTree]">Some</a><span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.hi" title="Int">hi</a><span class="delimiter">)</span><span class="delimiter">)</span>
        else <span class="delimiter">{</span>
          val mid = <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.lo" title="Int">lo</a> <a href="../../../Int.scala.html#scala;Int.+(1409840560)" title="(x: Int)Int">+</a> <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.hi" title="Int">hi</a><span class="delimiter">)</span> <a href="../../../Int.scala.html#scala;Int./(1409840560)" title="Int" id="scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.mid">/</a> <span title="Int(2)" class="int">2</span>
          val <a title="ContextTrees.this.Position" id="scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.midpos">midpos</a> = <a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.mid" title="Int">mid</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a>
          if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.midpos" title="ContextTrees.this.Position">midpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.includes" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.pos" title="ContextTrees.this.Position">pos</a><span class="delimiter">)</span>
            <a href="../../../Option.scala.html#scala;Some" title="(x: ContextTrees.this.ContextTree)Some[ContextTrees.this.ContextTree]">Some</a><span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.mid" title="Int">mid</a><span class="delimiter">)</span><span class="delimiter">)</span>
          else if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.midpos" title="ContextTrees.this.Position">midpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.properlyPrecedes" title="(pos: scala.reflect.internal.util.Position)Boolean">properlyPrecedes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.pos" title="ContextTrees.this.Position">pos</a><span class="delimiter">)</span>
            <span class="comment">// recursion metric: (hi - ((lo + hi)/2 + 1)) &lt; (hi - lo)</span>
            <span class="comment">// since (hi - ((lo + hi)/2 + 1)) - (hi - lo) = lo - ((lo + hi)/2 + 1) &lt; 0</span>
            <span class="comment">// since 2*lo - lo - hi - 2 = lo - hi - 2 &lt; 0</span>
            <span class="comment">// since lo &lt; hi + 2</span>
            <span class="comment">// can violate lo &lt;= hi, hence the lo &gt; hi check at the top [SI-8239]</span>
            <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop" title="(lo: Int, hi: Int, previousSibling: Option[ContextTrees.this.ContextTree])Option[ContextTrees.this.ContextTree]">loop</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.mid" title="Int">mid</a> <a href="../../../Int.scala.html#scala;Int.+(1409840560)" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>, <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.hi" title="Int">hi</a>, <a href="../../../Option.scala.html#scala;Some" title="(x: ContextTrees.this.ContextTree)Some[ContextTrees.this.ContextTree]">Some</a><span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.mid" title="Int">mid</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          else if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.lo" title="Int">lo</a> <a href="../../../Int.scala.html#scala;Int.!=(5f58a84eb3)" title="(x: Int)Boolean">!=</a> <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.hi" title="Int">hi</a><span class="delimiter">)</span> <span class="comment">// avoid looping forever (lo == hi violates the recursion metric) [SI-8239]</span>
            <span class="comment">// recursion metric: ((lo + hi)/2) - lo &lt; (hi - lo)</span>
            <span class="comment">// since ((lo + hi)/2) - lo - (hi - lo) = ((lo + hi)/2) - hi &lt; 0</span>
            <span class="comment">// since 2 * (((lo + hi)/2) - hi) = lo - hi &lt; 0 since lo &lt; hi</span>
            <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop" title="(lo: Int, hi: Int, previousSibling: Option[ContextTrees.this.ContextTree])Option[ContextTrees.this.ContextTree]">loop</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.lo" title="Int">lo</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.mid" title="Int">mid</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.previousSibling" title="Option[ContextTrees.this.ContextTree]">previousSibling</a><span class="delimiter">)</span>
          else <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop.previousSibling" title="Option[ContextTrees.this.ContextTree]">previousSibling</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.loop" title="(lo: Int, hi: Int, previousSibling: Option[ContextTrees.this.ContextTree])Option[ContextTrees.this.ContextTree]">loop</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#scala.tools.nsc.interactive;ContextTrees.locateContextTree.contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.length" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#scala;Int.-(1409840560)" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>, <a href="../../../Option.scala.html#scala.None" title="None.type">None</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Insert a context at correct position into a buffer of context trees.
   *  If the `context` has a transparent position, add it multiple times
   *  at the positions of all its solid descendant trees.
   */</span>
  def <a title="(contexts: ContextTrees.this.Contexts, context: ContextTrees.this.Context)Unit" id="scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054)">addContext</a><span class="delimiter">(</span><a title="ContextTrees.this.Contexts" id="scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).contexts">contexts</a>: <a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer" title="ContextTrees.this.Contexts">Contexts</a>, <a title="ContextTrees.this.Context" id="scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).context">context</a>: <a href="../typechecker/Contexts.scala.html#scala.tools.nsc.typechecker;Contexts;Context" title="ContextTrees.this.Context">Context</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#scala;Unit" title="Unit">Unit</a> = <span class="delimiter">{</span>
    val <a title="ContextTrees.this.analyzer.global.Position" id="scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).cpos">cpos</a> = <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).context" title="ContextTrees.this.Context">context</a>.<a href="../typechecker/Contexts.scala.html#scala.tools.nsc.typechecker;Contexts;Context.tree" title="=&gt; ContextTrees.this.analyzer.global.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; ContextTrees.this.analyzer.global.Position">pos</a>
    if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).cpos" title="ContextTrees.this.analyzer.global.Position">cpos</a>.<a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.isTransparent" title="=&gt; Boolean">isTransparent</a><span class="delimiter">)</span>
      for <span class="delimiter">(</span><a title="ContextTrees.this.Tree" id="scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).$anonfun.t">t</a> &lt;- <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).context" title="ContextTrees.this.Context">context</a>.<a href="../typechecker/Contexts.scala.html#scala.tools.nsc.typechecker;Contexts;Context.tree" title="=&gt; ContextTrees.this.analyzer.global.Tree">tree</a>.<a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;TreeContextApiImpl.children" title="=&gt; List[ContextTrees.this.analyzer.global.Tree]">children</a> <a href="../../../collection/immutable/List.scala.html#scala.collection.immutable;List.foreach" title="(f: ContextTrees.this.Tree =&gt; Unit)Unit">flatMap</a> <a href="../../../reflect/internal/Positions.scala.html#scala.reflect.internal;Positions.solidDescendants" title="(tree: ContextTrees.this.Tree)List[ContextTrees.this.Tree]">solidDescendants</a><span class="delimiter">)</span>
        <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7)" title="(contexts: ContextTrees.this.Contexts, context: ContextTrees.this.Context, cpos: ContextTrees.this.Position)Unit">addContext</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).contexts" title="ContextTrees.this.Contexts">contexts</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).context" title="ContextTrees.this.Context">context</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).$anonfun.t" title="ContextTrees.this.Tree">t</a>.<a href="../../../reflect/internal/Trees.scala.html#scala.reflect.internal;Trees;Tree.pos" title="=&gt; ContextTrees.this.Position">pos</a><span class="delimiter">)</span>
    else
      <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7)" title="(contexts: ContextTrees.this.Contexts, context: ContextTrees.this.Context, cpos: ContextTrees.this.Position)Unit">addContext</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).contexts" title="ContextTrees.this.Contexts">contexts</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).context" title="ContextTrees.this.Context">context</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(a1a4bfd054).cpos" title="ContextTrees.this.analyzer.global.Position">cpos</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Insert a context with non-transparent position `cpos`
   *  at correct position into a buffer of context trees.
   */</span>
  def <a title="(contexts: ContextTrees.this.Contexts, context: ContextTrees.this.Context, cpos: ContextTrees.this.Position)Unit" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7)">addContext</a><span class="delimiter">(</span><a title="ContextTrees.this.Contexts" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts">contexts</a>: <a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer" title="ContextTrees.this.Contexts">Contexts</a>, <a title="ContextTrees.this.Context" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).context">context</a>: <a href="../typechecker/Contexts.scala.html#scala.tools.nsc.typechecker;Contexts;Context" title="ContextTrees.this.Context">Context</a>, <a title="ContextTrees.this.Position" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos">cpos</a>: <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;Position" title="ContextTrees.this.Position">Position</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#scala;Unit" title="Unit">Unit</a> = <a href="#scala.tools.nsc.interactive;ContextTrees" title="(x$1: Any)Any">synchronized</a> <span title="Unit" class="delimiter">{</span>
    try <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a>.<a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;Position.isRange" title="=&gt; Boolean">isRange</a><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
      else if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/IndexedSeqOptimized.scala.html#scala.collection;IndexedSeqOptimized.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer.+=(780e854f97)" title="(elem: ContextTrees.this.ContextTree)contexts.type">+=</a> new <a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree" title="ContextTrees.this.ContextTree">ContextTree</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).context" title="ContextTrees.this.Context">context</a><span class="delimiter">)</span>
      else <span class="delimiter">{</span>
        val hi = <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.length" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#scala;Int.-(1409840560)" title="Int" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).hi">-</a> <span title="Int(1)" class="int">1</span>
        if <span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).hi" title="Int">hi</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.precedes" title="(pos: scala.reflect.internal.util.Position)Boolean">precedes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span class="delimiter">)</span>
          <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a> <a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer.+=(780e854f97)" title="(elem: ContextTrees.this.ContextTree)contexts.type">+=</a> new <a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree" title="ContextTrees.this.ContextTree">ContextTree</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).context" title="ContextTrees.this.Context">context</a><span class="delimiter">)</span>
        else if <span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).hi" title="Int">hi</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.properlyIncludes" title="(pos: scala.reflect.internal.util.Position)Boolean">properlyIncludes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span class="delimiter">)</span> <span class="comment">// fast path w/o search</span>
          <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7)" title="(contexts: ContextTrees.this.Contexts, context: ContextTrees.this.Context, cpos: ContextTrees.this.Position)Unit">addContext</a><span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).hi" title="Int">hi</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.children" title="=&gt; scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]">children</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).context" title="ContextTrees.this.Context">context</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span class="delimiter">)</span>
        else if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.precedes" title="(pos: scala.reflect.internal.util.Position)Boolean">precedes</a> <a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a><span class="delimiter">)</span>
          new <a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree" title="ContextTrees.this.ContextTree">ContextTree</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).context" title="ContextTrees.this.Context">context</a><span class="delimiter">)</span> <a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer.+=:" title="(elem: ContextTrees.this.ContextTree)contexts.type">+=:</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a>
        else <span class="delimiter">{</span>
          def <a title="(idx: Int)Boolean" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt">insertAt</a><span class="delimiter">(</span><a title="Int" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.idx">idx</a>: <a href="../../../Int.scala.html#scala;Int" title="Int">Int</a><span class="delimiter">)</span>: <a href="../../../Boolean.scala.html#scala;Boolean" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
            val <a title="ContextTrees.this.Position" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.oldpos">oldpos</a> = <a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.idx" title="Int">idx</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a>
            if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.oldpos" title="ContextTrees.this.Position">oldpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.sameRange" title="(pos: scala.reflect.internal.util.Position)Boolean">sameRange</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.update" title="(idx: Int, elem: ContextTrees.this.ContextTree)Unit">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.idx" title="Int">idx</a><span class="delimiter">)</span> = new <a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree" title="ContextTrees.this.ContextTree">ContextTree</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).context" title="ContextTrees.this.Context">context</a>, <a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.idx" title="Int">idx</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.children" title="=&gt; scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]">children</a><span class="delimiter">)</span>
              true
            <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.oldpos" title="ContextTrees.this.Position">oldpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.includes" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7)" title="(contexts: ContextTrees.this.Contexts, context: ContextTrees.this.Context, cpos: ContextTrees.this.Position)Unit">addContext</a><span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.idx" title="Int">idx</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.children" title="=&gt; scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]">children</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).context" title="ContextTrees.this.Context">context</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span class="delimiter">)</span>
              true
            <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.includes" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.oldpos" title="ContextTrees.this.Position">oldpos</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              val <a title="Int" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.start">start</a> = <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/GenSeqLike.scala.html#scala.collection;GenSeqLike.indexWhere(654a5f82d5)" title="(p: ContextTrees.this.ContextTree =&gt; Boolean)Int">indexWhere</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.includes" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.start.$anonfun.x$3" title="ContextTrees.this.ContextTree">_</a>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a><span class="delimiter">)</span>
              val <a title="Int" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.last">last</a> = <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/GenSeqLike.scala.html#scala.collection;GenSeqLike.lastIndexWhere(654a5f82d5)" title="(p: ContextTrees.this.ContextTree =&gt; Boolean)Int">lastIndexWhere</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.includes" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.last.$anonfun.x$4" title="ContextTrees.this.ContextTree">_</a>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a><span class="delimiter">)</span>
              <a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.update" title="(idx: Int, elem: ContextTrees.this.ContextTree)Unit">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.start" title="Int">start</a><span class="delimiter">)</span> = new <a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree" title="ContextTrees.this.ContextTree">ContextTree</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).context" title="ContextTrees.this.Context">context</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/IndexedSeqOptimized.scala.html#scala.collection;IndexedSeqOptimized.slice" title="(from: Int, until: Int)scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]">slice</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.start" title="Int">start</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.last" title="Int">last</a> <a href="../../../Int.scala.html#scala;Int.+(1409840560)" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/mutable/ArrayBuffer.scala.html#scala.collection.mutable;ArrayBuffer.remove(347ab11542)" title="(n: Int, count: Int)Unit">remove</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.start" title="Int">start</a> <a href="../../../Int.scala.html#scala;Int.+(1409840560)" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.last" title="Int">last</a> <a href="../../../Int.scala.html#scala;Int.-(1409840560)" title="(x: Int)Int">-</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt.start" title="Int">start</a><span class="delimiter">)</span>
              true
            <span class="delimiter">}</span> else false
          <span class="delimiter">}</span>
          def <a title="(lo: Int, hi: Int)Unit" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop">loop</a><span class="delimiter">(</span><a title="Int" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.lo">lo</a>: <a href="../../../Int.scala.html#scala;Int" title="Int">Int</a>, <a title="Int" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.hi">hi</a>: <a href="../../../Int.scala.html#scala;Int" title="Int">Int</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.hi" title="Int">hi</a> <a href="../../../Int.scala.html#scala;Int.-(1409840560)" title="(x: Int)Int">-</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.lo" title="Int">lo</a> <a href="../../../Int.scala.html#scala;Int.>(5f58a84eb3)" title="(x: Int)Boolean">&gt;</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              val mid = <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.lo" title="Int">lo</a> <a href="../../../Int.scala.html#scala;Int.+(1409840560)" title="(x: Int)Int">+</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.hi" title="Int">hi</a><span class="delimiter">)</span> <a href="../../../Int.scala.html#scala;Int./(1409840560)" title="Int" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.mid">/</a> <span title="Int(2)" class="int">2</span>
              val <a title="ContextTrees.this.Position" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.midpos">midpos</a> = <a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.mid" title="Int">mid</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a>
              if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.precedes" title="(pos: scala.reflect.internal.util.Position)Boolean">precedes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.midpos" title="ContextTrees.this.Position">midpos</a><span class="delimiter">)</span>
                <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop" title="(lo: Int, hi: Int)Unit">loop</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.lo" title="Int">lo</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.mid" title="Int">mid</a><span class="delimiter">)</span>
              else if <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.midpos" title="ContextTrees.this.Position">midpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.precedes" title="(pos: scala.reflect.internal.util.Position)Boolean">precedes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span class="delimiter">)</span>
                <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop" title="(lo: Int, hi: Int)Unit">loop</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.mid" title="Int">mid</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.hi" title="Int">hi</a><span class="delimiter">)</span>
              else
                <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7)" title="(contexts: ContextTrees.this.Contexts, context: ContextTrees.this.Context, cpos: ContextTrees.this.Position)Unit">addContext</a><span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.mid" title="Int">mid</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.children" title="=&gt; scala.collection.mutable.ArrayBuffer[ContextTrees.this.ContextTree]">children</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).context" title="ContextTrees.this.Context">context</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt" title="(idx: Int)Boolean">insertAt</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.lo" title="Int">lo</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#scala;Boolean.unary_!" title="=&gt; Boolean">!</a><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).insertAt" title="(idx: Int)Boolean">insertAt</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.hi" title="Int">hi</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              val <a title="ContextTrees.this.Position" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.lopos">lopos</a> = <a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.lo" title="Int">lo</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a>
              val <a title="ContextTrees.this.Position" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.hipos">hipos</a> = <a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.hi" title="Int">hi</a><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a>
              if <span class="delimiter">(</span><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.lopos" title="ContextTrees.this.Position">lopos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.precedes" title="(pos: scala.reflect.internal.util.Position)Boolean">precedes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#scala;Boolean.&&" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.precedes" title="(pos: scala.reflect.internal.util.Position)Boolean">precedes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.hipos" title="ContextTrees.this.Position">hipos</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/mutable/BufferLike.scala.html#scala.collection.mutable;BufferLike.insert" title="(n: Int, elems: ContextTrees.this.ContextTree*)Unit">insert</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.hi" title="Int">hi</a>, new <a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree" title="ContextTrees.this.ContextTree">ContextTree</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).context" title="ContextTrees.this.Context">context</a><span class="delimiter">)</span><span class="delimiter">)</span>
              else
                <a href="../../../reflect/internal/Reporting.scala.html#scala.reflect.internal;Reporting.inform(7fc9e56e07)" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="String(&quot;internal error? skewed positions: &quot;)" class="string">&quot;internal error? skewed positions: &quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.lopos" title="ContextTrees.this.Position">lopos</a><span title="(x$1: Any)String">+</span><span title="String(&quot; !&lt; &quot;)" class="string">&quot; !&lt; &quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span title="(x$1: Any)String">+</span><span title="String(&quot; !&lt; &quot;)" class="string">&quot; !&lt; &quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop.hipos" title="ContextTrees.this.Position">hipos</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
          <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).loop" title="(lo: Int, hi: Int)Unit">loop</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).hi" title="Int">hi</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="Throwable" id="scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).ex">ex</a>: <span title="Throwable">Throwable</span> =&gt;
        <a href="../../../Predef.scala.html#scala.Predef.println(b0c81b2e65)" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).ex" title="Throwable">ex</a><span class="delimiter">)</span>
        <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).ex" title="Throwable">ex</a>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="../../../Predef.scala.html#scala.Predef.println(b0c81b2e65)" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;failure inserting &quot;)" class="string">&quot;failure inserting &quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span title="(x$1: Any)String">+</span><span title="String(&quot; into &quot;)" class="string">&quot; into &quot;</span><span title="(x$1: Any)String">+</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a><span title="(x$1: Any)String">+</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.length" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#scala;Int.-(1409840560)" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a><span title="(x$1: Any)String">+</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span title="(x$1: Any)String">+</span>
                <span class="delimiter">(</span><a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.apply" title="(idx: Int)ContextTrees.this.ContextTree">contexts</a><span class="delimiter">(</span><a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).contexts" title="ContextTrees.this.Contexts">contexts</a>.<a href="../../../collection/mutable/ResizableArray.scala.html#scala.collection.mutable;ResizableArray.length" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#scala;Int.-(1409840560)" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<a href="#scala.tools.nsc.interactive;ContextTrees;ContextTree.pos" title="=&gt; ContextTrees.this.Position">pos</a> <a href="../../../reflect/internal/util/Position.scala.html#scala.reflect.internal.util;InternalPositionImpl.includes" title="(pos: scala.reflect.internal.util.Position)Boolean">includes</a> <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).cpos" title="ContextTrees.this.Position">cpos</a><span class="delimiter">)</span><span class="delimiter">)</span>
        throw <a href="#scala.tools.nsc.interactive;ContextTrees.addContext(43b4d1b1d7).ex" title="Throwable">ex</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>http4s-servlet/org/http4s/servlet/Http4sServlet.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
package org.http4s
package servlet

import scodec.bits.ByteVector
import java.util.concurrent.ExecutorService
import server._

import javax.servlet.http.<span class="delimiter">{</span>HttpServletResponse, HttpServletRequest, HttpServlet<span class="delimiter">}</span>
import java.net.InetAddress

import scala.collection.<span title="scala.collection.JavaConverters.type">JavaConverters</span>._
import javax.servlet._

import scala.concurrent.duration.Duration
import scalaz.concurrent.Actor
import scalaz.stream.<span title="scalaz.stream.Cause.type">Cause</span>.<span class="delimiter">{</span>End, Terminated<span class="delimiter">}</span>
import scalaz.concurrent.<span class="delimiter">{</span>Strategy, Task<span class="delimiter">}</span>
import scalaz.stream.<span title="scalaz.stream.io.type">io</span>._
import scalaz.<span class="delimiter">{</span>\/, -\/, \/-<span class="delimiter">}</span>
import scala.util.control.NonFatal
import org.parboiled2.ParseError
import org.log4s.getLogger

class <a title="class Http4sServlet extends javax.servlet.http.HttpServlet" id="org.http4s.servlet;Http4sServlet">Http4sServlet</a><a href="#org.http4s.servlet;Http4sServlet" title="org.http4s.servlet.Http4sServlet" class="delimiter">(</a><a title="org.http4s.server.HttpService" id="org.http4s.servlet;Http4sServlet.service">service</a>: <a href="../../../../http4s-server/org/http4s/server/Service.scala.html#org.http4s.server;Service" title="org.http4s.server.HttpService">HttpService</a>,
                    <a title="scala.concurrent.duration.Duration" id="org.http4s.servlet.Http4sServlet.<init>$default$2">asyncTimeout</a>: <span title="scala.concurrent.duration.Duration">Duration</span> = <span title="scala.concurrent.duration.Duration.type">Duration</span>.<span title="=&gt; scala.concurrent.duration.Duration.Infinite">Inf</span>,
                    <a title="Int" id="org.http4s.servlet.Http4sServlet.<init>$default$3">chunkSize</a>: <span title="Int">Int</span> = <span title="Int(4096)" class="int">4096</span>,
                    <a title="java.util.concurrent.ExecutorService" id="org.http4s.servlet.Http4sServlet.<init>$default$4">threadPool</a>: <span title="java.util.concurrent.ExecutorService">ExecutorService</span> = <span title="scalaz.concurrent.Strategy.type">Strategy</span>.<span title="=&gt; java.util.concurrent.ExecutorService">DefaultExecutorService</span><span class="delimiter">)</span>
  extends <a href="#org.http4s.servlet;Http4sServlet" title="javax.servlet.http.HttpServlet">HttpServlet</a>
<span class="delimiter">{</span>
  import <a href="#org.http4s.servlet.Http4sServlet.readResolve" title="org.http4s.servlet.Http4sServlet.type">Http4sServlet</a>._

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> val <a title="org.log4s.Logger" id="org.http4s.servlet;Http4sServlet.logger">logger</a> = <span title="org.log4s.Logger">getLogger</span>

  private val <a title="Long" id="org.http4s.servlet;Http4sServlet.asyncTimeoutMillis">asyncTimeoutMillis</a> = if <span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.<init>$default$2" title="scala.concurrent.duration.Duration">asyncTimeout</a>.<span title="()Boolean">isFinite</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#org.http4s.servlet.Http4sServlet.<init>$default$2" title="scala.concurrent.duration.Duration">asyncTimeout</a>.<span title="=&gt; Long">toMillis</span> else -<span title="Long(-1L)" class="int">1</span>  <span class="comment">// -1 == Inf</span>

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> var <a title="org.http4s.server.ServerSoftware" id="org.http4s.servlet;Http4sServlet.serverSoftware">serverSoftware</a>: <a href="../../../../http4s-core/org/http4s/server/ServerSoftware.scala.html#org.http4s.server;ServerSoftware" title="org.http4s.server.ServerSoftware">ServerSoftware</a> = _
  private<span class="delimiter">[</span>this<span class="delimiter">]</span> var <a title="org.http4s.servlet.Http4sServlet.BodyReader" id="org.http4s.servlet;Http4sServlet.inputStreamReader">inputStreamReader</a>: <span title="org.http4s.servlet.Http4sServlet.BodyReader">BodyReader</span> = _

  private class <a title="class Http4sAsyncListener extends Object with javax.servlet.AsyncListener" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener">Http4sAsyncListener</a> extends <a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener" title="javax.servlet.AsyncListener">AsyncListener</a> <span class="delimiter">{</span>
    override def <a title="(event: javax.servlet.AsyncEvent)Unit" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onComplete">onComplete</a><span class="delimiter">(</span><a title="javax.servlet.AsyncEvent" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onComplete.event">event</a>: <span title="javax.servlet.AsyncEvent">AsyncEvent</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>

    override def <a title="(event: javax.servlet.AsyncEvent)Unit" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onError">onError</a><span class="delimiter">(</span><a title="javax.servlet.AsyncEvent" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onError.event">event</a>: <span title="javax.servlet.AsyncEvent">AsyncEvent</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#org.http4s.servlet;Http4sServlet.logger" title="org.log4s.Logger">logger</a>.error<span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onError.event" title="javax.servlet.AsyncEvent">event</a>.<span title="()Throwable">getThrowable</span><span class="delimiter">)</span><span title="Unit" class="delimiter">(</span><span title="String(&quot;Async error processing request&quot;)" class="string">&quot;Async error processing request&quot;</span><span class="delimiter">)</span>

    override def <a title="(event: javax.servlet.AsyncEvent)Unit" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onStartAsync">onStartAsync</a><span class="delimiter">(</span><a title="javax.servlet.AsyncEvent" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onStartAsync.event">event</a>: <span title="javax.servlet.AsyncEvent">AsyncEvent</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>

    override def <a title="(event: javax.servlet.AsyncEvent)Unit" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout">onTimeout</a><span class="delimiter">(</span><a title="javax.servlet.AsyncEvent" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.event">event</a>: <span title="javax.servlet.AsyncEvent">AsyncEvent</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      val <a title="javax.servlet.AsyncContext" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.ctx">ctx</a> = <a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.event" title="javax.servlet.AsyncEvent">event</a>.<span title="()javax.servlet.AsyncContext">getAsyncContext</span>
      val <a title="javax.servlet.http.HttpServletResponse" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.servletResponse">servletResponse</a> = <a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.ctx" title="javax.servlet.AsyncContext">ctx</a>.<span title="()javax.servlet.ServletResponse">getResponse</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="javax.servlet.http.HttpServletResponse" class="delimiter">[</span><span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">]</span>
      val <a title="scalaz.concurrent.Task[org.http4s.Response]" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.response">response</a> = <a href="../../../../http4s-core/org/http4s/ResponseBuilder.scala.html#org.http4s.ResponseBuilder.apply(a16c282657)" title="(status: org.http4s.Status, body: String, headers: org.http4s.Header*)(implicit w: org.http4s.EntityEncoder[String])scalaz.concurrent.Task[org.http4s.Response]">ResponseBuilder</a><a href="../../../../http4s-core/org/http4s/EntityEncoder.scala.html#org.http4s;EntityEncoderInstances.stringEncoder" title="implicit org.http4s.EntityEncoderInstances.stringEncoder : (implicit charset: org.http4s.Charset)org.http4s.EntityEncoder[String]" class="delimiter">(</a><a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s.Status" title="org.http4s.Status.type">Status</a>.<a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s.Status.InternalServerError" title="=&gt; org.http4s.Status">InternalServerError</a>, <span title="String(&quot;Service timed out.&quot;)" class="string">&quot;Service timed out.&quot;</span><span class="delimiter">)</span>
      if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.servletResponse" title="javax.servlet.http.HttpServletResponse">servletResponse</a>.<span title="()Boolean">isCommitted</span><span class="delimiter">)</span>
        <a href="#org.http4s.servlet;Http4sServlet" title="Http4sServlet.this.type">Http4sServlet</a>.this.<a href="#org.http4s.servlet;Http4sServlet.renderResponse" title="(response: scalaz.concurrent.Task[org.http4s.Response], servletResponse: javax.servlet.http.HttpServletResponse)scalaz.concurrent.Task[Unit]">renderResponse</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.response" title="scalaz.concurrent.Task[org.http4s.Response]">response</a>, <a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.servletResponse" title="javax.servlet.http.HttpServletResponse">servletResponse</a><span class="delimiter">)</span>
      else <span class="delimiter">{</span>
        val <a title="javax.servlet.http.HttpServletRequest" id="org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.servletRequest">servletRequest</a> = <a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.ctx" title="javax.servlet.AsyncContext">ctx</a>.<span title="()javax.servlet.ServletRequest">getRequest</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="javax.servlet.http.HttpServletRequest" class="delimiter">[</span><span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span><span class="delimiter">]</span>
        <a href="#org.http4s.servlet;Http4sServlet.logger" title="org.log4s.Logger">logger</a>.warn<span title="Unit" class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Async context timed out after servlet response was already committed on &quot;)">Async context timed out after servlet response was already committed on $</span><span class="delimiter">{</span><a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.servletRequest" title="javax.servlet.http.HttpServletRequest">servletRequest</a>.<span title="()String">getMethod</span><span class="delimiter">}</span><span title="String(&quot; &quot;)"> $</span><span class="delimiter">{</span><a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.servletRequest" title="javax.servlet.http.HttpServletRequest">servletRequest</a>.<span title="()String">getPathInfo</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener.onTimeout.ctx" title="javax.servlet.AsyncContext">ctx</a>.<span title="()Unit">complete</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  override def <a title="(config: javax.servlet.ServletConfig)Unit" id="org.http4s.servlet;Http4sServlet.init(a76446beb6)">init</a><span class="delimiter">(</span><a title="javax.servlet.ServletConfig" id="org.http4s.servlet;Http4sServlet.init(a76446beb6).config">config</a>: <span title="javax.servlet.ServletConfig">ServletConfig</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="javax.servlet.ServletContext" id="org.http4s.servlet;Http4sServlet.init(a76446beb6).servletContext">servletContext</a> = <a href="#org.http4s.servlet;Http4sServlet.init(a76446beb6).config" title="javax.servlet.ServletConfig">config</a>.<span title="()javax.servlet.ServletContext">getServletContext</span>
    <a href="#org.http4s.servlet;Http4sServlet.serverSoftware" title="org.http4s.server.ServerSoftware">serverSoftware</a> = <a href="../../../../http4s-core/org/http4s/server/ServerSoftware.scala.html#org.http4s.server;ServerSoftware" title="(product: String, productVersion: Option[String], comment: Option[String])org.http4s.server.ServerSoftware">ServerSoftware</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.init(a76446beb6).servletContext" title="javax.servlet.ServletContext">servletContext</a>.<span title="()String">getServerInfo</span><span class="delimiter">)</span>
    val <a title="org.http4s.servlet.ServletApiVersion" id="org.http4s.servlet;Http4sServlet.init(a76446beb6).servletApiVersion">servletApiVersion</a> = <a href="ServletApiVersion.scala.html#org.http4s.servlet.ServletApiVersion.apply(a7f6695d1e)" title="(sc: javax.servlet.ServletContext)org.http4s.servlet.ServletApiVersion">ServletApiVersion</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.init(a76446beb6).servletContext" title="javax.servlet.ServletContext">servletContext</a><span class="delimiter">)</span>
    <a href="#org.http4s.servlet;Http4sServlet.logger" title="org.log4s.Logger">logger</a>.info<span title="Unit" class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Detected Servlet API version &quot;)">Detected Servlet API version $</span><a href="#org.http4s.servlet;Http4sServlet.init(a76446beb6).servletApiVersion" title="org.http4s.servlet.ServletApiVersion">servletApiVersion</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>

    <a href="#org.http4s.servlet;Http4sServlet.inputStreamReader" title="org.http4s.servlet.Http4sServlet.BodyReader">inputStreamReader</a> = if <span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.init(a76446beb6).servletApiVersion" title="org.http4s.servlet.ServletApiVersion">servletApiVersion</a> <span title="(that: org.http4s.servlet.ServletApiVersion)Boolean">&gt;=</span> <a href="ServletApiVersion.scala.html#org.http4s.servlet;ServletApiVersion" title="(major: Int, minor: Int)org.http4s.servlet.ServletApiVersion">ServletApiVersion</a><span class="delimiter">(</span><span title="Int(3)" class="int">3</span>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#org.http4s.servlet.Http4sServlet.syncInputStreamReader" title="(chunkSize: Int)(req: javax.servlet.http.HttpServletRequest)org.http4s.EntityBody">syncInputStreamReader</a><a href="#org.http4s.servlet;Http4sServlet.init(a76446beb6).$anonfun.req" title="javax.servlet.http.HttpServletRequest" class="delimiter">(</a><a href="#org.http4s.servlet.Http4sServlet.<init>$default$3" title="Int">chunkSize</a><span class="delimiter">)</span>
    else
      <a href="#org.http4s.servlet.Http4sServlet.syncInputStreamReader" title="(chunkSize: Int)(req: javax.servlet.http.HttpServletRequest)org.http4s.EntityBody">syncInputStreamReader</a><a href="#org.http4s.servlet;Http4sServlet.init(a76446beb6).$anonfun.req" title="javax.servlet.http.HttpServletRequest" class="delimiter">(</a><a href="#org.http4s.servlet.Http4sServlet.<init>$default$3" title="Int">chunkSize</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="(servletRequest: javax.servlet.http.HttpServletRequest, servletResponse: javax.servlet.http.HttpServletResponse)Unit" id="org.http4s.servlet;Http4sServlet.service(f7da0748a9)">service</a><span class="delimiter">(</span><a title="javax.servlet.http.HttpServletRequest" id="org.http4s.servlet;Http4sServlet.service(f7da0748a9).servletRequest">servletRequest</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.http4s.servlet;Http4sServlet.service(f7da0748a9).servletResponse">servletResponse</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      val <a title="javax.servlet.AsyncContext" id="org.http4s.servlet;Http4sServlet.service(f7da0748a9).ctx">ctx</a> = <a href="#org.http4s.servlet;Http4sServlet.service(f7da0748a9).servletRequest" title="javax.servlet.http.HttpServletRequest">servletRequest</a>.<span title="()javax.servlet.AsyncContext">startAsync</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#org.http4s.servlet;Http4sServlet.toRequest" title="(req: javax.servlet.http.HttpServletRequest)org.http4s.ParseResult[org.http4s.Request]">toRequest</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.service(f7da0748a9).servletRequest" title="javax.servlet.http.HttpServletRequest">servletRequest</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
        case -\/<span class="delimiter">(</span><span title="org.http4s.ParseFailure">e</span><span class="delimiter">)</span> =&gt;
          <span class="comment">// TODO make more http4sy</span>
          <a href="#org.http4s.servlet;Http4sServlet.service(f7da0748a9).servletResponse" title="javax.servlet.http.HttpServletResponse">servletResponse</a>.<span title="(x$1: Int, x$2: String)Unit">sendError</span><span class="delimiter">(</span>HttpServletResponse.<span title="Int(400)">SC_BAD_REQUEST</span>, <span title="org.http4s.ParseFailure">e</span>.<a href="../../../../http4s-core/org/http4s/ParseFailure.scala.html#org.http4s;ParseFailure.sanitized" title="=&gt; String">sanitized</a><span class="delimiter">)</span>
        case \/-<span class="delimiter">(</span><a title="org.http4s.Request" id="org.http4s.servlet;Http4sServlet.service(f7da0748a9).req">req</a><span class="delimiter">)</span> =&gt;
          <a href="#org.http4s.servlet;Http4sServlet.service(f7da0748a9).ctx" title="javax.servlet.AsyncContext">ctx</a>.<span title="(x$1: javax.servlet.AsyncListener)Unit">addListener</span><span class="delimiter">(</span>new <a href="#org.http4s.servlet;Http4sServlet;Http4sAsyncListener" title="Http4sServlet.this.Http4sAsyncListener">Http4sAsyncListener</a><span class="delimiter">)</span>
          <a href="#org.http4s.servlet;Http4sServlet.service(f7da0748a9).ctx" title="javax.servlet.AsyncContext">ctx</a>.<span title="(x$1: Long)Unit">setTimeout</span><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.asyncTimeoutMillis" title="=&gt; Long">asyncTimeoutMillis</a><span class="delimiter">)</span>
          <a href="#org.http4s.servlet;Http4sServlet.handle" title="(request: org.http4s.Request, ctx: javax.servlet.AsyncContext)Unit">handle</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.service(f7da0748a9).req" title="org.http4s.Request">req</a>, <a href="#org.http4s.servlet;Http4sServlet.service(f7da0748a9).ctx" title="javax.servlet.AsyncContext">ctx</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a href="#org.http4s.servlet;Http4sServlet.service(f7da0748a9).<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><span title="Throwable">e</span><span class="delimiter">)</span> =&gt; <a href="#org.http4s.servlet;Http4sServlet.handleError" title="(t: Throwable, response: javax.servlet.http.HttpServletResponse)Unit">handleError</a><span class="delimiter">(</span><span title="Throwable">e</span>, <a href="#org.http4s.servlet;Http4sServlet.service(f7da0748a9).servletResponse" title="javax.servlet.http.HttpServletResponse">servletResponse</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  private def <a title="(t: Throwable, response: javax.servlet.http.HttpServletResponse)Unit" id="org.http4s.servlet;Http4sServlet.handleError">handleError</a><span class="delimiter">(</span><a title="Throwable" id="org.http4s.servlet;Http4sServlet.handleError.t">t</a>: <span title="Throwable">Throwable</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.http4s.servlet;Http4sServlet.handleError.response">response</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#org.http4s.servlet;Http4sServlet.handleError.response" title="javax.servlet.http.HttpServletResponse">response</a>.<span title="()Boolean">isCommitted</span><span class="delimiter">)</span> <a href="#org.http4s.servlet;Http4sServlet.handleError.t" title="Throwable">t</a> match <span class="delimiter">{</span>
      case ParseError<span class="delimiter">(</span>_, _<span class="delimiter">)</span> =&gt;
        <a href="#org.http4s.servlet;Http4sServlet.logger" title="org.log4s.Logger">logger</a>.info<span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.handleError.t" title="Throwable">t</a><span class="delimiter">)</span><span title="(x$1: String, x$2: Throwable)Unit" class="delimiter">(</span><span title="String(&quot;Error during processing phase of request&quot;)" class="string">&quot;Error during processing phase of request&quot;</span><span class="delimiter">)</span>
        <a href="#org.http4s.servlet;Http4sServlet.handleError.response" title="javax.servlet.http.HttpServletResponse">response</a>.<span title="(x$1: Int)Unit">sendError</span><span class="delimiter">(</span>HttpServletResponse.<span title="Int(400)">SC_BAD_REQUEST</span><span class="delimiter">)</span>

      case _ =&gt;
        <a href="#org.http4s.servlet;Http4sServlet.logger" title="org.log4s.Logger">logger</a>.error<span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.handleError.t" title="Throwable">t</a><span class="delimiter">)</span><span title="(x$1: String, x$2: Throwable)Unit" class="delimiter">(</span><span title="String(&quot;Error processing request&quot;)" class="string">&quot;Error processing request&quot;</span><span class="delimiter">)</span>
        <a href="#org.http4s.servlet;Http4sServlet.handleError.response" title="javax.servlet.http.HttpServletResponse">response</a>.<span title="(x$1: Int)Unit">sendError</span><span class="delimiter">(</span>HttpServletResponse.<span title="Int(500)">SC_INTERNAL_SERVER_ERROR</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    else <a href="#org.http4s.servlet;Http4sServlet.logger" title="org.log4s.Logger">logger</a>.error<span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.handleError.t" title="Throwable">t</a><span class="delimiter">)</span><span title="(x$1: String, x$2: Throwable)Unit" class="delimiter">(</span><span title="String(&quot;Error processing request&quot;)" class="string">&quot;Error processing request&quot;</span><span class="delimiter">)</span>

  <span class="delimiter">}</span>

  private def <a title="(request: org.http4s.Request, ctx: javax.servlet.AsyncContext)Unit" id="org.http4s.servlet;Http4sServlet.handle">handle</a><span class="delimiter">(</span><a title="org.http4s.Request" id="org.http4s.servlet;Http4sServlet.handle.request">request</a>: <a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Request" title="org.http4s.Request">Request</a>, <a title="javax.servlet.AsyncContext" id="org.http4s.servlet;Http4sServlet.handle.ctx">ctx</a>: <span title="javax.servlet.AsyncContext">AsyncContext</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    val <a title="javax.servlet.http.HttpServletResponse" id="org.http4s.servlet;Http4sServlet.handle.servletResponse">servletResponse</a> = <a href="#org.http4s.servlet;Http4sServlet.handle.ctx" title="javax.servlet.AsyncContext">ctx</a>.<span title="()javax.servlet.ServletResponse">getResponse</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="javax.servlet.http.HttpServletResponse" class="delimiter">[</span><span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">]</span>
    <span title="scalaz.concurrent.Task.type">Task</span>.<span title="(a: =&gt; scalaz.concurrent.Task[Unit])(implicit pool: java.util.concurrent.ExecutorService)scalaz.concurrent.Task[Unit]">fork</span> <span class="delimiter">{</span>
      val <a title="scalaz.concurrent.Task[org.http4s.Response]" id="org.http4s.servlet;Http4sServlet.handle.response">response</a> = <a href="#org.http4s.servlet;Http4sServlet.service" title="org.http4s.server.HttpService">service</a>.<a href="../../../../http4s-server/org/http4s/server/Service.scala.html#org.http4s.server;Service.or" title="(a: org.http4s.Request, default: =&gt; scalaz.concurrent.Task[org.http4s.Response])scalaz.concurrent.Task[org.http4s.Response]">or</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.handle.request" title="org.http4s.Request">request</a>, <a href="../../../../http4s-core/org/http4s/ResponseBuilder.scala.html#org.http4s.ResponseBuilder" title="org.http4s.ResponseBuilder.type">ResponseBuilder</a>.<a href="../../../../http4s-core/org/http4s/ResponseBuilder.scala.html#org.http4s.ResponseBuilder.notFound" title="(request: org.http4s.Request)scalaz.concurrent.Task[org.http4s.Response]">notFound</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.handle.request" title="org.http4s.Request">request</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#org.http4s.servlet;Http4sServlet.renderResponse" title="(response: scalaz.concurrent.Task[org.http4s.Response], servletResponse: javax.servlet.http.HttpServletResponse)scalaz.concurrent.Task[Unit]">renderResponse</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.handle.response" title="scalaz.concurrent.Task[org.http4s.Response]">response</a>, <a href="#org.http4s.servlet;Http4sServlet.handle.servletResponse" title="javax.servlet.http.HttpServletResponse">servletResponse</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.<init>$default$4" title="java.util.concurrent.ExecutorService">threadPool</a><span class="delimiter">)</span>.<span title="(f: scalaz.\/[Throwable,Unit] =&gt; Unit)Unit">runAsync</span> <a href="#org.http4s.servlet;Http4sServlet.handle.$anonfun.x0$1" title="Unit" class="delimiter">{</a>
      case \/-<span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
        <a href="#org.http4s.servlet;Http4sServlet.handle.ctx" title="javax.servlet.AsyncContext">ctx</a>.<span title="()Unit">complete</span><span class="delimiter">(</span><span class="delimiter">)</span>
      case -\/<span class="delimiter">(</span><a title="Throwable" id="org.http4s.servlet;Http4sServlet.handle.$anonfun.t">t</a><span class="delimiter">)</span> =&gt;
        <a href="#org.http4s.servlet;Http4sServlet.handleError" title="(t: Throwable, response: javax.servlet.http.HttpServletResponse)Unit">handleError</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.handle.$anonfun.t" title="Throwable">t</a>, <a href="#org.http4s.servlet;Http4sServlet.handle.servletResponse" title="javax.servlet.http.HttpServletResponse">servletResponse</a><span class="delimiter">)</span>
        <a href="#org.http4s.servlet;Http4sServlet.handle.ctx" title="javax.servlet.AsyncContext">ctx</a>.<span title="()Unit">complete</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  private def <a title="(response: scalaz.concurrent.Task[org.http4s.Response], servletResponse: javax.servlet.http.HttpServletResponse)scalaz.concurrent.Task[Unit]" id="org.http4s.servlet;Http4sServlet.renderResponse">renderResponse</a><span class="delimiter">(</span><a title="scalaz.concurrent.Task[org.http4s.Response]" id="org.http4s.servlet;Http4sServlet.renderResponse.response">response</a>: <span title="scalaz.concurrent.Task[org.http4s.Response]">Task</span><span class="delimiter">[</span>Response<span class="delimiter">]</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.http4s.servlet;Http4sServlet.renderResponse.servletResponse">servletResponse</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span>: <span title="scalaz.concurrent.Task[Unit]">Task</span><span class="delimiter">[</span>Unit<span class="delimiter">]</span> =
    <a href="#org.http4s.servlet;Http4sServlet.renderResponse.response" title="scalaz.concurrent.Task[org.http4s.Response]">response</a>.<span title="(f: org.http4s.Response =&gt; scalaz.concurrent.Task[Unit])scalaz.concurrent.Task[Unit]">flatMap</span> <span class="delimiter">{</span> <a title="org.http4s.Response" id="org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.r">r</a> =&gt;
      <a href="#org.http4s.servlet;Http4sServlet.renderResponse.servletResponse" title="javax.servlet.http.HttpServletResponse">servletResponse</a>.<span title="(x$1: Int, x$2: String)Unit">setStatus</span><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.r" title="org.http4s.Response">r</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Response.status" title="=&gt; org.http4s.Status">status</a>.<a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s;Status.code" title="=&gt; Int">code</a>, <a href="#org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.r" title="org.http4s.Response">r</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Response.status" title="=&gt; org.http4s.Status">status</a>.<a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s;Status.reason" title="=&gt; String">reason</a><span class="delimiter">)</span>
      for <span class="delimiter">(</span><a title="org.http4s.Header" id="org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.$anonfun.header">header</a> &lt;- <a href="#org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.r" title="org.http4s.Response">r</a>.<a href="../../../../http4s-core/org/http4s/Headers.scala.html#org.http4s;Headers.foreach" title="(f: org.http4s.Header =&gt; Unit)Unit">headers</a><span class="delimiter">)</span>
        <a href="#org.http4s.servlet;Http4sServlet.renderResponse.servletResponse" title="javax.servlet.http.HttpServletResponse">servletResponse</a>.<span title="(x$1: String, x$2: String)Unit">addHeader</span><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.$anonfun.header" title="org.http4s.Header">header</a>.<a href="../../../../http4s-core/org/http4s/Header.scala.html#org.http4s;Header.name" title="=&gt; org.http4s.util.CaseInsensitiveString">name</a>.<a href="../../../../http4s-core/org/http4s/util/CaseInsensitiveString.scala.html#org.http4s.util;CaseInsensitiveString.toString" title="()String">toString</a>, <a href="#org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.$anonfun.header" title="org.http4s.Header">header</a>.<a href="../../../../http4s-core/org/http4s/Header.scala.html#org.http4s;Header.value" title="=&gt; String">value</a><span class="delimiter">)</span>
      val <a title="javax.servlet.ServletOutputStream" id="org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.out">out</a> = <a href="#org.http4s.servlet;Http4sServlet.renderResponse.servletResponse" title="javax.servlet.http.HttpServletResponse">servletResponse</a>.<span title="()javax.servlet.ServletOutputStream">getOutputStream</span>
      val <a title="Boolean" id="org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.isChunked">isChunked</a> = <a href="#org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.r" title="org.http4s.Response">r</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Message.isChunked" title="=&gt; Boolean">isChunked</a>
      <a href="#org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.r" title="org.http4s.Response">r</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Response.body" title="=&gt; org.http4s.EntityBody">body</a>.<span title="(f: scodec.bits.ByteVector =&gt; Unit)scalaz.stream.Process[scalaz.concurrent.Task,Unit]">map</span> <span class="delimiter">{</span> <a title="scodec.bits.ByteVector" id="org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.$anonfun.chunk">chunk</a> =&gt;
        <a href="#org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.out" title="javax.servlet.ServletOutputStream">out</a>.<span title="(x$1: Array[Byte])Unit">write</span><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.$anonfun.chunk" title="scodec.bits.ByteVector">chunk</a>.<span title="=&gt; Array[Byte]">toArray</span><span class="delimiter">)</span>
        if <span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.renderResponse.$anonfun.isChunked" title="Boolean">isChunked</a><span class="delimiter">)</span> <a href="#org.http4s.servlet;Http4sServlet.renderResponse.servletResponse" title="javax.servlet.http.HttpServletResponse">servletResponse</a>.<span title="()Unit">flushBuffer</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>.<span title="(implicit F: scalaz.Monad[[x]scalaz.concurrent.Task[x]], implicit C: scalaz.Catchable[[x]scalaz.concurrent.Task[x]])scalaz.concurrent.Task[Unit]">run</span>
    <span class="delimiter">}</span>

  protected def <a title="(req: javax.servlet.http.HttpServletRequest)org.http4s.ParseResult[org.http4s.Request]" id="org.http4s.servlet;Http4sServlet.toRequest">toRequest</a><span class="delimiter">(</span><a title="javax.servlet.http.HttpServletRequest" id="org.http4s.servlet;Http4sServlet.toRequest.req">req</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span><span class="delimiter">)</span>: <span title="org.http4s.ParseResult[org.http4s.Request]">ParseResult</span><span class="delimiter">[</span>Request<span class="delimiter">]</span> =
    for <span class="delimiter">{</span>
      <a title="org.http4s.Method" id="org.http4s.servlet;Http4sServlet.toRequest.$anonfun.method">method</a> &lt;- <a href="../../../../http4s-core/org/http4s/Method.scala.html#org.http4s.Method" title="org.http4s.Method.type">Method</a>.<a href="../../../../http4s-core/org/http4s/Method.scala.html#org.http4s.Method.fromString" title="(s: String)org.http4s.ParseResult[org.http4s.Method]">fromString</a><span title="(g: org.http4s.Method =&gt; scalaz.\/[org.http4s.ParseFailure,org.http4s.Request])scalaz.\/[org.http4s.ParseFailure,org.http4s.Request]" class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.toRequest.req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="()String">getMethod</span><span class="delimiter">)</span>
      <a title="org.http4s.Uri" id="org.http4s.servlet;Http4sServlet.toRequest.$anonfun.$anonfun.uri">uri</a> &lt;- <a href="../../../../http4s-core/org/http4s/Uri.scala.html#org.http4s.Uri" title="org.http4s.Uri.type">Uri</a>.<a href="../../../../http4s-core/org/http4s/Uri.scala.html#org.http4s.Uri.fromString" title="(s: String)org.http4s.ParseResult[org.http4s.Uri]">fromString</a><span title="(g: org.http4s.Uri =&gt; scalaz.\/[org.http4s.ParseFailure,org.http4s.Request])scalaz.\/[org.http4s.ParseFailure,org.http4s.Request]" class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.toRequest.req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="()String">getRequestURI</span><span class="delimiter">)</span>
      <a title="org.http4s.HttpVersion" id="org.http4s.servlet;Http4sServlet.toRequest.$anonfun.$anonfun.$anonfun.version">version</a> &lt;- <a href="../../../../http4s-core/org/http4s/HttpVersion.scala.html#org.http4s.HttpVersion" title="org.http4s.HttpVersion.type">HttpVersion</a>.<a href="../../../../http4s-core/org/http4s/HttpVersion.scala.html#org.http4s.HttpVersion.fromString" title="(s: String)org.http4s.ParseResult[org.http4s.HttpVersion]">fromString</a><span title="(g: org.http4s.HttpVersion =&gt; org.http4s.Request)scalaz.\/[org.http4s.ParseFailure,org.http4s.Request]" class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.toRequest.req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="()String">getProtocol</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> yield <a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Request" title="(method: org.http4s.Method, uri: org.http4s.Uri, httpVersion: org.http4s.HttpVersion, headers: org.http4s.Headers, body: org.http4s.EntityBody, attributes: org.http4s.AttributeMap)org.http4s.Request">Request</a><span class="delimiter">(</span>
      method = <a href="#org.http4s.servlet;Http4sServlet.toRequest.$anonfun.method" title="org.http4s.Method">method</a>,
      uri = <a href="#org.http4s.servlet;Http4sServlet.toRequest.$anonfun.$anonfun.uri" title="org.http4s.Uri">uri</a>,
      httpVersion = <a href="#org.http4s.servlet;Http4sServlet.toRequest.$anonfun.$anonfun.$anonfun.version" title="org.http4s.HttpVersion">version</a>,
      headers = <a href="#org.http4s.servlet;Http4sServlet.toHeaders" title="(req: javax.servlet.http.HttpServletRequest)org.http4s.Headers">toHeaders</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.toRequest.req" title="javax.servlet.http.HttpServletRequest">req</a><span class="delimiter">)</span>,
      body = <a href="#org.http4s.servlet;Http4sServlet.inputStreamReader" title="(v1: javax.servlet.http.HttpServletRequest)org.http4s.EntityBody">inputStreamReader</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.toRequest.req" title="javax.servlet.http.HttpServletRequest">req</a><span class="delimiter">)</span>,
      attributes = <a href="../../../../http4s-core/org/http4s/AttributeMap.scala.html#org.http4s.AttributeMap.apply(963dbe9908)" title="(entries: org.http4s.AttributeEntry[_]*)org.http4s.AttributeMap">AttributeMap</a><span class="delimiter">(</span>
        <a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s.Request" title="org.http4s.Request.type">Request</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s.Request.Keys" title="org.http4s.Request.Keys.type">Keys</a>.<a href="../../../../http4s-core/org/http4s/AttributeMap.scala.html#org.http4s;AttributeKey.apply" title="(value: Int)org.http4s.AttributeEntry[Int]">PathInfoCaret</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.toRequest.req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="()String">getContextPath</span>.<span title="()Int">length</span> <span title="(x: Int)Int">+</span> <a href="#org.http4s.servlet;Http4sServlet.toRequest.req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="()String">getServletPath</span>.<span title="()Int">length</span><span class="delimiter">)</span>,
        <a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s.Request" title="org.http4s.Request.type">Request</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s.Request.Keys" title="org.http4s.Request.Keys.type">Keys</a>.<a href="../../../../http4s-core/org/http4s/AttributeMap.scala.html#org.http4s;AttributeKey.apply" title="(value: java.net.InetAddress)org.http4s.AttributeEntry[java.net.InetAddress]">Remote</a><span class="delimiter">(</span><span title="java.net.InetAddress.type">InetAddress</span>.<span title="(x$1: String)java.net.InetAddress">getByName</span><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.toRequest.req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="()String">getRemoteAddr</span><span class="delimiter">)</span><span class="delimiter">)</span>,
        <a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s.Request" title="org.http4s.Request.type">Request</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s.Request.Keys" title="org.http4s.Request.Keys.type">Keys</a>.<a href="../../../../http4s-core/org/http4s/AttributeMap.scala.html#org.http4s;AttributeKey.apply" title="(value: org.http4s.server.ServerSoftware)org.http4s.AttributeEntry[org.http4s.server.ServerSoftware]">ServerSoftware</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.serverSoftware" title="org.http4s.server.ServerSoftware">serverSoftware</a><span class="delimiter">)</span>
      <span class="delimiter">)</span>
    <span class="delimiter">)</span>

  protected def <a title="(req: javax.servlet.http.HttpServletRequest)org.http4s.Headers" id="org.http4s.servlet;Http4sServlet.toHeaders">toHeaders</a><span class="delimiter">(</span><a title="javax.servlet.http.HttpServletRequest" id="org.http4s.servlet;Http4sServlet.toHeaders.req">req</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span><span class="delimiter">)</span>: <a href="../../../../http4s-core/org/http4s/Headers.scala.html#org.http4s;Headers" title="org.http4s.Headers">Headers</a> = <span class="delimiter">{</span>
    val <a title="Iterator[org.http4s.Header.Raw]" id="org.http4s.servlet;Http4sServlet.toHeaders.headers">headers</a> = for <span class="delimiter">{</span>
      <a title="String" id="org.http4s.servlet;Http4sServlet.toHeaders.headers.$anonfun.name">name</a> &lt;- <a href="#org.http4s.servlet;Http4sServlet.toHeaders.req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="(i: java.util.Enumeration[String])scala.collection.convert.Decorators.AsScala[Iterator[String]]">getHeaderNames</span>.<span title="(f: String =&gt; scala.collection.GenTraversableOnce[org.http4s.Header.Raw])Iterator[org.http4s.Header.Raw]">asScala</span>
      <a title="String" id="org.http4s.servlet;Http4sServlet.toHeaders.headers.$anonfun.$anonfun.value">value</a> &lt;- <a href="#org.http4s.servlet;Http4sServlet.toHeaders.req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="(x$1: String)java.util.Enumeration[String]">getHeaders</span><span title="(i: java.util.Enumeration[String])scala.collection.convert.Decorators.AsScala[Iterator[String]]" class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.toHeaders.headers.$anonfun.name" title="String">name</a><span class="delimiter">)</span>.<span title="(f: String =&gt; org.http4s.Header.Raw)Iterator[org.http4s.Header.Raw]">asScala</span>
    <span class="delimiter">}</span> yield <a href="../../../../http4s-core/org/http4s/Header.scala.html#org.http4s.Header.apply" title="(name: String, value: String)org.http4s.Header.Raw">Header</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.toHeaders.headers.$anonfun.name" title="String">name</a>, <a href="#org.http4s.servlet;Http4sServlet.toHeaders.headers.$anonfun.$anonfun.value" title="String">value</a><span class="delimiter">)</span>
    <a href="../../../../http4s-core/org/http4s/Headers.scala.html#org.http4s.Headers.apply(fa7f6a29f7)" title="(headers: org.http4s.Header*)org.http4s.Headers">Headers</a><span class="delimiter">(</span><a href="#org.http4s.servlet;Http4sServlet.toHeaders.headers" title="Iterator[org.http4s.Header.Raw]">headers</a>.<span title="=&gt; Seq[org.http4s.Header.Raw]">toSeq</span> : _*<span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

object <a title="org.http4s.servlet.Http4sServlet.type" id="org.http4s.servlet.Http4sServlet.readResolve">Http4sServlet</a> <a href="#org.http4s.servlet.Http4sServlet.readResolve" title="org.http4s.servlet.Http4sServlet.type" class="delimiter">{</a>
  import scalaz.stream.Process
  import scalaz.concurrent.Task

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> val <a title="org.log4s.Logger" id="org.http4s.servlet.Http4sServlet.logger">logger</a> = <span title="org.log4s.Logger">getLogger</span>

  private<span class="delimiter">[</span>servlet<span class="delimiter">]</span> val <a title="Int" id="org.http4s.servlet.Http4sServlet.DefaultChunkSize">DefaultChunkSize</a> = <span title="Int(4096)" class="int">4096</span>

  private type <a title="javax.servlet.http.HttpServletRequest =&gt; org.http4s.EntityBody" id="org.http4s.servlet.Http4sServlet;BodyReader">BodyReader</a> = HttpServletRequest =&gt; EntityBody

  private def <a title="(chunkSize: Int)(req: javax.servlet.http.HttpServletRequest)org.http4s.EntityBody" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader">asyncInputStreamReader</a><span class="delimiter">(</span><a title="Int" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.chunkSize">chunkSize</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="javax.servlet.http.HttpServletRequest" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.req">req</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span><span class="delimiter">)</span>: <span title="org.http4s.EntityBody">EntityBody</span> = <span class="delimiter">{</span>
    type <a title="scalaz.\/[Throwable,scodec.bits.ByteVector] =&gt; Unit" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader;Callback">Callback</a> = Throwable \/ ByteVector =&gt; Unit
    case object <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader;DataAvailable.productElement.x$1" title="DataAvailable.type" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader;DataAvailable.readResolve">DataAvailable</a>
    case object <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader;AllDataRead.productElement.x$1" title="AllDataRead.type" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader;AllDataRead.readResolve">AllDataRead</a>

    val <a title="javax.servlet.ServletInputStream" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.in">in</a> = <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="()javax.servlet.ServletInputStream">getInputStream</span>

    var <a title="Array[Byte]" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.buff">buff</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span> = null

    var <a title="List[Callback]" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks">callbacks</a>: <span title="List[Callback]">List</span><span class="delimiter">[</span>Callback<span class="delimiter">]</span> = <span title="scala.collection.immutable.Nil.type">Nil</span>

    def <a title="(cb: Callback)Unit" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead">doRead</a><span class="delimiter">(</span><a title="Callback" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.cb">cb</a>: <span title="Callback">Callback</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.buff" title="Array[Byte]">buff</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span> <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.buff" title="Array[Byte]">buff</a> = new <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.chunkSize" title="Int">chunkSize</a><span class="delimiter">)</span>
      val <a title="Int" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.len">len</a> = <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.in" title="javax.servlet.ServletInputStream">in</a>.<span title="(x$1: Array[Byte])Int">read</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.buff" title="Array[Byte]">buff</a><span class="delimiter">)</span>

      val <a title="scodec.bits.ByteVector" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.buffer">buffer</a> = if <span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.len" title="Int">len</a> <span title="(x: Int)Boolean">==</span> <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.chunkSize" title="Int">chunkSize</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        val <a title="scodec.bits.ByteVector" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.buffer.b">b</a> = <span title="scodec.bits.ByteVector.type">ByteVector</span>.<span title="(bytes: Array[Byte])scodec.bits.ByteVector">view</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.buff" title="Array[Byte]">buff</a><span class="delimiter">)</span>
        <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.buff" title="Array[Byte]">buff</a> = null
        <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.buffer.b" title="scodec.bits.ByteVector">b</a>
      <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.len" title="Int">len</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// Need to truncate the array</span>
        val <a title="Array[Byte]" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.buffer.b2">b2</a> = new <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.len" title="Int">len</a><span class="delimiter">)</span>
        <span title="System.type">System</span>.<span title="(x$1: Any, x$2: Int, x$3: Any, x$4: Int, x$5: Int)Unit">arraycopy</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.buff" title="Array[Byte]">buff</a>, <span title="Int(0)" class="int">0</span>, <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.buffer.b2" title="Array[Byte]">b2</a>, <span title="Int(0)" class="int">0</span>, <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.len" title="Int">len</a><span class="delimiter">)</span>
        <span title="scodec.bits.ByteVector.type">ByteVector</span>.<span title="(bytes: Array[Byte])scodec.bits.ByteVector">view</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.buffer.b2" title="Array[Byte]">b2</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> else <span title="scodec.bits.ByteVector.type">ByteVector</span>.<span title="=&gt; scodec.bits.ByteVector">empty</span>

      <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.cb" title="(v1: scalaz.\/[Throwable,scodec.bits.ByteVector])Unit">cb</a><span class="delimiter">(</span><span title="(b: scodec.bits.ByteVector)scalaz.\/-[scodec.bits.ByteVector]">\/-</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead.buffer" title="scodec.bits.ByteVector">buffer</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    if <span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.in" title="javax.servlet.ServletInputStream">in</a>.<span title="()Boolean">isFinished</span><span class="delimiter">)</span> <span title="scalaz.stream.Process.type">Process</span>.<span title="=&gt; scalaz.stream.Process0[Nothing]">halt</span>
    else <span class="delimiter">{</span>
      val <a title="scalaz.concurrent.Actor[Any]" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor">actor</a> = <span title="scalaz.concurrent.Actor.type">Actor</span>.<span title="[A](handler: A =&gt; Unit, onError: Throwable =&gt; Unit)(implicit s: scalaz.concurrent.Strategy)scalaz.concurrent.Actor[A]">actor</span><span title="(handler: Any =&gt; Unit, onError: Throwable =&gt; Unit)(implicit s: scalaz.concurrent.Strategy)scalaz.concurrent.Actor[Any]" class="delimiter">[</span><span title="Any">Any</span><span class="delimiter">]</span> <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.x0$2" title="Unit" class="delimiter">{</a>
        case <a title="Callback" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.cb">cb</a>: <span title="Callback">Callback</span> =&gt;
          if <span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.in" title="javax.servlet.ServletInputStream">in</a>.<span title="()Boolean">isFinished</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#org.http4s.servlet.Http4sServlet.logger" title="org.log4s.Logger">logger</a>.debug<span title="(x$1: String)Unit" class="delimiter">(</span><span title="String(&quot;Finished.&quot;)" class="string">&quot;Finished.&quot;</span><span class="delimiter">)</span>
            <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.cb" title="(v1: scalaz.\/[Throwable,scodec.bits.ByteVector])Unit">cb</a><span class="delimiter">(</span><span title="(a: scalaz.stream.Cause.Terminated)scalaz.-\/[scalaz.stream.Cause.Terminated]">-\/</span><span class="delimiter">(</span><span title="(cause: scalaz.stream.Cause)scalaz.stream.Cause.Terminated">Terminated</span><span class="delimiter">(</span><span title="scalaz.stream.Cause.End.type">End</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          else if <span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.in" title="javax.servlet.ServletInputStream">in</a>.<span title="()Boolean">isReady</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead" title="(cb: Callback)Unit">doRead</a><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.cb" title="Callback">cb</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          else <span class="delimiter">{</span>
            <span class="comment">// Consuming this stream on multiple threads can lead to multiple</span>
            <span class="comment">// callbacks accruing.  We shouldn't ever see this list grow beyond</span>
            <span class="comment">// one, but in the spirit of defensive programming, we'll try to</span>
            <span class="comment">// fulfill them all.</span>
            <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks" title="List[Callback]">callbacks</a> = <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.cb" title="Callback">cb</a> <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.x$1" title="(x: Callback)List[Callback]">::</a> <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks" title="List[Callback]">callbacks</a>
          <span class="delimiter">}</span>

        case <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader;DataAvailable.readResolve" title="DataAvailable.type">DataAvailable</a> =&gt;
          <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks" title="List[Callback]">callbacks</a> match <span class="delimiter">{</span>
            case <a title="Callback" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.head">head</a> :: <a title="List[Callback]" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.losers">losers</a> =&gt;
              <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.doRead" title="(cb: Callback)Unit">doRead</a><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.head" title="Callback">head</a><span class="delimiter">)</span>
              <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.losers" title="List[Callback]">losers</a>.<span title="(f: Callback =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.$anonfun.x$2" title="(v1: scalaz.\/[Throwable,scodec.bits.ByteVector])Unit">_</a><span class="delimiter">(</span><span title="(b: scodec.bits.ByteVector)scalaz.\/-[scodec.bits.ByteVector]">\/-</span><span class="delimiter">(</span><span title="scodec.bits.ByteVector.type">ByteVector</span>.<span title="=&gt; scodec.bits.ByteVector">empty</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks" title="List[Callback]">callbacks</a> = <span title="scala.collection.immutable.Nil.type">Nil</span>
            case _ =&gt;
          <span class="delimiter">}</span>

        case <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader;AllDataRead.readResolve" title="AllDataRead.type">AllDataRead</a> =&gt;
          <a href="#org.http4s.servlet.Http4sServlet.logger" title="org.log4s.Logger">logger</a>.debug<span title="(x$1: String)Unit" class="delimiter">(</span><span title="String(&quot;ReadListener signaled completion&quot;)" class="string">&quot;ReadListener signaled completion&quot;</span><span class="delimiter">)</span>
          if <span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks" title="List[Callback]">callbacks</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks" title="List[Callback]">callbacks</a>.<span title="(f: Callback =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.$anonfun.x$3" title="(v1: scalaz.\/[Throwable,scodec.bits.ByteVector])Unit">_</a><span class="delimiter">(</span><span title="(a: scalaz.stream.Cause.Terminated)scalaz.-\/[scalaz.stream.Cause.Terminated]">-\/</span><span class="delimiter">(</span><span title="(cause: scalaz.stream.Cause)scalaz.stream.Cause.Terminated">Terminated</span><span class="delimiter">(</span><span title="scalaz.stream.Cause.End.type">End</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks" title="List[Callback]">callbacks</a> = <span title="scala.collection.immutable.Nil.type">Nil</span>
          <span class="delimiter">}</span>

        case <a title="Throwable" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.t">t</a>: <span title="Throwable">Throwable</span> =&gt;
          <a href="#org.http4s.servlet.Http4sServlet.logger" title="org.log4s.Logger">logger</a>.error<span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.t" title="Throwable">t</a><span class="delimiter">)</span><span title="(x$1: String, x$2: Throwable)Unit" class="delimiter">(</span><span title="String(&quot;Error during Servlet Async Read&quot;)" class="string">&quot;Error during Servlet Async Read&quot;</span><span class="delimiter">)</span>
          if <span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks" title="List[Callback]">callbacks</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks" title="List[Callback]">callbacks</a>.<span title="(f: Callback =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.$anonfun.x$4" title="(v1: scalaz.\/[Throwable,scodec.bits.ByteVector])Unit">_</a><span class="delimiter">(</span><span title="(a: Throwable)scalaz.-\/[Throwable]">-\/</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor.$anonfun.t" title="Throwable">t</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.callbacks" title="List[Callback]">callbacks</a> = <span title="scala.collection.immutable.Nil.type">Nil</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="comment">// Initialized the listener</span>
      <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.in" title="javax.servlet.ServletInputStream">in</a>.<span title="(x$1: javax.servlet.ReadListener)Unit">setReadListener</span><span class="delimiter">(</span>new <a title="&lt;$anon: javax.servlet.ReadListener&gt; extends Object with javax.servlet.ReadListener" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader;$anon">ReadListener</a> <span class="delimiter">{</span>
        override def <a title="(t: Throwable)Unit" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader;$anon.onError">onError</a><span class="delimiter">(</span><a title="Throwable" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader;$anon.onError.t">t</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor" title="scalaz.concurrent.Actor[Any]">actor</a> <span title="(a: Any)Unit">!</span> <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader;$anon.onError.t" title="Throwable">t</a>
        override def <a title="()Unit" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader;$anon.onDataAvailable">onDataAvailable</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor" title="scalaz.concurrent.Actor[Any]">actor</a> <span title="(a: Any)Unit">!</span> <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader;DataAvailable.readResolve" title="DataAvailable.type">DataAvailable</a>
        override def <a title="()Unit" id="org.http4s.servlet.Http4sServlet.asyncInputStreamReader;$anon.onAllDataRead">onAllDataRead</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor" title="scalaz.concurrent.Actor[Any]">actor</a> <span title="(a: Any)Unit">!</span> <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader;AllDataRead.readResolve" title="AllDataRead.type">AllDataRead</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>

      <span title="scalaz.stream.Process.type">Process</span>.<span title="(f: scalaz.concurrent.Task[scodec.bits.ByteVector])scalaz.stream.Process[scalaz.concurrent.Task,scodec.bits.ByteVector]">repeatEval</span><span class="delimiter">(</span><span title="scalaz.concurrent.Task.type">Task</span>.<span title="[A](register: (scalaz.\/[Throwable,A] =&gt; Unit) =&gt; Unit)scalaz.concurrent.Task[A]">async</span><span title="(register: (scalaz.\/[Throwable,scodec.bits.ByteVector] =&gt; Unit) =&gt; Unit)scalaz.concurrent.Task[scodec.bits.ByteVector]" class="delimiter">[</span><span title="scodec.bits.ByteVector">ByteVector</span><span class="delimiter">]</span> <span class="delimiter">{</span> <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.actor" title="scalaz.concurrent.Actor[Any]">actor</a> <span title="(a: Any)Unit">!</span> <a href="#org.http4s.servlet.Http4sServlet.asyncInputStreamReader.$anonfun.x$5" title="scalaz.\/[Throwable,scodec.bits.ByteVector] =&gt; Unit">_</a> <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  private def <a title="(chunkSize: Int)(req: javax.servlet.http.HttpServletRequest)org.http4s.EntityBody" id="org.http4s.servlet.Http4sServlet.syncInputStreamReader">syncInputStreamReader</a><span class="delimiter">(</span><a title="Int" id="org.http4s.servlet.Http4sServlet.syncInputStreamReader.chunkSize">chunkSize</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="javax.servlet.http.HttpServletRequest" id="org.http4s.servlet.Http4sServlet.syncInputStreamReader.req">req</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span><span class="delimiter">)</span>: <span title="org.http4s.EntityBody">EntityBody</span> =
    <span title="(is: =&gt; java.io.InputStream)scalaz.stream.Channel[scalaz.concurrent.Task,Int,scodec.bits.ByteVector]">chunkR</span><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.syncInputStreamReader.req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="()javax.servlet.ServletInputStream">getInputStream</span><span class="delimiter">)</span>.<span title="(f: (Int =&gt; scalaz.concurrent.Task[scodec.bits.ByteVector]) =&gt; scalaz.concurrent.Task[scodec.bits.ByteVector])scalaz.stream.Process[scalaz.concurrent.Task,scalaz.concurrent.Task[scodec.bits.ByteVector]]">map</span><span title="(self: scalaz.stream.Process[scalaz.concurrent.Task,scalaz.concurrent.Task[scodec.bits.ByteVector]])scalaz.stream.Process.EvalProcess[scalaz.concurrent.Task,scodec.bits.ByteVector]" class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.syncInputStreamReader.$anonfun.x$6" title="(v1: Int)scalaz.concurrent.Task[scodec.bits.ByteVector]">_</a><span class="delimiter">(</span><a href="#org.http4s.servlet.Http4sServlet.syncInputStreamReader.chunkSize" title="Int">chunkSize</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; scalaz.stream.Process[scalaz.concurrent.Task,scodec.bits.ByteVector]">eval</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>http4s-server/org/http4s/server/MockServer.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
package org.http4s
package server


import org.http4s.server.<a href="#org.http4s.server.MockServer" title="org.http4s.server.MockServer.type">MockServer</a>._
import scodec.bits.ByteVector

import scalaz.concurrent.Task

class <a title="class MockServer extends AnyRef" id="org.http4s.server;MockServer">MockServer</a><a href="#org.http4s.server;MockServer" title="org.http4s.server.MockServer" class="delimiter">(</a><a title="org.http4s.server.HttpService" id="org.http4s.server;MockServer.service">service</a>: <a href="Service.scala.html#org.http4s.server;Service" title="org.http4s.server.HttpService">HttpService</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  def <a title="(request: org.http4s.Request)scalaz.concurrent.Task[org.http4s.server.MockServer.MockResponse]" id="org.http4s.server;MockServer.apply">apply</a><span class="delimiter">(</span><a title="org.http4s.Request" id="org.http4s.server;MockServer.apply.request">request</a>: <a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Request" title="org.http4s.Request">Request</a><span class="delimiter">)</span>: <span title="scalaz.concurrent.Task[org.http4s.server.MockServer.MockResponse]">Task</span><span class="delimiter">[</span>MockResponse<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="scalaz.concurrent.Task[org.http4s.server.MockServer.MockResponse]" id="org.http4s.server;MockServer.apply.task">task</a> = for <span class="delimiter">{</span>
      <a title="org.http4s.Response" id="org.http4s.server;MockServer.apply.task.$anonfun.response">response</a> &lt;- try <a href="#org.http4s.server;MockServer.service" title="org.http4s.server.HttpService">service</a>.<a href="Service.scala.html#org.http4s.server;Service.or" title="(a: org.http4s.Request, default: =&gt; scalaz.concurrent.Task[org.http4s.Response])scalaz.concurrent.Task[org.http4s.Response]">or</a><span class="delimiter">(</span><a href="#org.http4s.server;MockServer.apply.request" title="org.http4s.Request">request</a>, <a href="../../../../http4s-core/org/http4s/ResponseBuilder.scala.html#org.http4s.ResponseBuilder" title="org.http4s.ResponseBuilder.type">ResponseBuilder</a>.<a href="../../../../http4s-core/org/http4s/ResponseBuilder.scala.html#org.http4s.ResponseBuilder.notFound" title="(request: org.http4s.Request)scalaz.concurrent.Task[org.http4s.Response]">notFound</a><span class="delimiter">(</span><a href="#org.http4s.server;MockServer.apply.request" title="org.http4s.Request">request</a><span class="delimiter">)</span><span class="delimiter">)</span> catch <span class="delimiter">{</span>
                    case _: <span title="Throwable">Throwable</span>  =&gt; <a href="../../../../http4s-core/org/http4s/ResponseBuilder.scala.html#org.http4s.ResponseBuilder" title="org.http4s.ResponseBuilder.type">ResponseBuilder</a>.<a href="../../../../http4s-core/org/http4s/ResponseBuilder.scala.html#org.http4s.ResponseBuilder.basic" title="(status: org.http4s.Status, headers: org.http4s.Headers, body: org.http4s.EntityBody)scalaz.concurrent.Task[org.http4s.Response]">basic</a><span class="delimiter">(</span><a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s.Status" title="org.http4s.Status.type">Status</a>.<a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s.Status.InternalServerError" title="=&gt; org.http4s.Status">InternalServerError</a><span class="delimiter">)</span>
                  <span class="delimiter">}</span>
      <a title="IndexedSeq[Array[Byte]]" id="org.http4s.server;MockServer.apply.task.$anonfun.$anonfun.body">body</a> &lt;- <a href="#org.http4s.server;MockServer.apply.task.$anonfun.response" title="org.http4s.Response">response</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Response.body" title="=&gt; org.http4s.EntityBody">body</a>.<span title="(pf: PartialFunction[scodec.bits.ByteVector,Array[Byte]])scalaz.stream.Process[scalaz.concurrent.Task,Array[Byte]]">collect</span><a title="&lt;$anon: scodec.bits.ByteVector =&gt; Array[Byte]&gt; extends scala.runtime.AbstractPartialFunction[scodec.bits.ByteVector,Array[Byte]] with Serializable" id="org.http4s.server;MockServer.apply.task.$anonfun;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a> case <a title="scodec.bits.ByteVector" id="org.http4s.server;MockServer.apply.task.$anonfun;$anonfun.isDefinedAt.c">c</a>: <span title="scodec.bits.ByteVector">ByteVector</span> =&gt; <a href="#org.http4s.server;MockServer.apply.task.$anonfun;$anonfun.isDefinedAt.c" title="scodec.bits.ByteVector">c</a>.<span title="=&gt; Array[Byte]">toArray</span> <span class="delimiter">}</span>.<span title="(f: IndexedSeq[Array[Byte]] =&gt; org.http4s.server.MockServer.MockResponse)scalaz.concurrent.Task[org.http4s.server.MockServer.MockResponse]">runLog</span>
    <span class="delimiter">}</span> yield <a href="#org.http4s.server.MockServer.MockResponse.readResolve" title="(statusLine: org.http4s.Status, headers: org.http4s.Headers, body: Array[Byte], attributes: org.http4s.AttributeMap)org.http4s.server.MockServer.MockResponse">MockResponse</a><span class="delimiter">(</span>
      <a href="#org.http4s.server;MockServer.apply.task.$anonfun.response" title="org.http4s.Response">response</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Response.status" title="=&gt; org.http4s.Status">status</a>,
      <a href="#org.http4s.server;MockServer.apply.task.$anonfun.response" title="org.http4s.Response">response</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Response.headers" title="=&gt; org.http4s.Headers">headers</a>,
      <a href="#org.http4s.server;MockServer.apply.task.$anonfun.$anonfun.body" title="IndexedSeq[Array[Byte]]">body</a>.<a href="#org.http4s.server;MockServer.apply.task.$anonfun.$anonfun.$anonfun.xs" title="(implicit asTraversable: Array[Byte] =&gt; scala.collection.GenTraversableOnce[Byte])IndexedSeq[Byte]">flatten</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[Byte])Array[Byte]">toArray</span>,
      <a href="#org.http4s.server;MockServer.apply.task.$anonfun.response" title="org.http4s.Response">response</a>.<a href="../../../../http4s-core/org/http4s/Message.scala.html#org.http4s;Response.attributes" title="=&gt; org.http4s.AttributeMap">attributes</a>
    <span class="delimiter">)</span>

    <a href="#org.http4s.server;MockServer.apply.task" title="scalaz.concurrent.Task[org.http4s.server.MockServer.MockResponse]">task</a>.<span title="(f: PartialFunction[Throwable,org.http4s.server.MockServer.MockResponse])scalaz.concurrent.Task[org.http4s.server.MockServer.MockResponse]">handle</span> <a title="&lt;$anon: Throwable =&gt; org.http4s.server.MockServer.MockResponse&gt; extends scala.runtime.AbstractPartialFunction[Throwable,org.http4s.server.MockServer.MockResponse] with Serializable" id="org.http4s.server;MockServer.apply;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
      case <a title="Throwable" id="org.http4s.server;MockServer.apply;$anonfun.isDefinedAt.e">e</a> =&gt;
        <a href="#org.http4s.server;MockServer.apply;$anonfun.isDefinedAt.e" title="Throwable">e</a>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#org.http4s.server.MockServer.MockResponse.readResolve" title="(statusLine: org.http4s.Status, headers: org.http4s.Headers, body: Array[Byte], attributes: org.http4s.AttributeMap)org.http4s.server.MockServer.MockResponse">MockResponse</a><span class="delimiter">(</span><a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s.Status" title="org.http4s.Status.type">Status</a>.<a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s.Status.InternalServerError" title="=&gt; org.http4s.Status">InternalServerError</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

object <a title="org.http4s.server.MockServer.type" id="org.http4s.server.MockServer">MockServer</a> <a href="#org.http4s.server.MockServer" title="org.http4s.server.MockServer.type" class="delimiter">{</a>
  private<span class="delimiter">[</span>MockServer<span class="delimiter">]</span> val <a title="Array[Byte]" id="org.http4s.server.MockServer.emptyBody">emptyBody</a> = <span title="Array.type">Array</span>.<span title="[T](implicit evidence$1: scala.reflect.ClassTag[T])Array[T]">empty</span><span title="(implicit evidence$1: scala.reflect.ClassTag[Byte])Array[Byte]" class="delimiter">[</span><span title="Byte">Byte</span><span class="delimiter">]</span>   <span class="comment">// Makes direct Response comparison possible</span>

  case class <a title="class MockResponse extends AnyRef with Product with Serializable" id="org.http4s.server.MockServer.MockResponse.readResolve">MockResponse</a><a href="#org.http4s.server.MockServer.MockResponse.readResolve" title="Product" class="delimiter">(</a>
                           <a title="org.http4s.Status" id="org.http4s.server.MockServer.MockResponse.<init>$default$1">statusLine</a>: <a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s;Status" title="org.http4s.Status">Status</a> = <a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s.Status" title="org.http4s.Status.type">Status</a>.<a href="../../../../http4s-core/org/http4s/Status.scala.html#org.http4s.Status.Ok" title="=&gt; org.http4s.Status">Ok</a>,
                           <a title="org.http4s.Headers" id="org.http4s.server.MockServer.MockResponse.<init>$default$2">headers</a>: <a href="../../../../http4s-core/org/http4s/Headers.scala.html#org.http4s;Headers" title="org.http4s.Headers">Headers</a> = <a href="../../../../http4s-core/org/http4s/Headers.scala.html#org.http4s.Headers" title="org.http4s.Headers.type">Headers</a>.<a href="../../../../http4s-core/org/http4s/Headers.scala.html#org.http4s.Headers.empty" title="=&gt; org.http4s.Headers">empty</a>,
                           <a title="Array[Byte]" id="org.http4s.server.MockServer.MockResponse.<init>$default$3">body</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span> = <a href="#org.http4s.server.MockServer.emptyBody" title="=&gt; Array[Byte]">emptyBody</a>,
                           <a title="org.http4s.AttributeMap" id="org.http4s.server.MockServer.MockResponse.<init>$default$4">attributes</a>: <a href="../../../../http4s-core/org/http4s/AttributeMap.scala.html#org.http4s;AttributeMap" title="org.http4s.AttributeMap">AttributeMap</a> = <a href="../../../../http4s-core/org/http4s/AttributeMap.scala.html#org.http4s.AttributeMap" title="org.http4s.AttributeMap.type">AttributeMap</a>.<a href="../../../../http4s-core/org/http4s/AttributeMap.scala.html#org.http4s.AttributeMap.empty" title="=&gt; org.http4s.AttributeMap">empty</a>
                           <span class="delimiter">)</span>
<span class="delimiter">}</span>
        </pre>
    </body>
</html>

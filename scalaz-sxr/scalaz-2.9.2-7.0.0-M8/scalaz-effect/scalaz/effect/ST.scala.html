<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scalaz-effect/scalaz/effect/ST.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz
<span class="keyword">package</span> effect

<span class="keyword">import</span> <a href="World.scala.html#33623" title="object scalaz.effect.IvoryTower">IvoryTower</a>._
<span class="keyword">import</span> <a href="#33560" title="object scalaz.effect.STRef">STRef</a>._
<span class="keyword">import</span> <a href="#33041" title="object scalaz.effect.STArray">STArray</a>._
<span class="keyword">import</span> <a href="#33728" title="object scalaz.effect.ST">ST</a>._
<span class="keyword">import</span> std.<a href="../../../scalaz-core/scalaz/std/Function.scala.html#27447" title="object scalaz.std.function">function</a>._
<span class="keyword">import</span> <a href="../../../scalaz-core/scalaz/Id.scala.html#11827" title="object scalaz.Id">Id</a>._

<span class="comment">/**Mutable variable in state thread S containing a value of type A. http://research.microsoft.com/en-us/um/people/simonpj/papers/lazy-functional-state-threads.ps.Z */</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait STRef[S, A] extends java.lang.Object with ScalaObject" id="33559">STRef</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="33823">S</a>, <a title="&gt;: Nothing &lt;: Any" id="33824">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="=&gt; A" id="488562">value</a>: <a href="#33824" title="A">A</a>

  <span class="comment">/**Reads the value pointed at by this reference. */</span>
  <span class="keyword">def</span> <a title="=&gt; scalaz.effect.ST[S,A]" id="488563">read</a>: <a href="#33727" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#54166" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#488562" title="=&gt; A">value</a><span class="delimiter">)</span>

  <span class="comment">/**Modifies the value at this reference with the given function. */</span>
  <span class="keyword">def</span> <a title="[B](f: A =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="488564">mod</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="488566">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; A" id="489237">f</a>: A =&gt; A<span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">ST</a><span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#54158" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], scalaz.effect.STRef[S,A]))scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">st</a><span class="delimiter">(</span><span class="delimiter">(</span>s: <a href="World.scala.html#33697" title="scalaz.effect.Tower[S]">Tower</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
    <a href="#488562" title="(x$1: A)Unit">value</a> = <a href="#489237" title="(v1: A)A">f</a><span class="delimiter">(</span><a href="#488562" title="=&gt; A">value</a><span class="delimiter">)</span>;
    <span title="(_1: scalaz.effect.Tower[S], _2: scalaz.effect.STRef[S,A])(scalaz.effect.Tower[S], scalaz.effect.STRef[S,A])" class="delimiter">(</span><a href="#494573" title="scalaz.effect.Tower[S]">s</a>, <a href="#33559" title="scalaz.effect.STRef[S,A]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/**Associates this reference with the given value. */</span>
  <span class="keyword">def</span> <a title="(a: =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="488567">write</a><span class="delimiter">(</span><a title="=&gt; A" id="489222">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">ST</a><span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#54158" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], scalaz.effect.STRef[S,A]))scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">st</a><span class="delimiter">(</span><span class="delimiter">(</span>s: <a href="World.scala.html#33697" title="scalaz.effect.Tower[S]">Tower</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
    <a href="#488562" title="(x$1: A)Unit">value</a> = <a href="#489222" title="=&gt; A">a</a>;
    <span title="(_1: scalaz.effect.Tower[S], _2: scalaz.effect.STRef[S,A])(scalaz.effect.Tower[S], scalaz.effect.STRef[S,A])" class="delimiter">(</span><a href="#494586" title="scalaz.effect.Tower[S]">s</a>, <a href="#33559" title="scalaz.effect.STRef[S,A]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/**Synonym for write*/</span>
  <span class="keyword">def</span> <a title="(a: =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="488568">|=</a><span class="delimiter">(</span><a title="=&gt; A" id="494594">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">ST</a><span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#488567" title="(a: =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">write</a><span class="delimiter">(</span><a href="#494594" title="=&gt; A">a</a><span class="delimiter">)</span>

  <span class="comment">/**Swap the value at this reference with the value at another. */</span>
  <span class="keyword">def</span> <a title="(that: scalaz.effect.STRef[S,A])scalaz.effect.ST[S,Unit]" id="488569">swap</a><span class="delimiter">(</span><a title="scalaz.effect.STRef[S,A]" id="494596">that</a>: <a href="#33559" title="scalaz.effect.STRef[S,A]">STRef</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,Unit]">ST</a><span class="delimiter">[</span>S, Unit<span class="delimiter">]</span> = <span class="keyword">for</span> <span class="delimiter">{</span>
    <a title="A" id="494602">v1</a> &lt;- <a href="#33559" title="STRef.this.type" class="keyword">this</a>.<a href="#486890" title="(g: A =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]">read</a>
    <a title="A" id="494606">v2</a> &lt;- <a href="#494596" title="scalaz.effect.STRef[S,A]">that</a>.<a href="#486890" title="(g: A =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]">read</a>
    <a title="scalaz.effect.STRef[S,A]" id="494611">_</a> &lt;- <a href="#33559" title="STRef.this.type" class="keyword">this</a> <a href="#486890" title="(g: scalaz.effect.STRef[S,A] =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]">write</a> <a href="#494606" title="A">v2</a>
    <a title="scalaz.effect.STRef[S,A]" id="494616">_</a> &lt;- <a href="#494596" title="scalaz.effect.STRef[S,A]">that</a> <a href="#486893" title="(g: scalaz.effect.STRef[S,A] =&gt; Unit)scalaz.effect.ST[S,Unit]">write</a> <a href="#494602" title="A">v1</a>
  <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scalaz.effect.STRef" id="33560">STRef</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#33715" title="scalaz.effect.STRefFunctions">STRefFunctions</a> <span class="keyword">with</span> <a href="#33607" title="scalaz.effect.STRefInstances">STRefInstances</a> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[S]=&gt; scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" id="486947">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="486949">S</a><span class="delimiter">]</span>: <span class="delimiter">(</span>Id <a href="../../../scalaz-core/scalaz/NaturalTransformation.scala.html#17343" title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> =
    <a href="#486943" title="[S]=&gt; scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">stRef</a><span title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" class="delimiter">[</span><a href="#486949" title="S">S</a><span class="delimiter">]</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STRefFunctions extends java.lang.Object with ScalaObject" id="33715">STRefFunctions</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[S]=&gt; scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" id="486943">stRef</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="486945">S</a><span class="delimiter">]</span>: <span class="delimiter">(</span>Id <a href="../../../scalaz-core/scalaz/NaturalTransformation.scala.html#17343" title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> = <a href="#494647" title="java.lang.Object with scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" id="494647" class="delimiter">(</a>Id <a href="../../../scalaz-core/scalaz/NaturalTransformation.scala.html#17343" title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: A)java.lang.Object with scalaz.effect.STRef[S,A]" id="494656">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="494658">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="494659">a</a>: <a href="#494658" title="A">A</a><span class="delimiter">)</span> = <a href="#494668" title="java.lang.Object with scalaz.effect.STRef[S,A]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.effect.STRef[S,A]" id="494668">STRef</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="A" id="494673">value</a> = <a href="#494659" title="A">a</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STRefInstances extends java.lang.Object with ScalaObject" id="33607">STRefInstances</a> <span title="ScalaObject" class="delimiter">{</span>
  
  <span class="comment">/**Equality for STRefs is reference equality */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S, A]=&gt; scalaz.Equal[scalaz.effect.STRef[S,A]]" id="486951">STRefEqual</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="486954">S</a>, <a title="&gt;: Nothing &lt;: Any" id="486955">A</a><span class="delimiter">]</span>: <a href="../../../scalaz-core/scalaz/Equal.scala.html#20661" title="scalaz.Equal[scalaz.effect.STRef[S,A]]">Equal</a><span class="delimiter">[</span>STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="../../../scalaz-core/scalaz/Equal.scala.html#20662" title="object scalaz.Equal">Equal</a>.<a href="../../../scalaz-core/scalaz/Equal.scala.html#104211" title="scalaz.Equal[scalaz.effect.STRef[S,A]]">equalA</a> <span class="comment">// todo reference equality?</span>
<span class="delimiter">}</span>

<span class="comment">/**Mutable array in state thread S containing values of type A. */</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait STArray[S, A] extends java.lang.Object with ScalaObject" id="33040">STArray</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="33825">S</a>, <a title="&gt;: Nothing &lt;: Any" id="33826">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="494708">size</a>: <span title="Int">Int</span>
  <span class="keyword">def</span> <a title="=&gt; A" id="494709">z</a>: <a href="#33826" title="A">A</a>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; Manifest[A]" id="494710">manifest</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span>

  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Array[A]" id="494712">value</a>: <span title="Array[A]">Array</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span title="object Array">Array</span>.<span title="(n: Int)(elem: =&gt; A)(implicit evidence$9: scala.reflect.ClassManifest[A])Array[A]">fill</span><span class="delimiter">(</span><a href="#494708" title="=&gt; Int">size</a><span class="delimiter">)</span><a href="#494710" title="=&gt; Manifest[A]" class="delimiter">(</a><a href="#494709" title="=&gt; A">z</a><span class="delimiter">)</span>

  <span class="keyword">import</span> <a href="#33728" title="object scalaz.effect.ST">ST</a>._

  <span class="comment">/**Reads the value at the given index. */</span>
  <span class="keyword">def</span> <a title="(i: Int)scalaz.effect.ST[S,A]" id="494714">read</a><span class="delimiter">(</span><a title="Int" id="494785">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#54166" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#494711" title="(i: Int)A">value</a><span class="delimiter">(</span><a href="#494785" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**Writes the given value to the array, at the given offset. */</span>
  <span class="keyword">def</span> <a title="(i: Int, a: A)scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]" id="494715">write</a><span class="delimiter">(</span><a title="Int" id="494791">i</a>: <span title="Int">Int</span>, <a title="A" id="494792">a</a>: <a href="#33826" title="A">A</a><span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">ST</a><span class="delimiter">[</span>S, STArray<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#54158" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], scalaz.effect.STArray[S,A]))scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="494798">s</a> =&gt; <span class="delimiter">{</span>
    <a href="#494711" title="(i: Int, x: A)Unit">value</a><span class="delimiter">(</span><a href="#494791" title="Int">i</a><span class="delimiter">)</span> = <a href="#494792" title="A">a</a>;
    <span title="(_1: scalaz.effect.Tower[S], _2: scalaz.effect.STArray[S,A])(scalaz.effect.Tower[S], scalaz.effect.STArray[S,A])" class="delimiter">(</span><a href="#494798" title="scalaz.effect.Tower[S]">s</a>, <a href="#33040" title="scalaz.effect.STArray[S,A]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/**Turns a mutable array into an immutable one which is safe to return. */</span>
  <span class="keyword">def</span> <a title="=&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" id="494716">freeze</a>: <a href="#33727" title="scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">ST</a><span class="delimiter">[</span>S, ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#54158" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], scalaz.ImmutableArray[A]))scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="494814">s</a> =&gt; <span title="(_1: scalaz.effect.Tower[S], _2: scalaz.ImmutableArray[A])(scalaz.effect.Tower[S], scalaz.ImmutableArray[A])" class="delimiter">(</span><a href="#494814" title="scalaz.effect.Tower[S]">s</a>, <a href="../../../scalaz-core/scalaz/ImmutableArray.scala.html#10942" title="object scalaz.ImmutableArray">ImmutableArray</a>.<a href="../../../scalaz-core/scalaz/ImmutableArray.scala.html#277617" title="(x: Array[A])scalaz.ImmutableArray[A]">fromArray</a><span class="delimiter">(</span><a href="#494711" title="=&gt; Array[A]">value</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**Fill this array from the given association list. */</span>
  <span class="keyword">def</span> <a title="[B](f: (A, B) =&gt; A, xs: Traversable[(Int, B)])scalaz.effect.ST[S,Unit]" id="494717">fill</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="494719">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, B) =&gt; A" id="494825">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; A, <a title="Traversable[(Int, B)]" id="494826">xs</a>: <span title="Traversable[(Int, B)]">Traversable</span><span class="delimiter">[</span><span class="delimiter">(</span>Int, B<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,Unit]">ST</a><span class="delimiter">[</span>S, Unit<span class="delimiter">]</span> = <a href="#494826" title="Traversable[(Int, B)]">xs</a> <span title="scalaz.effect.ST[S,Unit]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="scalaz.effect.ST[S,Unit]">Nil</span>             =&gt; <a href="#54166" title="(a: =&gt; Unit)scalaz.effect.ST[S,Unit]">returnST</a><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="scalaz.effect.ST[S,Unit]" class="delimiter">(</span><span class="delimiter">(</span><a title="Int" id="494843">i</a>, <a title="B" id="494844">v</a><span class="delimiter">)</span> :: <a title="List[(Int, B)]" id="494845">ivs</a><span class="delimiter">)</span> =&gt; <span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="Unit" id="494879">_</a> &lt;- <a href="#494720" title="(f: (A, B) =&gt; A, i: Int, v: B)scalaz.effect.ST[S,Unit]">update</a><a href="#486890" title="(g: Unit =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#494825" title="(A, B) =&gt; A">f</a>, <a href="#494843" title="Int">i</a>, <a href="#494844" title="B">v</a><span class="delimiter">)</span>
      <a title="Unit" id="494898">_</a> &lt;- <a href="#494717" title="(f: (A, B) =&gt; A, xs: Traversable[(Int, B)])scalaz.effect.ST[S,Unit]">fill</a><a href="#486893" title="(g: Unit =&gt; Unit)scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#494825" title="(A, B) =&gt; A">f</a>, <a href="#494845" title="List[(Int, B)]">ivs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**Combine the given value with the value at the given index, using the given function. */</span>
  <span class="keyword">def</span> <a title="[B](f: (A, B) =&gt; A, i: Int, v: B)scalaz.effect.ST[S,Unit]" id="494720">update</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="494722">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, B) =&gt; A" id="494846">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; A, <a title="Int" id="494847">i</a>: <span title="Int">Int</span>, <a title="B" id="494848">v</a>: <a href="#494722" title="B">B</a><span class="delimiter">)</span> = <span class="keyword">for</span> <span class="delimiter">{</span>
    <a title="A" id="494855">x</a> &lt;- <a href="#494714" title="(i: Int)scalaz.effect.ST[S,A]">read</a><a href="#486890" title="(g: A =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#494847" title="Int">i</a><span class="delimiter">)</span>
    <a title="scalaz.effect.STArray[S,A]" id="494862">_</a> &lt;- <a href="#494715" title="(i: Int, a: A)scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">write</a><a href="#486893" title="(g: scalaz.effect.STArray[S,A] =&gt; Unit)scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#494847" title="Int">i</a>, <a href="#494846" title="(v1: A, v2: B)A">f</a><span class="delimiter">(</span><a href="#494855" title="A">x</a>, <a href="#494848" title="B">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scalaz.effect.STArray" id="33041">STArray</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#33679" title="scalaz.effect.STArrayFunctions">STArrayFunctions</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]" id="486937">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="486940">S</a>, <a title="&gt;: Nothing &lt;: Any" id="486941">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="494902">s</a>: <span title="Int">Int</span>, <a title="A" id="494903">a</a>: <a href="#486941" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Manifest[A]" id="494904">m</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#33040" title="scalaz.effect.STArray[S,A]">STArray</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#486931" title="(s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]">stArray</a><a href="#494904" title="Manifest[A]" class="delimiter">(</a><a href="#494902" title="Int">s</a>, <a href="#494903" title="A">a</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STArrayFunctions extends java.lang.Object with ScalaObject" id="33679">STArrayFunctions</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]" id="486931">stArray</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="486934">S</a>, <a title="&gt;: Nothing &lt;: Any" id="486935">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="494909">s</a>: <span title="Int">Int</span>, <a title="A" id="494910">a</a>: <a href="#486935" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Manifest[A]" id="494911">m</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#33040" title="scalaz.effect.STArray[S,A]">STArray</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#494945" title="java.lang.Object with scalaz.effect.STArray[S,A]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.effect.STArray[S,A]" id="494945">STArray</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="494949">size</a> = <a href="#494909" title="Int">s</a>
    <span class="keyword">val</span> <a title="A" id="494951">z</a> = <a href="#494910" title="A">a</a>
    <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="Manifest[A]" id="494953">manifest</a> = <a href="#494911" title="Manifest[A]">m</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Purely functional mutable state threads.
 * Based on JL and SPJ's paper &quot;Lazy Functional State Threads&quot;
 */</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait ST[S, A] extends java.lang.Object with ScalaObject" id="33727">ST</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="33827">S</a>, <a title="&gt;: Nothing &lt;: Any" id="33828">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">private</span><span class="delimiter">[</span>effect<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)" id="486888">apply</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="494959">s</a>: <a href="World.scala.html#33697" title="scalaz.effect.Tower[S]">Tower</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(scalaz.effect.Tower[S], A)" class="delimiter">(</span>Tower<span class="delimiter">[</span>S<span class="delimiter">]</span>, A<span class="delimiter">)</span>

  <span class="keyword">import</span> <a href="#33728" title="object scalaz.effect.ST">ST</a>._

  <span class="keyword">def</span> <a title="[B](g: A =&gt; scalaz.effect.ST[S,B])scalaz.effect.ST[S,B]" id="486890">flatMap</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="486892">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; scalaz.effect.ST[S,B]" id="489241">g</a>: A =&gt; ST<span class="delimiter">[</span>S, B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,B]">ST</a><span class="delimiter">[</span>S, B<span class="delimiter">]</span> =
    <a href="#54158" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], B))scalaz.effect.ST[S,B]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="494965">s</a> =&gt; <a href="#486888" title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)">apply</a><span class="delimiter">(</span><a href="#494965" title="scalaz.effect.Tower[S]">s</a><span class="delimiter">)</span> <span title="(scalaz.effect.Tower[S], B)" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="(scalaz.effect.Tower[S], B)" class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="494968">ns</a>, <a title="A" id="494969">a</a><span class="delimiter">)</span> =&gt; <a href="#489241" title="(v1: A)scalaz.effect.ST[S,B]">g</a><a href="#486888" title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], B)" class="delimiter">(</a><a href="#494969" title="A">a</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#494968" title="scalaz.effect.Tower[S]">ns</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[B](g: A =&gt; B)scalaz.effect.ST[S,B]" id="486893">map</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="486895">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; B" id="489225">g</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,B]">ST</a><span class="delimiter">[</span>S, B<span class="delimiter">]</span> =
    <a href="#54158" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], B))scalaz.effect.ST[S,B]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="494976">s</a> =&gt; <a href="#486888" title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)">apply</a><span class="delimiter">(</span><a href="#494976" title="scalaz.effect.Tower[S]">s</a><span class="delimiter">)</span> <span title="(scalaz.effect.Tower[S], B)" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="(scalaz.effect.Tower[S], B)" class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="494979">ns</a>, <a title="A" id="494980">a</a><span class="delimiter">)</span> =&gt; <span title="(_1: scalaz.effect.Tower[S], _2: B)(scalaz.effect.Tower[S], B)" class="delimiter">(</span><a href="#494979" title="scalaz.effect.Tower[S]">ns</a>, <a href="#489225" title="(v1: A)B">g</a><span class="delimiter">(</span><a href="#494980" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scalaz.effect.ST" id="33728">ST</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#33706" title="scalaz.effect.STFunctions">STFunctions</a> <span class="keyword">with</span> <a href="#33340" title="scalaz.effect.STInstances">STInstances</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](a: =&gt; A)scalaz.effect.ST[S,A]" id="54195">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54198">S</a>, <a title="&gt;: Nothing &lt;: Any" id="54199">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="494990">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> =
    <a href="#54166" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#494990" title="=&gt; A">a</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STFunctions extends java.lang.Object with ScalaObject" id="33706">STFunctions</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], A))scalaz.effect.ST[S,A]" id="54158">st</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54161">S</a>, <a title="&gt;: Nothing &lt;: Any" id="54162">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], A)" id="489151">f</a>: Tower<span class="delimiter">[</span>S<span class="delimiter">]</span> =&gt; <span class="delimiter">(</span>Tower<span class="delimiter">[</span>S<span class="delimiter">]</span>, A<span class="delimiter">)</span><span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#494999" title="java.lang.Object with scalaz.effect.ST[S,A]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.effect.ST[S,A]" id="494999">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">private</span><span class="delimiter">[</span>effect<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)" id="495003">apply</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="495004">s</a>: <a href="World.scala.html#33697" title="scalaz.effect.Tower[S]">Tower</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#489151" title="(v1: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)">f</a><span class="delimiter">(</span><a href="#495004" title="scalaz.effect.Tower[S]">s</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">// Implicit conversions between IO and ST</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](st: scalaz.effect.ST[scalaz.effect.IvoryTower,A])scalaz.effect.IO[A]" id="54163">STToIO</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54165">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.effect.ST[scalaz.effect.IvoryTower,A]" id="486971">st</a>: <a href="#33727" title="scalaz.effect.ST[scalaz.effect.IvoryTower,A]">ST</a><span class="delimiter">[</span>IvoryTower, A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="IO.scala.html#33115" title="scalaz.effect.IO[A]">IO</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="IO.scala.html#33116" title="object scalaz.effect.IO">IO</a>.<a href="IO.scala.html#54102" title="(f: scalaz.effect.Tower[scalaz.effect.IvoryTower] =&gt; scalaz.Free.Trampoline[(scalaz.effect.Tower[scalaz.effect.IvoryTower], A)])scalaz.effect.IO[A]">io</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[scalaz.effect.IvoryTower]" id="495014">rw</a> =&gt; <a href="../../../scalaz-core/scalaz/Free.scala.html#23599" title="object scalaz.Free">Free</a>.<a href="../../../scalaz-core/scalaz/Free.scala.html#54389" title="(value: =&gt; (scalaz.effect.Tower[scalaz.effect.IvoryTower], A))(implicit S: scalaz.Applicative[Function0])scalaz.Free[Function0,(scalaz.effect.Tower[scalaz.effect.IvoryTower], A)]">return_</a><a href="../../../scalaz-core/scalaz/std/Function.scala.html#54464" title="function0Instance extends java.lang.Object with scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Comonad[Function0] with scalaz.Distributive[Function0]" class="delimiter">(</a><a href="#486888" title="(s: scalaz.effect.Tower[scalaz.effect.IvoryTower])(scalaz.effect.Tower[scalaz.effect.IvoryTower], A)">st</a><span class="delimiter">(</span><a href="#495014" title="scalaz.effect.Tower[scalaz.effect.IvoryTower]">rw</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**Put a value in a state thread */</span>
  <span class="keyword">def</span> <a title="[S, A](a: =&gt; A)scalaz.effect.ST[S,A]" id="54166">returnST</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54169">S</a>, <a title="&gt;: Nothing &lt;: Any" id="54170">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="494562">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> =
    <a href="#54158" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], A))scalaz.effect.ST[S,A]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="495062">s</a> =&gt; <span title="(_1: scalaz.effect.Tower[S], _2: A)(scalaz.effect.Tower[S], A)" class="delimiter">(</span><a href="#495062" title="scalaz.effect.Tower[S]">s</a>, <a href="#494562" title="=&gt; A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**Run a state thread */</span>
  <span class="keyword">def</span> <a title="[A](f: scalaz.Forall[[S]scalaz.effect.ST[S,A]])A" id="54171">runST</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54173">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.Forall[[S]scalaz.effect.ST[S,A]]" id="495070">f</a>: <a href="../../../scalaz-core/scalaz/Forall.scala.html#19638" title="scalaz.Forall[[S]scalaz.effect.ST[S,A]]">Forall</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>S<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#54173" title="A">A</a> =
    <a href="#495070" title="scalaz.Forall[[S]scalaz.effect.ST[S,A]]">f</a>.<a href="../../../scalaz-core/scalaz/Forall.scala.html#284424" title="scalaz.effect.ST[scalaz.effect.IvoryTower,A]">apply</a>.<a href="#486888" title="(s: scalaz.effect.Tower[scalaz.effect.IvoryTower])(scalaz.effect.Tower[scalaz.effect.IvoryTower], A)">apply</a><span class="delimiter">(</span><a href="World.scala.html#54255" title="=&gt; scalaz.effect.Tower[scalaz.effect.IvoryTower]">ivoryTower</a><span class="delimiter">)</span>.<span title="=&gt; A">_2</span>

  <span class="comment">/**Allocates a fresh mutable reference. */</span>
  <span class="keyword">def</span> <a title="[S]=&gt; scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]" id="54174">newVar</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54176">S</a><span class="delimiter">]</span>: <span class="delimiter">(</span>Id <a href="../../../scalaz-core/scalaz/NaturalTransformation.scala.html#17343" title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> = <a href="#495086" title="java.lang.Object with scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]" id="495086" class="delimiter">(</a>Id <a href="../../../scalaz-core/scalaz/NaturalTransformation.scala.html#17343" title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="495095">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="495097">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="495098">a</a>: <a href="#495097" title="A">A</a><span class="delimiter">)</span> = <a href="#54166" title="(a: =&gt; scalaz.effect.STRef[S,A])scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">returnST</a><span class="delimiter">(</span><a href="#486943" title="[S]=&gt; scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">stRef</a><a href="../../../scalaz-core/scalaz/NaturalTransformation.scala.html#142794" title="(fa: scalaz.Id.Id[A])scalaz.effect.STRef[S,A]" class="delimiter">[</a><a href="#54176" title="S">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#495098" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**Allocates a fresh mutable array. */</span>
  <span class="keyword">def</span> <a title="[S, A](size: Int, z: A)(implicit evidence$1: Manifest[A])scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]" id="495128">newArr</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54180">S</a>, <a title="&gt;: Nothing &lt;: Any" id="54181">A</a>: Manifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="495126">size</a>: <span title="Int">Int</span>, <a title="A" id="495127">z</a>: <a href="#54181" title="A">A</a><span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">ST</a><span class="delimiter">[</span>S, STArray<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#54166" title="(a: =&gt; scalaz.effect.STArray[S,A])scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">returnST</a><span class="delimiter">(</span><a href="#486931" title="[S, A](s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]">stArray</a><span title="(s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]" class="delimiter">[</span><a href="#54180" title="S">S</a>, <a href="#54181" title="A">A</a><span class="delimiter">]</span><a href="#495128" title="Manifest[A]" class="delimiter">(</a><a href="#495126" title="Int">size</a>, <a href="#495127" title="A">z</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**Allows the result of a state transformer computation to be used lazily inside the computation. */</span>
  <span class="keyword">def</span> <a title="[S, A](k: =&gt; A =&gt; scalaz.effect.ST[S,A])scalaz.effect.ST[S,A]" id="54182">fixST</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54185">S</a>, <a title="&gt;: Nothing &lt;: Any" id="54186">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A =&gt; scalaz.effect.ST[S,A]" id="495157">k</a>: <span class="delimiter">(</span>=&gt; A<span class="delimiter">)</span> =&gt; ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#54158" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], A))scalaz.effect.ST[S,A]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="495164">s</a> =&gt; <span class="delimiter">{</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="(scalaz.effect.Tower[S], A)" id="495166">ans</a>: <span title="(scalaz.effect.Tower[S], A)" class="delimiter">(</span>Tower<span class="delimiter">[</span>S<span class="delimiter">]</span>, A<span class="delimiter">)</span> = <a href="#495157" title="(v1: =&gt; A)scalaz.effect.ST[S,A]">k</a><a href="#486888" title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)" class="delimiter">(</a><a href="#495167" title="=&gt; A">r</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#495164" title="scalaz.effect.Tower[S]">s</a><span class="delimiter">)</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a href="#495172" title="A" id="495168" class="delimiter">(</a>_, <a title="A" id="495172">r</a><span class="delimiter">)</span> = <a href="#495165" title="=&gt; (scalaz.effect.Tower[S], A)">ans</a>
    <a href="#495165" title="=&gt; (scalaz.effect.Tower[S], A)">ans</a>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/**Accumulates an integer-associated list into an immutable array. */</span>
  <span class="keyword">def</span> <a title="[F[_], A, B](size: Int, f: (A, B) =&gt; A, z: A, ivs: F[(Int, B)])(implicit F: scalaz.Foldable[F], implicit mf: Manifest[A])scalaz.ImmutableArray[A]" id="54187">accumArray</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="54191">F</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="495182">_</a><span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: Any" id="54192">A</a>, <a title="&gt;: Nothing &lt;: Any" id="54193">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="495175">size</a>: <span title="Int">Int</span>, <a title="(A, B) =&gt; A" id="495176">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; A, <a title="A" id="495177">z</a>: <a href="#54192" title="A">A</a>, <a title="F[(Int, B)]" id="495178">ivs</a>: <a href="#54191" title="F[(Int, B)]">F</a><span class="delimiter">[</span><span class="delimiter">(</span>Int, B<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[F]" id="495179">F</a>: <a href="../../../scalaz-core/scalaz/Foldable.scala.html#21378" title="scalaz.Foldable[F]">Foldable</a><span class="delimiter">[</span>F<span class="delimiter">]</span>, <a title="Manifest[A]" id="495180">mf</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../scalaz-core/scalaz/ImmutableArray.scala.html#10941" title="scalaz.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> std.<a href="../../../scalaz-core/scalaz/std/AnyVal.scala.html#28062" title="object scalaz.std.anyVal">anyVal</a>.unitInstance
    <span class="keyword">type</span> <a title="[S]scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" id="495190">STA</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="495191">S</a><span class="delimiter">]</span> = <a href="#33727" title="scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">ST</a><span class="delimiter">[</span>S, ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>
    <a href="#54171" title="(f: scalaz.Forall[[S]scalaz.effect.ST[S,scalaz.ImmutableArray[A]]])scalaz.ImmutableArray[A]">runST</a><span class="delimiter">(</span><a href="#495194" title="java.lang.Object with scalaz.Forall[STA]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.Forall[STA]" id="495194">Forall</a><span class="delimiter">[</span>STA<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="[S]=&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" id="495198">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="495200">S</a><span class="delimiter">]</span> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="scalaz.effect.STArray[S,A]" id="495235">a</a> &lt;- <a href="#495128" title="(size: Int, z: A)(implicit evidence$1: Manifest[A])scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">newArr</a><a href="#486890" title="(g: scalaz.effect.STArray[S,A] =&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]])scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" class="delimiter">(</a><a href="#495175" title="Int">size</a>, <a href="#495177" title="A">z</a><span class="delimiter">)</span>
        <a title="Unit" id="495289">_</a> &lt;- <span class="delimiter">{</span>
          <a href="#495179" title="scalaz.Foldable[F]">F</a>.<a href="../../../scalaz-core/scalaz/Foldable.scala.html#43990" title="(fa: F[(Int, B)])(f: ((Int, B)) =&gt; scalaz.effect.ST[S,Unit])(implicit F: scalaz.Monoid[scalaz.effect.ST[S,Unit]])scalaz.effect.ST[S,Unit]">foldMap</a><span class="delimiter">(</span><a href="#495178" title="F[(Int, B)]">ivs</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span>x: <span title="(Int, B)" class="delimiter">(</span>Int, B<span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#495235" title="scalaz.effect.STArray[S,A]">a</a>.<a href="#494720" title="(f: (A, B) =&gt; A, i: Int, v: B)scalaz.effect.ST[S,Unit]">update</a><span class="delimiter">(</span><a href="#495176" title="(A, B) =&gt; A">f</a>, <a href="#495250" title="(Int, B)">x</a>.<span title="=&gt; Int">_1</span>, <a href="#495250" title="(Int, B)">x</a>.<span title="=&gt; B">_2</span><span class="delimiter">)</span><span class="delimiter">)</span><a href="#486890" title="(g: Unit =&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]])scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" class="delimiter">(</a><a href="#54207" title="[S, A](implicit A: scalaz.Monoid[A])scalaz.Monoid[scalaz.effect.ST[S,A]]">stMonoid</a><a href="../../../scalaz-core/scalaz/std/AnyVal.scala.html#55611" title="(implicit A: scalaz.Monoid[Unit])scalaz.Monoid[scalaz.effect.ST[S,Unit]]" class="delimiter">[</a><a href="#495200" title="S">S</a>, <span title="Unit">Unit</span><span class="delimiter">]</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a title="scalaz.ImmutableArray[A]" id="495294">frozen</a> &lt;- <a href="#495235" title="scalaz.effect.STArray[S,A]">a</a>.<a href="#486893" title="(g: scalaz.ImmutableArray[A] =&gt; scalaz.ImmutableArray[A])scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">freeze</a>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#495294" title="scalaz.ImmutableArray[A]">frozen</a>
    <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STInstance0 extends java.lang.Object with ScalaObject" id="33034">STInstance0</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S, A](implicit A: scalaz.Semigroup[A])scalaz.Semigroup[scalaz.effect.ST[S,A]]" id="54201">stSemigroup</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54204">S</a>, <a title="&gt;: Nothing &lt;: Any" id="54205">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Semigroup[A]" id="486968">A</a>: <a href="../../../scalaz-core/scalaz/Semigroup.scala.html#20979" title="scalaz.Semigroup[A]">Semigroup</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../scalaz-core/scalaz/Semigroup.scala.html#20979" title="scalaz.Semigroup[scalaz.effect.ST[S,A]]">Semigroup</a><span class="delimiter">[</span>ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
      <a href="../../../scalaz-core/scalaz/Monoid.scala.html#19696" title="object scalaz.Monoid">Monoid</a>.<a href="../../../scalaz-core/scalaz/Monoid.scala.html#58700" title="[F[_], M](implicit F0: scalaz.Applicative[F], implicit M0: scalaz.Semigroup[M])scalaz.Semigroup[F[M]]">liftSemigroup</a><span title="(implicit F0: scalaz.Applicative[[α]scalaz.effect.ST[S,α]], implicit M0: scalaz.Semigroup[A])scalaz.Semigroup[scalaz.effect.ST[S,A]]" class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#<a href="#33727" title="[α]scalaz.effect.ST[S,α]">λ</a>, <a href="#54205" title="A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#33728" title="object scalaz.effect.ST">ST</a>.<a href="#54212" title="[S]=&gt; scalaz.Monad[[α]scalaz.effect.ST[S,α]]">stMonad</a><span title="scalaz.Monad[[α]scalaz.effect.ST[S,α]]" class="delimiter">[</span><a href="#54204" title="S">S</a><span class="delimiter">]</span>, <a href="#486968" title="scalaz.Semigroup[A]">A</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STInstances extends java.lang.Object with scalaz.effect.STInstance0 with ScalaObject" id="33340">STInstances</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#33034" title="scalaz.effect.STInstance0">STInstance0</a> <span class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S, A](implicit A: scalaz.Monoid[A])scalaz.Monoid[scalaz.effect.ST[S,A]]" id="54207">stMonoid</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54210">S</a>, <a title="&gt;: Nothing &lt;: Any" id="54211">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Monoid[A]" id="486965">A</a>: <a href="../../../scalaz-core/scalaz/Monoid.scala.html#19695" title="scalaz.Monoid[A]">Monoid</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../scalaz-core/scalaz/Monoid.scala.html#19695" title="scalaz.Monoid[scalaz.effect.ST[S,A]]">Monoid</a><span class="delimiter">[</span>ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="../../../scalaz-core/scalaz/Monoid.scala.html#19696" title="object scalaz.Monoid">Monoid</a>.<a href="../../../scalaz-core/scalaz/Monoid.scala.html#58705" title="[F[_], M](implicit F0: scalaz.Applicative[F], implicit M0: scalaz.Monoid[M])scalaz.Monoid[F[M]]">liftMonoid</a><span title="(implicit F0: scalaz.Applicative[[α]scalaz.effect.ST[S,α]], implicit M0: scalaz.Monoid[A])scalaz.Monoid[scalaz.effect.ST[S,A]]" class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#<a href="#33727" title="[α]scalaz.effect.ST[S,α]">λ</a>, <a href="#54211" title="A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#54212" title="[S]=&gt; scalaz.Monad[[α]scalaz.effect.ST[S,α]]">stMonad</a><span title="scalaz.Monad[[α]scalaz.effect.ST[S,α]]" class="delimiter">[</span><a href="#54210" title="S">S</a><span class="delimiter">]</span>, <a href="#486965" title="scalaz.Monoid[A]">A</a><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S]=&gt; scalaz.Monad[[α]scalaz.effect.ST[S,α]]" id="54212">stMonad</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="54214">S</a><span class="delimiter">]</span>: <a href="../../../scalaz-core/scalaz/Monad.scala.html#22710" title="scalaz.Monad[[α]scalaz.effect.ST[S,α]]">Monad</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">]</span> = <a href="#495337" title="java.lang.Object with scalaz.Monad[[α]scalaz.effect.ST[S,α]]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.Monad[[α]scalaz.effect.ST[S,α]]" id="495337">Monad</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: =&gt; A)scalaz.effect.ST[S,A]" id="495383">point</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="495385">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="495391">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#54166" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#495391" title="=&gt; A">a</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[A, B](fa: scalaz.effect.ST[S,A])(f: A =&gt; scalaz.effect.ST[S,B])scalaz.effect.ST[S,B]" id="495386">bind</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="495389">A</a>, <a title="&gt;: Nothing &lt;: Any" id="495390">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.effect.ST[S,A]" id="495397">fa</a>: <a href="#33727" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="A =&gt; scalaz.effect.ST[S,B]" id="495398">f</a>: A =&gt; ST<span class="delimiter">[</span>S, B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#33727" title="scalaz.effect.ST[S,B]">ST</a><span class="delimiter">[</span>S, B<span class="delimiter">]</span> = <a href="#495397" title="scalaz.effect.ST[S,A]">fa</a> <a href="#486890" title="(g: A =&gt; scalaz.effect.ST[S,B])scalaz.effect.ST[S,B]">flatMap</a> <a href="#495398" title="A =&gt; scalaz.effect.ST[S,B]">f</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>core/Rope.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz

<span class="keyword">import</span> collection.IndexedSeqLike
<span class="keyword">import</span> collection.immutable.IndexedSeq
<span class="keyword">import</span> collection.mutable.Builder
<span class="keyword">import</span> collection.generic.CanBuildFrom

<span class="keyword">import</span> syntax.Ops
<span class="keyword">import</span> scalaz.<span class="delimiter">{</span>ImmutableArray =&gt; IA<span class="delimiter">}</span>
<span class="keyword">import</span> std.<a href="std/AnyVal.scala.html#24509" title="scalaz.std.anyVal.type">anyVal</a>._
<span class="keyword">import</span> <a href="FingerTree.scala.html#16563" title="scalaz.FingerTree.type">FingerTree</a>._

/**
  * Ropes or 'heavyweight Strings' are an alternative to Strings.
  * In essence they are binary trees whose leaves are arrays of characters.
  * Their advantage over ordinary strings is support for efficient concatenation and substring operations,
  * which scale to long strings.
  *
  * They were first described in the paper: Ropes: an Alternative to Strings.
  * by Hans-J. Boehm , Russ Atkinson , Michael Plass
  *
  * @see [[http://citeseer.ist.psu.edu/viewdoc/download?doi=10.1.1.14.9450&amp;rep=rep1&amp;type=pdf]]
  */
<span class="keyword">sealed</span> <span class="keyword">class</span> <a title="class Rope[A] extends AnyRef with scalaz.syntax.Ops[scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]]" id="20057">Rope</a><span class="delimiter">[</span><a title="" id="23672">A</a> : ClassManifest<span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">val</span> <a title="scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]" id="415038">self</a>: Rope.<a href="FingerTree.scala.html#16562" title="scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">FingerTreeIntPlus</a><span class="delimiter">[</span>ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="keyword">extends</span> <a href="syntax/Ops.scala.html#28399" title="scalaz.syntax.Ops[scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]]">Ops</a><span class="delimiter">[</span>Rope.FingerTreeIntPlus<span class="delimiter">[</span>ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#20058" title="scalaz.Rope.type">Rope</a>._
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; scalaz.Reducer[scalaz.ImmutableArray[A],Int]" id="415022">sizer</a> = <a href="Reducer.scala.html#150707" title="(u: scalaz.ImmutableArray[A] =&gt; Int)(implicit mm: scalaz.Monoid[Int])scalaz.Reducer[scalaz.ImmutableArray[A],Int]">UnitReducer</a><a href="std/AnyVal.scala.html#45716" title="=&gt; scalaz.Monoid[Int] with scalaz.Enum[Int] with scalaz.Show[Int]" class="delimiter">(</a><span class="delimiter">(</span>arr: <a href="ImmutableArray.scala.html#9065" title="scalaz.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <a href="#415049" title="scalaz.ImmutableArray[A]">arr</a>.<a href="ImmutableArray.scala.html#358286" title="=&gt; Int">length</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="415023">length</a>: <span title="Int">Int</span> = <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100360" title="=&gt; Int">measure</a>

  <span class="keyword">def</span> <a title="(i: Int)A" id="415024">apply</a><span class="delimiter">(</span><a title="Int" id="415070">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#23672" title="A">A</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a href="#1680299" title="(x: (scalaz.FingerTree[Int,scalaz.ImmutableArray[A]], scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]))(scalaz.FingerTree[Int,scalaz.ImmutableArray[A]], scalaz.FingerTree[Int,scalaz.ImmutableArray[A]])" class="delimiter">(</a><a href="#1680297" title="scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]" id="415073">right</a>, <a href="#1680297" title="scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]" id="415074">left</a><span class="delimiter">)</span> = <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100391" title="(pred: Int =&gt; Boolean)(scalaz.FingerTree[Int,scalaz.ImmutableArray[A]], scalaz.FingerTree[Int,scalaz.ImmutableArray[A]])">split</a><a href="#1680297" title="(scalaz.FingerTree[Int,scalaz.ImmutableArray[A]], scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]) @unchecked" class="delimiter">(</a><a href="#415077" title="Int">_</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#415070" title="Int">i</a><span class="delimiter">)</span>
    <a href="#415074" title="scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">left</a>.<a href="FingerTree.scala.html#100395" title="=&gt; scalaz.ViewL[[α]scalaz.FingerTree[Int,α],scalaz.ImmutableArray[A]]">viewl</a>.<a href="FingerTree.scala.html#149630" title="=&gt; Option[scalaz.ImmutableArray[A]]">headOption</a>.<span title="(default: =&gt; scalaz.ImmutableArray[A])scalaz.ImmutableArray[A]">getOrElse</span><a href="ImmutableArray.scala.html#358285" title="(index: Int)A" class="delimiter">(</a>sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;Index &quot;)" class="string">&quot;Index &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#415070" title="Int">i</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &gt; &quot;)" class="string">&quot; &gt; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100360" title="=&gt; Int">measure</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#415070" title="Int">i</a> <span title="(x: Int)Int">-</span> <a href="#415073" title="scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">right</a>.<a href="FingerTree.scala.html#100360" title="=&gt; Int">measure</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /**Concatenates two Ropes. `(O lg min(r1, r2))` where `r1` and `r2` are their sizes. */
  <span class="keyword">def</span> <a title="(xs: scalaz.Rope[A])scalaz.Rope[A]" id="415025">++</a><span class="delimiter">(</span><a title="scalaz.Rope[A]" id="415151">xs</a>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a><a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a> <a href="FingerTree.scala.html#100377" title="(right: scalaz.FingerTree[Int,scalaz.ImmutableArray[A]])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">&lt;++&gt;</a> <a href="#415151" title="scalaz.Rope[A]">xs</a>.<a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a><span class="delimiter">)</span>

  /**Appends the given chunk to the rope*/
  <span class="keyword">def</span> <a title="(chunk: scalaz.ImmutableArray[A])scalaz.Rope[A]" id="415026">::+</a><span class="delimiter">(</span><a title="scalaz.ImmutableArray[A]" id="415168">chunk</a>: <a href="ImmutableArray.scala.html#9065" title="scalaz.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <span title="scalaz.Rope[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#415168" title="scalaz.ImmutableArray[A]">chunk</a>.<a href="ImmutableArray.scala.html#358287" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
      <a href="#20057" title="scalaz.Rope[A]" class="keyword">this</a>
    <span class="keyword">else</span>
      <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a>
        <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100396" title="=&gt; scalaz.ViewR[[α]scalaz.FingerTree[Int,α],scalaz.ImmutableArray[A]]">viewr</a>.<a href="FingerTree.scala.html#258807" title="(b: =&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]], f: (=&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]], =&gt; scalaz.ImmutableArray[A]) =&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">fold</a><span class="delimiter">(</span>
          <a href="FingerTree.scala.html#100317" title="(a: =&gt; scalaz.ImmutableArray[A])(implicit ms: scalaz.Reducer[scalaz.ImmutableArray[A],Int])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">single</a><span class="delimiter">(</span><a href="#415168" title="scalaz.ImmutableArray[A]">chunk</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#415022" title="=&gt; scalaz.Reducer[scalaz.ImmutableArray[A],Int]">sizer</a><span class="delimiter">)</span>,
          <span class="delimiter">(</span><a title="=&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]" id="415203">_</a>, <a title="=&gt; scalaz.ImmutableArray[A]" id="415204">last</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span title="scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#415204" title="=&gt; scalaz.ImmutableArray[A]">last</a>.<a href="ImmutableArray.scala.html#358286" title="=&gt; Int">length</a> <span title="(x: Int)Int">+</span> <a href="#415168" title="scalaz.ImmutableArray[A]">chunk</a>.<a href="ImmutableArray.scala.html#358286" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#414994" title="=&gt; Int">baseChunkLength</a><span class="delimiter">)</span>
            <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a> <a href="FingerTree.scala.html#100376" title="(a: =&gt; scalaz.ImmutableArray[A])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">:-|</a> <span class="delimiter">(</span><a href="#415204" title="=&gt; scalaz.ImmutableArray[A]">last</a> <a href="ImmutableArray.scala.html#358296" title="(other: scalaz.ImmutableArray[A])scalaz.ImmutableArray[A]">++</a> <a href="#415168" title="scalaz.ImmutableArray[A]">chunk</a><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a> <a href="FingerTree.scala.html#100374" title="(a: =&gt; scalaz.ImmutableArray[A])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">:+</a> <a href="#415168" title="scalaz.ImmutableArray[A]">chunk</a>
          <span class="delimiter">}</span>
        <span class="delimiter">)</span>
      <span class="delimiter">)</span>

  /**Prepends the given chunk to this rope*/
  <span class="keyword">def</span> <a title="(chunk: scalaz.ImmutableArray[A])scalaz.Rope[A]" id="415027">+::</a><span class="delimiter">(</span><a title="scalaz.ImmutableArray[A]" id="415227">chunk</a>: <a href="ImmutableArray.scala.html#9065" title="scalaz.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <span title="scalaz.Rope[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#415227" title="scalaz.ImmutableArray[A]">chunk</a>.<a href="ImmutableArray.scala.html#358287" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
      <a href="#20057" title="scalaz.Rope[A]" class="keyword">this</a>
    <span class="keyword">else</span>
      <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a>
        <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100395" title="=&gt; scalaz.ViewL[[α]scalaz.FingerTree[Int,α],scalaz.ImmutableArray[A]]">viewl</a>.<a href="FingerTree.scala.html#149627" title="(b: =&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]], f: (=&gt; scalaz.ImmutableArray[A], =&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]) =&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">fold</a><span class="delimiter">(</span>
          <a href="FingerTree.scala.html#100317" title="(a: =&gt; scalaz.ImmutableArray[A])(implicit ms: scalaz.Reducer[scalaz.ImmutableArray[A],Int])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">single</a><span class="delimiter">(</span><a href="#415227" title="scalaz.ImmutableArray[A]">chunk</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#415022" title="=&gt; scalaz.Reducer[scalaz.ImmutableArray[A],Int]">sizer</a><span class="delimiter">)</span>,
          <span class="delimiter">(</span><a title="=&gt; scalaz.ImmutableArray[A]" id="415262">head</a>, <a title="=&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]" id="415263">_</a><span class="delimiter">)</span> =&gt;
          <span title="scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#415227" title="scalaz.ImmutableArray[A]">chunk</a>.<a href="ImmutableArray.scala.html#358286" title="=&gt; Int">length</a> <span title="(x: Int)Int">+</span> <a href="#415262" title="=&gt; scalaz.ImmutableArray[A]">head</a>.<a href="ImmutableArray.scala.html#358286" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#414994" title="=&gt; Int">baseChunkLength</a><span class="delimiter">)</span>
            <span class="delimiter">(</span><a href="#415227" title="scalaz.ImmutableArray[A]">chunk</a> <a href="ImmutableArray.scala.html#358296" title="(other: scalaz.ImmutableArray[A])scalaz.ImmutableArray[A]">++</a> <a href="#415262" title="=&gt; scalaz.ImmutableArray[A]">head</a><span class="delimiter">)</span> <a href="FingerTree.scala.html#100375" title="(a: =&gt; scalaz.ImmutableArray[A])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">|-:</a> <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>
          <span class="keyword">else</span>
            <a href="#415227" title="scalaz.ImmutableArray[A]">chunk</a> <a href="FingerTree.scala.html#100373" title="(a: =&gt; scalaz.ImmutableArray[A])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">+:</a> <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>
        <span class="delimiter">)</span>
      <span class="delimiter">)</span>

  /**Appends the given element to this rope*/
  <span class="keyword">def</span> <a title="(x: A)scalaz.Rope[A]" id="415028">:+</a><span class="delimiter">(</span><a title="A" id="415288">x</a>: <a href="#23672" title="A">A</a><span class="delimiter">)</span>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#20057" title="Rope.this.type" class="keyword">this</a> <a href="#415026" title="(chunk: scalaz.ImmutableArray[A])scalaz.Rope[A]">::+</a> <a href="ImmutableArray.scala.html#9066" title="scalaz.ImmutableArray.type">IA</a>.<a href="ImmutableArray.scala.html#358403" title="(x: Array[A])scalaz.ImmutableArray[A]">fromArray</a><span class="delimiter">(</span><span title="(xs: A*)(implicit evidence$2: scala.reflect.ClassTag[A])Array[A]">Array</span><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a><a href="#415288" title="A">x</a><span class="delimiter">)</span><span class="delimiter">)</span>

  /**Prepends the given element to this rope*/
  <span class="keyword">def</span> <a title="(x: A)scalaz.Rope[A]" id="415029">+:</a><span class="delimiter">(</span><a title="A" id="415320">x</a>: <a href="#23672" title="A">A</a><span class="delimiter">)</span>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="ImmutableArray.scala.html#9066" title="scalaz.ImmutableArray.type">IA</a>.<a href="ImmutableArray.scala.html#358403" title="(x: Array[A])scalaz.ImmutableArray[A]">fromArray</a><span class="delimiter">(</span><span title="(xs: A*)(implicit evidence$2: scala.reflect.ClassTag[A])Array[A]">Array</span><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a><a href="#415320" title="A">x</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#415027" title="(chunk: scalaz.ImmutableArray[A])scalaz.Rope[A]">+::</a> <a href="#20057" title="Rope.this.type" class="keyword">this</a>

  /**tail of the Rope*/
  @annotation.tailrec
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; scalaz.Rope[A]" id="415030">tail</a>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scalaz.ImmutableArray[A]" id="415356">head</a> = <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100397" title="=&gt; scalaz.ImmutableArray[A]">head</a>
    <span title="scalaz.Rope[A]" class="keyword">if</span><span class="delimiter">(</span><a href="#415356" title="scalaz.ImmutableArray[A]">head</a>.<a href="ImmutableArray.scala.html#358286" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a><a href="ImmutableArray.scala.html#358430" title="(immArray: scalaz.ImmutableArray[A])scalaz.ImmutableArray.WrappedImmutableArray[A]">head</a>.<span title="=&gt; scalaz.ImmutableArray.WrappedImmutableArray[A]">tail</span> <a href="FingerTree.scala.html#100373" title="(a: =&gt; scalaz.ImmutableArray[A])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">+:</a> <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100399" title="=&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">tail</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="scalaz.Rope[A]" class="keyword">if</span><span class="delimiter">(</span><a href="#415356" title="scalaz.ImmutableArray[A]">head</a>.<a href="ImmutableArray.scala.html#358286" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a><a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100399" title="=&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">tail</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a><a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100399" title="=&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">tail</a><span class="delimiter">)</span>.<a href="#415030" title="=&gt; scalaz.Rope[A]">tail</a>
  <span class="delimiter">}</span>

  /**first element of the rope*/
  @annotation.tailrec
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; scalaz.Rope[A]" id="415031">init</a>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scalaz.ImmutableArray[A]" id="415637">last</a> = <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100398" title="=&gt; scalaz.ImmutableArray[A]">last</a>
    <span title="scalaz.Rope[A]" class="keyword">if</span><span class="delimiter">(</span><a href="#415637" title="scalaz.ImmutableArray[A]">last</a>.<a href="ImmutableArray.scala.html#358286" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a><a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100400" title="=&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">init</a> <a href="FingerTree.scala.html#100374" title="(a: =&gt; scalaz.ImmutableArray[A])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">:+</a> <a href="ImmutableArray.scala.html#358430" title="(immArray: scalaz.ImmutableArray[A])scalaz.ImmutableArray.WrappedImmutableArray[A]">last</a>.<a href="ImmutableArray.scala.html#358433" title="(immArrayOps: scalaz.ImmutableArray.WrappedImmutableArray[A])scalaz.ImmutableArray[A]">init</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="scalaz.Rope[A]" class="keyword">if</span><span class="delimiter">(</span><a href="#415637" title="scalaz.ImmutableArray[A]">last</a>.<a href="ImmutableArray.scala.html#358286" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a><a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100400" title="=&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">init</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#415019" title="ClassManifest[A]" class="delimiter">(</a><a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100400" title="=&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">init</a><span class="delimiter">)</span>.<a href="#415031" title="=&gt; scalaz.Rope[A]">init</a>
  <span class="delimiter">}</span>
//      def map[B](f: A =&gt; B) = Rope(value map f) TODO
//      def flatMap[B](f: A =&gt; Rope[B]) =
//        Rope(value.foldl(empty[Int, B])((ys, x) =&gt; ys &lt;++&gt; f(x).value))

  // override def foreach[U](f: A =&gt; U): Unit = value.foreach(_.foreach(f))

  <span class="keyword">def</span> <a title="=&gt; Iterator[A]" id="415032">iterator</a>: <span title="Iterator[A]">Iterator</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100430" title="=&gt; Iterator[scalaz.ImmutableArray[A]]">iterator</a>.<span title="(f: scalaz.ImmutableArray[A] =&gt; scala.collection.GenTraversableOnce[A])Iterator[A]">flatMap</span><span class="delimiter">(</span><a href="ImmutableArray.scala.html#358430" title="(immArray: scalaz.ImmutableArray[A])scalaz.ImmutableArray.WrappedImmutableArray[A]">_</a>.<span title="=&gt; Iterator[A]">iterator</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; Iterator[A]" id="415033">reverseIterator</a>: <span title="Iterator[A]">Iterator</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100431" title="=&gt; Iterator[scalaz.ImmutableArray[A]]">reverseIterator</a>.<span title="(f: scalaz.ImmutableArray[A] =&gt; scala.collection.GenTraversableOnce[A])Iterator[A]">flatMap</span><span class="delimiter">(</span><a href="ImmutableArray.scala.html#358430" title="(immArray: scalaz.ImmutableArray[A])scalaz.ImmutableArray.WrappedImmutableArray[A]">_</a>.<span title="=&gt; Iterator[A]">reverseIterator</span><span class="delimiter">)</span>

  // TODO override def reverse

  <span class="keyword">def</span> <a title="=&gt; Stream[scalaz.ImmutableArray[A]]" id="415034">chunks</a>: <span title="Stream[scalaz.ImmutableArray[A]]">Stream</span><span class="delimiter">[</span>ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100434" title="=&gt; scala.collection.immutable.Stream[scalaz.ImmutableArray[A]]">toStream</a>
<span class="delimiter">}</span>
    
<span class="keyword">sealed</span> <span class="keyword">class</span> <a title="class WrappedRope[A] extends AnyRef with scalaz.syntax.Ops[scalaz.Rope[A]] with scala.collection.immutable.IndexedSeq[A] with scala.collection.IndexedSeqLike[A,scalaz.WrappedRope[A]]" id="16715">WrappedRope</a><span class="delimiter">[</span><a title="" id="23673">A</a> : ClassManifest<span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">val</span> <a title="scalaz.Rope[A]" id="416119">self</a>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="keyword">extends</span> <a href="syntax/Ops.scala.html#28399" title="scalaz.syntax.Ops[scalaz.Rope[A]]">Ops</a><span class="delimiter">[</span>Rope<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> <span class="keyword">with</span> <span title="scala.collection.immutable.IndexedSeq[A]">IndexedSeq</span><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="keyword">with</span> <span title="scala.collection.IndexedSeqLike[A,scalaz.WrappedRope[A]]">IndexedSeqLike</span><span class="delimiter">[</span>A, WrappedRope<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#20058" title="scalaz.Rope.type">Rope</a>._

  <span class="keyword">def</span> <a title="(i: Int)A" id="415107">apply</a><span class="delimiter">(</span><a title="Int" id="416121">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#23673" title="A">A</a> = <a href="#415024" title="(i: Int)A">self</a><span class="delimiter">(</span><a href="#416121" title="Int">i</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(xs: scalaz.WrappedRope[A])scalaz.WrappedRope[A]" id="415108">++</a><span class="delimiter">(</span><a title="scalaz.WrappedRope[A]" id="416135">xs</a>: <a href="#16715" title="scalaz.WrappedRope[A]">WrappedRope</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#415063" title="(rope: scalaz.Rope[A])(implicit evidence$4: ClassManifest[A])scalaz.WrappedRope[A]">wrapRope</a><a href="#415104" title="ClassManifest[A]" class="delimiter">(</a><a href="#416119" title="=&gt; scalaz.Rope[A]">self</a> <a href="#415025" title="(xs: scalaz.Rope[A])scalaz.Rope[A]">++</a> <a href="#416135" title="scalaz.WrappedRope[A]">xs</a>.<a href="#416119" title="=&gt; scalaz.Rope[A]">self</a><span class="delimiter">)</span>

  // override def :+(x: A) = wrapRope(value :+ x)
  // override def +:(x: A) = wrapRope(x +: value)
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scalaz.WrappedRope[A]" id="415109">tail</a> = <a href="#416119" title="=&gt; scalaz.Rope[A]">self</a>.<a href="#415063" title="(rope: scalaz.Rope[A])(implicit evidence$4: ClassManifest[A])scalaz.WrappedRope[A]">tail</a>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scalaz.WrappedRope[A]" id="415110">init</a> = <a href="#416119" title="=&gt; scalaz.Rope[A]">self</a>.<a href="#415063" title="(rope: scalaz.Rope[A])(implicit evidence$4: ClassManifest[A])scalaz.WrappedRope[A]">init</a>
//def map[B](f: A =&gt; B) = Rope(value map f)
//def flatMap[B](f: A =&gt; Rope[B]) =
//  Rope(value.foldl(empty[Int, B])((ys, x) =&gt; ys &lt;++&gt; f(x).value))

//override def foreach[U](f: A =&gt; U): Unit = value.foreach(_.foreach(f))

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Iterator[A]" id="415111">iterator</a>: <span title="Iterator[A]">Iterator</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#416119" title="=&gt; scalaz.Rope[A]">self</a>.<a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100430" title="=&gt; Iterator[scalaz.ImmutableArray[A]]">iterator</a>.<span title="(f: scalaz.ImmutableArray[A] =&gt; scala.collection.GenTraversableOnce[A])Iterator[A]">flatMap</span><span class="delimiter">(</span><a href="ImmutableArray.scala.html#358430" title="(immArray: scalaz.ImmutableArray[A])scalaz.ImmutableArray.WrappedImmutableArray[A]">_</a>.<span title="=&gt; Iterator[A]">iterator</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Iterator[A]" id="415112">reverseIterator</a>: <span title="Iterator[A]">Iterator</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#416119" title="=&gt; scalaz.Rope[A]">self</a>.<a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100431" title="=&gt; Iterator[scalaz.ImmutableArray[A]]">reverseIterator</a>.<span title="(f: scalaz.ImmutableArray[A] =&gt; scala.collection.GenTraversableOnce[A])Iterator[A]">flatMap</span><span class="delimiter">(</span><a href="ImmutableArray.scala.html#358430" title="(immArray: scalaz.ImmutableArray[A])scalaz.ImmutableArray.WrappedImmutableArray[A]">_</a>.<span title="=&gt; Iterator[A]">reverseIterator</span><span class="delimiter">)</span>

  // TODO override def reverse

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Stream[A]" id="415113">toStream</a> = <a href="#416119" title="=&gt; scalaz.Rope[A]">self</a>.<a href="#415034" title="=&gt; Stream[scalaz.ImmutableArray[A]]">chunks</a>.<a href="ImmutableArray.scala.html#358430" title="(implicit asTraversable: scalaz.ImmutableArray[A] =&gt; scala.collection.GenTraversableOnce[A])scala.collection.immutable.Stream[A]">flatten</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="415114">length</a> = <a href="#416119" title="=&gt; scalaz.Rope[A]">self</a>.<a href="#415023" title="=&gt; Int">length</a>

  <span class="keyword">protected</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.mutable.Builder[A,scalaz.WrappedRope[A]]" id="415115">newBuilder</a> = <a href="#415104" title="scalaz.RopeBuilder[A]" class="keyword">new</a> <a href="#13010" title="scalaz.RopeBuilder[A]">RopeBuilder</a><span class="delimiter">[</span>A<span class="delimiter">]</span>.<span title="(f: scalaz.Rope[A] =&gt; scalaz.WrappedRope[A])scala.collection.mutable.Builder[A,scalaz.WrappedRope[A]]">mapResult</span><span class="delimiter">(</span><a href="#415063" title="(rope: scalaz.Rope[A])(implicit evidence$4: ClassManifest[A])scalaz.WrappedRope[A]">wrapRope</a><a href="#415104" title="ClassManifest[A]" class="delimiter">(</a><a href="#416615" title="scalaz.Rope[A]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>


<span class="keyword">sealed</span> <span class="keyword">class</span> <a title="class RopeCharW extends AnyRef with scalaz.syntax.Ops[scalaz.Rope[Char]]" id="17369">RopeCharW</a><a href="#17369" title="scalaz.RopeCharW" class="delimiter">(</a><span class="keyword">val</span> <a title="scalaz.Rope[Char]" id="416628">self</a>: <a href="#20057" title="scalaz.Rope[Char]">Rope</a><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="syntax/Ops.scala.html#28399" title="scalaz.syntax.Ops[scalaz.Rope[Char]]">Ops</a><span class="delimiter">[</span>Rope<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="416189">asString</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="StringBuilder" id="416632">stringBuilder</a> = <span title="(capacity: Int)StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span><span class="delimiter">(</span><a href="#416628" title="=&gt; scalaz.Rope[Char]">self</a>.<a href="#415023" title="=&gt; Int">length</a><span class="delimiter">)</span>
    <a href="#416190" title="(stringBuilder: StringBuilder)Unit">appendTo</a><span class="delimiter">(</span><a href="#416632" title="StringBuilder">stringBuilder</a><span class="delimiter">)</span>
    <a href="#416632" title="StringBuilder">stringBuilder</a>.<span title="()String">toString</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(stringBuilder: StringBuilder)Unit" id="416190">appendTo</a><span class="delimiter">(</span><a title="StringBuilder" id="416637">stringBuilder</a>: <span title="StringBuilder">StringBuilder</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#416628" title="=&gt; scalaz.Rope[Char]">self</a>.<a href="#415034" title="=&gt; Stream[scalaz.ImmutableArray[Char]]">chunks</a>.<span title="(f: scalaz.ImmutableArray[Char] =&gt; StringBuilder)Unit">foreach</span><span class="delimiter">(</span><a title="scalaz.ImmutableArray[Char]" id="416696">ia</a> =&gt; <a href="#416637" title="StringBuilder">stringBuilder</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span><a href="ImmutableArray.scala.html#358441" title="implicit scalaz.ImmutableArray.wrapRopeChar : (array: scalaz.ImmutableArray[Char])scalaz.ImmutableArray.ImmutableArrayCharW">ia</a>.<a href="ImmutableArray.scala.html#363847" title="=&gt; String">asString</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span class="keyword">import</span> collection.mutable.Builder
<span class="keyword">import</span> scalaz.<span class="delimiter">{</span>ImmutableArray =&gt; IA<span class="delimiter">}</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class RopeBuilder[A] extends AnyRef with scala.collection.mutable.Builder[A,scalaz.Rope[A]]" id="13010">RopeBuilder</a><span class="delimiter">[</span><a title="" id="23676">A</a> : ClassManifest<span class="delimiter">]</span> <span class="keyword">extends</span> <span title="scala.collection.mutable.Builder[A,scalaz.Rope[A]]">Builder</span><span class="delimiter">[</span>A, Rope<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#20058" title="scalaz.Rope.type">Rope</a>._
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="scalaz.Rope[A]" id="416595">startRope</a>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#20058" title="scalaz.Rope.type">Rope</a>.<a href="#416713" title="[A](implicit evidence$7: ClassManifest[A])scalaz.Rope[A]">empty</a><a href="#416591" title="(implicit evidence$7: ClassManifest[A])scalaz.Rope[A]" class="delimiter">[</a><a href="#23676" title="A">A</a><span class="delimiter">]</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]" id="416598">tailBuilder</a>: <span title="scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]">Builder</span><span class="delimiter">[</span>A, ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="ImmutableArray.scala.html#9066" title="scalaz.ImmutableArray.type">IA</a>.<a href="ImmutableArray.scala.html#358407" title="[A](implicit elemManifest: reflect.ClassManifest[A])scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]">newBuilder</a><a href="#416591" title="(implicit elemManifest: reflect.ClassManifest[A])scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]" class="delimiter">[</a><a href="#23676" title="A">A</a><span class="delimiter">]</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="416601">tailLength</a> = <span title="Int(0)" class="int">0</span>

  <span class="keyword">def</span> <a title="()Unit" id="416603">clear</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#416595" title="(x$1: scalaz.Rope[A])Unit">startRope</a> = <a href="#20058" title="scalaz.Rope.type">Rope</a>.<a href="#416713" title="[A](implicit evidence$7: ClassManifest[A])scalaz.Rope[A]">empty</a><a href="#416591" title="(implicit evidence$7: ClassManifest[A])scalaz.Rope[A]" class="delimiter">[</a><a href="#23676" title="A">A</a><span class="delimiter">]</span>
    <a href="#416598" title="(x$1: scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]])Unit">tailBuilder</a> = <a href="ImmutableArray.scala.html#9066" title="scalaz.ImmutableArray.type">IA</a>.<a href="ImmutableArray.scala.html#358407" title="[A](implicit elemManifest: reflect.ClassManifest[A])scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]">newBuilder</a><a href="#416591" title="(implicit elemManifest: reflect.ClassManifest[A])scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]" class="delimiter">[</a><a href="#23676" title="A">A</a><span class="delimiter">]</span>
    <a href="#416601" title="(x$1: Int)Unit">tailLength</a> = <span title="Int(0)" class="int">0</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(elem: A)RopeBuilder.this.type" id="416604">+=</a><span class="delimiter">(</span><a title="A" id="416744">elem</a>: <a href="#23676" title="A">A</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#416601" title="=&gt; Int">tailLength</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#414994" title="=&gt; Int">baseChunkLength</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#416598" title="=&gt; scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]">tailBuilder</a> <span title="(elem: A)scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]">+=</span> <a href="#416744" title="A">elem</a>
      <a href="#416601" title="(x$1: Int)Unit">tailLength</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#416606" title="=&gt; Unit">cleanTail</a>
      <a href="#416598" title="=&gt; scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]">tailBuilder</a> <span title="(elem: A)scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]">+=</span> <a href="#416744" title="A">elem</a>
      <a href="#416601" title="(x$1: Int)Unit">tailLength</a> = <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#13010" title="RopeBuilder.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()scalaz.Rope[A]" id="416605">result</a> = <a href="#416595" title="=&gt; scalaz.Rope[A]">startRope</a> <a href="#415026" title="(chunk: scalaz.ImmutableArray[A])scalaz.Rope[A]">::+</a> <a href="#416598" title="=&gt; scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]">tailBuilder</a>.<span title="()scalaz.ImmutableArray[A]">result</span>

  /*override def sizeHint(size: Int) {
    tailBuilder.sizeHint(math.min(size - startRope.length, baseChunkLength))
  }*/

      // TODO fix and reinstate
//      import collection.mutable.ArrayLike
//      override def ++=(xs: TraversableOnce[A]) = {
//        xs match {
//          case xs: Rope[A] =&gt; {
//            cleanTail
//            startRope ++= xs
//          }
//          case xs: ImmutableArray[A] =&gt; {
//            cleanTail
//            startRope ::+= xs
//          }
//          case xs: ArrayLike[A, _] =&gt; {
//            cleanTail
//            tailBuilder ++= xs
//          }
//          case _ =&gt;  super.++=(xs)
//        }
//        this
//      }
//    }

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Unit" id="416606">cleanTail</a> <span class="delimiter">{</span>
    <a href="#416595" title="(x$1: scalaz.Rope[A])Unit">startRope</a> <a href="#415026" title="(chunk: scalaz.ImmutableArray[A])scalaz.Rope[A]">::+=</a> <a href="#416598" title="=&gt; scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]">tailBuilder</a>.<span title="()scalaz.ImmutableArray[A]">result</span>
    <a href="#416598" title="=&gt; scala.collection.mutable.Builder[A,scalaz.ImmutableArray[A]]">tailBuilder</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="scalaz.Rope.type" id="20058">Rope</a> <a href="#20059" title="scalaz.Rope.type" class="delimiter">{</a>
  <span class="keyword">type</span> <a title="[A]scalaz.FingerTree[Int,A]" id="414981">FingerTreeIntPlus</a><span class="delimiter">[</span><a title="" id="414982">A</a><span class="delimiter">]</span> = <a href="FingerTree.scala.html#16562" title="scalaz.FingerTree[Int,A]">FingerTree</a><span class="delimiter">[</span>Int, A<span class="delimiter">]</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](rope: scalaz.Rope[A])(implicit evidence$4: ClassManifest[A])scalaz.WrappedRope[A]" id="415063">wrapRope</a><span class="delimiter">[</span><a title="" id="414985">A</a> : ClassManifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.Rope[A]" id="415062">rope</a>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#16715" title="scalaz.WrappedRope[A]">WrappedRope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#415063" title="scalaz.WrappedRope[A]" class="keyword">new</a> <a href="#16715" title="scalaz.WrappedRope[A]">WrappedRope</a><span class="delimiter">(</span><a href="#415062" title="scalaz.Rope[A]">rope</a><span class="delimiter">)</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](wrappedRope: scalaz.WrappedRope[A])(implicit evidence$5: ClassManifest[A])scalaz.Rope[A]" id="415059">unwrapRope</a><span class="delimiter">[</span><a title="" id="414988">A</a> : ClassManifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.WrappedRope[A]" id="415058">wrappedRope</a>: <a href="#16715" title="scalaz.WrappedRope[A]">WrappedRope</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#415058" title="scalaz.WrappedRope[A]">wrappedRope</a>.<a href="#416119" title="=&gt; scalaz.Rope[A]">self</a>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scalaz.Rope.wrapRopeChar : (rope: scalaz.Rope[Char])scalaz.RopeCharW" id="414989">wrapRopeChar</a><span class="delimiter">(</span><a title="scalaz.Rope[Char]" id="415057">rope</a>: <a href="#20057" title="scalaz.Rope[Char]">Rope</a><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#17369" title="scalaz.RopeCharW">RopeCharW</a> = <span title="scalaz.RopeCharW" class="keyword">new</span> <a href="#17369" title="scalaz.RopeCharW">RopeCharW</a><span class="delimiter">(</span><a href="#415057" title="scalaz.Rope[Char]">rope</a><span class="delimiter">)</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A]=&gt; scalaz.Reducer[scalaz.ImmutableArray[A],Int]" id="414990">sizer</a><span class="delimiter">[</span><a title="" id="414992">A</a><span class="delimiter">]</span>: <a href="Reducer.scala.html#21062" title="scalaz.Reducer[scalaz.ImmutableArray[A],Int]">Reducer</a><span class="delimiter">[</span>ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span>, Int<span class="delimiter">]</span> = <a href="Reducer.scala.html#150707" title="(u: scalaz.ImmutableArray[A] =&gt; Int)(implicit mm: scalaz.Monoid[Int])scalaz.Reducer[scalaz.ImmutableArray[A],Int]">UnitReducer</a><a href="std/AnyVal.scala.html#45716" title="=&gt; scalaz.Monoid[Int] with scalaz.Enum[Int] with scalaz.Show[Int]" class="delimiter">(</a><a href="#416866" title="scalaz.ImmutableArray[A]">_</a>.<a href="ImmutableArray.scala.html#358286" title="=&gt; Int">length</a><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; scalaz.Length[scalaz.Rope]" id="414993">ropeLength</a>: <a href="Length.scala.html#8522" title="scalaz.Length[scalaz.Rope]">Length</a><span class="delimiter">[</span>Rope<span class="delimiter">]</span> = <a href="#416872" title="scalaz.Length[scalaz.Rope]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.Length[scalaz.Rope]" id="416872">Length</a><span class="delimiter">[</span>Rope<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: scalaz.Rope[A])Int" id="416874">length</a><span class="delimiter">[</span><a title="" id="416876">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.Rope[A]" id="416878">a</a>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#416878" title="scalaz.Rope[A]">a</a>.<a href="#415038" title="=&gt; scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">self</a>.<a href="FingerTree.scala.html#100360" title="=&gt; Int">measure</a>
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="Int" id="414994">baseChunkLength</a> = <span title="Int(16)" class="int">16</span>

  <span class="keyword">def</span> <a title="[A](v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]" id="415154">apply</a><span class="delimiter">[</span><a title="" id="414998">A</a> : ClassManifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]" id="415153">v</a>: <a href="FingerTree.scala.html#16562" title="scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">FingerTreeIntPlus</a><span class="delimiter">[</span>ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#415154" title="scalaz.Rope[A]" class="keyword">new</a> <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">(</span><a href="#415153" title="scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]]">v</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[A](implicit evidence$7: ClassManifest[A])scalaz.Rope[A]" id="416713">empty</a><span class="delimiter">[</span><a title="" id="415001">A</a> : ClassManifest<span class="delimiter">]</span> = <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#416713" title="ClassManifest[A]" class="delimiter">(</a><a href="FingerTree.scala.html#16563" title="scalaz.FingerTree.type">FingerTree</a>.<a href="FingerTree.scala.html#100312" title="[V, A](implicit ms: scalaz.Reducer[A,V])scalaz.FingerTree[V,A]">empty</a><a href="#414990" title="(implicit ms: scalaz.Reducer[scalaz.ImmutableArray[A],Int])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]" class="delimiter">[</a><span title="Int">Int</span>, <a href="ImmutableArray.scala.html#9065" title="scalaz.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[A](a: Array[A])(implicit evidence$8: ClassManifest[A])scalaz.Rope[A]" id="416899">fromArray</a><span class="delimiter">[</span><a title="" id="415004">A</a> : ClassManifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="Array[A]" id="416898">a</a>: <span title="Array[A]">Array</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <span title="scalaz.Rope[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#416898" title="(xs: Array[A])scala.collection.mutable.ArrayOps[A]">a</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#416713" title="[A](implicit evidence$7: ClassManifest[A])scalaz.Rope[A]">empty</a><a href="#416899" title="(implicit evidence$7: ClassManifest[A])scalaz.Rope[A]" class="delimiter">[</a><a href="#415004" title="A">A</a><span class="delimiter">]</span> <span class="keyword">else</span> <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#416899" title="ClassManifest[A]" class="delimiter">(</a><a href="FingerTree.scala.html#100317" title="(a: =&gt; scalaz.ImmutableArray[A])(implicit ms: scalaz.Reducer[scalaz.ImmutableArray[A],Int])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">single</a><a href="#414990" title="scalaz.Reducer[scalaz.ImmutableArray[A],Int]" class="delimiter">(</a><a href="ImmutableArray.scala.html#9066" title="scalaz.ImmutableArray.type">IA</a>.<a href="ImmutableArray.scala.html#358403" title="(x: Array[A])scalaz.ImmutableArray[A]">fromArray</a><span class="delimiter">(</span><a href="#416898" title="Array[A]">a</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(str: String)scalaz.Rope[Char]" id="415005">fromString</a><span class="delimiter">(</span><a title="String" id="417013">str</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#20057" title="scalaz.Rope[Char]">Rope</a><span class="delimiter">[</span>Char<span class="delimiter">]</span> =
    <span title="scalaz.Rope[Char]" class="keyword">if</span> <span class="delimiter">(</span><a href="#417013" title="String">str</a>.<span title="()Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#416713" title="[A](implicit evidence$7: ClassManifest[A])scalaz.Rope[A]">empty</a><span title="(implicit evidence$7: ClassManifest[Char])scalaz.Rope[Char]" class="delimiter">[</span><span title="Char">Char</span><span class="delimiter">]</span> <span class="keyword">else</span> <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[Char]])(implicit evidence$6: ClassManifest[Char])scalaz.Rope[Char]">Rope</a><span title="=&gt; scala.reflect.AnyValManifest[Char]" class="delimiter">(</span><a href="FingerTree.scala.html#100317" title="(a: =&gt; scalaz.ImmutableArray[Char])(implicit ms: scalaz.Reducer[scalaz.ImmutableArray[Char],Int])scalaz.FingerTree[Int,scalaz.ImmutableArray[Char]]">single</a><a href="#414990" title="scalaz.Reducer[scalaz.ImmutableArray[Char],Int]" class="delimiter">(</a><a href="ImmutableArray.scala.html#9066" title="scalaz.ImmutableArray.type">IA</a>.<a href="ImmutableArray.scala.html#358406" title="(str: String)scalaz.ImmutableArray[Char]">fromString</a><span class="delimiter">(</span><a href="#417013" title="String">str</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[A](chunks: Seq[scalaz.ImmutableArray[A]])(implicit evidence$9: ClassManifest[A])scalaz.Rope[A]" id="417183">fromChunks</a><span class="delimiter">[</span><a title="" id="415008">A</a> : ClassManifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="Seq[scalaz.ImmutableArray[A]]" id="417182">chunks</a>: <span title="Seq[scalaz.ImmutableArray[A]]">Seq</span><span class="delimiter">[</span>ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#20057" title="scalaz.Rope[A]">Rope</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#415154" title="(v: scalaz.Rope.FingerTreeIntPlus[scalaz.ImmutableArray[A]])(implicit evidence$6: ClassManifest[A])scalaz.Rope[A]">Rope</a><a href="#417183" title="ClassManifest[A]" class="delimiter">(</a><a href="#417182" title="Seq[scalaz.ImmutableArray[A]]">chunks</a>.<span title="(z: scalaz.FingerTree[Int,scalaz.ImmutableArray[A]])(op: (scalaz.FingerTree[Int,scalaz.ImmutableArray[A]], scalaz.ImmutableArray[A]) =&gt; scalaz.FingerTree[Int,scalaz.ImmutableArray[A]])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">foldLeft</span><span class="delimiter">(</span><a href="FingerTree.scala.html#16563" title="scalaz.FingerTree.type">FingerTree</a>.<a href="FingerTree.scala.html#100312" title="[V, A](implicit ms: scalaz.Reducer[A,V])scalaz.FingerTree[V,A]">empty</a><a href="#414990" title="(implicit ms: scalaz.Reducer[scalaz.ImmutableArray[A],Int])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]" class="delimiter">[</a><span title="Int">Int</span>, <a href="ImmutableArray.scala.html#9065" title="scalaz.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]" id="417209">tree</a>, <a title="scalaz.ImmutableArray[A]" id="417210">chunk</a><span class="delimiter">)</span> =&gt; <span title="scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#417210" title="scalaz.ImmutableArray[A]">chunk</a>.<a href="ImmutableArray.scala.html#358287" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#417209" title="scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">tree</a> <a href="FingerTree.scala.html#100374" title="(a: =&gt; scalaz.ImmutableArray[A])scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">:+</a> <a href="#417210" title="scalaz.ImmutableArray[A]">chunk</a> <span class="keyword">else</span> <a href="#417209" title="scalaz.FingerTree[Int,scalaz.ImmutableArray[A]]">tree</a><span class="delimiter">)</span><span class="delimiter">)</span>
//      def apply[A](as: A*) = fromSeq(as)
//      def fromSeq[A](as: Seq[A]) = Rope(as.foldLeft(empty[Int, A](Reducer(a =&gt; 1)))((x, y) =&gt; x :+ y))

  <span class="keyword">def</span> <a title="[A](implicit evidence$10: ClassManifest[A])scala.collection.mutable.Builder[A,scalaz.Rope[A]]" id="417217">newBuilder</a><span class="delimiter">[</span><a title="" id="415011">A</a> : ClassManifest<span class="delimiter">]</span>: <span title="scala.collection.mutable.Builder[A,scalaz.Rope[A]]">Builder</span><span class="delimiter">[</span>A, Rope<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#417217" title="scalaz.RopeBuilder[A]" class="keyword">new</a> <a href="#13010" title="scalaz.RopeBuilder[A]">RopeBuilder</a><span class="delimiter">[</span>A<span class="delimiter">]</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](implicit evidence$11: ClassManifest[T])scala.collection.generic.CanBuildFrom[scalaz.Rope[_],T,scalaz.Rope[T]]" id="415053">canBuildFrom</a><span class="delimiter">[</span><a title="" id="415014">T</a> : ClassManifest<span class="delimiter">]</span>: <span title="scala.collection.generic.CanBuildFrom[scalaz.Rope[_],T,scalaz.Rope[T]]">CanBuildFrom</span><span class="delimiter">[</span>Rope<span class="delimiter">[</span>_<span class="delimiter">]</span>, T, Rope<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#417223" title="scala.collection.generic.CanBuildFrom[scalaz.Rope[_],T,scalaz.Rope[T]]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scala.collection.generic.CanBuildFrom[scalaz.Rope[_],T,scalaz.Rope[T]]" id="417223">CanBuildFrom</a><span class="delimiter">[</span>Rope<span class="delimiter">[</span>_<span class="delimiter">]</span>, T, Rope<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(from: scalaz.Rope[_])scala.collection.mutable.Builder[T,scalaz.Rope[T]]" id="417227">apply</a><span class="delimiter">(</span><a title="scalaz.Rope[_]" id="417231">from</a>: <a href="#20057" title="scalaz.Rope[_]">Rope</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.collection.mutable.Builder[T,scalaz.Rope[T]]">Builder</span><span class="delimiter">[</span>T, Rope<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#417217" title="[A](implicit evidence$10: ClassManifest[A])scala.collection.mutable.Builder[A,scalaz.Rope[A]]">newBuilder</a><a href="#415053" title="(implicit evidence$10: ClassManifest[T])scala.collection.mutable.Builder[T,scalaz.Rope[T]]" class="delimiter">[</a><a href="#415014" title="T">T</a><span class="delimiter">]</span>
      <span class="keyword">def</span> <a title="()scala.collection.mutable.Builder[T,scalaz.Rope[T]]" id="417228">apply</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="scala.collection.mutable.Builder[T,scalaz.Rope[T]]">Builder</span><span class="delimiter">[</span>T, Rope<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#417217" title="[A](implicit evidence$10: ClassManifest[A])scala.collection.mutable.Builder[A,scalaz.Rope[A]]">newBuilder</a><a href="#415053" title="(implicit evidence$10: ClassManifest[T])scala.collection.mutable.Builder[T,scalaz.Rope[T]]" class="delimiter">[</a><a href="#415014" title="T">T</a><span class="delimiter">]</span>
    <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
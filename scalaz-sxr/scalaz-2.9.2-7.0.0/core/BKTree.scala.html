<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>core/BKTree.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz

<span class="keyword">import</span> collection.immutable.IntMap
<span class="keyword">import</span> annotation.tailrec

<span class="keyword">import</span> <a href="#18627" title="scalaz.BKTree.type">BKTree</a>._

/**
 * Burkhard-Keller trees provide an implementation of sets which apart
 * from the ordinary operations also has an approximate member search,
 * allowing you to search for elements that are of a distance `n` from
 * the element you are searching for. The distance is determined using
 * a metric on the type of elements. Therefore all elements must
 * implement the [[scalaz.MetricSpace]] type class, rather than the more usual
 * [[scalaz.Ordering]].
 *
 * The worst case complexity of many of these operations is quite bad,
 * but the expected behavior varies greatly with the metric. For
 * example, the discrete metric (`distance x y | y == x = 0 |
 * otherwise = 1`) makes BK-trees behave abysmally. The metrics
 * mentioned above should give good performance characteristics.
 *
 * This implementation is a port of Haskell's [[http://hackage.haskell.org/packages/archive/bktrees/0.2.1/doc/html/src/Data-Set-BKTree.html Data.Set.BKTree]]
 */
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait BKTree[A] extends AnyRef" id="18626">BKTree</a><span class="delimiter">[</span><a title="" id="22848">A</a><span class="delimiter">]</span> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="119812">isEmpty</a>: <span title="Boolean">Boolean</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675169" title="Boolean" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <a href="#1675176" title="(x: Boolean)Boolean" class="keyword">true</a>
      <span class="keyword">case</span> BKTreeNode<a href="#1675169" title="Boolean" class="delimiter">(</a>_, _, _<span class="delimiter">)</span> =&gt; <a href="#1675176" title="(x: Boolean)Boolean" class="keyword">false</a>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[B](f: A =&gt; B)scalaz.BKTree[B]" id="119813">map</a><span class="delimiter">[</span><a title="" id="119815">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; B" id="120269">f</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#18626" title="scalaz.BKTree[B]">BKTree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675181" title="scalaz.BKTree[B]" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <a href="#122932" title="()scalaz.BKTreeEmpty[B]">BKTreeEmpty</a><a href="#1675185" title="(x: scalaz.BKTree[B])scalaz.BKTree[B]" class="delimiter">(</a><span class="delimiter">)</span>
      <span class="keyword">case</span> BKTreeNode<a href="#1675181" title="scalaz.BKTree[B]" class="delimiter">(</a><a href="#120278" title="A" id="120275">a</a>, <a href="#120279" title="Int" id="120276">s</a>, <a href="#120280" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]" id="120277">c</a><span class="delimiter">)</span> =&gt; <a href="#122939" title="(value: B, sz: Int, children: scala.collection.immutable.IntMap[scalaz.BKTree[B]])scalaz.BKTreeNode[B]">BKTreeNode</a><a href="#1675185" title="(x: scalaz.BKTree[B])scalaz.BKTree[B]" class="delimiter">(</a><a href="#120269" title="(v1: A)B">f</a><span class="delimiter">(</span><a href="#120275" title="A">a</a><span class="delimiter">)</span>, <a href="#120276" title="Int">s</a>, <a href="#120277" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">c</a>.<span title="(f: (scala.collection.immutable.IntMapUtils.Int, scalaz.BKTree[A]) =&gt; scalaz.BKTree[B])scala.collection.immutable.IntMap[scalaz.BKTree[B]]">transform</span><span class="delimiter">(</span><span class="delimiter">(</span>_: <span title="Int">Int</span>, z: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <a href="#120330" title="scalaz.BKTree[A]">z</a> <a href="#119813" title="(f: A =&gt; B)scalaz.BKTree[B]">map</a> <a href="#120269" title="A =&gt; B">f</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="119816">size</a>: <span title="Int">Int</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675190" title="Int" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <a href="#1675196" title="(x: Int)Int" class="int">0</a>
      <span class="keyword">case</span> BKTreeNode<a href="#1675190" title="Int" class="delimiter">(</a>_, <a href="#120279" title="Int" id="120392">s</a>, _<span class="delimiter">)</span> =&gt; <a href="#1675196" title="(x: Int)Int">s</a>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(a: A)(implicit A: scalaz.MetricSpace[A])scalaz.BKTree[A]" id="119817">+</a><span class="delimiter">(</span><a title="A" id="120393">a</a>: <a href="#22848" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[A]" id="120394">A</a>: <a href="MetricSpace.scala.html#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675214" title="scalaz.BKTree[A]" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <a href="#122939" title="(value: A, sz: Int, children: scala.collection.immutable.IntMap[scalaz.BKTree[A]])scalaz.BKTreeNode[A]">BKTreeNode</a><a href="#1675218" title="(x: scalaz.BKTree[A])scalaz.BKTree[A]" class="delimiter">(</a><a href="#120393" title="A">a</a>, <span title="Int(1)" class="int">1</span>, <span title="scala.collection.immutable.IntMap.type">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span><span class="delimiter">)</span>
      <span class="keyword">case</span> BKTreeNode<a href="#1675214" title="scalaz.BKTree[A]" class="delimiter">(</a><a href="#120278" title="A" id="120439">v</a>, <a href="#120279" title="Int" id="120440">s</a>, <a href="#120280" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]" id="120441">c</a><span class="delimiter">)</span> =&gt; <a href="#1675218" title="(x: scalaz.BKTree[A])scalaz.BKTree[A]" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="Int" id="120442">d</a> = <a href="#120394" title="scalaz.MetricSpace[A]">A</a>.<a href="MetricSpace.scala.html#106451" title="(a: A, b: A)Int">distance</a><span class="delimiter">(</span><a href="#120439" title="A">v</a>, <a href="#120393" title="A">a</a><span class="delimiter">)</span>
        <a href="#122939" title="(value: A, sz: Int, children: scala.collection.immutable.IntMap[scalaz.BKTree[A]])scalaz.BKTreeNode[A]">BKTreeNode</a><span class="delimiter">(</span><a href="#120439" title="A">v</a>, <a href="#120440" title="Int">s</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#120441" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">c</a> <span title="(kv: (scala.collection.immutable.IntMapUtils.Int, scalaz.BKTree[A]))scala.collection.immutable.IntMap[scalaz.BKTree[A]]">+</span> <span class="delimiter">(</span><span title="(_1: Int, _2: scalaz.BKTree[A])(Int, scalaz.BKTree[A])" class="delimiter">(</span><a href="#120442" title="Int">d</a>, <a href="#120441" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">c</a> <a href="#1675206" title="(key: scala.collection.immutable.IntMapUtils.Int)Option[scalaz.BKTree[A]]">get</a> <a href="#120442" title="Int">d</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#1675201" title="scalaz.BKTree[A]">None</a>    =&gt; <a href="#122939" title="(value: A, sz: Int, children: scala.collection.immutable.IntMap[scalaz.BKTree[A]])scalaz.BKTreeNode[A]">BKTreeNode</a><a href="#1675206" title="(x: scalaz.BKTree[A])scalaz.BKTree[A]" class="delimiter">(</a><a href="#120393" title="A">a</a>, <span title="Int(1)" class="int">1</span>, <span title="scala.collection.immutable.IntMap.type">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span><span class="delimiter">)</span>
          <span class="keyword">case</span> Some<a href="#1675201" title="scalaz.BKTree[A]" class="delimiter">(</a><a href="#1675203" title="scalaz.BKTree[A]" id="120549">w</a><span class="delimiter">)</span> =&gt; <a href="#120549" title="scalaz.BKTree[A]">w</a> <a href="#1675206" title="(x: scalaz.BKTree[A])scalaz.BKTree[A]">+</a> <a href="#120393" title="A">a</a>
        <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(t: scalaz.BKTree[A])(implicit m: scalaz.MetricSpace[A])scalaz.BKTree[A]" id="119818">++</a><span class="delimiter">(</span><a title="scalaz.BKTree[A]" id="120565">t</a>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[A]" id="120566">m</a>: <a href="MetricSpace.scala.html#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="scalaz.BKTree[A]" id="120567">k</a>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a>
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="A" id="120598">v</a> &lt;- <a href="#120565" title="scalaz.BKTree[A]">t</a>.<a href="#119821" title="(f: A =&gt; Unit)Unit">values</a><span class="delimiter">)</span>
      <a href="#120567" title="scalaz.BKTree[A]">k</a> = <a href="#120567" title="scalaz.BKTree[A]">k</a> <a href="#119817" title="(a: A)(implicit A: scalaz.MetricSpace[A])scalaz.BKTree[A]">+</a> <a href="#120598" title="A">v</a>
    <a href="#120567" title="scalaz.BKTree[A]">k</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(a: A)(implicit A: scalaz.MetricSpace[A])scalaz.BKTree[A]" id="119819">-</a><span class="delimiter">(</span><a title="A" id="120600">a</a>: <a href="#22848" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[A]" id="120601">A</a>: <a href="MetricSpace.scala.html#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675223" title="scalaz.BKTree[A]" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <a href="#122932" title="()scalaz.BKTreeEmpty[A]">BKTreeEmpty</a><a href="#1675228" title="(x: scalaz.BKTree[A])scalaz.BKTree[A]" class="delimiter">(</a><span class="delimiter">)</span>
      <span class="keyword">case</span> BKTreeNode<a href="#1675223" title="scalaz.BKTree[A]" class="delimiter">(</a><a href="#120278" title="A" id="120606">v</a>, _, <a href="#120280" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]" id="120607">c</a><span class="delimiter">)</span> =&gt; <a href="#1675228" title="(x: scalaz.BKTree[A])scalaz.BKTree[A]" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="Int" id="120608">d</a> = <a href="#120601" title="scalaz.MetricSpace[A]">A</a>.<a href="MetricSpace.scala.html#106451" title="(a: A, b: A)Int">distance</a><span class="delimiter">(</span><a href="#120606" title="A">v</a>, <a href="#120600" title="A">a</a><span class="delimiter">)</span>
        <span title="scalaz.BKTree[A]" class="keyword">if</span><span class="delimiter">(</span><a href="#120608" title="Int">d</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#120616" title="(as: A*)(implicit evidence$1: scalaz.MetricSpace[A])scalaz.BKTree[A]">BKTree</a><a href="#120601" title="scalaz.MetricSpace[A]" class="delimiter">(</a><a href="#120607" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">c</a>.<span title="=&gt; Iterable[scalaz.BKTree[A]]">values</span>.<span title="=&gt; Iterable[scalaz.BKTree[A]]">seq</span>.<span title="(f: scalaz.BKTree[A] =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[Iterable[scalaz.BKTree[A]],A,Iterable[A]])Iterable[A]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Iterable.Coll,A,Iterable[A]]" class="delimiter">(</span><a href="#120656" title="scalaz.BKTree[A]">_</a>.<a href="#119821" title="=&gt; List[A]">values</a><span class="delimiter">)</span>.<span title="=&gt; Seq[A]">toSeq</span>: _*<span class="delimiter">)</span>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="BKTree.this.M[scalaz.BKTree[A]]" id="120714">subTree</a> = <a href="#119834" title="(m: BKTree.this.M[scalaz.BKTree[A]], k: Int, f: scalaz.BKTree[A] =&gt; Option[scalaz.BKTree[A]])BKTree.this.M[scalaz.BKTree[A]]">updateMap</a><span class="delimiter">(</span><a href="#120607" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">c</a>, <a href="#120608" title="Int">d</a>, <span class="delimiter">(</span>t: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span title="(x: scalaz.BKTree[A])Some[scalaz.BKTree[A]]">Some</span><span class="delimiter">(</span><a href="#120788" title="scalaz.BKTree[A]">t</a> <a href="#119819" title="(a: A)(implicit A: scalaz.MetricSpace[A])scalaz.BKTree[A]">-</a> <a href="#120600" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Int" id="120715">size</a> = <a href="#120714" title="BKTree.this.M[scalaz.BKTree[A]]">subTree</a>.<span title="=&gt; Iterable[scalaz.BKTree[A]]">values</span>.<span title="(f: scalaz.BKTree[A] =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Iterable[scalaz.BKTree[A]],Int,Iterable[Int]])Iterable[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Iterable.Coll,Int,Iterable[Int]]" class="delimiter">(</span><a href="#120811" title="scalaz.BKTree[A]">_</a>.<a href="#119816" title="=&gt; Int">size</a><span class="delimiter">)</span>.<span title="(implicit num: Numeric[Int])Int">sum</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
          <a href="#122939" title="(value: A, sz: Int, children: scala.collection.immutable.IntMap[scalaz.BKTree[A]])scalaz.BKTreeNode[A]">BKTreeNode</a><span class="delimiter">(</span><a href="#120606" title="A">v</a>, <a href="#120715" title="Int">size</a>, <a href="#120714" title="BKTree.this.M[scalaz.BKTree[A]]">subTree</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(t: scalaz.BKTree[A])(implicit m: scalaz.MetricSpace[A])scalaz.BKTree[A]" id="119820">--</a><span class="delimiter">(</span><a title="scalaz.BKTree[A]" id="121720">t</a>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[A]" id="121721">m</a>: <a href="MetricSpace.scala.html#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="scalaz.BKTree[A]" id="121722">k</a>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a>
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="A" id="121745">v</a> &lt;- <a href="#121720" title="scalaz.BKTree[A]">t</a>.<a href="#119821" title="(f: A =&gt; Unit)Unit">values</a><span class="delimiter">)</span>
      <a href="#121722" title="scalaz.BKTree[A]">k</a> = <a href="#121722" title="scalaz.BKTree[A]">k</a> <a href="#119819" title="(a: A)(implicit A: scalaz.MetricSpace[A])scalaz.BKTree[A]">-</a> <a href="#121745" title="A">v</a>
    <a href="#121722" title="scalaz.BKTree[A]">k</a>
  <span class="delimiter">}</span>  

  <span class="keyword">def</span> <a title="=&gt; List[A]" id="119821">values</a>: <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675233" title="List[A]" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <a href="#1675238" title="(x: List[A])List[A]">Nil</a>
      <span class="keyword">case</span> BKTreeNode<a href="#1675233" title="List[A]" class="delimiter">(</a><a href="#120278" title="A" id="121750">v</a>, _, <a href="#120280" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]" id="121751">c</a><span class="delimiter">)</span> =&gt; <a href="#121750" title="A">v</a> <a href="#1675238" title="(x: List[A])List[A]">::</a> <a href="#121751" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">c</a>.<span title="=&gt; Iterator[scalaz.BKTree[A]]">valuesIterator</span>.<span title="=&gt; List[scalaz.BKTree[A]]">toList</span>.<span title="(f: scalaz.BKTree[A] =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[List[scalaz.BKTree[A]],A,List[A]])List[A]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,A,List[A]]" class="delimiter">(</span><a href="#121781" title="scalaz.BKTree[A]">_</a>.<a href="#119821" title="=&gt; List[A]">values</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>


  /**
   * Returns true of this set contains `a`.
   */
  @tailrec
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(a: A)(implicit A: scalaz.MetricSpace[A])Boolean" id="119822">contains</a><span class="delimiter">(</span><a title="A" id="121903">a</a>: <a href="#22848" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[A]" id="121904">A</a>: <a href="MetricSpace.scala.html#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675256" title="Boolean" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <a href="#1675261" title="(x: Boolean)Boolean" class="keyword">false</a>
      <span class="keyword">case</span> BKTreeNode<a href="#1675256" title="Boolean" class="delimiter">(</a><a href="#120278" title="A" id="121909">v</a>, _, <a href="#120280" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]" id="121910">c</a><span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="Int" id="121911">d</a> = <a href="#121904" title="scalaz.MetricSpace[A]">A</a>.<a href="MetricSpace.scala.html#106451" title="(a: A, b: A)Int">distance</a><span class="delimiter">(</span><a href="#121909" title="A">v</a>, <a href="#121903" title="A">a</a><span class="delimiter">)</span>
        <a href="#121911" title="Int">d</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><a href="#121910" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">c</a> <a href="#1675248" title="(key: scala.collection.immutable.IntMapUtils.Int)Option[scalaz.BKTree[A]]">get</a> <a href="#121911" title="Int">d</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#1675243" title="Boolean">None</a>    =&gt; <a href="#1675248" title="(x: Boolean)Boolean" class="keyword">false</a>
          <span class="keyword">case</span> Some<a href="#1675243" title="Boolean" class="delimiter">(</a><a href="#1675245" title="scalaz.BKTree[A]" id="121921">w</a><span class="delimiter">)</span> =&gt; <a href="#121921" title="scalaz.BKTree[A]">w</a> <a href="#1675248" title="(x: Boolean)Boolean">contains</a> <a href="#121903" title="A">a</a>
        <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  /** An alias for `contains` */
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(a: A)(implicit A: scalaz.MetricSpace[A])Boolean" id="119823">-?-</a><span class="delimiter">(</span><a title="A" id="121922">a</a>: <a href="#22848" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[A]" id="121923">A</a>: <a href="MetricSpace.scala.html#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#119822" title="(a: A)(implicit A: scalaz.MetricSpace[A])Boolean">contains</a><a href="#121923" title="scalaz.MetricSpace[A]" class="delimiter">(</a><a href="#121922" title="A">a</a><span class="delimiter">)</span>

  /** Returns true if this set contains an element which has a distance from `a` that is less than or equal to `n` */
  <span class="keyword">def</span> <a title="(a: A, n: Int)(implicit A: scalaz.MetricSpace[A])Boolean" id="119824">containsApproximate</a><span class="delimiter">(</span><a title="A" id="121924">a</a>: <a href="#22848" title="A">A</a>, <a title="Int" id="121925">n</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[A]" id="121926">A</a>: <a href="MetricSpace.scala.html#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675266" title="Boolean" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <a href="#1675271" title="(x: Boolean)Boolean" class="keyword">false</a>
      <span class="keyword">case</span> BKTreeNode<a href="#1675266" title="Boolean" class="delimiter">(</a><a href="#120278" title="A" id="121930">v</a>, _, c<span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="Int" id="121932">d</a> = <a href="#121926" title="scalaz.MetricSpace[A]">A</a>.<a href="MetricSpace.scala.html#106451" title="(a: A, b: A)Int">distance</a><span class="delimiter">(</span><a href="#121930" title="A">v</a>, <a href="#121924" title="A">a</a><span class="delimiter">)</span>
        <a href="#121932" title="Int">d</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#121925" title="Int">n</a> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><a href="#119830" title="(d: Int, n: Int)BKTree.this.M[scalaz.BKTree[A]]">subChildren</a><span class="delimiter">(</span><a href="#121932" title="Int">d</a>, <a href="#121925" title="Int">n</a><span class="delimiter">)</span> <span title="(p: ((scala.collection.immutable.IntMapUtils.Int, scalaz.BKTree[A])) =&gt; Boolean)Boolean">exists</span> <span class="delimiter">(</span><a href="#121959" title="(scala.collection.immutable.IntMapUtils.Int, scalaz.BKTree[A])">_</a>.<span title="=&gt; scalaz.BKTree[A]">_2</span> <a href="#119824" title="(a: A, n: Int)(implicit A: scalaz.MetricSpace[A])Boolean">containsApproximate</a><span class="delimiter">(</span><a href="#121924" title="A">a</a>, <a href="#121925" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  /** An alias for `containsApproximate` */
  <span class="keyword">def</span> <a title="(a: A, n: Int)(implicit A: scalaz.MetricSpace[A])Boolean" id="119825">=?=</a><span class="delimiter">(</span><a title="A" id="121960">a</a>: <a href="#22848" title="A">A</a>, <a title="Int" id="121961">n</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[A]" id="121962">A</a>: <a href="MetricSpace.scala.html#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#119824" title="(a: A, n: Int)(implicit A: scalaz.MetricSpace[A])Boolean">containsApproximate</a><a href="#121962" title="scalaz.MetricSpace[A]" class="delimiter">(</a><a href="#121960" title="A">a</a>, <a href="#121961" title="Int">n</a><span class="delimiter">)</span>

  /** Returns the elements which have an distance from `a` that is less than or equal to `n`. */
  <span class="keyword">def</span> <a title="(a: A, n: Int)(implicit A: scalaz.MetricSpace[A])List[A]" id="119826">valuesApproximate</a><span class="delimiter">(</span><a title="A" id="121963">a</a>: <a href="#22848" title="A">A</a>, <a title="Int" id="121964">n</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[A]" id="121965">A</a>: <a href="MetricSpace.scala.html#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675276" title="List[A]" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <a href="#1675281" title="(x: List[A])List[A]">Nil</a>
      <span class="keyword">case</span> BKTreeNode<a href="#1675276" title="List[A]" class="delimiter">(</a><a href="#120278" title="A" id="121969">v</a>, _, c<span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="Int" id="121971">d</a> = <a href="#121965" title="scalaz.MetricSpace[A]">A</a>.<a href="MetricSpace.scala.html#106451" title="(a: A, b: A)Int">distance</a><span class="delimiter">(</span><a href="#121969" title="A">v</a>, <a href="#121963" title="A">a</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="List[A]" id="121972">k</a> = <a href="#119830" title="(d: Int, n: Int)BKTree.this.M[scalaz.BKTree[A]]">subChildren</a><span class="delimiter">(</span><a href="#121971" title="Int">d</a>, <a href="#121964" title="Int">n</a><span class="delimiter">)</span>.<span title="=&gt; Iterator[scalaz.BKTree[A]]">valuesIterator</span>.<span title="=&gt; List[scalaz.BKTree[A]]">toList</span> <span title="(f: scalaz.BKTree[A] =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[List[scalaz.BKTree[A]],A,List[A]])List[A]">flatMap</span> <span class="delimiter">(</span><a href="#122003" title="scalaz.BKTree[A]">_</a> <a href="#119826" title="(a: A, n: Int)(implicit A: scalaz.MetricSpace[A])List[A]">valuesApproximate</a><span class="delimiter">(</span><a href="#121963" title="A">a</a>, <a href="#121964" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="List[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#121971" title="Int">d</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#121964" title="Int">n</a><span class="delimiter">)</span>
          <a href="#121969" title="A">v</a> <a href="#122036" title="(x: A)List[A]">::</a> <a href="#121972" title="List[A]">k</a>
        <span class="keyword">else</span>
          <a href="#121972" title="List[A]">k</a>
    <span class="delimiter">}</span>

  /** An alias for `valuesApproximate` */
  <span class="keyword">def</span> <a title="(a: A, n: Int)(implicit A: scalaz.MetricSpace[A])List[A]" id="119827">|=|</a><span class="delimiter">(</span><a title="A" id="122042">a</a>: <a href="#22848" title="A">A</a>, <a title="Int" id="122043">n</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[A]" id="122044">A</a>: <a href="MetricSpace.scala.html#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#119826" title="(a: A, n: Int)(implicit A: scalaz.MetricSpace[A])List[A]">valuesApproximate</a><a href="#122044" title="scalaz.MetricSpace[A]" class="delimiter">(</a><a href="#122042" title="A">a</a>, <a href="#122043" title="Int">n</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">type</span> <a title="[A]scala.collection.immutable.IntMap[A]" id="119828">M</a><span class="delimiter">[</span><a title="" id="119829">A</a><span class="delimiter">]</span> = <span title="scala.collection.immutable.IntMap[A]">IntMap</span><span class="delimiter">[</span>A<span class="delimiter">]</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(d: Int, n: Int)BKTree.this.M[scalaz.BKTree[A]]" id="119830">subChildren</a><span class="delimiter">(</span><a title="Int" id="121939">d</a>: <span title="Int">Int</span>, <a title="Int" id="121940">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="BKTree.this.M[scalaz.BKTree[A]]">M</span><span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675286" title="BKTree.this.M[scalaz.BKTree[A]]" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <span title="scala.collection.immutable.IntMap.type">IntMap</span>.<a href="#1675292" title="(x: BKTree.this.M[scalaz.BKTree[A]])BKTree.this.M[scalaz.BKTree[A]]">empty</a>
      <span class="keyword">case</span> BKTreeNode<a href="#1675286" title="BKTree.this.M[scalaz.BKTree[A]]" class="delimiter">(</a>_, _, <a href="#120280" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]" id="122056">c</a><span class="delimiter">)</span> =&gt; <a href="#119831" title="(m: BKTree.this.M[scalaz.BKTree[A]], d: Int, n: Int)BKTree.this.M[scalaz.BKTree[A]]">subMap</a><a href="#1675292" title="(x: BKTree.this.M[scalaz.BKTree[A]])BKTree.this.M[scalaz.BKTree[A]]" class="delimiter">(</a><a href="#122056" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">c</a>, <a href="#121939" title="Int">d</a>, <a href="#121940" title="Int">n</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(m: BKTree.this.M[scalaz.BKTree[A]], d: Int, n: Int)BKTree.this.M[scalaz.BKTree[A]]" id="119831">subMap</a><span class="delimiter">(</span><a title="BKTree.this.M[scalaz.BKTree[A]]" id="122057">m</a>: <span title="BKTree.this.M[scalaz.BKTree[A]]">M</span><span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Int" id="122058">d</a>: <span title="Int">Int</span>, <a title="Int" id="122059">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="BKTree.this.M[scalaz.BKTree[A]]">M</span><span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#119833" title="(m: BKTree.this.M[scalaz.BKTree[A]], k: Int)(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])">splitMap</a><span class="delimiter">(</span><a href="#119833" title="(m: BKTree.this.M[scalaz.BKTree[A]], k: Int)(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])">splitMap</a><span class="delimiter">(</span><a href="#122057" title="BKTree.this.M[scalaz.BKTree[A]]">m</a>, <a href="#122058" title="Int">d</a> <span title="(x: Int)Int">-</span> <a href="#122059" title="Int">n</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="=&gt; BKTree.this.M[scalaz.BKTree[A]]">_2</span>, <a href="#122058" title="Int">d</a> <span title="(x: Int)Int">+</span> <a href="#122059" title="Int">n</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="=&gt; BKTree.this.M[scalaz.BKTree[A]]">_1</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(k: Int)(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])" id="119832">splitChildren</a><span class="delimiter">(</span><a title="Int" id="122080">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])" class="delimiter">(</span>M<span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>, M<span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#18626" title="scalaz.BKTree[A]" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> BKTreeEmpty<a href="#1675297" title="(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])" class="delimiter">(</a><span class="delimiter">)</span>       =&gt; <a href="#1675303" title="(x: (BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]]))(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])" class="delimiter">(</a><span title="scala.collection.immutable.IntMap.type">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span>, <span title="scala.collection.immutable.IntMap.type">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span><span class="delimiter">)</span>
      <span class="keyword">case</span> BKTreeNode<a href="#1675297" title="(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])" class="delimiter">(</a>_, _, <a href="#120280" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]" id="122106">c</a><span class="delimiter">)</span> =&gt; <a href="#119833" title="(m: BKTree.this.M[scalaz.BKTree[A]], k: Int)(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])">splitMap</a><a href="#1675303" title="(x: (BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]]))(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])" class="delimiter">(</a><a href="#122106" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">c</a>, <a href="#122080" title="Int">k</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(m: BKTree.this.M[scalaz.BKTree[A]], k: Int)(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])" id="119833">splitMap</a><span class="delimiter">(</span><a title="BKTree.this.M[scalaz.BKTree[A]]" id="122060">m</a>: <span title="BKTree.this.M[scalaz.BKTree[A]]">M</span><span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Int" id="122061">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])" class="delimiter">(</span>M<span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>, M<span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="BKTree.this.M[scalaz.BKTree[A]]" id="122107">m1</a>: <span title="BKTree.this.M[scalaz.BKTree[A]]">M</span><span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="scala.collection.immutable.IntMap.type">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span>
    <span class="keyword">var</span> <a title="BKTree.this.M[scalaz.BKTree[A]]" id="122108">m2</a>: <span title="BKTree.this.M[scalaz.BKTree[A]]">M</span><span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="scala.collection.immutable.IntMap.type">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#1675315" title="scala.collection.immutable.IntMapUtils.Int" id="122147">i</a>, <a href="#1675315" title="scalaz.BKTree[A]" id="122148">v</a><span class="delimiter">)</span> &lt;- <a href="#122060" title="BKTree.this.M[scalaz.BKTree[A]]">m</a>.<a href="#122127" title="(f: ((scala.collection.immutable.IntMapUtils.Int, scalaz.BKTree[A])) =&gt; Unit)Unit">iterator</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1675317" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#122147" title="scala.collection.immutable.IntMapUtils.Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#122061" title="Int">k</a><span class="delimiter">)</span>
        <a href="#122107" title="BKTree.this.M[scalaz.BKTree[A]]">m1</a> = <a href="#122107" title="BKTree.this.M[scalaz.BKTree[A]]">m1</a> <span title="(kv: (scala.collection.immutable.IntMapUtils.Int, scalaz.BKTree[A]))scala.collection.immutable.IntMap[scalaz.BKTree[A]]">+</span> <span class="delimiter">(</span><span title="(_1: scala.collection.immutable.IntMapUtils.Int, _2: scalaz.BKTree[A])(scala.collection.immutable.IntMapUtils.Int, scalaz.BKTree[A])" class="delimiter">(</span><a href="#122147" title="scala.collection.immutable.IntMapUtils.Int">i</a>, <a href="#122148" title="scalaz.BKTree[A]">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#122147" title="scala.collection.immutable.IntMapUtils.Int">i</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#122061" title="Int">k</a><span class="delimiter">)</span>
        <a href="#122108" title="BKTree.this.M[scalaz.BKTree[A]]">m2</a> = <a href="#122108" title="BKTree.this.M[scalaz.BKTree[A]]">m2</a> <span title="(kv: (scala.collection.immutable.IntMapUtils.Int, scalaz.BKTree[A]))scala.collection.immutable.IntMap[scalaz.BKTree[A]]">+</span> <span class="delimiter">(</span><span title="(_1: scala.collection.immutable.IntMapUtils.Int, _2: scalaz.BKTree[A])(scala.collection.immutable.IntMapUtils.Int, scalaz.BKTree[A])" class="delimiter">(</span><a href="#122147" title="scala.collection.immutable.IntMapUtils.Int">i</a>, <a href="#122148" title="scalaz.BKTree[A]">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span title="(_1: BKTree.this.M[scalaz.BKTree[A]], _2: BKTree.this.M[scalaz.BKTree[A]])(BKTree.this.M[scalaz.BKTree[A]], BKTree.this.M[scalaz.BKTree[A]])" class="delimiter">(</span><a href="#122107" title="BKTree.this.M[scalaz.BKTree[A]]">m1</a>, <a href="#122108" title="BKTree.this.M[scalaz.BKTree[A]]">m2</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(m: BKTree.this.M[scalaz.BKTree[A]], k: Int, f: scalaz.BKTree[A] =&gt; Option[scalaz.BKTree[A]])BKTree.this.M[scalaz.BKTree[A]]" id="119834">updateMap</a><span class="delimiter">(</span><a title="BKTree.this.M[scalaz.BKTree[A]]" id="120716">m</a>: <span title="BKTree.this.M[scalaz.BKTree[A]]">M</span><span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Int" id="120717">k</a>: <span title="Int">Int</span>, <a title="scalaz.BKTree[A] =&gt; Option[scalaz.BKTree[A]]" id="120718">f</a>: BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#120716" title="BKTree.this.M[scalaz.BKTree[A]]">m</a> <a href="#1675339" title="(key: scala.collection.immutable.IntMapUtils.Int)Option[scalaz.BKTree[A]]">get</a> <a href="#120717" title="Int">k</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#1675334" title="BKTree.this.M[scalaz.BKTree[A]]">None</a> =&gt; <a href="#1675339" title="(x: BKTree.this.M[scalaz.BKTree[A]])BKTree.this.M[scalaz.BKTree[A]]">m</a>
      <span class="keyword">case</span> Some<a href="#1675334" title="BKTree.this.M[scalaz.BKTree[A]]" class="delimiter">(</a><a href="#1675336" title="scalaz.BKTree[A]" id="120722">v</a><span class="delimiter">)</span> =&gt; <a href="#120718" title="(v1: scalaz.BKTree[A])Option[scalaz.BKTree[A]]">f</a><a href="#1675339" title="(x: BKTree.this.M[scalaz.BKTree[A]])BKTree.this.M[scalaz.BKTree[A]]" class="delimiter">(</a><a href="#120722" title="scalaz.BKTree[A]">v</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#1675321" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">None</a> =&gt; <a href="#120716" title="BKTree.this.M[scalaz.BKTree[A]]">m</a> <a href="#1675326" title="(x: scala.collection.immutable.IntMap[scalaz.BKTree[A]])scala.collection.immutable.IntMap[scalaz.BKTree[A]]">-</a> <a href="#120717" title="Int">k</a>
        <span class="keyword">case</span> Some<a href="#1675321" title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]" class="delimiter">(</a><a href="#1675323" title="scalaz.BKTree[A]" id="120733">value</a><span class="delimiter">)</span> =&gt; <a href="#120716" title="BKTree.this.M[scalaz.BKTree[A]]">m</a>.<span title="(key: scala.collection.immutable.IntMapUtils.Int, value: scalaz.BKTree[A])scala.collection.immutable.IntMap[scalaz.BKTree[A]]">updated</span><a href="#1675326" title="(x: scala.collection.immutable.IntMap[scalaz.BKTree[A]])scala.collection.immutable.IntMap[scalaz.BKTree[A]]" class="delimiter">(</a><a href="#120717" title="Int">k</a>, <a href="#120733" title="scalaz.BKTree[A]">value</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">private</span> <span class="keyword">case class</span> <a href="#122336" title="class BKTreeNode[A] extends AnyRef with scalaz.BKTree[A] with Product with Serializable" id="122939">BKTreeNode</a><span class="delimiter">[</span><a title="" id="119865">A</a><span class="delimiter">]</span><a href="#122939" title="Product" class="delimiter">(</a><a title="A" id="120278">value</a>: <a href="#119865" title="A">A</a>, <a title="Int" id="120279">sz</a>: <span title="Int">Int</span>, <a title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]" id="120280">children</a>: <span title="scala.collection.immutable.IntMap[scalaz.BKTree[A]]">IntMap</span><span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span>

<span class="keyword">private</span> <span class="keyword">case class</span> <a href="#122388" title="class BKTreeEmpty[A] extends AnyRef with scalaz.BKTree[A] with Product with Serializable" id="122932">BKTreeEmpty</a><span class="delimiter">[</span><a title="" id="119851">A</a><span class="delimiter">]</span><a href="#122932" title="Product" class="delimiter">(</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span>

<span class="keyword">object</span> <a title="scalaz.BKTree.type" id="18627">BKTree</a> <a href="#18628" title="scalaz.BKTree.type" class="keyword">extends</a> <a href="#17501" title="scalaz.BKTreeFunctions">BKTreeFunctions</a> <span class="keyword">with</span> <a href="#22055" title="scalaz.BKTreeInstances">BKTreeInstances</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[A](as: A*)(implicit evidence$1: scalaz.MetricSpace[A])scalaz.BKTree[A]" id="120616">apply</a><span class="delimiter">[</span><a title="" id="119810">A</a>: MetricSpace<span class="delimiter">]</span><span class="delimiter">(</span><a title="A*" id="120615">as</a>: <span title="A*">A</span>*<span class="delimiter">)</span>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#120615" title="A*">as</a>.<span title="(z: scalaz.BKTree[A])(op: (scalaz.BKTree[A], A) =&gt; scalaz.BKTree[A])scalaz.BKTree[A]">foldLeft</span><span class="delimiter">(</span><a href="#119804" title="[A]=&gt; scalaz.BKTree[A]">emptyBKTree</a><span title="scalaz.BKTree[A]" class="delimiter">[</span><a href="#119810" title="A">A</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="scalaz.BKTree[A]" id="122421">b</a>, <a title="A" id="122422">a</a><span class="delimiter">)</span> =&gt; <a href="#122421" title="scalaz.BKTree[A]">b</a> <a href="#119817" title="(a: A)(implicit A: scalaz.MetricSpace[A])scalaz.BKTree[A]">+</a> <a href="#122422" title="A">a</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait BKTreeFunctions extends AnyRef" id="17501">BKTreeFunctions</a> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[A]=&gt; scalaz.BKTree[A]" id="119804">emptyBKTree</a><span class="delimiter">[</span><a title="" id="119806">A</a><span class="delimiter">]</span>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#122932" title="()scalaz.BKTreeEmpty[A]">BKTreeEmpty</a><span class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">trait</span> <a title="trait BKTreeInstances extends AnyRef" id="22055">BKTreeInstances</a> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; scalaz.Functor[scalaz.BKTree] with scalaz.Length[scalaz.BKTree]" id="119836">bKTreeInstance</a>: <a href="#120455" title="BKTreeInstances extends scalaz.Functor[scalaz.BKTree] with scalaz.Length[scalaz.BKTree]">Functor</a><span class="delimiter">[</span>BKTree<span class="delimiter">]</span> <span class="keyword">with</span> Length<span class="delimiter">[</span>BKTree<span class="delimiter">]</span> = <a href="#122428" title="scalaz.Functor[scalaz.BKTree] with scalaz.Length[scalaz.BKTree]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.Functor[scalaz.BKTree] with scalaz.Length[scalaz.BKTree]" id="122428">Functor</a><span class="delimiter">[</span>BKTree<span class="delimiter">]</span> <span class="keyword">with</span> <a href="Length.scala.html#8522" title="scalaz.Length[scalaz.BKTree]">Length</a><span class="delimiter">[</span>BKTree<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A, B](fa: scalaz.BKTree[A])(f: A =&gt; B)scalaz.BKTree[B]" id="122430">map</a><span class="delimiter">[</span><a title="" id="122433">A</a>, <a title="" id="122434">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.BKTree[A]" id="122438">fa</a>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="A =&gt; B" id="122439">f</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#18626" title="scalaz.BKTree[B]">BKTree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <a href="#122438" title="scalaz.BKTree[A]">fa</a> <a href="#119813" title="(f: A =&gt; B)scalaz.BKTree[B]">map</a> <a href="#122439" title="A =&gt; B">f</a>
    <span class="keyword">def</span> <a title="[A](fa: scalaz.BKTree[A])Int" id="122435">length</a><span class="delimiter">[</span><a title="" id="122437">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.BKTree[A]" id="122450">fa</a>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <a href="#122450" title="scalaz.BKTree[A]">fa</a>.<a href="#119816" title="=&gt; Int">size</a>
  <span class="delimiter">}</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](implicit evidence$2: scalaz.MetricSpace[A])scalaz.Monoid[scalaz.BKTree[A]]" id="120453">bKTreeMonoid</a><span class="delimiter">[</span><a title="" id="119839">A</a>: MetricSpace<span class="delimiter">]</span>: <a href="Monoid.scala.html#12518" title="scalaz.Monoid[scalaz.BKTree[A]]">Monoid</a><span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#122472" title="scalaz.Monoid[scalaz.BKTree[A]]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.Monoid[scalaz.BKTree[A]]" id="122472">Monoid</a><span class="delimiter">[</span>BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(f1: scalaz.BKTree[A], f2: =&gt; scalaz.BKTree[A])scalaz.BKTree[A]" id="122474">append</a><span class="delimiter">(</span><a title="scalaz.BKTree[A]" id="122478">f1</a>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="=&gt; scalaz.BKTree[A]" id="122479">f2</a>: =&gt; BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#122478" title="scalaz.BKTree[A]">f1</a> <a href="#119818" title="(t: scalaz.BKTree[A])(implicit m: scalaz.MetricSpace[A])scalaz.BKTree[A]">++</a> <a href="#122479" title="=&gt; scalaz.BKTree[A]">f2</a>
    <span class="keyword">def</span> <a title="=&gt; scalaz.BKTree[A]" id="122475">zero</a>: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#120616" title="[A](as: A*)(implicit evidence$1: scalaz.MetricSpace[A])scalaz.BKTree[A]">BKTree</a><span title="(as: A*)(implicit evidence$1: scalaz.MetricSpace[A])scalaz.BKTree[A]" class="delimiter">[</span><a href="#119839" title="A">A</a><span class="delimiter">]</span><a href="#120453" title="scalaz.MetricSpace[A]" class="delimiter">(</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](implicit A: scalaz.Equal[A])scalaz.Equal[scalaz.BKTree[A]]" id="119840">bkTreeEqual</a><span class="delimiter">[</span><a title="" id="119842">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Equal[A]" id="122491">A</a>: <a href="Equal.scala.html#19253" title="scalaz.Equal[A]">Equal</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> std.<a href="std/List.scala.html#25475" title="scalaz.std.list.type">list</a>._
    <a href="Equal.scala.html#19254" title="scalaz.Equal.type">Equal</a>.<a href="Equal.scala.html#50782" title="(f: scalaz.BKTree[A] =&gt; List[A])(implicit evidence$1: scalaz.Equal[List[A]])scalaz.Equal[scalaz.BKTree[A]]">equalBy</a><a href="std/List.scala.html#45735" title="(implicit A0: scalaz.Equal[A])scalaz.std.ListEqual[A]" class="delimiter">(</a><span class="delimiter">(</span>ba: <a href="#18626" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <a href="#122503" title="scalaz.BKTree[A]">ba</a>.<a href="#119821" title="=&gt; List[A]">values</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>core/MetricSpace.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz

////
/**
 * Useful metric spaces include the manhattan distance between two points,
 * the Levenshtein edit distance between two strings, the number of
 * edges in the shortest path between two nodes in an undirected graph
 * and the Hamming distance between two binary strings. Any euclidean
 * space also has a metric. However, in this module we use int-valued
 * metrics and that's not compatible with the metrics of euclidean
 * spaces which are real-values.
 *
 * @see [[scalaz.BKTree]]
 */
////
<span class="keyword">trait</span> <a title="trait MetricSpace[F] extends AnyRef" id="18914">MetricSpace</a><span class="delimiter">[</span><a title="" id="23478">F</a><span class="delimiter">]</span>  <span title="Unit" class="delimiter">{</span> self =&gt;
  ////
  <span class="keyword">def</span> <a title="(a: F, b: F)Int" id="106451">distance</a><span class="delimiter">(</span><a title="F" id="120443">a</a>: <a href="#23478" title="F">F</a>, <a title="F" id="120444">b</a>: <a href="#23478" title="F">F</a><span class="delimiter">)</span>: <span title="Int">Int</span>

  <span class="keyword">def</span> <a title="[B](f: B =&gt; F)scalaz.MetricSpace[B]" id="106452">contramap</a><span class="delimiter">[</span><a title="" id="106454">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B =&gt; F" id="395374">f</a>: B =&gt; F<span class="delimiter">)</span>: <a href="#18914" title="scalaz.MetricSpace[B]">MetricSpace</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <a href="#395376" title="scalaz.MetricSpace[B]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.MetricSpace[B]" id="395376">MetricSpace</a><span class="delimiter">[</span>B<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(a: B, b: B)Int" id="395378">distance</a><span class="delimiter">(</span><a title="B" id="395380">a</a>: <a href="#106454" title="B">B</a>, <a title="B" id="395381">b</a>: <a href="#106454" title="B">B</a><span class="delimiter">)</span>: <span title="Int">Int</span> = <a href="#18914" title="MetricSpace.this.type">self</a>.<a href="#106451" title="(a: F, b: F)Int">distance</a><span class="delimiter">(</span><a href="#395374" title="(v1: B)F">f</a><span class="delimiter">(</span><a href="#395380" title="B">a</a><span class="delimiter">)</span>, <a href="#395374" title="(v1: B)F">f</a><span class="delimiter">(</span><a href="#395381" title="B">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  // derived functions

  <span class="keyword">trait</span> <a title="trait MetricSpaceLaw extends AnyRef" id="106455">MetricSpaceLaw</a> <span title="Unit" class="delimiter">{</span>

    <span class="keyword">import</span> std.<a href="std/AnyVal.scala.html#25322" title="scalaz.std.boolean.type">boolean</a>.conditional

    <span class="keyword">def</span> <a title="(a1: F, a2: F)Boolean" id="395392">nonNegativity</a><span class="delimiter">(</span><a title="F" id="395398">a1</a>: <a href="#23478" title="F">F</a>, <a title="F" id="395399">a2</a>: <a href="#23478" title="F">F</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#106451" title="(a: F, b: F)Int">distance</a><span class="delimiter">(</span><a href="#395398" title="F">a1</a>, <a href="#395398" title="F">a1</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span>
    <span class="keyword">def</span> <a title="(a1: F)Boolean" id="395393">identity</a><span class="delimiter">(</span><a title="F" id="395404">a1</a>: <a href="#23478" title="F">F</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#106451" title="(a: F, b: F)Int">distance</a><span class="delimiter">(</span><a href="#395404" title="F">a1</a>, <a href="#395404" title="F">a1</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span>
    <span class="keyword">def</span> <a title="(a1: F, a2: F)(implicit F: scalaz.Equal[F])Boolean" id="395394">equality</a><span class="delimiter">(</span><a title="F" id="395410">a1</a>: <a href="#23478" title="F">F</a>, <a title="F" id="395411">a2</a>: <a href="#23478" title="F">F</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Equal[F]" id="395412">F</a>: <a href="Equal.scala.html#19253" title="scalaz.Equal[F]">Equal</a><span class="delimiter">[</span>F<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="std/AnyVal.scala.html#258583" title="(p: Boolean, q: =&gt; Boolean)Boolean">conditional</a><span class="delimiter">(</span><a href="#395412" title="scalaz.Equal[F]">F</a>.<a href="Equal.scala.html#50753" title="(a1: F, a2: F)Boolean">equal</a><span class="delimiter">(</span><a href="#395410" title="F">a1</a>, <a href="#395411" title="F">a2</a><span class="delimiter">)</span>, <a href="#106451" title="(a: F, b: F)Int">distance</a><span class="delimiter">(</span><a href="#395410" title="F">a1</a>, <a href="#395411" title="F">a2</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(a1: F, a2: F)Boolean" id="395395">symmetry</a><span class="delimiter">(</span><a title="F" id="395420">a1</a>: <a href="#23478" title="F">F</a>, <a title="F" id="395421">a2</a>: <a href="#23478" title="F">F</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#106451" title="(a: F, b: F)Int">distance</a><span class="delimiter">(</span><a href="#395420" title="F">a1</a>, <a href="#395421" title="F">a2</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">==</span> <a href="#106451" title="(a: F, b: F)Int">distance</a><span class="delimiter">(</span><a href="#395421" title="F">a2</a>, <a href="#395420" title="F">a1</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(a1: F, a2: F, a3: F)Boolean" id="395396">triangleInequality</a><span class="delimiter">(</span><a title="F" id="395427">a1</a>: <a href="#23478" title="F">F</a>, <a title="F" id="395428">a2</a>: <a href="#23478" title="F">F</a>, <a title="F" id="395429">a3</a>: <a href="#23478" title="F">F</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">(</span><a href="#106451" title="(a: F, b: F)Int">distance</a><span class="delimiter">(</span><a href="#395427" title="F">a1</a>, <a href="#395428" title="F">a2</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <a href="#106451" title="(a: F, b: F)Int">distance</a><span class="delimiter">(</span><a href="#395428" title="F">a2</a>, <a href="#395429" title="F">a3</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">&gt;=</span> <a href="#106451" title="(a: F, b: F)Int">distance</a><span class="delimiter">(</span><a href="#395427" title="F">a1</a>, <a href="#395429" title="F">a3</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; MetricSpace.this.MetricSpaceLaw" id="106456">metricSpaceLaw</a> = <a href="#395438" title="MetricSpace.this.MetricSpaceLaw" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with MetricSpace.this.MetricSpaceLaw" id="395438">MetricSpaceLaw</a> <span class="delimiter">{</span><span class="delimiter">}</span>

  ////
  <span class="keyword">val</span> <a title="metricSpaceSyntax extends AnyRef with scalaz.syntax.MetricSpaceSyntax[F]" id="106457">metricSpaceSyntax</a> = <a href="#395355" title="scalaz.syntax.MetricSpaceSyntax[F]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.syntax.MetricSpaceSyntax[F]" id="395355">scalaz</a>.syntax.<a href="syntax/MetricSpaceSyntax.scala.html#28132" title="scalaz.syntax.MetricSpaceSyntax[F]">MetricSpaceSyntax</a><span class="delimiter">[</span>F<span class="delimiter">]</span> <span class="delimiter">{</span> <span class="keyword">def</span> <a title="=&gt; scalaz.MetricSpace[F]" id="395360">F</a> = <a href="#18914" title="scalaz.MetricSpace[F]">MetricSpace</a>.<span class="keyword">this</span> <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">object</span> <a title="scalaz.MetricSpace.type" id="18915">MetricSpace</a> <a href="#18916" title="scalaz.MetricSpace.type" class="delimiter">{</a>
  @inline <span class="keyword">def</span> <a title="[F](implicit F: scalaz.MetricSpace[F])scalaz.MetricSpace[F]" id="395448">apply</a><span class="delimiter">[</span><a title="" id="395450">F</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.MetricSpace[F]" id="395532">F</a>: <a href="#18914" title="scalaz.MetricSpace[F]">MetricSpace</a><span class="delimiter">[</span>F<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#18914" title="scalaz.MetricSpace[F]">MetricSpace</a><span class="delimiter">[</span>F<span class="delimiter">]</span> = <a href="#395532" title="scalaz.MetricSpace[F]">F</a>

  ////
  <span class="keyword">val</span> <a title="metricSpaceInstance extends AnyRef with scalaz.Contravariant[scalaz.MetricSpace]" id="395451">metricSpaceInstance</a> = <a href="#395468" title="scalaz.Contravariant[scalaz.MetricSpace]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.Contravariant[scalaz.MetricSpace]" id="395468">Contravariant</a><span class="delimiter">[</span>MetricSpace<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A, B](r: scalaz.MetricSpace[A])(f: B =&gt; A)scalaz.MetricSpace[B]" id="395470">contramap</a><span class="delimiter">[</span><a title="" id="395473">A</a>, <a title="" id="395474">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.MetricSpace[A]" id="395475">r</a>: <a href="#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="B =&gt; A" id="395476">f</a>: B =&gt; A<span class="delimiter">)</span>: <a href="#18914" title="scalaz.MetricSpace[B]">MetricSpace</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <a href="#395475" title="scalaz.MetricSpace[A]">r</a> <a href="#106452" title="(f: B =&gt; A)scalaz.MetricSpace[B]">contramap</a> <a href="#395476" title="B =&gt; A">f</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[A](f: (A, A) =&gt; Int)scalaz.MetricSpace[A]" id="395453">metricSpace</a><span class="delimiter">[</span><a title="" id="395455">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, A) =&gt; Int" id="395535">f</a>: <span class="delimiter">(</span>A, A<span class="delimiter">)</span> =&gt; Int<span class="delimiter">)</span>: <a href="#18914" title="scalaz.MetricSpace[A]">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#395537" title="scalaz.MetricSpace[A]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.MetricSpace[A]" id="395537">MetricSpace</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(a1: A, a2: A)Int" id="395539">distance</a><span class="delimiter">(</span><a title="A" id="395541">a1</a>: <a href="#395455" title="A">A</a>, <a title="A" id="395542">a2</a>: <a href="#395455" title="A">A</a><span class="delimiter">)</span>: <span title="Int">Int</span> = <a href="#395535" title="(v1: A, v2: A)Int">f</a><span class="delimiter">(</span><a href="#395541" title="A">a1</a>, <a href="#395542" title="A">a2</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[F[_], A](implicit l: scalaz.Length[F], implicit i: scalaz.Index[F], implicit e: scalaz.Equal[A])scalaz.MetricSpace[F[A]]" id="395456">levenshtein</a><span class="delimiter">[</span><a title="[_]" id="395459">F</a><span class="delimiter">[</span><a title="" id="395553">_</a><span class="delimiter">]</span>, <a title="" id="395460">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Length[F]" id="395550">l</a>: <a href="Length.scala.html#8522" title="scalaz.Length[F]">Length</a><span class="delimiter">[</span>F<span class="delimiter">]</span>, <a title="scalaz.Index[F]" id="395551">i</a>: <a href="Index.scala.html#16436" title="scalaz.Index[F]">Index</a><span class="delimiter">[</span>F<span class="delimiter">]</span>, <a title="scalaz.Equal[A]" id="395552">e</a>: <a href="Equal.scala.html#19253" title="scalaz.Equal[A]">Equal</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#18914" title="scalaz.MetricSpace[F[A]]">MetricSpace</a><span class="delimiter">[</span>F<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#395557" title="scalaz.MetricSpace[F[A]]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.MetricSpace[F[A]]" id="395557">MetricSpace</a><span class="delimiter">[</span>F<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(a1: F[A], a2: F[A])Int" id="395559">distance</a><span class="delimiter">(</span><a title="F[A]" id="395561">a1</a>: <a href="#395459" title="F[A]">F</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="F[A]" id="395562">a2</a>: <a href="#395459" title="F[A]">F</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <a href="#395461" title="(value: F[A], w: F[A])(implicit l: scalaz.Length[F], implicit ind: scalaz.Index[F], implicit equ: scalaz.Equal[A])Int">levenshteinDistance</a><a href="#395550" title="scalaz.Length[F]" class="delimiter">(</a><a href="#395561" title="F[A]">a1</a>, <a href="#395562" title="F[A]">a2</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[F[_], A](value: F[A], w: F[A])(implicit l: scalaz.Length[F], implicit ind: scalaz.Index[F], implicit equ: scalaz.Equal[A])Int" id="395461">levenshteinDistance</a><span class="delimiter">[</span><a title="[_]" id="395464">F</a><span class="delimiter">[</span><a title="" id="395573">_</a><span class="delimiter">]</span>, <a title="" id="395465">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="F[A]" id="395568">value</a>: <a href="#395464" title="F[A]">F</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="F[A]" id="395569">w</a>: <a href="#395464" title="F[A]">F</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Length[F]" id="395570">l</a>: <a href="Length.scala.html#8522" title="scalaz.Length[F]">Length</a><span class="delimiter">[</span>F<span class="delimiter">]</span>, <a title="scalaz.Index[F]" id="395571">ind</a>: <a href="Index.scala.html#16436" title="scalaz.Index[F]">Index</a><span class="delimiter">[</span>F<span class="delimiter">]</span>, <a title="scalaz.Equal[A]" id="395572">equ</a>: <a href="Equal.scala.html#19253" title="scalaz.Equal[A]">Equal</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="Memo.scala.html#7641" title="scalaz.Memo.type">Memo</a>._
    <span class="keyword">def</span> <a title="(w: F[A])(implicit l: scalaz.Length[F], implicit ind: scalaz.Index[F], implicit equ: scalaz.Equal[A])(Int, Int) =&gt; Int" id="395599">levenshteinMatrix</a><span class="delimiter">(</span><a title="F[A]" id="395601">w</a>: <a href="#395464" title="F[A]">F</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Length[F]" id="395602">l</a>: <a href="Length.scala.html#8522" title="scalaz.Length[F]">Length</a><span class="delimiter">[</span>F<span class="delimiter">]</span>, <a title="scalaz.Index[F]" id="395603">ind</a>: <a href="Index.scala.html#16436" title="scalaz.Index[F]">Index</a><span class="delimiter">[</span>F<span class="delimiter">]</span>, <a title="scalaz.Equal[A]" id="395604">equ</a>: <a href="Equal.scala.html#19253" title="scalaz.Equal[A]">Equal</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span>Int, Int<span class="delimiter">)</span> =&gt; Int = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scalaz.Memo[(Int, Int),Int]" id="395605">m</a> = <a href="Memo.scala.html#392873" title="[K, V]=&gt; scalaz.Memo[K,V]">mutableHashMapMemo</a><span title="scalaz.Memo[(Int, Int),Int]" class="delimiter">[</span><span title="(Int, Int)" class="delimiter">(</span>Int, Int<span class="delimiter">)</span>, <span title="Int">Int</span><span class="delimiter">]</span>

      <span class="keyword">def</span> <a title="(i: Int, j: Int)Int" id="395606">get</a><span class="delimiter">(</span><a title="Int" id="395607">i</a>: <span title="Int">Int</span>, <a title="Int" id="395608">j</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#395607" title="Int">i</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#395608" title="Int">j</a>
      <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#395608" title="Int">j</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#395607" title="Int">i</a>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="A" id="395617">t</a>: <a href="#395465" title="A">A</a> = <a href="#395603" title="scalaz.Index[F]">ind</a>.<a href="Index.scala.html#68570" title="(fa: F[A], i: Int)Option[A]">index</a><span class="delimiter">(</span><a href="#395568" title="F[A]">value</a>, <span class="delimiter">(</span><a href="#395607" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; A">get</span>
        <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="A" id="395619">u</a>: <a href="#395465" title="A">A</a> = <a href="#395603" title="scalaz.Index[F]">ind</a>.<a href="Index.scala.html#68570" title="(fa: F[A], i: Int)Option[A]">index</a><span class="delimiter">(</span><a href="#395601" title="F[A]">w</a>, <span class="delimiter">(</span><a href="#395608" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; A">get</span>
        <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Boolean" id="395621">e</a>: <span title="Boolean">Boolean</span> = <a href="#395604" title="scalaz.Equal[A]">equ</a>.<a href="Equal.scala.html#50753" title="(a1: A, a2: A)Boolean">equal</a><span class="delimiter">(</span><a href="#395617" title="=&gt; A">t</a>, <a href="#395619" title="=&gt; A">u</a><span class="delimiter">)</span>


        <span class="keyword">val</span> <a title="((Int, Int)) =&gt; Int" id="395623">g</a>: <span class="delimiter">(</span><span class="delimiter">(</span>Int, Int<span class="delimiter">)</span><span class="delimiter">)</span> =&gt; Int = <a href="Memo.scala.html#392835" title="(z: ((Int, Int)) =&gt; Int)((Int, Int)) =&gt; Int">m</a> <a href="#395651" title="(Int, Int)" class="delimiter">{</a>
          <span class="keyword">case</span> <span class="delimiter">(</span><a href="#1679260" title="Int" id="395654">a</a>, <a href="#1679260" title="Int" id="395655">b</a><span class="delimiter">)</span> =&gt; <a href="#395606" title="(i: Int, j: Int)Int">get</a><a href="#1679262" title="(x: Int)Int" class="delimiter">(</a><a href="#395654" title="Int">a</a>, <a href="#395655" title="Int">b</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="Int" id="395624">a</a>: <span title="Int">Int</span> = <a href="#395623" title="(v1: (Int, Int))Int">g</a><span class="delimiter">(</span><span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><a href="#395607" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#395608" title="Int">j</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
        <span class="keyword">val</span> <a title="Int" id="395625">b</a>: <span title="Int">Int</span> = <a href="#395623" title="(v1: (Int, Int))Int">g</a><span class="delimiter">(</span><span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><a href="#395607" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#395608" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#395621" title="=&gt; Boolean">e</a><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> <span class="keyword">else</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="=&gt; Int" id="395626">c</a>: <span title="Int">Int</span> = <a href="#395623" title="(v1: (Int, Int))Int">g</a><span class="delimiter">(</span><span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><a href="#395607" title="Int">i</a>, <a href="#395608" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
        <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#395624" title="Int">a</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#395625" title="Int">b</a><span class="delimiter">)</span> <a href="#395624" title="Int">a</a> <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#395625" title="Int">b</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#395626" title="=&gt; Int">c</a><span class="delimiter">)</span> <a href="#395625" title="Int">b</a> <span class="keyword">else</span> <a href="#395626" title="=&gt; Int">c</a>
      <span class="delimiter">}</span>

      <a href="#395606" title="(i: Int, j: Int)Int">get</a>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="(Int, Int) =&gt; Int" id="395600">k</a> = <a href="#395599" title="(w: F[A])(implicit l: scalaz.Length[F], implicit ind: scalaz.Index[F], implicit equ: scalaz.Equal[A])(Int, Int) =&gt; Int">levenshteinMatrix</a><a href="#395570" title="scalaz.Length[F]" class="delimiter">(</a><a href="#395569" title="F[A]">w</a><span class="delimiter">)</span>
    <a href="#395600" title="(v1: Int, v2: Int)Int">k</a><span class="delimiter">(</span><a href="#395570" title="scalaz.Length[F]">l</a>.<a href="Length.scala.html#68580" title="(fa: F[A])Int">length</a><span class="delimiter">(</span><a href="#395568" title="F[A]">value</a><span class="delimiter">)</span>, <a href="#395570" title="scalaz.Length[F]">l</a>.<a href="Length.scala.html#68580" title="(fa: F[A])Int">length</a><span class="delimiter">(</span><a href="#395569" title="F[A]">w</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; scalaz.MetricSpace[String]" id="395466">LevenshteinString</a>: <a href="#18914" title="scalaz.MetricSpace[String]">MetricSpace</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> std.<a href="std/List.scala.html#25475" title="scalaz.std.list.type">list</a>._, std.<a href="std/AnyVal.scala.html#24509" title="scalaz.std.anyVal.type">anyVal</a>._
    <a href="#395456" title="[F[_], A](implicit l: scalaz.Length[F], implicit i: scalaz.Index[F], implicit e: scalaz.Equal[A])scalaz.MetricSpace[F[A]]">levenshtein</a><a href="std/List.scala.html#45739" title="(implicit l: scalaz.Length[List], implicit i: scalaz.Index[List], implicit e: scalaz.Equal[Char])scalaz.MetricSpace[List[Char]]" class="delimiter">[</a><span title="List">List</span>, <span title="Char">Char</span><span class="delimiter">]</span>.<a href="#106452" title="(f: String =&gt; List[Char])scalaz.MetricSpace[String]">contramap</a><span class="delimiter">(</span><span class="delimiter">(</span>s: <span title="String">String</span><span class="delimiter">)</span> =&gt; <a href="#395739" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; List[Char]">toList</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  ////
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
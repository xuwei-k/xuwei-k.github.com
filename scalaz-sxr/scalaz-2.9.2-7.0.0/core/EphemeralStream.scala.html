<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>core/EphemeralStream.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz

<span class="keyword">import</span> java.lang.ref.WeakReference

/** Like [[scala.collection.immutable.Stream]], but doesn't save
  * computed values.  As such, it can be used to represent similar
  * things, but without the space leak problem frequently encountered
  * using that type.
  */
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait EphemeralStream[A] extends AnyRef" id="17645">EphemeralStream</a><span class="delimiter">[</span><a title="" id="23097">A</a><span class="delimiter">]</span> <span title="Unit" class="delimiter">{</span>

  <span class="keyword">import</span> <a href="#17646" title="scalaz.EphemeralStream.type">EphemeralStream</a>._

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="255840">isEmpty</a>: <span title="Boolean">Boolean</span>

  <span class="keyword">def</span> <a title="=&gt; () =&gt; A" id="255841">head</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; A

  <span class="keyword">def</span> <a title="=&gt; () =&gt; scalaz.EphemeralStream[A]" id="255842">tail</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; EphemeralStream<span class="delimiter">[</span>A<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="=&gt; List[A]" id="255843">toList</a>: <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(xs: =&gt; List[A])(x: =&gt; A)List[A]" id="256598">lcons</a><span class="delimiter">(</span><a title="=&gt; List[A]" id="256599">xs</a>: =&gt; List<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; A" id="256600">x</a>: =&gt; A<span class="delimiter">)</span> = <a href="#256600" title="=&gt; A">x</a> <a href="#256601" title="(x: A)List[A]">::</a> <a href="#256599" title="=&gt; List[A]">xs</a>
    <a href="#255847" title="(z: =&gt; List[A])(f: (=&gt; List[A]) =&gt; ((=&gt; A) =&gt; List[A]))List[A]">foldLeft</a><span class="delimiter">(</span><span title="scala.collection.immutable.Nil.type">Nil</span>: <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#256598" title="(xs: =&gt; List[A])(x: =&gt; A)List[A]">lcons</a> _<span class="delimiter">)</span>.<span title="=&gt; List[A]">reverse</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[B](z: =&gt; B)(f: (=&gt; A) =&gt; ((=&gt; B) =&gt; B))B" id="255844">foldRight</a><span class="delimiter">[</span><a title="" id="255846">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; B" id="256654">z</a>: =&gt; B<span class="delimiter">)</span><span class="delimiter">(</span><a title="(=&gt; A) =&gt; ((=&gt; B) =&gt; B)" id="256655">f</a>: <span class="delimiter">(</span>=&gt; A<span class="delimiter">)</span> =&gt; <span class="delimiter">(</span>=&gt; B<span class="delimiter">)</span> =&gt; B<span class="delimiter">)</span>: <a href="#255846" title="B">B</a> =
    <span title="B" class="keyword">if</span> <span class="delimiter">(</span><a href="#255840" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#256654" title="=&gt; B">z</a> <span class="keyword">else</span> <a href="#256655" title="(v1: =&gt; A)(=&gt; B) =&gt; B">f</a><span title="(v1: =&gt; B)B" class="delimiter">(</span><a href="#255841" title="()A">head</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#255842" title="()scalaz.EphemeralStream[A]">tail</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="#255844" title="(z: =&gt; B)(f: (=&gt; A) =&gt; ((=&gt; B) =&gt; B))B">foldRight</a><span class="delimiter">(</span><a href="#256654" title="=&gt; B">z</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#256655" title="(=&gt; A) =&gt; ((=&gt; B) =&gt; B)">f</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[B](z: =&gt; B)(f: (=&gt; B) =&gt; ((=&gt; A) =&gt; B))B" id="255847">foldLeft</a><span class="delimiter">[</span><a title="" id="255849">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; B" id="256607">z</a>: =&gt; B<span class="delimiter">)</span><span class="delimiter">(</span><a title="(=&gt; B) =&gt; ((=&gt; A) =&gt; B)" id="256608">f</a>: <span class="delimiter">(</span>=&gt; B<span class="delimiter">)</span> =&gt; <span class="delimiter">(</span>=&gt; A<span class="delimiter">)</span> =&gt; B<span class="delimiter">)</span>: <a href="#255849" title="B">B</a> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="scalaz.EphemeralStream[A]" id="256667">t</a> = <a href="#17645" title="scalaz.EphemeralStream[A]" class="keyword">this</a>
    <span class="keyword">var</span> <a title="B" id="256668">acc</a> = <a href="#256607" title="=&gt; B">z</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#256667" title="scalaz.EphemeralStream[A]">t</a>.<a href="#255840" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#256669" title="()Unit" class="delimiter">{</a>
      <a href="#256668" title="B">acc</a> = <a href="#256608" title="(v1: =&gt; B)(=&gt; A) =&gt; B">f</a><span title="(v1: =&gt; A)B" class="delimiter">(</span><a href="#256668" title="B">acc</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#256667" title="scalaz.EphemeralStream[A]">t</a>.<a href="#255841" title="()A">head</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#256667" title="scalaz.EphemeralStream[A]">t</a> = <a href="#256667" title="scalaz.EphemeralStream[A]">t</a>.<a href="#255842" title="()scalaz.EphemeralStream[A]">tail</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#256668" title="B">acc</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(p: A =&gt; Boolean)scalaz.EphemeralStream[A]" id="255850">filter</a><span class="delimiter">(</span><a title="A =&gt; Boolean" id="256672">p</a>: A =&gt; Boolean<span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scalaz.EphemeralStream[A]" id="256673">rest</a> = <a href="#17645" title="EphemeralStream.this.type" class="keyword">this</a> <a href="#255851" title="(p: A =&gt; Boolean)scalaz.EphemeralStream[A]">dropWhile</a> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#256672" title="(v1: A)Boolean">p</a><span class="delimiter">(</span><a href="#256676" title="A">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="scalaz.EphemeralStream[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#256673" title="scalaz.EphemeralStream[A]">rest</a>.<a href="#255840" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#255876" title="scalaz.EphemeralStream[A]">emptyEphemeralStream</a>
    <span class="keyword">else</span> <a href="#255879" title="(a: =&gt; A, as: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]{val head: () =&gt; A; val tail: () =&gt; scalaz.EphemeralStream[A]}">cons</a><span class="delimiter">(</span><a href="#256673" title="scalaz.EphemeralStream[A]">rest</a>.<a href="#255841" title="()A">head</a><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="#256673" title="scalaz.EphemeralStream[A]">rest</a>.<a href="#255842" title="()scalaz.EphemeralStream[A]">tail</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="#255850" title="(p: A =&gt; Boolean)scalaz.EphemeralStream[A]">filter</a> <a href="#256672" title="A =&gt; Boolean">p</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(p: A =&gt; Boolean)scalaz.EphemeralStream[A]" id="255851">dropWhile</a><span class="delimiter">(</span><a title="A =&gt; Boolean" id="256674">p</a>: A =&gt; Boolean<span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="scalaz.EphemeralStream[A]" id="256704">these</a>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#17645" title="scalaz.EphemeralStream[A]" class="keyword">this</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#256704" title="scalaz.EphemeralStream[A]">these</a>.<a href="#255840" title="=&gt; Boolean">isEmpty</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#256674" title="(v1: A)Boolean">p</a><span class="delimiter">(</span><a href="#256704" title="scalaz.EphemeralStream[A]">these</a>.<a href="#255841" title="()A">head</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#256704" title="scalaz.EphemeralStream[A]">these</a> = <a href="#256704" title="scalaz.EphemeralStream[A]">these</a>.<a href="#255842" title="()scalaz.EphemeralStream[A]">tail</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#256704" title="scalaz.EphemeralStream[A]">these</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(e: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]" id="255852">++</a><span class="delimiter">(</span><a title="=&gt; scalaz.EphemeralStream[A]" id="256707">e</a>: =&gt; EphemeralStream<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#255844" title="[B](z: =&gt; B)(f: (=&gt; A) =&gt; ((=&gt; B) =&gt; B))B">foldRight</a><span title="(z: =&gt; scalaz.EphemeralStream[A])(f: (=&gt; A) =&gt; ((=&gt; scalaz.EphemeralStream[A]) =&gt; scalaz.EphemeralStream[A]))scalaz.EphemeralStream[A]" class="delimiter">[</span><a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#256707" title="=&gt; scalaz.EphemeralStream[A]">e</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#255879" title="[A](a: =&gt; A, as: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]{val head: () =&gt; A; val tail: () =&gt; scalaz.EphemeralStream[A]}">cons</a><span title="(a: =&gt; A, as: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]{val head: () =&gt; A; val tail: () =&gt; scalaz.EphemeralStream[A]}" class="delimiter">[</span><a href="#23097" title="A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#256718" title="=&gt; A">_</a>, <a href="#256719" title="=&gt; scalaz.EphemeralStream[A]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; (=&gt; A) =&gt; ((=&gt; scalaz.EphemeralStream[A]) =&gt; scalaz.EphemeralStream[A]{val head: () =&gt; A; val tail: () =&gt; scalaz.EphemeralStream[A]})">curried</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[B](f: A =&gt; scalaz.EphemeralStream[B])scalaz.EphemeralStream[B]" id="255853">flatMap</a><span class="delimiter">[</span><a title="" id="255855">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; scalaz.EphemeralStream[B]" id="256727">f</a>: A =&gt; EphemeralStream<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[B]">EphemeralStream</a><span class="delimiter">[</span>B<span class="delimiter">]</span> =
    <a href="#255844" title="[B](z: =&gt; B)(f: (=&gt; A) =&gt; ((=&gt; B) =&gt; B))B">foldRight</a><span title="(z: =&gt; scalaz.EphemeralStream[B])(f: (=&gt; A) =&gt; ((=&gt; scalaz.EphemeralStream[B]) =&gt; scalaz.EphemeralStream[B]))scalaz.EphemeralStream[B]" class="delimiter">[</span><a href="#17645" title="scalaz.EphemeralStream[B]">EphemeralStream</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#255876" title="scalaz.EphemeralStream[B]">emptyEphemeralStream</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; A" id="256733">h</a> =&gt; <a title="=&gt; scalaz.EphemeralStream[B]" id="256735">t</a> =&gt; <a href="#256727" title="(v1: A)scalaz.EphemeralStream[B]">f</a><span class="delimiter">(</span><a href="#256733" title="=&gt; A">h</a><span class="delimiter">)</span> <a href="#255852" title="(e: =&gt; scalaz.EphemeralStream[B])scalaz.EphemeralStream[B]">++</a> <a href="#256735" title="=&gt; scalaz.EphemeralStream[B]">t</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[B](f: A =&gt; B)scalaz.EphemeralStream[B]" id="255856">map</a><span class="delimiter">[</span><a title="" id="255858">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; B" id="256738">f</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[B]">EphemeralStream</a><span class="delimiter">[</span>B<span class="delimiter">]</span> =
    <a href="#255853" title="(f: A =&gt; scalaz.EphemeralStream[B])scalaz.EphemeralStream[B]">flatMap</a><span class="delimiter">(</span><a title="A" id="256743">x</a> =&gt; <a href="#255904" title="(as: B*)scalaz.EphemeralStream[B]">EphemeralStream</a><span class="delimiter">(</span><a href="#256738" title="(v1: A)B">f</a><span class="delimiter">(</span><a href="#256743" title="A">x</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="255859">length</a> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(c: =&gt; Int)(a: =&gt; A)Int" id="256762">addOne</a><span class="delimiter">(</span><a title="=&gt; Int" id="256763">c</a>: =&gt; Int<span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; A" id="256764">a</a>: =&gt; A<span class="delimiter">)</span> = <span title="Int(1)" class="int">1</span> <span title="(x: Int)Int">+</span> <a href="#256763" title="=&gt; Int">c</a>
    <a href="#255847" title="(z: =&gt; Int)(f: (=&gt; Int) =&gt; ((=&gt; A) =&gt; Int))Int">foldLeft</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#256762" title="(c: =&gt; Int)(a: =&gt; A)Int">addOne</a> _<span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[M[_]](p: A =&gt; M[Boolean])(implicit evidence$1: scalaz.Monad[M])M[Option[A]]" id="256781">findM</a><span class="delimiter">[</span><a title="[_]" id="255862">M</a><span class="delimiter">[</span><a title="" id="256782">_</a><span class="delimiter">]</span>: Monad<span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; M[Boolean]" id="256780">p</a>: A =&gt; M<span class="delimiter">[</span>Boolean<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#255862" title="M[Option[A]]">M</a><span class="delimiter">[</span>Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <span title="M[Option[A]]" class="keyword">if</span><span class="delimiter">(</span><a href="#255840" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
      <a href="Monad.scala.html#72095" title="[F[_]](implicit F: scalaz.Monad[F])scalaz.Monad[F]">Monad</a><a href="#256781" title="(implicit F: scalaz.Monad[M])scalaz.Monad[M]" class="delimiter">[</a><a href="#255862" title="M">M</a><span class="delimiter">]</span>.<a href="Applicative.scala.html#34510" title="(a: =&gt; Option[A])M[Option[A]]">point</a><span class="delimiter">(</span><span title="None.type">None</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="A" id="256795">hh</a> = <a href="#255841" title="()A">head</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="Monad.scala.html#72095" title="[F[_]](implicit F: scalaz.Monad[F])scalaz.Monad[F]">Monad</a><a href="#256781" title="(implicit F: scalaz.Monad[M])scalaz.Monad[M]" class="delimiter">[</a><a href="#255862" title="M">M</a><span class="delimiter">]</span>.<a href="Bind.scala.html#34574" title="(fa: M[Boolean])(f: Boolean =&gt; M[Option[A]])M[Option[A]]">bind</a><span class="delimiter">(</span><a href="#256780" title="(v1: A)M[Boolean]">p</a><span class="delimiter">(</span><a href="#256795" title="A">hh</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><span title="M[Option[A]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#256810" title="Boolean">_</a><span class="delimiter">)</span> <a href="Monad.scala.html#72095" title="[F[_]](implicit F: scalaz.Monad[F])scalaz.Monad[F]">Monad</a><a href="#256781" title="(implicit F: scalaz.Monad[M])scalaz.Monad[M]" class="delimiter">[</a><a href="#255862" title="M">M</a><span class="delimiter">]</span>.<a href="Applicative.scala.html#34510" title="(a: =&gt; Option[A])M[Option[A]]">point</a><span class="delimiter">(</span><span title="(x: A)Some[A]">Some</span><span class="delimiter">(</span><a href="#256795" title="A">hh</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#255842" title="()scalaz.EphemeralStream[A]">tail</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="#256781" title="(p: A =&gt; M[Boolean])(implicit evidence$1: scalaz.Monad[M])M[Option[A]]">findM</a> <a href="#256780" title="A =&gt; M[Boolean]">p</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; scalaz.EphemeralStream[A]" id="255863">reverse</a>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#255847" title="(z: =&gt; scalaz.EphemeralStream[A])(f: (=&gt; scalaz.EphemeralStream[A]) =&gt; ((=&gt; A) =&gt; scalaz.EphemeralStream[A]))scalaz.EphemeralStream[A]">foldLeft</a><span class="delimiter">(</span><a href="#17646" title="scalaz.EphemeralStream.type">EphemeralStream</a>.<a href="#255876" title="[A]=&gt; scalaz.EphemeralStream[A]">emptyEphemeralStream</a><span title="scalaz.EphemeralStream[A]" class="delimiter">[</span><a href="#23097" title="A">A</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; scalaz.EphemeralStream[A]" id="256838">a</a> =&gt; <a title="=&gt; A" id="256840">b</a> =&gt; <a href="#17646" title="scalaz.EphemeralStream.type">EphemeralStream</a>.<a href="#255879" title="(a: =&gt; A, as: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]{val head: () =&gt; A; val tail: () =&gt; scalaz.EphemeralStream[A]}">cons</a><span class="delimiter">(</span><a href="#256840" title="=&gt; A">b</a>, <a href="#256838" title="=&gt; scalaz.EphemeralStream[A]">a</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[B](b: =&gt; scalaz.EphemeralStream[B])scalaz.EphemeralStream[(A, B)]" id="255864">zip</a><span class="delimiter">[</span><a title="" id="255866">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; scalaz.EphemeralStream[B]" id="256866">b</a>: =&gt; EphemeralStream<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[(A, B)]">EphemeralStream</a><span class="delimiter">[</span><span class="delimiter">(</span>A, B<span class="delimiter">)</span><span class="delimiter">]</span> =
    <span title="scalaz.EphemeralStream[(A, B)]" class="keyword">if</span><span class="delimiter">(</span><a href="#255840" title="=&gt; Boolean">isEmpty</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#256866" title="=&gt; scalaz.EphemeralStream[B]">b</a>.<a href="#255840" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
      <a href="#255876" title="scalaz.EphemeralStream[(A, B)]">emptyEphemeralStream</a>
    <span class="keyword">else</span>
      <a href="#255879" title="(a: =&gt; (A, B), as: =&gt; scalaz.EphemeralStream[(A, B)])scalaz.EphemeralStream[(A, B)]{val head: () =&gt; (A, B); val tail: () =&gt; scalaz.EphemeralStream[(A, B)]}">cons</a><span class="delimiter">(</span><span title="(_1: A, _2: B)(A, B)" class="delimiter">(</span><a href="#255841" title="()A">head</a><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="#256866" title="=&gt; scalaz.EphemeralStream[B]">b</a>.<a href="#255841" title="()B">head</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#255842" title="()scalaz.EphemeralStream[A]">tail</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="#255864" title="(b: =&gt; scalaz.EphemeralStream[B])scalaz.EphemeralStream[(A, B)]">zip</a> <a href="#256866" title="=&gt; scalaz.EphemeralStream[B]">b</a>.<a href="#255842" title="()scalaz.EphemeralStream[B]">tail</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[X, Y](implicit ev: =:=[A,(X, Y)])(scalaz.EphemeralStream[X], scalaz.EphemeralStream[Y])" id="255867">unzip</a><span class="delimiter">[</span><a title="" id="255870">X</a>, <a title="" id="255871">Y</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="=:=[A,(X, Y)]" id="256903">ev</a>: A <span title="=:=[A,(X, Y)]">=:=</span> <span class="delimiter">(</span>X, Y<span class="delimiter">)</span><span class="delimiter">)</span>: <span title="(scalaz.EphemeralStream[X], scalaz.EphemeralStream[Y])" class="delimiter">(</span>EphemeralStream<span class="delimiter">[</span>X<span class="delimiter">]</span>, EphemeralStream<span class="delimiter">[</span>Y<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#255844" title="(z: =&gt; (scalaz.EphemeralStream[X], scalaz.EphemeralStream[Y]))(f: (=&gt; A) =&gt; ((=&gt; (scalaz.EphemeralStream[X], scalaz.EphemeralStream[Y])) =&gt; (scalaz.EphemeralStream[X], scalaz.EphemeralStream[Y])))(scalaz.EphemeralStream[X], scalaz.EphemeralStream[Y])">foldRight</a><span class="delimiter">(</span><span title="(_1: scalaz.EphemeralStream[X], _2: scalaz.EphemeralStream[Y])(scalaz.EphemeralStream[X], scalaz.EphemeralStream[Y])" class="delimiter">(</span><a href="#255876" title="[A]=&gt; scalaz.EphemeralStream[A]">emptyEphemeralStream</a><span title="scalaz.EphemeralStream[X]" class="delimiter">[</span><a href="#255870" title="X">X</a><span class="delimiter">]</span>, <a href="#255876" title="[A]=&gt; scalaz.EphemeralStream[A]">emptyEphemeralStream</a><span title="scalaz.EphemeralStream[Y]" class="delimiter">[</span><a href="#255871" title="Y">Y</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; A" id="256919">q</a> =&gt; <a title="=&gt; (scalaz.EphemeralStream[X], scalaz.EphemeralStream[Y])" id="256921">r</a> =&gt;
      <span title="(_1: scalaz.EphemeralStream[X]{val head: () =&gt; X; val tail: () =&gt; scalaz.EphemeralStream[X]}, _2: scalaz.EphemeralStream[Y]{val head: () =&gt; Y; val tail: () =&gt; scalaz.EphemeralStream[Y]})(scalaz.EphemeralStream[X]{val head: () =&gt; X; val tail: () =&gt; scalaz.EphemeralStream[X]}, scalaz.EphemeralStream[Y]{val head: () =&gt; Y; val tail: () =&gt; scalaz.EphemeralStream[Y]})" class="delimiter">(</span><a href="#255879" title="(a: =&gt; X, as: =&gt; scalaz.EphemeralStream[X])scalaz.EphemeralStream[X]{val head: () =&gt; X; val tail: () =&gt; scalaz.EphemeralStream[X]}">cons</a><span class="delimiter">(</span><a href="#256903" title="(v1: A)(X, Y)">q</a>.<span title="=&gt; X">_1</span>, <a href="#256921" title="=&gt; (scalaz.EphemeralStream[X], scalaz.EphemeralStream[Y])">r</a>.<span title="=&gt; scalaz.EphemeralStream[X]">_1</span><span class="delimiter">)</span>, <a href="#255879" title="(a: =&gt; Y, as: =&gt; scalaz.EphemeralStream[Y])scalaz.EphemeralStream[Y]{val head: () =&gt; Y; val tail: () =&gt; scalaz.EphemeralStream[Y]}">cons</a><span class="delimiter">(</span><a href="#256903" title="(v1: A)(X, Y)">q</a>.<span title="=&gt; Y">_2</span>, <a href="#256921" title="=&gt; (scalaz.EphemeralStream[X], scalaz.EphemeralStream[Y])">r</a>.<span title="=&gt; scalaz.EphemeralStream[Y]">_2</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(q: scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]" id="255872">interleave</a><span class="delimiter">(</span><a title="scalaz.EphemeralStream[A]" id="256995">q</a>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <span title="scalaz.EphemeralStream[A]" class="keyword">if</span><span class="delimiter">(</span><a href="#255840" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
      <a href="#256995" title="scalaz.EphemeralStream[A]">q</a>
    <span class="keyword">else</span> <span title="scalaz.EphemeralStream[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#256995" title="scalaz.EphemeralStream[A]">q</a>.<a href="#255840" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
      <a href="#17645" title="scalaz.EphemeralStream[A]" class="keyword">this</a>
    <span class="keyword">else</span>
      <a href="#255879" title="(a: =&gt; A, as: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]{val head: () =&gt; A; val tail: () =&gt; scalaz.EphemeralStream[A]}">cons</a><span class="delimiter">(</span><a href="#255841" title="()A">head</a><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="#255879" title="(a: =&gt; A, as: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]{val head: () =&gt; A; val tail: () =&gt; scalaz.EphemeralStream[A]}">cons</a><span class="delimiter">(</span><a href="#256995" title="scalaz.EphemeralStream[A]">q</a>.<a href="#255841" title="()A">head</a><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="#255842" title="()scalaz.EphemeralStream[A]">tail</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="#255872" title="(q: scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]">interleave</a> <a href="#256995" title="scalaz.EphemeralStream[A]">q</a>.<a href="#255842" title="()scalaz.EphemeralStream[A]">tail</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">object</span> <a title="scalaz.EphemeralStream.type" id="17646">EphemeralStream</a> <a href="#17647" title="scalaz.EphemeralStream.type" class="keyword">extends</a> <a href="#10976" title="scalaz.EphemeralStreamFunctions">EphemeralStreamFunctions</a> <span class="keyword">with</span> <a href="#15542" title="scalaz.EphemeralStreamInstances">EphemeralStreamInstances</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[A]=&gt; scalaz.EphemeralStream[A]" id="255901">apply</a><span class="delimiter">[</span><a title="" id="255903">A</a><span class="delimiter">]</span>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#255876" title="scalaz.EphemeralStream[A]">emptyEphemeralStream</a>

  <span class="keyword">def</span> <a title="[A](as: A*)scalaz.EphemeralStream[A]" id="255904">apply</a><span class="delimiter">[</span><a title="" id="255906">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A*" id="256746">as</a>: <span title="A*">A</span>*<span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#255882" title="(b: =&gt; Int)(f: Int =&gt; Option[(A, Int)])scalaz.EphemeralStream[A]">unfold</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="Int" id="257061">b</a> =&gt;
      <span title="Option[(A, Int)]" class="keyword">if</span> <span class="delimiter">(</span><a href="#257061" title="Int">b</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#256746" title="A*">as</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span> <span title="(x: (A, Int))Some[(A, Int)]">Some</span><span class="delimiter">(</span><span title="(_1: A, _2: Int)(A, Int)" class="delimiter">(</span><a href="#256746" title="(idx: Int)A">as</a><span class="delimiter">(</span><a href="#257061" title="Int">b</a><span class="delimiter">)</span>, <a href="#257061" title="Int">b</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="None.type">None</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait EphemeralStreamInstances extends AnyRef" id="15542">EphemeralStreamInstances</a> <span title="Unit" class="delimiter">{</span>
  // TODO more instances
  <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="ephemeralStreamInstance extends AnyRef with scalaz.MonadPlus[scalaz.EphemeralStream] with scalaz.Zip[scalaz.EphemeralStream] with scalaz.Unzip[scalaz.EphemeralStream] with scalaz.Traverse[scalaz.EphemeralStream]" id="255908">ephemeralStreamInstance</a> = <a href="#257095" title="scalaz.MonadPlus[scalaz.EphemeralStream] with scalaz.Zip[scalaz.EphemeralStream] with scalaz.Unzip[scalaz.EphemeralStream] with scalaz.Traverse[scalaz.EphemeralStream]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.MonadPlus[scalaz.EphemeralStream] with scalaz.Zip[scalaz.EphemeralStream] with scalaz.Unzip[scalaz.EphemeralStream] with scalaz.Traverse[scalaz.EphemeralStream]" id="257095">MonadPlus</a><span class="delimiter">[</span>EphemeralStream<span class="delimiter">]</span> <span class="keyword">with</span> <a href="Zip.scala.html#15899" title="scalaz.Zip[scalaz.EphemeralStream]">Zip</a><span class="delimiter">[</span>EphemeralStream<span class="delimiter">]</span> <span class="keyword">with</span> <a href="Unzip.scala.html#12389" title="scalaz.Unzip[scalaz.EphemeralStream]">Unzip</a><span class="delimiter">[</span>EphemeralStream<span class="delimiter">]</span> <span class="keyword">with</span> <a href="Traverse.scala.html#20819" title="scalaz.Traverse[scalaz.EphemeralStream]">Traverse</a><span class="delimiter">[</span>EphemeralStream<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: scalaz.EphemeralStream[A], b: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]" id="257097">plus</a><span class="delimiter">[</span><a title="" id="257099">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.EphemeralStream[A]" id="257128">a</a>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="=&gt; scalaz.EphemeralStream[A]" id="257129">b</a>: =&gt; EphemeralStream<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#257128" title="scalaz.EphemeralStream[A]">a</a> <a href="#255852" title="(e: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]">++</a> <a href="#257129" title="=&gt; scalaz.EphemeralStream[A]">b</a>
    <span class="keyword">def</span> <a title="[A, B](fa: scalaz.EphemeralStream[A])(f: A =&gt; scalaz.EphemeralStream[B])scalaz.EphemeralStream[B]" id="257100">bind</a><span class="delimiter">[</span><a title="" id="257103">A</a>, <a title="" id="257104">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.EphemeralStream[A]" id="257151">fa</a>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="A =&gt; scalaz.EphemeralStream[B]" id="257152">f</a>: A =&gt; EphemeralStream<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#257151" title="scalaz.EphemeralStream[A]">fa</a> <a href="#255853" title="(f: A =&gt; scalaz.EphemeralStream[B])scalaz.EphemeralStream[B]">flatMap</a> <a href="#257152" title="A =&gt; scalaz.EphemeralStream[B]">f</a>
    <span class="keyword">def</span> <a title="[A](a: =&gt; A)scalaz.EphemeralStream[A]" id="257105">point</a><span class="delimiter">[</span><a title="" id="257107">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="257177">a</a>: =&gt; A<span class="delimiter">)</span> = <a href="#255904" title="(as: A*)scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">(</span><a href="#257177" title="=&gt; A">a</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[A]=&gt; scalaz.EphemeralStream[A]" id="257108">empty</a><span class="delimiter">[</span><a title="" id="257110">A</a><span class="delimiter">]</span> = <a href="#255904" title="(as: A*)scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[A, B](a: =&gt; scalaz.EphemeralStream[A], b: =&gt; scalaz.EphemeralStream[B])scalaz.EphemeralStream[(A, B)]" id="257111">zip</a><span class="delimiter">[</span><a title="" id="257114">A</a>, <a title="" id="257115">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; scalaz.EphemeralStream[A]" id="257224">a</a>: =&gt; EphemeralStream<span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="=&gt; scalaz.EphemeralStream[B]" id="257225">b</a>: =&gt; EphemeralStream<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#257224" title="=&gt; scalaz.EphemeralStream[A]">a</a> <a href="#255864" title="(b: =&gt; scalaz.EphemeralStream[B])scalaz.EphemeralStream[(A, B)]">zip</a> <a href="#257225" title="=&gt; scalaz.EphemeralStream[B]">b</a>
    <span class="keyword">def</span> <a title="[A, B](a: scalaz.EphemeralStream[(A, B)])(scalaz.EphemeralStream[A], scalaz.EphemeralStream[B])" id="257116">unzip</a><span class="delimiter">[</span><a title="" id="257119">A</a>, <a title="" id="257120">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.EphemeralStream[(A, B)]" id="257261">a</a>: <a href="#17645" title="scalaz.EphemeralStream[(A, B)]">EphemeralStream</a><span class="delimiter">[</span><span class="delimiter">(</span>A, B<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#257261" title="scalaz.EphemeralStream[(A, B)]">a</a>.<a href="#255867" title="(implicit ev: =:=[(A, B),(A, B)])(scalaz.EphemeralStream[A], scalaz.EphemeralStream[B])">unzip</a>

    <span class="keyword">def</span> <a title="[G[_], A, B](fa: scalaz.EphemeralStream[A])(f: A =&gt; G[B])(implicit G: scalaz.Applicative[G])G[scalaz.EphemeralStream[B]]" id="257121">traverseImpl</a><span class="delimiter">[</span><a title="[_]" id="257125">G</a><span class="delimiter">[</span><a title="" id="257283">_</a><span class="delimiter">]</span>, <a title="" id="257126">A</a>, <a title="" id="257127">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.EphemeralStream[A]" id="257280">fa</a>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="A =&gt; G[B]" id="257281">f</a>: A =&gt; G<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Applicative[G]" id="257282">G</a>: <a href="Applicative.scala.html#15416" title="scalaz.Applicative[G]">Applicative</a><span class="delimiter">[</span>G<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#257125" title="G[scalaz.EphemeralStream[B]]">G</a><span class="delimiter">[</span>EphemeralStream<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="G[scalaz.EphemeralStream[B]]" id="257391">seed</a>: <a href="#257125" title="G[scalaz.EphemeralStream[B]]">G</a><span class="delimiter">[</span>EphemeralStream<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#257282" title="scalaz.Applicative[G]">G</a>.<a href="Applicative.scala.html#34510" title="(a: =&gt; scalaz.EphemeralStream[B])G[scalaz.EphemeralStream[B]]">point</a><span class="delimiter">(</span><a href="#255904" title="[A](as: A*)scalaz.EphemeralStream[A]">EphemeralStream</a><span title="(as: B*)scalaz.EphemeralStream[B]" class="delimiter">[</span><a href="#257127" title="B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

      <a href="Traverse.scala.html#33571" title="(fa: scalaz.EphemeralStream[A], z: =&gt; G[scalaz.EphemeralStream[B]])(f: (A, =&gt; G[scalaz.EphemeralStream[B]]) =&gt; G[scalaz.EphemeralStream[B]])G[scalaz.EphemeralStream[B]]">foldRight</a><span class="delimiter">(</span><a href="#257280" title="scalaz.EphemeralStream[A]">fa</a>, <a href="#257391" title="G[scalaz.EphemeralStream[B]]">seed</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="delimiter">(</span><a title="A" id="257423">x</a>, <a title="=&gt; G[scalaz.EphemeralStream[B]]" id="257424">ys</a><span class="delimiter">)</span> =&gt; <a href="#257282" title="scalaz.Applicative[G]">G</a>.<a href="Applicative.scala.html#34521" title="(fa: =&gt; G[B], fb: =&gt; G[scalaz.EphemeralStream[B]])(f: (B, scalaz.EphemeralStream[B]) =&gt; scalaz.EphemeralStream[B])G[scalaz.EphemeralStream[B]]">apply2</a><span class="delimiter">(</span><a href="#257281" title="(v1: A)G[B]">f</a><span class="delimiter">(</span><a href="#257423" title="A">x</a><span class="delimiter">)</span>, <a href="#257424" title="=&gt; G[scalaz.EphemeralStream[B]]">ys</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="B" id="257445">b</a>, <a title="scalaz.EphemeralStream[B]" id="257446">bs</a><span class="delimiter">)</span> =&gt; <a href="#17646" title="scalaz.EphemeralStream.type">EphemeralStream</a>.<a href="#255879" title="(a: =&gt; B, as: =&gt; scalaz.EphemeralStream[B])scalaz.EphemeralStream[B]{val head: () =&gt; B; val tail: () =&gt; scalaz.EphemeralStream[B]}">cons</a><span class="delimiter">(</span><a href="#257445" title="B">b</a>, <a href="#257446" title="scalaz.EphemeralStream[B]">bs</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">trait</span> <a title="trait EphemeralStreamFunctions extends AnyRef" id="10976">EphemeralStreamFunctions</a> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">type</span> <a title="[A]scalaz.EphemeralStream[A]" id="255874">EStream</a><span class="delimiter">[</span><a title="" id="255875">A</a><span class="delimiter">]</span> = <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="[A]=&gt; scalaz.EphemeralStream[A]" id="255876">emptyEphemeralStream</a><span class="delimiter">[</span><a title="" id="255878">A</a><span class="delimiter">]</span>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#257698" title="scalaz.EphemeralStream[A]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.EphemeralStream[A]" id="257698">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="257700">isEmpty</a> = <span title="Boolean(true)" class="keyword">true</span>

    <span class="keyword">def</span> <a title="=&gt; () =&gt; Nothing" id="257701">head</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Nothing = <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;head of empty stream&quot;)" class="string">&quot;head of empty stream&quot;</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="=&gt; () =&gt; Nothing" id="257702">tail</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Nothing = <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;tail of empty stream&quot;)" class="string">&quot;tail of empty stream&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[A](a: =&gt; A, as: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]{val head: () =&gt; A; val tail: () =&gt; scalaz.EphemeralStream[A]}" id="255879">cons</a><span class="delimiter">[</span><a title="" id="255881">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="255910">a</a>: =&gt; A, <a title="=&gt; scalaz.EphemeralStream[A]" id="255911">as</a>: =&gt; EphemeralStream<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#255912" title="scalaz.EphemeralStream[A]{}" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.EphemeralStream[A]" id="255912">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="255914">isEmpty</a> = <span title="Boolean(false)" class="keyword">false</span>

    <span class="keyword">val</span> <a title="() =&gt; A" id="255915">head</a> = <a href="#255897" title="(f: =&gt; A)() =&gt; A">weakMemo</a><span class="delimiter">(</span><a href="#255910" title="=&gt; A">a</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="() =&gt; scalaz.EphemeralStream[A]" id="255917">tail</a> = <a href="#255897" title="(f: =&gt; scalaz.EphemeralStream[A])() =&gt; scalaz.EphemeralStream[A]">weakMemo</a><span class="delimiter">(</span><a href="#255911" title="=&gt; scalaz.EphemeralStream[A]">as</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[A, B](b: =&gt; B)(f: B =&gt; Option[(A, B)])scalaz.EphemeralStream[A]" id="255882">unfold</a><span class="delimiter">[</span><a title="" id="255885">A</a>, <a title="" id="255886">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; B" id="257048">b</a>: =&gt; B<span class="delimiter">)</span><span class="delimiter">(</span><a title="B =&gt; Option[(A, B)]" id="257049">f</a>: B =&gt; Option<span class="delimiter">[</span><span class="delimiter">(</span>A, B<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#257049" title="(v1: B)Option[(A, B)]">f</a><a href="#1676555" title="(x: scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]" class="delimiter">(</a><a href="#257048" title="=&gt; B">b</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#1676549" title="scalaz.EphemeralStream[A]">None</a>         =&gt; <a href="#1676555" title="(x: scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]">emptyEphemeralStream</a>
      <span class="keyword">case</span> Some<a href="#1676549" title="scalaz.EphemeralStream[A]" class="delimiter">(</a><a href="#1676552" title="=&gt; (A, B)" class="delimiter">(</a><a href="#1676551" title="A" id="257724">a</a>, <a href="#1676551" title="B" id="257725">r</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#255879" title="(a: =&gt; A, as: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]{val head: () =&gt; A; val tail: () =&gt; scalaz.EphemeralStream[A]}">cons</a><a href="#1676555" title="(x: scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]" class="delimiter">(</a><a href="#257724" title="A">a</a>, <a href="#255882" title="(b: =&gt; B)(f: B =&gt; Option[(A, B)])scalaz.EphemeralStream[A]">unfold</a><span class="delimiter">(</span><a href="#257725" title="B">r</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#257049" title="B =&gt; Option[(A, B)]">f</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[A](start: A)(f: A =&gt; A)scalaz.EphemeralStream[A]" id="255887">iterate</a><span class="delimiter">[</span><a title="" id="255889">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="257761">start</a>: <a href="#255889" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="A =&gt; A" id="257762">f</a>: A =&gt; A<span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#255882" title="(b: =&gt; A)(f: A =&gt; Option[(A, A)])scalaz.EphemeralStream[A]">unfold</a><span class="delimiter">(</span><a href="#257761" title="A">start</a><span class="delimiter">)</span><span class="delimiter">{</span> <a title="A" id="257774">a</a> =&gt;
      <span class="keyword">val</span> <a title="A" id="257775">fa</a> = <a href="#257762" title="(v1: A)A">f</a><span class="delimiter">(</span><a href="#257774" title="A">a</a><span class="delimiter">)</span>
      <span title="(x: (A, A))Some[(A, A)]">Some</span><span class="delimiter">(</span><span title="(_1: A, _2: A)(A, A)" class="delimiter">(</span><a href="#257775" title="A">fa</a>, <a href="#257775" title="A">fa</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(lower: Int, upper: Int)scalaz.EphemeralStream[Int]" id="255890">range</a><span class="delimiter">(</span><a title="Int" id="257788">lower</a>: <span title="Int">Int</span>, <a title="Int" id="257789">upper</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[Int]">EphemeralStream</a><span class="delimiter">[</span>Int<span class="delimiter">]</span> =
    <span title="scalaz.EphemeralStream[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#257788" title="Int">lower</a> <span title="(x: Int)Boolean">&gt;=</span> <a href="#257789" title="Int">upper</a><span class="delimiter">)</span> <a href="#255876" title="scalaz.EphemeralStream[Int]">emptyEphemeralStream</a> <span class="keyword">else</span> <a href="#255879" title="(a: =&gt; Int, as: =&gt; scalaz.EphemeralStream[Int])scalaz.EphemeralStream[Int]{val head: () =&gt; Int; val tail: () =&gt; scalaz.EphemeralStream[Int]}">cons</a><span class="delimiter">(</span><a href="#257788" title="Int">lower</a>, <a href="#255890" title="(lower: Int, upper: Int)scalaz.EphemeralStream[Int]">range</a><span class="delimiter">(</span><a href="#257788" title="Int">lower</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#257789" title="Int">upper</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[A](s: =&gt; Stream[A])scalaz.EphemeralStream[A]" id="255891">fromStream</a><span class="delimiter">[</span><a title="" id="255893">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; Stream[A]" id="257824">s</a>: =&gt; Stream<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#257824" title="=&gt; Stream[A]">s</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#1676563" title="(x: scala.collection.immutable.Stream[A])Some[scala.collection.immutable.Stream[A]]">Stream</a><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#1676569" title="(x: scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]">emptyEphemeralStream</a>
    <span class="keyword">case</span> <a title="A" id="257870">h</a> <a href="#1676563" title="(xs: scala.collection.immutable.Stream[A])Option[(A, scala.collection.immutable.Stream[A])]">#::</a> <a title="scala.collection.immutable.Stream[A]" id="257871">t</a>  =&gt; <a href="#255879" title="(a: =&gt; A, as: =&gt; scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]{val head: () =&gt; A; val tail: () =&gt; scalaz.EphemeralStream[A]}">cons</a><a href="#1676569" title="(x: scalaz.EphemeralStream[A])scalaz.EphemeralStream[A]" class="delimiter">(</a><a href="#257870" title="A">h</a>, <a href="#255891" title="(s: =&gt; Stream[A])scalaz.EphemeralStream[A]">fromStream</a><span class="delimiter">(</span><a href="#257871" title="scala.collection.immutable.Stream[A]">t</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](e: scalaz.EphemeralStream[A])Iterable[A]" id="255894">toIterable</a><span class="delimiter">[</span><a title="" id="255896">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.EphemeralStream[A]" id="256789">e</a>: <a href="#17645" title="scalaz.EphemeralStream[A]">EphemeralStream</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Iterable[A]">Iterable</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#257914" title="Iterable[A]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with Iterable[A]" id="257914">Iterable</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Iterator[A]" id="257916">iterator</a> = <a href="#258281" title="Iterator[A]{}" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with Iterator[A]" id="258281">Iterator</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="scalaz.EphemeralStream[A]" id="258284">cur</a> = <a href="#256789" title="scalaz.EphemeralStream[A]">e</a>

      <span class="keyword">def</span> <a title="()A" id="258286">next</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="A" id="258453">t</a> = <a href="#258284" title="=&gt; scalaz.EphemeralStream[A]">cur</a>.<a href="#255841" title="()A">head</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#258284" title="(x$1: scalaz.EphemeralStream[A])Unit">cur</a> = <a href="#258284" title="=&gt; scalaz.EphemeralStream[A]">cur</a>.<a href="#255842" title="()scalaz.EphemeralStream[A]">tail</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#258453" title="A">t</a>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="=&gt; Boolean" id="258287">hasNext</a> = <span title="=&gt; Boolean">!</span><a href="#258284" title="=&gt; scalaz.EphemeralStream[A]">cur</a>.<a href="#255840" title="=&gt; Boolean">isEmpty</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[V](f: =&gt; V)() =&gt; V" id="255897">weakMemo</a><span class="delimiter">[</span><a title="" id="255899">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; V" id="255922">f</a>: =&gt; V<span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; V = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Object" id="258473">latch</a> = <span title="Object" class="keyword">new</span> <span title="Object">Object</span>
    // TODO I don't think this annotation does anything, as `v` isn't a class member.
    @volatile <span class="keyword">var</span> <a title="Option[java.lang.ref.WeakReference[V]]" id="258474">v</a>: <span title="Option[java.lang.ref.WeakReference[V]]">Option</span><span class="delimiter">[</span>WeakReference<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="None.type">None</span>
    <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Option[V]" id="258519">a</a> = <a href="#258474" title="Option[java.lang.ref.WeakReference[V]]">v</a>.<span title="(f: java.lang.ref.WeakReference[V] =&gt; V)Option[V]">map</span><span class="delimiter">(</span><a title="java.lang.ref.WeakReference[V]" id="258524">x</a> =&gt; <a href="#258524" title="java.lang.ref.WeakReference[V]">x</a>.<span title="()V">get</span><span class="delimiter">)</span>
      <span title="V" class="keyword">if</span> <span class="delimiter">(</span><a href="#258519" title="Option[V]">a</a>.<span title="=&gt; Boolean">isDefined</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#258519" title="Option[V]">a</a>.<span title="=&gt; V">get</span> <span title="(x$1: Any)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#258519" title="Option[V]">a</a>.<span title="=&gt; V">get</span>
      <span class="keyword">else</span> <a href="#258473" title="Object">latch</a>.<span title="(x$1: V)V">synchronized</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="V" id="258528">x</a> = <a href="#255922" title="=&gt; V">f</a>
        <a href="#258474" title="Option[java.lang.ref.WeakReference[V]]">v</a> = <span title="(x: java.lang.ref.WeakReference[V])Some[java.lang.ref.WeakReference[V]]">Some</span><span class="delimiter">(</span><span title="java.lang.ref.WeakReference[V]" class="keyword">new</span> <span title="java.lang.ref.WeakReference[V]">WeakReference</span><span class="delimiter">(</span><a href="#258528" title="V">x</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#258528" title="V">x</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
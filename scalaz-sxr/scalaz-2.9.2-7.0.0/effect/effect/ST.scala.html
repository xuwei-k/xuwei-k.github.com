<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>effect/effect/ST.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz
<span class="keyword">package</span> effect

<span class="keyword">import</span> <a href="World.scala.html#29764" title="scalaz.effect.IvoryTower.type">IvoryTower</a>._
<span class="keyword">import</span> <a href="#29723" title="scalaz.effect.STRef.type">STRef</a>._
<span class="keyword">import</span> <a href="#29730" title="scalaz.effect.STArray.type">STArray</a>._
<span class="keyword">import</span> <a href="#29736" title="scalaz.effect.ST.type">ST</a>._
<span class="keyword">import</span> std.<a href="../../core/std/Function.scala.html#24791" title="scalaz.std.function.type">function</a>._
<span class="keyword">import</span> <a href="../../core/Id.scala.html#8190" title="scalaz.Id.type">Id</a>._

/**Mutable variable in state thread S containing a value of type A. http://research.microsoft.com/en-us/um/people/simonpj/papers/lazy-functional-state-threads.ps.Z */
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait STRef[S, A] extends AnyRef" id="29720">STRef</a><span class="delimiter">[</span><a title="" id="29721">S</a>, <a title="" id="29722">A</a><span class="delimiter">]</span> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="=&gt; A" id="498857">value</a>: <a href="#29722" title="A">A</a>

  /**Reads the value pointed at by this reference. */
  <span class="keyword">def</span> <a title="=&gt; scalaz.effect.ST[S,A]" id="498858">read</a>: <a href="#29733" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#44250" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#498857" title="=&gt; A">value</a><span class="delimiter">)</span>

  /**Modifies the value at this reference with the given function. */
  <span class="keyword">def</span> <a title="[B](f: A =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="498859">mod</a><span class="delimiter">[</span><a title="" id="498861">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; A" id="499810">f</a>: A =&gt; A<span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">ST</a><span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#44242" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], scalaz.effect.STRef[S,A]))scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">st</a><span class="delimiter">(</span><span class="delimiter">(</span>s: <a href="World.scala.html#29759" title="scalaz.effect.Tower[S]">Tower</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
    <a href="#498857" title="(x$1: A)Unit">value</a> = <a href="#499810" title="(v1: A)A">f</a><span class="delimiter">(</span><a href="#498857" title="=&gt; A">value</a><span class="delimiter">)</span>;
    <span title="(_1: scalaz.effect.Tower[S], _2: scalaz.effect.STRef[S,A])(scalaz.effect.Tower[S], scalaz.effect.STRef[S,A])" class="delimiter">(</span><a href="#504489" title="scalaz.effect.Tower[S]">s</a>, <a href="#29720" title="scalaz.effect.STRef[S,A]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  /**Associates this reference with the given value. */
  <span class="keyword">def</span> <a title="(a: =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="498862">write</a><span class="delimiter">(</span><a title="=&gt; A" id="499797">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">ST</a><span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#44242" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], scalaz.effect.STRef[S,A]))scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">st</a><span class="delimiter">(</span><span class="delimiter">(</span>s: <a href="World.scala.html#29759" title="scalaz.effect.Tower[S]">Tower</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
    <a href="#498857" title="(x$1: A)Unit">value</a> = <a href="#499797" title="=&gt; A">a</a>;
    <span title="(_1: scalaz.effect.Tower[S], _2: scalaz.effect.STRef[S,A])(scalaz.effect.Tower[S], scalaz.effect.STRef[S,A])" class="delimiter">(</span><a href="#504502" title="scalaz.effect.Tower[S]">s</a>, <a href="#29720" title="scalaz.effect.STRef[S,A]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  /**Synonym for write*/
  <span class="keyword">def</span> <a title="(a: =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="498863">|=</a><span class="delimiter">(</span><a title="=&gt; A" id="504510">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">ST</a><span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#498862" title="(a: =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">write</a><span class="delimiter">(</span><a href="#504510" title="=&gt; A">a</a><span class="delimiter">)</span>

  /**Swap the value at this reference with the value at another. */
  <span class="keyword">def</span> <a title="(that: scalaz.effect.STRef[S,A])scalaz.effect.ST[S,Unit]" id="498864">swap</a><span class="delimiter">(</span><a title="scalaz.effect.STRef[S,A]" id="504511">that</a>: <a href="#29720" title="scalaz.effect.STRef[S,A]">STRef</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,Unit]">ST</a><span class="delimiter">[</span>S, Unit<span class="delimiter">]</span> = <span class="keyword">for</span> <span class="delimiter">{</span>
    <a title="A" id="504516">v1</a> &lt;- <a href="#29720" title="STRef.this.type" class="keyword">this</a>.<a href="#497259" title="(g: A =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]">read</a>
    <a title="A" id="504520">v2</a> &lt;- <a href="#504511" title="scalaz.effect.STRef[S,A]">that</a>.<a href="#497259" title="(g: A =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]">read</a>
    <a title="scalaz.effect.STRef[S,A]" id="504525">_</a> &lt;- <a href="#29720" title="STRef.this.type" class="keyword">this</a> <a href="#497259" title="(g: scalaz.effect.STRef[S,A] =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]">write</a> <a href="#504520" title="A">v2</a>
    <a title="scalaz.effect.STRef[S,A]" id="504530">_</a> &lt;- <a href="#504511" title="scalaz.effect.STRef[S,A]">that</a> <a href="#497262" title="(g: scalaz.effect.STRef[S,A] =&gt; Unit)scalaz.effect.ST[S,Unit]">write</a> <a href="#504516" title="A">v1</a>
  <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">object</span> <a title="scalaz.effect.STRef.type" id="29723">STRef</a> <a href="#29724" title="scalaz.effect.STRef.type" class="keyword">extends</a> <a href="#29725" title="scalaz.effect.STRefFunctions">STRefFunctions</a> <span class="keyword">with</span> <a href="#29726" title="scalaz.effect.STRefInstances">STRefInstances</a> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[S]=&gt; scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" id="497122">apply</a><span class="delimiter">[</span><a title="" id="497124">S</a><span class="delimiter">]</span>: <span class="delimiter">(</span>Id <a href="../../core/NaturalTransformation.scala.html#19940" title="scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> =
    <a href="#497118" title="[S]=&gt; scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">stRef</a><span title="scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" class="delimiter">[</span><a href="#497124" title="S">S</a><span class="delimiter">]</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STRefFunctions extends AnyRef" id="29725">STRefFunctions</a> <span title="Unit" class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[S]=&gt; scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" id="497118">stRef</a><span class="delimiter">[</span><a title="" id="497120">S</a><span class="delimiter">]</span>: <span class="delimiter">(</span>Id <a href="../../core/NaturalTransformation.scala.html#19940" title="scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> = <a href="#504554" title="scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" id="504554" class="delimiter">(</a>Id <a href="../../core/NaturalTransformation.scala.html#19940" title="scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: A)scalaz.effect.STRef[S,A]" id="504561">apply</a><span class="delimiter">[</span><a title="" id="504563">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="504565">a</a>: <a href="#504563" title="A">A</a><span class="delimiter">)</span> = <a href="#504575" title="scalaz.effect.STRef[S,A]{}" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.effect.STRef[S,A]" id="504575">STRef</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="A" id="504578">value</a> = <a href="#504565" title="A">a</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">trait</span> <a title="trait STRefInstances extends AnyRef" id="29726">STRefInstances</a> <span title="Unit" class="delimiter">{</span>
  
  /**Equality for STRefs is reference equality */
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S, A]=&gt; scalaz.Equal[scalaz.effect.STRef[S,A]]" id="497126">STRefEqual</a><span class="delimiter">[</span><a title="" id="497129">S</a>, <a title="" id="497130">A</a><span class="delimiter">]</span>: <a href="../../core/Equal.scala.html#19253" title="scalaz.Equal[scalaz.effect.STRef[S,A]]">Equal</a><span class="delimiter">[</span>STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="../../core/Equal.scala.html#19254" title="scalaz.Equal.type">Equal</a>.<a href="../../core/Equal.scala.html#50776" title="scalaz.Equal[scalaz.effect.STRef[S,A]]">equalA</a> // todo reference equality?
<span class="delimiter">}</span>

/**Mutable array in state thread S containing values of type A. */
<span title="AnyRef" class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait STArray[S, A] extends AnyRef" id="29727">STArray</a><span class="delimiter">[</span><a title="" id="29728">S</a>, <a title="" id="29729">A</a><span class="delimiter">]</span> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="504616">size</a>: <span title="Int">Int</span>
  <span class="keyword">def</span> <a title="=&gt; A" id="504617">z</a>: <a href="#29729" title="A">A</a>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; Manifest[A]" id="504618">manifest</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span>

  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Array[A]" id="504619">value</a>: <span title="Array[A]">Array</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span title="Array.type">Array</span>.<span title="(n: Int)(elem: =&gt; A)(implicit evidence$9: scala.reflect.ClassTag[A])Array[A]">fill</span><span class="delimiter">(</span><a href="#504616" title="=&gt; Int">size</a><span class="delimiter">)</span><a href="#504618" title="=&gt; Manifest[A]" class="delimiter">(</a><a href="#504617" title="=&gt; A">z</a><span class="delimiter">)</span>

  <span class="keyword">import</span> <a href="#29736" title="scalaz.effect.ST.type">ST</a>._

  /**Reads the value at the given index. */
  <span class="keyword">def</span> <a title="(i: Int)scalaz.effect.ST[S,A]" id="504622">read</a><span class="delimiter">(</span><a title="Int" id="504683">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#44250" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#504619" title="(i: Int)A">value</a><span class="delimiter">(</span><a href="#504683" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>

  /**Writes the given value to the array, at the given offset. */
  <span class="keyword">def</span> <a title="(i: Int, a: A)scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]" id="504623">write</a><span class="delimiter">(</span><a title="Int" id="504688">i</a>: <span title="Int">Int</span>, <a title="A" id="504689">a</a>: <a href="#29729" title="A">A</a><span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">ST</a><span class="delimiter">[</span>S, STArray<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#44242" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], scalaz.effect.STArray[S,A]))scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="504694">s</a> =&gt; <span class="delimiter">{</span>
    <a href="#504619" title="(i: Int, x: A)Unit">value</a><span class="delimiter">(</span><a href="#504688" title="Int">i</a><span class="delimiter">)</span> = <a href="#504689" title="A">a</a>;
    <span title="(_1: scalaz.effect.Tower[S], _2: scalaz.effect.STArray[S,A])(scalaz.effect.Tower[S], scalaz.effect.STArray[S,A])" class="delimiter">(</span><a href="#504694" title="scalaz.effect.Tower[S]">s</a>, <a href="#29727" title="scalaz.effect.STArray[S,A]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  /**Turns a mutable array into an immutable one which is safe to return. */
  <span class="keyword">def</span> <a title="=&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" id="504624">freeze</a>: <a href="#29733" title="scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">ST</a><span class="delimiter">[</span>S, ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#44242" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], scalaz.ImmutableArray[A]))scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="504708">s</a> =&gt; <span title="(_1: scalaz.effect.Tower[S], _2: scalaz.ImmutableArray[A])(scalaz.effect.Tower[S], scalaz.ImmutableArray[A])" class="delimiter">(</span><a href="#504708" title="scalaz.effect.Tower[S]">s</a>, <a href="../../core/ImmutableArray.scala.html#9066" title="scalaz.ImmutableArray.type">ImmutableArray</a>.<a href="../../core/ImmutableArray.scala.html#358403" title="(x: Array[A])scalaz.ImmutableArray[A]">fromArray</a><span class="delimiter">(</span><a href="#504619" title="=&gt; Array[A]">value</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  /**Fill this array from the given association list. */
  <span class="keyword">def</span> <a title="[B](f: (A, B) =&gt; A, xs: Traversable[(Int, B)])scalaz.effect.ST[S,Unit]" id="504625">fill</a><span class="delimiter">[</span><a title="" id="504627">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, B) =&gt; A" id="504719">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; A, <a title="Traversable[(Int, B)]" id="504720">xs</a>: <span title="Traversable[(Int, B)]">Traversable</span><span class="delimiter">[</span><span class="delimiter">(</span>Int, B<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,Unit]">ST</a><span class="delimiter">[</span>S, Unit<span class="delimiter">]</span> = <a href="#504720" title="Traversable[(Int, B)]">xs</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#1684321" title="scalaz.effect.ST[S,Unit]">Nil</a>             =&gt; <a href="#44250" title="(a: =&gt; Unit)scalaz.effect.ST[S,Unit]">returnST</a><a href="#1684327" title="(x: scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]" class="delimiter">(</a><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span class="delimiter">(</span><a href="#1684324" title="=&gt; (Int, ?B1)" class="delimiter">(</a><a href="#1684323" title="Int" id="504736">i</a>, <a href="#1684323" title="B" id="504737">v</a><span class="delimiter">)</span> <a href="#1684321" title="scalaz.effect.ST[S,Unit]">::</a> <a href="#1684324" title="List[(Int, B)]" id="504738">ivs</a><span class="delimiter">)</span> =&gt; <span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="Unit" id="504770">_</a> &lt;- <a href="#504628" title="(f: (A, B) =&gt; A, i: Int, v: B)scalaz.effect.ST[S,Unit]">update</a><a href="#497259" title="(g: Unit =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#504719" title="(A, B) =&gt; A">f</a>, <a href="#504736" title="Int">i</a>, <a href="#504737" title="B">v</a><span class="delimiter">)</span>
      <a title="Unit" id="504789">_</a> &lt;- <a href="#504625" title="(f: (A, B) =&gt; A, xs: Traversable[(Int, B)])scalaz.effect.ST[S,Unit]">fill</a><a href="#497262" title="(g: Unit =&gt; Unit)scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#504719" title="(A, B) =&gt; A">f</a>, <a href="#504738" title="List[(Int, B)]">ivs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /**Combine the given value with the value at the given index, using the given function. */
  <span class="keyword">def</span> <a title="[B](f: (A, B) =&gt; A, i: Int, v: B)scalaz.effect.ST[S,Unit]" id="504628">update</a><span class="delimiter">[</span><a title="" id="504630">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, B) =&gt; A" id="504739">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; A, <a title="Int" id="504740">i</a>: <span title="Int">Int</span>, <a title="B" id="504741">v</a>: <a href="#504630" title="B">B</a><span class="delimiter">)</span> = <span class="keyword">for</span> <span class="delimiter">{</span>
    <a title="A" id="504746">x</a> &lt;- <a href="#504622" title="(i: Int)scalaz.effect.ST[S,A]">read</a><a href="#497259" title="(g: A =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#504740" title="Int">i</a><span class="delimiter">)</span>
    <a title="scalaz.effect.STArray[S,A]" id="504753">_</a> &lt;- <a href="#504623" title="(i: Int, a: A)scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">write</a><a href="#497262" title="(g: scalaz.effect.STArray[S,A] =&gt; Unit)scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#504740" title="Int">i</a>, <a href="#504739" title="(v1: A, v2: B)A">f</a><span class="delimiter">(</span><a href="#504746" title="A">x</a>, <a href="#504741" title="B">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">object</span> <a title="scalaz.effect.STArray.type" id="29730">STArray</a> <a href="#29731" title="scalaz.effect.STArray.type" class="keyword">extends</a> <a href="#29732" title="scalaz.effect.STArrayFunctions">STArrayFunctions</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]" id="497112">apply</a><span class="delimiter">[</span><a title="" id="497115">S</a>, <a title="" id="497116">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="504793">s</a>: <span title="Int">Int</span>, <a title="A" id="504794">a</a>: <a href="#497116" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Manifest[A]" id="504795">m</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#29727" title="scalaz.effect.STArray[S,A]">STArray</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#497106" title="(s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]">stArray</a><a href="#504795" title="Manifest[A]" class="delimiter">(</a><a href="#504793" title="Int">s</a>, <a href="#504794" title="A">a</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STArrayFunctions extends AnyRef" id="29732">STArrayFunctions</a> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]" id="497106">stArray</a><span class="delimiter">[</span><a title="" id="497109">S</a>, <a title="" id="497110">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="504800">s</a>: <span title="Int">Int</span>, <a title="A" id="504801">a</a>: <a href="#497110" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Manifest[A]" id="504802">m</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#29727" title="scalaz.effect.STArray[S,A]">STArray</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#504834" title="scalaz.effect.STArray[S,A]{}" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.effect.STArray[S,A]" id="504834">STArray</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="504836">size</a> = <a href="#504800" title="Int">s</a>
    <span class="keyword">val</span> <a title="A" id="504838">z</a> = <a href="#504801" title="A">a</a>
    <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="Manifest[A]" id="504840">manifest</a> = <a href="#504802" title="Manifest[A]">m</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

/**
 * Purely functional mutable state threads.
 * Based on JL and SPJ's paper &quot;Lazy Functional State Threads&quot;
 */
<span title="AnyRef" class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait ST[S, A] extends AnyRef" id="29733">ST</a><span class="delimiter">[</span><a title="" id="29734">S</a>, <a title="" id="29735">A</a><span class="delimiter">]</span> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">private</span><span class="delimiter">[</span>effect<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)" id="497257">apply</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="504846">s</a>: <a href="World.scala.html#29759" title="scalaz.effect.Tower[S]">Tower</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(scalaz.effect.Tower[S], A)" class="delimiter">(</span>Tower<span class="delimiter">[</span>S<span class="delimiter">]</span>, A<span class="delimiter">)</span>

  <span class="keyword">import</span> <a href="#29736" title="scalaz.effect.ST.type">ST</a>._

  <span class="keyword">def</span> <a title="[B](g: A =&gt; scalaz.effect.ST[S,B])scalaz.effect.ST[S,B]" id="497259">flatMap</a><span class="delimiter">[</span><a title="" id="497261">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; scalaz.effect.ST[S,B]" id="499813">g</a>: A =&gt; ST<span class="delimiter">[</span>S, B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,B]">ST</a><span class="delimiter">[</span>S, B<span class="delimiter">]</span> =
    <a href="#44242" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], B))scalaz.effect.ST[S,B]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="504851">s</a> =&gt; <a href="#497257" title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)">apply</a><a href="#1684335" title="(scalaz.effect.Tower[S], B)" class="delimiter">(</a><a href="#504851" title="scalaz.effect.Tower[S]">s</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span class="delimiter">(</span><a href="#1684335" title="scalaz.effect.Tower[S]" id="504854">ns</a>, <a href="#1684335" title="A" id="504855">a</a><span class="delimiter">)</span> =&gt; <a href="#499813" title="(v1: A)scalaz.effect.ST[S,B]">g</a><a href="#497257" title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], B)" class="delimiter">(</a><a href="#504855" title="A">a</a><span class="delimiter">)</span><a href="#1684337" title="(x: (scalaz.effect.Tower[S], B))(scalaz.effect.Tower[S], B)" class="delimiter">(</a><a href="#504854" title="scalaz.effect.Tower[S]">ns</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[B](g: A =&gt; B)scalaz.effect.ST[S,B]" id="497262">map</a><span class="delimiter">[</span><a title="" id="497264">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; B" id="499799">g</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,B]">ST</a><span class="delimiter">[</span>S, B<span class="delimiter">]</span> =
    <a href="#44242" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], B))scalaz.effect.ST[S,B]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="504862">s</a> =&gt; <a href="#497257" title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)">apply</a><a href="#1684341" title="(scalaz.effect.Tower[S], B)" class="delimiter">(</a><a href="#504862" title="scalaz.effect.Tower[S]">s</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span class="delimiter">(</span><a href="#1684341" title="scalaz.effect.Tower[S]" id="504865">ns</a>, <a href="#1684341" title="A" id="504866">a</a><span class="delimiter">)</span> =&gt; <a href="#1684343" title="(x: (scalaz.effect.Tower[S], B))(scalaz.effect.Tower[S], B)" class="delimiter">(</a><a href="#504865" title="scalaz.effect.Tower[S]">ns</a>, <a href="#499799" title="(v1: A)B">g</a><span class="delimiter">(</span><a href="#504866" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">object</span> <a title="scalaz.effect.ST.type" id="29736">ST</a> <a href="#29737" title="scalaz.effect.ST.type" class="keyword">extends</a> <a href="#29738" title="scalaz.effect.STFunctions">STFunctions</a> <span class="keyword">with</span> <a href="#29740" title="scalaz.effect.STInstances">STInstances</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](a: =&gt; A)scalaz.effect.ST[S,A]" id="44279">apply</a><span class="delimiter">[</span><a title="" id="44282">S</a>, <a title="" id="44283">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="504876">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> =
    <a href="#44250" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#504876" title="=&gt; A">a</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STFunctions extends AnyRef" id="29738">STFunctions</a> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], A))scalaz.effect.ST[S,A]" id="44242">st</a><span class="delimiter">[</span><a title="" id="44245">S</a>, <a title="" id="44246">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], A)" id="499434">f</a>: Tower<span class="delimiter">[</span>S<span class="delimiter">]</span> =&gt; <span class="delimiter">(</span>Tower<span class="delimiter">[</span>S<span class="delimiter">]</span>, A<span class="delimiter">)</span><span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#504884" title="scalaz.effect.ST[S,A]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.effect.ST[S,A]" id="504884">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">private</span><span class="delimiter">[</span>effect<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)" id="504886">apply</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="504888">s</a>: <a href="World.scala.html#29759" title="scalaz.effect.Tower[S]">Tower</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#499434" title="(v1: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)">f</a><span class="delimiter">(</span><a href="#504888" title="scalaz.effect.Tower[S]">s</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  // Implicit conversions between IO and ST
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](st: scalaz.effect.ST[scalaz.effect.IvoryTower,A])scalaz.effect.IO[A]" id="44247">STToIO</a><span class="delimiter">[</span><a title="" id="44249">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.effect.ST[scalaz.effect.IvoryTower,A]" id="497143">st</a>: <a href="#29733" title="scalaz.effect.ST[scalaz.effect.IvoryTower,A]">ST</a><span class="delimiter">[</span>IvoryTower, A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="IO.scala.html#29599" title="scalaz.effect.IO[A]">IO</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="IO.scala.html#29601" title="scalaz.effect.IO.type">IO</a>.<a href="IO.scala.html#44186" title="(f: scalaz.effect.Tower[scalaz.effect.IvoryTower] =&gt; scalaz.Free.Trampoline[(scalaz.effect.Tower[scalaz.effect.IvoryTower], A)])scalaz.effect.IO[A]">io</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[scalaz.effect.IvoryTower]" id="504898">rw</a> =&gt; <a href="../../core/Free.scala.html#10908" title="scalaz.Free.type">Free</a>.<a href="../../core/Free.scala.html#44473" title="(value: =&gt; (scalaz.effect.Tower[scalaz.effect.IvoryTower], A))(implicit S: scalaz.Applicative[Function0])scalaz.Free[Function0,(scalaz.effect.Tower[scalaz.effect.IvoryTower], A)]">return_</a><a href="../../core/std/Function.scala.html#44548" title="=&gt; scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Comonad[Function0] with scalaz.Distributive[Function0]" class="delimiter">(</a><a href="#497257" title="(s: scalaz.effect.Tower[scalaz.effect.IvoryTower])(scalaz.effect.Tower[scalaz.effect.IvoryTower], A)">st</a><span class="delimiter">(</span><a href="#504898" title="scalaz.effect.Tower[scalaz.effect.IvoryTower]">rw</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  /**Put a value in a state thread */
  <span class="keyword">def</span> <a title="[S, A](a: =&gt; A)scalaz.effect.ST[S,A]" id="44250">returnST</a><span class="delimiter">[</span><a title="" id="44253">S</a>, <a title="" id="44254">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="504479">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> =
    <a href="#44242" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], A))scalaz.effect.ST[S,A]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="504945">s</a> =&gt; <span title="(_1: scalaz.effect.Tower[S], _2: A)(scalaz.effect.Tower[S], A)" class="delimiter">(</span><a href="#504945" title="scalaz.effect.Tower[S]">s</a>, <a href="#504479" title="=&gt; A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>

  /**Run a state thread */
  <span class="keyword">def</span> <a title="[A](f: scalaz.Forall[[S]scalaz.effect.ST[S,A]])A" id="44255">runST</a><span class="delimiter">[</span><a title="" id="44257">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.Forall[[S]scalaz.effect.ST[S,A]]" id="504953">f</a>: <a href="../../core/Forall.scala.html#13529" title="scalaz.Forall[[S]scalaz.effect.ST[S,A]]">Forall</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>S<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#44257" title="A">A</a> =
    <a href="#504953" title="scalaz.Forall[[S]scalaz.effect.ST[S,A]]">f</a>.<a href="../../core/Forall.scala.html#282135" title="scalaz.effect.ST[scalaz.effect.IvoryTower,A]">apply</a>.<a href="#497257" title="(s: scalaz.effect.Tower[scalaz.effect.IvoryTower])(scalaz.effect.Tower[scalaz.effect.IvoryTower], A)">apply</a><span class="delimiter">(</span><a href="World.scala.html#44339" title="=&gt; scalaz.effect.Tower[scalaz.effect.IvoryTower]">ivoryTower</a><span class="delimiter">)</span>.<span title="=&gt; A">_2</span>

  /**Allocates a fresh mutable reference. */
  <span class="keyword">def</span> <a title="[S]=&gt; scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]" id="44258">newVar</a><span class="delimiter">[</span><a title="" id="44260">S</a><span class="delimiter">]</span>: <span class="delimiter">(</span>Id <a href="../../core/NaturalTransformation.scala.html#19940" title="scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> = <a href="#504968" title="scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]" id="504968" class="delimiter">(</a>Id <a href="../../core/NaturalTransformation.scala.html#19940" title="scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="504975">apply</a><span class="delimiter">[</span><a title="" id="504977">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="504979">a</a>: <a href="#504977" title="A">A</a><span class="delimiter">)</span> = <a href="#44250" title="(a: =&gt; scalaz.effect.STRef[S,A])scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">returnST</a><span class="delimiter">(</span><a href="#497118" title="[S]=&gt; scalaz.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">stRef</a><a href="../../core/NaturalTransformation.scala.html#144451" title="(fa: scalaz.Id.Id[A])scalaz.effect.STRef[S,A]" class="delimiter">[</a><a href="#44260" title="S">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#504979" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /**Allocates a fresh mutable array. */
  <span class="keyword">def</span> <a title="[S, A](size: Int, z: A)(implicit evidence$1: Manifest[A])scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]" id="505010">newArr</a><span class="delimiter">[</span><a title="" id="44264">S</a>, <a title="" id="44265">A</a>: Manifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="505008">size</a>: <span title="Int">Int</span>, <a title="A" id="505009">z</a>: <a href="#44265" title="A">A</a><span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">ST</a><span class="delimiter">[</span>S, STArray<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#44250" title="(a: =&gt; scalaz.effect.STArray[S,A])scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">returnST</a><span class="delimiter">(</span><a href="#497106" title="[S, A](s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]">stArray</a><span title="(s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]" class="delimiter">[</span><a href="#44264" title="S">S</a>, <a href="#44265" title="A">A</a><span class="delimiter">]</span><a href="#505010" title="Manifest[A]" class="delimiter">(</a><a href="#505008" title="Int">size</a>, <a href="#505009" title="A">z</a><span class="delimiter">)</span><span class="delimiter">)</span>

  /**Allows the result of a state transformer computation to be used lazily inside the computation. */
  <span class="keyword">def</span> <a title="[S, A](k: (=&gt; A) =&gt; scalaz.effect.ST[S,A])scalaz.effect.ST[S,A]" id="44266">fixST</a><span class="delimiter">[</span><a title="" id="44269">S</a>, <a title="" id="44270">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(=&gt; A) =&gt; scalaz.effect.ST[S,A]" id="505038">k</a>: <span class="delimiter">(</span>=&gt; A<span class="delimiter">)</span> =&gt; ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#44242" title="(f: scalaz.effect.Tower[S] =&gt; (scalaz.effect.Tower[S], A))scalaz.effect.ST[S,A]">st</a><span class="delimiter">(</span><a title="scalaz.effect.Tower[S]" id="505044">s</a> =&gt; <span class="delimiter">{</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="(scalaz.effect.Tower[S], A)" id="505045">ans</a>: <span title="(scalaz.effect.Tower[S], A)" class="delimiter">(</span>Tower<span class="delimiter">[</span>S<span class="delimiter">]</span>, A<span class="delimiter">)</span> = <a href="#505038" title="(v1: =&gt; A)scalaz.effect.ST[S,A]">k</a><a href="#497257" title="(s: scalaz.effect.Tower[S])(scalaz.effect.Tower[S], A)" class="delimiter">(</a><a href="#505047" title="=&gt; A">r</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#505044" title="scalaz.effect.Tower[S]">s</a><span class="delimiter">)</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="A" id="505047" class="delimiter">(</a>_, <a href="#1684347" title="A" id="505053">r</a><span class="delimiter">)</span> = <a href="#505045" title="=&gt; (scalaz.effect.Tower[S], A)">ans</a>
    <a href="#505045" title="=&gt; (scalaz.effect.Tower[S], A)">ans</a>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  /**Accumulates an integer-associated list into an immutable array. */
  <span class="keyword">def</span> <a title="[F[_], A, B](size: Int, f: (A, B) =&gt; A, z: A, ivs: F[(Int, B)])(implicit F: scalaz.Foldable[F], implicit mf: Manifest[A])scalaz.ImmutableArray[A]" id="44271">accumArray</a><span class="delimiter">[</span><a title="[_]" id="44275">F</a><span class="delimiter">[</span><a title="" id="505063">_</a><span class="delimiter">]</span>, <a title="" id="44276">A</a>, <a title="" id="44277">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="505057">size</a>: <span title="Int">Int</span>, <a title="(A, B) =&gt; A" id="505058">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; A, <a title="A" id="505059">z</a>: <a href="#44276" title="A">A</a>, <a title="F[(Int, B)]" id="505060">ivs</a>: <a href="#44275" title="F[(Int, B)]">F</a><span class="delimiter">[</span><span class="delimiter">(</span>Int, B<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[F]" id="505061">F</a>: <a href="../../core/Foldable.scala.html#17390" title="scalaz.Foldable[F]">Foldable</a><span class="delimiter">[</span>F<span class="delimiter">]</span>, <a title="Manifest[A]" id="505062">mf</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../core/ImmutableArray.scala.html#9065" title="scalaz.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> std.<a href="../../core/std/AnyVal.scala.html#24509" title="scalaz.std.anyVal.type">anyVal</a>.unitInstance
    <span class="keyword">type</span> <a title="[S]scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" id="505071">STA</a><span class="delimiter">[</span><a title="" id="505072">S</a><span class="delimiter">]</span> = <a href="#29733" title="scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">ST</a><span class="delimiter">[</span>S, ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>
    <a href="#44255" title="(f: scalaz.Forall[[S]scalaz.effect.ST[S,scalaz.ImmutableArray[A]]])scalaz.ImmutableArray[A]">runST</a><span class="delimiter">(</span><a href="#505075" title="scalaz.Forall[STA]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.Forall[STA]" id="505075">Forall</a><span class="delimiter">[</span>STA<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="[S]=&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" id="505077">apply</a><span class="delimiter">[</span><a title="" id="505079">S</a><span class="delimiter">]</span> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="scalaz.effect.STArray[S,A]" id="505115">a</a> &lt;- <a href="#505010" title="(size: Int, z: A)(implicit evidence$1: Manifest[A])scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">newArr</a><a href="#497259" title="(g: scalaz.effect.STArray[S,A] =&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]])scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" class="delimiter">(</a><a href="#505057" title="Int">size</a>, <a href="#505059" title="A">z</a><span class="delimiter">)</span>
        <a title="Unit" id="505169">_</a> &lt;- <span class="delimiter">{</span>
          <a href="#505061" title="scalaz.Foldable[F]">F</a>.<a href="../../core/Foldable.scala.html#33665" title="(fa: F[(Int, B)])(f: ((Int, B)) =&gt; scalaz.effect.ST[S,Unit])(implicit F: scalaz.Monoid[scalaz.effect.ST[S,Unit]])scalaz.effect.ST[S,Unit]">foldMap</a><span class="delimiter">(</span><a href="#505060" title="F[(Int, B)]">ivs</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span>x: <span title="(Int, B)" class="delimiter">(</span>Int, B<span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#505115" title="scalaz.effect.STArray[S,A]">a</a>.<a href="#504628" title="(f: (A, B) =&gt; A, i: Int, v: B)scalaz.effect.ST[S,Unit]">update</a><span class="delimiter">(</span><a href="#505058" title="(A, B) =&gt; A">f</a>, <a href="#505130" title="(Int, B)">x</a>.<span title="=&gt; Int">_1</span>, <a href="#505130" title="(Int, B)">x</a>.<span title="=&gt; B">_2</span><span class="delimiter">)</span><span class="delimiter">)</span><a href="#497259" title="(g: Unit =&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]])scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" class="delimiter">(</a><a href="#44291" title="[S, A](implicit A: scalaz.Monoid[A])scalaz.Monoid[scalaz.effect.ST[S,A]]">stMonoid</a><a href="../../core/std/AnyVal.scala.html#45694" title="(implicit A: scalaz.Monoid[Unit])scalaz.Monoid[scalaz.effect.ST[S,Unit]]" class="delimiter">[</a><a href="#505079" title="S">S</a>, <span title="Unit">Unit</span><span class="delimiter">]</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a title="scalaz.ImmutableArray[A]" id="505174">frozen</a> &lt;- <a href="#505115" title="scalaz.effect.STArray[S,A]">a</a>.<a href="#497262" title="(g: scalaz.ImmutableArray[A] =&gt; scalaz.ImmutableArray[A])scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">freeze</a>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#505174" title="scalaz.ImmutableArray[A]">frozen</a>
    <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">trait</span> <a title="trait STInstance0 extends AnyRef" id="29739">STInstance0</a> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S, A](implicit A: scalaz.Semigroup[A])scalaz.Semigroup[scalaz.effect.ST[S,A]]" id="44285">stSemigroup</a><span class="delimiter">[</span><a title="" id="44288">S</a>, <a title="" id="44289">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Semigroup[A]" id="497141">A</a>: <a href="../../core/Semigroup.scala.html#7832" title="scalaz.Semigroup[A]">Semigroup</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../core/Semigroup.scala.html#7832" title="scalaz.Semigroup[scalaz.effect.ST[S,A]]">Semigroup</a><span class="delimiter">[</span>ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
      <a href="../../core/Monoid.scala.html#12519" title="scalaz.Monoid.type">Monoid</a>.<a href="../../core/Monoid.scala.html#51401" title="[F[_], M](implicit F0: scalaz.Applicative[F], implicit M0: scalaz.Semigroup[M])scalaz.Semigroup[F[M]]">liftSemigroup</a><span title="(implicit F0: scalaz.Applicative[[α]scalaz.effect.ST[S,α]], implicit M0: scalaz.Semigroup[A])scalaz.Semigroup[scalaz.effect.ST[S,A]]" class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#<a href="#29733" title="[α]scalaz.effect.ST[S,α]">λ</a>, <a href="#44289" title="A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#29736" title="scalaz.effect.ST.type">ST</a>.<a href="#44296" title="[S]=&gt; scalaz.Monad[[α]scalaz.effect.ST[S,α]]">stMonad</a><span title="scalaz.Monad[[α]scalaz.effect.ST[S,α]]" class="delimiter">[</span><a href="#44288" title="S">S</a><span class="delimiter">]</span>, <a href="#497141" title="scalaz.Semigroup[A]">A</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">trait</span> <a title="trait STInstances extends AnyRef with scalaz.effect.STInstance0" id="29740">STInstances</a> <span title="Unit" class="keyword">extends</span> <a href="#29739" title="scalaz.effect.STInstance0">STInstance0</a> <span class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S, A](implicit A: scalaz.Monoid[A])scalaz.Monoid[scalaz.effect.ST[S,A]]" id="44291">stMonoid</a><span class="delimiter">[</span><a title="" id="44294">S</a>, <a title="" id="44295">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Monoid[A]" id="497138">A</a>: <a href="../../core/Monoid.scala.html#12518" title="scalaz.Monoid[A]">Monoid</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../core/Monoid.scala.html#12518" title="scalaz.Monoid[scalaz.effect.ST[S,A]]">Monoid</a><span class="delimiter">[</span>ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="../../core/Monoid.scala.html#12519" title="scalaz.Monoid.type">Monoid</a>.<a href="../../core/Monoid.scala.html#51406" title="[F[_], M](implicit F0: scalaz.Applicative[F], implicit M0: scalaz.Monoid[M])scalaz.Monoid[F[M]]">liftMonoid</a><span title="(implicit F0: scalaz.Applicative[[α]scalaz.effect.ST[S,α]], implicit M0: scalaz.Monoid[A])scalaz.Monoid[scalaz.effect.ST[S,A]]" class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#<a href="#29733" title="[α]scalaz.effect.ST[S,α]">λ</a>, <a href="#44295" title="A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#44296" title="[S]=&gt; scalaz.Monad[[α]scalaz.effect.ST[S,α]]">stMonad</a><span title="scalaz.Monad[[α]scalaz.effect.ST[S,α]]" class="delimiter">[</span><a href="#44294" title="S">S</a><span class="delimiter">]</span>, <a href="#497138" title="scalaz.Monoid[A]">A</a><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S]=&gt; scalaz.Monad[[α]scalaz.effect.ST[S,α]]" id="44296">stMonad</a><span class="delimiter">[</span><a title="" id="44298">S</a><span class="delimiter">]</span>: <a href="../../core/Monad.scala.html#15566" title="scalaz.Monad[[α]scalaz.effect.ST[S,α]]">Monad</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">]</span> = <a href="#505216" title="scalaz.Monad[[α]scalaz.effect.ST[S,α]]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with scalaz.Monad[[α]scalaz.effect.ST[S,α]]" id="505216">Monad</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: =&gt; A)scalaz.effect.ST[S,A]" id="505223">point</a><span class="delimiter">[</span><a title="" id="505225">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="505258">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#44250" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#505258" title="=&gt; A">a</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[A, B](fa: scalaz.effect.ST[S,A])(f: A =&gt; scalaz.effect.ST[S,B])scalaz.effect.ST[S,B]" id="505226">bind</a><span class="delimiter">[</span><a title="" id="505229">A</a>, <a title="" id="505230">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.effect.ST[S,A]" id="505264">fa</a>: <a href="#29733" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="A =&gt; scalaz.effect.ST[S,B]" id="505265">f</a>: A =&gt; ST<span class="delimiter">[</span>S, B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#29733" title="scalaz.effect.ST[S,B]">ST</a><span class="delimiter">[</span>S, B<span class="delimiter">]</span> = <a href="#505264" title="scalaz.effect.ST[S,A]">fa</a> <a href="#497259" title="(g: A =&gt; scalaz.effect.ST[S,B])scalaz.effect.ST[S,B]">flatMap</a> <a href="#505265" title="A =&gt; scalaz.effect.ST[S,B]">f</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
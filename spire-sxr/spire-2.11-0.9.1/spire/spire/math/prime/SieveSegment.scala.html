<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>spire/spire/math/prime/SieveSegment.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
package spire.math.prime

import scala.annotation.tailrec
import scala.collection.mutable.<span class="delimiter">{</span>ArrayBuffer<span class="delimiter">}</span>
import <span title="System.type">System</span>.arraycopy

import spire.math.<span class="delimiter">{</span>SafeLong, min<span class="delimiter">}</span>
import spire.syntax.<a href="../../syntax/package.scala.html#spire.syntax.package.cfor" title="spire.syntax.cfor.type">cfor</a>._

import <a href="SieveUtil.scala.html#spire.math.prime.SieveUtil" title="spire.math.prime.SieveUtil.type">SieveUtil</a>._

<span class="comment">/**
 * This respresents a single sieve segment.
 *
 * The 'start' field says what this segment's first number
 * is. 'primes' is a bitset of possible primes in this
 * segment. 'cutoff' specifies the largest prime factor we're
 * interested in. This means that cutoff**2-1 is the largest number we
 * could reliably identify as prime.
 * 
 * We are using a mod30 wheel, which means that we don't need to
 * manually factor using 2, 3, or 5 (30 is the lcm of 2, 3, and
 * 5). Since each wheel turn is 30-bits, and our bitset groups
 * elements into 32-bit groups (integers), we have a 480-bit (15
 * integer) period between the wheel and the bitset. This requires our
 * segment length to be divisible by 480.
 * 
 * When building a sieve, we will first initialize using the mod30
 * wheel. Then, if we are on the first segment, we'll do a traditional
 * sieve. We'll save any primes greater than 5 we find as factors,
 * either fast factors (if they will show up frequently in each
 * segment) or slow factors otherwise. If a factor is larger than
 * cutoff we don't save it. After that we'll be done with the first
 * segment.
 *
 * For later segments, we will use our fast and slow factors to block
 * out composites as we find them. Like in the first segment, we'll
 * save factors we find (although any new factors we find now will
 * always be slow). And of course we won't save any factors above our
 * cutoff.
 *
 * Once the sieve is initialized it doesn't do anything else
 * interesting, besides report prime numbers. Currently its internals
 * are made available to the Siever.
 */</span>
object <a title="spire.math.prime.SieveSegment.type" id="spire.math.prime.SieveSegment.readResolve">SieveSegment</a> <a href="#spire.math.prime.SieveSegment.readResolve" title="spire.math.prime.SieveSegment.type" class="delimiter">{</a>
  val <a title="Array[Int]" id="spire.math.prime.SieveSegment.wheel30">wheel30</a>: <span title="Array[Int]">Array</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span class="delimiter">{</span>
    var <a title="Long" id="spire.math.prime.SieveSegment.wheel30.b">b</a>: <span title="Long">Long</span> = <span title="Long(0L)" class="long">0L</span>
    <a href="#spire.math.prime.SieveSegment.wheel30.b" title="Long">b</a> <span title="(x: Int)Long">|=</span> <span class="delimiter">(</span><span class="int">1</span> <span title="Int(2)">&lt;&lt;</span> <span class="int">1</span><span class="delimiter">)</span>
    <a href="#spire.math.prime.SieveSegment.wheel30.b" title="Long">b</a> <span title="(x: Int)Long">|=</span> <span class="delimiter">(</span><span class="int">1</span> <span title="Int(128)">&lt;&lt;</span> <span class="int">7</span><span class="delimiter">)</span>
    <a href="#spire.math.prime.SieveSegment.wheel30.b" title="Long">b</a> <span title="(x: Int)Long">|=</span> <span class="delimiter">(</span><span class="int">1</span> <span title="Int(2048)">&lt;&lt;</span> <span class="int">11</span><span class="delimiter">)</span>
    <a href="#spire.math.prime.SieveSegment.wheel30.b" title="Long">b</a> <span title="(x: Int)Long">|=</span> <span class="delimiter">(</span><span class="int">1</span> <span title="Int(8192)">&lt;&lt;</span> <span class="int">13</span><span class="delimiter">)</span>
    <a href="#spire.math.prime.SieveSegment.wheel30.b" title="Long">b</a> <span title="(x: Int)Long">|=</span> <span class="delimiter">(</span><span class="int">1</span> <span title="Int(131072)">&lt;&lt;</span> <span class="int">17</span><span class="delimiter">)</span>
    <a href="#spire.math.prime.SieveSegment.wheel30.b" title="Long">b</a> <span title="(x: Int)Long">|=</span> <span class="delimiter">(</span><span class="int">1</span> <span title="Int(524288)">&lt;&lt;</span> <span class="int">19</span><span class="delimiter">)</span>
    <a href="#spire.math.prime.SieveSegment.wheel30.b" title="Long">b</a> <span title="(x: Int)Long">|=</span> <span class="delimiter">(</span><span class="int">1</span> <span title="Int(8388608)">&lt;&lt;</span> <span class="int">23</span><span class="delimiter">)</span>
    <a href="#spire.math.prime.SieveSegment.wheel30.b" title="Long">b</a> <span title="(x: Int)Long">|=</span> <span class="delimiter">(</span><span class="int">1</span> <span title="Int(536870912)">&lt;&lt;</span> <span class="int">29</span><span class="delimiter">)</span>
    val n: <span title="Long">Long</span> = <a href="#spire.math.prime.SieveSegment.wheel30.b" title="Long">b</a> <a title="Long" id="spire.math.prime.SieveSegment.wheel30.n">|</a> <span class="delimiter">(</span><a href="#spire.math.prime.SieveSegment.wheel30.b" title="Long">b</a> <span title="(x: Long)Long">&lt;&lt;</span> <span title="Long(30L)" class="long">30L</span><span class="delimiter">)</span>
    val <a title="Array[Int]" id="spire.math.prime.SieveSegment.wheel30.arr">arr</a> = new <span title="Array[Int]">Array</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(15)" class="int">15</span><span class="delimiter">)</span>
    cfor<span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">(</span>_ <span title="(x: Int)Boolean">&lt;</span> <span title="Int(15)" class="int">15</span>, _ <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a title="Int" id="spire.math.prime.SieveSegment.wheel30.index$macro$400" class="delimiter">{</a> i =&gt;
      <a href="#spire.math.prime.SieveSegment.wheel30.arr" title="(i: Int, x: Int)Unit">arr</a><span class="delimiter">(</span>i<span class="delimiter">)</span> = <span class="delimiter">(</span><span class="delimiter">(</span><a href="#spire.math.prime.SieveSegment.wheel30.n" title="Long">n</a> <span title="(x: Int)Long">&gt;&gt;&gt;</span> <span class="delimiter">(</span>i <span title="(x: Int)Int">*</span> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Long)Long">&amp;</span> <span title="Long(4294967295L)" class="long">0xffffffffL</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>
    <span class="delimiter">}</span>
    <a href="#spire.math.prime.SieveSegment.wheel30.arr" title="Array[Int]">arr</a>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

case class <a title="(start: spire.math.SafeLong, primes: spire.math.prime.BitSet, cutoff: spire.math.SafeLong)spire.math.prime.SieveSegment" id="spire.math.prime;SieveSegment.equals">SieveSegment</a><a href="#spire.math.prime;SieveSegment.equals" title="Product" class="delimiter">(</a><a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.copy$default$1">start</a>: <a href="../SafeLong.scala.html#spire.math;SafeLong" title="spire.math.SafeLong">SafeLong</a>, <a title="spire.math.prime.BitSet" id="spire.math.prime;SieveSegment.copy$default$2">primes</a>: <a href="BitSet.scala.html#spire.math.prime;BitSet" title="spire.math.prime.BitSet">BitSet</a>, <a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.copy$default$3">cutoff</a>: <a href="../SafeLong.scala.html#spire.math;SafeLong" title="spire.math.SafeLong">SafeLong</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  def <a title="(n: spire.math.SafeLong)Boolean" id="spire.math.prime;SieveSegment.isPrime">isPrime</a><span class="delimiter">(</span><a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.isPrime.n">n</a>: <a href="../SafeLong.scala.html#spire.math;SafeLong" title="spire.math.SafeLong">SafeLong</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="BitSet.scala.html#spire.math.prime;BitSet.apply" title="(n: Int)Boolean">primes</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.isPrime.n" title="spire.math.SafeLong">n</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.-(a361d50555)" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a><span class="delimiter">)</span>.<a href="../SafeLong.scala.html#spire.math;SafeLong.toInt" title="=&gt; Int">toInt</a><span class="delimiter">)</span>
  def <a title="(n: spire.math.SafeLong)Boolean" id="spire.math.prime;SieveSegment.isComposite">isComposite</a><span class="delimiter">(</span><a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.isComposite.n">n</a>: <a href="../SafeLong.scala.html#spire.math;SafeLong" title="spire.math.SafeLong">SafeLong</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span title="=&gt; Boolean">!</span><a href="BitSet.scala.html#spire.math.prime;BitSet.apply" title="(n: Int)Boolean">primes</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.isComposite.n" title="spire.math.SafeLong">n</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.-(a361d50555)" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a><span class="delimiter">)</span>.<a href="../SafeLong.scala.html#spire.math;SafeLong.toInt" title="=&gt; Int">toInt</a><span class="delimiter">)</span>
  def <a title="(n: spire.math.SafeLong)Unit" id="spire.math.prime;SieveSegment.set">set</a><span class="delimiter">(</span><a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.set.n">n</a>: <a href="../SafeLong.scala.html#spire.math;SafeLong" title="spire.math.SafeLong">SafeLong</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.+=" title="(n: Int)Unit">+=</a> <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.set.n" title="spire.math.SafeLong">n</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.-(a361d50555)" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a><span class="delimiter">)</span>.<a href="../SafeLong.scala.html#spire.math;SafeLong.toInt" title="=&gt; Int">toInt</a>
  def <a title="(n: spire.math.SafeLong)Unit" id="spire.math.prime;SieveSegment.unset">unset</a><span class="delimiter">(</span><a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.unset.n">n</a>: <a href="../SafeLong.scala.html#spire.math;SafeLong" title="spire.math.SafeLong">SafeLong</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.-=" title="(n: Int)Unit">-=</a> <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.unset.n" title="spire.math.SafeLong">n</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.-(a361d50555)" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a><span class="delimiter">)</span>.<a href="../SafeLong.scala.html#spire.math;SafeLong.toInt" title="=&gt; Int">toInt</a>

  def <a title="(n: spire.math.SafeLong)spire.math.SafeLong" id="spire.math.prime;SieveSegment.nextAfter">nextAfter</a><span class="delimiter">(</span><a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.nextAfter.n">n</a>: <a href="../SafeLong.scala.html#spire.math;SafeLong" title="spire.math.SafeLong">SafeLong</a><span class="delimiter">)</span>: <a href="../SafeLong.scala.html#spire.math;SafeLong" title="spire.math.SafeLong">SafeLong</a> = <span class="delimiter">{</span>
    var <a title="Int" id="spire.math.prime;SieveSegment.nextAfter.i">i</a> = <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.nextAfter.n" title="spire.math.SafeLong">n</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.-(a361d50555)" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.+(8cf326fedb)" title="(rhs: Long)spire.math.SafeLong">+</a> <span title="Long(2L)" class="int">2</span><span class="delimiter">)</span>.<a href="../SafeLong.scala.html#spire.math;SafeLong.toInt" title="=&gt; Int">toInt</a>
    val <a title="Int" id="spire.math.prime;SieveSegment.nextAfter.len">len</a> = <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.length" title="=&gt; Int">length</a>
    while <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.nextAfter.i" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.nextAfter.len" title="Int">len</a><span class="delimiter">)</span> <a href="#spire.math.prime;SieveSegment.nextAfter.while$1" title="()Unit" class="delimiter">{</a>
      if <span class="delimiter">(</span><a href="BitSet.scala.html#spire.math.prime;BitSet.apply" title="(n: Int)Boolean">primes</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.nextAfter.i" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span> return <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.+(8cf326fedb)" title="(rhs: Long)spire.math.SafeLong">+</a> <a href="#spire.math.prime;SieveSegment.nextAfter.i" title="=&gt; Long">i</a>
      <a href="#spire.math.prime;SieveSegment.nextAfter.i" title="Int">i</a> <span title="(x: Int)Int">+=</span> <span title="Int(2)" class="int">2</span>
    <span class="delimiter">}</span>
    <a href="../SafeLong.scala.html#spire.math.SafeLong.apply(88efbd6bde)" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>-<span title="Long(-1L)" class="long">1L</span><span class="delimiter">)</span> <span class="comment">// fail</span>
  <span class="delimiter">}</span>

  def <a title="(fastq: spire.math.prime.SieveUtil.FastFactors, slowq: spire.math.prime.FactorHeap)Unit" id="spire.math.prime;SieveSegment.init">init</a><span class="delimiter">(</span><a title="spire.math.prime.SieveUtil.FastFactors" id="spire.math.prime;SieveSegment.init.fastq">fastq</a>: <a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;FastFactors" title="spire.math.prime.SieveUtil.FastFactors">FastFactors</a>, <a title="spire.math.prime.FactorHeap" id="spire.math.prime;SieveSegment.init.slowq">slowq</a>: <a href="FactorHeap.scala.html#spire.math.prime;FactorHeap" title="spire.math.prime.FactorHeap">FactorHeap</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#spire.math.prime;SieveSegment.initMod30" title="()Unit">initMod30</a><span class="delimiter">(</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#spire.math.prime;SieveSegment.initFirst" title="(fastq: spire.math.prime.SieveUtil.FastFactors, slowq: spire.math.prime.FactorHeap)Unit">initFirst</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.init.fastq" title="spire.math.prime.SieveUtil.FastFactors">fastq</a>, <a href="#spire.math.prime;SieveSegment.init.slowq" title="spire.math.prime.FactorHeap">slowq</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> else <span class="delimiter">{</span>
      val <a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.init.limit">limit</a> = <a href="../package.scala.html#spire.math.package.min(9ef17897e5)" title="(x: spire.math.SafeLong, y: spire.math.SafeLong)(implicit ev: spire.algebra.Order[spire.math.SafeLong])spire.math.SafeLong">min</a><a href="../SafeLong.scala.html#spire.math;SafeLongInstances.SafeLongIsReal" title="spire.math.SafeLong.SafeLongIsReal.type" class="delimiter">(</a><a href="#spire.math.prime;SieveSegment.copy$default$3" title="=&gt; spire.math.SafeLong">cutoff</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.**" title="(rhs: Int)spire.math.SafeLong">**</a> <span title="Int(2)" class="int">2</span>, <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.+(8cf326fedb)" title="(rhs: Long)spire.math.SafeLong">+</a> <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.length" title="=&gt; Long">length</a><span class="delimiter">)</span>
      <a href="#spire.math.prime;SieveSegment.initFromArray" title="(fastq: spire.math.prime.SieveUtil.FastFactors)Unit">initFromArray</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.init.fastq" title="spire.math.prime.SieveUtil.FastFactors">fastq</a><span class="delimiter">)</span>
      <a href="#spire.math.prime;SieveSegment.initFromQueue" title="(limit: spire.math.SafeLong, q: spire.math.prime.FactorHeap)Unit">initFromQueue</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.init.limit" title="spire.math.SafeLong">limit</a>, <a href="#spire.math.prime;SieveSegment.init.slowq" title="spire.math.prime.FactorHeap">slowq</a><span class="delimiter">)</span>
      <a href="#spire.math.prime;SieveSegment.initRest" title="(slowq: spire.math.prime.FactorHeap)Unit">initRest</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.init.slowq" title="spire.math.prime.FactorHeap">slowq</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="()Unit" id="spire.math.prime;SieveSegment.initMod30">initMod30</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="Array[Int]" id="spire.math.prime;SieveSegment.initMod30.arr">arr</a> = <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.array" title="=&gt; Array[Int]">array</a>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initMod30.arr" title="Array[Int]">arr</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">%</span> <span title="Int(15)" class="int">15</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    val <a title="Int" id="spire.math.prime;SieveSegment.initMod30.limit">limit</a> = <a href="#spire.math.prime;SieveSegment.initMod30.arr" title="Array[Int]">arr</a>.<span title="=&gt; Int">length</span>
    val <a title="Array[Int]" id="spire.math.prime;SieveSegment.initMod30.wheel">wheel</a> = <a href="#spire.math.prime.SieveSegment.readResolve" title="spire.math.prime.SieveSegment.type">SieveSegment</a>.<a href="#spire.math.prime.SieveSegment.wheel30" title="=&gt; Array[Int]">wheel30</a>
    cfor<span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">(</span>_ <span title="(x: Int)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.initMod30.limit" title="Int">limit</a>, _ <span title="(x: Int)Int">+</span> <span title="Int(15)" class="int">15</span><span class="delimiter">)</span><a title="Int" id="spire.math.prime;SieveSegment.initMod30.index$macro$401" class="delimiter">(</a>i =&gt; <span title="(x$1: Any, x$2: Int, x$3: Any, x$4: Int, x$5: Int)Unit">arraycopy</span><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initMod30.wheel" title="Array[Int]">wheel</a>, <span title="Int(0)" class="int">0</span>, <a href="#spire.math.prime;SieveSegment.initMod30.arr" title="Array[Int]">arr</a>, i, <span title="Int(15)" class="int">15</span><span class="delimiter">)</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <span title="(x$1: Any)Boolean">==</span> <span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.-=" title="(n: Int)Unit">-=</a> <span title="Int(1)" class="int">1</span>
      <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.+=" title="(n: Int)Unit">+=</a> <span title="Int(2)" class="int">2</span>
      <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.+=" title="(n: Int)Unit">+=</a> <span title="Int(3)" class="int">3</span>
      <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.+=" title="(n: Int)Unit">+=</a> <span title="Int(5)" class="int">5</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  private def <a title="(fastq: spire.math.prime.SieveUtil.FastFactors)Unit" id="spire.math.prime;SieveSegment.initFromArray">initFromArray</a><span class="delimiter">(</span><a title="spire.math.prime.SieveUtil.FastFactors" id="spire.math.prime;SieveSegment.initFromArray.fastq">fastq</a>: <a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;FastFactors" title="spire.math.prime.SieveUtil.FastFactors">FastFactors</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="Array[spire.math.prime.SieveUtil.FastFactor]" id="spire.math.prime;SieveSegment.initFromArray.arr">arr</a> = <a href="#spire.math.prime;SieveSegment.initFromArray.fastq" title="spire.math.prime.SieveUtil.FastFactors">fastq</a>.<a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;FastFactors.arr" title="=&gt; Array[spire.math.prime.SieveUtil.FastFactor]">arr</a>
    var <a title="Int" id="spire.math.prime;SieveSegment.initFromArray.i">i</a> = <span title="Int(0)" class="int">0</span>

    val <a title="Long" id="spire.math.prime;SieveSegment.initFromArray.len">len</a>: <span title="Long">Long</span> = if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.+(8cf326fedb)" title="(rhs: Long)spire.math.SafeLong">+</a> <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.length" title="=&gt; Long">length</a> <span title="(that: spire.math.SafeLong)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.copy$default$3" title="=&gt; spire.math.SafeLong">cutoff</a><span class="delimiter">)</span>
      <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.copy$default$3" title="=&gt; spire.math.SafeLong">cutoff</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.-(a361d50555)" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span>
    else
      <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.length" title="=&gt; Long">length</a>

    while <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFromArray.i" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.initFromArray.arr" title="Array[spire.math.prime.SieveUtil.FastFactor]">arr</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span> <a href="#spire.math.prime;SieveSegment.initFromArray.while$3" title="()Unit" class="delimiter">{</a>
      val <a title="spire.math.prime.SieveUtil.FastFactor" id="spire.math.prime;SieveSegment.initFromArray.factor">factor</a> = <a href="#spire.math.prime;SieveSegment.initFromArray.arr" title="(i: Int)spire.math.prime.SieveUtil.FastFactor">arr</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFromArray.i" title="Int">i</a><span class="delimiter">)</span>
      var <a title="Int" id="spire.math.prime;SieveSegment.initFromArray.j">j</a> = <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFromArray.factor" title="spire.math.prime.SieveUtil.FastFactor">factor</a>.<a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;FastFactor.m" title="=&gt; spire.math.SafeLong">m</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.-(a361d50555)" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a><span class="delimiter">)</span>.<a href="../SafeLong.scala.html#spire.math;SafeLong.toInt" title="=&gt; Int">toInt</a>
      val <a title="Int" id="spire.math.prime;SieveSegment.initFromArray.k">k</a> = <a href="#spire.math.prime;SieveSegment.initFromArray.factor" title="spire.math.prime.SieveUtil.FastFactor">factor</a>.<a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;FastFactor.p" title="=&gt; Int">p</a>
      val kk = <a href="#spire.math.prime;SieveSegment.initFromArray.k" title="Int">k</a> <a title="Int" id="spire.math.prime;SieveSegment.initFromArray.kk">+</a> <a href="#spire.math.prime;SieveSegment.initFromArray.k" title="Int">k</a>
      val lim = <a href="#spire.math.prime;SieveSegment.initFromArray.len" title="Long">len</a> <a title="Long" id="spire.math.prime;SieveSegment.initFromArray.lim">-</a> <a href="#spire.math.prime;SieveSegment.initFromArray.kk" title="Int">kk</a>
      <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.-=" title="(n: Int)Unit">-=</a> <a href="#spire.math.prime;SieveSegment.initFromArray.j" title="Int">j</a>
      while <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFromArray.j" title="Int">j</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.initFromArray.lim" title="Long">lim</a><span class="delimiter">)</span> <a href="#spire.math.prime;SieveSegment.initFromArray.while$2" title="()Unit" class="delimiter">{</a>
        <a href="#spire.math.prime;SieveSegment.initFromArray.j" title="Int">j</a> <span title="(x: Int)Int">+=</span> <a href="#spire.math.prime;SieveSegment.initFromArray.kk" title="Int">kk</a>
        <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.-=" title="(n: Int)Unit">-=</a> <a href="#spire.math.prime;SieveSegment.initFromArray.j" title="Int">j</a>
      <span class="delimiter">}</span>
      <a href="#spire.math.prime;SieveSegment.initFromArray.factor" title="spire.math.prime.SieveUtil.FastFactor">factor</a>.<a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;FastFactor.m_=" title="(x$1: spire.math.SafeLong)Unit">m</a> = <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.+(8cf326fedb)" title="(rhs: Long)spire.math.SafeLong">+</a> <a href="#spire.math.prime;SieveSegment.initFromArray.j" title="=&gt; Long">j</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.+(8cf326fedb)" title="(rhs: Long)spire.math.SafeLong">+</a> <a href="#spire.math.prime;SieveSegment.initFromArray.kk" title="=&gt; Long">kk</a>
      <a href="#spire.math.prime;SieveSegment.initFromArray.i" title="Int">i</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  @tailrec private def <a title="(limit: spire.math.SafeLong, q: spire.math.prime.FactorHeap)Unit" id="spire.math.prime;SieveSegment.initFromQueue">initFromQueue</a><span class="delimiter">(</span><a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.initFromQueue.limit">limit</a>: <a href="../SafeLong.scala.html#spire.math;SafeLong" title="spire.math.SafeLong">SafeLong</a>, <a title="spire.math.prime.FactorHeap" id="spire.math.prime;SieveSegment.initFromQueue.q">q</a>: <a href="FactorHeap.scala.html#spire.math.prime;FactorHeap" title="spire.math.prime.FactorHeap">FactorHeap</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFromQueue.q" title="spire.math.prime.FactorHeap">q</a>.<a href="FactorHeap.scala.html#spire.math.prime;FactorHeap.isEmpty" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> return <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>

    val <a title="spire.math.prime.SieveUtil.Factor" id="spire.math.prime;SieveSegment.initFromQueue.factor">factor</a> = <a href="#spire.math.prime;SieveSegment.initFromQueue.q" title="spire.math.prime.FactorHeap">q</a>.<a href="FactorHeap.scala.html#spire.math.prime;FactorHeap.dequeue" title="()spire.math.prime.SieveUtil.Factor">dequeue</a>
    val <a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.initFromQueue.m">m</a> = <a href="#spire.math.prime;SieveSegment.initFromQueue.factor" title="spire.math.prime.SieveUtil.Factor">factor</a>.<a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;Factor.next" title="=&gt; spire.math.SafeLong">next</a>
    if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFromQueue.m" title="spire.math.SafeLong">m</a> <span title="(that: spire.math.SafeLong)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.initFromQueue.limit" title="spire.math.SafeLong">limit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.initFromQueue.p">p</a> = <a href="#spire.math.prime;SieveSegment.initFromQueue.factor" title="spire.math.prime.SieveUtil.Factor">factor</a>.<a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;Factor.p" title="=&gt; spire.math.SafeLong">p</a>
      val <a title="Int" id="spire.math.prime;SieveSegment.initFromQueue.len">len</a> = <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.length" title="=&gt; Int">length</a>
      var <a title="Int" id="spire.math.prime;SieveSegment.initFromQueue.i">i</a> = <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFromQueue.m" title="spire.math.SafeLong">m</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.-(a361d50555)" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a><span class="delimiter">)</span>.<a href="../SafeLong.scala.html#spire.math;SafeLong.toInt" title="=&gt; Int">toInt</a>
      val <a title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.initFromQueue.m2">m2</a> = if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFromQueue.p" title="spire.math.SafeLong">p</a> <span title="(that: spire.math.SafeLong)Boolean">&lt;</span> <a href="../SafeLong.scala.html#spire.math.SafeLong.apply(88efbd6bde)" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">len</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        val <a title="Int" id="spire.math.prime;SieveSegment.initFromQueue.m2.k">k</a> = <a href="#spire.math.prime;SieveSegment.initFromQueue.p" title="spire.math.SafeLong">p</a>.<a href="../SafeLong.scala.html#spire.math;SafeLong.toInt" title="=&gt; Int">toInt</a>
        val kk = <a href="#spire.math.prime;SieveSegment.initFromQueue.m2.k" title="Int">k</a> <a title="Int" id="spire.math.prime;SieveSegment.initFromQueue.m2.kk">+</a> <a href="#spire.math.prime;SieveSegment.initFromQueue.m2.k" title="Int">k</a>
        while <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFromQueue.i" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.initFromQueue.len" title="Int">len</a><span class="delimiter">)</span> <a href="#spire.math.prime;SieveSegment.initFromQueue.m2.while$4" title="()Unit" class="delimiter">{</a> <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.-=" title="(n: Int)Unit">-=</a> <a href="#spire.math.prime;SieveSegment.initFromQueue.i" title="Int">i</a>; <a href="#spire.math.prime;SieveSegment.initFromQueue.i" title="Int">i</a> <span title="(x: Int)Int">+=</span> <a href="#spire.math.prime;SieveSegment.initFromQueue.m2.kk" title="Int">kk</a> <span class="delimiter">}</span>
        <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.+(8cf326fedb)" title="(rhs: Long)spire.math.SafeLong">+</a> <a href="#spire.math.prime;SieveSegment.initFromQueue.i" title="=&gt; Long">i</a>
      <span class="delimiter">}</span> else <span class="delimiter">{</span>
        <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.-=" title="(n: Int)Unit">-=</a> <a href="#spire.math.prime;SieveSegment.initFromQueue.i" title="Int">i</a>
        <a href="#spire.math.prime;SieveSegment.initFromQueue.m" title="spire.math.SafeLong">m</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.+(a361d50555)" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">+</a> <a href="#spire.math.prime;SieveSegment.initFromQueue.p" title="spire.math.SafeLong">p</a>
      <span class="delimiter">}</span>
      <a href="#spire.math.prime;SieveSegment.initFromQueue.factor" title="spire.math.prime.SieveUtil.Factor">factor</a>.<a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;Factor.next_=" title="(x$1: spire.math.SafeLong)Unit">next</a> = <a href="#spire.math.prime;SieveSegment.initFromQueue.m2" title="spire.math.SafeLong">m2</a>
      <a href="#spire.math.prime;SieveSegment.initFromQueue.q" title="spire.math.prime.FactorHeap">q</a> <a href="FactorHeap.scala.html#spire.math.prime;FactorHeap.+=" title="(factor: spire.math.prime.SieveUtil.Factor)Unit">+=</a> <a href="#spire.math.prime;SieveSegment.initFromQueue.factor" title="spire.math.prime.SieveUtil.Factor">factor</a>
      <a href="#spire.math.prime;SieveSegment.initFromQueue" title="(limit: spire.math.SafeLong, q: spire.math.prime.FactorHeap)Unit">initFromQueue</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFromQueue.limit" title="spire.math.SafeLong">limit</a>, <a href="#spire.math.prime;SieveSegment.initFromQueue.q" title="spire.math.prime.FactorHeap">q</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> else <span class="delimiter">{</span>
      <a href="#spire.math.prime;SieveSegment.initFromQueue.q" title="spire.math.prime.FactorHeap">q</a> <a href="FactorHeap.scala.html#spire.math.prime;FactorHeap.+=" title="(factor: spire.math.prime.SieveUtil.Factor)Unit">+=</a> <a href="#spire.math.prime;SieveSegment.initFromQueue.factor" title="spire.math.prime.SieveUtil.Factor">factor</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(fastq: spire.math.prime.SieveUtil.FastFactors, slowq: spire.math.prime.FactorHeap)Unit" id="spire.math.prime;SieveSegment.initFirst">initFirst</a><span class="delimiter">(</span><a title="spire.math.prime.SieveUtil.FastFactors" id="spire.math.prime;SieveSegment.initFirst.fastq">fastq</a>: <a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;FastFactors" title="spire.math.prime.SieveUtil.FastFactors">FastFactors</a>, <a title="spire.math.prime.FactorHeap" id="spire.math.prime;SieveSegment.initFirst.slowq">slowq</a>: <a href="FactorHeap.scala.html#spire.math.prime;FactorHeap" title="spire.math.prime.FactorHeap">FactorHeap</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    var <a title="Int" id="spire.math.prime;SieveSegment.initFirst.p">p</a>: <span title="Int">Int</span> = <span title="Int(1)" class="int">1</span>
    val <a title="Int" id="spire.math.prime;SieveSegment.initFirst.len">len</a> = <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.length" title="=&gt; Int">length</a>
    val <a title="scala.collection.mutable.ArrayBuffer[spire.math.prime.SieveUtil.FastFactor]" id="spire.math.prime;SieveSegment.initFirst.buf">buf</a> = <span title="scala.collection.mutable.ArrayBuffer.type">ArrayBuffer</span>.<span title="[A]=&gt; scala.collection.mutable.ArrayBuffer[A]">empty</span><span title="scala.collection.mutable.ArrayBuffer[spire.math.prime.SieveUtil.FastFactor]" class="delimiter">[</span><a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;FastFactor" title="spire.math.prime.SieveUtil.FastFactor">FastFactor</a><span class="delimiter">]</span>
    while <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFirst.p" title="Int">p</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.initFirst.len" title="Int">len</a><span class="delimiter">)</span> <a href="#spire.math.prime;SieveSegment.initFirst.while$6" title="()Unit" class="delimiter">{</a>
      if <span class="delimiter">(</span><a href="BitSet.scala.html#spire.math.prime;BitSet.apply" title="(n: Int)Boolean">primes</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFirst.p" title="Int">p</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        var m = <a href="#spire.math.prime;SieveSegment.initFirst.p" title="Int">p</a>.<span title="=&gt; Long">toLong</span> <a title="Long" id="spire.math.prime;SieveSegment.initFirst.m">*</a> <a href="#spire.math.prime;SieveSegment.initFirst.p" title="Int">p</a>.<span title="=&gt; Long">toLong</span>
        if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFirst.m" title="Long">m</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.initFirst.len" title="Int">len</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          val pp = <a href="#spire.math.prime;SieveSegment.initFirst.p" title="Int">p</a> <a title="Int" id="spire.math.prime;SieveSegment.initFirst.pp">+</a> <a href="#spire.math.prime;SieveSegment.initFirst.p" title="Int">p</a>
          var <a title="Int" id="spire.math.prime;SieveSegment.initFirst.k">k</a> = <a href="#spire.math.prime;SieveSegment.initFirst.m" title="Long">m</a>.<span title="=&gt; Int">toInt</span>
          <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.-=" title="(n: Int)Unit">-=</a> <a href="#spire.math.prime;SieveSegment.initFirst.k" title="Int">k</a>
          val lim = <a href="#spire.math.prime;SieveSegment.initFirst.len" title="Int">len</a> <a title="Int" id="spire.math.prime;SieveSegment.initFirst.lim">-</a> <a href="#spire.math.prime;SieveSegment.initFirst.pp" title="Int">pp</a>
          while <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFirst.k" title="Int">k</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.initFirst.lim" title="Int">lim</a><span class="delimiter">)</span> <a href="#spire.math.prime;SieveSegment.initFirst.while$5" title="()Unit" class="delimiter">{</a> <a href="#spire.math.prime;SieveSegment.initFirst.k" title="Int">k</a> <span title="(x: Int)Int">+=</span> <a href="#spire.math.prime;SieveSegment.initFirst.pp" title="Int">pp</a>; <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a> <a href="BitSet.scala.html#spire.math.prime;BitSet.-=" title="(n: Int)Unit">-=</a> <a href="#spire.math.prime;SieveSegment.initFirst.k" title="Int">k</a> <span class="delimiter">}</span>
          <a href="#spire.math.prime;SieveSegment.initFirst.m" title="Long">m</a> = <a href="#spire.math.prime;SieveSegment.initFirst.k" title="Int">k</a>.<span title="=&gt; Long">toLong</span> <span title="(x: Int)Long">+</span> <a href="#spire.math.prime;SieveSegment.initFirst.pp" title="Int">pp</a>
        <span class="delimiter">}</span>
        if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFirst.p" title="Int">p</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(7)" class="int">7</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span>
        <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFirst.m" title="Long">m</a> <span title="(x: Int)Long">-</span> <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.length" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.length" title="=&gt; Int">length</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#spire.math.prime;SieveSegment.initFirst.buf" title="scala.collection.mutable.ArrayBuffer[spire.math.prime.SieveUtil.FastFactor]">buf</a> <span title="(elem: spire.math.prime.SieveUtil.FastFactor)buf.type">+=</span> <a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;FastFactor" title="(p: Int, m: spire.math.SafeLong)spire.math.prime.SieveUtil.FastFactor">FastFactor</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFirst.p" title="Int">p</a>, <a href="../SafeLong.scala.html#spire.math.SafeLong.apply(88efbd6bde)" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFirst.m" title="Long">m</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.copy$default$3" title="=&gt; spire.math.SafeLong">cutoff</a> <span title="(that: spire.math.SafeLong)Boolean">&gt;</span> <a href="../SafeLong.scala.html#spire.math.SafeLong.apply(88efbd6bde)" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">p</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#spire.math.prime;SieveSegment.initFirst.slowq" title="spire.math.prime.FactorHeap">slowq</a> <a href="FactorHeap.scala.html#spire.math.prime;FactorHeap.+=" title="(factor: spire.math.prime.SieveUtil.Factor)Unit">+=</a> <a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;Factor" title="(p: spire.math.SafeLong, next: spire.math.SafeLong)spire.math.prime.SieveUtil.Factor">Factor</a><span class="delimiter">(</span><a href="../SafeLong.scala.html#spire.math.SafeLong.apply(88efbd6bde)" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFirst.p" title="=&gt; Long">p</a><span class="delimiter">)</span>, <a href="../SafeLong.scala.html#spire.math.SafeLong.apply(88efbd6bde)" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initFirst.m" title="Long">m</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <a href="#spire.math.prime;SieveSegment.initFirst.p" title="Int">p</a> <span title="(x: Int)Int">+=</span> <span title="Int(2)" class="int">2</span>
    <span class="delimiter">}</span>
    <a href="#spire.math.prime;SieveSegment.initFirst.fastq" title="spire.math.prime.SieveUtil.FastFactors">fastq</a>.<a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;FastFactors.arr_=" title="(x$1: Array[spire.math.prime.SieveUtil.FastFactor])Unit">arr</a> = <a href="#spire.math.prime;SieveSegment.initFirst.buf" title="scala.collection.mutable.ArrayBuffer[spire.math.prime.SieveUtil.FastFactor]">buf</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[spire.math.prime.SieveUtil.FastFactor])Array[spire.math.prime.SieveUtil.FastFactor]">toArray</span>
  <span class="delimiter">}</span>

  def <a title="(slowq: spire.math.prime.FactorHeap)Unit" id="spire.math.prime;SieveSegment.initRest">initRest</a><span class="delimiter">(</span><a title="spire.math.prime.FactorHeap" id="spire.math.prime;SieveSegment.initRest.slowq">slowq</a>: <a href="FactorHeap.scala.html#spire.math.prime;FactorHeap" title="spire.math.prime.FactorHeap">FactorHeap</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <span title="(that: spire.math.SafeLong)Boolean">&gt;=</span> <a href="#spire.math.prime;SieveSegment.copy$default$3" title="=&gt; spire.math.SafeLong">cutoff</a><span class="delimiter">)</span> return <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>

    val <a title="Long" id="spire.math.prime;SieveSegment.initRest.len">len</a>: <span title="Long">Long</span> = if <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.+(8cf326fedb)" title="(rhs: Long)spire.math.SafeLong">+</a> <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.length" title="=&gt; Long">length</a> <span title="(that: spire.math.SafeLong)Boolean">&gt;=</span> <a href="#spire.math.prime;SieveSegment.copy$default$3" title="=&gt; spire.math.SafeLong">cutoff</a><span class="delimiter">)</span>
      <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.copy$default$3" title="=&gt; spire.math.SafeLong">cutoff</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.-(a361d50555)" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span>
    else
      <a href="#spire.math.prime;SieveSegment.copy$default$2" title="=&gt; spire.math.prime.BitSet">primes</a>.<a href="BitSet.scala.html#spire.math.prime;BitSet.length" title="=&gt; Long">length</a>

    var <a title="Int" id="spire.math.prime;SieveSegment.initRest.i">i</a> = <span title="Int(1)" class="int">1</span>
    while <span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initRest.i" title="Int">i</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#spire.math.prime;SieveSegment.initRest.len" title="Long">len</a><span class="delimiter">)</span> <a href="#spire.math.prime;SieveSegment.initRest.while$7" title="()Unit" class="delimiter">{</a>
      if <span class="delimiter">(</span><a href="BitSet.scala.html#spire.math.prime;BitSet.apply" title="(n: Int)Boolean">primes</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initRest.i" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        val p: <a href="../SafeLong.scala.html#spire.math;SafeLong" title="spire.math.SafeLong">SafeLong</a> = <a href="#spire.math.prime;SieveSegment.copy$default$1" title="=&gt; spire.math.SafeLong">start</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.+(8cf326fedb)" title="spire.math.SafeLong" id="spire.math.prime;SieveSegment.initRest.p">+</a> <a href="#spire.math.prime;SieveSegment.initRest.i" title="=&gt; Long">i</a>
        <a href="#spire.math.prime;SieveSegment.initRest.slowq" title="spire.math.prime.FactorHeap">slowq</a> <a href="FactorHeap.scala.html#spire.math.prime;FactorHeap.+=" title="(factor: spire.math.prime.SieveUtil.Factor)Unit">+=</a> <a href="SieveUtil.scala.html#spire.math.prime.SieveUtil;Factor" title="(p: spire.math.SafeLong, next: spire.math.SafeLong)spire.math.prime.SieveUtil.Factor">Factor</a><span class="delimiter">(</span><a href="#spire.math.prime;SieveSegment.initRest.p" title="spire.math.SafeLong">p</a>, <a href="#spire.math.prime;SieveSegment.initRest.p" title="spire.math.SafeLong">p</a> <a href="../SafeLong.scala.html#spire.math;SafeLong.**" title="(rhs: Int)spire.math.SafeLong">**</a> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#spire.math.prime;SieveSegment.initRest.i" title="Int">i</a> <span title="(x: Int)Int">+=</span> <span title="Int(2)" class="int">2</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

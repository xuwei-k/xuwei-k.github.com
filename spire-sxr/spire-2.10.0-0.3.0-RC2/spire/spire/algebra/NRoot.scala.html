<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>spire/spire/algebra/NRoot.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> spire.algebra

<span class="keyword">import</span> spire.math._
<span class="keyword">import</span> spire.macrosk.Ops

<span class="keyword">import</span> scala.<span class="delimiter">{</span>specialized =&gt; spec, math =&gt; mth<span class="delimiter">}</span>
<span class="keyword">import</span> java.math.MathContext
<span class="keyword">import</span> java.lang.Math

// NOTE: fpow vs pow is a bit of a trainwreck :P
// overloading is evil, but it's definitely what users will expect.

/**
 * This is a type class for types with n-roots. The value returned by `nroot`
 * and `sqrt` are only guaranteed to be approximate answers (except in the case
 * of `Real`).
 *
 * Also, generally `nroot`s where `n` is even are not defined for
 * negative numbers. The behaviour is undefined if this is attempted. It would
 * be nice to ensure an exception is raised, but some types may defer
 * computation and testing if a value is negative may not be ideal. So, do not
 * count on `ArithmeticException`s to save you from bad arithmetic!
 */
<span class="keyword">trait</span> <a title="trait NRoot[A] extends Object" id="10586">NRoot</a><span class="delimiter">[</span>@spec<span class="delimiter">(</span>Double,Float,Int,Long<span class="delimiter">)</span> <a title="" id="11960">A</a><span class="delimiter">]</span> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(a: A, n: Int)A" id="32059">nroot</a><span class="delimiter">(</span><a title="A" id="95071">a</a>: <a href="#11960" title="A">A</a>, <a title="Int" id="95072">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#11960" title="A">A</a>
  <span class="keyword">def</span> <a title="(a: A)A" id="32060">sqrt</a><span class="delimiter">(</span><a title="A" id="91439">a</a>: <a href="#11960" title="A">A</a><span class="delimiter">)</span>: <a href="#11960" title="A">A</a> = <a href="#32059" title="(a: A, n: Int)A">nroot</a><span class="delimiter">(</span><a href="#91439" title="A">a</a>, <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(a: A)A" id="32061">log</a><span class="delimiter">(</span><a title="A" id="95073">a</a>:<a href="#11960" title="A">A</a><span class="delimiter">)</span>:<a href="#11960" title="A">A</a>
  <span class="keyword">def</span> <a title="(a: A, b: A)A" id="32062">fpow</a><span class="delimiter">(</span><a title="A" id="95074">a</a>:<a href="#11960" title="A">A</a>, <a title="A" id="95075">b</a>:<a href="#11960" title="A">A</a><span class="delimiter">)</span>: <a href="#11960" title="A">A</a>
<span class="delimiter">}</span>

<span title="Object" class="keyword">import</span> spire.math.<span class="delimiter">{</span>ConvertableTo, ConvertableFrom, Number<span class="delimiter">}</span>

<span class="keyword">final</span> <span class="keyword">class</span> <a title="class NRootOps[A] extends Object" id="9302">NRootOps</a><span class="delimiter">[</span><a title="" id="11962">A</a><span class="delimiter">]</span><a href="#9302" title="spire.algebra.NRootOps[A]" class="delimiter">(</a><a title="A" id="32050">lhs</a>: <a href="#11962" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="spire.algebra.NRoot[A]" id="32051">ev</a>: <a href="#10586" title="spire.algebra.NRoot[A]">NRoot</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(rhs: Int)A" id="32041">nroot</a><span class="delimiter">(</span><a title="Int" id="95079">rhs</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#11962" title="A">A</a> = macro <a href="../macros/Ops.scala.html#12191" title="spire.macrosk.Ops.type">Ops</a>.<a href="../macros/Ops.scala.html#40155" title="[A, R](c: scala.reflect.macros.Context)(rhs: c.Expr[A])c.Expr[R]">binop</a><span title="(c: scala.reflect.macros.Context)(rhs: c.Expr[Int])c.Expr[A]" class="delimiter">[</span><span title="Int">Int</span>, <a href="#11962" title="A">A</a><span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="()A" id="32042">sqrt</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#11962" title="A">A</a> = macro <a href="../macros/Ops.scala.html#12191" title="spire.macrosk.Ops.type">Ops</a>.<a href="../macros/Ops.scala.html#40142" title="[R](c: scala.reflect.macros.Context)()c.Expr[R]">unop</a><span title="(c: scala.reflect.macros.Context)()c.Expr[A]" class="delimiter">[</span><a href="#11962" title="A">A</a><span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="()A" id="32043">log</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#11962" title="A">A</a> = macro <a href="../macros/Ops.scala.html#12191" title="spire.macrosk.Ops.type">Ops</a>.<a href="../macros/Ops.scala.html#40142" title="[R](c: scala.reflect.macros.Context)()c.Expr[R]">unop</a><span title="(c: scala.reflect.macros.Context)()c.Expr[A]" class="delimiter">[</span><a href="#11962" title="A">A</a><span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="(rhs: A)A" id="32044">fpow</a><span class="delimiter">(</span><a title="A" id="95085">rhs</a>: <a href="#11962" title="A">A</a><span class="delimiter">)</span>: <a href="#11962" title="A">A</a> = macro <a href="../macros/Ops.scala.html#12191" title="spire.macrosk.Ops.type">Ops</a>.<a href="../macros/Ops.scala.html#40155" title="[A, R](c: scala.reflect.macros.Context)(rhs: c.Expr[A])c.Expr[R]">binop</a><span title="(c: scala.reflect.macros.Context)(rhs: c.Expr[A])c.Expr[A]" class="delimiter">[</span><a href="#11962" title="A">A</a>, <a href="#11962" title="A">A</a><span class="delimiter">]</span>

  // TODO: should be macros
  <span class="keyword">def</span> <a title="(rhs: Double)(implicit c: spire.math.ConvertableTo[A])A" id="32045">pow</a><span class="delimiter">(</span><a title="Double" id="95089">rhs</a>: <span title="Double">Double</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="spire.math.ConvertableTo[A]" id="95090">c</a>: <a href="../math/Convertable.scala.html#13124" title="spire.math.ConvertableTo[A]">ConvertableTo</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#32051" title="spire.algebra.NRoot[A]">ev</a>.<a href="#32062" title="(a: A, b: A)A">fpow</a><span class="delimiter">(</span><a href="#32050" title="A">lhs</a>, <a href="#95090" title="spire.math.ConvertableTo[A]">c</a>.<a href="../math/Convertable.scala.html#55863" title="(n: Double)A">fromDouble</a><span class="delimiter">(</span><a href="#95089" title="Double">rhs</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(rhs: Double)(implicit c: spire.math.ConvertableTo[A])A" id="32046">**</a><span class="delimiter">(</span><a title="Double" id="95093">rhs</a>: <span title="Double">Double</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="spire.math.ConvertableTo[A]" id="95094">c</a>: <a href="../math/Convertable.scala.html#13124" title="spire.math.ConvertableTo[A]">ConvertableTo</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#32051" title="spire.algebra.NRoot[A]">ev</a>.<a href="#32062" title="(a: A, b: A)A">fpow</a><span class="delimiter">(</span><a href="#32050" title="A">lhs</a>, <a href="#95094" title="spire.math.ConvertableTo[A]">c</a>.<a href="../math/Convertable.scala.html#55863" title="(n: Double)A">fromDouble</a><span class="delimiter">(</span><a href="#95093" title="Double">rhs</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(rhs: spire.math.Number)(implicit c: spire.math.ConvertableFrom[A])spire.math.Number" id="32047">pow</a><span class="delimiter">(</span><a title="spire.math.Number" id="95095">rhs</a>:<a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="spire.math.ConvertableFrom[A]" id="95096">c</a>:<a href="../math/Convertable.scala.html#15812" title="spire.math.ConvertableFrom[A]">ConvertableFrom</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a> = <a href="#95096" title="spire.math.ConvertableFrom[A]">c</a>.<a href="../math/Convertable.scala.html#38906" title="(a: A)spire.math.Number">toNumber</a><span class="delimiter">(</span><a href="#32050" title="A">lhs</a><span class="delimiter">)</span> <a href="../math/Number.scala.html#48412" title="(rhs: spire.math.Number)spire.math.Number">pow</a> <a href="#95095" title="spire.math.Number">rhs</a>
  <span class="keyword">def</span> <a title="(rhs: spire.math.Number)(implicit c: spire.math.ConvertableFrom[A])spire.math.Number" id="32048">**</a><span class="delimiter">(</span><a title="spire.math.Number" id="95100">rhs</a>:<a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="spire.math.ConvertableFrom[A]" id="95101">c</a>:<a href="../math/Convertable.scala.html#15812" title="spire.math.ConvertableFrom[A]">ConvertableFrom</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a> = <a href="#95101" title="spire.math.ConvertableFrom[A]">c</a>.<a href="../math/Convertable.scala.html#38906" title="(a: A)spire.math.Number">toNumber</a><span class="delimiter">(</span><a href="#32050" title="A">lhs</a><span class="delimiter">)</span> <a href="../math/Number.scala.html#48413" title="(rhs: spire.math.Number)spire.math.Number">**</a> <a href="#95100" title="spire.math.Number">rhs</a>
<span class="delimiter">}</span>

<span title="Object" class="keyword">trait</span> <a title="trait DoubleIsNRoot extends Object with spire.algebra.NRoot[Double]" id="10877">DoubleIsNRoot</a> <span title="Unit" class="keyword">extends</span> <a href="#10586" title="spire.algebra.NRoot[Double]">NRoot</a><span class="delimiter">[</span>Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(a: Double, k: Int)Double" id="91687">nroot</a><span class="delimiter">(</span><a title="Double" id="95108">a</a>: <span title="Double">Double</span>, <a title="Int" id="95109">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Double">Double</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double, x$2: Double)Double">pow</span><span class="delimiter">(</span><a href="#95108" title="Double">a</a>, <span title="Int(1)" class="int">1</span> <span title="(x: Double)Double">/</span> <a href="#95109" title="Int">k</a>.<span title="=&gt; Double">toDouble</span><span class="delimiter">)</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(a: Double)Double" id="91688">sqrt</a><span class="delimiter">(</span><a title="Double" id="95117">a</a>: <span title="Double">Double</span><span class="delimiter">)</span>: <span title="Double">Double</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double)Double">sqrt</span><span class="delimiter">(</span><a href="#95117" title="Double">a</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(a: Double)Double" id="91689">log</a><span class="delimiter">(</span><a title="Double" id="95120">a</a>: <span title="Double">Double</span><span class="delimiter">)</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double)Double">log</span><span class="delimiter">(</span><a href="#95120" title="Double">a</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(a: Double, b: Double)Double" id="91690">fpow</a><span class="delimiter">(</span><a title="Double" id="95124">a</a>: <span title="Double">Double</span>, <a title="Double" id="95125">b</a>: <span title="Double">Double</span><span class="delimiter">)</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double, x$2: Double)Double">pow</span><span class="delimiter">(</span><a href="#95124" title="Double">a</a>, <a href="#95125" title="Double">b</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait FloatIsNRoot extends Object with spire.algebra.NRoot[Float]" id="10502">FloatIsNRoot</a> <span title="Unit" class="keyword">extends</span> <a href="#10586" title="spire.algebra.NRoot[Float]">NRoot</a><span class="delimiter">[</span>Float<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(a: Float, k: Int)Float" id="91695">nroot</a><span class="delimiter">(</span><a title="Float" id="95132">a</a>: <span title="Float">Float</span>, <a title="Int" id="95133">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Float">Float</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double, x$2: Double)Double">pow</span><span class="delimiter">(</span><a href="#95132" title="=&gt; Double">a</a>, <span title="Int(1)" class="int">1</span> <span title="(x: Double)Double">/</span> <a href="#95133" title="Int">k</a>.<span title="=&gt; Double">toDouble</span><span class="delimiter">)</span>.<span title="=&gt; Float">toFloat</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(a: Float)Float" id="91696">sqrt</a><span class="delimiter">(</span><a title="Float" id="95141">a</a>: <span title="Float">Float</span><span class="delimiter">)</span>: <span title="Float">Float</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double)Double">sqrt</span><span class="delimiter">(</span><a href="#95141" title="=&gt; Double">a</a><span class="delimiter">)</span>.<span title="=&gt; Float">toFloat</span>
  <span class="keyword">def</span> <a title="(a: Float)Float" id="91697">log</a><span class="delimiter">(</span><a title="Float" id="95144">a</a>: <span title="Float">Float</span><span class="delimiter">)</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double)Double">log</span><span class="delimiter">(</span><a href="#95144" title="=&gt; Double">a</a><span class="delimiter">)</span>.<span title="=&gt; Float">toFloat</span>
  <span class="keyword">def</span> <a title="(a: Float, b: Float)Float" id="91698">fpow</a><span class="delimiter">(</span><a title="Float" id="95148">a</a>: <span title="Float">Float</span>, <a title="Float" id="95149">b</a>: <span title="Float">Float</span><span class="delimiter">)</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double, x$2: Double)Double">pow</span><span class="delimiter">(</span><a href="#95148" title="=&gt; Double">a</a>, <a href="#95149" title="=&gt; Double">b</a><span class="delimiter">)</span>.<span title="=&gt; Float">toFloat</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait RationalIsNRoot extends Object with spire.algebra.NRoot[spire.math.Rational]" id="8126">RationalIsNRoot</a> <span title="Unit" class="keyword">extends</span> <a href="#10586" title="spire.algebra.NRoot[spire.math.Rational]">NRoot</a><span class="delimiter">[</span>Rational<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; spire.math.ApproximationContext[spire.math.Rational]" id="91652">context</a>:<a href="../math/ApproximationContext.scala.html#12227" title="spire.math.ApproximationContext[spire.math.Rational]">ApproximationContext</a><span class="delimiter">[</span>Rational<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="(a: spire.math.Rational, k: Int)spire.math.Rational" id="91653">nroot</a><span class="delimiter">(</span><a title="spire.math.Rational" id="95156">a</a>: <a href="../math/Rational.scala.html#15737" title="spire.math.Rational">Rational</a>, <a title="Int" id="95157">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="../math/Rational.scala.html#15737" title="spire.math.Rational">Rational</a> = <a href="#95156" title="spire.math.Rational">a</a>.<a href="../math/Rational.scala.html#58180" title="(k: Int)(implicit ctxt: spire.math.ApproximationContext[spire.math.Rational])spire.math.Rational">nroot</a><a href="#91652" title="=&gt; spire.math.ApproximationContext[spire.math.Rational]" class="delimiter">(</a><a href="#95157" title="Int">k</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(a: spire.math.Rational)spire.math.Rational" id="91654">log</a><span class="delimiter">(</span><a title="spire.math.Rational" id="95164">a</a>: <a href="../math/Rational.scala.html#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="../math/Rational.scala.html#15737" title="spire.math.Rational">Rational</a> = <a href="#95164" title="spire.math.Rational">a</a>.<a href="../math/Rational.scala.html#58178" title="()spire.math.Rational">log</a>
  <span class="keyword">def</span> <a title="(a: spire.math.Rational, b: spire.math.Rational)spire.math.Rational" id="91655">fpow</a><span class="delimiter">(</span><a title="spire.math.Rational" id="95168">a</a>: <a href="../math/Rational.scala.html#15737" title="spire.math.Rational">Rational</a>, <a title="spire.math.Rational" id="95169">b</a>: <a href="../math/Rational.scala.html#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="../math/Rational.scala.html#15737" title="spire.math.Rational">Rational</a> = <a href="#95168" title="spire.math.Rational">a</a>.<a href="../math/Rational.scala.html#58179" title="(exp: spire.math.Rational)(implicit ctxt: spire.math.ApproximationContext[spire.math.Rational])spire.math.Rational">pow</a><a href="#91652" title="=&gt; spire.math.ApproximationContext[spire.math.Rational]" class="delimiter">(</a><a href="#95169" title="spire.math.Rational">b</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait RealIsNRoot extends Object with spire.algebra.NRoot[spire.math.Real]" id="10802">RealIsNRoot</a> <span title="Unit" class="keyword">extends</span> <a href="#10586" title="spire.algebra.NRoot[spire.math.Real]">NRoot</a><span class="delimiter">[</span>Real<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(a: spire.math.Real, k: Int)spire.math.Real" id="91640">nroot</a><span class="delimiter">(</span><a title="spire.math.Real" id="95184">a</a>: <a href="../math/Real.scala.html#12446" title="spire.math.Real">Real</a>, <a title="Int" id="95185">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="../math/Real.scala.html#12446" title="spire.math.Real">Real</a> = <a href="#95184" title="spire.math.Real">a</a> <a href="../math/real/RealTransform.scala.html#58140" title="(k: Int)spire.math.Real">nroot</a> <a href="#95185" title="Int">k</a>
  <span class="keyword">def</span> <a title="(a: spire.math.Real)Nothing" id="91641">log</a><span class="delimiter">(</span><a title="spire.math.Real" id="95192">a</a>:<a href="../math/Real.scala.html#12446" title="spire.math.Real">Real</a><span class="delimiter">)</span> = sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;fixme&quot;)" class="string">&quot;fixme&quot;</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(a: spire.math.Real, b: spire.math.Real)Nothing" id="91642">fpow</a><span class="delimiter">(</span><a title="spire.math.Real" id="95309">a</a>:<a href="../math/Real.scala.html#12446" title="spire.math.Real">Real</a>, <a title="spire.math.Real" id="95310">b</a>:<a href="../math/Real.scala.html#12446" title="spire.math.Real">Real</a><span class="delimiter">)</span> = sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;fixme&quot;)" class="string">&quot;fixme&quot;</span><span class="delimiter">)</span>
<span class="delimiter">}</span>


<span class="keyword">trait</span> <a title="trait BigDecimalIsNRoot extends Object with spire.algebra.NRoot[BigDecimal]" id="8138">BigDecimalIsNRoot</a> <span title="Unit" class="keyword">extends</span> <a href="#10586" title="spire.algebra.NRoot[BigDecimal]">NRoot</a><span class="delimiter">[</span>BigDecimal<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(a: BigDecimal, k: Int)BigDecimal" id="91680">nroot</a><span class="delimiter">(</span><a title="BigDecimal" id="95317">a</a>: <span title="BigDecimal">BigDecimal</span>, <a title="Int" id="95318">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="BigDecimal">BigDecimal</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#95317" title="BigDecimal">a</a>.<span title="=&gt; java.math.MathContext">mc</span>.<span title="()Int">getPrecision</span> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)ArithmeticException" class="keyword">new</span> <span title="ArithmeticException">ArithmeticException</span><span class="delimiter">(</span><span title="String(&quot;Cannot find the nroot of a BigDecimal with unlimited precision.&quot;)" class="string">&quot;Cannot find the nroot of a BigDecimal with unlimited precision.&quot;</span><span class="delimiter">)</span>
    <a href="#10587" title="spire.algebra.NRoot.type">NRoot</a>.<a href="#55705" title="(a: BigDecimal, k: Int, ctxt: java.math.MathContext)BigDecimal">nroot</a><span class="delimiter">(</span><a href="#95317" title="BigDecimal">a</a>, <a href="#95318" title="Int">k</a>, <a href="#95317" title="BigDecimal">a</a>.<span title="=&gt; java.math.MathContext">mc</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(a: BigDecimal)BigDecimal" id="91681">log</a><span class="delimiter">(</span><a title="BigDecimal" id="95348">a</a>:<span title="BigDecimal">BigDecimal</span><span class="delimiter">)</span> = spire.math.<a href="../package.scala.html#16994" title="(n: BigDecimal)BigDecimal">log</a><span class="delimiter">(</span><a href="#95348" title="BigDecimal">a</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(a: BigDecimal, b: BigDecimal)scala.math.BigDecimal" id="91682">fpow</a><span class="delimiter">(</span><a title="BigDecimal" id="95358">a</a>:<span title="BigDecimal">BigDecimal</span>, <a title="BigDecimal" id="95359">b</a>:<span title="BigDecimal">BigDecimal</span><span class="delimiter">)</span> = spire.math.<a href="../package.scala.html#17003" title="(base: BigDecimal, ex: BigDecimal)scala.math.BigDecimal">pow</a><span class="delimiter">(</span><a href="#95358" title="BigDecimal">a</a>, <a href="#95359" title="BigDecimal">b</a><span class="delimiter">)</span>
<span class="delimiter">}</span>


<span class="keyword">trait</span> <a title="trait IntIsNRoot extends Object with spire.algebra.NRoot[Int]" id="9197">IntIsNRoot</a> <span title="Unit" class="keyword">extends</span> <a href="#10586" title="spire.algebra.NRoot[Int]">NRoot</a><span class="delimiter">[</span>Int<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(x: Int, n: Int)Int" id="91839">nroot</a><span class="delimiter">(</span><a title="Int" id="95406">x</a>: <span title="Int">Int</span>, <a title="Int" id="95407">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(prev: Int, add: Int)Int" id="95411">findnroot</a><span class="delimiter">(</span><a title="Int" id="95412">prev</a>: <span title="Int">Int</span>, <a title="Int" id="95413">add</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="95414">next</a> = <a href="#95412" title="Int">prev</a> <span title="(x: Int)Int">|</span> <a href="#95413" title="Int">add</a>
      <span class="keyword">val</span> <a title="Double" id="95415">e</a> = <span title="Math.type">Math</span>.<span title="(x$1: Double, x$2: Double)Double">pow</span><span class="delimiter">(</span><a href="#95414" title="=&gt; Double">next</a>, <a href="#95407" title="=&gt; Double">n</a><span class="delimiter">)</span>

      <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#95415" title="Double">e</a> <span title="(x: Int)Boolean">==</span> <a href="#95406" title="Int">x</a> <span title="(x: Boolean)Boolean">||</span> <a href="#95413" title="Int">add</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#95414" title="Int">next</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#95415" title="Double">e</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">||</span> <a href="#95415" title="Double">e</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#95406" title="Int">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#95411" title="(prev: Int, add: Int)Int">findnroot</a><span class="delimiter">(</span><a href="#95412" title="Int">prev</a>, <a href="#95413" title="Int">add</a> <span title="(x: Int)Int">&gt;&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#95411" title="(prev: Int, add: Int)Int">findnroot</a><span class="delimiter">(</span><a href="#95414" title="Int">next</a>, <a href="#95413" title="Int">add</a> <span title="(x: Int)Int">&gt;&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <a href="#95411" title="(prev: Int, add: Int)Int">findnroot</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Int(1)" class="int">1</span> <span title="(x: Int)Int">&lt;&lt;</span> <span class="delimiter">(</span><span class="delimiter">(</span><span title="Int(33)" class="int">33</span> <span title="(x: Int)Int">-</span> <a href="#95407" title="Int">n</a><span class="delimiter">)</span> <span title="(x: Int)Int">/</span> <a href="#95407" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(a: Int)Int" id="91840">log</a><span class="delimiter">(</span><a title="Int" id="95456">a</a>:<span title="Int">Int</span><span class="delimiter">)</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double)Double">log</span><span class="delimiter">(</span><a href="#95456" title="Int">a</a>.<span title="=&gt; Double">toDouble</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>
  <span class="keyword">def</span> <a title="(a: Int, b: Int)Int" id="91841">fpow</a><span class="delimiter">(</span><a title="Int" id="95460">a</a>:<span title="Int">Int</span>, <a title="Int" id="95461">b</a>:<span title="Int">Int</span><span class="delimiter">)</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double, x$2: Double)Double">pow</span><span class="delimiter">(</span><a href="#95460" title="=&gt; Double">a</a>, <a href="#95461" title="=&gt; Double">b</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait LongIsNRoot extends Object with spire.algebra.NRoot[Long]" id="9590">LongIsNRoot</a> <span title="Unit" class="keyword">extends</span> <a href="#10586" title="spire.algebra.NRoot[Long]">NRoot</a><span class="delimiter">[</span>Long<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(x: Long, n: Int)Long" id="91834">nroot</a><span class="delimiter">(</span><a title="Long" id="95468">x</a>: <span title="Long">Long</span>, <a title="Int" id="95469">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Long">Long</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(prev: Long, add: Long)Long" id="95473">findnroot</a><span class="delimiter">(</span><a title="Long" id="95474">prev</a>: <span title="Long">Long</span>, <a title="Long" id="95475">add</a>: <span title="Long">Long</span><span class="delimiter">)</span>: <span title="Long">Long</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Long" id="95476">next</a> = <a href="#95474" title="Long">prev</a> <span title="(x: Long)Long">|</span> <a href="#95475" title="Long">add</a>
      <span class="keyword">val</span> <a title="Double" id="95477">e</a> = <span title="Math.type">Math</span>.<span title="(x$1: Double, x$2: Double)Double">pow</span><span class="delimiter">(</span><a href="#95476" title="=&gt; Double">next</a>, <a href="#95469" title="=&gt; Double">n</a><span class="delimiter">)</span>

      <span title="Long" class="keyword">if</span> <span class="delimiter">(</span><a href="#95477" title="Double">e</a> <span title="(x: Long)Boolean">==</span> <a href="#95468" title="Long">x</a> <span title="(x: Boolean)Boolean">||</span> <a href="#95475" title="Long">add</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#95476" title="Long">next</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Long" class="keyword">if</span> <span class="delimiter">(</span><a href="#95477" title="Double">e</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">||</span> <a href="#95477" title="Double">e</a> <span title="(x: Long)Boolean">&gt;</span> <a href="#95468" title="Long">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#95473" title="(prev: Long, add: Long)Long">findnroot</a><span class="delimiter">(</span><a href="#95474" title="Long">prev</a>, <a href="#95475" title="Long">add</a> <span title="(x: Int)Long">&gt;&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#95473" title="(prev: Long, add: Long)Long">findnroot</a><span class="delimiter">(</span><a href="#95476" title="Long">next</a>, <a href="#95475" title="Long">add</a> <span title="(x: Int)Long">&gt;&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <a href="#95473" title="(prev: Long, add: Long)Long">findnroot</a><span class="delimiter">(</span><span title="Long(0L)" class="int">0</span>, <span title="Long(1L)" class="long">1L</span> <span title="(x: Int)Long">&lt;&lt;</span> <span class="delimiter">(</span><span class="delimiter">(</span><span title="Int(65)" class="int">65</span> <span title="(x: Int)Int">-</span> <a href="#95469" title="Int">n</a><span class="delimiter">)</span> <span title="(x: Int)Int">/</span> <a href="#95469" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(a: Long)Long" id="91835">log</a><span class="delimiter">(</span><a title="Long" id="95518">a</a>:<span title="Long">Long</span><span class="delimiter">)</span> = <span title="Math.type">Math</span>.<span title="(x$1: Double)Double">log</span><span class="delimiter">(</span><a href="#95518" title="Long">a</a>.<span title="=&gt; Double">toDouble</span><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span>
  <span class="keyword">def</span> <a title="(a: Long, b: Long)Long" id="91836">fpow</a><span class="delimiter">(</span><a title="Long" id="95522">a</a>:<span title="Long">Long</span>, <a title="Long" id="95523">b</a>:<span title="Long">Long</span><span class="delimiter">)</span> = spire.math.<a href="../package.scala.html#17004" title="(base: Long, ex: Long)Long">pow</a><span class="delimiter">(</span><a href="#95522" title="Long">a</a>, <a href="#95523" title="Long">b</a><span class="delimiter">)</span> // xyz
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait BigIntIsNRoot extends Object with spire.algebra.NRoot[BigInt]" id="9320">BigIntIsNRoot</a> <span title="Unit" class="keyword">extends</span> <a href="#10586" title="spire.algebra.NRoot[BigInt]">NRoot</a><span class="delimiter">[</span>BigInt<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(a: BigInt, k: Int)BigInt" id="91829">nroot</a><span class="delimiter">(</span><a title="BigInt" id="95532">a</a>: <span title="BigInt">BigInt</span>, <a title="Int" id="95533">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="BigInt">BigInt</span> = <span title="scala.math.BigInt" class="keyword">if</span> <span class="delimiter">(</span><a href="#95532" title="BigInt">a</a> <span title="(that: scala.math.BigInt)Boolean">&lt;</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#95533" title="Int">k</a> <span title="(x: Int)Int">%</span> <span title="Int(2)" class="int">2</span> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="=&gt; scala.math.BigInt">-</span><a href="#91829" title="(a: BigInt, k: Int)BigInt">nroot</a><span class="delimiter">(</span><span title="=&gt; scala.math.BigInt">-</span><a href="#95532" title="BigInt">a</a>, <a href="#95533" title="Int">k</a><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span title="BigInt" class="keyword">if</span> <span class="delimiter">(</span><a href="#95532" title="BigInt">a</a> <span title="(that: scala.math.BigInt)Boolean">&lt;</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)ArithmeticException" class="keyword">new</span> <span title="ArithmeticException">ArithmeticException</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Cannot find %d-root of negative number.&quot;</span> <span title="(args: Any*)String">format</span> <a href="#95533" title="Int">k</a><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(b: BigInt, i: Int)BigInt" id="95553">findNroot</a><span class="delimiter">(</span><a title="BigInt" id="95554">b</a>: <span title="BigInt">BigInt</span>, <a title="Int" id="95555">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="BigInt">BigInt</span> = <span title="BigInt" class="keyword">if</span> <span class="delimiter">(</span><a href="#95555" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#95554" title="BigInt">b</a>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="95560">c</a> = <a href="#95554" title="BigInt">b</a> <span title="(n: Int)scala.math.BigInt">setBit</span> <a href="#95555" title="Int">i</a>

      <span title="BigInt" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#95560" title="scala.math.BigInt">c</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#95533" title="Int">k</a><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)Boolean">&lt;=</span> <a href="#95532" title="BigInt">a</a><span class="delimiter">)</span>
        <a href="#95553" title="(b: BigInt, i: Int)BigInt">findNroot</a><span class="delimiter">(</span><a href="#95560" title="scala.math.BigInt">c</a>, <a href="#95555" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="keyword">else</span>
        <a href="#95553" title="(b: BigInt, i: Int)BigInt">findNroot</a><span class="delimiter">(</span><a href="#95554" title="BigInt">b</a>, <a href="#95555" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="#95553" title="(b: BigInt, i: Int)BigInt">findNroot</a><span class="delimiter">(</span><span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">0</span>, <a href="#95532" title="BigInt">a</a>.<span title="=&gt; Int">bitLength</span> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(a: BigInt)scala.math.BigInt" id="91830">log</a><span class="delimiter">(</span><a title="BigInt" id="95573">a</a>:<span title="BigInt">BigInt</span><span class="delimiter">)</span> = spire.math.<a href="../package.scala.html#16994" title="(n: BigDecimal)BigDecimal">log</a><span class="delimiter">(</span><span title="(x: scala.math.BigInt)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><a href="#95573" title="BigInt">a</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="()scala.math.BigInt">toBigInt</span>
  <span class="keyword">def</span> <a title="(a: BigInt, b: BigInt)scala.math.BigInt" id="91831">fpow</a><span class="delimiter">(</span><a title="BigInt" id="95589">a</a>:<span title="BigInt">BigInt</span>, <a title="BigInt" id="95590">b</a>:<span title="BigInt">BigInt</span><span class="delimiter">)</span> = spire.math.<a href="../package.scala.html#17003" title="(base: BigDecimal, ex: BigDecimal)scala.math.BigDecimal">pow</a><span class="delimiter">(</span><span title="(x: scala.math.BigInt)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><a href="#95589" title="BigInt">a</a><span class="delimiter">)</span>, <span title="(x: scala.math.BigInt)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><a href="#95590" title="BigInt">b</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="()scala.math.BigInt">toBigInt</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait SafeLongIsNRoot extends Object with spire.algebra.NRoot[spire.math.SafeLong]" id="8801">SafeLongIsNRoot</a> <span title="Unit" class="keyword">extends</span> <a href="#10586" title="spire.algebra.NRoot[spire.math.SafeLong]">NRoot</a><span class="delimiter">[</span>SafeLong<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#10587" title="spire.algebra.NRoot.type">NRoot</a>.<span class="delimiter">{</span>LongIsNRoot, BigIntIsNRoot<span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(a: spire.math.SafeLong, k: Int)spire.math.SafeLong" id="91824">nroot</a><span class="delimiter">(</span><a title="spire.math.SafeLong" id="95617">a</a>: <a href="../math/SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a>, <a title="Int" id="95618">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="../math/SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a> = <a href="#95617" title="spire.math.SafeLong">a</a>.<a href="../math/SafeLong.scala.html#49272" title="(f: Long =&gt; spire.math.SafeLong, g: BigInt =&gt; spire.math.SafeLong)spire.math.SafeLong">fold</a><span class="delimiter">(</span>
    <a title="Long" id="95633">n</a> =&gt; <a href="../math/SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#55682" title="spire.algebra.NRoot.LongIsNRoot.type">LongIsNRoot</a>.<a href="#91834" title="(x: Long, n: Int)Long">nroot</a><span class="delimiter">(</span><a href="#95633" title="Long">n</a>, <a href="#95618" title="Int">k</a><span class="delimiter">)</span><span class="delimiter">)</span>,
    <a title="BigInt" id="95645">n</a> =&gt; <a href="../math/SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#55684" title="spire.algebra.NRoot.BigIntIsNRoot.type">BigIntIsNRoot</a>.<a href="#91829" title="(a: BigInt, k: Int)BigInt">nroot</a><span class="delimiter">(</span><a href="#95645" title="BigInt">n</a>, <a href="#95618" title="Int">k</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(a: spire.math.SafeLong)spire.math.SafeLong" id="91825">log</a><span class="delimiter">(</span><a title="spire.math.SafeLong" id="95658">a</a>:<a href="../math/SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a><span class="delimiter">)</span> = <a href="#95658" title="spire.math.SafeLong">a</a>.<a href="../math/SafeLong.scala.html#49272" title="(f: Long =&gt; spire.math.SafeLong, g: BigInt =&gt; spire.math.SafeLong)spire.math.SafeLong">fold</a><span class="delimiter">(</span>
    <a title="Long" id="95668">n</a> =&gt; <a href="../math/SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#55682" title="spire.algebra.NRoot.LongIsNRoot.type">LongIsNRoot</a>.<a href="#91835" title="(a: Long)Long">log</a><span class="delimiter">(</span><a href="#95668" title="Long">n</a><span class="delimiter">)</span><span class="delimiter">)</span>,
    <a title="BigInt" id="95679">n</a> =&gt; <a href="../math/SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#55684" title="spire.algebra.NRoot.BigIntIsNRoot.type">BigIntIsNRoot</a>.<a href="#91830" title="(a: BigInt)scala.math.BigInt">log</a><span class="delimiter">(</span><a href="#95679" title="BigInt">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(a: spire.math.SafeLong, b: spire.math.SafeLong)spire.math.SafeLong" id="91826">fpow</a><span class="delimiter">(</span><a title="spire.math.SafeLong" id="95691">a</a>:<a href="../math/SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a>, <a title="spire.math.SafeLong" id="95692">b</a>:<a href="../math/SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a><span class="delimiter">)</span> =
    <a href="../math/SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#55684" title="spire.algebra.NRoot.BigIntIsNRoot.type">BigIntIsNRoot</a>.<a href="#91831" title="(a: BigInt, b: BigInt)scala.math.BigInt">fpow</a><span class="delimiter">(</span><a href="#95691" title="spire.math.SafeLong">a</a>.<a href="../math/SafeLong.scala.html#49268" title="=&gt; BigInt">toBigInt</a>, <a href="#95692" title="spire.math.SafeLong">b</a>.<a href="../math/SafeLong.scala.html#49268" title="=&gt; BigInt">toBigInt</a><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="spire.algebra.NRoot.type" id="10587">NRoot</a> <a href="#10588" title="spire.algebra.NRoot.type" class="delimiter">{</a>
  @inline <span class="keyword">final</span> <span class="keyword">def</span> <a title="[A](implicit ev: spire.algebra.NRoot[A])spire.algebra.NRoot[A]" id="55677">apply</a><span class="delimiter">[</span>@spec<span class="delimiter">(</span>Int,Long,Float,Double<span class="delimiter">)</span> <a title="" id="55679">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="spire.algebra.NRoot[A]" id="55706">ev</a>:<a href="#10586" title="spire.algebra.NRoot[A]">NRoot</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#55706" title="spire.algebra.NRoot[A]">ev</a>

  <span class="keyword">implicit</span> <span class="keyword">object</span> <a title="spire.algebra.NRoot.IntIsNRoot.type" id="55680">IntIsNRoot</a> <a href="#55681" title="spire.algebra.NRoot.IntIsNRoot.type" class="keyword">extends</a> <a href="#9197" title="spire.algebra.IntIsNRoot">IntIsNRoot</a>
  <span class="keyword">implicit</span> <span class="keyword">object</span> <a title="spire.algebra.NRoot.LongIsNRoot.type" id="55682">LongIsNRoot</a> <a href="#55683" title="spire.algebra.NRoot.LongIsNRoot.type" class="keyword">extends</a> <a href="#9590" title="spire.algebra.LongIsNRoot">LongIsNRoot</a>
  <span class="keyword">implicit</span> <span class="keyword">object</span> <a title="spire.algebra.NRoot.BigIntIsNRoot.type" id="55684">BigIntIsNRoot</a> <a href="#55685" title="spire.algebra.NRoot.BigIntIsNRoot.type" class="keyword">extends</a> <a href="#9320" title="spire.algebra.BigIntIsNRoot">BigIntIsNRoot</a>
  <span class="keyword">implicit</span> <span class="keyword">object</span> <a title="spire.algebra.NRoot.SafeLongIsNRoot.type" id="55686">SafeLongIsNRoot</a> <a href="#55687" title="spire.algebra.NRoot.SafeLongIsNRoot.type" class="keyword">extends</a> <a href="#8801" title="spire.algebra.SafeLongIsNRoot">SafeLongIsNRoot</a>

  <span class="keyword">implicit</span> <span class="keyword">object</span> <a title="spire.algebra.NRoot.FloatIsNRoot.type" id="55688">FloatIsNRoot</a> <a href="#55689" title="spire.algebra.NRoot.FloatIsNRoot.type" class="keyword">extends</a> <a href="#10502" title="spire.algebra.FloatIsNRoot">FloatIsNRoot</a>
  <span class="keyword">implicit</span> <span class="keyword">object</span> <a title="spire.algebra.NRoot.DoubleIsNRoot.type" id="55690">DoubleIsNRoot</a> <a href="#55691" title="spire.algebra.NRoot.DoubleIsNRoot.type" class="keyword">extends</a> <a href="#10877" title="spire.algebra.DoubleIsNRoot">DoubleIsNRoot</a>
  <span class="keyword">implicit</span> <span class="keyword">object</span> <a title="spire.algebra.NRoot.BigDecimalIsNRoot.type" id="55692">BigDecimalIsNRoot</a> <a href="#55693" title="spire.algebra.NRoot.BigDecimalIsNRoot.type" class="keyword">extends</a> <a href="#8138" title="spire.algebra.BigDecimalIsNRoot">BigDecimalIsNRoot</a>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit spire.algebra.NRoot.rationalIsNRoot : (implicit c: spire.math.ApproximationContext[spire.math.Rational])spire.algebra.RationalIsNRoot" id="55694">rationalIsNRoot</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="spire.math.ApproximationContext[spire.math.Rational]" id="91802">c</a>:<a href="../math/ApproximationContext.scala.html#12227" title="spire.math.ApproximationContext[spire.math.Rational]">ApproximationContext</a><span class="delimiter">[</span>Rational<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#91803" title="spire.algebra.RationalIsNRoot" class="keyword">new</a> <a title="anonymous class $anon extends Object with spire.algebra.RationalIsNRoot" id="91803">RationalIsNRoot</a> <span class="delimiter">{</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; spire.math.ApproximationContext[spire.math.Rational]" id="91805">context</a> = <a href="#91802" title="spire.math.ApproximationContext[spire.math.Rational]">c</a>
  <span class="delimiter">}</span>

  <span class="keyword">implicit</span> <span class="keyword">object</span> <a title="spire.algebra.NRoot.RealIsNRoot.type" id="55695">RealIsNRoot</a> <a href="#55696" title="spire.algebra.NRoot.RealIsNRoot.type" class="keyword">extends</a> <a href="#10802" title="spire.algebra.RealIsNRoot">RealIsNRoot</a>
  <span class="keyword">implicit</span> <span class="keyword">object</span> <a title="spire.algebra.NRoot.NumberIsNRoot.type" id="55697">NumberIsNRoot</a> <a href="#55698" title="spire.algebra.NRoot.NumberIsNRoot.type" class="keyword">extends</a> <a href="#7511" title="spire.algebra.NumberIsNRoot">NumberIsNRoot</a>

  /**
   * This will return the largest integer that meets some criteria. Specifically,
   * if we're looking for some integer `x` and `f(x')` is guaranteed to return
   * `true` iff `x' &lt;= x`, then this will return `x`.
   *
   * This can be used, for example, to find an integer `x` s.t. 
   * `x * x &lt; y &lt; (x+1)*(x+1)`, by using `intSearch(x =&gt; x * x &lt;= y)`.
   */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(f: Int =&gt; Boolean)Int" id="55699">intSearch</a><span class="delimiter">(</span><a title="Int =&gt; Boolean" id="95717">f</a>: Int =&gt; Boolean<span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="95718">ceil</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <span title="Int(32)" class="int">32</span><span class="delimiter">)</span> <span title="(p: Int =&gt; Boolean)Option[Int]">find</span> <span class="delimiter">(</span><a title="Int" id="96255">i</a> =&gt; <span title="=&gt; Boolean">!</span><a href="#95717" title="(v1: Int)Boolean">f</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span> <span title="(x: Int)Int">&lt;&lt;</span> <a href="#96255" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(default: =&gt; Int)Int">getOrElse</span> <span title="Int(33)" class="int">33</span>
    <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#95718" title="Int">ceil</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Int(0)" class="int">0</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="delimiter">(</span><span title="Int(0)" class="int">0</span> <a href="#96270" title="(z: Int)(op: (Int, Int) =&gt; Int)Int">/:</a> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#95718" title="Int">ceil</a> <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <span title="Int(0)" class="int">0</span> <span title="(step: Int)scala.collection.immutable.Range">by</span> -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="Int" id="96371">x</a>, <a title="Int" id="96372">i</a><span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="Int" id="96373">y</a> = <a href="#96371" title="Int">x</a> <span title="(x: Int)Int">|</span> <span class="delimiter">(</span><span title="Int(1)" class="int">1</span> <span title="(x: Int)Int">&lt;&lt;</span> <a href="#96372" title="Int">i</a><span class="delimiter">)</span>
        <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#95717" title="(v1: Int)Boolean">f</a><span class="delimiter">(</span><a href="#96373" title="Int">y</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#96373" title="Int">y</a> <span class="keyword">else</span> <a href="#96371" title="Int">x</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>


  /**
   * Returns the digits to the right of the decimal point of `x / y` in base
   * `r` if x &lt; y.
   */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(x: BigInt, y: BigInt, r: Int)Stream[BigInt]" id="55700">decDiv</a><span class="delimiter">(</span><a title="BigInt" id="96382">x</a>: <span title="BigInt">BigInt</span>, <a title="BigInt" id="96383">y</a>: <span title="BigInt">BigInt</span>, <a title="Int" id="96384">r</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Stream[BigInt]">Stream</span><span class="delimiter">[</span>BigInt<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.math.BigInt" id="96638">expanded</a> = <a href="#96382" title="BigInt">x</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#96384" title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt">r</a>
    <span class="keyword">val</span> <a title="scala.math.BigInt" id="96639">quot</a> = <a href="#96638" title="scala.math.BigInt">expanded</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#96383" title="BigInt">y</a>
    <span class="keyword">val</span> <a title="scala.math.BigInt" id="96640">rem</a> = <a href="#96638" title="scala.math.BigInt">expanded</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">-</span> <span class="delimiter">(</span><a href="#96639" title="scala.math.BigInt">quot</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#96383" title="BigInt">y</a><span class="delimiter">)</span>

    <span title="Stream.Cons[scala.math.BigInt]" class="keyword">if</span> <span class="delimiter">(</span><a href="#96640" title="scala.math.BigInt">rem</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="=&gt; collection.immutable.Stream.type">Stream</span>.<span title="(hd: scala.math.BigInt, tl: =&gt; scala.collection.immutable.Stream[scala.math.BigInt])Stream.Cons[scala.math.BigInt]">cons</span><span class="delimiter">(</span><a href="#96639" title="scala.math.BigInt">quot</a>, <span title="=&gt; collection.immutable.Stream.type">Stream</span>.<span title="scala.collection.immutable.Stream[Nothing]">empty</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span title="=&gt; collection.immutable.Stream.type">Stream</span>.<span title="(hd: BigInt, tl: =&gt; scala.collection.immutable.Stream[BigInt])Stream.Cons[BigInt]">cons</span><span class="delimiter">(</span><a href="#96639" title="scala.math.BigInt">quot</a>, <a href="#55700" title="(x: BigInt, y: BigInt, r: Int)Stream[BigInt]">decDiv</a><span class="delimiter">(</span><a href="#96640" title="scala.math.BigInt">rem</a>, <a href="#96383" title="BigInt">y</a>, <a href="#96384" title="Int">r</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>


  /** Returns the digits of `x` in base `r`. */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(x: BigInt, r: Int, prev: List[Int])List[Int]" id="55701">digitize</a><span class="delimiter">(</span><a title="BigInt" id="96789">x</a>: <span title="BigInt">BigInt</span>, <a title="Int" id="96790">r</a>: <span title="Int">Int</span>, <a title="List[Int]" id="96792">prev</a>: <span title="List[Int]">List</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span>: <span title="List[Int]">List</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> =
    <span title="List[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#96789" title="BigInt">x</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#96792" title="List[Int]">prev</a> <span class="keyword">else</span> <a href="#55701" title="(x: BigInt, r: Int, prev: List[Int])List[Int]">digitize</a><span class="delimiter">(</span><a href="#96789" title="BigInt">x</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#96790" title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt">r</a>, <a href="#96790" title="Int">r</a>, <span class="delimiter">(</span><a href="#96789" title="BigInt">x</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#96790" title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt">r</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span> <a href="#96831" title="(x: Int)List[Int]">::</a> <a href="#96792" title="List[Int]">prev</a><span class="delimiter">)</span>


  /** Converts a list of digits in base `r` to a `BigInt`. */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(digits: Seq[Int], r: Int)BigInt" id="55702">undigitize</a><span class="delimiter">(</span><a title="Seq[Int]" id="96837">digits</a>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <a title="Int" id="96838">r</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="BigInt">BigInt</span> =
    <span class="delimiter">(</span><span title="(i: Int)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#96839" title="(z: scala.math.BigInt)(op: (scala.math.BigInt, Int) =&gt; scala.math.BigInt)scala.math.BigInt">/:</a> <a href="#96837" title="Seq[Int]">digits</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#96860" title="scala.math.BigInt">_</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#96838" title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt">r</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <a href="#96861" title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt">_</a><span class="delimiter">)</span>


  // 1 billion: because it's the largest positive Int power of 10.
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Int" id="55703">radix</a> = <span title="Int(1000000000)" class="int">1000000000</span>


  /**
   * An implementation of the shifting n-th root algorithm for BigDecimal. For
   * the BigDecimal a, this is guaranteed to be accurate up to the precision
   * specified in ctxt.
   *
   * See http://en.wikipedia.org/wiki/Shifting_nth_root_algorithm
   *
   * @param a A (positive if k % 2 == 0) `BigDecimal`.
   * @param k A positive `Int` greater than 1.
   * @param ctxt The `MathContext` to bound the precision of the result.
   *
   * returns A `BigDecimal` approximation to the `k`-th root of `a`.
   */
  <span class="keyword">def</span> <a title="(a: BigDecimal, k: Int, ctxt: java.math.MathContext)BigDecimal" id="55705">nroot</a><span class="delimiter">(</span><a title="BigDecimal" id="95345">a</a>: <span title="BigDecimal">BigDecimal</span>, <a title="Int" id="95346">k</a>: <span title="Int">Int</span>, <a title="java.math.MathContext" id="95347">ctxt</a>: <span title="java.math.MathContext">MathContext</span><span class="delimiter">)</span>: <span title="BigDecimal">BigDecimal</span> = <span title="scala.math.BigDecimal" class="keyword">if</span> <span class="delimiter">(</span><a href="#95346" title="Int">k</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="(i: Int)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span title="BigDecimal" class="keyword">if</span> <span class="delimiter">(</span><a href="#95345" title="BigDecimal">a</a>.<span title="=&gt; Int">signum</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="BigDecimal" class="keyword">if</span> <span class="delimiter">(</span><a href="#95346" title="Int">k</a> <span title="(x: Int)Int">%</span> <span title="Int(2)" class="int">2</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)ArithmeticException" class="keyword">new</span> <span title="ArithmeticException">ArithmeticException</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%d-root of negative number&quot;</span> <span title="(args: Any*)String">format</span> <a href="#95346" title="Int">k</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span title="=&gt; scala.math.BigDecimal">-</span><a href="#55705" title="(a: BigDecimal, k: Int, ctxt: java.math.MathContext)BigDecimal">nroot</a><span class="delimiter">(</span><span title="=&gt; scala.math.BigDecimal">-</span><a href="#95345" title="BigDecimal">a</a>, <a href="#95346" title="Int">k</a>, <a href="#95347" title="java.math.MathContext">ctxt</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.math.BigInt" id="96892">underlying</a> = <span title="(x: Array[Byte])scala.math.BigInt">BigInt</span><span class="delimiter">(</span><a href="#95345" title="BigDecimal">a</a>.<span title="=&gt; java.math.BigDecimal">bigDecimal</span>.<span title="()java.math.BigInteger">unscaledValue</span>.<span title="()Array[Byte]">toByteArray</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.math.BigInt" id="96893">scale</a> = <span title="(i: Int)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><span title="Int(10)" class="int">10</span><span class="delimiter">)</span> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#95345" title="BigDecimal">a</a>.<span title="=&gt; Int">scale</span>
    <span class="keyword">val</span> <a title="List[Int]" id="96894">intPart</a> = <a href="#55701" title="(x: BigInt, r: Int, prev: List[Int])List[Int]">digitize</a><span class="delimiter">(</span><a href="#96892" title="scala.math.BigInt">underlying</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#96893" title="scala.math.BigInt">scale</a>, <a href="#55703" title="=&gt; Int">radix</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Stream[Int]" id="96895">fracPart</a> = <a href="#55700" title="(x: BigInt, y: BigInt, r: Int)Stream[BigInt]">decDiv</a><span class="delimiter">(</span><a href="#96892" title="scala.math.BigInt">underlying</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#96893" title="scala.math.BigInt">scale</a>, <a href="#96893" title="scala.math.BigInt">scale</a>, <a href="#55703" title="=&gt; Int">radix</a><span class="delimiter">)</span> <span title="(f: BigInt =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[BigInt],Int,scala.collection.immutable.Stream[Int]])scala.collection.immutable.Stream[Int]">map</span> <span class="delimiter">(</span><a href="#96955" title="BigInt">_</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Stream[Int]" id="96896">leader</a> = <span title="scala.collection.immutable.Stream[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#96894" title="List[Int]">intPart</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">%</span> <a href="#95346" title="Int">k</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="=&gt; collection.immutable.Stream.type">Stream</span>.<span title="scala.collection.immutable.Stream[Nothing]">empty</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span title="=&gt; collection.immutable.Stream.type">Stream</span>.<span title="(n: Int)(elem: =&gt; Int)scala.collection.immutable.Stream[Int]">fill</span><span class="delimiter">(</span><a href="#95346" title="Int">k</a> <span title="(x: Int)Int">-</span> <a href="#96894" title="List[Int]">intPart</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">%</span> <a href="#95346" title="Int">k</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Stream[Int]" id="96897">digits</a> = <a href="#96896" title="scala.collection.immutable.Stream[Int]">leader</a> <span title="(that: scala.collection.GenTraversableOnce[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[Int],Int,scala.collection.immutable.Stream[Int]])scala.collection.immutable.Stream[Int]">++</span> <a href="#96894" title="List[Int]">intPart</a>.<span title="=&gt; scala.collection.immutable.Stream[Int]">toStream</span> <span title="(that: scala.collection.GenTraversableOnce[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[Int],Int,scala.collection.immutable.Stream[Int]])scala.collection.immutable.Stream[Int]">++</span> <a href="#96895" title="scala.collection.immutable.Stream[Int]">fracPart</a> <span title="(that: scala.collection.GenTraversableOnce[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[Int],Int,scala.collection.immutable.Stream[Int]])scala.collection.immutable.Stream[Int]">++</span> <span title="=&gt; collection.immutable.Stream.type">Stream</span>.<span title="(elem: =&gt; Int)scala.collection.immutable.Stream[Int]">continually</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.math.BigInt" id="96898">radixPowK</a> = <span title="(i: Int)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><a href="#55703" title="=&gt; Int">radix</a><span class="delimiter">)</span> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#95346" title="Int">k</a>

    // Total # of digits to compute.
    // Note: I originally had `+ 1` here, but some edge cases were missed, so now
    // it is `+ 2`.
    <span class="keyword">val</span> <a title="Int" id="96899">maxSize</a> = <span class="delimiter">(</span><a href="#95347" title="java.math.MathContext">ctxt</a>.<span title="()Int">getPrecision</span> <span title="(x: Int)Int">+</span> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span> <span title="(x: Int)Int">/</span> <span title="Int(9)" class="int">9</span> <span title="(x: Int)Int">+</span> <span title="Int(2)" class="int">2</span>

    <span class="keyword">def</span> <a title="(digits: Stream[Int], y: BigInt, r: BigInt, i: Int)(Int, BigInt)" id="96900">findRoot</a><span class="delimiter">(</span><a title="Stream[Int]" id="97633">digits</a>: <span title="Stream[Int]">Stream</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <a title="BigInt" id="97634">y</a>: <span title="BigInt">BigInt</span>, <a title="BigInt" id="97635">r</a>: <span title="BigInt">BigInt</span>, <a title="Int" id="97636">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(Int, BigInt)" class="delimiter">(</span>Int, BigInt<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="97637">y_</a> = <a href="#97634" title="BigInt">y</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#55703" title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt">radix</a>
      <span class="keyword">val</span> <a title="BigInt" id="97638">a</a> = <a href="#55702" title="(digits: Seq[Int], r: Int)BigInt">undigitize</a><span class="delimiter">(</span><a href="#97633" title="Stream[Int]">digits</a> <span title="(n: Int)scala.collection.immutable.Stream[Int]">take</span> <a href="#95346" title="Int">k</a>, <a href="#55703" title="=&gt; Int">radix</a><span class="delimiter">)</span>
      // Note: target grows quite fast (so I imagine (y_ + b) pow k does too).
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="97639">target</a> = <a href="#96898" title="scala.math.BigInt">radixPowK</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#97635" title="BigInt">r</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <a href="#97638" title="BigInt">a</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <span class="delimiter">(</span><a href="#97637" title="scala.math.BigInt">y_</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#95346" title="Int">k</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Int" id="97640">b</a> = <a href="#55699" title="(f: Int =&gt; Boolean)Int">intSearch</a><span class="delimiter">(</span><a title="Int" id="97643">b</a> =&gt; <span class="delimiter">(</span><span class="delimiter">(</span><a href="#97637" title="scala.math.BigInt">y_</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <a href="#97643" title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt">b</a><span class="delimiter">)</span> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#95346" title="Int">k</a><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)Boolean">&lt;=</span> <a href="#97639" title="scala.math.BigInt">target</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="scala.math.BigInt" id="97641">ny</a> = <a href="#97637" title="scala.math.BigInt">y_</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <a href="#97640" title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt">b</a>

      <span title="(Int, scala.math.BigInt)" class="keyword">if</span> <span class="delimiter">(</span><a href="#97636" title="Int">i</a> <span title="(x: Int)Boolean">==</span> <a href="#96899" title="Int">maxSize</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="(_1: Int, _2: scala.math.BigInt)(Int, scala.math.BigInt)" class="delimiter">(</span><a href="#97636" title="Int">i</a>, <a href="#97641" title="scala.math.BigInt">ny</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="scala.math.BigInt" id="97654">nr</a> = <a href="#97639" title="scala.math.BigInt">target</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">-</span> <span class="delimiter">(</span><a href="#97641" title="scala.math.BigInt">ny</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#95346" title="Int">k</a><span class="delimiter">)</span>
        
        // TODO: Add stopping condition for when nr == 0 and there are no more
        // digits. Tricky part is refactoring to know when digits end...

        <a href="#96900" title="(digits: Stream[Int], y: BigInt, r: BigInt, i: Int)(Int, BigInt)">findRoot</a><span class="delimiter">(</span><a href="#97633" title="Stream[Int]">digits</a> <span title="(n: Int)scala.collection.immutable.Stream[Int]">drop</span> <a href="#95346" title="Int">k</a>, <a href="#97641" title="scala.math.BigInt">ny</a>, <a href="#97654" title="scala.math.BigInt">nr</a>, <a href="#97636" title="Int">i</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a href="#211408" title="(x: (Int, BigInt))(Int, BigInt)" class="delimiter">(</a><a href="#211406" title="Int" id="96902">size</a>, <a href="#211406" title="BigInt" id="96903">unscaled</a><span class="delimiter">)</span> = <a href="#96900" title="(digits: Stream[Int], y: BigInt, r: BigInt, i: Int)(Int, BigInt)">findRoot</a><a href="#211406" title="(Int, BigInt) @unchecked" class="delimiter">(</a><a href="#96897" title="scala.collection.immutable.Stream[Int]">digits</a>, <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">0</span>, <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">0</span>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="96904">newscale</a> = <span class="delimiter">(</span><a href="#96902" title="Int">size</a> <span title="(x: Int)Int">-</span> <span class="delimiter">(</span><a href="#96894" title="List[Int]">intPart</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">+</span> <a href="#95346" title="Int">k</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: Int)Int">/</span> <a href="#95346" title="Int">k</a><span class="delimiter">)</span> <span title="(x: Int)Int">*</span> <span title="Int(9)" class="int">9</span>
    <span title="(unscaledVal: scala.math.BigInt, scale: Int, mc: java.math.MathContext)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><a href="#96903" title="BigInt">unscaled</a>, <a href="#96904" title="Int">newscale</a>, <a href="#95347" title="java.math.MathContext">ctxt</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="Object" class="keyword">trait</span> <a title="trait NumberIsNRoot extends Object with spire.algebra.NRoot[spire.math.Number]" id="7511">NumberIsNRoot</a> <span title="Unit" class="keyword">extends</span> <a href="#10586" title="spire.algebra.NRoot[spire.math.Number]">NRoot</a><span class="delimiter">[</span>Number<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(a: spire.math.Number, k: Int)spire.math.Number" id="91632">nroot</a><span class="delimiter">(</span><a title="spire.math.Number" id="97705">a</a>: <a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a>, <a title="Int" id="97706">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a> = <a href="#97705" title="spire.math.Number">a</a>.<a href="../math/Number.scala.html#48412" title="(rhs: spire.math.Number)spire.math.Number">pow</a><span class="delimiter">(</span><a href="../math/Number.scala.html#48976" title="(n: Int)spire.math.Number">Number</a><span class="delimiter">(</span><a href="#97706" title="Int">k</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(a: spire.math.Number)spire.math.Number" id="91633">sqrt</a><span class="delimiter">(</span><a title="spire.math.Number" id="97718">a</a>: <a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a><span class="delimiter">)</span>: <a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a> = <a href="#97718" title="spire.math.Number">a</a>.<a href="../math/Number.scala.html#48412" title="(rhs: spire.math.Number)spire.math.Number">pow</a><span class="delimiter">(</span><a href="../math/Number.scala.html#48980" title="(n: Double)spire.math.Number">Number</a><span class="delimiter">(</span><span title="Double(0.5)" class="double">0.5</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(a: spire.math.Number)spire.math.Number" id="91634">log</a><span class="delimiter">(</span><a title="spire.math.Number" id="97729">a</a>: <a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a><span class="delimiter">)</span> = <a href="../math/Number.scala.html#48980" title="(n: Double)spire.math.Number">Number</a><span class="delimiter">(</span><span title="Math.type">Math</span>.<span title="(x$1: Double)Double">log</span><span class="delimiter">(</span><a href="#97729" title="spire.math.Number">a</a>.<span title="=&gt; Double">toDouble</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(a: spire.math.Number, b: spire.math.Number)spire.math.Number" id="91635">fpow</a><span class="delimiter">(</span><a title="spire.math.Number" id="97741">a</a>: <a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a>, <a title="spire.math.Number" id="97742">b</a>: <a href="../math/Number.scala.html#14780" title="spire.math.Number">Number</a><span class="delimiter">)</span> = <a href="#97741" title="spire.math.Number">a</a>.<a href="../math/Number.scala.html#48412" title="(rhs: spire.math.Number)spire.math.Number">pow</a><span class="delimiter">(</span><a href="#97742" title="spire.math.Number">b</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>spire/spire/math/Rational.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> spire.math

<span class="keyword">import</span> scala.annotation.tailrec
<span class="keyword">import</span> scala.math.<span class="delimiter">{</span>ScalaNumber, ScalaNumericConversions<span class="delimiter">}</span>

<span class="keyword">import</span> java.lang.Math

<span class="keyword">import</span> spire.algebra.<span class="delimiter">{</span>Sign, Positive, Negative, Zero<span class="delimiter">}</span>
<span class="keyword">import</span> spire.<a href="../package.scala.html#7310" title="spire.implicits.type">implicits</a>._

<span class="keyword">trait</span> <a title="trait Fraction[A] extends Object" id="14135">Fraction</a><span class="delimiter">[</span>@specialized<span class="delimiter">(</span>Long<span class="delimiter">)</span> <a title="" id="16265">A</a><span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; A" id="173488">num</a>: <a href="#16265" title="A">A</a>
  <span class="keyword">def</span> <a title="=&gt; A" id="173489">den</a>: <a href="#16265" title="A">A</a>
<span class="delimiter">}</span>

<span title="Object" class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Rational extends scala.math.ScalaNumber with scala.math.ScalaNumericConversions with Ordered[spire.math.Rational]" id="15737">Rational</a> <a href="#15737" title="spire.math.Rational" class="keyword">extends</a> <span title="scala.math.ScalaNumber">ScalaNumber</span> <span class="keyword">with</span> <span title="scala.math.ScalaNumericConversions">ScalaNumericConversions</span> <span class="keyword">with</span> <span title="Ordered[spire.math.Rational]">Ordered</span><span class="delimiter">[</span>Rational<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#13764" title="spire.math.LongRationals.type">LongRationals</a>.LongRational
  <span class="keyword">import</span> <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.BigRational

  <span class="keyword">def</span> <a title="=&gt; BigInt" id="58156">numerator</a>: <span title="BigInt">BigInt</span>
  <span class="keyword">def</span> <a title="=&gt; BigInt" id="58157">denominator</a>: <span title="BigInt">BigInt</span>

  // ugh, ScalaNumber and ScalaNumericConversions in 2.10 require this hack
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()List[Any]" id="58158">underlying</a>: <span title="List[Any]">List</span><span class="delimiter">[</span>Any<span class="delimiter">]</span> = sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;unimplemented&quot;)" class="string">&quot;unimplemented&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; spire.math.Rational" id="58159">abs</a>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#15737" title="Rational.this.type" class="keyword">this</a> <span title="(that: spire.math.Rational)Boolean">&lt;</span> <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84807" title="=&gt; spire.math.Rational">zero</a><span class="delimiter">)</span> <a href="#58162" title="()spire.math.Rational">-</a><a href="#15737" title="Rational.this.type" class="keyword">this</a> <span class="keyword">else</span> <a href="#15737" title="spire.math.Rational" class="keyword">this</a>
  <span class="keyword">def</span> <a title="=&gt; spire.math.Rational" id="58160">inverse</a>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84809" title="=&gt; spire.math.Rational">one</a> <a href="#58166" title="(rhs: spire.math.Rational)spire.math.Rational">/</a> <a href="#15737" title="spire.math.Rational" class="keyword">this</a>
  <span class="keyword">def</span> <a title="=&gt; Int" id="58161">signum</a>: <span title="Int">Int</span> = <a href="#58156" title="=&gt; BigInt">numerator</a>.<span title="=&gt; Int">signum</span>

  <span class="keyword">def</span> <a title="()spire.math.Rational" id="58162">unary_-</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84807" title="=&gt; spire.math.Rational">zero</a> <a href="#58164" title="(rhs: spire.math.Rational)spire.math.Rational">-</a> <a href="#15737" title="spire.math.Rational" class="keyword">this</a>

  <span class="keyword">def</span> <a title="(rhs: spire.math.Rational)spire.math.Rational" id="58163">+</a><span class="delimiter">(</span><a title="spire.math.Rational" id="98890">rhs</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a>
  <span class="keyword">def</span> <a title="(rhs: spire.math.Rational)spire.math.Rational" id="58164">-</a><span class="delimiter">(</span><a title="spire.math.Rational" id="98877">rhs</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a>
  <span class="keyword">def</span> <a title="(rhs: spire.math.Rational)spire.math.Rational" id="58165">*</a><span class="delimiter">(</span><a title="spire.math.Rational" id="98910">rhs</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a>
  <span class="keyword">def</span> <a title="(rhs: spire.math.Rational)spire.math.Rational" id="58166">/</a><span class="delimiter">(</span><a title="spire.math.Rational" id="90091">rhs</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a>

  <span class="keyword">def</span> <a title="(rhs: spire.math.Rational)spire.math.Rational" id="58167">/~</a><span class="delimiter">(</span><a title="spire.math.Rational" id="84766">rhs</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#15737" title="Rational.this.type" class="keyword">this</a> <a href="#58166" title="(rhs: spire.math.Rational)spire.math.Rational">/</a> <a href="#84766" title="spire.math.Rational">rhs</a><span class="delimiter">)</span>.<a href="#58170" title="=&gt; BigInt">toBigInt</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#15411" title="spire.math.SafeLong.type">SafeLong</a>.<a href="SafeLong.scala.html#86133" title="=&gt; spire.math.SafeLong">one</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(rhs: spire.math.Rational)spire.math.Rational" id="58168">%</a><span class="delimiter">(</span><a title="spire.math.Rational" id="84774">rhs</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#15737" title="Rational.this.type" class="keyword">this</a> <a href="#58164" title="(rhs: spire.math.Rational)spire.math.Rational">-</a> <span class="delimiter">(</span><a href="#15737" title="Rational.this.type" class="keyword">this</a> <a href="#58167" title="(rhs: spire.math.Rational)spire.math.Rational">/~</a> <a href="#84774" title="spire.math.Rational">rhs</a><span class="delimiter">)</span> <a href="#58165" title="(rhs: spire.math.Rational)spire.math.Rational">*</a> <a href="#84774" title="spire.math.Rational">rhs</a>
  <span class="keyword">def</span> <a title="(rhs: spire.math.Rational)(spire.math.Rational, spire.math.Rational)" id="58169">/%</a><span class="delimiter">(</span><a title="spire.math.Rational" id="84782">rhs</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <span title="(spire.math.Rational, spire.math.Rational)" class="delimiter">(</span>Rational, Rational<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="spire.math.Rational" id="173542">q</a> = <a href="#15737" title="Rational.this.type" class="keyword">this</a> <a href="#58167" title="(rhs: spire.math.Rational)spire.math.Rational">/~</a> <a href="#84782" title="spire.math.Rational">rhs</a>
    <span title="(_1: spire.math.Rational, _2: spire.math.Rational)(spire.math.Rational, spire.math.Rational)" class="delimiter">(</span><a href="#173542" title="spire.math.Rational">q</a>, <a href="#15737" title="Rational.this.type" class="keyword">this</a> <a href="#58164" title="(rhs: spire.math.Rational)spire.math.Rational">-</a> <a href="#173542" title="spire.math.Rational">q</a> <a href="#58165" title="(rhs: spire.math.Rational)spire.math.Rational">*</a> <a href="#84782" title="spire.math.Rational">rhs</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; BigInt" id="58170">toBigInt</a>: <span title="BigInt">BigInt</span>
  <span class="keyword">def</span> <a title="=&gt; BigDecimal" id="58171">toBigDecimal</a>: <span title="BigDecimal">BigDecimal</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Short" id="58172">shortValue</a> = <a href="#15737" title="()Long">longValue</a>.<span title="=&gt; Short">toShort</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Byte" id="58173">byteValue</a> = <a href="#15737" title="()Long">longValue</a>.<span title="=&gt; Byte">toByte</span>

  <span class="keyword">def</span> <a title="=&gt; spire.math.Rational" id="58174">floor</a>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#84817" title="implicit spire.math.Rational.apply : (x: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#58170" title="=&gt; BigInt">toBigInt</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; spire.math.Rational" id="58175">ceil</a>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#58157" title="=&gt; BigInt">denominator</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="#58174" title="=&gt; spire.math.Rational">floor</a> <span class="keyword">else</span> <a href="#84817" title="implicit spire.math.Rational.apply : (x: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#58170" title="=&gt; BigInt">toBigInt</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">1</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; spire.math.Rational" id="58176">round</a>: <a href="#15737" title="spire.math.Rational">Rational</a>

  <span class="keyword">def</span> <a title="(exp: Int)spire.math.Rational" id="58177">pow</a><span class="delimiter">(</span><a title="Int" id="95178">exp</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a>

  <span class="keyword">def</span> <a title="()spire.math.Rational" id="58178">log</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a>

  /**
   * Returns this `Rational` to the exponent `exp`. Both the numerator and
   * denominator of `exp` must be valid integers. Anything larger will cause
   * `pow` to throw an `ArithmeticException`.
   */
  <span class="keyword">def</span> <a title="(exp: spire.math.Rational)(implicit ctxt: spire.math.ApproximationContext[spire.math.Rational])spire.math.Rational" id="58179">pow</a><span class="delimiter">(</span><a title="spire.math.Rational" id="95175">exp</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="spire.math.ApproximationContext[spire.math.Rational]" id="95176">ctxt</a>: <a href="ApproximationContext.scala.html#12227" title="spire.math.ApproximationContext[spire.math.Rational]">ApproximationContext</a><span class="delimiter">[</span>Rational<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
    <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#95175" title="spire.math.Rational">exp</a> <span title="(that: spire.math.Rational)Boolean">&lt;</span> <a href="#84816" title="implicit spire.math.Rational.apply : (x: Long)spire.math.Rational" class="int">0</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#15737" title="Rational.this.type" class="keyword">this</a>.<a href="#58160" title="=&gt; spire.math.Rational">inverse</a>.<a href="#58179" title="(exp: spire.math.Rational)(implicit ctxt: spire.math.ApproximationContext[spire.math.Rational])spire.math.Rational">pow</a><span class="delimiter">(</span><a href="#58162" title="()spire.math.Rational">-</a><a href="#95175" title="spire.math.Rational">exp</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#95176" title="spire.math.ApproximationContext[spire.math.Rational]">ctxt</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><span class="delimiter">(</span><a href="#95175" title="spire.math.Rational">exp</a>.<a href="#58156" title="=&gt; BigInt">numerator</a>.<span title="=&gt; Boolean">isValidInt</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <span title="=&gt; Boolean">!</span><span class="delimiter">(</span><a href="#95175" title="spire.math.Rational">exp</a>.<a href="#58157" title="=&gt; BigInt">denominator</a>.<span title="=&gt; Boolean">isValidInt</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)ArithmeticException" class="keyword">new</span> <span title="ArithmeticException">ArithmeticException</span><span class="delimiter">(</span><span title="String(&quot;Exponent is too large!&quot;)" class="string">&quot;Exponent is too large!&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      
      // nroot must be done last so the context is still valid, otherwise, we'd
      // need to adjust the error, as the absolute error would increase,
      // relatively, by (1 + e)^exp.numerator if nroot was done before the pow.

      <span class="delimiter">(</span><a href="#15737" title="Rational.this.type" class="keyword">this</a> <a href="#58177" title="(exp: Int)spire.math.Rational">pow</a> <a href="#95175" title="spire.math.Rational">exp</a>.<a href="#58156" title="=&gt; BigInt">numerator</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>.<a href="#58180" title="(k: Int)(implicit ctxt: spire.math.ApproximationContext[spire.math.Rational])spire.math.Rational">nroot</a><span class="delimiter">(</span><a href="#95175" title="spire.math.Rational">exp</a>.<a href="#58157" title="=&gt; BigInt">denominator</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#95176" title="spire.math.ApproximationContext[spire.math.Rational]">ctxt</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>


  /**
   * Find the n-th root of this `Rational`. This requires an (implicit)
   * `ApproximationContext` to bound the allowable absolute error of the answer.
   */
  <span class="keyword">def</span> <a title="(k: Int)(implicit ctxt: spire.math.ApproximationContext[spire.math.Rational])spire.math.Rational" id="58180">nroot</a><span class="delimiter">(</span><a title="Int" id="95161">k</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="spire.math.ApproximationContext[spire.math.Rational]" id="95162">ctxt</a>: <a href="ApproximationContext.scala.html#12227" title="spire.math.ApproximationContext[spire.math.Rational]">ApproximationContext</a><span class="delimiter">[</span>Rational<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#95161" title="Int">k</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84809" title="=&gt; spire.math.Rational">one</a>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#95161" title="Int">k</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#15737" title="Rational.this.type" class="keyword">this</a>.<a href="#58160" title="=&gt; spire.math.Rational">inverse</a>.<a href="#58180" title="(k: Int)(implicit ctxt: spire.math.ApproximationContext[spire.math.Rational])spire.math.Rational">nroot</a><span class="delimiter">(</span><span title="=&gt; Int">-</span><a href="#95161" title="Int">k</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#95162" title="spire.math.ApproximationContext[spire.math.Rational]">ctxt</a><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#58156" title="=&gt; BigInt">numerator</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84807" title="=&gt; spire.math.Rational">zero</a>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

    // TODO: Is this necessary with the better init. approx in the else?

    <span class="keyword">val</span> <a href="#214052" title="(x: (spire.math.Rational, spire.math.Rational))(spire.math.Rational, spire.math.Rational)" class="delimiter">(</a><a href="#214050" title="spire.math.Rational" id="173621">low</a>, <a href="#214050" title="spire.math.Rational" id="173622">high</a><span class="delimiter">)</span> = <a href="#15737" title="spire.math.Rational" class="keyword">this</a> <a href="#214050" title="(spire.math.Rational, spire.math.Rational) @unchecked" class="keyword">match</a> <span class="delimiter">{</span>
      <span class="keyword">case</span> LongRational<a href="#214041" title="(spire.math.Rational, spire.math.Rational)" id="214042" class="delimiter">(</a><a href="#174121" title="Long" id="173685">n</a>, <a href="#174122" title="Long" id="173686">d</a><span class="delimiter">)</span> =&gt; <a href="#214045" title="(x: (spire.math.Rational, spire.math.Rational))(spire.math.Rational, spire.math.Rational)" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="(Long, Long)" id="173687">n_</a> = <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84822" title="(x: Long, n: Int)(Long, Long)">nroot</a><span class="delimiter">(</span><a href="#173685" title="Long">n</a>, <a href="#95161" title="Int">k</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="(Long, Long)" id="173688">d_</a> = <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84822" title="(x: Long, n: Int)(Long, Long)">nroot</a><span class="delimiter">(</span><a href="#173686" title="Long">d</a>, <a href="#95161" title="Int">k</a><span class="delimiter">)</span>
        <span title="(_1: spire.math.Rational, _2: spire.math.Rational)(spire.math.Rational, spire.math.Rational)" class="delimiter">(</span><a href="#84812" title="(n: Long, d: Long)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#173687" title="(Long, Long)">n_</a>.<span title="=&gt; Long">_1</span>, <a href="#173688" title="(Long, Long)">d_</a>.<span title="=&gt; Long">_2</span><span class="delimiter">)</span>, <a href="#84812" title="(n: Long, d: Long)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#173687" title="(Long, Long)">n_</a>.<span title="=&gt; Long">_2</span>, <a href="#173688" title="(Long, Long)">d_</a>.<span title="=&gt; Long">_1</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">case</span> BigRational<a href="#214041" title="(spire.math.Rational, spire.math.Rational)" id="214043" class="delimiter">(</a><a href="#174375" title="BigInt" id="173772">n</a>, <a href="#174376" title="BigInt" id="173773">d</a><span class="delimiter">)</span> =&gt; <a href="#214045" title="(x: (spire.math.Rational, spire.math.Rational))(spire.math.Rational, spire.math.Rational)" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="(BigInt, BigInt)" id="173774">n_</a> = <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84821" title="(x: BigInt, n: Int)(BigInt, BigInt)">nroot</a><span class="delimiter">(</span><a href="#173772" title="BigInt">n</a>, <a href="#95161" title="Int">k</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="(BigInt, BigInt)" id="173775">d_</a> = <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84821" title="(x: BigInt, n: Int)(BigInt, BigInt)">nroot</a><span class="delimiter">(</span><a href="#173773" title="BigInt">d</a>, <a href="#95161" title="Int">k</a><span class="delimiter">)</span>
        <span title="(_1: spire.math.Rational, _2: spire.math.Rational)(spire.math.Rational, spire.math.Rational)" class="delimiter">(</span><a href="#84813" title="(n: BigInt, d: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#173774" title="(BigInt, BigInt)">n_</a>.<span title="=&gt; BigInt">_1</span>, <a href="#173775" title="(BigInt, BigInt)">d_</a>.<span title="=&gt; BigInt">_2</span><span class="delimiter">)</span>, <a href="#84813" title="(n: BigInt, d: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#173774" title="(BigInt, BigInt)">n_</a>.<span title="=&gt; BigInt">_2</span>, <a href="#173775" title="(BigInt, BigInt)">d_</a>.<span title="=&gt; BigInt">_1</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    
    <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#173621" title="spire.math.Rational">low</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#173622" title="spire.math.Rational">high</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#173621" title="spire.math.Rational">low</a>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
    
      <span class="keyword">import</span> <a href="#174779" title="spire.math.Rational.type">Rational</a>.<span class="delimiter">{</span> nroot =&gt; intNroot <span class="delimiter">}</span>

      // To ensure the initial approximation is within (relatively) 1/n of the
      // actual root, we need to ensure the num. and den. are both &gt;= min.
      // Otherwise, we need to find a single multiplier for them that can
      // guarantee this. From there, we can simply use the integer version of
      // nroot to get a good approximation.

      <span class="keyword">val</span> <a title="scala.math.BigInt" id="173822">min</a> = <span class="delimiter">(</span><span title="(i: Int)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><a href="#95161" title="Int">k</a><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">2</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">1</span><span class="delimiter">)</span> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#95161" title="Int">k</a>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="173823">mul</a> = <a href="#173822" title="scala.math.BigInt">min</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <span class="delimiter">(</span><a href="#15737" title="Rational.this.type" class="keyword">this</a>.<a href="#58156" title="=&gt; BigInt">numerator</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">min</span> <a href="#15737" title="Rational.this.type" class="keyword">this</a>.<a href="#58157" title="=&gt; BigInt">denominator</a><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">1</span>
      <span class="keyword">val</span> <a title="(BigInt, BigInt)" id="173824">numIntRt</a> = <a href="#84821" title="(x: BigInt, n: Int)(BigInt, BigInt)">intNroot</a><span class="delimiter">(</span><a href="#58156" title="=&gt; BigInt">numerator</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#173823" title="scala.math.BigInt">mul</a>, <a href="#95161" title="Int">k</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="(BigInt, BigInt)" id="173825">denIntRt</a> = <a href="#84821" title="(x: BigInt, n: Int)(BigInt, BigInt)">intNroot</a><span class="delimiter">(</span><a href="#58157" title="=&gt; BigInt">denominator</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#173823" title="scala.math.BigInt">mul</a>, <a href="#95161" title="Int">k</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="spire.math.Rational" id="173826">low</a> = <a href="#84813" title="(n: BigInt, d: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#173824" title="(BigInt, BigInt)">numIntRt</a>.<span title="=&gt; BigInt">_1</span>, <a href="#173825" title="(BigInt, BigInt)">denIntRt</a>.<span title="=&gt; BigInt">_2</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="spire.math.Rational" id="173827">high</a> = <a href="#84813" title="(n: BigInt, d: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#173824" title="(BigInt, BigInt)">numIntRt</a>.<span title="=&gt; BigInt">_2</span>, <a href="#173825" title="(BigInt, BigInt)">denIntRt</a>.<span title="=&gt; BigInt">_1</span><span class="delimiter">)</span>

      // Reduction in absolute error from n-th root algorithm:
      // Let x(k) be the approximation at step k, x(oo) be the n-th root. Let
      // e(k) be the relative error at step k, thus x(k) = x(oo)(1 + e(k)). If
      // x(0) &gt; x(oo), then x(k) &gt; x(oo) (this can be seen during the
      // derivation).
      //
      // x(k+1) = 1/n [(n-1) * x(k) + x(oo)^n / x(k)^(n-1)]
      //          1/n [(n-1) * x(oo) * (1 + e(k)) + x(oo)^n / (x(oo) * (1 + e(k)))^(n-1)]
      //          x(oo)[(n-1)*(1+e(k)) / n + 1 / (n * (1 + e(k))^(n-1))]
      //          x(oo)[1 + e(k) + (1 + e(k))/n + 1 / (n * (1 + e(k))^(n-1))]
      //          x(oo)[1 + e(k) * (1 - ((1 + e(k))^n - 1) / (e(k) * n * (1 + e(k))^(n-1))]
      //          x(oo)[1 + e(k) * (1 - ((1 + n*e(k) + nC2*e(k)^2 + ... + e(k)^n) - 1) / (.. as above ..))]
      //          x(oo)[1 + e(k) * (1 - (1 + nC2*e^2/n + ... + e^(n-1)/n) / (1 + e(k))^(n-1))]
      //        &lt; x(oo)[1 + e(k) * (1 - 1 / (1 + e(k))^(n-1))]
      //        &lt; x(oo)[1 + e(k) * (1 - 1 / (1 + 1/n)^(n-1))]
      // Let e = (1 + 1/n)^(n-1).
      //        &lt; x(oo)[1 + e(k) * (e - 1 / e)]
      //          
      // So, we use a = (e - 1) / e as the relative error multiplier.

      <span class="keyword">val</span> <a title="spire.math.Rational" id="173828">e</a> = <a href="#84812" title="(n: Long, d: Long)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#95161" title="Int">k</a> <span title="=&gt; Long">+</span> <span title="Int(1)" class="int">1</span>, <a href="#95161" title="=&gt; Long">k</a><span class="delimiter">)</span> <a href="#58177" title="(exp: Int)spire.math.Rational">pow</a> <span class="delimiter">(</span><a href="#95161" title="Int">k</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="spire.math.Rational" id="173829">a</a> = <span class="delimiter">(</span><a href="#173828" title="spire.math.Rational">e</a> <a href="#58164" title="(rhs: spire.math.Rational)spire.math.Rational">-</a> <a href="#84816" title="implicit spire.math.Rational.apply : (x: Long)spire.math.Rational" class="int">1</a><span class="delimiter">)</span> <a href="#58166" title="(rhs: spire.math.Rational)spire.math.Rational">/</a> <a href="#173828" title="spire.math.Rational">e</a>   // The relative error is multiplied by this each iter.
      <span class="keyword">val</span> <a title="spire.math.Rational" id="173830">error</a> = <a href="#95162" title="spire.math.ApproximationContext[spire.math.Rational]">ctxt</a>.<a href="ApproximationContext.scala.html#91661" title="=&gt; spire.math.Rational">error</a>
      <span class="keyword">val</span> <a title="spire.math.Rational" id="173831">absErr</a> = <a href="#173827" title="spire.math.Rational">high</a> <a href="#58164" title="(rhs: spire.math.Rational)spire.math.Rational">-</a> <a href="#173826" title="spire.math.Rational">low</a> // I have no idea why I had this: high / k

      // absErr * a^k &lt; error =&gt; a^k = error / absErr =&gt; k = log(error / absErr) / log(a)
      <span class="keyword">val</span> <a title="Int" id="173832">maxiters</a> = math.<span title="(x: Double)Double">ceil</span><span class="delimiter">(</span>math.<span title="(x: Double)Double">log</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#173830" title="spire.math.Rational">error</a> <a href="#58166" title="(rhs: spire.math.Rational)spire.math.Rational">/</a> <a href="#173831" title="spire.math.Rational">absErr</a><span class="delimiter">)</span>.<span title="=&gt; Double">toDouble</span><span class="delimiter">)</span> <span title="(x: Double)Double">/</span> math.<span title="(x: Double)Double">log</span><span class="delimiter">(</span><a href="#173829" title="spire.math.Rational">a</a>.<span title="=&gt; Double">toDouble</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>
      
      // A single step of the nth-root algorithm.
      @inline <span class="keyword">def</span> <a title="(x: spire.math.Rational)spire.math.Rational" id="173833">refine</a><span class="delimiter">(</span><a title="spire.math.Rational" id="173918">x</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#173918" title="spire.math.Rational">x</a> <a href="#58165" title="(rhs: spire.math.Rational)spire.math.Rational">*</a> <span class="delimiter">(</span><a href="#95161" title="Int">k</a> <a href="#84816" title="implicit spire.math.Rational.apply : (x: Long)spire.math.Rational">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="#58163" title="(rhs: spire.math.Rational)spire.math.Rational">+</a> <a href="#15737" title="Rational.this.type" class="keyword">this</a> <a href="#58166" title="(rhs: spire.math.Rational)spire.math.Rational">/</a> <span class="delimiter">(</span><a href="#173918" title="spire.math.Rational">x</a> <a href="#58177" title="(exp: Int)spire.math.Rational">pow</a> <span class="delimiter">(</span><a href="#95161" title="Int">k</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#58166" title="(rhs: spire.math.Rational)spire.math.Rational">/</a> <a href="#84816" title="implicit spire.math.Rational.apply : (x: Long)spire.math.Rational">k</a>

      <span class="keyword">def</span> <a title="(prev: spire.math.Rational, i: Int)spire.math.Rational" id="173834">findNthRoot</a><span class="delimiter">(</span><a title="spire.math.Rational" id="174001">prev</a>: <a href="#15737" title="spire.math.Rational">Rational</a>, <a title="Int" id="174002">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174002" title="Int">i</a> <span title="(x: Int)Boolean">==</span> <a href="#173832" title="Int">maxiters</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#174001" title="spire.math.Rational">prev</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="spire.math.Rational" id="174007">next</a> = <a href="#173833" title="(x: spire.math.Rational)spire.math.Rational">refine</a><span class="delimiter">(</span><a href="#174001" title="spire.math.Rational">prev</a><span class="delimiter">)</span>
        
        // We know x(e0 - e1) &gt; (1 - a)xe0, so xe0 &lt; x(e0 - e1) / (1 - a).
        // Thus, if we have the difference, we can recalculate our guess of the
        // absolute error more &quot;accurately&quot; by dividing the difference of the
        // previous 2 guesses by (1 - a).
        //
        // This recalculation helps a lot. The numbers are a lot saner.

        // TODO: If we remove the iters constraint and just use this, will we
        //       ever perform worse than iters + 1 iterations? Need proof.

        <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174001" title="spire.math.Rational">prev</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#174007" title="spire.math.Rational">next</a> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#174001" title="spire.math.Rational">prev</a> <a href="#58164" title="(rhs: spire.math.Rational)spire.math.Rational">-</a> <a href="#174007" title="spire.math.Rational">next</a><span class="delimiter">)</span> <a href="#58166" title="(rhs: spire.math.Rational)spire.math.Rational">/</a> <span class="delimiter">(</span><a href="#84816" title="implicit spire.math.Rational.apply : (x: Long)spire.math.Rational">Rational</a><span class="delimiter">(</span><span title="Long(1L)" class="int">1</span><span class="delimiter">)</span> <a href="#58164" title="(rhs: spire.math.Rational)spire.math.Rational">-</a> <a href="#173829" title="spire.math.Rational">a</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(that: spire.math.Rational)Boolean">&lt;</span> <a href="#173830" title="spire.math.Rational">error</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#174001" title="spire.math.Rational">prev</a>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#173834" title="(prev: spire.math.Rational, i: Int)spire.math.Rational">findNthRoot</a><span class="delimiter">(</span><a href="#174007" title="spire.math.Rational">next</a>, <a href="#174002" title="Int">i</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="#173834" title="(prev: spire.math.Rational, i: Int)spire.math.Rational">findNthRoot</a><span class="delimiter">(</span><a href="#173827" title="spire.math.Rational">high</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; spire.algebra.Sign" id="58181">sign</a>: <a href="../algebra/Sign.scala.html#8717" title="spire.algebra.Sign">Sign</a> = <a href="../algebra/Sign.scala.html#99631" title="implicit spire.algebra.Sign.apply : (i: Int)spire.algebra.Sign">Sign</a><span class="delimiter">(</span><a href="#58161" title="=&gt; Int">signum</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="58182">compareToOne</a>: <span title="Int">Int</span>

  /**
   * Returns a `Rational` whose numerator and denominator both fit in an `Int`.
   */
  <span class="keyword">def</span> <a title="=&gt; spire.math.Rational" id="58183">limitToInt</a>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#58185" title="(max: BigInt)spire.math.Rational">limitTo</a><span class="delimiter">(</span><span title="(i: Int)scala.math.BigInt">BigInt</span><span class="delimiter">(</span>Int.<span title="Int(2147483647)">MaxValue</span><span class="delimiter">)</span><span class="delimiter">)</span>


  /**
   * Returns a `Rational` whose numerator and denominator both fit in a `Long`.
   */
  <span class="keyword">def</span> <a title="=&gt; spire.math.Rational" id="58184">limitToLong</a>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#58185" title="(max: BigInt)spire.math.Rational">limitTo</a><span class="delimiter">(</span><span title="(l: Long)scala.math.BigInt">BigInt</span><span class="delimiter">(</span>Long.<span title="Long(9223372036854775807L)">MaxValue</span><span class="delimiter">)</span><span class="delimiter">)</span>


  /**
   * Returns a `Rational` whose denominator and numerator are no larger than
   * `max` and whose value is close to the original. This applies, even if, for
   * example, this `Rational` is greater than `max`. In that case,
   * `Rational(max, 1)` is returned.
   *
   * @param max A positive integer.
   */
  <span class="keyword">def</span> <a title="(max: BigInt)spire.math.Rational" id="58185">limitTo</a><span class="delimiter">(</span><a title="BigInt" id="174028">max</a>: <span title="BigInt">BigInt</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#15737" title="Rational.this.type" class="keyword">this</a>.<a href="#58161" title="=&gt; Int">signum</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#58162" title="()spire.math.Rational">-</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#58162" title="()spire.math.Rational">-</a><a href="#15737" title="Rational.this.type" class="keyword">this</a><span class="delimiter">)</span>.<a href="#58185" title="(max: BigInt)spire.math.Rational">limitTo</a><span class="delimiter">(</span><a href="#174028" title="BigInt">max</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
    <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#174028" title="BigInt">max</a> <span title="(that: scala.math.BigInt)Boolean">&gt;</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">0</span>, <span title="String(&quot;Limit must be a positive integer.&quot;)" class="string">&quot;Limit must be a positive integer.&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scala.math.BigInt" id="174052">half</a> = <a href="#174028" title="BigInt">max</a> <span title="(n: Int)scala.math.BigInt">&gt;&gt;</span> <span title="Int(1)" class="int">1</span>
    <span class="keyword">val</span> <a title="BigInt" id="174053">floor</a> = <a href="#15737" title="Rational.this.type" class="keyword">this</a>.<a href="#58170" title="=&gt; BigInt">toBigInt</a>
    <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174053" title="BigInt">floor</a> <span title="(that: scala.math.BigInt)Boolean">&gt;=</span> <a href="#174028" title="BigInt">max</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#84817" title="implicit spire.math.Rational.apply : (x: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#174028" title="BigInt">max</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174053" title="BigInt">floor</a> <span title="(that: scala.math.BigInt)Boolean">&gt;=</span> <span class="delimiter">(</span><a href="#174028" title="BigInt">max</a> <span title="(n: Int)scala.math.BigInt">&gt;&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#84816" title="implicit spire.math.Rational.apply : (x: Long)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#174053" title="BigInt">floor</a>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#15737" title="Rational.this.type" class="keyword">this</a> <span title="(that: spire.math.Rational)Boolean">&lt;</span> <a href="#84816" title="implicit spire.math.Rational.apply : (x: Long)spire.math.Rational">Rational</a><span class="delimiter">(</span><span title="Long(1L)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#58186" title="(limit: BigInt)spire.math.Rational">limitDenominatorTo</a><span class="delimiter">(</span><a href="#174028" title="BigInt">max</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#58186" title="(limit: BigInt)spire.math.Rational">limitDenominatorTo</a><span class="delimiter">(</span><a href="#174028" title="BigInt">max</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#58157" title="=&gt; BigInt">denominator</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#58156" title="=&gt; BigInt">numerator</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>


  /**
   * Finds the closest `Rational` to this `Rational` whose denominator is no
   * larger than `limit`.
   *
   * See [[http://en.wikipedia.org/wiki/Stern%E2%80%93Brocot_tree#Mediants_and_binary_search]]
   */
  <span class="keyword">def</span> <a title="(limit: BigInt)spire.math.Rational" id="58186">limitDenominatorTo</a><span class="delimiter">(</span><a title="BigInt" id="174086">limit</a>: <span title="BigInt">BigInt</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
    <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#174086" title="BigInt">limit</a> <span title="(that: scala.math.BigInt)Boolean">&gt;</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">0</span>, <span title="String(&quot;Cannot limit denominator to non-positive number.&quot;)" class="string">&quot;Cannot limit denominator to non-positive number.&quot;</span><span class="delimiter">)</span>

    // TODO: We should always perform a binary search from the left or right to
    //       speed up computation. For example, if in a search, we have a lower
    //       bound of 1/2 for many steps, then each step will only add 1/2 to
    //       the upper-bound, and so we'd converge on the number quite slowly.
    //       However, we can speed this up by tentatively checking if we could
    //       skip some intermediate values, by performing an adaptive search.
    //       We'd simply keep doubling the number of steps we're skipping until
    //       the upper-bound (eg) is now the lower bound, then go back to find
    //       the greatest lower bound in the steps we missed by binary search.
    //       Instead of adding 1/2 n times, we would try to add 1/2, 2/4, 4/8,
    //       8/16, etc., until the upper-bound swiches to a lower bound. Say
    //       this happens a (1/2)*2^k, then we simply perform a binary search in
    //       between (1/2)*2^(k-1) and (1/2)*2^k to find the new lower bound.
    //       This would reduce the number of steps to O(log n).

    @tailrec
    <span class="keyword">def</span> <a title="(l: spire.math.Rational, u: spire.math.Rational)spire.math.Rational" id="174088">closest</a><span class="delimiter">(</span><a title="spire.math.Rational" id="174096">l</a>: <a href="#15737" title="spire.math.Rational">Rational</a>, <a title="spire.math.Rational" id="174097">u</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="spire.math.Rational" id="174098">mediant</a> = <a href="#84813" title="(n: BigInt, d: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#174096" title="spire.math.Rational">l</a>.<a href="#58156" title="=&gt; BigInt">numerator</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <a href="#174097" title="spire.math.Rational">u</a>.<a href="#58156" title="=&gt; BigInt">numerator</a>, <a href="#174096" title="spire.math.Rational">l</a>.<a href="#58157" title="=&gt; BigInt">denominator</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <a href="#174097" title="spire.math.Rational">u</a>.<a href="#58157" title="=&gt; BigInt">denominator</a><span class="delimiter">)</span>
    
      <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174098" title="spire.math.Rational">mediant</a>.<a href="#58157" title="=&gt; BigInt">denominator</a> <span title="(that: scala.math.BigInt)Boolean">&gt;</span> <a href="#174086" title="BigInt">limit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#15737" title="Rational.this.type" class="keyword">this</a> <a href="#58164" title="(rhs: spire.math.Rational)spire.math.Rational">-</a> <a href="#174096" title="spire.math.Rational">l</a><span class="delimiter">)</span>.<a href="#58159" title="=&gt; spire.math.Rational">abs</a> <span title="(that: spire.math.Rational)Boolean">&gt;</span> <span class="delimiter">(</span><a href="#174097" title="spire.math.Rational">u</a> <a href="#58164" title="(rhs: spire.math.Rational)spire.math.Rational">-</a> <a href="#15737" title="spire.math.Rational" class="keyword">this</a><span class="delimiter">)</span>.<a href="#58159" title="=&gt; spire.math.Rational">abs</a><span class="delimiter">)</span> <a href="#174097" title="spire.math.Rational">u</a> <span class="keyword">else</span> <a href="#174096" title="spire.math.Rational">l</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174098" title="spire.math.Rational">mediant</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#15737" title="spire.math.Rational" class="keyword">this</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#174098" title="spire.math.Rational">mediant</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174098" title="spire.math.Rational">mediant</a> <span title="(that: spire.math.Rational)Boolean">&lt;</span> <a href="#15737" title="spire.math.Rational" class="keyword">this</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#174088" title="(l: spire.math.Rational, u: spire.math.Rational)spire.math.Rational">closest</a><span class="delimiter">(</span><a href="#174098" title="spire.math.Rational">mediant</a>, <a href="#174097" title="spire.math.Rational">u</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#174088" title="(l: spire.math.Rational, u: spire.math.Rational)spire.math.Rational">closest</a><span class="delimiter">(</span><a href="#174096" title="spire.math.Rational">l</a>, <a href="#174098" title="spire.math.Rational">mediant</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <a href="#15737" title="Rational.this.type" class="keyword">this</a>.<a href="#58181" title="=&gt; spire.algebra.Sign">sign</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="../algebra/Sign.scala.html#10941" title="spire.math.Rational" id="214060">Zero</a> =&gt; <a href="#214064" title="(x: spire.math.Rational)spire.math.Rational" class="keyword">this</a>
      <span class="keyword">case</span> <a href="../algebra/Sign.scala.html#11064" title="spire.math.Rational" id="214061">Positive</a> =&gt; <a href="#174088" title="(l: spire.math.Rational, u: spire.math.Rational)spire.math.Rational">closest</a><a href="#214064" title="(x: spire.math.Rational)spire.math.Rational" class="delimiter">(</a><a href="#84817" title="implicit spire.math.Rational.apply : (x: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#15737" title="Rational.this.type" class="keyword">this</a>.<a href="#58170" title="=&gt; BigInt">toBigInt</a><span class="delimiter">)</span>, <a href="#13764" title="spire.math.LongRationals.type">LongRationals</a>.<a href="#176435" title="(n: Long, d: Long)spire.math.LongRationals.LongRational">LongRational</a><span class="delimiter">(</span><span title="Long(1L)" class="int">1</span>, <span title="Long(0L)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../algebra/Sign.scala.html#11238" title="spire.math.Rational" id="214062">Negative</a> =&gt; <a href="#174088" title="(l: spire.math.Rational, u: spire.math.Rational)spire.math.Rational">closest</a><a href="#214064" title="(x: spire.math.Rational)spire.math.Rational" class="delimiter">(</a><a href="#13764" title="spire.math.LongRationals.type">LongRationals</a>.<a href="#176435" title="(n: Long, d: Long)spire.math.LongRationals.LongRational">LongRational</a><span class="delimiter">(</span>-<span title="Long(-1L)" class="int">1</span>, <span title="Long(0L)" class="int">0</span><span class="delimiter">)</span>, <a href="#84817" title="implicit spire.math.Rational.apply : (x: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#15737" title="Rational.this.type" class="keyword">this</a>.<a href="#58170" title="=&gt; BigInt">toBigInt</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span class="keyword">object</span> <a title="spire.math.Rational.type" id="174779">Rational</a> <a href="#15739" title="spire.math.Rational.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="84801">RationalString</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;^(-?\d+)/(-?\d+)$&quot;&quot;&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="84803">IntegerString</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;^(-?\d+)$&quot;&quot;&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>

  <span class="keyword">import</span> <a href="#13764" title="spire.math.LongRationals.type">LongRationals</a>.LongRational
  <span class="keyword">import</span> <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.BigRational

  <span class="keyword">val</span> <a title="spire.math.Rational" id="84807">zero</a>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#176435" title="(n: Long, d: Long)spire.math.LongRationals.LongRational">LongRational</a><span class="delimiter">(</span><span title="Long(0L)" class="long">0L</span>, <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="spire.math.Rational" id="84809">one</a>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#176435" title="(n: Long, d: Long)spire.math.LongRationals.LongRational">LongRational</a><span class="delimiter">(</span><span title="Long(1L)" class="long">1L</span>, <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
  
  <span class="keyword">private</span><span class="delimiter">[</span>math<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational" id="84811">apply</a><span class="delimiter">(</span><a title="spire.math.SafeLong" id="98927">n</a>: <a href="SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a>, <a title="spire.math.SafeLong" id="98928">d</a>: <a href="SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
    <a href="#98927" title="spire.math.SafeLong">n</a>.<a href="SafeLong.scala.html#49280" title="[A, B &lt;: A, C &lt;: A](that: spire.math.SafeLong)(f: (Long, Long) =&gt; B, g: (BigInt, BigInt) =&gt; C)A">foldWith</a><span title="(that: spire.math.SafeLong)(f: (Long, Long) =&gt; spire.math.LongRationals.LongRational, g: (BigInt, BigInt) =&gt; spire.math.BigRationals.BigRational)spire.math.Rational" class="delimiter">[</span><a href="#15737" title="spire.math.Rational">Rational</a>,<a href="#176435" title="spire.math.LongRationals.LongRational">LongRational</a>,<a href="#177170" title="spire.math.BigRationals.BigRational">BigRational</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#98928" title="spire.math.SafeLong">d</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#176435" title="(n: Long, d: Long)spire.math.LongRationals.LongRational">LongRational</a><span class="delimiter">(</span><a href="#174370" title="Long">_</a>, <a href="#174371" title="Long">_</a><span class="delimiter">)</span>, <a href="#177170" title="(n: BigInt, d: BigInt)spire.math.BigRationals.BigRational">BigRational</a><span class="delimiter">(</span><a href="#174373" title="BigInt">_</a>, <a href="#174374" title="BigInt">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(n: Long, d: Long)spire.math.Rational" id="84812">apply</a><span class="delimiter">(</span><a title="Long" id="98925">n</a>: <span title="Long">Long</span>, <a title="Long" id="98926">d</a>: <span title="Long">Long</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#13764" title="spire.math.LongRationals.type">LongRationals</a>.<a href="#173509" title="(n: Long, d: Long)spire.math.Rational">build</a><span class="delimiter">(</span><a href="#98925" title="Long">n</a>, <a href="#98926" title="Long">d</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(n: BigInt, d: BigInt)spire.math.Rational" id="84813">apply</a><span class="delimiter">(</span><a title="BigInt" id="98923">n</a>: <span title="BigInt">BigInt</span>, <a title="BigInt" id="98924">d</a>: <span title="BigInt">BigInt</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.<a href="#173516" title="(n: BigInt, d: BigInt)spire.math.Rational">build</a><span class="delimiter">(</span><a href="#98923" title="BigInt">n</a>, <a href="#98924" title="BigInt">d</a><span class="delimiter">)</span>

  <span class="keyword">protected</span><span class="delimiter">[</span>math<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(n: Long, d: Long)spire.math.Rational" id="84814">unsafeBuild</a><span class="delimiter">(</span><a title="Long" id="174395">n</a>: <span title="Long">Long</span>, <a title="Long" id="174396">d</a>: <span title="Long">Long</span><span class="delimiter">)</span> = <a href="#13764" title="spire.math.LongRationals.type">LongRationals</a>.<a href="#173510" title="(n: Long, d: Long)spire.math.Rational">unsafeBuild</a><span class="delimiter">(</span><a href="#174395" title="Long">n</a>, <a href="#174396" title="Long">d</a><span class="delimiter">)</span>
  <span class="keyword">protected</span><span class="delimiter">[</span>math<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(n: BigInt, d: BigInt)spire.math.Rational" id="84815">unsafeBuild</a><span class="delimiter">(</span><a title="BigInt" id="174401">n</a>: <span title="BigInt">BigInt</span>, <a title="BigInt" id="174402">d</a>: <span title="BigInt">BigInt</span><span class="delimiter">)</span> = <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.<a href="#173517" title="(n: BigInt, d: BigInt)spire.math.Rational">unsafeBuild</a><span class="delimiter">(</span><a href="#174401" title="BigInt">n</a>, <a href="#174402" title="BigInt">d</a><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit spire.math.Rational.apply : (x: Long)spire.math.Rational" id="84816">apply</a><span class="delimiter">(</span><a title="Long" id="98922">x</a>:<span title="Long">Long</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#13764" title="spire.math.LongRationals.type">LongRationals</a>.<a href="#173509" title="(n: Long, d: Long)spire.math.Rational">build</a><span class="delimiter">(</span><a href="#98922" title="Long">x</a>, <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit spire.math.Rational.apply : (x: BigInt)spire.math.Rational" id="84817">apply</a><span class="delimiter">(</span><a title="BigInt" id="98921">x</a>:<span title="BigInt">BigInt</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.<a href="#173516" title="(n: BigInt, d: BigInt)spire.math.Rational">build</a><span class="delimiter">(</span><a href="#98921" title="BigInt">x</a>, <span title="(i: Int)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit spire.math.Rational.apply : (x: Double)spire.math.Rational" id="84818">apply</a><span class="delimiter">(</span><a title="Double" id="98920">x</a>:<span title="Double">Double</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Long" id="174419">bits</a> = java.lang.<span title="Double.type">Double</span>.<span title="(x$1: Double)Long">doubleToLongBits</span><span class="delimiter">(</span><a href="#98920" title="Double">x</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Long" id="174420">value</a> = <span title="Long" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#174419" title="Long">bits</a> <span title="(x: Int)Long">&gt;&gt;</span> <span title="Int(63)" class="int">63</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="=&gt; Long">-</span><span class="delimiter">(</span><a href="#174419" title="Long">bits</a> <span title="(x: Long)Long">&amp;</span> <span title="Long(4503599627370495L)" class="long">0x000FFFFFFFFFFFFFL</span> <span title="(x: Long)Long">|</span> <span title="Long(4503599627370496L)" class="long">0x0010000000000000L</span><span class="delimiter">)</span>
                <span class="keyword">else</span> <span class="delimiter">(</span><a href="#174419" title="Long">bits</a> <span title="(x: Long)Long">&amp;</span> <span title="Long(4503599627370495L)" class="long">0x000FFFFFFFFFFFFFL</span> <span title="(x: Long)Long">|</span> <span title="Long(4503599627370496L)" class="long">0x0010000000000000L</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="174421">exp</a> = <span class="delimiter">(</span><span class="delimiter">(</span><a href="#174419" title="Long">bits</a> <span title="(x: Int)Long">&gt;&gt;</span> <span title="Int(52)" class="int">52</span><span class="delimiter">)</span> <span title="(x: Int)Long">&amp;</span> <span title="Int(2047)" class="int">0x7FF</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span> <span title="(x: Int)Int">-</span> <span title="Int(1075)" class="int">1075</span> // 1023 + 52
    <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174421" title="Int">exp</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(10)" class="int">10</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#84813" title="(n: BigInt, d: BigInt)spire.math.Rational">apply</a><span class="delimiter">(</span><span title="(l: Long)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><a href="#174420" title="Long">value</a><span class="delimiter">)</span> <span title="(n: Int)scala.math.BigInt">&lt;&lt;</span> <a href="#174421" title="Int">exp</a>, <span title="(i: Int)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174421" title="Int">exp</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#84812" title="(n: Long, d: Long)spire.math.Rational">apply</a><span class="delimiter">(</span><a href="#174420" title="Long">value</a> <span title="(x: Int)Long">&lt;&lt;</span> <a href="#174421" title="Int">exp</a>, <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174421" title="Int">exp</a> <span title="(x: Int)Boolean">&gt;=</span> -<span title="Int(-52)" class="int">52</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><span title="=&gt; Long">~</span><span class="delimiter">(</span><span class="delimiter">(</span>-<span title="Long(-1L)" class="long">1L</span><span class="delimiter">)</span> <span title="(x: Int)Long">&lt;&lt;</span> <span class="delimiter">(</span><span title="=&gt; Int">-</span><a href="#174421" title="Int">exp</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Long)Long">&amp;</span> <a href="#174420" title="Long">value</a><span class="delimiter">)</span> <span title="(x: Long)Boolean">==</span> <span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#84812" title="(n: Long, d: Long)spire.math.Rational">apply</a><span class="delimiter">(</span><a href="#174420" title="Long">value</a> <span title="(x: Int)Long">&gt;&gt;</span> <span class="delimiter">(</span><span title="=&gt; Int">-</span><a href="#174421" title="Int">exp</a><span class="delimiter">)</span>, <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#84813" title="(n: BigInt, d: BigInt)spire.math.Rational">apply</a><span class="delimiter">(</span><span title="(l: Long)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><a href="#174420" title="Long">value</a><span class="delimiter">)</span>, <span title="(i: Int)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(n: Int)scala.math.BigInt">&lt;&lt;</span> <span class="delimiter">(</span><span title="=&gt; Int">-</span><a href="#174421" title="Int">exp</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit spire.math.Rational.apply : (x: BigDecimal)spire.math.Rational" id="84819">apply</a><span class="delimiter">(</span><a title="BigDecimal" id="98919">x</a>:<span title="BigDecimal">BigDecimal</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
    <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#98919" title="BigDecimal">x</a>.<span title="=&gt; scala.math.BigDecimal">ulp</span> <span title="(that: scala.math.BigDecimal)Boolean">&gt;=</span> <span title="implicit scala.math.BigDecimal.int2bigDecimal : (i: Int)scala.math.BigDecimal" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.<a href="#173516" title="(n: BigInt, d: BigInt)spire.math.Rational">build</a><span class="delimiter">(</span><a href="#98919" title="BigDecimal">x</a>.<span title="()scala.math.BigInt">toBigInt</span>, <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="174557">n</a> = <span class="delimiter">(</span><a href="#98919" title="BigDecimal">x</a> <span title="(that: scala.math.BigDecimal)scala.math.BigDecimal">/</span> <a href="#98919" title="BigDecimal">x</a>.<span title="=&gt; scala.math.BigDecimal">ulp</span><span class="delimiter">)</span>.<span title="()scala.math.BigInt">toBigInt</span>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="174558">d</a> = <span class="delimiter">(</span><span title="(d: Double)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><span title="Double(1.0)" class="double">1.0</span><span class="delimiter">)</span> <span title="(that: scala.math.BigDecimal)scala.math.BigDecimal">/</span> <a href="#98919" title="BigDecimal">x</a>.<span title="=&gt; scala.math.BigDecimal">ulp</span><span class="delimiter">)</span>.<span title="()scala.math.BigInt">toBigInt</span>
      <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.<a href="#173516" title="(n: BigInt, d: BigInt)spire.math.Rational">build</a><span class="delimiter">(</span><a href="#174557" title="scala.math.BigInt">n</a>, <a href="#174558" title="scala.math.BigInt">d</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(r: String)spire.math.Rational" id="84820">apply</a><span class="delimiter">(</span><a title="String" id="98918">r</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#98918" title="String">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#84801" title="Option[List[String]]" id="214091">RationalString</a><span class="delimiter">(</span><a title="String" id="174568">n</a>, <a title="String" id="174569">d</a><span class="delimiter">)</span> =&gt; <a href="#84813" title="(n: BigInt, d: BigInt)spire.math.Rational">Rational</a><a href="#214087" title="(x: spire.math.Rational)spire.math.Rational" class="delimiter">(</a><span title="(x: String)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><a href="#174568" title="String">n</a><span class="delimiter">)</span>, <span title="(x: String)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><a href="#174569" title="String">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="#84803" title="Option[List[String]]" id="214093">IntegerString</a><span class="delimiter">(</span><a title="String" id="174595">n</a><span class="delimiter">)</span> =&gt; <a href="#84817" title="implicit spire.math.Rational.apply : (x: BigInt)spire.math.Rational">Rational</a><a href="#214087" title="(x: spire.math.Rational)spire.math.Rational" class="delimiter">(</a><span title="(x: String)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><a href="#174595" title="String">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> s =&gt; <a href="#214087" title="(x: spire.math.Rational)spire.math.Rational" class="keyword">try</a> <span class="delimiter">{</span>
      <a href="#84819" title="implicit spire.math.Rational.apply : (x: BigDecimal)spire.math.Rational">Rational</a><span class="delimiter">(</span><span title="(x: String)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span>s<span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="Nothing" id="174629">nfe</a>: <span title="NumberFormatException">NumberFormatException</span> =&gt; <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)NumberFormatException" class="keyword">new</span> <span title="NumberFormatException">NumberFormatException</span><span class="delimiter">(</span><span title="String(&quot;For input string: &quot;)" class="string">&quot;For input string: &quot;</span> <span title="(x$1: Any)String">+</span> s<span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /**
   * Returns an interval that bounds the nth-root of the integer x.
   *
   * TODO: This is really out-of-place too.
   */
  <span class="keyword">def</span> <a title="(x: BigInt, n: Int)(BigInt, BigInt)" id="84821">nroot</a><span class="delimiter">(</span><a title="BigInt" id="173693">x</a>: <span title="BigInt">BigInt</span>, <a title="Int" id="173694">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(BigInt, BigInt)" class="delimiter">(</span>BigInt, BigInt<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(prev: BigInt, add: Int)(BigInt, BigInt)" id="174632">findnroot</a><span class="delimiter">(</span><a title="BigInt" id="174633">prev</a>: <span title="BigInt">BigInt</span>, <a title="Int" id="174634">add</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(BigInt, BigInt)" class="delimiter">(</span>BigInt, BigInt<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="174635">min</a> = <a href="#174633" title="BigInt">prev</a> <span title="(n: Int)scala.math.BigInt">setBit</span> <a href="#174634" title="Int">add</a>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="174636">max</a> = <a href="#174635" title="scala.math.BigInt">min</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">1</span>

      <span class="keyword">val</span> <a title="scala.math.BigInt" id="174637">fl</a> = <a href="#174635" title="scala.math.BigInt">min</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#173694" title="Int">n</a>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="174638">cl</a> = <a href="#174636" title="scala.math.BigInt">max</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#173694" title="Int">n</a>

      <span title="(BigInt, BigInt)" class="keyword">if</span> <span class="delimiter">(</span><a href="#174637" title="scala.math.BigInt">fl</a> <span title="(that: scala.math.BigInt)Boolean">&gt;</span> <a href="#173693" title="BigInt">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#174632" title="(prev: BigInt, add: Int)(BigInt, BigInt)">findnroot</a><span class="delimiter">(</span><a href="#174633" title="BigInt">prev</a>, <a href="#174634" title="Int">add</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="(BigInt, BigInt)" class="keyword">if</span> <span class="delimiter">(</span><a href="#174638" title="scala.math.BigInt">cl</a> <span title="(that: scala.math.BigInt)Boolean">&lt;</span> <a href="#173693" title="BigInt">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#174632" title="(prev: BigInt, add: Int)(BigInt, BigInt)">findnroot</a><span class="delimiter">(</span><a href="#174635" title="scala.math.BigInt">min</a>, <a href="#174634" title="Int">add</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="(scala.math.BigInt, scala.math.BigInt)" class="keyword">if</span> <span class="delimiter">(</span><a href="#174638" title="scala.math.BigInt">cl</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#173693" title="BigInt">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="(_1: scala.math.BigInt, _2: scala.math.BigInt)(scala.math.BigInt, scala.math.BigInt)" class="delimiter">(</span><a href="#174636" title="scala.math.BigInt">max</a>, <a href="#174636" title="scala.math.BigInt">max</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="(scala.math.BigInt, scala.math.BigInt)" class="keyword">if</span> <span class="delimiter">(</span><a href="#174637" title="scala.math.BigInt">fl</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#173693" title="BigInt">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="(_1: scala.math.BigInt, _2: scala.math.BigInt)(scala.math.BigInt, scala.math.BigInt)" class="delimiter">(</span><a href="#174635" title="scala.math.BigInt">min</a>, <a href="#174635" title="scala.math.BigInt">min</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="(_1: scala.math.BigInt, _2: scala.math.BigInt)(scala.math.BigInt, scala.math.BigInt)" class="delimiter">(</span><a href="#174635" title="scala.math.BigInt">min</a>, <a href="#174636" title="scala.math.BigInt">max</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <a href="#174632" title="(prev: BigInt, add: Int)(BigInt, BigInt)">findnroot</a><span class="delimiter">(</span><span title="(i: Int)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <span class="delimiter">(</span><a href="#173693" title="BigInt">x</a>.<span title="=&gt; Int">bitLength</span> <span title="(x: Int)Int">+</span> <a href="#173694" title="Int">n</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: Int)Int">/</span> <a href="#173694" title="Int">n</a><span class="delimiter">)</span> // ceil(x.bitLength / n)
  <span class="delimiter">}</span>


  /**
   * Returns an interval that bounds the nth-root of the integer x.
   */
  <span class="keyword">def</span> <a title="(x: Long, n: Int)(Long, Long)" id="84822">nroot</a><span class="delimiter">(</span><a title="Long" id="173691">x</a>: <span title="Long">Long</span>, <a title="Int" id="173692">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(Long, Long)" class="delimiter">(</span>Long, Long<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(prev: Long, add: Long)(Long, Long)" id="174698">findnroot</a><span class="delimiter">(</span><a title="Long" id="174699">prev</a>: <span title="Long">Long</span>, <a title="Long" id="174700">add</a>: <span title="Long">Long</span><span class="delimiter">)</span>: <span title="(Long, Long)" class="delimiter">(</span>Long, Long<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Long" id="174701">min</a> = <a href="#174699" title="Long">prev</a> <span title="(x: Long)Long">|</span> <a href="#174700" title="Long">add</a>
      <span class="keyword">val</span> <a title="Long" id="174702">max</a> = <a href="#174701" title="Long">min</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span>
      <span class="keyword">val</span> <a title="Long" id="174703">fl</a> = <a href="../package.scala.html#17004" title="(base: Long, ex: Long)Long">pow</a><span class="delimiter">(</span><a href="#174701" title="Long">min</a>, <a href="#173692" title="=&gt; Long">n</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Long" id="174704">cl</a> = <a href="../package.scala.html#17004" title="(base: Long, ex: Long)Long">pow</a><span class="delimiter">(</span><a href="#174702" title="Long">max</a>, <a href="#173692" title="=&gt; Long">n</a><span class="delimiter">)</span>

      <span title="(Long, Long)" class="keyword">if</span> <span class="delimiter">(</span><a href="#174703" title="Long">fl</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">||</span> <a href="#174703" title="Long">fl</a> <span title="(x: Long)Boolean">&gt;</span> <a href="#173691" title="Long">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#174698" title="(prev: Long, add: Long)(Long, Long)">findnroot</a><span class="delimiter">(</span><a href="#174699" title="Long">prev</a>, <a href="#174700" title="Long">add</a> <span title="(x: Int)Long">&gt;&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="(Long, Long)" class="keyword">if</span> <span class="delimiter">(</span><a href="#174704" title="Long">cl</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#173691" title="Long">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#174698" title="(prev: Long, add: Long)(Long, Long)">findnroot</a><span class="delimiter">(</span><a href="#174701" title="Long">min</a>, <a href="#174700" title="Long">add</a> <span title="(x: Int)Long">&gt;&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="(Long, Long)" class="keyword">if</span> <span class="delimiter">(</span><a href="#174704" title="Long">cl</a> <span title="(x: Long)Boolean">==</span> <a href="#173691" title="Long">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="(_1: Long, _2: Long)(Long, Long)" class="delimiter">(</span><a href="#174702" title="Long">max</a>, <a href="#174702" title="Long">max</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="(Long, Long)" class="keyword">if</span> <span class="delimiter">(</span><a href="#174703" title="Long">fl</a> <span title="(x: Long)Boolean">==</span> <a href="#173691" title="Long">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="(_1: Long, _2: Long)(Long, Long)" class="delimiter">(</span><a href="#174701" title="Long">min</a>, <a href="#174701" title="Long">min</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="(_1: Long, _2: Long)(Long, Long)" class="delimiter">(</span><a href="#174701" title="Long">min</a>, <a href="#174702" title="Long">max</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    // TODO: Could probably get a better initial add then this.
    <a href="#174698" title="(prev: Long, add: Long)(Long, Long)">findnroot</a><span class="delimiter">(</span><span title="Long(0L)" class="int">0</span>, <span title="Long(1L)" class="long">1L</span> <span title="(x: Int)Long">&lt;&lt;</span> <span class="delimiter">(</span><span class="delimiter">(</span><span title="Int(65)" class="int">65</span> <span title="(x: Int)Int">-</span> <a href="#173692" title="Int">n</a><span class="delimiter">)</span> <span title="(x: Int)Int">/</span> <a href="#173692" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>




<span title="Object" class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Rationals[A] extends Object" id="14351">Rationals</a><span class="delimiter">[</span>@specialized<span class="delimiter">(</span>Long<span class="delimiter">)</span> <a title="" id="16266">A</a><span class="delimiter">]</span><a href="#14351" title="spire.math.Rationals[A]" class="delimiter">(</a><span class="keyword">implicit</span> <a title="spire.math.Integral[A]" id="174789">integral</a>: <a href="Integral.scala.html#12359" title="spire.math.Integral[A]">Integral</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#13764" title="spire.math.LongRationals.type">LongRationals</a>._
  <span class="keyword">import</span> <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>._
  <span class="keyword">import</span> <a href="#174789" title="spire.math.Integral[A]">integral</a>._

  <span class="keyword">def</span> <a title="(n: A, d: A)spire.math.Rational" id="173505">build</a><span class="delimiter">(</span><a title="A" id="174383">n</a>: <a href="#16266" title="A">A</a>, <a title="A" id="174384">d</a>: <a href="#16266" title="A">A</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a>

  <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait RationalLike extends spire.math.Rational with spire.math.Fraction[A]" id="173506">RationalLike</a> <span title="Unit" class="keyword">extends</span> <a href="#15737" title="spire.math.Rational">Rational</a> <span class="keyword">with</span> <a href="#14135" title="spire.math.Fraction[A]">Fraction</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="173627">signum</a>: <span title="Int">Int</span> = scala.math.<span title="(x: Int)Int">signum</span><span class="delimiter">(</span><a href="#174789" title="spire.math.Integral[A]">integral</a>.<a href="Order.scala.html#31826" title="(x: A, y: A)Int">compare</a><span class="delimiter">(</span><a href="#173488" title="=&gt; A">num</a>, <a href="../algebra/Additive.scala.html#31692" title="=&gt; A">zero</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="()Boolean" id="173628">isWhole</a>: <span title="Boolean">Boolean</span> = <a href="#173489" title="=&gt; A">den</a> <span title="(x$1: Any)Boolean">==</span> <a href="../algebra/Multiplicative.scala.html#31747" title="=&gt; A">one</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()List[A]" id="173629">underlying</a> = <span title="(xs: A*)List[A]">List</span><span class="delimiter">(</span><a href="#173488" title="=&gt; A">num</a>, <a href="#173489" title="=&gt; A">den</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="=&gt; BigInt" id="173630">toBigInt</a>: <span title="BigInt">BigInt</span> = <span class="delimiter">(</span><a href="#174789" title="spire.math.Integral[A]">integral</a>.<a href="Convertable.scala.html#38903" title="(a: A)BigInt">toBigInt</a><span class="delimiter">(</span><a href="#173488" title="=&gt; A">num</a><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#174789" title="spire.math.Integral[A]">integral</a>.<a href="Convertable.scala.html#38903" title="(a: A)BigInt">toBigInt</a><span class="delimiter">(</span><a href="#173489" title="=&gt; A">den</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; BigDecimal" id="173631">toBigDecimal</a>: <span title="BigDecimal">BigDecimal</span> = <a href="#174789" title="spire.math.Integral[A]">integral</a>.<a href="Convertable.scala.html#38904" title="(a: A)BigDecimal">toBigDecimal</a><span class="delimiter">(</span><a href="#173488" title="=&gt; A">num</a><span class="delimiter">)</span> <span title="(that: scala.math.BigDecimal)scala.math.BigDecimal">/</span> <a href="#174789" title="spire.math.Integral[A]">integral</a>.<a href="Convertable.scala.html#38904" title="(a: A)BigDecimal">toBigDecimal</a><span class="delimiter">(</span><a href="#173489" title="=&gt; A">den</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="()Long" id="173632">longValue</a> = <a href="#173630" title="=&gt; BigInt">toBigInt</a>.<span title="()Long">longValue</span>    // Override if possible.
    <span class="keyword">def</span> <a title="()Int" id="173633">intValue</a> = <a href="#173632" title="implicit scala.Predef.long2Long : (x: Long)Long">longValue</a>.<span title="()Int">intValue</span>

    <span class="keyword">def</span> <a title="()Float" id="173634">floatValue</a> = <a href="#173635" title="()Double">doubleValue</a>.<span title="=&gt; Float">toFloat</span>

    <span class="keyword">def</span> <a title="()Double" id="173635">doubleValue</a>: <span title="Double">Double</span> = <span title="Double" class="keyword">if</span> <span class="delimiter">(</span><a href="#173488" title="=&gt; A">num</a> <span title="(x$1: Any)Boolean">==</span> <a href="../algebra/Additive.scala.html#31692" title="=&gt; A">zero</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Double(0.0)" class="double">0.0</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Double" class="keyword">if</span> <span class="delimiter">(</span><a href="#174789" title="spire.math.Integral[A]">integral</a>.<a href="Order.scala.html#31821" title="(x: A, y: A)Boolean">lt</a><span class="delimiter">(</span><a href="#173488" title="=&gt; A">num</a>, <a href="../algebra/Additive.scala.html#31692" title="=&gt; A">zero</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="=&gt; Double">-</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#58162" title="()spire.math.Rational">-</a><a href="#173506" title="RationalLike.this.type" class="keyword">this</a><span class="delimiter">)</span>.<span title="=&gt; Double">toDouble</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

      // We basically just shift n so that integer division gives us 54 bits of
      // accuracy. We use the last bit for rounding, so end w/ 53 bits total.

      <span class="keyword">val</span> <a title="BigInt" id="174857">n</a> = <a href="#174789" title="spire.math.Integral[A]">integral</a>.<a href="Convertable.scala.html#38903" title="(a: A)BigInt">toBigInt</a><span class="delimiter">(</span><a href="#173488" title="=&gt; A">num</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="BigInt" id="174858">d</a> = <a href="#174789" title="spire.math.Integral[A]">integral</a>.<a href="Convertable.scala.html#38903" title="(a: A)BigInt">toBigInt</a><span class="delimiter">(</span><a href="#173489" title="=&gt; A">den</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="Int" id="174859">sharedLength</a> = <span title="Math.type">Math</span>.<span title="(x$1: Int, x$2: Int)Int">min</span><span class="delimiter">(</span><a href="#174857" title="BigInt">n</a>.<span title="=&gt; Int">bitLength</span>, <a href="#174858" title="BigInt">d</a>.<span title="=&gt; Int">bitLength</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Int" id="174860">dLowerLength</a> = <a href="#174858" title="BigInt">d</a>.<span title="=&gt; Int">bitLength</span> <span title="(x: Int)Int">-</span> <a href="#174859" title="Int">sharedLength</a>

      <span class="keyword">val</span> <a title="scala.math.BigInt" id="174861">nShared</a> = <a href="#174857" title="BigInt">n</a> <span title="(n: Int)scala.math.BigInt">&gt;&gt;</span> <span class="delimiter">(</span><a href="#174857" title="BigInt">n</a>.<span title="=&gt; Int">bitLength</span> <span title="(x: Int)Int">-</span> <a href="#174859" title="Int">sharedLength</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="174862">dShared</a> = <a href="#174858" title="BigInt">d</a> <span title="(n: Int)scala.math.BigInt">&gt;&gt;</span> <a href="#174860" title="Int">dLowerLength</a>
    
      <a href="#174858" title="BigInt">d</a>.<span title="()java.math.BigInteger">underlying</span>.<span title="()Int">getLowestSetBit</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;</span> <a href="#174860" title="Int">dLowerLength</a>
      <span class="keyword">val</span> <a title="Int" id="174863">addBit</a> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#174861" title="scala.math.BigInt">nShared</a> <span title="(that: scala.math.BigInt)Boolean">&lt;</span> <a href="#174862" title="scala.math.BigInt">dShared</a> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><a href="#174861" title="scala.math.BigInt">nShared</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#174862" title="scala.math.BigInt">dShared</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#174858" title="BigInt">d</a>.<span title="()java.math.BigInteger">underlying</span>.<span title="()Int">getLowestSetBit</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;</span> <a href="#174860" title="Int">dLowerLength</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Int(1)" class="int">1</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="Int(0)" class="int">0</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="Int" id="174864">e</a> = <a href="#174858" title="BigInt">d</a>.<span title="=&gt; Int">bitLength</span> <span title="(x: Int)Int">-</span> <a href="#174857" title="BigInt">n</a>.<span title="=&gt; Int">bitLength</span> <span title="(x: Int)Int">+</span> <a href="#174863" title="Int">addBit</a>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="174865">ln</a> = <a href="#174857" title="BigInt">n</a> <span title="(n: Int)scala.math.BigInt">&lt;&lt;</span> <span class="delimiter">(</span><span title="Int(53)" class="int">53</span> <span title="(x: Int)Int">+</span> <a href="#174864" title="Int">e</a><span class="delimiter">)</span>    // We add 1 bit for rounding.
      <span class="keyword">val</span> <a title="Long" id="174866">lm</a> = <span class="delimiter">(</span><a href="#174865" title="scala.math.BigInt">ln</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#174858" title="BigInt">d</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span>
      <span class="keyword">val</span> <a title="Long" id="174867">m</a> = <span class="delimiter">(</span><span class="delimiter">(</span><a href="#174866" title="Long">lm</a> <span title="(x: Int)Long">&gt;&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: Long)Long">+</span> <span class="delimiter">(</span><a href="#174866" title="Long">lm</a> <span title="(x: Int)Long">&amp;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Long)Long">&amp;</span> <span title="Long(4503599627370495L)" class="long">0x000fffffffffffffL</span>
      <span class="keyword">val</span> <a title="Long" id="174868">bits</a> = <span class="delimiter">(</span><a href="#174867" title="Long">m</a> <span title="(x: Long)Long">|</span> <span class="delimiter">(</span><span class="delimiter">(</span><span title="Long(1023L)" class="long">1023L</span> <span title="(x: Int)Long">-</span> <a href="#174864" title="Int">e</a><span class="delimiter">)</span> <span title="(x: Int)Long">&lt;&lt;</span> <span title="Int(52)" class="int">52</span><span class="delimiter">)</span><span class="delimiter">)</span>
      java.lang.<span title="Double.type">Double</span>.<span title="(x$1: Long)Double">longBitsToDouble</span><span class="delimiter">(</span><a href="#174868" title="Long">bits</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
      

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Int" id="173636">hashCode</a>: <span title="Int">Int</span> =
      <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#173628" title="()Boolean">isWhole</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#173630" title="=&gt; BigInt">toBigInt</a> <span title="(x$1: Any)Boolean">==</span> <a href="#173506" title="=&gt; Long">toLong</a><span class="delimiter">)</span> <a href="#173506" title="()Int">unifiedPrimitiveHashcode</a>
      <span class="keyword">else</span> <span title="Int(29)" class="int">29</span> <span title="(x: Int)Int">*</span> <span class="delimiter">(</span><span title="Int(37)" class="int">37</span> <span title="(x: Int)Int">*</span> <a href="#173488" title="=&gt; A">num</a>.<span title="()Int">##</span> <span title="(x: Int)Int">+</span> <a href="#173489" title="=&gt; A">den</a>.<span title="()Int">##</span><span class="delimiter">)</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(that: Any)Boolean" id="173637">equals</a><span class="delimiter">(</span><a title="Any" id="174952">that</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#174952" title="Any">that</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#214125" title="Boolean" id="214126">that</a>: Rational <span class="keyword">with</span> Fraction<span class="delimiter">[</span>_<span class="delimiter">]</span> =&gt; <a href="#173488" title="=&gt; A">num</a> <span title="(x$1: Any)Boolean">==</span> that.<a href="#173488" title="=&gt; _">num</a> <a href="#214132" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#173489" title="=&gt; A">den</a> <span title="(x$1: Any)Boolean">==</span> that.<a href="#173489" title="=&gt; _">den</a>
      <span class="keyword">case</span> <a href="#214125" title="Boolean" id="214127">that</a>: BigInt =&gt; <a href="#173628" title="()Boolean">isWhole</a> <a href="#214132" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#173630" title="=&gt; BigInt">toBigInt</a> <span title="(x$1: AnyRef)Boolean">==</span> that
      <span class="keyword">case</span> <a href="#214125" title="Boolean" id="214128">that</a>: BigDecimal =&gt;
        <a href="#214132" title="(x: Boolean)Boolean" class="keyword">try</a> <span class="delimiter">{</span>
          <a href="#173631" title="=&gt; BigDecimal">toBigDecimal</a> <span title="(x$1: AnyRef)Boolean">==</span> that
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a title="Boolean(false)" id="174970">ae</a>: <span title="ArithmeticException">ArithmeticException</span> =&gt; <span title="Boolean(false)" class="keyword">false</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> that =&gt; <a href="#173506" title="(x: Any)Boolean">unifiedPrimitiveEquals</a><a href="#214132" title="(x: Boolean)Boolean" class="delimiter">(</a>that<span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="173638">toString</a>: <span title="String">String</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s/%s&quot;</span> <span title="(args: Any*)String">format</span> <span class="delimiter">(</span><a href="#173488" title="=&gt; A">num</a>, <a href="#173489" title="=&gt; A">den</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span title="Object" class="keyword">object</span> <a title="spire.math.LongRationals.type" id="13764">LongRationals</a> <a href="#13765" title="spire.math.LongRationals.type" class="keyword">extends</a> <a href="#14351" title="spire.math.Rationals[Long]">Rationals</a><span class="delimiter">[</span>Long<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.BigRational

  <span class="keyword">def</span> <a title="(n: Long, d: Long)spire.math.Rational" id="173509">build</a><span class="delimiter">(</span><a title="Long" id="174381">n</a>: <span title="Long">Long</span>, <a title="Long" id="174382">d</a>: <span title="Long">Long</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#174382" title="Long">d</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="String(&quot;0 denominator&quot;)" class="string">&quot;0 denominator&quot;</span><span class="delimiter">)</span>
    <a href="#173510" title="(n: Long, d: Long)spire.math.Rational">unsafeBuild</a><span class="delimiter">(</span><a href="#174381" title="Long">n</a>, <a href="#174382" title="Long">d</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(n: Long, d: Long)spire.math.Rational" id="173510">unsafeBuild</a><span class="delimiter">(</span><a title="Long" id="174399">n</a>: <span title="Long">Long</span>, <a title="Long" id="174400">d</a>: <span title="Long">Long</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Long" id="175081">divisor</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174399" title="Long">n</a>, <a href="#174400" title="Long">d</a><span class="delimiter">)</span>
    <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#175081" title="Long">divisor</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174400" title="Long">d</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><span title="=&gt; Long">-</span><a href="#174399" title="Long">n</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><span title="=&gt; Long">-</span><a href="#174400" title="Long">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span>
        <a href="#176435" title="(n: Long, d: Long)spire.math.LongRationals.LongRational">LongRational</a><span class="delimiter">(</span><a href="#174399" title="Long">n</a>, <a href="#174400" title="Long">d</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span title="spire.math.LongRationals.LongRational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174400" title="Long">d</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        <a href="#176435" title="(n: Long, d: Long)spire.math.LongRationals.LongRational">LongRational</a><span class="delimiter">(</span><span title="=&gt; Long">-</span><a href="#174399" title="Long">n</a> <span title="(x: Long)Long">/</span> <a href="#175081" title="Long">divisor</a>, <span title="=&gt; Long">-</span><a href="#174400" title="Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175081" title="Long">divisor</a><span class="delimiter">)</span>
      <span class="keyword">else</span>
        <a href="#176435" title="(n: Long, d: Long)spire.math.LongRationals.LongRational">LongRational</a><span class="delimiter">(</span><a href="#174399" title="Long">n</a> <span title="(x: Long)Long">/</span> <a href="#175081" title="Long">divisor</a>, <a href="#174400" title="Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175081" title="Long">divisor</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class LongRational extends spire.math.Rational with spire.math.LongRationals.RationalLike with Product with Serializable" id="176435">LongRational</a> <a href="#176435" title="Product" class="keyword">private</a><span class="delimiter">[</span>math<span class="delimiter">]</span> <span class="delimiter">(</span><a title="Long" id="174121">n</a>: <span title="Long">Long</span>, <a title="Long" id="174122">d</a>: <span title="Long">Long</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#173506" title="spire.math.LongRationals.RationalLike">RationalLike</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Long" id="173646">num</a>: <span title="Long">Long</span> = <a href="#174121" title="=&gt; Long">n</a>
    <span class="keyword">def</span> <a title="=&gt; Long" id="173647">den</a>: <span title="Long">Long</span> = <a href="#174122" title="=&gt; Long">d</a>

    <span class="keyword">def</span> <a title="=&gt; BigInt" id="173648">numerator</a> = <a href="Convertable.scala.html#87564" title="[A](implicit ev: spire.math.ConvertableFrom[A])spire.math.ConvertableFrom[A]">ConvertableFrom</a><a href="Convertable.scala.html#87573" title="(implicit ev: spire.math.ConvertableFrom[Long])spire.math.ConvertableFrom[Long]" class="delimiter">[</a><span title="Long">Long</span><span class="delimiter">]</span>.<a href="Convertable.scala.html#38903" title="(a: Long)BigInt">toBigInt</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; BigInt" id="173649">denominator</a> = <a href="Convertable.scala.html#87564" title="[A](implicit ev: spire.math.ConvertableFrom[A])spire.math.ConvertableFrom[A]">ConvertableFrom</a><a href="Convertable.scala.html#87573" title="(implicit ev: spire.math.ConvertableFrom[Long])spire.math.ConvertableFrom[Long]" class="delimiter">[</a><span title="Long">Long</span><span class="delimiter">]</span>.<a href="Convertable.scala.html#38903" title="(a: Long)BigInt">toBigInt</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="173650">signum</a>: <span title="Int">Int</span> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="Int(1)" class="int">1</span> <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> -<span title="Int(-1)" class="int">1</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()spire.math.Rational" id="173651">unary_-</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="(x: Long)Boolean">==</span> Long.<span title="Long(-9223372036854775808L)">MinValue</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#177170" title="(n: BigInt, d: BigInt)spire.math.BigRationals.BigRational">BigRational</a><span class="delimiter">(</span><span title="=&gt; scala.math.BigInt">-</span><span title="(l: Long)scala.math.BigInt">BigInt</span><span class="delimiter">(</span>Long.<span title="Long(-9223372036854775808L)">MinValue</span><span class="delimiter">)</span>, <span title="(l: Long)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#176435" title="(n: Long, d: Long)spire.math.LongRationals.LongRational">LongRational</a><span class="delimiter">(</span><span title="=&gt; Long">-</span><a href="#174121" title="=&gt; Long">n</a>, <a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(r: spire.math.Rational)spire.math.Rational" id="173652">+</a><span class="delimiter">(</span><a title="spire.math.Rational" id="175213">r</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#175213" title="spire.math.Rational">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#214139" title="spire.math.Rational" id="214140">r</a>: LongRational =&gt;
        <span class="keyword">val</span> <a title="Long" id="175216">dgcd</a>: <span title="Long">Long</span> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, r.<a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>
        <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#175216" title="Long">dgcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span> <span class="delimiter">{</span>

          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175223">num</a> = <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> r.<a href="#174122" title="=&gt; Long">d</a> <a href="SafeLong.scala.html#49223" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">+</a> <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#174122" title="=&gt; Long">d</a>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175224">den</a> = <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> r.<a href="#174122" title="=&gt; Long">d</a>
          <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175223" title="spire.math.SafeLong">num</a>, <a href="#175224" title="spire.math.SafeLong">den</a><span class="delimiter">)</span>

        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

          <span class="keyword">val</span> <a title="Long" id="175273">lden</a>: <span title="Long">Long</span> = <a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175216" title="Long">dgcd</a>
          <span class="keyword">val</span> <a title="Long" id="175274">rden</a>: <span title="Long">Long</span> = r.<a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175216" title="Long">dgcd</a>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175275">num</a>: <a href="SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a> = <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#175274" title="Long">rden</a> <a href="SafeLong.scala.html#49223" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">+</a> <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#175273" title="Long">lden</a>
          <span class="keyword">val</span> <a title="Long" id="175276">ngcd</a>: <span title="Long">Long</span> = <a href="#175275" title="spire.math.SafeLong">num</a>.<a href="SafeLong.scala.html#49272" title="(f: Long =&gt; Long, g: BigInt =&gt; Long)Long">fold</a><span class="delimiter">(</span><a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#175319" title="Long">_</a>, <a href="#175216" title="Long">dgcd</a><span class="delimiter">)</span>, <a title="BigInt" id="175325">num</a> =&gt; <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#175216" title="Long">dgcd</a>, <span class="delimiter">(</span><a href="#175325" title="BigInt">num</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#175216" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">dgcd</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#175276" title="Long">ngcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175275" title="spire.math.SafeLong">num</a>, <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#175273" title="Long">lden</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> r.<a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175275" title="spire.math.SafeLong">num</a> <a href="SafeLong.scala.html#49236" title="(rhs: Long)spire.math.SafeLong">/</a> <a href="#175276" title="Long">ngcd</a>, <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#175273" title="Long">lden</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175276" title="Long">ngcd</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#214139" title="spire.math.Rational" id="214141">r</a>: BigRational =&gt;
        <span class="keyword">val</span> <a title="Long" id="175385">dgcd</a>: <span title="Long">Long</span> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, <span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#174122" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">d</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>
        <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#175385" title="Long">dgcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span> <span class="delimiter">{</span>

          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175392">num</a> = <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174121" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174122" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">d</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175393">den</a> = <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174122" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">d</a><span class="delimiter">)</span>
          <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175392" title="spire.math.SafeLong">num</a>, <a href="#175393" title="spire.math.SafeLong">den</a><span class="delimiter">)</span>

        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

          <span class="keyword">val</span> <a title="Long" id="175418">lden</a>: <span title="Long">Long</span> = <a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175385" title="Long">dgcd</a>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175419">rden</a>: <a href="SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a> = <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49236" title="(rhs: Long)spire.math.SafeLong">/</a> <a href="#175385" title="Long">dgcd</a>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175420">num</a>: <a href="SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a> = <a href="#175419" title="spire.math.SafeLong">rden</a> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#174121" title="=&gt; Long">n</a> <a href="SafeLong.scala.html#49223" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">+</a> <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#175418" title="Long">lden</a>
          <span class="keyword">val</span> <a title="Long" id="175421">ngcd</a>: <span title="Long">Long</span> = <a href="#175420" title="spire.math.SafeLong">num</a>.<a href="SafeLong.scala.html#49272" title="(f: Long =&gt; Long, g: BigInt =&gt; Long)Long">fold</a><span class="delimiter">(</span><a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#175464" title="Long">_</a>, <a href="#175385" title="Long">dgcd</a><span class="delimiter">)</span>, <a title="BigInt" id="175470">num</a> =&gt; <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#175385" title="Long">dgcd</a>, <span class="delimiter">(</span><a href="#175470" title="BigInt">num</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#175385" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">dgcd</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#175421" title="Long">ngcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175420" title="spire.math.SafeLong">num</a>, <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#175418" title="Long">lden</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175420" title="spire.math.SafeLong">num</a> <a href="SafeLong.scala.html#49236" title="(rhs: Long)spire.math.SafeLong">/</a> <a href="#175421" title="Long">ngcd</a>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#175421" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">ngcd</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#175418" title="Long">lden</a><span class="delimiter">)</span>

        <span class="delimiter">}</span>
    <span class="delimiter">}</span>


    <span class="keyword">def</span> <a title="(r: spire.math.Rational)spire.math.Rational" id="173653">-</a><span class="delimiter">(</span><a title="spire.math.Rational" id="175525">r</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#175525" title="spire.math.Rational">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#214148" title="spire.math.Rational" id="214149">r</a>: LongRational =&gt;
        <span class="keyword">val</span> <a title="Long" id="175528">dgcd</a>: <span title="Long">Long</span> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, r.<a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>
        <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#175528" title="Long">dgcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span> <span class="delimiter">{</span>

          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175535">num</a> = <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> r.<a href="#174122" title="=&gt; Long">d</a> <a href="SafeLong.scala.html#49224" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#174122" title="=&gt; Long">d</a>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175536">den</a> = <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> r.<a href="#174122" title="=&gt; Long">d</a>
          <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175535" title="spire.math.SafeLong">num</a>, <a href="#175536" title="spire.math.SafeLong">den</a><span class="delimiter">)</span>

        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

          <span class="keyword">val</span> <a title="Long" id="175585">lden</a>: <span title="Long">Long</span> = <a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175528" title="Long">dgcd</a>
          <span class="keyword">val</span> <a title="Long" id="175586">rden</a>: <span title="Long">Long</span> = r.<a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175528" title="Long">dgcd</a>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175587">num</a>: <a href="SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a> = <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#175586" title="Long">rden</a> <a href="SafeLong.scala.html#49224" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#175585" title="Long">lden</a>
          <span class="keyword">val</span> <a title="Long" id="175588">ngcd</a>: <span title="Long">Long</span> = <a href="#175587" title="spire.math.SafeLong">num</a>.<a href="SafeLong.scala.html#49272" title="(f: Long =&gt; Long, g: BigInt =&gt; Long)Long">fold</a><span class="delimiter">(</span><a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#175631" title="Long">_</a>, <a href="#175528" title="Long">dgcd</a><span class="delimiter">)</span>, <a title="BigInt" id="175637">num</a> =&gt; <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#175528" title="Long">dgcd</a>, <span class="delimiter">(</span><a href="#175637" title="BigInt">num</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#175528" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">dgcd</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#175588" title="Long">ngcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175587" title="spire.math.SafeLong">num</a>, <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#175585" title="Long">lden</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> r.<a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175587" title="spire.math.SafeLong">num</a> <a href="SafeLong.scala.html#49236" title="(rhs: Long)spire.math.SafeLong">/</a> <a href="#175588" title="Long">ngcd</a>, <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#175585" title="Long">lden</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175588" title="Long">ngcd</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#214148" title="spire.math.Rational" id="214150">r</a>: BigRational =&gt;
        <span class="keyword">val</span> <a title="Long" id="175697">dgcd</a>: <span title="Long">Long</span> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, <span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#174122" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">d</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>
        <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#175697" title="Long">dgcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span> <span class="delimiter">{</span>

          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175704">num</a> = <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174121" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">-</span> r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174122" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">d</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175705">den</a> = <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174122" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">d</a><span class="delimiter">)</span>
          <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175704" title="spire.math.SafeLong">num</a>, <a href="#175705" title="spire.math.SafeLong">den</a><span class="delimiter">)</span>

        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

          <span class="keyword">val</span> <a title="Long" id="175730">lden</a>: <span title="Long">Long</span> = <a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175697" title="Long">dgcd</a>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175731">rden</a>: <a href="SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a> = <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49236" title="(rhs: Long)spire.math.SafeLong">/</a> <a href="#175697" title="Long">dgcd</a>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175732">num</a>: <a href="SafeLong.scala.html#15410" title="spire.math.SafeLong">SafeLong</a> = <a href="#175731" title="spire.math.SafeLong">rden</a> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#174121" title="=&gt; Long">n</a> <a href="SafeLong.scala.html#49224" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#175730" title="Long">lden</a>
          <span class="keyword">val</span> <a title="Long" id="175733">ngcd</a>: <span title="Long">Long</span> = <a href="#175732" title="spire.math.SafeLong">num</a>.<a href="SafeLong.scala.html#49272" title="(f: Long =&gt; Long, g: BigInt =&gt; Long)Long">fold</a><span class="delimiter">(</span><a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#175776" title="Long">_</a>, <a href="#175697" title="Long">dgcd</a><span class="delimiter">)</span>, <a title="BigInt" id="175782">num</a> =&gt; <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#175697" title="Long">dgcd</a>, <span class="delimiter">(</span><a href="#175782" title="BigInt">num</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#175697" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">dgcd</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#175733" title="Long">ngcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175732" title="spire.math.SafeLong">num</a>, <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#175730" title="Long">lden</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175732" title="spire.math.SafeLong">num</a> <a href="SafeLong.scala.html#49236" title="(rhs: Long)spire.math.SafeLong">/</a> <a href="#175733" title="Long">ngcd</a>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#175733" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">ngcd</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#175730" title="Long">lden</a><span class="delimiter">)</span>

        <span class="delimiter">}</span>
    <span class="delimiter">}</span>


    <span class="keyword">def</span> <a title="(r: spire.math.Rational)spire.math.Rational" id="173654">*</a><span class="delimiter">(</span><a title="spire.math.Rational" id="175837">r</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
      <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="(x: Long)Boolean">==</span> <span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span> <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84807" title="=&gt; spire.math.Rational">zero</a> <span class="keyword">else</span> <span class="delimiter">(</span><a href="#175837" title="spire.math.Rational">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#214157" title="spire.math.Rational" id="214158">r</a>: LongRational =&gt;
          <span class="keyword">val</span> <a title="Long" id="175844">a</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a>, r.<a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Long" id="175845">b</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, r.<a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span>
          <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="(x: Long)Long">/</span> <a href="#175844" title="Long">a</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174121" title="=&gt; Long">n</a> <span title="(x: Long)Long">/</span> <a href="#175845" title="Long">b</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175845" title="Long">b</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175844" title="Long">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="#214157" title="spire.math.Rational" id="214159">r</a>: BigRational =&gt;
          <span class="keyword">val</span> <a title="Long" id="175903">a</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a>, <span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#174121" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">n</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Long" id="175904">b</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, <span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#174122" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">d</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>
          <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="(x: Long)Long">/</span> <a href="#175903" title="Long">a</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#175904" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">b</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175904" title="Long">b</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#175903" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>


    <span class="keyword">def</span> <a title="(r: spire.math.Rational)spire.math.Rational" id="173655">/</a><span class="delimiter">(</span><a title="spire.math.Rational" id="175953">r</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#175953" title="spire.math.Rational">r</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84807" title="=&gt; spire.math.Rational">zero</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="String(&quot;/ by 0&quot;)" class="string">&quot;/ by 0&quot;</span><span class="delimiter">)</span>
      <a href="#175953" title="spire.math.Rational">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#214166" title="spire.math.Rational" id="214167">r</a>: LongRational =&gt; <a href="#214170" title="(x: spire.math.Rational)spire.math.Rational" class="delimiter">{</a>
          <span class="keyword">val</span> <a title="Long" id="175964">a</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a>, r.<a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Long" id="175965">b</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, r.<a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175966">num</a> = <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="(x: Long)Long">/</span> <a href="#175964" title="Long">a</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175965" title="Long">b</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="175967">den</a> = <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#175965" title="Long">b</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174121" title="=&gt; Long">n</a> <span title="(x: Long)Long">/</span> <a href="#175964" title="Long">a</a><span class="delimiter">)</span>
          <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#175967" title="spire.math.SafeLong">den</a> <span title="(that: spire.math.SafeLong)Boolean">&lt;</span> <a href="SafeLong.scala.html#15411" title="spire.math.SafeLong.type">SafeLong</a>.<a href="SafeLong.scala.html#86131" title="=&gt; spire.math.SafeLong">zero</a><span class="delimiter">)</span> <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#49262" title="()spire.math.SafeLong">-</a><a href="#175966" title="spire.math.SafeLong">num</a>, <a href="SafeLong.scala.html#49262" title="()spire.math.SafeLong">-</a><a href="#175967" title="spire.math.SafeLong">den</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#175966" title="spire.math.SafeLong">num</a>, <a href="#175967" title="spire.math.SafeLong">den</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <a href="#214166" title="spire.math.Rational" id="214168">r</a>: BigRational =&gt; <a href="#214170" title="(x: spire.math.Rational)spire.math.Rational" class="delimiter">{</a>
          <span class="keyword">val</span> <a title="Long" id="176034">a</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a>, <span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#174121" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">n</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Long" id="176035">b</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, <span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#174122" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">d</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="176036">num</a> = <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="(x: Long)Long">/</span> <a href="#176034" title="Long">a</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176035" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">b</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="spire.math.SafeLong" id="176037">den</a> = <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#176035" title="Long">b</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176034" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">a</a><span class="delimiter">)</span>
          <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176037" title="spire.math.SafeLong">den</a> <span title="(that: spire.math.SafeLong)Boolean">&lt;</span> <a href="SafeLong.scala.html#15411" title="spire.math.SafeLong.type">SafeLong</a>.<a href="SafeLong.scala.html#86131" title="=&gt; spire.math.SafeLong">zero</a><span class="delimiter">)</span> <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#49262" title="()spire.math.SafeLong">-</a><a href="#176036" title="spire.math.SafeLong">num</a>, <a href="SafeLong.scala.html#49262" title="()spire.math.SafeLong">-</a><a href="#176037" title="spire.math.SafeLong">den</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#176036" title="spire.math.SafeLong">num</a>, <a href="#176037" title="spire.math.SafeLong">den</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="=&gt; spire.math.Rational" id="173656">round</a>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Long" id="176097">m</a> = <span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="implicit scala.LowPriorityImplicits.longWrapper : (x: Long)scala.runtime.RichLong">%</span> <a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>.<span title="=&gt; Long">abs</span>
      <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176097" title="Long">m</a> <span title="(x: Long)Boolean">&gt;=</span> <span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a> <span title="implicit scala.LowPriorityImplicits.longWrapper : (x: Long)scala.runtime.RichLong">-</span> <a href="#176097" title="Long">m</a><span class="delimiter">)</span>.<span title="=&gt; Long">abs</span><span class="delimiter">)</span> <a href="#84816" title="implicit spire.math.Rational.apply : (x: Long)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="(x: Long)Long">/</span> <a href="#174122" title="=&gt; Long">d</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#84816" title="implicit spire.math.Rational.apply : (x: Long)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a> <span title="(x: Long)Long">/</span> <a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(exp: Int)spire.math.Rational" id="173657">pow</a><span class="delimiter">(</span><a title="Int" id="176195">exp</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176195" title="Int">exp</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84809" title="=&gt; spire.math.Rational">one</a>
    <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176195" title="Int">exp</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.<a href="#173516" title="(n: BigInt, d: BigInt)spire.math.Rational">build</a><span class="delimiter">(</span>spire.math.<a href="../package.scala.html#17004" title="(base: Long, ex: Long)Long">pow</a><span title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt" class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, <span title="=&gt; Long">-</span><a href="#176195" title="Int">exp</a><span class="delimiter">)</span>, spire.math.<a href="../package.scala.html#17004" title="(base: Long, ex: Long)Long">pow</a><span title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt" class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a>, <span title="=&gt; Long">-</span><a href="#176195" title="Int">exp</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">else</span>
      <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.<a href="#173516" title="(n: BigInt, d: BigInt)spire.math.Rational">build</a><span class="delimiter">(</span>spire.math.<a href="../package.scala.html#17004" title="(base: Long, ex: Long)Long">pow</a><span title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt" class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a>, <a href="#176195" title="=&gt; Long">exp</a><span class="delimiter">)</span>, spire.math.<a href="../package.scala.html#17004" title="(base: Long, ex: Long)Long">pow</a><span title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt" class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, <a href="#176195" title="=&gt; Long">exp</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="()spire.math.Rational" id="173658">log</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#84818" title="implicit spire.math.Rational.apply : (x: Double)spire.math.Rational">Rational</a><span class="delimiter">(</span><span title="Math.type">Math</span>.<span title="(x$1: Double)Double">log</span><span class="delimiter">(</span><a href="#174121" title="=&gt; Double">n</a><span class="delimiter">)</span> <span title="(x: Double)Double">-</span> <span title="Math.type">Math</span>.<span title="(x$1: Double)Double">log</span><span class="delimiter">(</span><a href="#174122" title="=&gt; Double">d</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="=&gt; Int" id="173659">compareToOne</a>: <span title="Int">Int</span> = <a href="#174121" title="implicit scala.LowPriorityImplicits.longWrapper : (x: Long)scala.runtime.RichLong">n</a> <span title="(y: Long)Int">compare</span> <a href="#174122" title="=&gt; Long">d</a>

    <span class="keyword">def</span> <a title="(r: spire.math.Rational)Int" id="173660">compare</a><span class="delimiter">(</span><a title="spire.math.Rational" id="176264">r</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <span title="Int">Int</span> = <a href="#176264" title="spire.math.Rational">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#214175" title="Int" id="214176">r</a>: LongRational =&gt;
        <span class="keyword">val</span> <a title="Long" id="176268">dgcd</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, r.<a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>
        <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#176268" title="Long">dgcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
          <span class="delimiter">(</span><a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> r.<a href="#174122" title="=&gt; Long">d</a> <a href="SafeLong.scala.html#49224" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>.<a href="SafeLong.scala.html#49222" title="=&gt; Int">signum</a>
        <span class="keyword">else</span>
          <span class="delimiter">(</span><a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#176268" title="Long">dgcd</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49224" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#176268" title="Long">dgcd</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="SafeLong.scala.html#49222" title="=&gt; Int">signum</a>

      <span class="keyword">case</span> <a href="#214175" title="Int" id="214177">r</a>: BigRational =&gt;
        <span class="keyword">val</span> <a title="Long" id="176342">dgcd</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a>, <span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#174122" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">d</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>
        <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#176342" title="Long">dgcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
          <span class="delimiter">(</span><a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> r.<a href="#174376" title="=&gt; BigInt">d</a> <a href="SafeLong.scala.html#49224" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <a href="#174122" title="=&gt; Long">d</a><span class="delimiter">)</span>.<a href="SafeLong.scala.html#49222" title="=&gt; Int">signum</a>
        <span class="keyword">else</span>
          <span class="delimiter">(</span><a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176342" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">dgcd</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49224" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <span class="delimiter">(</span><a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#176342" title="Long">dgcd</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="SafeLong.scala.html#49222" title="=&gt; Int">signum</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span class="keyword">object</span> <a title="spire.math.BigRationals.type" id="15144">BigRationals</a> <a href="#15145" title="spire.math.BigRationals.type" class="keyword">extends</a> <a href="#14351" title="spire.math.Rationals[BigInt]">Rationals</a><span class="delimiter">[</span>BigInt<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#13764" title="spire.math.LongRationals.type">LongRationals</a>.LongRational

  <span class="keyword">def</span> <a title="(n: BigInt, d: BigInt)spire.math.Rational" id="173516">build</a><span class="delimiter">(</span><a title="BigInt" id="174389">n</a>: <span title="BigInt">BigInt</span>, <a title="BigInt" id="174390">d</a>: <span title="BigInt">BigInt</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#174390" title="BigInt">d</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="String(&quot;0 denominator&quot;)" class="string">&quot;0 denominator&quot;</span><span class="delimiter">)</span>
    <a href="#173517" title="(n: BigInt, d: BigInt)spire.math.Rational">unsafeBuild</a><span class="delimiter">(</span><a href="#174389" title="BigInt">n</a>, <a href="#174390" title="BigInt">d</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(n: BigInt, d: BigInt)spire.math.Rational" id="173517">unsafeBuild</a><span class="delimiter">(</span><a title="BigInt" id="174405">n</a>: <span title="BigInt">BigInt</span>, <a title="BigInt" id="174406">d</a>:<span title="BigInt">BigInt</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.math.BigInt" id="176540">gcd</a> = <a href="#174405" title="BigInt">n</a>.<span title="(that: scala.math.BigInt)scala.math.BigInt">gcd</span><span class="delimiter">(</span><a href="#174406" title="BigInt">d</a><span class="delimiter">)</span>
    <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176540" title="scala.math.BigInt">gcd</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174406" title="BigInt">d</a> <span title="(that: scala.math.BigInt)Boolean">&lt;</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">0</span><span class="delimiter">)</span>
        <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><span title="=&gt; scala.math.BigInt">-</span><a href="#174405" title="BigInt">n</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><span title="=&gt; scala.math.BigInt">-</span><a href="#174406" title="BigInt">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span>
        <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174405" title="BigInt">n</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174406" title="BigInt">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#174406" title="BigInt">d</a> <span title="(that: scala.math.BigInt)Boolean">&lt;</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">0</span><span class="delimiter">)</span>
        <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#49262" title="()spire.math.SafeLong">-</a><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174405" title="BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176540" title="scala.math.BigInt">gcd</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#49262" title="()spire.math.SafeLong">-</a><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174406" title="BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176540" title="scala.math.BigInt">gcd</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span>
        <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174405" title="BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176540" title="scala.math.BigInt">gcd</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174406" title="BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176540" title="scala.math.BigInt">gcd</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>


  case <span class="keyword">class</span> <a title="class BigRational extends spire.math.Rational with spire.math.BigRationals.RationalLike with Product with Serializable" id="177170">BigRational</a> <a href="#177170" title="Product" class="keyword">private</a><span class="delimiter">[</span>math<span class="delimiter">]</span> <span class="delimiter">(</span><a title="BigInt" id="174375">n</a>: <span title="BigInt">BigInt</span>, <a title="BigInt" id="174376">d</a>: <span title="BigInt">BigInt</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#173506" title="spire.math.BigRationals.RationalLike">RationalLike</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; BigInt" id="173733">num</a>: <span title="BigInt">BigInt</span> = <a href="#174375" title="=&gt; BigInt">n</a>
    <span class="keyword">def</span> <a title="=&gt; BigInt" id="173734">den</a>: <span title="BigInt">BigInt</span> = <a href="#174376" title="=&gt; BigInt">d</a>

    <span class="keyword">def</span> <a title="=&gt; BigInt" id="173735">numerator</a> = <a href="#174375" title="=&gt; BigInt">n</a>
    <span class="keyword">def</span> <a title="=&gt; BigInt" id="173736">denominator</a> = <a href="#174376" title="=&gt; BigInt">d</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="173737">signum</a>: <span title="Int">Int</span> = <a href="#174375" title="=&gt; BigInt">n</a>.<span title="=&gt; Int">signum</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()spire.math.Rational" id="173738">unary_-</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#49262" title="()spire.math.SafeLong">-</a><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(r: spire.math.Rational)spire.math.Rational" id="173739">+</a><span class="delimiter">(</span><a title="spire.math.Rational" id="176691">r</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#176691" title="spire.math.Rational">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#214192" title="spire.math.Rational" id="214193">r</a>: LongRational =&gt; r <a href="#214196" title="(x: spire.math.Rational)spire.math.Rational">+</a> <a href="#177170" title="spire.math.BigRationals.BigRational" class="keyword">this</a>
      <span class="keyword">case</span> <a href="#214192" title="spire.math.Rational" id="214194">r</a>: BigRational =&gt;
        <span class="keyword">val</span> <a title="BigInt" id="176695">dgcd</a>: <span title="BigInt">BigInt</span> = <a href="#174376" title="=&gt; BigInt">d</a>.<span title="(that: scala.math.BigInt)scala.math.BigInt">gcd</span><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>
        <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176695" title="BigInt">dgcd</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="BigInt" id="176724">lden</a>: <span title="BigInt">BigInt</span> = <a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176695" title="BigInt">dgcd</a>
          <span class="keyword">val</span> <a title="BigInt" id="176725">rden</a>: <span title="BigInt">BigInt</span> = r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176695" title="BigInt">dgcd</a>
          <span class="keyword">val</span> <a title="BigInt" id="176726">num</a>: <span title="BigInt">BigInt</span> = <a href="#176725" title="BigInt">rden</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#176724" title="BigInt">lden</a>
          <span class="keyword">val</span> <a title="BigInt" id="176727">ngcd</a>: <span title="BigInt">BigInt</span> = <a href="#176726" title="BigInt">num</a>.<span title="(that: scala.math.BigInt)scala.math.BigInt">gcd</span><span class="delimiter">(</span><a href="#176695" title="BigInt">dgcd</a><span class="delimiter">)</span>
          <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176727" title="BigInt">ngcd</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#176726" title="BigInt">num</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#176724" title="BigInt">lden</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#176726" title="BigInt">num</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176727" title="BigInt">ngcd</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176727" title="BigInt">ngcd</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <a href="#176724" title="BigInt">lden</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>


    <span class="keyword">def</span> <a title="(r: spire.math.Rational)spire.math.Rational" id="173740">-</a><span class="delimiter">(</span><a title="spire.math.Rational" id="176784">r</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#176784" title="spire.math.Rational">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#214201" title="spire.math.Rational" id="214202">r</a>: LongRational =&gt; <span class="delimiter">(</span><a href="#173651" title="()spire.math.Rational">-</a>r<span class="delimiter">)</span> <a href="#214205" title="(x: spire.math.Rational)spire.math.Rational">+</a> <a href="#177170" title="spire.math.BigRationals.BigRational" class="keyword">this</a>
      <span class="keyword">case</span> <a href="#214201" title="spire.math.Rational" id="214203">r</a>: BigRational =&gt;
        <span class="keyword">val</span> <a title="BigInt" id="176788">dgcd</a>: <span title="BigInt">BigInt</span> = <a href="#174376" title="=&gt; BigInt">d</a>.<span title="(that: scala.math.BigInt)scala.math.BigInt">gcd</span><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>
        <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176788" title="BigInt">dgcd</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">-</span> r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="BigInt" id="176817">lden</a>: <span title="BigInt">BigInt</span> = <a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176788" title="BigInt">dgcd</a>
          <span class="keyword">val</span> <a title="BigInt" id="176818">rden</a>: <span title="BigInt">BigInt</span> = r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176788" title="BigInt">dgcd</a>
          <span class="keyword">val</span> <a title="BigInt" id="176819">num</a>: <span title="BigInt">BigInt</span> = <a href="#176818" title="BigInt">rden</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">-</span> r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#176817" title="BigInt">lden</a>
          <span class="keyword">val</span> <a title="BigInt" id="176820">ngcd</a>: <span title="BigInt">BigInt</span> = <a href="#176819" title="BigInt">num</a>.<span title="(that: scala.math.BigInt)scala.math.BigInt">gcd</span><span class="delimiter">(</span><a href="#176788" title="BigInt">dgcd</a><span class="delimiter">)</span>
          <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176820" title="BigInt">ngcd</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#176819" title="BigInt">num</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#176817" title="BigInt">lden</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#176819" title="BigInt">num</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176820" title="BigInt">ngcd</a><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176820" title="BigInt">ngcd</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <a href="#176817" title="BigInt">lden</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>


    <span class="keyword">def</span> <a title="(r: spire.math.Rational)spire.math.Rational" id="173741">*</a><span class="delimiter">(</span><a title="spire.math.Rational" id="176877">r</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#176877" title="spire.math.Rational">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#214210" title="spire.math.Rational" id="214211">r</a>: LongRational =&gt; r <a href="#214214" title="(x: spire.math.Rational)spire.math.Rational">*</a> <a href="#177170" title="spire.math.BigRationals.BigRational" class="keyword">this</a>
      <span class="keyword">case</span> <a href="#214210" title="spire.math.Rational" id="214212">r</a>: BigRational =&gt;
        <span class="keyword">val</span> <a title="scala.math.BigInt" id="176881">a</a> = <a href="#174375" title="=&gt; BigInt">n</a>.<span title="(that: scala.math.BigInt)scala.math.BigInt">gcd</span><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="scala.math.BigInt" id="176882">b</a> = <a href="#174376" title="=&gt; BigInt">d</a>.<span title="(that: scala.math.BigInt)scala.math.BigInt">gcd</span><span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span>
        <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176881" title="scala.math.BigInt">a</a><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176882" title="scala.math.BigInt">b</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176882" title="scala.math.BigInt">b</a><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176881" title="scala.math.BigInt">a</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    

    <span class="keyword">def</span> <a title="(r: spire.math.Rational)spire.math.Rational" id="173742">/</a><span class="delimiter">(</span><a title="spire.math.Rational" id="176907">r</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <a href="#176907" title="spire.math.Rational">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#214219" title="spire.math.Rational" id="214220">r</a>: LongRational =&gt; r.<a href="#58160" title="=&gt; spire.math.Rational">inverse</a> <a href="#214223" title="(x: spire.math.Rational)spire.math.Rational">*</a> <a href="#177170" title="spire.math.BigRationals.BigRational" class="keyword">this</a>
      <span class="keyword">case</span> <a href="#214219" title="spire.math.Rational" id="214221">r</a>: BigRational =&gt;
        <span class="keyword">val</span> <a title="scala.math.BigInt" id="176911">a</a> = <a href="#174375" title="=&gt; BigInt">n</a>.<span title="(that: scala.math.BigInt)scala.math.BigInt">gcd</span><span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="scala.math.BigInt" id="176912">b</a> = <a href="#174376" title="=&gt; BigInt">d</a>.<span title="(that: scala.math.BigInt)scala.math.BigInt">gcd</span><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="spire.math.SafeLong" id="176913">num</a> = <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176911" title="scala.math.BigInt">a</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176912" title="scala.math.BigInt">b</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="spire.math.SafeLong" id="176914">den</a> = <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176912" title="scala.math.BigInt">b</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#176911" title="scala.math.BigInt">a</a><span class="delimiter">)</span>
        <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176914" title="spire.math.SafeLong">den</a> <span title="(that: spire.math.SafeLong)Boolean">&lt;</span> <a href="SafeLong.scala.html#15411" title="spire.math.SafeLong.type">SafeLong</a>.<a href="SafeLong.scala.html#86131" title="=&gt; spire.math.SafeLong">zero</a><span class="delimiter">)</span> <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="SafeLong.scala.html#49262" title="()spire.math.SafeLong">-</a><a href="#176913" title="spire.math.SafeLong">num</a>, <a href="SafeLong.scala.html#49262" title="()spire.math.SafeLong">-</a><a href="#176914" title="spire.math.SafeLong">den</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#84811" title="(n: spire.math.SafeLong, d: spire.math.SafeLong)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#176913" title="spire.math.SafeLong">num</a>, <a href="#176914" title="spire.math.SafeLong">den</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="=&gt; spire.math.Rational" id="173743">round</a>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.math.BigInt" id="176958">m</a> = <span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> <a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>.<span title="=&gt; scala.math.BigInt">abs</span>
      <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176958" title="scala.math.BigInt">m</a> <span title="(that: scala.math.BigInt)Boolean">&gt;=</span> <span class="delimiter">(</span><a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">-</span> <a href="#176958" title="scala.math.BigInt">m</a><span class="delimiter">)</span>.<span title="=&gt; scala.math.BigInt">abs</span><span class="delimiter">)</span> <a href="#84817" title="implicit spire.math.Rational.apply : (x: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">1</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#84817" title="implicit spire.math.Rational.apply : (x: BigInt)spire.math.Rational">Rational</a><span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(exp: Int)spire.math.Rational" id="173744">pow</a><span class="delimiter">(</span><a title="Int" id="176980">exp</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#15737" title="spire.math.Rational">Rational</a> = <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176980" title="Int">exp</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#174779" title="spire.math.Rational.type">Rational</a>.<a href="#84809" title="=&gt; spire.math.Rational">one</a>
    <span class="keyword">else</span> <span title="spire.math.Rational" class="keyword">if</span> <span class="delimiter">(</span><a href="#176980" title="Int">exp</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.<a href="#173516" title="(n: BigInt, d: BigInt)spire.math.Rational">build</a><span class="delimiter">(</span><a href="#174376" title="=&gt; BigInt">d</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <span title="=&gt; Int">-</span><a href="#176980" title="Int">exp</a>, <a href="#174375" title="=&gt; BigInt">n</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <span title="=&gt; Int">-</span><a href="#176980" title="Int">exp</a><span class="delimiter">)</span>
    <span class="keyword">else</span>
      <a href="#15144" title="spire.math.BigRationals.type">BigRationals</a>.<a href="#173516" title="(n: BigInt, d: BigInt)spire.math.Rational">build</a><span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#176980" title="Int">exp</a>, <a href="#174376" title="=&gt; BigInt">d</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <a href="#176980" title="Int">exp</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="()spire.math.Rational" id="173745">log</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#84819" title="implicit spire.math.Rational.apply : (x: BigDecimal)spire.math.Rational">Rational</a><span class="delimiter">(</span>spire.math.<a href="../package.scala.html#16994" title="(n: BigDecimal)BigDecimal">log</a><span class="delimiter">(</span><span title="(x: scala.math.BigInt)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(that: scala.math.BigDecimal)scala.math.BigDecimal">-</span> spire.math.<a href="../package.scala.html#16994" title="(n: BigDecimal)BigDecimal">log</a><span class="delimiter">(</span><span title="(x: scala.math.BigInt)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="=&gt; Int" id="173746">compareToOne</a>: <span title="Int">Int</span> = <a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)Int">compare</span> <a href="#174376" title="=&gt; BigInt">d</a>

    <span class="keyword">def</span> <a title="(r: spire.math.Rational)Int" id="173747">compare</a><span class="delimiter">(</span><a title="spire.math.Rational" id="177027">r</a>: <a href="#15737" title="spire.math.Rational">Rational</a><span class="delimiter">)</span>: <span title="Int">Int</span> = <a href="#177027" title="spire.math.Rational">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#214228" title="Int" id="214229">r</a>: LongRational =&gt; <a href="#214232" title="(x: Int)Int" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="Long" id="177031">dgcd</a> = <a href="../package.scala.html#17007" title="(_x: Long, _y: Long)Long">gcd</a><span class="delimiter">(</span>r.<a href="#174122" title="=&gt; Long">d</a>, <span class="delimiter">(</span><a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">%</span> r.<a href="#174122" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">d</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>
        <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#177031" title="Long">dgcd</a> <span title="(x: Long)Boolean">==</span> <span title="Long(1L)" class="long">1L</span><span class="delimiter">)</span>
          <span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> r.<a href="#174122" title="=&gt; Long">d</a> <a href="SafeLong.scala.html#49224" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>.<a href="SafeLong.scala.html#49222" title="=&gt; Int">signum</a>
        <span class="keyword">else</span>
          <span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49235" title="(rhs: Long)spire.math.SafeLong">*</a> <span class="delimiter">(</span>r.<a href="#174122" title="=&gt; Long">d</a> <span title="(x: Long)Long">/</span> <a href="#177031" title="Long">dgcd</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49224" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="SafeLong.scala.html#86135" title="implicit spire.math.SafeLong.apply : (x: Long)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174121" title="=&gt; Long">n</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <span class="delimiter">(</span><a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#177031" title="implicit scala.math.BigInt.long2bigInt : (l: Long)scala.math.BigInt">dgcd</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="SafeLong.scala.html#49222" title="=&gt; Int">signum</a>
      <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#214228" title="Int" id="214230">r</a>: BigRational =&gt; <a href="#214232" title="(x: Int)Int" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="scala.math.BigInt" id="177101">dgcd</a> = <a href="#174376" title="=&gt; BigInt">d</a>.<span title="(that: scala.math.BigInt)scala.math.BigInt">gcd</span><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>
        <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#177101" title="scala.math.BigInt">dgcd</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
          <span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> r.<a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49243" title="(rhs: BigInt)spire.math.SafeLong">-</a> r.<a href="#174375" title="=&gt; BigInt">n</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#174376" title="=&gt; BigInt">d</a><span class="delimiter">)</span>.<a href="SafeLong.scala.html#49222" title="=&gt; Int">signum</a>
        <span class="keyword">else</span>
          <span class="delimiter">(</span><a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span>r.<a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#177101" title="scala.math.BigInt">dgcd</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> <a href="#174375" title="=&gt; BigInt">n</a> <a href="SafeLong.scala.html#49224" title="(rhs: spire.math.SafeLong)spire.math.SafeLong">-</a> <a href="SafeLong.scala.html#86136" title="implicit spire.math.SafeLong.apply : (x: BigInt)spire.math.SafeLong">SafeLong</a><span class="delimiter">(</span><a href="#174376" title="=&gt; BigInt">d</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">/</span> <a href="#177101" title="scala.math.BigInt">dgcd</a><span class="delimiter">)</span> <a href="SafeLong.scala.html#49244" title="(rhs: BigInt)spire.math.SafeLong">*</a> r.<a href="#174375" title="=&gt; BigInt">n</a><span class="delimiter">)</span>.<a href="SafeLong.scala.html#49222" title="=&gt; Int">signum</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>spire/spire/math/real/BMFSSBound.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> spire.math.real

<span class="keyword">import</span> spire.math._
<span class="keyword">import</span> spire.algebra._
<span class="keyword">import</span> spire.<a href="../../package.scala.html#7310" title="spire.implicits.type">implicits</a>._

/**
 * A mixin for the SeparationBound that implements the BMFSS bound.
 */
<span class="keyword">trait</span> <a title="trait BMFSSBound[A &lt;: spire.math.real.BMFSSBound[A]] extends scala.math.ScalaNumber with spire.math.real.SeparationBound[A]" id="16598">BMFSSBound</a><span class="delimiter">[</span><a title=" &lt;: spire.math.real.BMFSSBound[A]" id="16745">A</a> &lt;: BMFSSBound<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> <span title="Unit" class="keyword">extends</span> <a href="SeparationBound.scala.html#16682" title="spire.math.real.SeparationBound[A]">SeparationBound</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span> self: A =&gt;
  
  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="BigInt" id="58089">l</a>: <span title="BigInt">BigInt</span> = <a href="#16598" title="A" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="Expr.scala.html#186706" title="Option[Int]" id="214574">IntLit</a><a href="#214570" title="BigInt" class="delimiter">(</a><a title="Int" id="214555">_</a><span class="delimiter">)</span> | <a href="Expr.scala.html#186730" title="Option[BigInt]" id="214576">BigIntLit</a><span class="delimiter">(</span><a title="BigInt" id="214557">_</a><span class="delimiter">)</span> =&gt; <span title="(i: Int)scala.math.BigInt">BigInt</span><a href="#214566" title="(x: BigInt)BigInt" class="delimiter">(</a><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="Expr.scala.html#186762" title="Option[(A, Int)]" id="214578">KRoot</a><span class="delimiter">(</span><a title="A" id="186782">a</a>, <a title="Int" id="186783">k</a><span class="delimiter">)</span> =&gt; <a href="#214566" title="(x: BigInt)BigInt" class="keyword">if</a> <span class="delimiter">(</span><a href="#186782" title="A">a</a>.<a href="#58090" title="=&gt; BigInt">u</a> <span title="(that: scala.math.BigInt)Boolean">&lt;</span> <a href="#186782" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a><span class="delimiter">)</span> <a href="../../algebra/NRoot.scala.html#55677" title="[A](implicit ev: spire.algebra.NRoot[A])spire.algebra.NRoot[A]">NRoot</a><a href="../../algebra/NRoot.scala.html#55684" title="(implicit ev: spire.algebra.NRoot[BigInt])spire.algebra.NRoot[BigInt]" class="delimiter">[</a><span title="BigInt">BigInt</span><span class="delimiter">]</span>.<a href="../../algebra/NRoot.scala.html#32059" title="(a: BigInt, n: Int)BigInt">nroot</a><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#186782" title="A">a</a>.<a href="#58090" title="=&gt; BigInt">u</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <span class="delimiter">(</span><a href="#186783" title="Int">k</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#186782" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a><span class="delimiter">)</span>, <a href="#186783" title="Int">k</a><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">1</span> <span class="keyword">else</span> <a href="#186782" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186800" title="Option[(A, A)]" id="214580">Add</a><span class="delimiter">(</span><a title="A" id="186820">a</a>, <a title="A" id="186821">b</a><span class="delimiter">)</span> =&gt; <a href="#186820" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a> <a href="#214566" title="(x: BigInt)BigInt">*</a> <a href="#186821" title="A">b</a>.<a href="#58088" title="=&gt; BigInt">l</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186826" title="Option[(A, A)]" id="214582">Sub</a><span class="delimiter">(</span><a title="A" id="186846">a</a>, <a title="A" id="186847">b</a><span class="delimiter">)</span> =&gt; <a href="#186846" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a> <a href="#214566" title="(x: BigInt)BigInt">*</a> <a href="#186847" title="A">b</a>.<a href="#58088" title="=&gt; BigInt">l</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186852" title="Option[(A, A)]" id="214584">Mul</a><span class="delimiter">(</span><a title="A" id="186872">a</a>, <a title="A" id="186873">b</a><span class="delimiter">)</span> =&gt; <a href="#186872" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a> <a href="#214566" title="(x: BigInt)BigInt">*</a> <a href="#186873" title="A">b</a>.<a href="#58088" title="=&gt; BigInt">l</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186878" title="Option[(A, A)]" id="214586">Div</a><span class="delimiter">(</span><a title="A" id="186898">a</a>, <a title="A" id="186899">b</a><span class="delimiter">)</span> =&gt; <a href="#186898" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a> <a href="#214566" title="(x: BigInt)BigInt">*</a> <a href="#186899" title="A">b</a>.<a href="#58090" title="=&gt; BigInt">u</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186904" title="Option[A]" id="214588">Neg</a><span class="delimiter">(</span><a title="A" id="186924">a</a><span class="delimiter">)</span> =&gt; <a href="#186924" title="A">a</a>.<a href="#214566" title="(x: BigInt)BigInt">l</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="BigInt" id="58091">u</a>: <span title="BigInt">BigInt</span> = <a href="#16598" title="A" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="Expr.scala.html#186706" title="Option[Int]" id="214613">IntLit</a><span class="delimiter">(</span><a title="Int" id="186938">n</a><span class="delimiter">)</span> =&gt; <span title="(i: Int)scala.math.BigInt">BigInt</span><span class="delimiter">(</span><a href="#186938" title="Int">n</a><span class="delimiter">)</span>.<a href="#214609" title="(x: BigInt)BigInt">abs</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186730" title="Option[BigInt]" id="214615">BigIntLit</a><span class="delimiter">(</span><a title="BigInt" id="186960">n</a><span class="delimiter">)</span> =&gt; <a href="#186960" title="BigInt">n</a>.<a href="#214609" title="(x: BigInt)BigInt">abs</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186762" title="Option[(A, Int)]" id="214617">KRoot</a><span class="delimiter">(</span><a title="A" id="186974">a</a>, <a title="Int" id="186975">k</a><span class="delimiter">)</span> =&gt; <a href="#214609" title="(x: BigInt)BigInt" class="keyword">if</a> <span class="delimiter">(</span><a href="#186974" title="A">a</a>.<a href="#58090" title="=&gt; BigInt">u</a> <span title="(that: scala.math.BigInt)Boolean">&gt;=</span> <a href="#186974" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a><span class="delimiter">)</span> <a href="../../algebra/NRoot.scala.html#55677" title="[A](implicit ev: spire.algebra.NRoot[A])spire.algebra.NRoot[A]">NRoot</a><a href="../../algebra/NRoot.scala.html#55684" title="(implicit ev: spire.algebra.NRoot[BigInt])spire.algebra.NRoot[BigInt]" class="delimiter">[</a><span title="BigInt">BigInt</span><span class="delimiter">]</span>.<a href="../../algebra/NRoot.scala.html#32059" title="(a: BigInt, n: Int)BigInt">nroot</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#186974" title="A">a</a>.<a href="#58090" title="=&gt; BigInt">u</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <span class="delimiter">(</span><a href="#186974" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <span class="delimiter">(</span><a href="#186975" title="Int">k</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#186975" title="Int">k</a><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">+</span> <span title="implicit scala.math.BigInt.int2bigInt : (i: Int)scala.math.BigInt" class="int">1</span> <span class="keyword">else</span> <a href="#186974" title="A">a</a>.<a href="#58090" title="=&gt; BigInt">u</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186800" title="Option[(A, A)]" id="214619">Add</a><span class="delimiter">(</span><a title="A" id="186999">a</a>, <a title="A" id="187000">b</a><span class="delimiter">)</span> =&gt; <a href="#186999" title="A">a</a>.<a href="#58090" title="=&gt; BigInt">u</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#187000" title="A">b</a>.<a href="#58088" title="=&gt; BigInt">l</a> <a href="#214609" title="(x: BigInt)BigInt">+</a> <a href="#186999" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#187000" title="A">b</a>.<a href="#58090" title="=&gt; BigInt">u</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186826" title="Option[(A, A)]" id="214621">Sub</a><span class="delimiter">(</span><a title="A" id="187014">a</a>, <a title="A" id="187015">b</a><span class="delimiter">)</span> =&gt; <a href="#187014" title="A">a</a>.<a href="#58090" title="=&gt; BigInt">u</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#187015" title="A">b</a>.<a href="#58088" title="=&gt; BigInt">l</a> <a href="#214609" title="(x: BigInt)BigInt">+</a> <a href="#187014" title="A">a</a>.<a href="#58088" title="=&gt; BigInt">l</a> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#187015" title="A">b</a>.<a href="#58090" title="=&gt; BigInt">u</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186852" title="Option[(A, A)]" id="214623">Mul</a><span class="delimiter">(</span><a title="A" id="187029">a</a>, <a title="A" id="187030">b</a><span class="delimiter">)</span> =&gt; <a href="#187029" title="A">a</a>.<a href="#58090" title="=&gt; BigInt">u</a> <a href="#214609" title="(x: BigInt)BigInt">*</a> <a href="#187030" title="A">b</a>.<a href="#58090" title="=&gt; BigInt">u</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186878" title="Option[(A, A)]" id="214625">Div</a><span class="delimiter">(</span><a title="A" id="187044">a</a>, <a title="A" id="187045">b</a><span class="delimiter">)</span> =&gt; <a href="#187044" title="A">a</a>.<a href="#58090" title="=&gt; BigInt">u</a> <a href="#214609" title="(x: BigInt)BigInt">*</a> <a href="#187045" title="A">b</a>.<a href="#58088" title="=&gt; BigInt">l</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186904" title="Option[A]" id="214627">Neg</a><span class="delimiter">(</span><a title="A" id="187059">a</a><span class="delimiter">)</span> =&gt; <a href="#187059" title="A">a</a>.<a href="#214609" title="(x: BigInt)BigInt">u</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Int" id="58093">weight</a>: <span title="Int">Int</span> = <a href="#16598" title="A" class="keyword">this</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="Expr.scala.html#186706" title="Option[Int]" id="214658">IntLit</a><a href="#214654" title="Int" class="delimiter">(</a><a title="Int" id="214639">_</a><span class="delimiter">)</span> | <a href="Expr.scala.html#186730" title="Option[BigInt]" id="214660">BigIntLit</a><span class="delimiter">(</span><a title="BigInt" id="214641">_</a><span class="delimiter">)</span> =&gt; <a href="#214650" title="(x: Int)Int" class="int">1</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186904" title="Option[A]" id="214662">Neg</a><span class="delimiter">(</span><a title="A" id="187099">a</a><span class="delimiter">)</span> =&gt; <a href="#187099" title="A">a</a>.<a href="#214650" title="(x: Int)Int">weight</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186762" title="Option[(A, Int)]" id="214664">KRoot</a><span class="delimiter">(</span><a title="A" id="187113">a</a>, <a title="Int" id="187114">k</a><span class="delimiter">)</span> =&gt; <a href="#187114" title="Int">k</a> <a href="#214650" title="(x: Int)Int">*</a> <a href="#187113" title="A">a</a>.<a href="#58092" title="=&gt; Int">weight</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186800" title="Option[(A, A)]" id="214666">Add</a><span class="delimiter">(</span><a title="A" id="187132">a</a>, <a title="A" id="187133">b</a><span class="delimiter">)</span> =&gt; <a href="#187132" title="A">a</a>.<a href="#58092" title="=&gt; Int">weight</a> <a href="#214650" title="(x: Int)Int">*</a> <a href="#187133" title="A">b</a>.<a href="#58092" title="=&gt; Int">weight</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186826" title="Option[(A, A)]" id="214668">Sub</a><span class="delimiter">(</span><a title="A" id="187151">a</a>, <a title="A" id="187152">b</a><span class="delimiter">)</span> =&gt; <a href="#187151" title="A">a</a>.<a href="#58092" title="=&gt; Int">weight</a> <a href="#214650" title="(x: Int)Int">*</a> <a href="#187152" title="A">b</a>.<a href="#58092" title="=&gt; Int">weight</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186852" title="Option[(A, A)]" id="214670">Mul</a><span class="delimiter">(</span><a title="A" id="187170">a</a>, <a title="A" id="187171">b</a><span class="delimiter">)</span> =&gt; <a href="#187170" title="A">a</a>.<a href="#58092" title="=&gt; Int">weight</a> <a href="#214650" title="(x: Int)Int">*</a> <a href="#187171" title="A">b</a>.<a href="#58092" title="=&gt; Int">weight</a>
    <span class="keyword">case</span> <a href="Expr.scala.html#186878" title="Option[(A, A)]" id="214672">Div</a><span class="delimiter">(</span><a title="A" id="187189">a</a>, <a title="A" id="187190">b</a><span class="delimiter">)</span> =&gt; <a href="#187189" title="A">a</a>.<a href="#58092" title="=&gt; Int">weight</a> <a href="#214650" title="(x: Int)Int">*</a> <a href="#187190" title="A">b</a>.<a href="#58092" title="=&gt; Int">weight</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="58094">lowerBound</a>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.math.BigInt" id="187199">d</a> = <span class="delimiter">(</span><a href="#58090" title="=&gt; BigInt">u</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <span class="delimiter">(</span><a href="#58092" title="=&gt; Int">weight</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#58088" title="=&gt; BigInt">l</a>
    <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#187199" title="scala.math.BigInt">d</a> <span title="(x$1: Any)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> <span class="keyword">else</span> <span title="=&gt; Int">-</span><a href="#187199" title="scala.math.BigInt">d</a>.<span title="=&gt; Int">bitLength</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="58095">upperBound</a>: <span title="Int">Int</span> = <span class="delimiter">(</span><span class="delimiter">(</span><a href="#58088" title="=&gt; BigInt">l</a> <span title="(exp: Int)scala.math.BigInt">pow</span> <span class="delimiter">(</span><a href="#58092" title="=&gt; Int">weight</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(that: scala.math.BigInt)scala.math.BigInt">*</span> <a href="#58090" title="=&gt; BigInt">u</a><span class="delimiter">)</span>.<span title="=&gt; Int">bitLength</span>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>
<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>main/org/squeryl/internals/FieldReferenceLinker.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*******************************************************************************
 * Copyright 2010 Maxime LÃ©vesque
 * 
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ***************************************************************************** */</span>
<span class="keyword">package</span> org.squeryl.internals

<span class="keyword">import</span> java.lang.reflect.Method
<span class="keyword">import</span> net.sf.cglib.proxy._
<span class="keyword">import</span> collection.mutable.<span class="delimiter">{</span>HashSet, ArrayBuffer<span class="delimiter">}</span>
<span class="keyword">import</span> org.squeryl.dsl.ast._
<span class="keyword">import</span> org.squeryl.dsl.CompositeKey
<span class="keyword">import</span> java.lang.reflect.<span class="delimiter">{</span>Field, Method<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object org.squeryl.internals.FieldReferenceLinker" id="10755">FieldReferenceLinker</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[T](e: () =&gt; org.squeryl.dsl.ast.TypedExpressionNode[T])T" id="18196">pushExpressionOrCollectValue</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="18198">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="() =&gt; org.squeryl.dsl.ast.TypedExpressionNode[T]" id="76437">e</a>: <span class="delimiter">(</span><span class="delimiter">)</span>=&gt;TypedExpressionNode<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#18198" title="T">T</a> = <span class="delimiter">{</span>
    <span title="T" class="keyword">if</span> <span class="delimiter">(</span><a href="#18200" title="=&gt; Boolean">isYieldInspectionMode</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="org.squeryl.internals.FieldReferenceLinker.YieldInspection" id="97956">yi</a> = <a href="#18214" title="=&gt; java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]">_yieldInspectionTL</a>.<span title="()org.squeryl.internals.FieldReferenceLinker.YieldInspection">get</span>
      <span class="keyword">val</span> <a title="org.squeryl.dsl.ast.TypedExpressionNode[T]" id="97957">expr</a> = <a href="#97956" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90852" title="(f: () =&gt; org.squeryl.dsl.ast.TypedExpressionNode[T])org.squeryl.dsl.ast.TypedExpressionNode[T]">callWithoutReentrance</a><span class="delimiter">(</span><a href="#76437" title="() =&gt; org.squeryl.dsl.ast.TypedExpressionNode[T]">e</a><span class="delimiter">)</span>
      <a href="#97956" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90855" title="(e: org.squeryl.dsl.ast.SelectElement)Unit">addSelectElement</a><span class="delimiter">(</span><span title="org.squeryl.dsl.ast.ValueSelectElement" class="keyword">new</span> <a href="../dsl/ast/SelectElement.scala.html#10346" title="org.squeryl.dsl.ast.ValueSelectElement">ValueSelectElement</a><span class="delimiter">(</span><a href="#97957" title="org.squeryl.dsl.ast.TypedExpressionNode[T]">expr</a>, <a href="#97956" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90856" title="=&gt; org.squeryl.internals.ResultSetMapper">resultSetMapper</a>, <a href="#97957" title="org.squeryl.dsl.ast.TypedExpressionNode[T]">expr</a>.<a href="../dsl/ast/ExpressionNode.scala.html#18111" title="=&gt; org.squeryl.internals.OutMapper[T]">mapper</a>, <a href="#97956" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90846" title="=&gt; org.squeryl.dsl.ast.QueryExpressionNode[_]">queryExpressionNode</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="T" id="97958">r</a> = <a href="#97957" title="org.squeryl.dsl.ast.TypedExpressionNode[T]">expr</a>.<a href="../dsl/ast/ExpressionNode.scala.html#18110" title="=&gt; T">sample</a>
      <a href="#97958" title="T">r</a>
    <span class="delimiter">}</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="T" id="97974">r</a> = <a href="#18202" title="=&gt; java.lang.ThreadLocal[scala.collection.mutable.ArrayBuffer[AnyRef]]">_yieldValues</a>.<span title="()scala.collection.mutable.ArrayBuffer[AnyRef]">get</span>.<span title="(n: Int)AnyRef">remove</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="T" class="delimiter">[</span><a href="#18198" title="T">T</a><span class="delimiter">]</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#18202" title="=&gt; java.lang.ThreadLocal[scala.collection.mutable.ArrayBuffer[AnyRef]]">_yieldValues</a>.<span title="()scala.collection.mutable.ArrayBuffer[AnyRef]">get</span>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#18202" title="=&gt; java.lang.ThreadLocal[scala.collection.mutable.ArrayBuffer[AnyRef]]">_yieldValues</a>.<span title="()Unit">remove</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#97974" title="T">r</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(v: AnyRef)Unit" id="18199">pushYieldValue</a><span class="delimiter">(</span><a title="AnyRef" id="97998">v</a>:<span title="AnyRef">AnyRef</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="scala.collection.mutable.ArrayBuffer[AnyRef]" id="98001">a</a> = <a href="#18202" title="=&gt; java.lang.ThreadLocal[scala.collection.mutable.ArrayBuffer[AnyRef]]">_yieldValues</a>.<span title="()scala.collection.mutable.ArrayBuffer[AnyRef]">get</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#98001" title="scala.collection.mutable.ArrayBuffer[AnyRef]">a</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#98001" title="scala.collection.mutable.ArrayBuffer[AnyRef]">a</a> = <span title="()scala.collection.mutable.ArrayBuffer[AnyRef]" class="keyword">new</span> <span title="scala.collection.mutable.ArrayBuffer[AnyRef]">ArrayBuffer</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span>
      <a href="#18202" title="=&gt; java.lang.ThreadLocal[scala.collection.mutable.ArrayBuffer[AnyRef]]">_yieldValues</a>.<span title="(x$1: scala.collection.mutable.ArrayBuffer[AnyRef])Unit">set</span><span class="delimiter">(</span><a href="#98001" title="scala.collection.mutable.ArrayBuffer[AnyRef]">a</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#98001" title="scala.collection.mutable.ArrayBuffer[AnyRef]">a</a>.<span title="(elems: AnyRef*)Unit">append</span><span class="delimiter">(</span><a href="#97998" title="AnyRef">v</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="18200">isYieldInspectionMode</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.squeryl.internals.FieldReferenceLinker.YieldInspection" id="90838">yi</a> = <a href="#18214" title="=&gt; java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]">_yieldInspectionTL</a>.<span title="()org.squeryl.internals.FieldReferenceLinker.YieldInspection">get</span>
    <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#90838" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#90838" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90851" title="=&gt; Boolean">isOn</a>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#18214" title="=&gt; java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]">_yieldInspectionTL</a>.<span title="()Unit">remove</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; org.squeryl.dsl.ast.QueryExpressionNode[_]" id="18201">inspectedQueryExpressionNode</a> = <a href="#18214" title="=&gt; java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]">_yieldInspectionTL</a>.<span title="()org.squeryl.internals.FieldReferenceLinker.YieldInspection">get</span>.<a href="#90846" title="=&gt; org.squeryl.dsl.ast.QueryExpressionNode[_]">queryExpressionNode</a>
  
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.ThreadLocal[scala.collection.mutable.ArrayBuffer[AnyRef]]" id="18202">_yieldValues</a> = <span title="java.lang.ThreadLocal[scala.collection.mutable.ArrayBuffer[AnyRef]]" class="keyword">new</span> <span title="java.lang.ThreadLocal[scala.collection.mutable.ArrayBuffer[AnyRef]]">ThreadLocal</span><span class="delimiter">[</span>ArrayBuffer<span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">]</span>
  
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.ThreadLocal[Option[org.squeryl.dsl.ast.SelectElement]]" id="18204">__lastAccessedFieldReference</a> = <span title="java.lang.ThreadLocal[Option[org.squeryl.dsl.ast.SelectElement]]" class="keyword">new</span> <span title="java.lang.ThreadLocal[Option[org.squeryl.dsl.ast.SelectElement]]">ThreadLocal</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>SelectElement<span class="delimiter">]</span><span class="delimiter">]</span>

  <span class="keyword">private</span> <span class="delimiter">[</span>squeryl<span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; Option[org.squeryl.dsl.ast.SelectElement]" id="18206">_lastAccessedFieldReference</a>: <span title="Option[org.squeryl.dsl.ast.SelectElement]">Option</span><span class="delimiter">[</span>SelectElement<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Option[org.squeryl.dsl.ast.SelectElement]" id="98016">fr</a> = <a href="#18204" title="=&gt; java.lang.ThreadLocal[Option[org.squeryl.dsl.ast.SelectElement]]">__lastAccessedFieldReference</a>.<span title="()Option[org.squeryl.dsl.ast.SelectElement]">get</span>
    <span title="Option[org.squeryl.dsl.ast.SelectElement]" class="keyword">if</span> <span class="delimiter">(</span><a href="#98016" title="Option[org.squeryl.dsl.ast.SelectElement]">fr</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="object None">None</span> <span class="keyword">else</span> <a href="#98016" title="Option[org.squeryl.dsl.ast.SelectElement]">fr</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="delimiter">[</span>squeryl<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(se: Option[org.squeryl.dsl.ast.SelectElement])Unit" id="18207">_lastAccessedFieldReference_=</a><span class="delimiter">(</span><a title="Option[org.squeryl.dsl.ast.SelectElement]" id="90881">se</a>: <span title="Option[org.squeryl.dsl.ast.SelectElement]">Option</span><span class="delimiter">[</span>SelectElement<span class="delimiter">]</span><span class="delimiter">)</span> =
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90881" title="Option[org.squeryl.dsl.ast.SelectElement]">se</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="object None">None</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#18204" title="=&gt; java.lang.ThreadLocal[Option[org.squeryl.dsl.ast.SelectElement]]">__lastAccessedFieldReference</a>.<span title="()Unit">remove</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#18204" title="=&gt; java.lang.ThreadLocal[Option[org.squeryl.dsl.ast.SelectElement]]">__lastAccessedFieldReference</a>.<span title="(x$1: Option[org.squeryl.dsl.ast.SelectElement])Unit">set</span><span class="delimiter">(</span><a href="#90881" title="Option[org.squeryl.dsl.ast.SelectElement]">se</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.ThreadLocal[Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]]" id="18208">_compositeKeyMembers</a> = <span title="java.lang.ThreadLocal[Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]]" class="keyword">new</span> <span title="java.lang.ThreadLocal[Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]]">ThreadLocal</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>ArrayBuffer<span class="delimiter">[</span>SelectElement<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>

  <span class="comment">/**
   * _lastAccessedFieldReference is unique per thread, AST construction can be nested and can interfere with
   * one another, this method is used for  preserving the previous _lastAccessedFieldReference when a nested
   * AST construction takes place *and* during the construction of 'sample' POSOs, because they are proxied,
   * and can call their intercepted fields during construction, calling the constructor for 'sample' POSO construction
   * without wrapping with this methor would have the effect of 'polluting' the _lastAccessedFieldReference (issue 68). 
   */</span>
  <span class="keyword">def</span> <a title="[A](expressionWithSideEffectsASTConstructionThreadLocalState: =&gt; A)A" id="18210">executeAndRestoreLastAccessedFieldReference</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="18212">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="63156">expressionWithSideEffectsASTConstructionThreadLocalState</a>: =&gt;A<span class="delimiter">)</span>: <a href="#18212" title="A">A</a> = <span class="delimiter">{</span>
    <span class="comment">// if we are currently building an AST, we must save the (last) _lastAccessedFieldReference</span>
    <span class="keyword">val</span> <a title="Option[org.squeryl.dsl.ast.SelectElement]" id="98021">prev</a> = <a href="#10755" title="object org.squeryl.internals.FieldReferenceLinker">FieldReferenceLinker</a>.<a href="#18206" title="=&gt; Option[org.squeryl.dsl.ast.SelectElement]">_lastAccessedFieldReference</a>
    <span class="keyword">val</span> <a title="A" id="98022">a</a> = <a href="#63156" title="=&gt; A">expressionWithSideEffectsASTConstructionThreadLocalState</a>
    <span class="comment">// and restore it to the previous state (issue19)</span>
    <a href="#10755" title="object org.squeryl.internals.FieldReferenceLinker">FieldReferenceLinker</a>.<a href="#18207" title="(se: Option[org.squeryl.dsl.ast.SelectElement])Unit">_lastAccessedFieldReference</a> = <a href="#98021" title="Option[org.squeryl.dsl.ast.SelectElement]">prev</a>
    <a href="#98022" title="A">a</a>
  <span class="delimiter">}</span>
  
  <span class="keyword">class</span> <a title="class YieldInspection extends java.lang.Object with ScalaObject" id="18213">YieldInspection</a> <a href="#18213" title="ScalaObject" class="delimiter">{</a>
    
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]" id="90840">_utilizedFields</a> = <span title="()scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]" class="keyword">new</span> <span title="scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]">ArrayBuffer</span><span class="delimiter">[</span>SelectElement<span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="Boolean" id="90843">_on</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">var</span> <a title="org.squeryl.dsl.ast.QueryExpressionNode[_]" id="90846">queryExpressionNode</a>: <a href="../dsl/ast/QueryExpressionNode.scala.html#10333" title="org.squeryl.dsl.ast.QueryExpressionNode[_]">QueryExpressionNode</a><span class="delimiter">[</span>_<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">var</span> <a title="org.squeryl.internals.ResultSetMapper" id="90849">_resultSetMapper</a>: <a href="ResultSetMapper.scala.html#10810" title="org.squeryl.internals.ResultSetMapper">ResultSetMapper</a> = <span title="Null(null)" class="keyword">null</span>

    <span class="keyword">def</span> <a title="=&gt; Boolean" id="90851">isOn</a> = <a href="#90843" title="=&gt; Boolean">_on</a>

    <span class="keyword">def</span> <a title="[U](f: () =&gt; U)U" id="90852">callWithoutReentrance</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="90854">U</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="() =&gt; U" id="97959">f</a>: <span class="delimiter">(</span><span class="delimiter">)</span>=&gt;U<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Boolean" id="97962">prev</a> = <a href="#90843" title="=&gt; Boolean">_on</a>
      <a href="#90843" title="(x$1: Boolean)Unit">_on</a> = <span title="Boolean(false)" class="keyword">false</span>
      <span class="keyword">val</span> <a title="U" id="97963">res</a> = <a href="#97959" title="()U">f</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#90843" title="(x$1: Boolean)Unit">_on</a> = <a href="#97962" title="Boolean">prev</a>
      <a href="#97963" title="U">res</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(e: org.squeryl.dsl.ast.SelectElement)Unit" id="90855">addSelectElement</a><span class="delimiter">(</span><a title="org.squeryl.dsl.ast.SelectElement" id="90872">e</a>: <a href="../dsl/ast/SelectElement.scala.html#10343" title="org.squeryl.dsl.ast.SelectElement">SelectElement</a><span class="delimiter">)</span> =
      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#90872" title="org.squeryl.dsl.ast.SelectElement">e</a>.<a href="../dsl/ast/SelectElement.scala.html#18405" title="=&gt; Boolean">inhibited</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#90840" title="=&gt; scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]">_utilizedFields</a>.<span title="(elems: org.squeryl.dsl.ast.SelectElement*)Unit">append</span><span class="delimiter">(</span><a href="#90872" title="org.squeryl.dsl.ast.SelectElement">e</a><span class="delimiter">)</span>
        <a href="#90872" title="org.squeryl.dsl.ast.SelectElement">e</a>.<a href="../dsl/ast/SelectElement.scala.html#18403" title="(index: Int)Unit">prepareColumnMapper</a><span class="delimiter">(</span><a href="#90840" title="=&gt; scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]">_utilizedFields</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    
    <span class="keyword">def</span> <a title="=&gt; org.squeryl.internals.ResultSetMapper" id="90856">resultSetMapper</a> = <a href="#90849" title="=&gt; org.squeryl.internals.ResultSetMapper">_resultSetMapper</a>

    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="90858">_reentranceDepth</a> = <span title="Int(0)" class="int">0</span>

     <span class="keyword">def</span> <a title="=&gt; Int" id="90860">reentranceDepth</a> = <a href="#90858" title="=&gt; Int">_reentranceDepth</a>

     <span class="keyword">def</span> <a title="=&gt; Unit" id="90861">incrementReentranceDepth</a> =
       <a href="#90858" title="(x$1: Int)Unit">_reentranceDepth</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>

     <span class="keyword">def</span> <a title="=&gt; Unit" id="90862">decrementReentranceDepth</a> =
       <a href="#90858" title="(x$1: Int)Unit">_reentranceDepth</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>

    <span class="keyword">def</span> <a title="(q: org.squeryl.dsl.ast.QueryExpressionNode[_], rsm: org.squeryl.internals.ResultSetMapper)Unit" id="90863">turnOn</a><span class="delimiter">(</span><a title="org.squeryl.dsl.ast.QueryExpressionNode[_]" id="91488">q</a>: <a href="../dsl/ast/QueryExpressionNode.scala.html#10333" title="org.squeryl.dsl.ast.QueryExpressionNode[_]">QueryExpressionNode</a><span class="delimiter">[</span>_<span class="delimiter">]</span>, <a title="org.squeryl.internals.ResultSetMapper" id="91489">rsm</a>: <a href="ResultSetMapper.scala.html#10810" title="org.squeryl.internals.ResultSetMapper">ResultSetMapper</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#90858" title="(x$1: Int)Unit">_reentranceDepth</a> = <span title="Int(0)" class="int">0</span>
      <a href="#90846" title="(x$1: org.squeryl.dsl.ast.QueryExpressionNode[_])Unit">queryExpressionNode</a> = <a href="#91488" title="org.squeryl.dsl.ast.QueryExpressionNode[_]">q</a>
      <a href="#90843" title="(x$1: Boolean)Unit">_on</a> = <span title="Boolean(true)" class="keyword">true</span>
      <a href="#90849" title="(x$1: org.squeryl.internals.ResultSetMapper)Unit">_resultSetMapper</a> = <a href="#91489" title="org.squeryl.internals.ResultSetMapper">rsm</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="=&gt; List[org.squeryl.dsl.ast.SelectElement]" id="90864">outExpressions</a>: <span title="List[org.squeryl.dsl.ast.SelectElement]">List</span><span class="delimiter">[</span>SelectElement<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#90840" title="=&gt; scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]">_utilizedFields</a>.<span title="=&gt; List[org.squeryl.dsl.ast.SelectElement]">toList</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]" id="18214">_yieldInspectionTL</a> = <span title="java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]" class="keyword">new</span> <span title="java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]">ThreadLocal</span><span class="delimiter">[</span>YieldInspection<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(e: org.squeryl.dsl.ast.SelectElement)Unit" id="18216">putLastAccessedSelectElement</a><span class="delimiter">(</span><a title="org.squeryl.dsl.ast.SelectElement" id="90832">e</a>: <a href="../dsl/ast/SelectElement.scala.html#10343" title="org.squeryl.dsl.ast.SelectElement">SelectElement</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#18200" title="=&gt; Boolean">isYieldInspectionMode</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#18214" title="=&gt; java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]">_yieldInspectionTL</a>.<span title="()org.squeryl.internals.FieldReferenceLinker.YieldInspection">get</span>.<a href="#90855" title="(e: org.squeryl.dsl.ast.SelectElement)Unit">addSelectElement</a><span class="delimiter">(</span><span title="org.squeryl.dsl.ast.ExportedSelectElement" class="keyword">new</span> <a href="../dsl/ast/SelectElement.scala.html#10349" title="org.squeryl.dsl.ast.ExportedSelectElement">ExportedSelectElement</a><span class="delimiter">(</span><a href="#90832" title="org.squeryl.dsl.ast.SelectElement">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span>
    <a href="#18207" title="(se: Option[org.squeryl.dsl.ast.SelectElement])Unit">_lastAccessedFieldReference</a> = <span title="(x: org.squeryl.dsl.ast.SelectElement)Some[org.squeryl.dsl.ast.SelectElement]">Some</span><span class="delimiter">(</span><a href="#90832" title="org.squeryl.dsl.ast.SelectElement">e</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Option[org.squeryl.dsl.ast.SelectElement]" id="18217">takeLastAccessedFieldReference</a>: <span title="Option[org.squeryl.dsl.ast.SelectElement]">Option</span><span class="delimiter">[</span>SelectElement<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Option[org.squeryl.dsl.ast.SelectElement]" id="98049">res</a> = <a href="#18206" title="=&gt; Option[org.squeryl.dsl.ast.SelectElement]">_lastAccessedFieldReference</a>
    <a href="#18207" title="(se: Option[org.squeryl.dsl.ast.SelectElement])Unit">_lastAccessedFieldReference</a> = <span title="object None">None</span>
    <a href="#98049" title="Option[org.squeryl.dsl.ast.SelectElement]">res</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; org.squeryl.dsl.ast.SelectElementReference[_]" id="18218">_takeLastAccessedUntypedFieldReference</a>: <a href="../dsl/ast/SelectElement.scala.html#10347" title="org.squeryl.dsl.ast.SelectElementReference[_]">SelectElementReference</a><span class="delimiter">[</span>_<span class="delimiter">]</span> =
    <a href="#10755" title="object org.squeryl.internals.FieldReferenceLinker">FieldReferenceLinker</a>.<a href="#18217" title="=&gt; Option[org.squeryl.dsl.ast.SelectElement]">takeLastAccessedFieldReference</a> <span title="org.squeryl.dsl.ast.SelectElementReference[Any]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="org.squeryl.dsl.ast.SelectElementReference[Any]">Some</span><span class="delimiter">(</span><a title="org.squeryl.dsl.ast.SelectElement" id="98057">n</a>:<a href="../dsl/ast/SelectElement.scala.html#10343" title="org.squeryl.dsl.ast.SelectElement">SelectElement</a><span class="delimiter">)</span> =&gt; <span title="org.squeryl.dsl.ast.SelectElementReference[Any]" class="keyword">new</span> <a href="../dsl/ast/SelectElement.scala.html#10347" title="org.squeryl.dsl.ast.SelectElementReference[Any]">SelectElementReference</a><span class="delimiter">(</span><a href="#98057" title="org.squeryl.dsl.ast.SelectElement">n</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="ResultSetMapper.scala.html#10806" title="object org.squeryl.internals.NoOpOutMapper">NoOpOutMapper</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Nothing">None</span> =&gt; org.squeryl.internals.<a href="Utils.scala.html#10829" title="object org.squeryl.internals.Utils">Utils</a>.<a href="Utils.scala.html#30502" title="(msg: String)Nothing">throwError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Thread local does not have a last accessed field... this is a severe bug !&quot;)" class="string">&quot;Thread local does not have a last accessed field... this is a severe bug !&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(e: Any, c: Any)org.squeryl.dsl.ast.LogicalBoolean" id="18219">createEqualityExpressionWithLastAccessedFieldReferenceAndConstant</a><span class="delimiter">(</span><a title="Any" id="63570">e</a>: <span title="Any">Any</span>, <a title="Any" id="63571">c</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <a href="../dsl/ast/ExpressionNode.scala.html#10282" title="org.squeryl.dsl.ast.LogicalBoolean">LogicalBoolean</a> = <span class="delimiter">{</span>

    <span title="org.squeryl.dsl.ast.LogicalBoolean" class="keyword">if</span><span class="delimiter">(</span><a href="#63570" title="Any">e</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../dsl/CompositeKey.scala.html#10030" title="org.squeryl.dsl.CompositeKey">CompositeKey</a><span class="delimiter">]</span><span class="delimiter">)</span>
      <a href="#63570" title="Any">e</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="org.squeryl.dsl.CompositeKey" class="delimiter">[</span><a href="../dsl/CompositeKey.scala.html#10030" title="org.squeryl.dsl.CompositeKey">CompositeKey</a><span class="delimiter">]</span>.<a href="../dsl/CompositeKey.scala.html#18544" title="(ck: org.squeryl.dsl.CompositeKey)org.squeryl.dsl.ast.LogicalBoolean">buildEquality</a><span class="delimiter">(</span><a href="#63571" title="Any">c</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="org.squeryl.dsl.CompositeKey" class="delimiter">[</span><a href="../dsl/CompositeKey.scala.html#10030" title="org.squeryl.dsl.CompositeKey">CompositeKey</a><span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="keyword">else</span>
      <a href="#18220" title="(c: Any)org.squeryl.dsl.ast.LogicalBoolean">createEqualityExpressionWithLastAccessedFieldReferenceAndConstant</a><span class="delimiter">(</span><a href="#63571" title="Any">c</a><span class="delimiter">)</span>    
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(c: Any)org.squeryl.dsl.ast.LogicalBoolean" id="18220">createEqualityExpressionWithLastAccessedFieldReferenceAndConstant</a><span class="delimiter">(</span><a title="Any" id="63568">c</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <a href="../dsl/ast/ExpressionNode.scala.html#10282" title="org.squeryl.dsl.ast.LogicalBoolean">LogicalBoolean</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.squeryl.dsl.ast.SelectElementReference[_]" id="98077">fr</a> = <a href="#18218" title="=&gt; org.squeryl.dsl.ast.SelectElementReference[_]">_takeLastAccessedUntypedFieldReference</a>

    <a href="../dsl/ast/ExpressionNode.scala.html#72543" title="org.squeryl.dsl.ast.BinaryOperatorNodeLogicalBoolean" class="keyword">new</a> <a href="../dsl/ast/ExpressionNode.scala.html#10276" title="org.squeryl.dsl.ast.BinaryOperatorNodeLogicalBoolean">BinaryOperatorNodeLogicalBoolean</a><span class="delimiter">(</span>
      <a href="#98077" title="org.squeryl.dsl.ast.SelectElementReference[_]">fr</a>,
      <span title="org.squeryl.dsl.ast.InputOnlyConstantExpressionNode[Any]" class="keyword">new</span> <a href="../dsl/ast/ExpressionNode.scala.html#10292" title="org.squeryl.dsl.ast.InputOnlyConstantExpressionNode[Any]">InputOnlyConstantExpressionNode</a><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">(</span><a href="#63568" title="Any">c</a><span class="delimiter">)</span>,
      <span title="java.lang.String(&quot;=&quot;)" class="string">&quot;=&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  
  <span class="comment">/**
   * It is assumed that yield invocation for inspection will never be nested, since
   * a query is completely built (and it's yield inspection is done) before it can
   * be nested, this is unlikely to change, but documenting this assumption was
   * deemed usefull, because this method would stop working (without complaining)
   * if (the assumption) was broken.   
   */</span>

  <span class="keyword">def</span> <a title="(q: org.squeryl.dsl.ast.QueryExpressionNode[_], rsm: org.squeryl.internals.ResultSetMapper, selectClosure: () =&gt; AnyRef)(List[org.squeryl.dsl.ast.SelectElement], AnyRef)" id="18221">determineColumnsUtilizedInYeldInvocation</a><span class="delimiter">(</span><a title="org.squeryl.dsl.ast.QueryExpressionNode[_]" id="91477">q</a>: <a href="../dsl/ast/QueryExpressionNode.scala.html#10333" title="org.squeryl.dsl.ast.QueryExpressionNode[_]">QueryExpressionNode</a><span class="delimiter">[</span>_<span class="delimiter">]</span>, <a title="org.squeryl.internals.ResultSetMapper" id="91478">rsm</a>: <a href="ResultSetMapper.scala.html#10810" title="org.squeryl.internals.ResultSetMapper">ResultSetMapper</a>, <a title="() =&gt; AnyRef" id="91479">selectClosure</a>: <span class="delimiter">(</span><span class="delimiter">)</span>=&gt;AnyRef<span class="delimiter">)</span> = <span class="delimiter">{</span>
    
    <span class="keyword">val</span> <a title="org.squeryl.internals.FieldReferenceLinker.YieldInspection" id="91482">yi</a> = <span title="org.squeryl.internals.FieldReferenceLinker.YieldInspection" class="keyword">new</span> <a href="#18213" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">YieldInspection</a>
      <a href="#18214" title="=&gt; java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]">_yieldInspectionTL</a>.<span title="(x$1: org.squeryl.internals.FieldReferenceLinker.YieldInspection)Unit">set</span><span class="delimiter">(</span><a href="#91482" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="(List[org.squeryl.dsl.ast.SelectElement], AnyRef)" id="91483">result</a>:<span title="(List[org.squeryl.dsl.ast.SelectElement], AnyRef)" class="delimiter">(</span>List<span class="delimiter">[</span>SelectElement<span class="delimiter">]</span>,AnyRef<span class="delimiter">)</span> = <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#91482" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90863" title="(q: org.squeryl.dsl.ast.QueryExpressionNode[_], rsm: org.squeryl.internals.ResultSetMapper)Unit">turnOn</a><span class="delimiter">(</span><a href="#91477" title="org.squeryl.dsl.ast.QueryExpressionNode[_]">q</a>, <a href="#91478" title="org.squeryl.internals.ResultSetMapper">rsm</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="Option[org.squeryl.dsl.ast.SelectElement]" id="91485">prev</a> = <a href="#18206" title="=&gt; Option[org.squeryl.dsl.ast.SelectElement]">_lastAccessedFieldReference</a>
      <span class="keyword">val</span> <a title="AnyRef" id="91486">res0</a> =
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <a href="#91479" title="()AnyRef">selectClosure</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">finally</span> <span class="delimiter">{</span>
          <a href="#18207" title="(se: Option[org.squeryl.dsl.ast.SelectElement])Unit">_lastAccessedFieldReference</a> = <a href="#91485" title="Option[org.squeryl.dsl.ast.SelectElement]">prev</a>
        <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#91486" title="AnyRef">res0</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
        org.squeryl.internals.<a href="Utils.scala.html#10829" title="object org.squeryl.internals.Utils">Utils</a>.<a href="Utils.scala.html#30502" title="(msg: String)Nothing">throwError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;query &quot;)" class="string">&quot;query &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#91477" title="org.squeryl.dsl.ast.QueryExpressionNode[_]">q</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; yielded null&quot;)" class="string">&quot; yielded null&quot;</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="java.util.IdentityHashMap[AnyRef,AnyRef]" id="91487">visitedSet</a> = <span title="java.util.IdentityHashMap[AnyRef,AnyRef]" class="keyword">new</span> java.util.<span title="java.util.IdentityHashMap[AnyRef,AnyRef]">IdentityHashMap</span><span class="delimiter">[</span>AnyRef, AnyRef<span class="delimiter">]</span>
        
      <a href="#18224" title="(visited: java.util.IdentityHashMap[AnyRef,AnyRef], yi: org.squeryl.internals.FieldReferenceLinker.YieldInspection, q: org.squeryl.dsl.ast.QueryExpressionElements, o: AnyRef)Unit">_populateSelectColsRecurse</a><span class="delimiter">(</span><a href="#91487" title="java.util.IdentityHashMap[AnyRef,AnyRef]">visitedSet</a>, <a href="#91482" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>, <a href="#91477" title="org.squeryl.dsl.ast.QueryExpressionNode[_]">q</a>, <a href="#91486" title="AnyRef">res0</a><span class="delimiter">)</span>

      <a href="#91483" title="(List[org.squeryl.dsl.ast.SelectElement], AnyRef)">result</a> = <span title="(_1: List[org.squeryl.dsl.ast.SelectElement], _2: AnyRef)(List[org.squeryl.dsl.ast.SelectElement], AnyRef)" class="delimiter">(</span><a href="#91482" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90864" title="=&gt; List[org.squeryl.dsl.ast.SelectElement]">outExpressions</a>, <a href="#91486" title="AnyRef">res0</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="#18214" title="=&gt; java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]">_yieldInspectionTL</a>.<span title="()Unit">remove</span><span class="delimiter">(</span><span class="delimiter">)</span>      
    <span class="delimiter">}</span>
    <a href="#91483" title="(List[org.squeryl.dsl.ast.SelectElement], AnyRef)">result</a>
  <span class="delimiter">}</span>
  
  <span class="comment">/*
   * The theory here is that setting the var is an atomic operation, so
   * it should be ok to perform without synchronization.
   * Worst case scenario would be that one thread overwrites the map
   * created by a previous thread, but since it's just a cache and the fields
   * can be retrieved at any time, that's ok.
   */</span>
  <span class="keyword">private</span> <span class="keyword">object</span> <a title="object org.squeryl.internals.FieldReferenceLinker._declaredFieldCache" id="18222">_declaredFieldCache</a> <span title="ScalaObject" class="delimiter">{</span>
  
	  @volatile <span class="keyword">var</span> <a title="Map[Class[_],Array[java.lang.reflect.Field]]" id="98085">_cache</a>: <span title="Map[Class[_],Array[java.lang.reflect.Field]]">Map</span><span class="delimiter">[</span>Class<span class="delimiter">[</span>_<span class="delimiter">]</span>, Array<span class="delimiter">[</span>Field<span class="delimiter">]</span><span class="delimiter">]</span> =
			  <span title="[A, B](elems: (A, B)*)scala.collection.immutable.Map[A,B]">Map</span><span title="(elems: (Class[_], Array[java.lang.reflect.Field])*)scala.collection.immutable.Map[Class[_],Array[java.lang.reflect.Field]]" class="delimiter">[</span><span title="Class[_]">Class</span><span class="delimiter">[</span>_<span class="delimiter">]</span>, <span title="Array[java.lang.reflect.Field]">Array</span><span class="delimiter">[</span>Field<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    
	  <span class="keyword">def</span> <a title="(cls: Class[_])Array[java.lang.reflect.Field]" id="98087">apply</a><span class="delimiter">(</span><a title="Class[_]" id="98108">cls</a>: <span title="Class[_]">Class</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span> =
	    <a href="#98085" title="=&gt; Map[Class[_],Array[java.lang.reflect.Field]]">_cache</a>.<span title="(key: Class[_])Option[Array[java.lang.reflect.Field]]">get</span><span class="delimiter">(</span><a href="#98108" title="Class[_]">cls</a><span class="delimiter">)</span> <span title="(default: =&gt; Array[java.lang.reflect.Field])Array[java.lang.reflect.Field]">getOrElse</span> <span class="delimiter">{</span>
	      <span class="keyword">val</span> <a title="Array[java.lang.reflect.Field]" id="98131">declaredFields</a> = <a href="#98108" title="Class[_]">cls</a>.<span title="()Array[java.lang.reflect.Field]">getDeclaredFields</span><span class="delimiter">(</span><span class="delimiter">)</span>
	      <a href="#98085" title="(x$1: Map[Class[_],Array[java.lang.reflect.Field]])Unit">_cache</a> <span title="(kv: (Class[_], Array[java.lang.reflect.Field]))scala.collection.immutable.Map[Class[_],Array[java.lang.reflect.Field]]">+=</span> <span class="delimiter">(</span><span title="(_1: Class[_$7], _2: Array[java.lang.reflect.Field])(Class[_$7], Array[java.lang.reflect.Field])" class="delimiter">(</span><a href="#98108" title="Class[_]">cls</a>, <a href="#98131" title="Array[java.lang.reflect.Field]">declaredFields</a><span class="delimiter">)</span><span class="delimiter">)</span>
	      <a href="#98131" title="Array[java.lang.reflect.Field]">declaredFields</a>
	    <span class="delimiter">}</span>
	  
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(visited: java.util.IdentityHashMap[AnyRef,AnyRef], yi: org.squeryl.internals.FieldReferenceLinker.YieldInspection, q: org.squeryl.dsl.ast.QueryExpressionElements, o: AnyRef)Unit" id="18224">_populateSelectColsRecurse</a><span class="delimiter">(</span><a title="java.util.IdentityHashMap[AnyRef,AnyRef]" id="91768">visited</a>: java.util.<span title="java.util.IdentityHashMap[AnyRef,AnyRef]">IdentityHashMap</span><span class="delimiter">[</span>AnyRef, AnyRef<span class="delimiter">]</span> , <a title="org.squeryl.internals.FieldReferenceLinker.YieldInspection" id="91769">yi</a>: <a href="#18213" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">YieldInspection</a>,<a title="org.squeryl.dsl.ast.QueryExpressionElements" id="91770">q</a>: <a href="../dsl/ast/QueryExpressionElements.scala.html#10326" title="org.squeryl.dsl.ast.QueryExpressionElements">QueryExpressionElements</a>, <a title="AnyRef" id="91771">o</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
	  <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#91771" title="AnyRef">o</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#91771" title="AnyRef">o</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="object None">None</span><span class="delimiter">)</span> <span class="delimiter">{</span>
		  <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#91768" title="java.util.IdentityHashMap[AnyRef,AnyRef]">visited</a>.<span title="(x$1: Any)Boolean">containsKey</span><span class="delimiter">(</span><a href="#91771" title="AnyRef">o</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
			  <span class="keyword">val</span> <a title="java.lang.Class[_ &lt;: AnyRef]" id="98261">clazz</a> = <a href="#91771" title="AnyRef">o</a>.<span title="()java.lang.Class[_]">getClass</span>
			  <span class="keyword">val</span> <a title="java.lang.String" id="98262">clazzName</a> = <a href="#98261" title="java.lang.Class[_ &lt;: AnyRef]">clazz</a>.<span title="()java.lang.String">getName</span>
			  <span class="comment">//println(&quot;Looking at &quot; + clazzName)</span>
			  <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#98262" title="java.lang.String">clazzName</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;java.&quot;)" class="string">&quot;java.&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> 
					  <span title="=&gt; Boolean">!</span><a href="#98262" title="java.lang.String">clazzName</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;net.sf.cglib.&quot;)" class="string">&quot;net.sf.cglib.&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> 
					  <span title="=&gt; Boolean">!</span><a href="#98262" title="java.lang.String">clazzName</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;scala.Enumeration&quot;)" class="string">&quot;scala.Enumeration&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
				  <a href="#91768" title="java.util.IdentityHashMap[AnyRef,AnyRef]">visited</a>.<span title="(x$1: AnyRef, x$2: AnyRef)AnyRef">put</span><span class="delimiter">(</span><a href="#91771" title="AnyRef">o</a>,<a href="#91771" title="AnyRef">o</a><span class="delimiter">)</span>
				  <a href="#18225" title="(yi: org.squeryl.internals.FieldReferenceLinker.YieldInspection, q: org.squeryl.dsl.ast.QueryExpressionElements, sample: AnyRef)Unit">_populateSelectCols</a><span class="delimiter">(</span><a href="#91769" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>, <a href="#91770" title="org.squeryl.dsl.ast.QueryExpressionElements">q</a>, <a href="#91771" title="AnyRef">o</a><span class="delimiter">)</span>
				  <span class="keyword">for</span><span class="delimiter">(</span><a title="java.lang.reflect.Field" id="99003">f</a> &lt;- <a href="#98087" title="(cls: Class[_])Array[java.lang.reflect.Field]">_declaredFieldCache</a><span title="(f: java.lang.reflect.Field =&gt; Unit)Unit" class="delimiter">(</span><a href="#98261" title="java.lang.Class[_ &lt;: AnyRef]">clazz</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
					  <a href="#99003" title="java.lang.reflect.Field">f</a>.<span title="(x$1: Boolean)Unit">setAccessible</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>;
					  <span class="keyword">val</span> <a title="java.lang.Object" id="99004">ob</a> = <a href="#99003" title="java.lang.reflect.Field">f</a>.<span title="(x$1: Any)java.lang.Object">get</span><span class="delimiter">(</span><a href="#91771" title="AnyRef">o</a><span class="delimiter">)</span>
					  <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#99003" title="java.lang.reflect.Field">f</a>.<span title="()java.lang.String">getName</span>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;CGLIB$&quot;)" class="string">&quot;CGLIB$&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> 
					        <span title="=&gt; Boolean">!</span><a href="#99003" title="java.lang.reflect.Field">f</a>.<span title="()java.lang.Class[_]">getType</span>.<span title="()java.lang.String">getName</span>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;scala.Function&quot;)" class="string">&quot;scala.Function&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> 
					        <span title="=&gt; Boolean">!</span><a href="FieldMetaData.scala.html#10744" title="object org.squeryl.internals.FieldMetaData">FieldMetaData</a>.<a href="FieldMetaData.scala.html#43243" title="=&gt; java.lang.Object with org.squeryl.internals.FieldMetaDataFactory">factory</a>.<a href="FieldMetaData.scala.html#43262" title="(o: AnyRef, f: java.lang.reflect.Field)Boolean">hideFromYieldInspection</a><span class="delimiter">(</span><a href="#91771" title="AnyRef">o</a>, <a href="#99003" title="java.lang.reflect.Field">f</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
						  <a href="#18224" title="(visited: java.util.IdentityHashMap[AnyRef,AnyRef], yi: org.squeryl.internals.FieldReferenceLinker.YieldInspection, q: org.squeryl.dsl.ast.QueryExpressionElements, o: AnyRef)Unit">_populateSelectColsRecurse</a><span class="delimiter">(</span><a href="#91768" title="java.util.IdentityHashMap[AnyRef,AnyRef]">visited</a>, <a href="#91769" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>, <a href="#91770" title="org.squeryl.dsl.ast.QueryExpressionElements">q</a>, <a href="#99004" title="java.lang.Object">ob</a><span class="delimiter">)</span>
					  <span class="delimiter">}</span>
				  <span class="delimiter">}</span>
			  <span class="delimiter">}</span>
		  <span class="delimiter">}</span>
	  <span class="delimiter">}</span>
  
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(yi: org.squeryl.internals.FieldReferenceLinker.YieldInspection, q: org.squeryl.dsl.ast.QueryExpressionElements, sample: AnyRef)Unit" id="18225">_populateSelectCols</a><span class="delimiter">(</span><a title="org.squeryl.internals.FieldReferenceLinker.YieldInspection" id="98278">yi</a>: <a href="#18213" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">YieldInspection</a>,<a title="org.squeryl.dsl.ast.QueryExpressionElements" id="98279">q</a>: <a href="../dsl/ast/QueryExpressionElements.scala.html#10326" title="org.squeryl.dsl.ast.QueryExpressionElements">QueryExpressionElements</a>, <a title="AnyRef" id="98280">sample</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Option[org.squeryl.dsl.ast.QueryableExpressionNode]" id="99011">owner</a> = <a href="#18227" title="(sample: AnyRef, q: org.squeryl.dsl.ast.QueryExpressionElements)Option[org.squeryl.dsl.ast.QueryableExpressionNode]">_findQENThatOwns</a><span class="delimiter">(</span><a href="#98280" title="AnyRef">sample</a>, <a href="#98279" title="org.squeryl.dsl.ast.QueryExpressionElements">q</a><span class="delimiter">)</span>
    <a href="#99011" title="Option[org.squeryl.dsl.ast.QueryableExpressionNode]">owner</a> <span title="(f: org.squeryl.dsl.ast.QueryableExpressionNode =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="org.squeryl.dsl.ast.QueryableExpressionNode" id="99019">o</a> =&gt;
      <span class="keyword">for</span><span class="delimiter">(</span><a title="org.squeryl.dsl.ast.SelectElement" id="99038">e</a> &lt;- <a href="#99019" title="org.squeryl.dsl.ast.QueryableExpressionNode">o</a>.<a href="../dsl/ast/ExpressionNode.scala.html#63114" title="(forScope: org.squeryl.dsl.ast.QueryExpressionElements)Iterable[org.squeryl.dsl.ast.SelectElement]">getOrCreateAllSelectElements</a><span title="(f: org.squeryl.dsl.ast.SelectElement =&gt; Unit)Unit" class="delimiter">(</span><a href="#98279" title="org.squeryl.dsl.ast.QueryExpressionElements">q</a><span class="delimiter">)</span><span class="delimiter">)</span>
    	  <a href="#98278" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90855" title="(e: org.squeryl.dsl.ast.SelectElement)Unit">addSelectElement</a><span class="delimiter">(</span><a href="#99038" title="org.squeryl.dsl.ast.SelectElement">e</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(s: AnyRef)Option[org.squeryl.dsl.ast.QueryableExpressionNode]" id="18226">findOwnerOfSample</a><span class="delimiter">(</span><a title="AnyRef" id="99041">s</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Option[org.squeryl.dsl.ast.QueryableExpressionNode]">Option</span><span class="delimiter">[</span>QueryableExpressionNode<span class="delimiter">]</span> =
<span class="comment">// TODO: could we enforce that Query[AnyVal] are not nested in some other way ?   </span>
<span class="comment">//    if(s.isInstanceOf[AnyVal])</span>
<span class="comment">//      org.squeryl.internals.Utils.throwError(&quot;A query that returns a AnyVal cannot be nested &quot; + Utils.failSafeString(FieldReferenceLinker.inspectedQueryExpressionNode.toString))</span>
<span class="comment">//    else</span>
     <a href="#18227" title="(sample: AnyRef, q: org.squeryl.dsl.ast.QueryExpressionElements)Option[org.squeryl.dsl.ast.QueryableExpressionNode]">_findQENThatOwns</a><span class="delimiter">(</span><a href="#99041" title="AnyRef">s</a>, <a href="#10755" title="object org.squeryl.internals.FieldReferenceLinker">FieldReferenceLinker</a>.<a href="#18201" title="=&gt; org.squeryl.dsl.ast.QueryExpressionNode[_]">inspectedQueryExpressionNode</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sample: AnyRef, q: org.squeryl.dsl.ast.QueryExpressionElements)Option[org.squeryl.dsl.ast.QueryableExpressionNode]" id="18227">_findQENThatOwns</a><span class="delimiter">(</span><a title="AnyRef" id="99012">sample</a>: <span title="AnyRef">AnyRef</span>, <a title="org.squeryl.dsl.ast.QueryExpressionElements" id="99013">q</a>: <a href="../dsl/ast/QueryExpressionElements.scala.html#10326" title="org.squeryl.dsl.ast.QueryExpressionElements">QueryExpressionElements</a><span class="delimiter">)</span>: <span title="Option[org.squeryl.dsl.ast.QueryableExpressionNode]">Option</span><span class="delimiter">[</span>QueryableExpressionNode<span class="delimiter">]</span> = <span class="delimiter">{</span>

    <a href="#99013" title="org.squeryl.dsl.ast.QueryExpressionElements">q</a>.<a href="../dsl/ast/ExpressionNode.scala.html#18100" title="[T](implicit manifest: Manifest[T])Iterable[T]">filterDescendantsOfType</a><span title="(implicit manifest: Manifest[org.squeryl.dsl.ast.QueryableExpressionNode])Iterable[org.squeryl.dsl.ast.QueryableExpressionNode]" class="delimiter">[</span><a href="../dsl/ast/ExpressionNode.scala.html#10311" title="org.squeryl.dsl.ast.QueryableExpressionNode">QueryableExpressionNode</a><span class="delimiter">]</span>.<span title="(p: org.squeryl.dsl.ast.QueryableExpressionNode =&gt; Boolean)Option[org.squeryl.dsl.ast.QueryableExpressionNode]">find</span><span class="delimiter">(</span><a href="#99062" title="org.squeryl.dsl.ast.QueryableExpressionNode">_</a>.<a href="../dsl/ast/ExpressionNode.scala.html#63111" title="(aSample: AnyRef)Boolean">owns</a><span class="delimiter">(</span><a href="#99012" title="AnyRef">sample</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(v: org.squeryl.dsl.ast.ViewExpressionNode[_])net.sf.cglib.proxy.Callback" id="18228">createCallBack</a><span class="delimiter">(</span><a title="org.squeryl.dsl.ast.ViewExpressionNode[_]" id="63163">v</a>: <a href="../dsl/ast/ViewExpressionNode.scala.html#10362" title="org.squeryl.dsl.ast.ViewExpressionNode[_]">ViewExpressionNode</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="net.sf.cglib.proxy.Callback">Callback</span> =
    <span title="org.squeryl.internals.FieldReferenceLinker.PosoPropertyAccessInterceptor" class="keyword">new</span> <a href="#18229" title="org.squeryl.internals.FieldReferenceLinker.PosoPropertyAccessInterceptor">PosoPropertyAccessInterceptor</a><span class="delimiter">(</span><a href="#63163" title="org.squeryl.dsl.ast.ViewExpressionNode[_]">v</a><span class="delimiter">)</span>
  
  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class PosoPropertyAccessInterceptor extends java.lang.Object with net.sf.cglib.proxy.MethodInterceptor with ScalaObject" id="18229">PosoPropertyAccessInterceptor</a><a href="#18229" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="org.squeryl.dsl.ast.ViewExpressionNode[_]" id="99076">viewExpressionNode</a>: <a href="../dsl/ast/ViewExpressionNode.scala.html#10362" title="org.squeryl.dsl.ast.ViewExpressionNode[_]">ViewExpressionNode</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="net.sf.cglib.proxy.MethodInterceptor">MethodInterceptor</span> <span class="delimiter">{</span>

      <span class="keyword">def</span> <a title="(m: java.lang.reflect.Method)Option[org.squeryl.internals.FieldMetaData]" id="99073">fmd4Method</a><span class="delimiter">(</span><a title="java.lang.reflect.Method" id="99093">m</a>: <span title="java.lang.reflect.Method">Method</span><span class="delimiter">)</span> =
        <a href="#99076" title="=&gt; org.squeryl.dsl.ast.ViewExpressionNode[_]">viewExpressionNode</a>.<a href="../dsl/ast/ViewExpressionNode.scala.html#63117" title="(=&gt; org.squeryl.View[_$9]) forSome { type _$9 }">view</a>.<a href="../View.scala.html#20454" title="(name: String)Option[org.squeryl.internals.FieldMetaData]">findFieldMetaDataForProperty</a><span class="delimiter">(</span><a href="#99093" title="java.lang.reflect.Method">m</a>.<span title="()java.lang.String">getName</span><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(o: java.lang.Object, m: java.lang.reflect.Method, args: Array[java.lang.Object], proxy: net.sf.cglib.proxy.MethodProxy)java.lang.Object" id="99074">intercept</a><span class="delimiter">(</span><a title="java.lang.Object" id="99098">o</a>: <span title="java.lang.Object">Object</span>, <a title="java.lang.reflect.Method" id="99099">m</a>: <span title="java.lang.reflect.Method">Method</span>, <a title="Array[java.lang.Object]" id="99100">args</a>: <span title="Array[java.lang.Object]">Array</span><span class="delimiter">[</span>Object<span class="delimiter">]</span>, <a title="net.sf.cglib.proxy.MethodProxy" id="99101">proxy</a>: <span title="net.sf.cglib.proxy.MethodProxy">MethodProxy</span><span class="delimiter">)</span>: <span title="java.lang.Object">Object</span> = <span class="delimiter">{</span>

        <span class="keyword">val</span> <a title="Option[org.squeryl.internals.FieldMetaData]" id="99363">fmd</a> = <a href="#99073" title="(m: java.lang.reflect.Method)Option[org.squeryl.internals.FieldMetaData]">fmd4Method</a><span class="delimiter">(</span><a href="#99099" title="java.lang.reflect.Method">m</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="org.squeryl.internals.FieldReferenceLinker.YieldInspection" id="99364">yi</a> = <span title="org.squeryl.internals.FieldReferenceLinker.YieldInspection" class="keyword">if</span> <span class="delimiter">(</span><a href="#18200" title="=&gt; Boolean">isYieldInspectionMode</a><span class="delimiter">)</span> <a href="#18214" title="=&gt; java.lang.ThreadLocal[org.squeryl.internals.FieldReferenceLinker.YieldInspection]">_yieldInspectionTL</a>.<span title="()org.squeryl.internals.FieldReferenceLinker.YieldInspection">get</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
        <span class="keyword">val</span> <a title="Boolean" id="99365">isComposite</a> =
          classOf<span title="java.lang.Class[org.squeryl.dsl.CompositeKey](classOf[org.squeryl.dsl.CompositeKey])" class="delimiter">[</span>CompositeKey<span class="delimiter">]</span>.<span title="(x$1: java.lang.Class[_])Boolean">isAssignableFrom</span><span class="delimiter">(</span><a href="#99099" title="java.lang.reflect.Method">m</a>.<span title="()java.lang.Class[_]">getReturnType</span><span class="delimiter">)</span>

        <span class="keyword">try</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#99363" title="Option[org.squeryl.internals.FieldMetaData]">fmd</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="object None">None</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#99364" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
            <a href="#99364" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90861" title="=&gt; Unit">incrementReentranceDepth</a>

          <a href="#99075" title="(o: java.lang.Object, m: java.lang.reflect.Method, args: Array[java.lang.Object], proxy: net.sf.cglib.proxy.MethodProxy, fmd: Option[org.squeryl.internals.FieldMetaData], yi: org.squeryl.internals.FieldReferenceLinker.YieldInspection, isComposite: Boolean)java.lang.Object">_intercept</a><span class="delimiter">(</span><a href="#99098" title="java.lang.Object">o</a>, <a href="#99099" title="java.lang.reflect.Method">m</a>, <a href="#99100" title="Array[java.lang.Object]">args</a>, <a href="#99101" title="net.sf.cglib.proxy.MethodProxy">proxy</a>, <a href="#99363" title="Option[org.squeryl.internals.FieldMetaData]">fmd</a>, <a href="#99364" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>, <a href="#99365" title="Boolean">isComposite</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">finally</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#99363" title="Option[org.squeryl.internals.FieldMetaData]">fmd</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="object None">None</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#99364" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
            <a href="#99364" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90862" title="=&gt; Unit">decrementReentranceDepth</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">private</span> <span class="keyword">def</span> <a title="(o: java.lang.Object, m: java.lang.reflect.Method, args: Array[java.lang.Object], proxy: net.sf.cglib.proxy.MethodProxy, fmd: Option[org.squeryl.internals.FieldMetaData], yi: org.squeryl.internals.FieldReferenceLinker.YieldInspection, isComposite: Boolean)java.lang.Object" id="99075">_intercept</a><span class="delimiter">(</span><a title="java.lang.Object" id="99376">o</a>: <span title="java.lang.Object">Object</span>, <a title="java.lang.reflect.Method" id="99377">m</a>: <span title="java.lang.reflect.Method">Method</span>, <a title="Array[java.lang.Object]" id="99378">args</a>: <span title="Array[java.lang.Object]">Array</span><span class="delimiter">[</span>Object<span class="delimiter">]</span>, <a title="net.sf.cglib.proxy.MethodProxy" id="99379">proxy</a>: <span title="net.sf.cglib.proxy.MethodProxy">MethodProxy</span>, <a title="Option[org.squeryl.internals.FieldMetaData]" id="99380">fmd</a>: <span title="Option[org.squeryl.internals.FieldMetaData]">Option</span><span class="delimiter">[</span>FieldMetaData<span class="delimiter">]</span>, <a title="org.squeryl.internals.FieldReferenceLinker.YieldInspection" id="99381">yi</a>: <a href="#18213" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">YieldInspection</a>, <a title="Boolean" id="99382">isComposite</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>: <span title="java.lang.Object">Object</span> = <span class="delimiter">{</span>

        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#99382" title="Boolean">isComposite</a><span class="delimiter">)</span>
          <a href="#18208" title="=&gt; java.lang.ThreadLocal[Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]]">_compositeKeyMembers</a>.<span title="(x$1: Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]])Unit">set</span><span class="delimiter">(</span><span title="(x: scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement])Some[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]">Some</span><span class="delimiter">(</span><span title="()scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]" class="keyword">new</span> <span title="scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]">ArrayBuffer</span><span class="delimiter">[</span>SelectElement<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">var</span> <a title="java.lang.Object" id="99392">res</a> = <a href="#99379" title="net.sf.cglib.proxy.MethodProxy">proxy</a>.<span title="(x$1: Any, x$2: Array[java.lang.Object])java.lang.Object">invokeSuper</span><span class="delimiter">(</span><a href="#99376" title="java.lang.Object">o</a>, <a href="#99378" title="Array[java.lang.Object]">args</a><span class="delimiter">)</span>;

        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#99382" title="Boolean">isComposite</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="org.squeryl.dsl.CompositeKey" id="99406">ck</a> = <a href="#99392" title="java.lang.Object">res</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="org.squeryl.dsl.CompositeKey" class="delimiter">[</span><a href="../dsl/CompositeKey.scala.html#10030" title="org.squeryl.dsl.CompositeKey">CompositeKey</a><span class="delimiter">]</span>
          <a href="#99406" title="org.squeryl.dsl.CompositeKey">ck</a>.<a href="../dsl/CompositeKey.scala.html#18536" title="(x$1: Option[Seq[org.squeryl.dsl.ast.SelectElementReference[Any]]])Unit">_members</a> = <span title="(x: Seq[org.squeryl.dsl.ast.SelectElementReference[Any]])Some[Seq[org.squeryl.dsl.ast.SelectElementReference[Any]]]">Some</span><span class="delimiter">(</span><a href="#18208" title="=&gt; java.lang.ThreadLocal[Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]]">_compositeKeyMembers</a>.<span title="()Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]">get</span>.<span title="=&gt; scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]">get</span>.<span title="(f: org.squeryl.dsl.ast.SelectElement =&gt; org.squeryl.dsl.ast.SelectElementReference[Any])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement],org.squeryl.dsl.ast.SelectElementReference[Any],Seq[org.squeryl.dsl.ast.SelectElementReference[Any]]])Seq[org.squeryl.dsl.ast.SelectElementReference[Any]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.mutable.ArrayBuffer.Coll,org.squeryl.dsl.ast.SelectElementReference[Any],scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElementReference[Any]]]" class="delimiter">(</span><span title="org.squeryl.dsl.ast.SelectElementReference[Any]" class="keyword">new</span> <a href="../dsl/ast/SelectElement.scala.html#10347" title="org.squeryl.dsl.ast.SelectElementReference[Any]">SelectElementReference</a><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">(</span><a href="#99444" title="org.squeryl.dsl.ast.SelectElement">_</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="ResultSetMapper.scala.html#10806" title="object org.squeryl.internals.NoOpOutMapper">NoOpOutMapper</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#99406" title="org.squeryl.dsl.CompositeKey">ck</a>.<a href="../dsl/CompositeKey.scala.html#18539" title="(x$1: Option[String])Unit">_propertyName</a> = <span title="(x: java.lang.String)Some[java.lang.String]">Some</span><span class="delimiter">(</span><a href="#99377" title="java.lang.reflect.Method">m</a>.<span title="()java.lang.String">getName</span><span class="delimiter">)</span>
          <a href="#18208" title="=&gt; java.lang.ThreadLocal[Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]]">_compositeKeyMembers</a>.<span title="()Unit">remove</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#99377" title="java.lang.reflect.Method">m</a>.<span title="()java.lang.String">getName</span>.<span title="(x$1: Any)Boolean">equals</span><span class="delimiter">(</span><span title="java.lang.String(&quot;toString&quot;)" class="string">&quot;toString&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#99377" title="java.lang.reflect.Method">m</a>.<span title="()Array[java.lang.Class[_]]">getParameterTypes</span>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
          <a href="#99392" title="java.lang.Object">res</a> = <span title="java.lang.String(&quot;sample:&quot;)" class="string">&quot;sample:&quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#99076" title="=&gt; org.squeryl.dsl.ast.ViewExpressionNode[_]">viewExpressionNode</a>.<a href="../dsl/ast/ViewExpressionNode.scala.html#63117" title="(=&gt; org.squeryl.View[_$9]) forSome { type _$9 }">view</a>.<a href="../View.scala.html#20450" title="=&gt; String">name</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;[&quot;)" class="string">&quot;[&quot;</span><span title="(x$1: Any)java.lang.String">+</span><span title="object java.lang.Integer">Integer</span>.<span title="(x$1: Int)java.lang.String">toHexString</span><span class="delimiter">(</span><span title="object java.lang.System">System</span>.<span title="(x$1: Any)Int">identityHashCode</span><span class="delimiter">(</span><a href="#99376" title="java.lang.Object">o</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;]&quot;)" class="string">&quot;]&quot;</span>

        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#99380" title="Option[org.squeryl.internals.FieldMetaData]">fmd</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="object None">None</span><span class="delimiter">)</span> <span class="delimiter">{</span>

          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#99381" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span>  <a href="#99381" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90860" title="=&gt; Int">reentranceDepth</a> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
            <a href="#99381" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90855" title="(e: org.squeryl.dsl.ast.SelectElement)Unit">addSelectElement</a><span class="delimiter">(</span><a href="#99076" title="=&gt; org.squeryl.dsl.ast.ViewExpressionNode[_]">viewExpressionNode</a>.<a href="../dsl/ast/ViewExpressionNode.scala.html#63126" title="(fmd: org.squeryl.internals.FieldMetaData, forScope: org.squeryl.dsl.ast.QueryExpressionElements)org.squeryl.dsl.ast.SelectElement">getOrCreateSelectElement</a><span class="delimiter">(</span><a href="#99380" title="Option[org.squeryl.internals.FieldMetaData]">fmd</a>.<span title="=&gt; org.squeryl.internals.FieldMetaData">get</span>, <a href="#99381" title="org.squeryl.internals.FieldReferenceLinker.YieldInspection">yi</a>.<a href="#90846" title="=&gt; org.squeryl.dsl.ast.QueryExpressionNode[_]">queryExpressionNode</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#18208" title="=&gt; java.lang.ThreadLocal[Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]]">_compositeKeyMembers</a>.<span title="()Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]">get</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#18208" title="=&gt; java.lang.ThreadLocal[Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]]">_compositeKeyMembers</a>.<span title="()Unit">remove</span><span class="delimiter">(</span><span class="delimiter">)</span>
            <a href="#18207" title="(se: Option[org.squeryl.dsl.ast.SelectElement])Unit">_lastAccessedFieldReference</a> = <span title="(x: org.squeryl.dsl.ast.SelectElement)Some[org.squeryl.dsl.ast.SelectElement]">Some</span><span class="delimiter">(</span><a href="#99076" title="=&gt; org.squeryl.dsl.ast.ViewExpressionNode[_]">viewExpressionNode</a>.<a href="../dsl/ast/ViewExpressionNode.scala.html#63125" title="(fmd: org.squeryl.internals.FieldMetaData)org.squeryl.dsl.ast.SelectElement">getOrCreateSelectElement</a><span class="delimiter">(</span><a href="#99380" title="Option[org.squeryl.internals.FieldMetaData]">fmd</a>.<span title="=&gt; org.squeryl.internals.FieldMetaData">get</span><span class="delimiter">)</span><span class="delimiter">)</span>;
          <span class="delimiter">}</span> <span class="keyword">else</span>
            <a href="#18208" title="=&gt; java.lang.ThreadLocal[Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]]">_compositeKeyMembers</a>.<span title="()Option[scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]]">get</span>.<span title="=&gt; scala.collection.mutable.ArrayBuffer[org.squeryl.dsl.ast.SelectElement]">get</span>.<span title="(elems: org.squeryl.dsl.ast.SelectElement*)Unit">append</span><span class="delimiter">(</span><a href="#99076" title="=&gt; org.squeryl.dsl.ast.ViewExpressionNode[_]">viewExpressionNode</a>.<a href="../dsl/ast/ViewExpressionNode.scala.html#63125" title="(fmd: org.squeryl.internals.FieldMetaData)org.squeryl.dsl.ast.SelectElement">getOrCreateSelectElement</a><span class="delimiter">(</span><a href="#99380" title="Option[org.squeryl.internals.FieldMetaData]">fmd</a>.<span title="=&gt; org.squeryl.internals.FieldMetaData">get</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <a href="#99392" title="java.lang.Object">res</a>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
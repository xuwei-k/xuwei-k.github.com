<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>test/org/squeryl/test/customtypes/TestCustomTypesMode.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.squeryl.test.customtypes

<span class="comment">/*******************************************************************************
 * Copyright 2010 Maxime LÃ©vesque
 * 
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ***************************************************************************** */</span>
<span class="keyword">import</span> java.sql.SQLException
<span class="keyword">import</span> org.squeryl.customtypes._
<span class="keyword">import</span> org.squeryl.<span class="delimiter">{</span>KeyedEntity, Schema<span class="delimiter">}</span>
<span class="keyword">import</span> org.squeryl.framework._

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class TestCustomTypesMode extends org.squeryl.framework.SchemaTester with org.squeryl.framework.QueryTester with org.squeryl.framework.RunTestsInsideTransaction with ScalaObject" id="11110">TestCustomTypesMode</a> <a href="#11110" title="ScalaObject" class="keyword">extends</a> <a href="../../framework/SchemaTester.scala.html#10951" title="org.squeryl.framework.SchemaTester">SchemaTester</a> <span class="keyword">with</span> <a href="../../framework/QueryTester.scala.html#10933" title="org.squeryl.framework.QueryTester">QueryTester</a> <span class="keyword">with</span> <a href="../../framework/RunTestsInsideTransaction.scala.html#10942" title="org.squeryl.framework.RunTestsInsideTransaction">RunTestsInsideTransaction</a> <span class="delimiter">{</span>

  <span class="keyword">val</span> <a title="org.squeryl.test.customtypes.HospitalDb" id="117275">schema</a> = <span title="org.squeryl.test.customtypes.HospitalDb" class="keyword">new</span> <a href="#11114" title="org.squeryl.test.customtypes.HospitalDb">HospitalDb</a>

  <span class="keyword">import</span> <a href="#117275" title="=&gt; org.squeryl.test.customtypes.HospitalDb">schema</a>._

  <span class="keyword">var</span> <a title="org.squeryl.test.customtypes.TestData" id="117279">sharedTestObjects</a> : <a href="#11111" title="org.squeryl.test.customtypes.TestData">TestData</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="117281">prePopulate</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">{</span>
    <a href="#117279" title="(x$1: org.squeryl.test.customtypes.TestData)Unit">sharedTestObjects</a> = <span title="org.squeryl.test.customtypes.TestData" class="keyword">new</span> <a href="#11111" title="org.squeryl.test.customtypes.TestData">TestData</a><span class="delimiter">(</span><a href="#117275" title="=&gt; org.squeryl.test.customtypes.HospitalDb">schema</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>


  <span class="keyword">import</span> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#9994" title="object org.squeryl.customtypes.CustomTypesMode">CustomTypesMode</a>._

  <span class="keyword">def</span> <a title="=&gt; org.squeryl.Query[org.squeryl.test.customtypes.Patient]" id="117283">simpleSelect</a> =
    <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15987" title="(t1: org.squeryl.Queryable[org.squeryl.test.customtypes.Patient])(f: org.squeryl.test.customtypes.Patient =&gt; org.squeryl.dsl.QueryYield[org.squeryl.test.customtypes.Patient])org.squeryl.Query[org.squeryl.test.customtypes.Patient]">from</a><span class="delimiter">(</span><a href="#136018" title="=&gt; org.squeryl.Table[org.squeryl.test.customtypes.Patient]">patients</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="org.squeryl.test.customtypes.Patient" id="136609">p</a> =&gt;
      <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15264" title="(b: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.fsm.WhereState[org.squeryl.dsl.fsm.Conditioned]">where</a><span class="delimiter">(</span><a href="#136609" title="org.squeryl.test.customtypes.Patient">p</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15199" title="implicit org.squeryl.dsl.DslFactory.optionInt2ScalarInt : (i: Option[org.squeryl.customtypes.CustomTypesMode.IntType])org.squeryl.dsl.NumericalExpression[Option[org.squeryl.customtypes.CustomTypesMode.IntType]]">age</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18127" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType])org.squeryl.dsl.ast.BinaryOperatorNodeLogicalBoolean">&gt;</a> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69079" title="implicit org.squeryl.customtypes.CustomTypesMode.createConstantNodeOfScalarIntType : (i: Int)org.squeryl.dsl.ast.ConstantExpressionNode[org.squeryl.customtypes.CustomTypesMode.IntType] with org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType]" class="int">70</a><span class="delimiter">)</span>
      <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; org.squeryl.test.customtypes.Patient)org.squeryl.dsl.fsm.SelectState[org.squeryl.test.customtypes.Patient]">select</a><span class="delimiter">(</span><a href="#136609" title="org.squeryl.test.customtypes.Patient">p</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>

  <a href="#11110" title="(testName: String, testTags: org.scalatest.Tag*)(testFun: =&gt; Unit)Unit">test</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Queries&quot;)" class="string">&quot;Queries&quot;</span><span class="delimiter">)</span><span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.squeryl.test.customtypes.TestData" id="136663">testObjects</a> = <a href="#117279" title="=&gt; org.squeryl.test.customtypes.TestData">sharedTestObjects</a>; <span class="keyword">import</span> <a href="#136663" title="org.squeryl.test.customtypes.TestData">testObjects</a>._

    <a href="../../framework/QueryTester.scala.html#117225" title="(name: Symbol, q: org.squeryl.Query[org.squeryl.test.customtypes.Patient], mapFunc: org.squeryl.test.customtypes.Patient =&gt; Int, expected: List[Int])Unit">validateQuery</a><span class="delimiter">(</span><span title="(name: String)Symbol" class="symbol">'simpleSelect</span>, <a href="#117283" title="=&gt; org.squeryl.Query[org.squeryl.test.customtypes.Patient]">simpleSelect</a>, <span class="delimiter">(</span>p:<a href="#11115" title="org.squeryl.test.customtypes.Patient">Patient</a><span class="delimiter">)</span>=&gt;<a href="#136697" title="org.squeryl.test.customtypes.Patient">p</a>.<a href="#136198" title="=&gt; org.squeryl.customtypes.IntField">id</a>.<a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69169" title="=&gt; Int">value</a>, <span title="(xs: Int*)List[Int]">List</span><span class="delimiter">(</span><a href="#136028" title="=&gt; org.squeryl.test.customtypes.Patient">joseCuervo</a>.<a href="#136198" title="=&gt; org.squeryl.customtypes.IntField">id</a>.<a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69169" title="=&gt; Int">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="../../framework/QueryTester.scala.html#117225" title="(name: Symbol, q: org.squeryl.Query[org.squeryl.test.customtypes.Patient], mapFunc: org.squeryl.test.customtypes.Patient =&gt; Int, expected: List[Int])Unit">validateQuery</a><span class="delimiter">(</span><span title="(name: String)Symbol" class="symbol">'simpleSelect1</span>, <a href="#136018" title="=&gt; org.squeryl.Table[org.squeryl.test.customtypes.Patient]">patients</a>.<a href="../../../../../main/org/squeryl/Queryable.scala.html#20047" title="(whereClauseFunctor: org.squeryl.test.customtypes.Patient =&gt; org.squeryl.dsl.ast.LogicalBoolean)(implicit dsl: org.squeryl.dsl.QueryDsl)org.squeryl.Query[org.squeryl.test.customtypes.Patient]">where</a><a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15261" title="=&gt; org.squeryl.dsl.QueryDsl" class="delimiter">(</a><a href="#136793" title="org.squeryl.test.customtypes.Patient">_</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15199" title="implicit org.squeryl.dsl.DslFactory.optionInt2ScalarInt : (i: Option[org.squeryl.customtypes.CustomTypesMode.IntType])org.squeryl.dsl.NumericalExpression[Option[org.squeryl.customtypes.CustomTypesMode.IntType]]">age</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18127" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType])org.squeryl.dsl.ast.BinaryOperatorNodeLogicalBoolean">&gt;</a> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69079" title="implicit org.squeryl.customtypes.CustomTypesMode.createConstantNodeOfScalarIntType : (i: Int)org.squeryl.dsl.ast.ConstantExpressionNode[org.squeryl.customtypes.CustomTypesMode.IntType] with org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType]" class="int">70</a><span class="delimiter">)</span>, <span class="delimiter">(</span>p:<a href="#11115" title="org.squeryl.test.customtypes.Patient">Patient</a><span class="delimiter">)</span>=&gt;<a href="#136830" title="org.squeryl.test.customtypes.Patient">p</a>.<a href="#136198" title="=&gt; org.squeryl.customtypes.IntField">id</a>.<a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69169" title="=&gt; Int">value</a>, <span title="(xs: Int*)List[Int]">List</span><span class="delimiter">(</span><a href="#136028" title="=&gt; org.squeryl.test.customtypes.Patient">joseCuervo</a>.<a href="#136198" title="=&gt; org.squeryl.customtypes.IntField">id</a>.<a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69169" title="=&gt; Int">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="../../framework/QueryTester.scala.html#117225" title="(name: Symbol, q: org.squeryl.Query[org.squeryl.test.customtypes.Patient], mapFunc: org.squeryl.test.customtypes.Patient =&gt; Int, expected: List[Int])Unit">validateQuery</a><span class="delimiter">(</span><span title="(name: String)Symbol" class="symbol">'simpleSelect2</span>, <a href="#136018" title="=&gt; org.squeryl.Table[org.squeryl.test.customtypes.Patient]">patients</a>.<a href="../../../../../main/org/squeryl/Queryable.scala.html#20047" title="(whereClauseFunctor: org.squeryl.test.customtypes.Patient =&gt; org.squeryl.dsl.ast.LogicalBoolean)(implicit dsl: org.squeryl.dsl.QueryDsl)org.squeryl.Query[org.squeryl.test.customtypes.Patient]">where</a><a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15261" title="=&gt; org.squeryl.dsl.QueryDsl" class="delimiter">(</a><a href="#136884" title="org.squeryl.test.customtypes.Patient">_</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15199" title="implicit org.squeryl.dsl.DslFactory.optionInt2ScalarInt : (i: Option[org.squeryl.customtypes.CustomTypesMode.IntType])org.squeryl.dsl.NumericalExpression[Option[org.squeryl.customtypes.CustomTypesMode.IntType]]">age</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18133" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType])org.squeryl.dsl.ast.BinaryOperatorNodeLogicalBoolean">&lt;</a> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69079" title="implicit org.squeryl.customtypes.CustomTypesMode.createConstantNodeOfScalarIntType : (i: Int)org.squeryl.dsl.ast.ConstantExpressionNode[org.squeryl.customtypes.CustomTypesMode.IntType] with org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType]" class="int">40</a><span class="delimiter">)</span>, <span class="delimiter">(</span>p:<a href="#11115" title="org.squeryl.test.customtypes.Patient">Patient</a><span class="delimiter">)</span>=&gt;<a href="#136923" title="org.squeryl.test.customtypes.Patient">p</a>.<a href="#136198" title="=&gt; org.squeryl.customtypes.IntField">id</a>.<a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69169" title="=&gt; Int">value</a>, <span title="(xs: Int*)List[Int]">List</span><span class="delimiter">(</span><a href="#136030" title="=&gt; org.squeryl.test.customtypes.Patient">raoulEspinoza</a>.<a href="#136198" title="=&gt; org.squeryl.customtypes.IntField">id</a>.<a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69169" title="=&gt; Int">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <a href="#11110" title="(testName: String, testTags: org.scalatest.Tag*)(testFun: =&gt; Unit)Unit">test</a><span class="delimiter">(</span><span title="java.lang.String(&quot;OneToMany&quot;)" class="string">&quot;OneToMany&quot;</span><span class="delimiter">)</span><span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.squeryl.test.customtypes.TestData" id="136958">testObjects</a> = <a href="#117279" title="=&gt; org.squeryl.test.customtypes.TestData">sharedTestObjects</a>; <span class="keyword">import</span> <a href="#136958" title="org.squeryl.test.customtypes.TestData">testObjects</a>._

    <span class="keyword">val</span> <a title="org.squeryl.test.customtypes.Patient" id="136960">jose</a> = <a href="#136018" title="=&gt; org.squeryl.Table[org.squeryl.test.customtypes.Patient]">patients</a>.<a href="../../../../../main/org/squeryl/Queryable.scala.html#20047" title="(whereClauseFunctor: org.squeryl.test.customtypes.Patient =&gt; org.squeryl.dsl.ast.LogicalBoolean)(implicit dsl: org.squeryl.dsl.QueryDsl)org.squeryl.Query[org.squeryl.test.customtypes.Patient]">where</a><a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15261" title="=&gt; org.squeryl.dsl.QueryDsl" class="delimiter">(</a><a href="#136964" title="org.squeryl.test.customtypes.Patient">_</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15199" title="implicit org.squeryl.dsl.DslFactory.optionInt2ScalarInt : (i: Option[org.squeryl.customtypes.CustomTypesMode.IntType])org.squeryl.dsl.NumericalExpression[Option[org.squeryl.customtypes.CustomTypesMode.IntType]]">age</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18127" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType])org.squeryl.dsl.ast.BinaryOperatorNodeLogicalBoolean">&gt;</a> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69079" title="implicit org.squeryl.customtypes.CustomTypesMode.createConstantNodeOfScalarIntType : (i: Int)org.squeryl.dsl.ast.ConstantExpressionNode[org.squeryl.customtypes.CustomTypesMode.IntType] with org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType]" class="int">70</a><span class="delimiter">)</span>.<a href="../../../../../main/org/squeryl/Query.scala.html#14065" title="=&gt; org.squeryl.test.customtypes.Patient">single</a>
    <span class="keyword">val</span> <a title="org.squeryl.test.customtypes.PatientInfo" id="136961">pi</a> = <span title="org.squeryl.test.customtypes.PatientInfo" class="keyword">new</span> <a href="#11116" title="org.squeryl.test.customtypes.PatientInfo">PatientInfo</a><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.Info" class="keyword">new</span> <a href="#11123" title="org.squeryl.test.customtypes.Info">Info</a><span class="delimiter">(</span><span title="java.lang.String(&quot;!!!!!&quot;)" class="string">&quot;!!!!!&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="org.squeryl.test.customtypes.PatientInfo" id="136962">pi0</a> = <span title="org.squeryl.test.customtypes.PatientInfo" class="keyword">new</span> <a href="#11116" title="org.squeryl.test.customtypes.PatientInfo">PatientInfo</a><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.Info" class="keyword">new</span> <a href="#11123" title="org.squeryl.test.customtypes.Info">Info</a><span class="delimiter">(</span><span title="java.lang.String(&quot;zzzz&quot;)" class="string">&quot;zzzz&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <a href="#136960" title="org.squeryl.test.customtypes.Patient">jose</a>.<a href="#136200" title="=&gt; org.squeryl.dsl.OneToMany[org.squeryl.test.customtypes.PatientInfo]">patientInfo</a>.<a href="../../../../../main/org/squeryl/dsl/ManyToMany.scala.html#75895" title="(m: org.squeryl.test.customtypes.PatientInfo)org.squeryl.test.customtypes.PatientInfo">assign</a><span class="delimiter">(</span><a href="#136962" title="org.squeryl.test.customtypes.PatientInfo">pi0</a><span class="delimiter">)</span>
    <a href="#11110" title="(condition: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#136960" title="org.squeryl.test.customtypes.Patient">jose</a>.<a href="#136198" title="=&gt; org.squeryl.customtypes.IntField">id</a>.<a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69169" title="=&gt; Int">value</a> <span title="(x: Int)Boolean">==</span> <a href="#136962" title="org.squeryl.test.customtypes.PatientInfo">pi0</a>.<a href="#137004" title="=&gt; org.squeryl.customtypes.IntField">patientId</a>.<a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#69169" title="=&gt; Int">value</a><span class="delimiter">)</span>
    <a href="#136020" title="=&gt; org.squeryl.Table[org.squeryl.test.customtypes.PatientInfo]">patientInfo</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.customtypes.PatientInfo)org.squeryl.test.customtypes.PatientInfo">insert</a><span class="delimiter">(</span><a href="#136962" title="org.squeryl.test.customtypes.PatientInfo">pi0</a><span class="delimiter">)</span>        

    <a href="#136960" title="org.squeryl.test.customtypes.Patient">jose</a>.<a href="#136200" title="=&gt; org.squeryl.dsl.OneToMany[org.squeryl.test.customtypes.PatientInfo]">patientInfo</a>.<a href="../../../../../main/org/squeryl/dsl/ManyToMany.scala.html#75896" title="(m: org.squeryl.test.customtypes.PatientInfo)(implicit ev: &lt;:&lt;[org.squeryl.test.customtypes.PatientInfo,org.squeryl.KeyedEntity[_]])org.squeryl.test.customtypes.PatientInfo">associate</a><span title="&lt;:&lt;[org.squeryl.test.customtypes.PatientInfo,org.squeryl.test.customtypes.PatientInfo]" class="delimiter">(</span><a href="#136961" title="org.squeryl.test.customtypes.PatientInfo">pi</a><span class="delimiter">)</span>

  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class TestData extends java.lang.Object with ScalaObject" id="11111">TestData</a><a href="#11111" title="ScalaObject" class="delimiter">(</a><a title="org.squeryl.test.customtypes.HospitalDb" id="136034">schema</a> : <a href="#11114" title="org.squeryl.test.customtypes.HospitalDb">HospitalDb</a><span class="delimiter">)</span><span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="org.squeryl.test.customtypes.Patient" id="136028">joseCuervo</a> = <a href="#136034" title="org.squeryl.test.customtypes.HospitalDb">schema</a>.<a href="#136018" title="=&gt; org.squeryl.Table[org.squeryl.test.customtypes.Patient]">patients</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.customtypes.Patient)org.squeryl.test.customtypes.Patient">insert</a><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.Patient" class="keyword">new</span> <a href="#11115" title="org.squeryl.test.customtypes.Patient">Patient</a><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.FirstName" class="keyword">new</span> <a href="#11120" title="org.squeryl.test.customtypes.FirstName">FirstName</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Jose&quot;)" class="string">&quot;Jose&quot;</span><span class="delimiter">)</span>, <span title="(x: org.squeryl.test.customtypes.Age)Some[org.squeryl.test.customtypes.Age]">Some</span><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.Age" class="keyword">new</span> <a href="#11119" title="org.squeryl.test.customtypes.Age">Age</a><span class="delimiter">(</span><span title="Int(76)" class="int">76</span><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(x: org.squeryl.test.customtypes.WeightInKilograms)Some[org.squeryl.test.customtypes.WeightInKilograms]">Some</span><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.WeightInKilograms" class="keyword">new</span> <a href="#11121" title="org.squeryl.test.customtypes.WeightInKilograms">WeightInKilograms</a><span class="delimiter">(</span><span title="Double(290.134)" class="double">290.134</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.squeryl.test.customtypes.Patient" id="136030">raoulEspinoza</a> = <a href="#136034" title="org.squeryl.test.customtypes.HospitalDb">schema</a>.<a href="#136018" title="=&gt; org.squeryl.Table[org.squeryl.test.customtypes.Patient]">patients</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.customtypes.Patient)org.squeryl.test.customtypes.Patient">insert</a><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.Patient" class="keyword">new</span> <a href="#11115" title="org.squeryl.test.customtypes.Patient">Patient</a><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.FirstName" class="keyword">new</span> <a href="#11120" title="org.squeryl.test.customtypes.FirstName">FirstName</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Raoul&quot;)" class="string">&quot;Raoul&quot;</span><span class="delimiter">)</span>, <span title="(x: org.squeryl.test.customtypes.Age)Some[org.squeryl.test.customtypes.Age]">Some</span><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.Age" class="keyword">new</span> <a href="#11119" title="org.squeryl.test.customtypes.Age">Age</a><span class="delimiter">(</span><span title="Int(32)" class="int">32</span><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="object None">None</span><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object org.squeryl.test.customtypes.HospitalDb" id="11112">HospitalDb</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#11114" title="org.squeryl.test.customtypes.HospitalDb">HospitalDb</a>

<span class="keyword">class</span> <a title="class HospitalDb extends java.lang.Object with org.squeryl.Schema with ScalaObject" id="11114">HospitalDb</a> <a href="#11114" title="ScalaObject" class="keyword">extends</a> <a href="../../../../../main/org/squeryl/Schema.scala.html#9839" title="org.squeryl.Schema">Schema</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#9994" title="object org.squeryl.customtypes.CustomTypesMode">CustomTypesMode</a>._
  
  <span class="keyword">val</span> <a title="org.squeryl.Table[org.squeryl.test.customtypes.Patient]" id="136018">patients</a> = <a href="../../../../../main/org/squeryl/Schema.scala.html#14359" title="[T]()(implicit manifestT: scala.reflect.Manifest[T])org.squeryl.Table[T]">table</a><span title="()(implicit manifestT: scala.reflect.Manifest[org.squeryl.test.customtypes.Patient])org.squeryl.Table[org.squeryl.test.customtypes.Patient]" class="delimiter">[</span><a href="#11115" title="org.squeryl.test.customtypes.Patient">Patient</a><span class="delimiter">]</span>

  <span class="keyword">val</span> <a title="org.squeryl.Table[org.squeryl.test.customtypes.PatientInfo]" id="136020">patientInfo</a> = <a href="../../../../../main/org/squeryl/Schema.scala.html#14359" title="[T]()(implicit manifestT: scala.reflect.Manifest[T])org.squeryl.Table[T]">table</a><span title="()(implicit manifestT: scala.reflect.Manifest[org.squeryl.test.customtypes.PatientInfo])org.squeryl.Table[org.squeryl.test.customtypes.PatientInfo]" class="delimiter">[</span><a href="#11116" title="org.squeryl.test.customtypes.PatientInfo">PatientInfo</a><span class="delimiter">]</span>

  <span class="keyword">val</span> <a title="org.squeryl.customtypes.CustomTypesMode.OneToManyRelationImpl[org.squeryl.test.customtypes.Patient,org.squeryl.test.customtypes.PatientInfo]" id="136022">patienttoPatientInfo</a> =
      <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15335" title="(ot: org.squeryl.Table[org.squeryl.test.customtypes.Patient], mt: org.squeryl.Table[org.squeryl.test.customtypes.PatientInfo])org.squeryl.customtypes.CustomTypesMode.OneToManyRelationBuilder[org.squeryl.test.customtypes.Patient,org.squeryl.test.customtypes.PatientInfo]">oneToManyRelation</a><span class="delimiter">(</span><a href="#136018" title="=&gt; org.squeryl.Table[org.squeryl.test.customtypes.Patient]">patients</a>, <a href="#136020" title="=&gt; org.squeryl.Table[org.squeryl.test.customtypes.PatientInfo]">patientInfo</a><span class="delimiter">)</span>.
      <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#79901" title="(f: (org.squeryl.test.customtypes.Patient, org.squeryl.test.customtypes.PatientInfo) =&gt; org.squeryl.dsl.ast.EqualityExpression)(implicit schema: org.squeryl.Schema)org.squeryl.customtypes.CustomTypesMode.OneToManyRelationImpl[org.squeryl.test.customtypes.Patient,org.squeryl.test.customtypes.PatientInfo]">via</a><a href="../../../../../main/org/squeryl/Schema.scala.html#14312" title="=&gt; org.squeryl.Schema" class="delimiter">(</a><span class="delimiter">(</span><a title="org.squeryl.test.customtypes.Patient" id="137055">p</a>,<a title="org.squeryl.test.customtypes.PatientInfo" id="137056">pi</a><span class="delimiter">)</span> =&gt; <a href="#137055" title="org.squeryl.test.customtypes.Patient">p</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15191" title="implicit org.squeryl.dsl.DslFactory.int2ScalarInt : (i: org.squeryl.customtypes.CustomTypesMode.IntType)org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType]">id</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="#137056" title="org.squeryl.test.customtypes.PatientInfo">pi</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15191" title="implicit org.squeryl.dsl.DslFactory.int2ScalarInt : (i: org.squeryl.customtypes.CustomTypesMode.IntType)org.squeryl.dsl.NumericalExpression[org.squeryl.customtypes.CustomTypesMode.IntType]">patientId</a><span class="delimiter">)</span>
  
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Unit" id="136024">drop</a> = <a href="#11114" title="org.squeryl.test.customtypes.HospitalDb" class="keyword">super</a>.<a href="../../../../../main/org/squeryl/Schema.scala.html#14344" title="=&gt; Unit">drop</a>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class Patient extends java.lang.Object with org.squeryl.KeyedEntity[org.squeryl.customtypes.IntField] with ScalaObject" id="11115">Patient</a><a href="#11115" title="ScalaObject" class="delimiter">(</a><span class="keyword">var</span> <a title="org.squeryl.test.customtypes.FirstName" id="136714">firstName</a>: <a href="#11120" title="org.squeryl.test.customtypes.FirstName">FirstName</a>, <span class="keyword">var</span> <a title="Option[org.squeryl.test.customtypes.Age]" id="136715">age</a>: <span title="Option[org.squeryl.test.customtypes.Age]">Option</span><span class="delimiter">[</span>Age<span class="delimiter">]</span>, <span class="keyword">var</span> <a title="Option[org.squeryl.test.customtypes.WeightInKilograms]" id="136716">weight</a>: <span title="Option[org.squeryl.test.customtypes.WeightInKilograms]">Option</span><span class="delimiter">[</span>WeightInKilograms<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../../../main/org/squeryl/KeyedEntity.scala.html#9788" title="org.squeryl.KeyedEntity[org.squeryl.customtypes.IntField]">KeyedEntity</a><span class="delimiter">[</span>IntField<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="()org.squeryl.test.customtypes.Patient" id="136196" class="keyword">this</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#11115" title="Patient.this.type" class="keyword">this</a><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <span title="(x: org.squeryl.test.customtypes.Age)Some[org.squeryl.test.customtypes.Age]">Some</span><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.Age" class="keyword">new</span> <a href="#11119" title="org.squeryl.test.customtypes.Age">Age</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>,<span title="(x: org.squeryl.test.customtypes.WeightInKilograms)Some[org.squeryl.test.customtypes.WeightInKilograms]">Some</span><span class="delimiter">(</span><span title="org.squeryl.test.customtypes.WeightInKilograms" class="keyword">new</span> <a href="#11121" title="org.squeryl.test.customtypes.WeightInKilograms">WeightInKilograms</a><span class="delimiter">(</span><span title="Double(1.0)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">var</span> <a title="org.squeryl.customtypes.IntField" id="136198">id</a>: <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#9997" title="org.squeryl.customtypes.IntField">IntField</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="org.squeryl.dsl.OneToMany[org.squeryl.test.customtypes.PatientInfo]" id="136201">patientInfo</a> = <a href="#11112" title="object org.squeryl.test.customtypes.HospitalDb">HospitalDb</a>.<a href="#136022" title="=&gt; org.squeryl.customtypes.CustomTypesMode.OneToManyRelationImpl[org.squeryl.test.customtypes.Patient,org.squeryl.test.customtypes.PatientInfo]">patienttoPatientInfo</a>.<a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#79950" title="(leftSide: org.squeryl.test.customtypes.Patient)org.squeryl.dsl.OneToMany[org.squeryl.test.customtypes.PatientInfo]">left</a><span class="delimiter">(</span><a href="#11115" title="org.squeryl.test.customtypes.Patient" class="keyword">this</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class PatientInfo extends java.lang.Object with org.squeryl.KeyedEntity[org.squeryl.customtypes.IntField] with ScalaObject" id="11116">PatientInfo</a><a href="#11116" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="org.squeryl.test.customtypes.Info" id="137010">info</a>: <a href="#11123" title="org.squeryl.test.customtypes.Info">Info</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../../../main/org/squeryl/KeyedEntity.scala.html#9788" title="org.squeryl.KeyedEntity[org.squeryl.customtypes.IntField]">KeyedEntity</a><span class="delimiter">[</span>IntField<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">val</span> <a title="org.squeryl.customtypes.IntField" id="137004">patientId</a>: <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#9997" title="org.squeryl.customtypes.IntField">IntField</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">val</span> <a title="org.squeryl.customtypes.IntField" id="137006">id</a>: <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#9997" title="org.squeryl.customtypes.IntField">IntField</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="org.squeryl.dsl.ManyToOne[org.squeryl.test.customtypes.Patient]" id="137009">patient</a> = <a href="#11112" title="object org.squeryl.test.customtypes.HospitalDb">HospitalDb</a>.<a href="#136022" title="=&gt; org.squeryl.customtypes.CustomTypesMode.OneToManyRelationImpl[org.squeryl.test.customtypes.Patient,org.squeryl.test.customtypes.PatientInfo]">patienttoPatientInfo</a>.<a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#79951" title="(rightSide: org.squeryl.test.customtypes.PatientInfo)org.squeryl.dsl.ManyToOne[org.squeryl.test.customtypes.Patient]">right</a><span class="delimiter">(</span><a href="#11116" title="org.squeryl.test.customtypes.PatientInfo" class="keyword">this</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * En example of trait that can be added to custom types,
 * to add meta data and validation 
 */</span>
<span class="keyword">trait</span> <a title="trait Domain[A] extends java.lang.Object with ScalaObject" id="11117">Domain</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="11118">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  self: Product1<span class="delimiter">[</span>Any<span class="delimiter">]</span> =&gt;

  <span class="keyword">def</span> <a title="=&gt; String" id="136623">label</a>: <span title="String">String</span>
  <span class="keyword">def</span> <a title="(a: A)Unit" id="136624">validate</a><span class="delimiter">(</span><a title="A" id="137162">a</a>: <a href="#11118" title="A">A</a><span class="delimiter">)</span>: <span title="Unit">Unit</span>
  <span class="keyword">def</span> <a title="=&gt; A" id="136625">value</a>: <a href="#11118" title="A">A</a>

  <a href="#136624" title="(a: A)Unit">validate</a><span class="delimiter">(</span><a href="#136625" title="=&gt; A">value</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class Age extends org.squeryl.customtypes.IntField with org.squeryl.test.customtypes.Domain[Int] with ScalaObject" id="11119">Age</a><a href="#11119" title="ScalaObject" class="delimiter">(</a><a title="Int" id="136728">v</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#9997" title="org.squeryl.customtypes.IntField">IntField</a><span class="delimiter">(</span><a href="#136728" title="Int">v</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#11117" title="org.squeryl.test.customtypes.Domain[Int]">Domain</a><span class="delimiter">[</span>Int<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="comment">// secondary constructor to show  #93</span>
  <span class="keyword">def</span> <a title="(s: String)org.squeryl.test.customtypes.Age" id="136618" class="keyword">this</a><span class="delimiter">(</span><a title="String" id="136727">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#11119" title="Age.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#136727" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>
  
  <span class="keyword">def</span> <a title="(a: Int)Unit" id="136619">validate</a><span class="delimiter">(</span><a title="Int" id="137186">a</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span title="(assertion: Boolean, message: =&gt; Any)Unit">assert</span><span class="delimiter">(</span><a href="#137186" title="Int">a</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span>, <span title="java.lang.String(&quot;age must be positive, got &quot;)" class="string">&quot;age must be positive, got &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#137186" title="Int">a</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="136620">label</a> = <span title="java.lang.String(&quot;age&quot;)" class="string">&quot;age&quot;</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class FirstName extends org.squeryl.customtypes.StringField with org.squeryl.test.customtypes.Domain[String] with ScalaObject" id="11120">FirstName</a><a href="#11120" title="ScalaObject" class="delimiter">(</a><a title="String" id="136722">v</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#9998" title="org.squeryl.customtypes.StringField">StringField</a><span class="delimiter">(</span><a href="#136722" title="String">v</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#11117" title="org.squeryl.test.customtypes.Domain[String]">Domain</a><span class="delimiter">[</span>String<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(s: String)Unit" id="136720">validate</a><span class="delimiter">(</span><a title="String" id="137202">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="(assertion: Boolean, message: =&gt; Any)Unit">assert</span><span class="delimiter">(</span><a href="#137202" title="String">s</a>.<span title="()Int">length</span> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(50)" class="int">50</span>, <span title="java.lang.String(&quot;first name is waaaay to long : &quot;)" class="string">&quot;first name is waaaay to long : &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#137202" title="String">s</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="136721">label</a> = <span title="java.lang.String(&quot;first name&quot;)" class="string">&quot;first name&quot;</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class WeightInKilograms extends org.squeryl.customtypes.DoubleField with org.squeryl.test.customtypes.Domain[Double] with ScalaObject" id="11121">WeightInKilograms</a><a href="#11121" title="ScalaObject" class="delimiter">(</a><a title="Double" id="136739">v</a>: <span title="Double">Double</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#9999" title="org.squeryl.customtypes.DoubleField">DoubleField</a><span class="delimiter">(</span><a href="#136739" title="Double">v</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#11117" title="org.squeryl.test.customtypes.Domain[Double]">Domain</a><span class="delimiter">[</span>Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(d: Double)Unit" id="136737">validate</a><span class="delimiter">(</span><a title="Double" id="137218">d</a>:<span title="Double">Double</span><span class="delimiter">)</span> = <span title="(assertion: Boolean, message: =&gt; Any)Unit">assert</span><span class="delimiter">(</span><a href="#137218" title="Double">d</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span>, <span title="java.lang.String(&quot;weight must be positive, got &quot;)" class="string">&quot;weight must be positive, got &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#137218" title="Double">d</a><span class="delimiter">)</span> 
  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="136738">label</a> = <span title="java.lang.String(&quot;weight (in kilograms)&quot;)" class="string">&quot;weight (in kilograms)&quot;</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class ReasonOfVisit extends org.squeryl.customtypes.StringField with org.squeryl.test.customtypes.Domain[String] with ScalaObject" id="11122">ReasonOfVisit</a><a href="#11122" title="ScalaObject" class="delimiter">(</a><a title="String" id="137239">v</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#9998" title="org.squeryl.customtypes.StringField">StringField</a><span class="delimiter">(</span><a href="#137239" title="String">v</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#11117" title="org.squeryl.test.customtypes.Domain[String]">Domain</a><span class="delimiter">[</span>String<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(s: String)Unit" id="137234">validate</a><span class="delimiter">(</span><a title="String" id="137240">s</a>:<span title="String">String</span><span class="delimiter">)</span> = <span title="(assertion: Boolean, message: =&gt; Any)Unit">assert</span><span class="delimiter">(</span><a href="#137240" title="String">s</a>.<span title="()Int">length</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span>, <span title="java.lang.String(&quot;invalid visit reason : &quot;)" class="string">&quot;invalid visit reason : &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#137240" title="String">s</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="137235">label</a> = <span title="java.lang.String(&quot;reason of visit&quot;)" class="string">&quot;reason of visit&quot;</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class Info extends org.squeryl.customtypes.StringField with org.squeryl.test.customtypes.Domain[String] with ScalaObject" id="11123">Info</a><a href="#11123" title="ScalaObject" class="delimiter">(</a><a title="String" id="137016">v</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../../../main/org/squeryl/customtypes/CustomTypesMode.scala.html#9998" title="org.squeryl.customtypes.StringField">StringField</a><span class="delimiter">(</span><a href="#137016" title="String">v</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#11117" title="org.squeryl.test.customtypes.Domain[String]">Domain</a><span class="delimiter">[</span>String<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(s: String)Unit" id="137014">validate</a><span class="delimiter">(</span><a title="String" id="137256">s</a>:<span title="String">String</span><span class="delimiter">)</span> = <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="137015">label</a> = <span title="java.lang.String(&quot;info&quot;)" class="string">&quot;info&quot;</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
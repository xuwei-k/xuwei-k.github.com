<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>test/org/squeryl/test/demo/MusicDb.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.squeryl.test.demo

<span class="comment">/*******************************************************************************
 * Copyright 2010 Maxime LÃ©vesque
 * 
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ***************************************************************************** */</span>
<span class="keyword">import</span> org.squeryl.<a href="../../../../../main/org/squeryl/PrimitiveTypeMode.scala.html#9807" title="object org.squeryl.PrimitiveTypeMode">PrimitiveTypeMode</a>._
<span class="keyword">import</span> org.squeryl.<span class="delimiter">{</span>Query, Session, KeyedEntity, Schema<span class="delimiter">}</span>
<span class="keyword">import</span> org.squeryl.dsl.GroupWithMeasures
<span class="keyword">import</span> org.squeryl.framework.<span class="delimiter">{</span>RunTestsInsideTransaction, SchemaTester<span class="delimiter">}</span>

<span class="comment">// The root object of the schema. Inheriting KeyedEntity[T] is not mandatory</span>
<span class="comment">// it just makes primary key methods available (delete and lookup) on tables.</span>
<span class="keyword">class</span> <a title="class MusicDbObject extends java.lang.Object with org.squeryl.KeyedEntity[Long] with ScalaObject" id="11133">MusicDbObject</a> <a href="#11133" title="ScalaObject" class="keyword">extends</a> <a href="../../../../../main/org/squeryl/KeyedEntity.scala.html#9788" title="org.squeryl.KeyedEntity[Long]">KeyedEntity</a><span class="delimiter">[</span>Long<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="Long" id="137267">id</a>: <span title="Long">Long</span> = <span title="Long(0L)" class="int">0</span>
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class Artist extends org.squeryl.test.demo.MusicDbObject with ScalaObject with Product with Serializable" id="143488">Artist</a><a href="#143488" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="String" id="143485">name</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11133" title="org.squeryl.test.demo.MusicDbObject">MusicDbObject</a> <span class="delimiter">{</span>

  <span class="comment">// this returns a Query[Song] which is also an Iterable[Song] :</span>
  <span class="keyword">def</span> <a title="=&gt; org.squeryl.Query[org.squeryl.test.demo.Song]" id="137274">songs</a> = <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15987" title="(t1: org.squeryl.Queryable[org.squeryl.test.demo.Song])(f: org.squeryl.test.demo.Song =&gt; org.squeryl.dsl.QueryYield[org.squeryl.test.demo.Song])org.squeryl.Query[org.squeryl.test.demo.Song]">from</a><span class="delimiter">(</span><a href="#11141" title="object org.squeryl.test.demo.MusicDb">MusicDb</a>.<a href="#137426" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Song]">songs</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="org.squeryl.test.demo.Song" id="137856">s</a> =&gt; <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15264" title="(b: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.fsm.WhereState[org.squeryl.dsl.fsm.Conditioned]">where</a><span class="delimiter">(</span><a href="#137856" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">artistId</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a><span class="delimiter">)</span> <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; org.squeryl.test.demo.Song)org.squeryl.dsl.fsm.SelectState[org.squeryl.test.demo.Song]">select</a><span class="delimiter">(</span><a href="#137856" title="org.squeryl.test.demo.Song">s</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(title: String, filePath: Option[String], year: Int)org.squeryl.test.demo.Song" id="137275">newSong</a><span class="delimiter">(</span><a title="String" id="137893">title</a>: <span title="String">String</span>, <a title="Option[String]" id="137894">filePath</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="Int" id="137895">year</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#11141" title="object org.squeryl.test.demo.MusicDb">MusicDb</a>.<a href="#137426" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Song]">songs</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.demo.Song)org.squeryl.test.demo.Song">insert</a><span class="delimiter">(</span><span title="org.squeryl.test.demo.Song" class="keyword">new</span> <a href="#11137" title="org.squeryl.test.demo.Song">Song</a><span class="delimiter">(</span><a href="#137893" title="String">title</a>, <a href="#137267" title="=&gt; Long">id</a>, <a href="#137894" title="Option[String]">filePath</a>, <a href="#137895" title="Int">year</a><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">// Option[] members are mapped to nullable database columns,</span>
<span class="comment">// otherwise they have a NOT NULL constraint.</span>
<span class="keyword">class</span> <a title="class Song extends org.squeryl.test.demo.MusicDbObject with ScalaObject" id="11137">Song</a><a href="#11137" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="String" id="137907">title</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="Long" id="137908">artistId</a>: <span title="Long">Long</span>, <span class="keyword">val</span> <a title="Option[String]" id="137909">filePath</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <span class="keyword">val</span> <a title="Int" id="137910">year</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11133" title="org.squeryl.test.demo.MusicDbObject">MusicDbObject</a> <span class="delimiter">{</span>

  <span class="comment">// IMPORTANT : currently classes with Option[] members *must* provide a zero arg</span>
  <span class="comment">// constructor where every Option[T] member gets initialized with Some(t:T).</span>
  <span class="comment">// or else Squeryl will not be able to reflect the type of the field, and an exception will</span>
  <span class="comment">// be thrown at table instantiation time.</span>
  <span class="keyword">def</span> <a title="()org.squeryl.test.demo.Song" id="137453" class="keyword">this</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#11137" title="Song.this.type" class="keyword">this</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="Long(0L)" class="int">0</span>, <span title="(x: java.lang.String)Some[java.lang.String]">Some</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

  <span class="comment">// the schema can be imported in the scope, to lighten the syntax :</span>
  <span class="keyword">import</span> <a href="#11141" title="object org.squeryl.test.demo.MusicDb">MusicDb</a>._
  
  <span class="comment">// An alternative (shorter) syntax for single table queries :</span>
  <span class="keyword">def</span> <a title="=&gt; org.squeryl.test.demo.Artist" id="137455">artist</a> = <a href="#137424" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Artist]">artists</a>.<a href="../../../../../main/org/squeryl/Queryable.scala.html#20047" title="(whereClauseFunctor: org.squeryl.test.demo.Artist =&gt; org.squeryl.dsl.ast.LogicalBoolean)(implicit dsl: org.squeryl.dsl.QueryDsl)org.squeryl.Query[org.squeryl.test.demo.Artist]">where</a><a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15261" title="=&gt; org.squeryl.dsl.QueryDsl" class="delimiter">(</a><a title="org.squeryl.test.demo.Artist" id="137977">a</a> =&gt; <a href="#137977" title="org.squeryl.test.demo.Artist">a</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">artistId</a><span class="delimiter">)</span>.<a href="../../../../../main/org/squeryl/Query.scala.html#14065" title="=&gt; org.squeryl.test.demo.Artist">single</a>

  <span class="comment">// Another alternative for lookup by primary key, since Artist is a</span>
  <span class="comment">// KeyedEntity[Long], it's table has a lookup[Long](k: Long)</span>
  <span class="comment">// method available :</span>
  <span class="keyword">def</span> <a title="=&gt; Option[org.squeryl.test.demo.Artist]" id="137456">lookupArtist</a> = <a href="#137424" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Artist]">artists</a>.<a href="../../../../../main/org/squeryl/View.scala.html#20466" title="(k: Long)(implicit ev: &lt;:&lt;[org.squeryl.test.demo.Artist,org.squeryl.KeyedEntity[Long]], implicit dsl: org.squeryl.dsl.QueryDsl)Option[org.squeryl.test.demo.Artist]">lookup</a><a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15261" title="&lt;:&lt;[org.squeryl.test.demo.Artist,org.squeryl.test.demo.Artist]" class="delimiter">(</a><a href="#137908" title="=&gt; Long">artistId</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class Playlist extends org.squeryl.test.demo.MusicDbObject with ScalaObject" id="11138">Playlist</a><a href="#11138" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="String" id="138050">name</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="138051">path</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11133" title="org.squeryl.test.demo.MusicDbObject">MusicDbObject</a> <span class="delimiter">{</span>

  <span class="keyword">import</span> <a href="#11141" title="object org.squeryl.test.demo.MusicDb">MusicDb</a>._

  <span class="comment">// a two table join : </span>
  <span class="keyword">def</span> <a title="=&gt; org.squeryl.Query[org.squeryl.test.demo.Song]" id="138039">songsInPlaylistOrder</a> =
    <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15992" title="(t1: org.squeryl.Queryable[org.squeryl.test.demo.PlaylistElement], t2: org.squeryl.Queryable[org.squeryl.test.demo.Song])(f: (org.squeryl.test.demo.PlaylistElement, org.squeryl.test.demo.Song) =&gt; org.squeryl.dsl.QueryYield[org.squeryl.test.demo.Song])org.squeryl.Query[org.squeryl.test.demo.Song]">from</a><span class="delimiter">(</span><a href="#137430" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.PlaylistElement]">playlistElements</a>, <a href="#137426" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Song]">songs</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="org.squeryl.test.demo.PlaylistElement" id="138245">ple</a>, <a title="org.squeryl.test.demo.Song" id="138246">s</a><span class="delimiter">)</span> =&gt;
      <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15264" title="(b: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.fsm.WhereState[org.squeryl.dsl.fsm.Conditioned]">where</a><span class="delimiter">(</span><a href="#138245" title="org.squeryl.test.demo.PlaylistElement">ple</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">playlistId</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a> <a href="../../../../../main/org/squeryl/dsl/ast/ExpressionNode.scala.html#61744" title="(b: org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.ast.BinaryOperatorNodeLogicalBoolean">and</a> <a href="#138245" title="org.squeryl.test.demo.PlaylistElement">ple</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">songId</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="#138246" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a><span class="delimiter">)</span>
      <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; org.squeryl.test.demo.Song)org.squeryl.dsl.fsm.SelectState[org.squeryl.test.demo.Song]">select</a><span class="delimiter">(</span><a href="#138246" title="org.squeryl.test.demo.Song">s</a><span class="delimiter">)</span>
      <a href="../../../../../main/org/squeryl/dsl/boilerplate/OrderBySignatures.scala.html#20509" title="(e1: =&gt; org.squeryl.dsl.ast.ExpressionNode)org.squeryl.dsl.QueryYield[org.squeryl.test.demo.Song]">orderBy</a><span class="delimiter">(</span><a href="#138245" title="org.squeryl.test.demo.PlaylistElement">ple</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15231" title="(e: Int)(implicit evidence$2: Int =&gt; org.squeryl.dsl.ast.TypedExpressionNode[_])org.squeryl.dsl.ast.OrderByArg">songNumber</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15234" title="implicit org.squeryl.dsl.DslFactory.orderByArg2OrderByExpression : (a: org.squeryl.dsl.ast.OrderByArg)org.squeryl.dsl.ast.OrderByExpression">asc</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(s: org.squeryl.test.demo.Song)org.squeryl.test.demo.PlaylistElement" id="138040">addSong</a><span class="delimiter">(</span><a title="org.squeryl.test.demo.Song" id="138519">s</a>: <a href="#11137" title="org.squeryl.test.demo.Song">Song</a><span class="delimiter">)</span> = <span class="delimiter">{</span>

    <span class="comment">// Note how this query can be implicitly converted to an Int since it returns</span>
    <span class="comment">// at most one row, this applies to all single column aggregate queries with no groupBy clause.</span>
    <span class="comment">// The nvl function in this example changed the return type to Int, from</span>
    <span class="comment">// Option[Int], since the 'max' function (like all aggregates, 'count' being the only exception).</span>
    <span class="keyword">val</span> <a title="Int" id="138522">nextSongNumber</a>: <span title="Int">Int</span> =
      <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15987" title="(t1: org.squeryl.Queryable[org.squeryl.test.demo.PlaylistElement])(f: org.squeryl.test.demo.PlaylistElement =&gt; org.squeryl.dsl.QueryYield[org.squeryl.dsl.Measures[org.squeryl.PrimitiveTypeMode.IntType]])org.squeryl.Query[org.squeryl.dsl.Measures[org.squeryl.PrimitiveTypeMode.IntType]]">from</a><span class="delimiter">(</span><a href="#137430" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.PlaylistElement]">playlistElements</a><span class="delimiter">)</span><a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15300" title="(cq: org.squeryl.Query[org.squeryl.dsl.Measures[org.squeryl.PrimitiveTypeMode.IntType]])org.squeryl.PrimitiveTypeMode.IntType" class="delimiter">(</a><a title="org.squeryl.test.demo.PlaylistElement" id="138667">ple</a> =&gt;
        <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15264" title="(b: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.fsm.WhereState[org.squeryl.dsl.fsm.Conditioned]">where</a><span class="delimiter">(</span><a href="#138667" title="org.squeryl.test.demo.PlaylistElement">ple</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">playlistId</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a><span class="delimiter">)</span>
        <a href="../../../../../main/org/squeryl/dsl/boilerplate/ComputeMeasuresSignaturesFromStartOrWhereState.scala.html#15772" title="(e1: =&gt; org.squeryl.dsl.ast.TypedExpressionNode[org.squeryl.PrimitiveTypeMode.IntType])org.squeryl.dsl.fsm.ComputeStateStartOrWhereState[org.squeryl.PrimitiveTypeMode.IntType]">compute</a><span class="delimiter">(</span><a href="../../../../../main/org/squeryl/dsl/SqlFunctions.scala.html#15659" title="(a: org.squeryl.dsl.NumericalExpression[Option[org.squeryl.PrimitiveTypeMode.IntType]], b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.IntType])org.squeryl.dsl.NvlFunctionNumerical[org.squeryl.PrimitiveTypeMode.IntType,org.squeryl.PrimitiveTypeMode.IntType]">nvl</a><a href="../../../../../main/org/squeryl/dsl/TypeArithmetic.scala.html#14763" title="implicit org.squeryl.dsl.TypeArithmetic.binaryOpConv12 : (op: org.squeryl.dsl.BinaryAMSOp[org.squeryl.PrimitiveTypeMode.IntType,org.squeryl.PrimitiveTypeMode.IntType])org.squeryl.dsl.NumericalTypeConversion[org.squeryl.PrimitiveTypeMode.IntType]" class="delimiter">(</a><a href="../../../../../main/org/squeryl/dsl/SqlFunctions.scala.html#15626" title="(e: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.IntType])org.squeryl.dsl.UnaryAgregateLengthNeutralOp[org.squeryl.PrimitiveTypeMode.IntType]">max</a><a href="../../../../../main/org/squeryl/dsl/TypeArithmetic.scala.html#15063" title="implicit org.squeryl.dsl.TypeArithmetic.unaryOpConv2 : (op: org.squeryl.dsl.UnaryAgregateLengthNeutralOp[org.squeryl.PrimitiveTypeMode.IntType])org.squeryl.dsl.NumericalTypeConversion[Option[org.squeryl.PrimitiveTypeMode.IntType]]" class="delimiter">(</a><a href="#138667" title="org.squeryl.test.demo.PlaylistElement">ple</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15191" title="implicit org.squeryl.dsl.DslFactory.int2ScalarInt : (i: org.squeryl.PrimitiveTypeMode.IntType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.IntType]">songNumber</a><span class="delimiter">)</span>, <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15191" title="implicit org.squeryl.dsl.DslFactory.int2ScalarInt : (i: org.squeryl.PrimitiveTypeMode.IntType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.IntType]" class="int">0</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">)</span>    
    
    <a href="#137430" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.PlaylistElement]">playlistElements</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.demo.PlaylistElement)org.squeryl.test.demo.PlaylistElement">insert</a><span class="delimiter">(</span><span title="org.squeryl.test.demo.PlaylistElement" class="keyword">new</span> <a href="#11139" title="org.squeryl.test.demo.PlaylistElement">PlaylistElement</a><span class="delimiter">(</span><a href="#138522" title="Int">nextSongNumber</a>, <a href="#137267" title="=&gt; Long">id</a>, <a href="#138519" title="org.squeryl.test.demo.Song">s</a>.<a href="#137267" title="=&gt; Long">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(song: org.squeryl.test.demo.Song)Int" id="138041">removeSong</a><span class="delimiter">(</span><a title="org.squeryl.test.demo.Song" id="140141">song</a>: <a href="#11137" title="org.squeryl.test.demo.Song">Song</a><span class="delimiter">)</span> =
    <a href="#137430" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.PlaylistElement]">playlistElements</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34614" title="(whereClause: org.squeryl.test.demo.PlaylistElement =&gt; org.squeryl.dsl.ast.LogicalBoolean)(implicit dsl: org.squeryl.dsl.QueryDsl)Int">deleteWhere</a><a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15261" title="=&gt; org.squeryl.dsl.QueryDsl" class="delimiter">(</a><a title="org.squeryl.test.demo.PlaylistElement" id="140146">ple</a> =&gt; <a href="#140146" title="org.squeryl.test.demo.PlaylistElement">ple</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">songId</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="#140141" title="org.squeryl.test.demo.Song">song</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(artist: org.squeryl.test.demo.Artist)Int" id="138042">removeSongOfArtist</a><span class="delimiter">(</span><a title="org.squeryl.test.demo.Artist" id="140184">artist</a>: <a href="#143488" title="org.squeryl.test.demo.Artist">Artist</a><span class="delimiter">)</span> =
    <a href="#137430" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.PlaylistElement]">playlistElements</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34614" title="(whereClause: org.squeryl.test.demo.PlaylistElement =&gt; org.squeryl.dsl.ast.LogicalBoolean)(implicit dsl: org.squeryl.dsl.QueryDsl)Int">deleteWhere</a><a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15261" title="=&gt; org.squeryl.dsl.QueryDsl" class="delimiter">(</a><a title="org.squeryl.test.demo.PlaylistElement" id="140188">ple</a> =&gt;
      <span class="delimiter">(</span><a href="#140188" title="org.squeryl.test.demo.PlaylistElement">ple</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">playlistId</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a><span class="delimiter">)</span> <a href="../../../../../main/org/squeryl/dsl/ast/ExpressionNode.scala.html#61744" title="(b: org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.ast.BinaryOperatorNodeLogicalBoolean">and</a>
      <span class="delimiter">(</span><a href="#140188" title="org.squeryl.test.demo.PlaylistElement">ple</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">songId</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18180" title="(e: org.squeryl.dsl.ast.RightHandSideOfIn[Long])(implicit evidence$1: Long =&gt; org.squeryl.dsl.NumericalExpression[_])org.squeryl.dsl.ast.InclusionOperator">in</a> <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15987" title="(t1: org.squeryl.Queryable[org.squeryl.test.demo.Song])(f: org.squeryl.test.demo.Song =&gt; org.squeryl.dsl.QueryYield[Long])org.squeryl.Query[Long]">from</a><span class="delimiter">(</span><a href="#138046" title="(artistId: Long)org.squeryl.Query[org.squeryl.test.demo.Song]">songsOf</a><span class="delimiter">(</span><a href="#140184" title="org.squeryl.test.demo.Artist">artist</a>.<a href="#137267" title="=&gt; Long">id</a><span class="delimiter">)</span><span class="delimiter">)</span><a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15268" title="(q: org.squeryl.Query[Long])org.squeryl.dsl.ast.RightHandSideOfIn[Long]" class="delimiter">(</a><a title="org.squeryl.test.demo.Song" id="140675">s</a> =&gt; <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; Long)org.squeryl.dsl.fsm.SelectState[Long]">select</a><span class="delimiter">(</span><a href="#140675" title="org.squeryl.test.demo.Song">s</a>.<a href="#137267" title="=&gt; Long">id</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">)</span>

  <span class="comment">// New concept : a group query with aggregate functions return GroupWithMeasures[K,M]</span>
  <span class="comment">// where K and M are tuples whose members correspond to the group by list and compute list</span>
  <span class="comment">// respectively.</span>
  <span class="keyword">def</span> <a title="=&gt; org.squeryl.Query[org.squeryl.dsl.GroupWithMeasures[Long,Long]]" id="138043">_songCountByArtistId</a>: <a href="../../../../../main/org/squeryl/Query.scala.html#9818" title="org.squeryl.Query[org.squeryl.dsl.GroupWithMeasures[Long,Long]]">Query</a><span class="delimiter">[</span>GroupWithMeasures<span class="delimiter">[</span>Long,Long<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15992" title="(t1: org.squeryl.Queryable[org.squeryl.test.demo.Artist], t2: org.squeryl.Queryable[org.squeryl.test.demo.Song])(f: (org.squeryl.test.demo.Artist, org.squeryl.test.demo.Song) =&gt; org.squeryl.dsl.QueryYield[org.squeryl.dsl.GroupWithMeasures[org.squeryl.PrimitiveTypeMode.LongType,org.squeryl.PrimitiveTypeMode.LongType]])org.squeryl.Query[org.squeryl.dsl.GroupWithMeasures[org.squeryl.PrimitiveTypeMode.LongType,org.squeryl.PrimitiveTypeMode.LongType]]">from</a><span class="delimiter">(</span><a href="#137424" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Artist]">artists</a>, <a href="#137426" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Song]">songs</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="org.squeryl.test.demo.Artist" id="140931">a</a>,<a title="org.squeryl.test.demo.Song" id="140932">s</a><span class="delimiter">)</span> =&gt;
      <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15264" title="(b: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.fsm.WhereState[org.squeryl.dsl.fsm.Conditioned]">where</a><span class="delimiter">(</span><a href="#140931" title="org.squeryl.test.demo.Artist">a</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="#140932" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">artistId</a><span class="delimiter">)</span>
      <a href="../../../../../main/org/squeryl/dsl/boilerplate/GroupBySignatures.scala.html#15683" title="(e1: =&gt; org.squeryl.dsl.ast.TypedExpressionNode[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.fsm.GroupByState[org.squeryl.PrimitiveTypeMode.LongType]">groupBy</a><span class="delimiter">(</span><a href="#140931" title="org.squeryl.test.demo.Artist">a</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a><span class="delimiter">)</span>
      <a href="../../../../../main/org/squeryl/dsl/boilerplate/ComputeMeasuresSignaturesFromGroupByState.scala.html#86017" title="(e1: =&gt; org.squeryl.dsl.ast.TypedExpressionNode[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.fsm.ComputeStateFromGroupByState[org.squeryl.PrimitiveTypeMode.LongType,org.squeryl.PrimitiveTypeMode.LongType]">compute</a><span class="delimiter">(</span><a href="../../../../../main/org/squeryl/dsl/SqlFunctions.scala.html#15656" title="=&gt; org.squeryl.PrimitiveTypeMode.CountFunction">count</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>

  <span class="comment">// Queries are nestable just as they would in SQL</span>
  <span class="keyword">def</span> <a title="=&gt; org.squeryl.Query[(org.squeryl.test.demo.Artist, Long)]" id="138044">songCountForAllArtists</a>  =
    <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15992" title="(t1: org.squeryl.Queryable[org.squeryl.dsl.GroupWithMeasures[Long,Long]], t2: org.squeryl.Queryable[org.squeryl.test.demo.Artist])(f: (org.squeryl.dsl.GroupWithMeasures[Long,Long], org.squeryl.test.demo.Artist) =&gt; org.squeryl.dsl.QueryYield[(org.squeryl.test.demo.Artist, Long)])org.squeryl.Query[(org.squeryl.test.demo.Artist, Long)]">from</a><span class="delimiter">(</span><a href="#138043" title="=&gt; org.squeryl.Query[org.squeryl.dsl.GroupWithMeasures[Long,Long]]">_songCountByArtistId</a>, <a href="#137424" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Artist]">artists</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="org.squeryl.dsl.GroupWithMeasures[Long,Long]" id="141269">sca</a>,<a title="org.squeryl.test.demo.Artist" id="141270">a</a><span class="delimiter">)</span> =&gt;
      <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15264" title="(b: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.fsm.WhereState[org.squeryl.dsl.fsm.Conditioned]">where</a><span class="delimiter">(</span><a href="#141269" title="org.squeryl.dsl.GroupWithMeasures[Long,Long]">sca</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">key</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="#141270" title="org.squeryl.test.demo.Artist">a</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a><span class="delimiter">)</span>
      <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; (org.squeryl.test.demo.Artist, Long))org.squeryl.dsl.fsm.SelectState[(org.squeryl.test.demo.Artist, Long)]">select</a><span class="delimiter">(</span><span title="(_1: org.squeryl.test.demo.Artist, _2: Long)(org.squeryl.test.demo.Artist, Long)" class="delimiter">(</span><a href="#141270" title="org.squeryl.test.demo.Artist">a</a>, <a href="#141269" title="org.squeryl.dsl.GroupWithMeasures[Long,Long]">sca</a>.<a href="../../../../../main/org/squeryl/dsl/Group.scala.html#75835" title="=&gt; Long">measures</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">)</span>

  <span class="comment">// Unlike SQL, a function that returns a query can be nested</span>
  <span class="comment">// as if it were a query, notice the nesting of 'songsOf'</span>
  <span class="comment">// allowing DRY persistence layers as reuse is enhanced.</span>
  <span class="keyword">def</span> <a title="(artistId: Long)Option[org.squeryl.test.demo.Song]" id="138045">latestSongFrom</a><span class="delimiter">(</span><a title="Long" id="141319">artistId</a>: <span title="Long">Long</span><span class="delimiter">)</span> =
    <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15987" title="(t1: org.squeryl.Queryable[org.squeryl.test.demo.Song])(f: org.squeryl.test.demo.Song =&gt; org.squeryl.dsl.QueryYield[org.squeryl.test.demo.Song])org.squeryl.Query[org.squeryl.test.demo.Song]">from</a><span class="delimiter">(</span><a href="#138046" title="(artistId: Long)org.squeryl.Query[org.squeryl.test.demo.Song]">songsOf</a><span class="delimiter">(</span><a href="#141319" title="Long">artistId</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="org.squeryl.test.demo.Song" id="141466">s</a> =&gt;
      <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; org.squeryl.test.demo.Song)org.squeryl.dsl.fsm.SelectState[org.squeryl.test.demo.Song]">select</a><span class="delimiter">(</span><a href="#141466" title="org.squeryl.test.demo.Song">s</a><span class="delimiter">)</span>
      <a href="../../../../../main/org/squeryl/dsl/boilerplate/OrderBySignatures.scala.html#20509" title="(e1: =&gt; org.squeryl.dsl.ast.ExpressionNode)org.squeryl.dsl.QueryYield[org.squeryl.test.demo.Song]">orderBy</a><span class="delimiter">(</span><a href="#141466" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15231" title="(e: Long)(implicit evidence$2: Long =&gt; org.squeryl.dsl.ast.TypedExpressionNode[_])org.squeryl.dsl.ast.OrderByArg">id</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15234" title="implicit org.squeryl.dsl.DslFactory.orderByArg2OrderByExpression : (a: org.squeryl.dsl.ast.OrderByArg)org.squeryl.dsl.ast.OrderByExpression">desc</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>.<a href="../../../../../main/org/squeryl/Query.scala.html#14066" title="=&gt; Option[org.squeryl.test.demo.Song]">headOption</a>

  <span class="keyword">def</span> <a title="(artistId: Long)org.squeryl.Query[org.squeryl.test.demo.Song]" id="138046">songsOf</a><span class="delimiter">(</span><a title="Long" id="140404">artistId</a>: <span title="Long">Long</span><span class="delimiter">)</span> =
    <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15992" title="(t1: org.squeryl.Queryable[org.squeryl.test.demo.PlaylistElement], t2: org.squeryl.Queryable[org.squeryl.test.demo.Song])(f: (org.squeryl.test.demo.PlaylistElement, org.squeryl.test.demo.Song) =&gt; org.squeryl.dsl.QueryYield[org.squeryl.test.demo.Song])org.squeryl.Query[org.squeryl.test.demo.Song]">from</a><span class="delimiter">(</span><a href="#137430" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.PlaylistElement]">playlistElements</a>, <a href="#137426" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Song]">songs</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="org.squeryl.test.demo.PlaylistElement" id="140555">ple</a>,<a title="org.squeryl.test.demo.Song" id="140556">s</a><span class="delimiter">)</span> =&gt;
      <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15264" title="(b: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.fsm.WhereState[org.squeryl.dsl.fsm.Conditioned]">where</a><span class="delimiter">(</span><a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="#140555" title="org.squeryl.test.demo.PlaylistElement">ple</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">playlistId</a> <a href="../../../../../main/org/squeryl/dsl/ast/ExpressionNode.scala.html#61744" title="(b: org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.ast.BinaryOperatorNodeLogicalBoolean">and</a> <a href="#140555" title="org.squeryl.test.demo.PlaylistElement">ple</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">songId</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="#140556" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a> <a href="../../../../../main/org/squeryl/dsl/ast/ExpressionNode.scala.html#61744" title="(b: org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.ast.BinaryOperatorNodeLogicalBoolean">and</a> <a href="#140556" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">artistId</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">artistId</a><span class="delimiter">)</span>
      <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; org.squeryl.test.demo.Song)org.squeryl.dsl.fsm.SelectState[org.squeryl.test.demo.Song]">select</a><span class="delimiter">(</span><a href="#140556" title="org.squeryl.test.demo.Song">s</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>
<span class="delimiter">}</span>


<span class="keyword">class</span> <a title="class PlaylistElement extends java.lang.Object with ScalaObject" id="11139">PlaylistElement</a><a href="#11139" title="ScalaObject" class="delimiter">(</a><span class="keyword">var</span> <a title="Int" id="140138">songNumber</a>: <span title="Int">Int</span>, <span class="keyword">var</span> <a title="Long" id="140139">playlistId</a>: <span title="Long">Long</span>, <span class="keyword">var</span> <a title="Long" id="140140">songId</a>: <span title="Long">Long</span><span class="delimiter">)</span>


<span class="keyword">class</span> <a title="class Rating extends java.lang.Object with ScalaObject" id="11140">Rating</a><a href="#11140" title="ScalaObject" class="delimiter">(</a><span class="keyword">var</span> <a title="Long" id="141624">userId</a>: <span title="Long">Long</span>, <span class="keyword">var</span> <a title="Int" id="141625">appreciationScore</a>: <span title="Int">Int</span>, <span class="keyword">var</span> <a title="Int" id="141626">songId</a>: <span title="Int">Int</span><span class="delimiter">)</span>


<span class="keyword">object</span> <a title="object org.squeryl.test.demo.MusicDb" id="11141">MusicDb</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../../main/org/squeryl/Schema.scala.html#9839" title="org.squeryl.Schema">Schema</a> <span class="delimiter">{</span>

  <span class="keyword">val</span> <a title="org.squeryl.Table[org.squeryl.test.demo.Artist]" id="137424">artists</a> = <a href="../../../../../main/org/squeryl/Schema.scala.html#14359" title="[T]()(implicit manifestT: scala.reflect.Manifest[T])org.squeryl.Table[T]">table</a><span title="()(implicit manifestT: scala.reflect.Manifest[org.squeryl.test.demo.Artist])org.squeryl.Table[org.squeryl.test.demo.Artist]" class="delimiter">[</span><a href="#143488" title="org.squeryl.test.demo.Artist">Artist</a><span class="delimiter">]</span>
  <span class="keyword">val</span> <a title="org.squeryl.Table[org.squeryl.test.demo.Song]" id="137426">songs</a> = <a href="../../../../../main/org/squeryl/Schema.scala.html#14359" title="[T]()(implicit manifestT: scala.reflect.Manifest[T])org.squeryl.Table[T]">table</a><span title="()(implicit manifestT: scala.reflect.Manifest[org.squeryl.test.demo.Song])org.squeryl.Table[org.squeryl.test.demo.Song]" class="delimiter">[</span><a href="#11137" title="org.squeryl.test.demo.Song">Song</a><span class="delimiter">]</span>
  <span class="keyword">val</span> <a title="org.squeryl.Table[org.squeryl.test.demo.Playlist]" id="137428">playlists</a> = <a href="../../../../../main/org/squeryl/Schema.scala.html#14359" title="[T]()(implicit manifestT: scala.reflect.Manifest[T])org.squeryl.Table[T]">table</a><span title="()(implicit manifestT: scala.reflect.Manifest[org.squeryl.test.demo.Playlist])org.squeryl.Table[org.squeryl.test.demo.Playlist]" class="delimiter">[</span><a href="#11138" title="org.squeryl.test.demo.Playlist">Playlist</a><span class="delimiter">]</span>
  <span class="keyword">val</span> <a title="org.squeryl.Table[org.squeryl.test.demo.PlaylistElement]" id="137430">playlistElements</a> = <a href="../../../../../main/org/squeryl/Schema.scala.html#14359" title="[T]()(implicit manifestT: scala.reflect.Manifest[T])org.squeryl.Table[T]">table</a><span title="()(implicit manifestT: scala.reflect.Manifest[org.squeryl.test.demo.PlaylistElement])org.squeryl.Table[org.squeryl.test.demo.PlaylistElement]" class="delimiter">[</span><a href="#11139" title="org.squeryl.test.demo.PlaylistElement">PlaylistElement</a><span class="delimiter">]</span>
  <span class="keyword">val</span> <a title="org.squeryl.Table[org.squeryl.test.demo.Rating]" id="137432">ratings</a> = <a href="../../../../../main/org/squeryl/Schema.scala.html#14359" title="[T]()(implicit manifestT: scala.reflect.Manifest[T])org.squeryl.Table[T]">table</a><span title="()(implicit manifestT: scala.reflect.Manifest[org.squeryl.test.demo.Rating])org.squeryl.Table[org.squeryl.test.demo.Rating]" class="delimiter">[</span><a href="#11140" title="org.squeryl.test.demo.Rating">Rating</a><span class="delimiter">]</span>

  <span class="comment">// drop (schema) is normaly protected... for safety, here we live dangerously !</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Unit" id="137434">drop</a> = <span class="keyword">super</span>.<a href="../../../../../main/org/squeryl/Schema.scala.html#14344" title="=&gt; Unit">drop</a>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class TestData extends java.lang.Object with ScalaObject" id="11143">TestData</a><a href="#11143" title="ScalaObject" class="delimiter">{</a>
  <span class="keyword">import</span> <a href="#11141" title="object org.squeryl.test.demo.MusicDb">MusicDb</a>._

  <span class="keyword">val</span> <a title="org.squeryl.test.demo.Artist" id="141690">herbyHancock</a> = <a href="#137424" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Artist]">artists</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.demo.Artist)org.squeryl.test.demo.Artist">insert</a><span class="delimiter">(</span><span title="org.squeryl.test.demo.Artist" class="keyword">new</span> <a href="#143488" title="org.squeryl.test.demo.Artist">Artist</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Herby Hancock&quot;)" class="string">&quot;Herby Hancock&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.squeryl.test.demo.Artist" id="141692">ponchoSanchez</a> = <a href="#137424" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Artist]">artists</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.demo.Artist)org.squeryl.test.demo.Artist">insert</a><span class="delimiter">(</span><span title="org.squeryl.test.demo.Artist" class="keyword">new</span> <a href="#143488" title="org.squeryl.test.demo.Artist">Artist</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Poncho Sanchez&quot;)" class="string">&quot;Poncho Sanchez&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.squeryl.test.demo.Artist" id="141694">mongoSantaMaria</a> = <a href="#137424" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Artist]">artists</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.demo.Artist)org.squeryl.test.demo.Artist">insert</a><span class="delimiter">(</span><span title="org.squeryl.test.demo.Artist" class="keyword">new</span> <a href="#143488" title="org.squeryl.test.demo.Artist">Artist</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Mongo Santa Maria&quot;)" class="string">&quot;Mongo Santa Maria&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.squeryl.test.demo.Artist" id="141696">theMeters</a> = <a href="#137424" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Artist]">artists</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.demo.Artist)org.squeryl.test.demo.Artist">insert</a><span class="delimiter">(</span><span title="org.squeryl.test.demo.Artist" class="keyword">new</span> <a href="#143488" title="org.squeryl.test.demo.Artist">Artist</a><span class="delimiter">(</span><span title="java.lang.String(&quot;The Meters&quot;)" class="string">&quot;The Meters&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="org.squeryl.test.demo.Song" id="141698">watermelonMan</a> = <a href="#141690" title="=&gt; org.squeryl.test.demo.Artist">herbyHancock</a>.<a href="#137275" title="(title: String, filePath: Option[String], year: Int)org.squeryl.test.demo.Song">newSong</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Watermelon Man&quot;)" class="string">&quot;Watermelon Man&quot;</span>, <span title="object None">None</span>, <span title="Int(1962)" class="int">1962</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.squeryl.test.demo.Song" id="141700">besameMama</a> = <a href="#141694" title="=&gt; org.squeryl.test.demo.Artist">mongoSantaMaria</a>.<a href="#137275" title="(title: String, filePath: Option[String], year: Int)org.squeryl.test.demo.Song">newSong</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Besame Mama&quot;)" class="string">&quot;Besame Mama&quot;</span>, <span title="(x: java.lang.String)Some[java.lang.String]">Some</span><span class="delimiter">(</span><span title="java.lang.String(&quot;c:/MyMusic/besameMama.flac&quot;)" class="string">&quot;c:/MyMusic/besameMama.flac&quot;</span><span class="delimiter">)</span>, <span title="Int(1998)" class="int">1998</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.squeryl.test.demo.Song" id="141702">freedomSound</a> = <a href="#141692" title="=&gt; org.squeryl.test.demo.Artist">ponchoSanchez</a>.<a href="#137275" title="(title: String, filePath: Option[String], year: Int)org.squeryl.test.demo.Song">newSong</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Freedom Sound&quot;)" class="string">&quot;Freedom Sound&quot;</span>, <span title="object None">None</span>, <span title="Int(1997)" class="int">1997</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.squeryl.test.demo.Song" id="141704">funkifyYouLife</a> = <a href="#141696" title="=&gt; org.squeryl.test.demo.Artist">theMeters</a>.<a href="#137275" title="(title: String, filePath: Option[String], year: Int)org.squeryl.test.demo.Song">newSong</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Funkify Your Life&quot;)" class="string">&quot;Funkify Your Life&quot;</span>, <span title="object None">None</span>,<span title="Int(1969)" class="int">1969</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.squeryl.test.demo.Song" id="141706">goodOldFunkyMusic</a> = <a href="#141696" title="=&gt; org.squeryl.test.demo.Artist">theMeters</a>.<a href="#137275" title="(title: String, filePath: Option[String], year: Int)org.squeryl.test.demo.Song">newSong</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Good old Funky Music&quot;)" class="string">&quot;Good old Funky Music&quot;</span>, <span title="object None">None</span>, <span title="Int(1968)" class="int">1968</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.squeryl.test.demo.Playlist" id="141708">funkAndLatinJazz</a> = <a href="#137428" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Playlist]">playlists</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.demo.Playlist)org.squeryl.test.demo.Playlist">insert</a><span class="delimiter">(</span><span title="org.squeryl.test.demo.Playlist" class="keyword">new</span> <a href="#11138" title="org.squeryl.test.demo.Playlist">Playlist</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Funk and Latin Jazz&quot;)" class="string">&quot;Funk and Latin Jazz&quot;</span>, <span title="java.lang.String(&quot;c:/myPlayLists/funkAndLatinJazz&quot;)" class="string">&quot;c:/myPlayLists/funkAndLatinJazz&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class KickTheTires extends org.squeryl.framework.SchemaTester with org.squeryl.framework.RunTestsInsideTransaction with ScalaObject" id="11144">KickTheTires</a> <a href="#11144" title="ScalaObject" class="keyword">extends</a> <a href="../../framework/SchemaTester.scala.html#10951" title="org.squeryl.framework.SchemaTester">SchemaTester</a> <span class="keyword">with</span> <a href="../../framework/RunTestsInsideTransaction.scala.html#10942" title="org.squeryl.framework.RunTestsInsideTransaction">RunTestsInsideTransaction</a><span class="delimiter">{</span>

  <span class="keyword">val</span> <a title="org.squeryl.test.demo.MusicDb.type" id="117287">schema</a> = <a href="#11141" title="object org.squeryl.test.demo.MusicDb">MusicDb</a>

  <span class="keyword">import</span> <a href="#117287" title="=&gt; org.squeryl.test.demo.MusicDb.type">schema</a>._

  <span class="keyword">var</span> <a title="org.squeryl.test.demo.TestData" id="117291">sharedTestData</a> : <a href="#11143" title="org.squeryl.test.demo.TestData">TestData</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="117293">prePopulate</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">{</span>
    <a href="#117291" title="(x$1: org.squeryl.test.demo.TestData)Unit">sharedTestData</a> = <span title="org.squeryl.test.demo.TestData" class="keyword">new</span> <a href="#11143" title="org.squeryl.test.demo.TestData">TestData</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>


  <a href="#11144" title="(testName: String, testTags: org.scalatest.Tag*)(testFun: =&gt; Unit)Unit">test</a><span class="delimiter">(</span><span title="java.lang.String(&quot;kick tires&quot;)" class="string">&quot;kick tires&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.squeryl.test.demo.TestData" id="141743">testData</a> = <a href="#117291" title="=&gt; org.squeryl.test.demo.TestData">sharedTestData</a>; <span class="keyword">import</span> <a href="#141743" title="org.squeryl.test.demo.TestData">testData</a>._

    <a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#138040" title="(s: org.squeryl.test.demo.Song)org.squeryl.test.demo.PlaylistElement">addSong</a><span class="delimiter">(</span><a href="#141698" title="=&gt; org.squeryl.test.demo.Song">watermelonMan</a><span class="delimiter">)</span>
    <a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#138040" title="(s: org.squeryl.test.demo.Song)org.squeryl.test.demo.PlaylistElement">addSong</a><span class="delimiter">(</span><a href="#141700" title="=&gt; org.squeryl.test.demo.Song">besameMama</a><span class="delimiter">)</span>
    <a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#138040" title="(s: org.squeryl.test.demo.Song)org.squeryl.test.demo.PlaylistElement">addSong</a><span class="delimiter">(</span><a href="#141702" title="=&gt; org.squeryl.test.demo.Song">freedomSound</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="org.squeryl.test.demo.Playlist" id="141745">decadeOf1960</a> = <a href="#137428" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Playlist]">playlists</a>.<a href="../../../../../main/org/squeryl/Table.scala.html#34602" title="(t: org.squeryl.test.demo.Playlist)org.squeryl.test.demo.Playlist">insert</a><span class="delimiter">(</span><span title="org.squeryl.test.demo.Playlist" class="keyword">new</span> <a href="#11138" title="org.squeryl.test.demo.Playlist">Playlist</a><span class="delimiter">(</span><span title="java.lang.String(&quot;1960s&quot;)" class="string">&quot;1960s&quot;</span>, <span title="java.lang.String(&quot;c:/myPlayLists/funkAndLatinJazz&quot;)" class="string">&quot;c:/myPlayLists/funkAndLatinJazz&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    
    <a href="#141745" title="org.squeryl.test.demo.Playlist">decadeOf1960</a>.<a href="#138040" title="(s: org.squeryl.test.demo.Song)org.squeryl.test.demo.PlaylistElement">addSong</a><span class="delimiter">(</span><a href="#141698" title="=&gt; org.squeryl.test.demo.Song">watermelonMan</a><span class="delimiter">)</span>
    <a href="#141745" title="org.squeryl.test.demo.Playlist">decadeOf1960</a>.<a href="#138040" title="(s: org.squeryl.test.demo.Song)org.squeryl.test.demo.PlaylistElement">addSong</a><span class="delimiter">(</span><a href="#141704" title="=&gt; org.squeryl.test.demo.Song">funkifyYouLife</a><span class="delimiter">)</span>
    <a href="#141745" title="org.squeryl.test.demo.Playlist">decadeOf1960</a>.<a href="#138040" title="(s: org.squeryl.test.demo.Song)org.squeryl.test.demo.PlaylistElement">addSong</a><span class="delimiter">(</span><a href="#141706" title="=&gt; org.squeryl.test.demo.Song">goodOldFunkyMusic</a><span class="delimiter">)</span>

    <span class="comment">//Session.currentSession.setLogger(m =&gt; println(m))</span>

    <span class="comment">// Nesting a query in a where clause : </span>
    <span class="keyword">val</span> <a title="org.squeryl.Query[org.squeryl.test.demo.Song]" id="141746">songsFromThe60sInFunkAndLatinJazzPlaylist</a> =
      <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15987" title="(t1: org.squeryl.Queryable[org.squeryl.test.demo.Song])(f: org.squeryl.test.demo.Song =&gt; org.squeryl.dsl.QueryYield[org.squeryl.test.demo.Song])org.squeryl.Query[org.squeryl.test.demo.Song]">from</a><span class="delimiter">(</span><a href="#137426" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Song]">songs</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="org.squeryl.test.demo.Song" id="141903">s</a>=&gt;
        <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15264" title="(b: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.fsm.WhereState[org.squeryl.dsl.fsm.Conditioned]">where</a><span class="delimiter">(</span><a href="#141903" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18180" title="(e: org.squeryl.dsl.ast.RightHandSideOfIn[Long])(implicit evidence$1: Long =&gt; org.squeryl.dsl.NumericalExpression[_])org.squeryl.dsl.ast.InclusionOperator">in</a> <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15987" title="(t1: org.squeryl.Queryable[org.squeryl.test.demo.Song])(f: org.squeryl.test.demo.Song =&gt; org.squeryl.dsl.QueryYield[Long])org.squeryl.Query[Long]">from</a><span class="delimiter">(</span><a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#138039" title="=&gt; org.squeryl.Query[org.squeryl.test.demo.Song]">songsInPlaylistOrder</a><span class="delimiter">)</span><a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15268" title="(q: org.squeryl.Query[Long])org.squeryl.dsl.ast.RightHandSideOfIn[Long]" class="delimiter">(</a><a title="org.squeryl.test.demo.Song" id="142087">s2</a> =&gt; <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; Long)org.squeryl.dsl.fsm.SelectState[Long]">select</a><span class="delimiter">(</span><a href="#142087" title="org.squeryl.test.demo.Song">s2</a>.<a href="#137267" title="=&gt; Long">id</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; org.squeryl.test.demo.Song)org.squeryl.dsl.fsm.SelectState[org.squeryl.test.demo.Song]">select</a><span class="delimiter">(</span><a href="#141903" title="org.squeryl.test.demo.Song">s</a><span class="delimiter">)</span>
      <span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scala.collection.immutable.Set[Long]" id="141747">songIds</a> =
      <a href="#141746" title="org.squeryl.Query[org.squeryl.test.demo.Song]">songsFromThe60sInFunkAndLatinJazzPlaylist</a>.<span title="(f: org.squeryl.test.demo.Song =&gt; Long)(implicit bf: scala.collection.generic.CanBuildFrom[Iterable[org.squeryl.test.demo.Song],Long,Iterable[Long]])Iterable[Long]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Iterable.Coll,Long,Iterable[Long]]" class="delimiter">(</span><a href="#142255" title="org.squeryl.test.demo.Song">_</a>.<a href="#137267" title="=&gt; Long">id</a><span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[Long]">toSet</span>

    <a href="#11144" title="(condition: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#141747" title="scala.collection.immutable.Set[Long]">songIds</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#138039" title="=&gt; org.squeryl.Query[org.squeryl.test.demo.Song]">songsInPlaylistOrder</a>.<span title="(f: org.squeryl.test.demo.Song =&gt; Long)(implicit bf: scala.collection.generic.CanBuildFrom[Iterable[org.squeryl.test.demo.Song],Long,Iterable[Long]])Iterable[Long]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Iterable.Coll,Long,Iterable[Long]]" class="delimiter">(</span><a href="#142315" title="org.squeryl.test.demo.Song">_</a>.<a href="#137267" title="=&gt; Long">id</a><span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[Long]">toSet</span><span class="delimiter">)</span>

    <span class="comment">// Nesting in From clause :</span>
    <span class="keyword">val</span> <a title="org.squeryl.Query[org.squeryl.test.demo.Song]" id="141748">songsFromThe60sInFunkAndLatinJazzPlaylist2</a> =
      <a href="../../../../../main/org/squeryl/dsl/boilerplate/FromSignatures.scala.html#15987" title="(t1: org.squeryl.Queryable[org.squeryl.test.demo.Song])(f: org.squeryl.test.demo.Song =&gt; org.squeryl.dsl.QueryYield[org.squeryl.test.demo.Song])org.squeryl.Query[org.squeryl.test.demo.Song]">from</a><span class="delimiter">(</span><a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#138039" title="=&gt; org.squeryl.Query[org.squeryl.test.demo.Song]">songsInPlaylistOrder</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="org.squeryl.test.demo.Song" id="142490">s</a>=&gt;
        <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15264" title="(b: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.fsm.WhereState[org.squeryl.dsl.fsm.Conditioned]">where</a><span class="delimiter">(</span><a href="#142490" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.IntType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15191" title="implicit org.squeryl.dsl.DslFactory.int2ScalarInt : (i: org.squeryl.PrimitiveTypeMode.IntType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.IntType]" class="int">123</a><span class="delimiter">)</span>
        <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; org.squeryl.test.demo.Song)org.squeryl.dsl.fsm.SelectState[org.squeryl.test.demo.Song]">select</a><span class="delimiter">(</span><a href="#142490" title="org.squeryl.test.demo.Song">s</a><span class="delimiter">)</span>
      <span class="delimiter">)</span>
    
    <span class="comment">// Left Outer Join :</span>
    <span class="keyword">var</span> <a title="org.squeryl.Query[(org.squeryl.test.demo.Song, Option[org.squeryl.test.demo.Rating])]" id="141749">ratingsForAllSongs</a> =
      <a href="../../../../../main/org/squeryl/dsl/boilerplate/JoinSignatures.scala.html#15851" title="(q: org.squeryl.Queryable[org.squeryl.test.demo.Song], q1: org.squeryl.dsl.internal.JoinedQueryable[Option[org.squeryl.test.demo.Rating]])(f: (org.squeryl.test.demo.Song, Option[org.squeryl.test.demo.Rating]) =&gt; org.squeryl.dsl.boilerplate.JoinQueryYield1[(org.squeryl.test.demo.Song, Option[org.squeryl.test.demo.Rating])])org.squeryl.Query[(org.squeryl.test.demo.Song, Option[org.squeryl.test.demo.Rating])]">join</a><span class="delimiter">(</span><a href="#137426" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Song]">songs</a>, <a href="../../../../../main/org/squeryl/dsl/boilerplate/JoinSignatures.scala.html#15845" title="(q: org.squeryl.Queryable[org.squeryl.test.demo.Rating])org.squeryl.PrimitiveTypeMode.JoinPrecursor[org.squeryl.test.demo.Rating]">ratings</a>.<a href="../../../../../main/org/squeryl/dsl/boilerplate/JoinSignatures.scala.html#22676" title="=&gt; org.squeryl.dsl.internal.OuterJoinedQueryable[org.squeryl.test.demo.Rating]">leftOuter</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="org.squeryl.test.demo.Song" id="142688">s</a>,<a title="Option[org.squeryl.test.demo.Rating]" id="142689">r</a><span class="delimiter">)</span> =&gt;
        <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15765" title="(yieldClosure: =&gt; (org.squeryl.test.demo.Song, Option[org.squeryl.test.demo.Rating]))org.squeryl.dsl.fsm.SelectState[(org.squeryl.test.demo.Song, Option[org.squeryl.test.demo.Rating])]">select</a><span class="delimiter">(</span><span title="(_1: org.squeryl.test.demo.Song, _2: Option[org.squeryl.test.demo.Rating])(org.squeryl.test.demo.Song, Option[org.squeryl.test.demo.Rating])" class="delimiter">(</span><a href="#142688" title="org.squeryl.test.demo.Song">s</a>, <a href="#142689" title="Option[org.squeryl.test.demo.Rating]">r</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="../../../../../main/org/squeryl/dsl/QueryYield.scala.html#20488" title="(lb1: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.boilerplate.JoinQueryYield1[(org.squeryl.test.demo.Song, Option[org.squeryl.test.demo.Rating])]">on</a><span class="delimiter">(</span><a href="#142688" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15196" title="implicit org.squeryl.dsl.DslFactory.long2ScalarLong : (l: org.squeryl.PrimitiveTypeMode.LongType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.LongType]">id</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18121" title="(b: org.squeryl.dsl.NumericalExpression[Option[org.squeryl.PrimitiveTypeMode.IntType]])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="#142689" title="Option[org.squeryl.test.demo.Rating]">r</a>.<span title="(f: org.squeryl.test.demo.Rating =&gt; Int)Option[Int]">map</span><a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15199" title="implicit org.squeryl.dsl.DslFactory.optionInt2ScalarInt : (i: Option[org.squeryl.PrimitiveTypeMode.IntType])org.squeryl.dsl.NumericalExpression[Option[org.squeryl.PrimitiveTypeMode.IntType]]" class="delimiter">(</a><a href="#142741" title="org.squeryl.test.demo.Rating">_</a>.<a href="#141626" title="=&gt; Int">songId</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">)</span>

<span class="comment">//    for(sr &lt;- ratingsForAllSongs)</span>
<span class="comment">//      println(sr._1.title + &quot; rating is &quot; + sr._2.map(r =&gt; r.appreciationScore.toString).getOrElse(&quot;not rated&quot;))</span>


    <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15311" title="(t: org.squeryl.Table[org.squeryl.test.demo.Song])(s: org.squeryl.test.demo.Song =&gt; org.squeryl.dsl.ast.UpdateStatement)Int">update</a><span class="delimiter">(</span><a href="#137426" title="=&gt; org.squeryl.Table[org.squeryl.test.demo.Song]">songs</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="org.squeryl.test.demo.Song" id="142754">s</a> =&gt;
      <a href="../../../../../main/org/squeryl/dsl/QueryDsl.scala.html#15264" title="(b: =&gt; org.squeryl.dsl.ast.LogicalBoolean)org.squeryl.dsl.fsm.WhereState[org.squeryl.dsl.fsm.Conditioned]">where</a><span class="delimiter">(</span><a href="#142754" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15195" title="implicit org.squeryl.dsl.DslFactory.string2ScalarString : (s: org.squeryl.PrimitiveTypeMode.StringType)org.squeryl.dsl.StringExpression[org.squeryl.PrimitiveTypeMode.StringType]">title</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#22738" title="(b: org.squeryl.dsl.NonNumericalExpression[org.squeryl.PrimitiveTypeMode.StringType])org.squeryl.dsl.ast.EqualityExpression">===</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15195" title="implicit org.squeryl.dsl.DslFactory.string2ScalarString : (s: org.squeryl.PrimitiveTypeMode.StringType)org.squeryl.dsl.StringExpression[org.squeryl.PrimitiveTypeMode.StringType]" class="string">&quot;Watermelon Man&quot;</a><span class="delimiter">)</span>
      <a href="../../../../../main/org/squeryl/dsl/fsm/StartState.scala.html#15768" title="(updateAssignments: org.squeryl.dsl.ast.UpdateAssignment*)(implicit cond: =:=[org.squeryl.dsl.fsm.Conditioned,org.squeryl.dsl.fsm.Conditioned])org.squeryl.dsl.ast.UpdateStatement">set</a><span class="delimiter">(</span><a href="#142754" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15195" title="implicit org.squeryl.dsl.DslFactory.string2ScalarString : (s: org.squeryl.PrimitiveTypeMode.StringType)org.squeryl.dsl.StringExpression[org.squeryl.PrimitiveTypeMode.StringType]">title</a> <a href="../../../../../main/org/squeryl/dsl/ast/ExpressionNode.scala.html#18112" title="(b: java.lang.String)(implicit evidence$1: java.lang.String =&gt; org.squeryl.dsl.ast.TypedExpressionNode[org.squeryl.PrimitiveTypeMode.StringType])org.squeryl.dsl.ast.UpdateAssignment">:=</a> <span title="java.lang.String(&quot;The Watermelon Man&quot;)" class="string">&quot;The Watermelon Man&quot;</span>,
          <a href="#142754" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15191" title="implicit org.squeryl.dsl.DslFactory.int2ScalarInt : (i: org.squeryl.PrimitiveTypeMode.IntType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.IntType]">year</a>  <a href="../../../../../main/org/squeryl/dsl/ast/ExpressionNode.scala.html#18112" title="(b: org.squeryl.dsl.BinaryAMSOp[org.squeryl.PrimitiveTypeMode.IntType,org.squeryl.PrimitiveTypeMode.IntType])(implicit evidence$1: org.squeryl.dsl.BinaryAMSOp[org.squeryl.PrimitiveTypeMode.IntType,org.squeryl.PrimitiveTypeMode.IntType] =&gt; org.squeryl.dsl.ast.TypedExpressionNode[org.squeryl.PrimitiveTypeMode.IntType])org.squeryl.dsl.ast.UpdateAssignment">:=</a> <a href="#142754" title="org.squeryl.test.demo.Song">s</a>.<a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15191" title="implicit org.squeryl.dsl.DslFactory.int2ScalarInt : (i: org.squeryl.PrimitiveTypeMode.IntType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.IntType]">year</a> <a href="../../../../../main/org/squeryl/dsl/FieldTypes.scala.html#18163" title="(b: org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.IntType])org.squeryl.dsl.BinaryAMSOp[org.squeryl.PrimitiveTypeMode.IntType,org.squeryl.PrimitiveTypeMode.IntType]">plus</a> <a href="../../../../../main/org/squeryl/dsl/DslFactory.scala.html#15191" title="implicit org.squeryl.dsl.DslFactory.int2ScalarInt : (i: org.squeryl.PrimitiveTypeMode.IntType)org.squeryl.dsl.NumericalExpression[org.squeryl.PrimitiveTypeMode.IntType]" class="int">1</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>

    <span class="keyword">for</span><span class="delimiter">(</span><a title="org.squeryl.test.demo.Song" id="143444">s</a> &lt;- <a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#138046" title="(artistId: Long)org.squeryl.Query[org.squeryl.test.demo.Song]">songsOf</a><span title="(f: org.squeryl.test.demo.Song =&gt; Unit)Unit" class="delimiter">(</span><a href="#141690" title="=&gt; org.squeryl.test.demo.Artist">herbyHancock</a>.<a href="#137267" title="=&gt; Long">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;herby &quot;)" class="string">&quot;herby &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#143444" title="org.squeryl.test.demo.Song">s</a>.<a href="#137907" title="=&gt; String">title</a><span class="delimiter">)</span>
    
    <span class="keyword">val</span> <a title="Int" id="141750">c</a> = <a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#138042" title="(artist: org.squeryl.test.demo.Artist)Int">removeSongOfArtist</a><span class="delimiter">(</span><a href="#141690" title="=&gt; org.squeryl.test.demo.Artist">herbyHancock</a><span class="delimiter">)</span>

    <a href="#11144" title="(condition: Boolean, clue: Any)Unit">assert</a><span class="delimiter">(</span><a href="#141750" title="Int">c</a> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span>, <span title="java.lang.String(&quot;expected 1, got &quot;)" class="string">&quot;expected 1, got &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#141750" title="Int">c</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;playList.id:&quot;)" class="string">&quot;playList.id:&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#137267" title="=&gt; Long">id</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, artist.id:&quot;)" class="string">&quot;, artist.id:&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#141690" title="=&gt; org.squeryl.test.demo.Artist">herbyHancock</a>.<a href="#137267" title="=&gt; Long">id</a><span class="delimiter">)</span>


    <a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#138043" title="=&gt; org.squeryl.Query[org.squeryl.dsl.GroupWithMeasures[Long,Long]]">_songCountByArtistId</a>.<span title="=&gt; List[org.squeryl.dsl.GroupWithMeasures[Long,Long]]">toList</span>

    
    <span class="keyword">val</span> <a title="org.squeryl.Query[(org.squeryl.test.demo.Artist, Long)]" id="141751">q</a> = <a href="#141708" title="=&gt; org.squeryl.test.demo.Playlist">funkAndLatinJazz</a>.<a href="#138044" title="=&gt; org.squeryl.Query[(org.squeryl.test.demo.Artist, Long)]">songCountForAllArtists</a>

    <span class="comment">//println(q.dumpAst)</span>
    
    <a href="#141751" title="org.squeryl.Query[(org.squeryl.test.demo.Artist, Long)]">q</a>.<span title="=&gt; List[(org.squeryl.test.demo.Artist, Long)]">toList</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>unfiltered/unfiltered/unfiltered/response/cookies.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> unfiltered.response

<span class="keyword">import</span> unfiltered.Cookie

/** Set-Cookie response header. See SetCookies */
<span class="keyword">object</span> <a title="unfiltered.response.ResponseCookies.type" id="9419">ResponseCookies</a> <a href="#9420" title="unfiltered.response.ResponseCookies.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="String" id="115347">Name</a> = <span title="String(&quot;Set-Cookie&quot;)" class="string">&quot;Set-Cookie&quot;</span>
<span class="delimiter">}</span>

/** Set-Cookie response header */
<span title="AnyRef" class="keyword">object</span> <a title="unfiltered.response.SetCookies.type" id="9500">SetCookies</a> <a href="#9501" title="unfiltered.response.SetCookies.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="String" id="115351">Name</a> = <span title="String(&quot;Set-Cookie&quot;)" class="string">&quot;Set-Cookie&quot;</span>
  <span class="keyword">def</span> <a title="(cookies: unfiltered.Cookie*)unfiltered.response.ResponseHeader" id="115353">apply</a><span class="delimiter">(</span><a title="unfiltered.Cookie*" id="115356">cookies</a>: <span title="unfiltered.Cookie*">Cookie</span>*<span class="delimiter">)</span> =
    <span title="unfiltered.response.ResponseHeader" class="keyword">new</span> <a href="headers.scala.html#9448" title="unfiltered.response.ResponseHeader">ResponseHeader</a><span class="delimiter">(</span><a href="#115351" title="=&gt; String">Name</a>, <span class="delimiter">(</span><span title="scala.collection.Seq.type">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span> <a href="#115359" title="(z: Seq[String])(op: (Seq[String], unfiltered.Cookie) =&gt; Seq[String])Seq[String]">/:</a> <a href="#115356" title="unfiltered.Cookie*">cookies</a><span class="delimiter">)</span><span class="delimiter">(</span>
      <span class="delimiter">(</span><a title="Seq[String]" id="115372">a</a>, <a title="unfiltered.Cookie" id="115373">e</a><span class="delimiter">)</span> =&gt; <a href="#115381" title="(cs: unfiltered.Cookie*)String">ToCookies</a><span class="delimiter">(</span><a href="#115373" title="unfiltered.Cookie">e</a><span class="delimiter">)</span> <a href="#115374" title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],String,Seq[String]])Seq[String]">+:</a> <a href="#115372" title="Seq[String]">a</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>
  /** Call this method with a list of names to discard cookies */
  <span class="keyword">def</span> <a title="(names: String*)unfiltered.response.ResponseHeader" id="115354">discarding</a><span class="delimiter">(</span><a title="String*" id="115425">names</a>: <span title="String*">String</span>*<span class="delimiter">)</span> =
    <a href="#115353" title="(cookies: unfiltered.Cookie*)unfiltered.response.ResponseHeader">apply</a><span class="delimiter">(</span><a href="#115425" title="String*">names</a>.<span title="(f: String =&gt; unfiltered.Cookie)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],unfiltered.Cookie,Seq[unfiltered.Cookie]])Seq[unfiltered.Cookie]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,unfiltered.Cookie,Seq[unfiltered.Cookie]]" class="delimiter">(</span><a href="../cookies.scala.html#45063" title="Option[String]" id="115469">Cookie</a><span class="delimiter">(</span><a href="#115442" title="String" id="115462">_</a>, <a title="String" id="115463" class="string">&quot;&quot;</a>, maxAge = <span title="(x: Int)Some[Int]">Some</span><a title="Some[Int]" id="115464" class="delimiter">(</a><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>:_*<span class="delimiter">)</span>
<span class="delimiter">}</span>

/** Module for Cookie serialization */
<span title="AnyRef" class="keyword">object</span> <a title="unfiltered.response.ToCookies.type" id="9560">ToCookies</a> <a href="#9561" title="unfiltered.response.ToCookies.type" class="delimiter">{</a>
  <span class="keyword">import</span> java.util.Date
  <span class="keyword">import</span> unfiltered.<a href="../cookies.scala.html#7191" title="unfiltered.CookieKeys.type">CookieKeys</a>._
  <span class="keyword">import</span> unfiltered.request.DateFormatting

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Array[Char]" id="115379">Quotables</a> = <span title="(x: Char, xs: Char*)Array[Char]">Array</span><span class="delimiter">(</span>
    <span title="Char('\t')" class="char">'\t'</span>, <span title="Char(' ')" class="char">' '</span>, <span title="Char('\&quot;')" class="char">'&quot;'</span>, <span title="Char('(')" class="char">'('</span>, <span title="Char(')')" class="char">')'</span>, <span title="Char(',')" class="char">','</span>, <span title="Char('/')" class="char">'/'</span>, <span title="Char(':')" class="char">':'</span>, <span title="Char(';')" class="char">';'</span>, <span title="Char('&lt;')" class="char">'&lt;'</span>,
    <span title="Char('=')" class="char">'='</span>, <span title="Char('&gt;')" class="char">'&gt;'</span>, <span title="Char('?')" class="char">'?'</span>, <span title="Char('@')" class="char">'@'</span>, <span title="Char('[')" class="char">'['</span>, <span title="Char('\\')" class="char">'\\'</span>, <span title="Char(']')" class="char">']'</span>, <span title="Char('{')" class="char">'{'</span>, <span title="Char('}')" class="char">'}'</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(cs: unfiltered.Cookie*)String" id="115381">apply</a><span class="delimiter">(</span><a title="unfiltered.Cookie*" id="115387">cs</a>: <span title="unfiltered.Cookie*">Cookie</span>*<span class="delimiter">)</span>: <span title="String">String</span> =
    <span class="delimiter">(</span><span class="delimiter">(</span><span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span> <a href="#115519" title="(z: StringBuilder)(op: (StringBuilder, unfiltered.Cookie) =&gt; StringBuilder)StringBuilder">/:</a> <a href="#115387" title="unfiltered.Cookie*">cs</a><span class="delimiter">)</span> <a href="#126153" title="String" class="delimiter">{</a> <span class="delimiter">(</span><a title="StringBuilder" id="115717">b</a>, <a title="unfiltered.Cookie" id="115718">c</a><span class="delimiter">)</span> =&gt; <a href="#115386" title="(sb: StringBuilder, c: unfiltered.Cookie)Unit">append</a><span class="delimiter">(</span><a href="#115717" title="StringBuilder">b</a>, <a href="#115718" title="unfiltered.Cookie">c</a><span class="delimiter">)</span>; <a href="#115717" title="StringBuilder">b</a> <span class="delimiter">}</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> sb <span class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#126148" title="StringBuilder">sb</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> =&gt;
        <a href="#126148" title="StringBuilder">sb</a>.<span title="(len: Int)Unit">setLength</span><span class="delimiter">(</span><a href="#126148" title="StringBuilder">sb</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <a href="#126148" title="StringBuilder">sb</a>.<span title="()String">toString</span>
      <span class="keyword">case</span> empty =&gt; <a href="#126148" title="StringBuilder">empty</a>.<a href="#126150" title="(x: String)String">toString</a>
    <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(k: String, v: String)String" id="115382">quoted</a><span class="delimiter">(</span><a title="String" id="115727">k</a>: <span title="String">String</span>, <a title="String" id="115728">v</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;%s=&quot;%s&quot;;&quot;&quot;&quot;</span> <span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#115727" title="String">k</a>, <a href="#115728" title="String">v</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#126155" title="Any" class="keyword">null</a> =&gt; <a href="#126160" title="(x: Any)Any" class="string">&quot;&quot;</a>
      <span class="keyword">case</span> value =&gt; <a href="#126155" title="String">value</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;\\&quot;)" class="string">&quot;\\&quot;</span>, <span title="String(&quot;\\\\&quot;)" class="string">&quot;\\\\&quot;</span><span class="delimiter">)</span>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><a href="#126160" title="(x: Any)Any" class="delimiter">(</a><span title="String(&quot;\&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>, <span title="String(&quot;\\\&quot;&quot;)" class="string">&quot;\\\&quot;&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(k: String, v: String)String" id="115383">literal</a><span class="delimiter">(</span><a title="String" id="115811">k</a>: <span title="String">String</span>, <a title="String" id="115812">v</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s=%s;&quot;</span> <span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#115811" title="String">k</a>, <a href="#115812" title="String">v</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(k: String, v: String)String" id="115384">add</a><span class="delimiter">(</span><a title="String" id="115725">k</a>: <span title="String">String</span>, <a title="String" id="115726">v</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#115726" title="String">v</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#126168" title="String" class="keyword">null</a> =&gt; <a href="#115382" title="(k: String, v: String)String">quoted</a><a href="#126173" title="(x: String)String" class="delimiter">(</a><a href="#115725" title="String">k</a>, <a href="#115726" title="String">v</a><span class="delimiter">)</span>
    <span class="keyword">case</span> value =&gt;
      <a href="#126173" title="(x: String)String" class="keyword">if</a><span class="delimiter">(</span><a href="#126168" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">value</a>.<span title="(p: Char =&gt; Boolean)Option[Char]">find</span><span class="delimiter">(</span><a href="#115379" title="implicit scala.Predef.charArrayOps : (xs: Array[Char])scala.collection.mutable.ArrayOps[Char]">Quotables</a>.<a href="#115810" title="(elem: Any)Boolean">contains</a><span class="delimiter">)</span>.<span title="=&gt; Boolean">isDefined</span><span class="delimiter">)</span> <a href="#115382" title="(k: String, v: String)String">quoted</a><span class="delimiter">(</span><a href="#115725" title="String">k</a>, <a href="#115726" title="String">v</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <a href="#115383" title="(k: String, v: String)String">literal</a><span class="delimiter">(</span><a href="#115725" title="String">k</a>, <a href="#115726" title="String">v</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(secs: Int)String" id="115385">gmt</a><span class="delimiter">(</span><a title="Int" id="115829">secs</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="../request/headers.scala.html#7487" title="unfiltered.request.DateFormatting.type">DateFormatting</a>.<a href="../request/headers.scala.html#108229" title="(date: java.util.Date)String">format</a><span class="delimiter">(</span>
      <span title="(x$1: Long)java.util.Date" class="keyword">new</span> <span title="java.util.Date">Date</span><span class="delimiter">(</span><span title="System.type">System</span>.<span title="()Long">currentTimeMillis</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x: Long)Long">+</span> <a href="#115829" title="Int">secs</a> <span title="(x: Long)Long">*</span> <span title="Long(1000L)" class="long">1000L</span><span class="delimiter">)</span>
    <span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sb: StringBuilder, c: unfiltered.Cookie)Unit" id="115386">append</a><span class="delimiter">(</span><a title="StringBuilder" id="115719">sb</a>: <span title="StringBuilder">StringBuilder</span>, <a title="unfiltered.Cookie" id="115720">c</a>: <a href="../cookies.scala.html#7184" title="unfiltered.Cookie">Cookie</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#115719" title="StringBuilder">sb</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span><a href="#115384" title="(k: String, v: String)String">add</a><span class="delimiter">(</span><a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43178" title="=&gt; String">name</a>, <a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43180" title="=&gt; String">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43186" title="=&gt; Option[Int]">maxAge</a> <span title="(f: Int =&gt; StringBuilder)Option[StringBuilder]">map</span> <span class="delimiter">{</span> <a title="Int" id="115820">ma</a> =&gt;
      <a href="#115719" title="StringBuilder">sb</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span>
        <span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43192" title="=&gt; Int">version</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#115383" title="(k: String, v: String)String">literal</a><span class="delimiter">(</span><a href="../cookies.scala.html#104623" title="=&gt; String">Expires</a>, <a href="#115385" title="(secs: Int)String">gmt</a><span class="delimiter">(</span><a href="#115820" title="Int">ma</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <a href="#115384" title="(k: String, v: String)String">add</a><span class="delimiter">(</span><a href="../cookies.scala.html#104625" title="=&gt; String">MaxAge</a>, <a href="#115820" title="Int">ma</a>.<span title="()String">toString</span><span class="delimiter">)</span>
      <span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43184" title="=&gt; Option[String]">path</a> <span title="(f: String =&gt; StringBuilder)Option[StringBuilder]">map</span> <span class="delimiter">{</span> <a title="String" id="115847">p</a> =&gt;
      <a href="#115719" title="StringBuilder">sb</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span>
        <span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43192" title="=&gt; Int">version</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#115384" title="(k: String, v: String)String">add</a><span class="delimiter">(</span><a href="../cookies.scala.html#104621" title="=&gt; String">Path</a>, <a href="#115847" title="String">p</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <a href="#115383" title="(k: String, v: String)String">literal</a><span class="delimiter">(</span><a href="../cookies.scala.html#104621" title="=&gt; String">Path</a>, <a href="#115847" title="String">p</a><span class="delimiter">)</span>
      <span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43182" title="=&gt; Option[String]">domain</a> <span title="(f: String =&gt; StringBuilder)Option[StringBuilder]">map</span> <span class="delimiter">{</span> <a title="String" id="115861">d</a> =&gt;
      <a href="#115719" title="StringBuilder">sb</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span>
        <span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43192" title="=&gt; Int">version</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#115384" title="(k: String, v: String)String">add</a><span class="delimiter">(</span><a href="../cookies.scala.html#104627" title="=&gt; String">Domain</a>, <a href="#115861" title="String">d</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <a href="#115383" title="(k: String, v: String)String">literal</a><span class="delimiter">(</span><a href="../cookies.scala.html#104627" title="=&gt; String">Domain</a>, <a href="#115861" title="String">d</a><span class="delimiter">)</span>
      <span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43188" title="=&gt; Option[Boolean]">secure</a> <span title="(f: Boolean =&gt; Any)Option[Any]">map</span><span class="delimiter">(</span><span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="#115875" title="Boolean">_</a><span class="delimiter">)</span> <a href="#115719" title="StringBuilder">sb</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s;&quot;</span> <span title="(args: Any*)String">format</span> <a href="../cookies.scala.html#104629" title="=&gt; String">Secure</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43190" title="=&gt; Boolean">httpOnly</a><span class="delimiter">)</span> <a href="#115719" title="StringBuilder">sb</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s;&quot;</span> <span title="(args: Any*)String">format</span> <a href="../cookies.scala.html#104631" title="=&gt; String">HTTPOnly</a><span class="delimiter">)</span>
    <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43192" title="=&gt; Int">version</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
       <a href="#115719" title="StringBuilder">sb</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span><a href="#115384" title="(k: String, v: String)String">add</a><span class="delimiter">(</span><a href="../cookies.scala.html#104641" title="=&gt; String">Version</a>, <a href="#115720" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#43192" title="=&gt; Int">version</a>.<span title="()String">toString</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#115719" title="StringBuilder">sb</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#115719" title="StringBuilder">sb</a>.<span title="(len: Int)Unit">setLength</span><span class="delimiter">(</span><a href="#115719" title="StringBuilder">sb</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    // ignore v1 extras for now
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>unfiltered/unfiltered/unfiltered/request/params.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> unfiltered.request

<span class="keyword">import</span> unfiltered.response.ResponseFunction
<span class="keyword">import</span> scala.util.control.<span title="scala.util.control.Exception.type">Exception</span>.allCatch
<span class="keyword">import</span> java.net.URLDecoder

/** Basic parameter access, and a pattern matching extractor in Extract. */
<span class="keyword">object</span> <a title="unfiltered.request.Params.type" id="7802">Params</a> <a href="#7803" title="unfiltered.request.Params.type" class="delimiter">{</a>
  <span class="keyword">type</span> <a title="scala.collection.Map[String,Seq[String]]" id="35645">Map</a> = scala.collection.<span title="scala.collection.Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span>
  /**
   * Given a req, extract the request params into a (Map[String, Seq[String]], request).
   * The Map is assigned a default value of Nil, so param(&quot;p&quot;) would return Nil if there
   * is no such parameter, or (as normal for servlets) a single empty string if the
   * parameter was supplied without a value. */
  <span class="keyword">def</span> <a title="[T](req: unfiltered.request.HttpRequest[T])Some[scala.collection.immutable.Map[String,Seq[String]]]" id="35646">unapply</a><span class="delimiter">[</span><a title="" id="35648">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.HttpRequest[T]" id="35672">req</a>: <a href="HttpRequest.scala.html#7615" title="unfiltered.request.HttpRequest[T]">HttpRequest</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Iterator[String]" id="35673">names</a> = <a href="#35672" title="unfiltered.request.HttpRequest[T]">req</a>.<a href="HttpRequest.scala.html#12735" title="=&gt; Iterator[String]">parameterNames</a>
    <span title="(x: scala.collection.immutable.Map[String,Seq[String]])Some[scala.collection.immutable.Map[String,Seq[String]]]">Some</span><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">(</span><span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">[</span><span title="String">String</span>, <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> <a href="#35676" title="(z: scala.collection.immutable.Map[String,Seq[String]])(op: (scala.collection.immutable.Map[String,Seq[String]], String) =&gt; scala.collection.immutable.Map[String,Seq[String]])scala.collection.immutable.Map[String,Seq[String]]">/:</a> <a href="#35673" title="Iterator[String]">names</a><span class="delimiter">)</span> <span class="delimiter">(</span><span class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="35735">m</a>, <a title="String" id="35736">n</a><span class="delimiter">)</span> =&gt;
        <a href="#35735" title="scala.collection.immutable.Map[String,Seq[String]]">m</a> <span title="(kv: (String, Seq[String]))scala.collection.immutable.Map[String,Seq[String]]">+</span> <span class="delimiter">(</span><a href="#35736" title="(x: String)ArrowAssoc[String]">n</a> <span title="(y: Seq[String])(String, Seq[String])">-&gt;</span> <a href="#35672" title="unfiltered.request.HttpRequest[T]">req</a>.<a href="HttpRequest.scala.html#12736" title="(param: String)Seq[String]">parameterValues</a><span class="delimiter">(</span><a href="#35736" title="String">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(d: Seq[String])scala.collection.immutable.Map[String,Seq[String]]">withDefaultValue</span><span class="delimiter">(</span><span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /**
   * A function Seq[String] =&gt; Option[B]  used to test and transform values
   * from the parameter map. Conditions may be chained with `~&gt;` */
  <span class="keyword">class</span> <a title="class ParamMapper[B] extends AnyRef with Seq[String] =&gt; Option[B]" id="35649">ParamMapper</a><span class="delimiter">[</span><a title="" id="35650">B</a><span class="delimiter">]</span><a href="#35649" title="unfiltered.request.Params.ParamMapper[B]" class="delimiter">(</a><a title="Seq[String] =&gt; Option[B]" id="54350">f</a>: Seq<span class="delimiter">[</span>String<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span class="delimiter">(</span>Seq<span class="delimiter">[</span>String<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(a: Seq[String])Option[B]" id="54345">apply</a><span class="delimiter">(</span><a title="Seq[String]" id="110773">a</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#54350" title="(v1: Seq[String])Option[B]">f</a><span class="delimiter">(</span><a href="#110773" title="Seq[String]">a</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[C](that: Option[B] =&gt; Option[C])unfiltered.request.Params.ParamMapper[C]" id="54346">~&gt;</a> <span class="delimiter">[</span><a title="" id="54348">C</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[B] =&gt; Option[C]" id="110778">that</a>: Option<span class="delimiter">[</span>B<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>C<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="unfiltered.request.Params.ParamMapper[C]" class="keyword">new</span> <a href="#35649" title="unfiltered.request.Params.ParamMapper[C]">ParamMapper</a><span class="delimiter">(</span><span class="delimiter">{</span> <a href="#54350" title="Seq[String] =&gt; Option[B]">f</a> <span title="(g: Option[B] =&gt; Option[C])Seq[String] =&gt; Option[C]">andThen</span> <a href="#110778" title="Option[B] =&gt; Option[C]">that</a> <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Maps first parameter, if present. */
  <span class="keyword">val</span> <a title="unfiltered.request.Params.ParamMapper[String]" id="35651">first</a> = <span title="unfiltered.request.Params.ParamMapper[String]" class="keyword">new</span> <a href="#35649" title="unfiltered.request.Params.ParamMapper[String]">ParamMapper</a><span class="delimiter">(</span><a href="#54353" title="Seq[String]">_</a>.<span title="=&gt; Option[String]">headOption</span><span class="delimiter">)</span>

  /**
   * Base class for parameter extractor objects, may be extended inline with
   * chained ParamMapper objects. */
  <span class="keyword">class</span> <a title="class Extract[E, T] extends AnyRef" id="35653">Extract</a><span class="delimiter">[</span><a title="" id="35654">E</a>,<a title="" id="35655">T</a><span class="delimiter">]</span><a href="#35653" title="unfiltered.request.Params.Extract[E,T]" class="delimiter">(</a><a title="unfiltered.request.Params.Map =&gt; Option[T]" id="54132">f</a>: Map =&gt; Option<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(name: String, f: Seq[String] =&gt; Option[T])unfiltered.request.Params.Extract[E,T]" id="36727" class="keyword">this</a><span class="delimiter">(</span><a title="String" id="54128">name</a>: <span title="String">String</span>, <a title="Seq[String] =&gt; Option[T]" id="54129">f</a>: Seq<span class="delimiter">[</span>String<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> =
      <a href="#35653" title="Extract.this.type" class="keyword">this</a><span class="delimiter">(</span><span class="delimiter">{</span> params: <span title="unfiltered.request.Params.Map">Map</span> =&gt; <a href="#54129" title="(v1: Seq[String])Option[T]">f</a><span class="delimiter">(</span><a href="#110801" title="(key: String)Seq[String]">params</a><span class="delimiter">(</span><a href="#54128" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(params: unfiltered.request.Params.Map)Option[T]" id="36728">unapply</a><span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="36729">params</a>: <span title="unfiltered.request.Params.Map">Map</span><span class="delimiter">)</span> = <a href="#54132" title="(v1: unfiltered.request.Params.Map)Option[T]">f</a><span class="delimiter">(</span><a href="#36729" title="unfiltered.request.Params.Map">params</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  /** Construct a parameter predicate */
  <span class="keyword">def</span> <a title="[E, A](p: A =&gt; Boolean)Option[A] =&gt; Option[A]" id="35656">pred</a><span class="delimiter">[</span><a title="" id="35659">E</a>,<a title="" id="35660">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; Boolean" id="55556">p</a>: A =&gt; Boolean<span class="delimiter">)</span>: Option<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a title="Option[A]" id="110829">opt</a> =&gt; <a href="#110829" title="Option[A]">opt</a> <span title="(p: A =&gt; Boolean)Option[A]">filter</span> <a href="#55556" title="A =&gt; Boolean">p</a>

  <span class="keyword">def</span> <a title="(os: Option[String])Option[Int]" id="35661">int</a><span class="delimiter">(</span><a title="Option[String]" id="110831">os</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#110831" title="Option[String]">os</a>.<span title="(f: String =&gt; Option[Int])Option[Int]">flatMap</span> <span class="delimiter">{</span> <a title="String" id="110836">s</a> =&gt; <span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; Int)Option[Int]">opt</span> <span class="delimiter">{</span> <a href="#110836" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">toInt</span> <span class="delimiter">}</span> <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(os: Option[String])Option[Long]" id="35662">long</a><span class="delimiter">(</span><a title="Option[String]" id="110849">os</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#110849" title="Option[String]">os</a>.<span title="(f: String =&gt; Option[Long])Option[Long]">flatMap</span> <span class="delimiter">{</span> <a title="String" id="110854">s</a> =&gt; <span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; Long)Option[Long]">opt</span> <span class="delimiter">{</span> <a href="#110854" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Long">toLong</span> <span class="delimiter">}</span> <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(os: Option[String])Option[Float]" id="35663">float</a><span class="delimiter">(</span><a title="Option[String]" id="110867">os</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#110867" title="Option[String]">os</a>.<span title="(f: String =&gt; Option[Float])Option[Float]">flatMap</span> <span class="delimiter">{</span> <a title="String" id="110872">s</a> =&gt; <span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; Float)Option[Float]">opt</span> <span class="delimiter">{</span> <a href="#110872" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Float">toFloat</span> <span class="delimiter">}</span> <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(os: Option[String])Option[Double]" id="35664">double</a><span class="delimiter">(</span><a title="Option[String]" id="110885">os</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#110885" title="Option[String]">os</a>.<span title="(f: String =&gt; Option[Double])Option[Double]">flatMap</span> <span class="delimiter">{</span> <a title="String" id="110890">s</a> =&gt; <span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; Double)Option[Double]">opt</span> <span class="delimiter">{</span> <a href="#110890" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Double">toDouble</span> <span class="delimiter">}</span> <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="Option[Int] =&gt; Option[Int]" id="35665">even</a> = <a href="#35656" title="(p: Int =&gt; Boolean)Option[Int] =&gt; Option[Int]">pred</a> <span class="delimiter">{</span> <span class="delimiter">(</span><a href="#110745" title="Int">_</a>:<span title="Int">Int</span><span class="delimiter">)</span> <span title="(x: Int)Int">%</span> <span title="Int(2)" class="int">2</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span> <span class="delimiter">}</span>
  <span class="keyword">val</span> <a title="Option[Int] =&gt; Option[Int]" id="35667">odd</a> = <a href="#35656" title="(p: Int =&gt; Boolean)Option[Int] =&gt; Option[Int]">pred</a> <span class="delimiter">{</span> <span class="delimiter">(</span><a href="#110760" title="Int">_</a>:<span title="Int">Int</span><span class="delimiter">)</span> <span title="(x: Int)Int">%</span> <span title="Int(2)" class="int">2</span> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span> <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(s: Option[String])Option[String]" id="35669">trimmed</a><span class="delimiter">(</span><a title="Option[String]" id="110903">s</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#110903" title="Option[String]">s</a> <span title="(f: String =&gt; String)Option[String]">map</span> <span class="delimiter">{</span> <a href="#110908" title="String">_</a>.<span title="()String">trim</span> <span class="delimiter">}</span>
  <span class="keyword">val</span> <a title="Option[String] =&gt; Option[String]" id="35670">nonempty</a> = <a href="#35656" title="(p: String =&gt; Boolean)Option[String] =&gt; Option[String]">pred</a> <span class="delimiter">{</span> <span title="=&gt; Boolean">!</span><span class="delimiter">(</span><a href="#55562" title="String">_</a>:<span title="String">String</span><span class="delimiter">)</span>.<span title="()Boolean">isEmpty</span> <span class="delimiter">}</span>
<span class="delimiter">}</span>

/** Basic query parameter acess. */
<span title="AnyRef" class="keyword">object</span> <a title="unfiltered.request.QueryParams.type" id="7937">QueryParams</a> <a href="#7938" title="unfiltered.request.QueryParams.type" class="delimiter">{</a>
  
  /**
   * Given a req, extract the request query params into a (Map[String, Seq[String]], request).
   * The Map is assigned a default value of Nil, so param(&quot;p&quot;) would return Nil if there
   * is no such parameter, or (as normal for servlets) a single empty string if the
   * parameter was supplied without a value. */
  <span class="keyword">def</span> <a title="[T](req: unfiltered.request.HttpRequest[T])Some[Map[String,Seq[String]]]" id="30675">unapply</a><span class="delimiter">[</span><a title="" id="30677">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.HttpRequest[T]" id="30679">req</a>: <a href="HttpRequest.scala.html#7615" title="unfiltered.request.HttpRequest[T]">HttpRequest</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="(x: Map[String,Seq[String]])Some[Map[String,Seq[String]]]">Some</span><span class="delimiter">(</span><a href="#30678" title="(enc: String)Map[String,Seq[String]]">urldecode</a><span class="delimiter">(</span><a href="#30679" title="unfiltered.request.HttpRequest[T]">req</a>.<a href="HttpRequest.scala.html#12734" title="=&gt; String">uri</a><span class="delimiter">)</span><span class="delimiter">)</span>
  
  <span class="keyword">def</span> <a title="(enc: String)Map[String,Seq[String]]" id="30678">urldecode</a><span class="delimiter">(</span><a title="String" id="30682">enc</a>: <span title="String">String</span><span class="delimiter">)</span> : <span title="Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(raw: String)String" id="110911">decode</a><span class="delimiter">(</span><a title="String" id="110914">raw</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="java.net.URLDecoder.type">URLDecoder</span>.<span title="(x$1: String, x$2: String)String">decode</span><span class="delimiter">(</span><a href="#110914" title="String">raw</a>, <span title="String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="String" id="110912">params</a> = <a href="#30682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">enc</a>.<span title="(p: Char =&gt; Boolean)String">dropWhile</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><span title="Char('?')" class="char">'?'</span><a href="#110954" title="(x: Char)Boolean">!=</a><span class="delimiter">)</span>.<span title="(p: Char =&gt; Boolean)String">dropWhile</span><span class="delimiter">(</span><span title="Char('?')" class="char">'?'</span><a href="#110995" title="(x: Char)Boolean">==</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Seq[(String, String)]" id="110913">pairs</a>: <span title="Seq[(String, String)]">Seq</span><span class="delimiter">[</span><span class="delimiter">(</span>String,String<span class="delimiter">)</span><span class="delimiter">]</span> = <a href="#110912" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">params</a>.<span title="(separator: Char)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="Char('&amp;')" class="char">'&amp;'</span><span class="delimiter">)</span>.<span title="(f: String =&gt; scala.collection.GenTraversableOnce[(String, String)])(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],(String, String),Seq[(String, String)]])Seq[(String, String)]">flatMap</span> <span title="(implicit m: DummyImplicit)scala.collection.generic.CanBuildFrom[Array[_],(String, String),scala.collection.mutable.ArraySeq[(String, String)]]" class="delimiter">{</span>
      <a href="#111412" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="(separator: Char)Array[String]">split</span><span title="List[(String, String)]" class="delimiter">(</span><span title="Char('=')" class="char">'='</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#125874" title="(x: Array[String])Option[IndexedSeq[String]]">Array</a><span class="delimiter">(</span><a title="String" id="111439">key</a>, <a title="String" id="111440">value</a><span class="delimiter">)</span> =&gt; <span title="(xs: (String, String)*)List[(String, String)]">List</span><a href="#125880" title="(x: List[(String, String)])List[(String, String)]" class="delimiter">(</a><span title="(_1: String, _2: String)(String, String)" class="delimiter">(</span><a href="#110911" title="(raw: String)String">decode</a><span class="delimiter">(</span><a href="#111439" title="String">key</a><span class="delimiter">)</span>, <a href="#110911" title="(raw: String)String">decode</a><span class="delimiter">(</span><a href="#111440" title="String">value</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="#125874" title="(x: Array[String])Option[IndexedSeq[String]]">Array</a><span class="delimiter">(</span><a title="String" id="111460">key</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#111460" title="String">key</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> =&gt; <span title="(xs: (String, String)*)List[(String, String)]">List</span><a href="#125880" title="(x: List[(String, String)])List[(String, String)]" class="delimiter">(</a><span title="(_1: String, _2: String)(String, String)" class="delimiter">(</span><a href="#110911" title="(raw: String)String">decode</a><span class="delimiter">(</span><a href="#111460" title="String">key</a><span class="delimiter">)</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt; <a href="#125880" title="(x: List[(String, String)])List[(String, String)]">Nil</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#110913" title="Seq[(String, String)]">pairs</a>.<span title="(f: ((String, String)) =&gt; String)scala.collection.immutable.Map[String,Seq[(String, String)]]">groupBy</span><span class="delimiter">(</span><a href="#111517" title="(String, String)">_</a>.<span title="=&gt; String">_1</span><span class="delimiter">)</span>.<span title="(f: ((String, Seq[(String, String)])) =&gt; (String, Seq[String]))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map[String,Seq[(String, String)]],(String, Seq[String]),scala.collection.immutable.Map[String,Seq[String]]])scala.collection.immutable.Map[String,Seq[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map.Coll,(String, Seq[String]),scala.collection.immutable.Map[String,Seq[String]]]" class="delimiter">(</span><a title="(String, Seq[(String, String)])" id="111548">t</a> =&gt; <span title="(_1: String, _2: Seq[String])(String, Seq[String])" class="delimiter">(</span><a href="#111548" title="(String, Seq[(String, String)])">t</a>.<span title="=&gt; String">_1</span>, <a href="#111548" title="(String, Seq[(String, String)])">t</a>.<span title="=&gt; Seq[(String, String)]">_2</span>.<span title="(f: ((String, String)) =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, String)],String,Seq[String]])Seq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,String,Seq[String]]" class="delimiter">(</span><a href="#111569" title="(String, String)">_</a>.<span title="=&gt; String">_2</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ev: &lt;:&lt;[(String, Seq[String]),(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">toMap</span>.<span title="(d: String =&gt; Seq[String])scala.collection.immutable.Map[String,Seq[String]]">withDefault</span> <span class="delimiter">{</span> <a title="String" id="111667">_</a> =&gt; <span title="scala.collection.immutable.Nil.type">Nil</span> <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
<span class="delimiter">}</span>

/** Fined-grained error reporting for arbitrarily many failing parameters.
 * Import QParams._ to use; see ParamsSpec for examples. */
<span title="AnyRef" class="keyword">object</span> <a title="unfiltered.request.QParams.type" id="7910">QParams</a> <a href="#7911" title="unfiltered.request.QParams.type" class="delimiter">{</a>
  <span class="keyword">type</span> <a title="[E]List[unfiltered.request.QParams.Fail[E]]" id="54917">Log</a><span class="delimiter">[</span><a title="" id="54918">E</a><span class="delimiter">]</span> = <span title="List[unfiltered.request.QParams.Fail[E]]">List</span><span class="delimiter">[</span>Fail<span class="delimiter">[</span>E<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="keyword">type</span> <a title="[E, A](unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], A)" id="54919">QueryFn</a><span class="delimiter">[</span><a title="" id="54920">E</a>,<a title="" id="54921">A</a><span class="delimiter">]</span> = <span class="delimiter">(</span>Params.Map, Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Log<span class="delimiter">[</span>E<span class="delimiter">]</span><span class="delimiter">)</span> =&gt;
    <span class="delimiter">(</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Log<span class="delimiter">[</span>E<span class="delimiter">]</span>, A<span class="delimiter">)</span>
  <span class="keyword">type</span> <a title="[E, A]Either[unfiltered.request.QParams.Log[E],A]" id="54922">QueryResult</a><span class="delimiter">[</span><a title="" id="54923">E</a>,<a title="" id="54924">A</a><span class="delimiter">]</span> = <span title="Either[unfiltered.request.QParams.Log[E],A]">Either</span><span class="delimiter">[</span>Log<span class="delimiter">[</span>E<span class="delimiter">]</span>, A<span class="delimiter">]</span>
  /** Left if the query has failed, right if it has not (but may be empty) */
  <span class="keyword">type</span> <a title="[E, A]Either[E,Option[A]]" id="54925">Report</a><span class="delimiter">[</span><a title="" id="54926">E</a>,<a title="" id="54927">A</a><span class="delimiter">]</span> = <span title="Either[E,Option[A]]">Either</span><span class="delimiter">[</span>E,Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="keyword">type</span> <a title="[E, A, B]Option[A] =&gt; unfiltered.request.QParams.Report[E,B]" id="54928">Reporter</a><span class="delimiter">[</span><a title="" id="54929">E</a>,<a title="" id="54930">A</a>,<a title="" id="54931">B</a><span class="delimiter">]</span> = Option<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Report<span class="delimiter">[</span>E,B<span class="delimiter">]</span>

  <span class="keyword">case class</span> <a href="#111698" title="class Fail[E] extends AnyRef with Product with Serializable" id="112250">Fail</a><span class="delimiter">[</span><a title="" id="74409">E</a><span class="delimiter">]</span><a href="#112250" title="Product" class="delimiter">(</a><a title="String" id="111957">name</a>: <span title="String">String</span>, <a title="E" id="111958">error</a>: <a href="#74409" title="E">E</a><span class="delimiter">)</span>

  /* Implicitly provide 'orFail' for QueryResult (either) type. */
  <span class="keyword">case class</span> <a href="#111737" title="class QueryResultX[E, A] extends AnyRef with Product with Serializable" id="112272">QueryResultX</a><span class="delimiter">[</span><a title="" id="111770">E</a>,<a title="" id="111771">A</a><span class="delimiter">]</span><a href="#112272" title="Product" class="delimiter">(</a><a title="unfiltered.request.QParams.QueryResult[E,A]" id="111772">r</a>: <span title="unfiltered.request.QParams.QueryResult[E,A]">QueryResult</span><span class="delimiter">[</span>E,A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[B &gt;: A](handler: unfiltered.request.QParams.Log[E] =&gt; B)B" id="55858">orFail</a><span class="delimiter">[</span><a title=" &gt;: A" id="55860">B</a> &gt;: A<span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.QParams.Log[E] =&gt; B" id="55868">handler</a>: Log<span class="delimiter">[</span>E<span class="delimiter">]</span> =&gt; B<span class="delimiter">)</span> =
      <a href="#111772" title="=&gt; unfiltered.request.QParams.QueryResult[E,A]">r</a>.<span title="=&gt; scala.util.Either.LeftProjection[unfiltered.request.QParams.Log[E],A]">left</span>.<span title="(f: unfiltered.request.QParams.Log[E] =&gt; B)Serializable with Product with scala.util.Either[B,A]">map</span><a href="#125945" title="(x: B)B" class="delimiter">(</a><a href="#55868" title="unfiltered.request.QParams.Log[E] =&gt; B">handler</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span> // i.e. .merge, in 2.8
        <span class="keyword">case</span> Left<a href="#125939" title="B" class="delimiter">(</a><a href="#125940" title="B" id="55921">v</a><span class="delimiter">)</span> =&gt; <a href="#125945" title="(x: B)B">v</a>
        <span class="keyword">case</span> Right<a href="#125939" title="B" class="delimiter">(</a><a href="#125941" title="A" id="55925">v</a><span class="delimiter">)</span> =&gt; <a href="#125945" title="(x: B)B">v</a>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[E, A](r: unfiltered.request.QParams.QueryResult[E,A])unfiltered.request.QParams.QueryResultX[E,A]" id="54941">queryOrElse</a><span class="delimiter">[</span><a title="" id="54944">E</a>,<a title="" id="54945">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.QParams.QueryResult[E,A]" id="55006">r</a>: <span title="unfiltered.request.QParams.QueryResult[E,A]">QueryResult</span><span class="delimiter">[</span>E,A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#112272" title="unfiltered.request.QParams.QueryResultX[E,A]">QueryResultX</a><span class="delimiter">[</span>E,A<span class="delimiter">]</span> =
    <a href="#112272" title="(r: unfiltered.request.QParams.QueryResult[E,A])unfiltered.request.QParams.QueryResultX[E,A]">QueryResultX</a><span class="delimiter">(</span><a href="#55006" title="unfiltered.request.QParams.QueryResult[E,A]">r</a><span class="delimiter">)</span>

  /* The query-building monad, a variant of state-transformer. */
  <span class="keyword">case class</span> <a href="#112002" title="class QueryM[E, A] extends AnyRef with Product with Serializable" id="112294">QueryM</a><span class="delimiter">[</span><a title="" id="111791">E</a>,<a title="" id="111792">A</a><span class="delimiter">]</span><a href="#112294" title="Product" class="delimiter">(</a><a title="(unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], A)" id="111793">exec</a>: <span title="(unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], A)">QueryFn</span><span class="delimiter">[</span>E,A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[B](f: A =&gt; unfiltered.request.QParams.QueryM[E,B])unfiltered.request.QParams.QueryM[E,B]" id="55522">flatMap</a><span class="delimiter">[</span><a title="" id="55524">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; unfiltered.request.QParams.QueryM[E,B]" id="55584">f</a>: A =&gt; QueryM<span class="delimiter">[</span>E,B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#112294" title="unfiltered.request.QParams.QueryM[E,B]">QueryM</a><span class="delimiter">[</span>E,B<span class="delimiter">]</span> =
      <a href="#112294" title="(exec: (unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], B))unfiltered.request.QParams.QueryM[E,B]">QueryM</a> <span class="delimiter">{</span>
        <span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="111799">params</a>, <a title="Option[String]" id="111800">key0</a>, <a title="unfiltered.request.QParams.Log[E]" id="111801">log0</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#125965" title="(x: (Option[String], unfiltered.request.QParams.Log[E], A))(Option[String], unfiltered.request.QParams.Log[E], A)" class="delimiter">(</a><a href="#125963" title="Option[String]" id="111803">key1</a>, <a href="#125963" title="unfiltered.request.QParams.Log[E]" id="111804">log1</a>, <a href="#125963" title="A" id="111805">value</a><span class="delimiter">)</span> = <a href="#111793" title="(v1: unfiltered.request.Params.Map, v2: Option[String], v3: unfiltered.request.QParams.Log[E])(Option[String], unfiltered.request.QParams.Log[E], A)">exec</a><a href="#125963" title="(Option[String], unfiltered.request.QParams.Log[E], A) @unchecked" class="delimiter">(</a><a href="#111799" title="unfiltered.request.Params.Map">params</a>, <a href="#111800" title="Option[String]">key0</a>, <a href="#111801" title="unfiltered.request.QParams.Log[E]">log0</a><span class="delimiter">)</span>
          <a href="#55584" title="(v1: A)unfiltered.request.QParams.QueryM[E,B]">f</a><span class="delimiter">(</span><a href="#111805" title="A">value</a><span class="delimiter">)</span>.<a href="#111793" title="(v1: unfiltered.request.Params.Map, v2: Option[String], v3: unfiltered.request.QParams.Log[E])(Option[String], unfiltered.request.QParams.Log[E], B)">exec</a><span class="delimiter">(</span><a href="#111799" title="unfiltered.request.Params.Map">params</a>, <a href="#111803" title="Option[String]">key1</a>, <a href="#111804" title="unfiltered.request.QParams.Log[E]">log1</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    /* Compose monads, ignoring value of this. */
    <span class="keyword">def</span> <a title="[B](that: unfiltered.request.QParams.QueryM[E,B])unfiltered.request.QParams.QueryM[E,B]" id="55525">andThen</a><span class="delimiter">[</span><a title="" id="55527">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.QParams.QueryM[E,B]" id="111849">that</a>: <a href="#112294" title="unfiltered.request.QParams.QueryM[E,B]">QueryM</a><span class="delimiter">[</span>E,B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#112294" title="unfiltered.request.QParams.QueryM[E,B]">QueryM</a><span class="delimiter">[</span>E,B<span class="delimiter">]</span> =
      <a href="#55522" title="(f: A =&gt; unfiltered.request.QParams.QueryM[E,B])unfiltered.request.QParams.QueryM[E,B]">flatMap</a><span class="delimiter">(</span><a title="A" id="111855">_</a> =&gt; <a href="#111849" title="unfiltered.request.QParams.QueryM[E,B]">that</a><span class="delimiter">)</span>

    /* This map is not defined as flatMap(unit(f(_))), as expected.
       If any errors have been accumulated, it does NOT run the
       query function. */
    <span class="keyword">def</span> <a title="[B](f: A =&gt; B)unfiltered.request.QParams.QueryM[E,unfiltered.request.QParams.QueryResult[E,B]]" id="55528">map</a><span class="delimiter">[</span><a title="" id="55530">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; B" id="55678">f</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#112294" title="unfiltered.request.QParams.QueryM[E,unfiltered.request.QParams.QueryResult[E,B]]">QueryM</a><span class="delimiter">[</span>E,QueryResult<span class="delimiter">[</span>E,B<span class="delimiter">]</span><span class="delimiter">]</span> =
      <a href="#112294" title="(exec: (unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], unfiltered.request.QParams.QueryResult[E,B]))unfiltered.request.QParams.QueryM[E,unfiltered.request.QParams.QueryResult[E,B]]">QueryM</a> <span class="delimiter">{</span>
        <span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="111861">params</a>, <a title="Option[String]" id="111862">key0</a>, <a title="unfiltered.request.QParams.Log[E]" id="111863">log0</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#125971" title="(x: (Option[String], unfiltered.request.QParams.Log[E], A))(Option[String], unfiltered.request.QParams.Log[E], A)" class="delimiter">(</a><a href="#125969" title="Option[String]" id="111865">key1</a>, <a href="#125969" title="unfiltered.request.QParams.Log[E]" id="111866">log1</a>, <a href="#125969" title="A" id="111867">value</a><span class="delimiter">)</span> = <a href="#111793" title="(v1: unfiltered.request.Params.Map, v2: Option[String], v3: unfiltered.request.QParams.Log[E])(Option[String], unfiltered.request.QParams.Log[E], A)">exec</a><a href="#125969" title="(Option[String], unfiltered.request.QParams.Log[E], A) @unchecked" class="delimiter">(</a><a href="#111861" title="unfiltered.request.Params.Map">params</a>, <a href="#111862" title="Option[String]">key0</a>, <a href="#111863" title="unfiltered.request.QParams.Log[E]">log0</a><span class="delimiter">)</span>
          <span title="(_1: Option[String], _2: unfiltered.request.QParams.Log[E], _3: unfiltered.request.QParams.QueryResult[E,B])(Option[String], unfiltered.request.QParams.Log[E], unfiltered.request.QParams.QueryResult[E,B])" class="delimiter">(</span><a href="#111865" title="Option[String]">key1</a>, <a href="#111866" title="unfiltered.request.QParams.Log[E]">log1</a>, <a href="#111866" title="unfiltered.request.QParams.Log[E]">log1</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#125975" title="unfiltered.request.QParams.QueryResult[E,B]">Nil</a> =&gt; <span title="(b: B)scala.util.Right[Nothing,B]">Right</span><a href="#125979" title="(x: unfiltered.request.QParams.QueryResult[E,B])unfiltered.request.QParams.QueryResult[E,B]" class="delimiter">(</a><a href="#55678" title="(v1: A)B">f</a><span class="delimiter">(</span><a href="#111867" title="A">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> _ =&gt; <span title="(a: List[unfiltered.request.QParams.Fail[E]])scala.util.Left[List[unfiltered.request.QParams.Fail[E]],Nothing]">Left</span><a href="#125979" title="(x: unfiltered.request.QParams.QueryResult[E,B])unfiltered.request.QParams.QueryResult[E,B]" class="delimiter">(</a><a href="#111866" title="unfiltered.request.QParams.Log[E]">log1</a>.<span title="=&gt; List[unfiltered.request.QParams.Fail[E]]">reverse</span><span class="delimiter">)</span>
          <span class="delimiter">}</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    /* Combinator for filtering the value and tagging errors. */
    <span class="keyword">def</span> <a title="[B](f: A =&gt; unfiltered.request.QParams.Report[E,B])unfiltered.request.QParams.QueryM[E,Option[B]]" id="55531">is</a><span class="delimiter">[</span><a title="" id="55533">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; unfiltered.request.QParams.Report[E,B]" id="55540">f</a>: A =&gt; Report<span class="delimiter">[</span>E,B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#112294" title="unfiltered.request.QParams.QueryM[E,Option[B]]">QueryM</a><span class="delimiter">[</span>E,Option<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span> =
      <a href="#112294" title="(exec: (unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], Option[B]))unfiltered.request.QParams.QueryM[E,Option[B]]">QueryM</a> <span class="delimiter">{</span>
        <span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="111913">params</a>, <a title="Option[String]" id="111914">key0</a>, <a title="unfiltered.request.QParams.Log[E]" id="111915">log0</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#125989" title="(x: (Option[String], unfiltered.request.QParams.Log[E], A))(Option[String], unfiltered.request.QParams.Log[E], A)" class="delimiter">(</a><a href="#125987" title="Option[String]" id="111917">key1</a>, <a href="#125987" title="unfiltered.request.QParams.Log[E]" id="111918">log1</a>, <a href="#125987" title="A" id="111919">value</a><span class="delimiter">)</span> = <a href="#111793" title="(v1: unfiltered.request.Params.Map, v2: Option[String], v3: unfiltered.request.QParams.Log[E])(Option[String], unfiltered.request.QParams.Log[E], A)">exec</a><a href="#125987" title="(Option[String], unfiltered.request.QParams.Log[E], A) @unchecked" class="delimiter">(</a><a href="#111913" title="unfiltered.request.Params.Map">params</a>, <a href="#111914" title="Option[String]">key0</a>, <a href="#111915" title="unfiltered.request.QParams.Log[E]">log0</a><span class="delimiter">)</span>
          <a href="#111917" title="Option[String]">key1</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#126002" title="(Option[String], unfiltered.request.QParams.Log[E], Option[B])">None</a> =&gt; <a href="#126007" title="(x: (Option[String], unfiltered.request.QParams.Log[E], Option[B]))(Option[String], unfiltered.request.QParams.Log[E], Option[B])" class="delimiter">(</a><a href="#111917" title="Option[String]">key1</a>, <a href="#111918" title="unfiltered.request.QParams.Log[E]">log1</a>, <span title="None.type">None</span><span class="delimiter">)</span> // do not record error
            <span class="keyword">case</span> Some<a href="#126002" title="(Option[String], unfiltered.request.QParams.Log[E], Option[B])" class="delimiter">(</a><a href="#126004" title="String" id="111946">k</a><span class="delimiter">)</span> =&gt;
              <a href="#55540" title="(v1: A)unfiltered.request.QParams.Report[E,B]">f</a><a href="#126007" title="(x: (Option[String], unfiltered.request.QParams.Log[E], Option[B]))(Option[String], unfiltered.request.QParams.Log[E], Option[B])" class="delimiter">(</a><a href="#111919" title="A">value</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> Left<a href="#125993" title="(Option[String], unfiltered.request.QParams.Log[E], Option[B])" class="delimiter">(</a><a href="#125994" title="E" id="111949">err</a><span class="delimiter">)</span> =&gt; <a href="#125997" title="(x: (Option[String], unfiltered.request.QParams.Log[E], Option[B]))(Option[String], unfiltered.request.QParams.Log[E], Option[B])" class="delimiter">(</a><span title="None.type">None</span>, <a href="#112250" title="(name: String, error: E)unfiltered.request.QParams.Fail[E]">Fail</a><span class="delimiter">(</span><a href="#111946" title="String">k</a>,<a href="#111949" title="E">err</a><span class="delimiter">)</span><a href="#111956" title="(x: unfiltered.request.QParams.Fail[E])List[unfiltered.request.QParams.Fail[E]]">::</a><a href="#111918" title="unfiltered.request.QParams.Log[E]">log1</a>, <span title="None.type">None</span><span class="delimiter">)</span> // do record
                <span class="keyword">case</span> Right<a href="#125993" title="(Option[String], unfiltered.request.QParams.Log[E], Option[B])" class="delimiter">(</a><a href="#125995" title="Option[B]" id="111975">v</a><span class="delimiter">)</span> =&gt; <a href="#125997" title="(x: (Option[String], unfiltered.request.QParams.Log[E], Option[B]))(Option[String], unfiltered.request.QParams.Log[E], Option[B])" class="delimiter">(</a><a href="#111917" title="Option[String]">key1</a>, <a href="#111918" title="unfiltered.request.QParams.Log[E]">log1</a>, <a href="#111975" title="Option[B]">v</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(params: unfiltered.request.Params.Map)A" id="55534">apply</a><span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="55823">params</a>: Params.<span title="unfiltered.request.Params.Map">Map</span><span class="delimiter">)</span> = <a href="#111793" title="(v1: unfiltered.request.Params.Map, v2: Option[String], v3: unfiltered.request.QParams.Log[E])(Option[String], unfiltered.request.QParams.Log[E], A)">exec</a><span class="delimiter">(</span><a href="#55823" title="unfiltered.request.Params.Map">params</a>, <span title="None.type">None</span>, <span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span>.<span title="=&gt; A">_3</span>
  <span class="delimiter">}</span>

  /** Create a validation token from a named value from the input Params.Map */
  <span class="keyword">def</span> <a title="[E](key: String)unfiltered.request.QParams.QueryM[E,Option[String]]" id="54951">lookup</a><span class="delimiter">[</span><a title="" id="54953">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="55516">key</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#112294" title="unfiltered.request.QParams.QueryM[E,Option[String]]">QueryM</a><span class="delimiter">[</span>E,Option<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#112294" title="(exec: (unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], Option[String]))unfiltered.request.QParams.QueryM[E,Option[String]]">QueryM</a> <span class="delimiter">{</span>
      <span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="112029">params</a>, <a title="Option[String]" id="112030">_</a>, <a title="unfiltered.request.QParams.Log[E]" id="112031">log0</a><span class="delimiter">)</span> =&gt;
        <span title="(_1: Some[String], _2: unfiltered.request.QParams.Log[E], _3: Option[String])(Some[String], unfiltered.request.QParams.Log[E], Option[String])" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#55516" title="String">key</a><span class="delimiter">)</span>, <a href="#112031" title="unfiltered.request.QParams.Log[E]">log0</a>, <a href="#112029" title="unfiltered.request.Params.Map">params</a>.<span title="(key: String)Option[Seq[String]]">get</span><span class="delimiter">(</span><a href="#55516" title="String">key</a><span class="delimiter">)</span>.<span title="(f: Seq[String] =&gt; Option[String])Option[String]">flatMap</span> <span class="delimiter">{</span> <a href="#112047" title="Seq[String]">_</a>.<span title="=&gt; Option[String]">headOption</span> <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  /** Create and name a validation token for an external input */
  <span class="keyword">def</span> <a title="[E, A](key: String, value: Option[A])unfiltered.request.QParams.QueryM[E,Option[A]]" id="54954">external</a><span class="delimiter">[</span><a title="" id="54957">E</a>, <a title="" id="54958">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="112062">key</a>: <span title="String">String</span>, <a title="Option[A]" id="112063">value</a>: <span title="Option[A]">Option</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#112294" title="unfiltered.request.QParams.QueryM[E,Option[A]]">QueryM</a><span class="delimiter">[</span>E,Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#112294" title="(exec: (unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], Option[A]))unfiltered.request.QParams.QueryM[E,Option[A]]">QueryM</a> <span class="delimiter">{</span>
      <span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="112070">params</a>, <a title="Option[String]" id="112071">_</a>, <a title="unfiltered.request.QParams.Log[E]" id="112072">log0</a><span class="delimiter">)</span> =&gt;
        <span title="(_1: Some[String], _2: unfiltered.request.QParams.Log[E], _3: Option[A])(Some[String], unfiltered.request.QParams.Log[E], Option[A])" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#112062" title="String">key</a><span class="delimiter">)</span>, <a href="#112072" title="unfiltered.request.QParams.Log[E]">log0</a>, <a href="#112063" title="Option[A]">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  /* Functions that are useful arguments to QueryM.is */
  <span class="keyword">def</span> <a title="[E, A](err: E)Option[A] =&gt; unfiltered.request.QParams.Report[E,A]" id="54959">required</a><span class="delimiter">[</span><a title="" id="54962">E</a>,<a title="" id="54963">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="E" id="55577">err</a>:<a href="#54962" title="E">E</a><span class="delimiter">)</span>: <span title="Option[A] =&gt; unfiltered.request.QParams.Report[E,A]">Reporter</span><span class="delimiter">[</span>E,A,A<span class="delimiter">]</span> = <a href="#112096" title="Option[A]" class="delimiter">{</a>
    <span class="keyword">case</span> <a href="#126028" title="unfiltered.request.QParams.Report[E,A]">None</a> =&gt; <span title="(a: E)scala.util.Left[E,Nothing]">Left</span><a href="#126032" title="(x: unfiltered.request.QParams.Report[E,A])unfiltered.request.QParams.Report[E,A]" class="delimiter">(</a><a href="#55577" title="E">err</a><span class="delimiter">)</span>
    <span class="keyword">case</span> oa =&gt; <span title="(b: Option[A])scala.util.Right[Nothing,Option[A]]">Right</span><a href="#126032" title="(x: unfiltered.request.QParams.Report[E,A])unfiltered.request.QParams.Report[E,A]" class="delimiter">(</a><a href="#126028" title="Option[A]">oa</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]" id="54964">optional</a><span class="delimiter">[</span><a title="" id="54967">E</a>,<a title="" id="54968">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[A]" id="55634">xs</a>: <span title="Option[A]">Option</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="unfiltered.request.QParams.Report[E,Option[A]]">Report</span><span class="delimiter">[</span>E,Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <span title="(b: Some[Option[A]])scala.util.Right[Nothing,Some[Option[A]]]">Right</span><span class="delimiter">(</span><span title="(x: Option[A])Some[Option[A]]">Some</span><span class="delimiter">(</span><a href="#55634" title="Option[A]">xs</a><span class="delimiter">)</span><span class="delimiter">)</span>

  /** Promote c to an error reporter that fails if Some input is discarded */
  <span class="keyword">def</span> <a title="[E, A, B](c: Option[A] =&gt; Option[B], err: A =&gt; E)Option[A] =&gt; unfiltered.request.QParams.Report[E,B]" id="54969">watch</a><span class="delimiter">[</span><a title="" id="54973">E</a>,<a title="" id="54974">A</a>,<a title="" id="54975">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[A] =&gt; Option[B]" id="55547">c</a>: Option<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>B<span class="delimiter">]</span>, <a title="A =&gt; E" id="55548">err</a>: A =&gt; E<span class="delimiter">)</span>: <span title="Option[A] =&gt; unfiltered.request.QParams.Report[E,B]">Reporter</span><span class="delimiter">[</span>E,A,B<span class="delimiter">]</span> = <a href="#112114" title="Option[A]" class="delimiter">{</a>
    <span class="keyword">case</span> <a href="#126040" title="unfiltered.request.QParams.Report[E,B]">None</a> =&gt; <span title="(b: None.type)scala.util.Right[Nothing,None.type]">Right</span><a href="#126045" title="(x: unfiltered.request.QParams.Report[E,B])unfiltered.request.QParams.Report[E,B]" class="delimiter">(</a><span title="None.type">None</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Some<a href="#126040" title="unfiltered.request.QParams.Report[E,B]" class="delimiter">(</a><a href="#126042" title="A" id="112121">a</a><span class="delimiter">)</span> =&gt; <a href="#55547" title="(v1: Option[A])Option[B]">c</a><span class="delimiter">(</span><span title="(x: A)Some[A]">Some</span><span class="delimiter">(</span><a href="#112121" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: B =&gt; scala.util.Right[Nothing,Some[B]])Option[scala.util.Right[Nothing,Some[B]]]">map</span> <span class="delimiter">{</span> <a title="B" id="112130">b</a> =&gt; <span title="(b: Some[B])scala.util.Right[Nothing,Some[B]]">Right</span><span class="delimiter">(</span><span title="(x: B)Some[B]">Some</span><span class="delimiter">(</span><a href="#112130" title="B">b</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span> <a href="#126045" title="(x: unfiltered.request.QParams.Report[E,B])unfiltered.request.QParams.Report[E,B]">getOrElse</a> <span title="(a: E)scala.util.Left[E,Nothing]">Left</span><span class="delimiter">(</span><a href="#55548" title="(v1: A)E">err</a><span class="delimiter">(</span><a href="#112121" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Convert a predicate into an error reporter */
  <span class="keyword">def</span> <a title="[E, A](p: A =&gt; Boolean, err: A =&gt; E)Option[A] =&gt; unfiltered.request.QParams.Report[E,A]" id="54976">pred</a><span class="delimiter">[</span><a title="" id="54979">E</a>,<a title="" id="54980">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; Boolean" id="55611">p</a>: A =&gt; Boolean, <a title="A =&gt; E" id="55612">err</a>: A =&gt; E<span class="delimiter">)</span>: <span title="Option[A] =&gt; unfiltered.request.QParams.Report[E,A]">Reporter</span><span class="delimiter">[</span>E,A,A<span class="delimiter">]</span> =
    <a href="#54969" title="(c: Option[A] =&gt; Option[A], err: A =&gt; E)Option[A] =&gt; unfiltered.request.QParams.Report[E,A]">watch</a><span class="delimiter">(</span><span class="delimiter">{</span><a href="#112166" title="Option[A]">_</a> <span title="(p: A =&gt; Boolean)Option[A]">filter</span> <a href="#55611" title="A =&gt; Boolean">p</a><span class="delimiter">}</span>, <a href="#55612" title="A =&gt; E">err</a><span class="delimiter">)</span>

  /** Convert f into an error reporter that never reports errors */
  <span class="keyword">def</span> <a title="[E, A, B](f: Option[A] =&gt; Option[B])Option[A] =&gt; unfiltered.request.QParams.Report[E,B]" id="54981">ignore</a><span class="delimiter">[</span><a title="" id="54985">E</a>,<a title="" id="54986">A</a>,<a title="" id="54987">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[A] =&gt; Option[B]" id="112170">f</a>: Option<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[A] =&gt; unfiltered.request.QParams.Report[E,B]">Reporter</span><span class="delimiter">[</span>E,A,B<span class="delimiter">]</span> =
    <a title="Option[A]" id="112173">opt</a> =&gt; <span title="(b: Option[B])scala.util.Right[Nothing,Option[B]]">Right</span><span class="delimiter">(</span><a href="#112170" title="(v1: Option[A])Option[B]">f</a><span class="delimiter">(</span><a href="#112173" title="Option[A]">opt</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[E](e: String =&gt; E)Option[String] =&gt; unfiltered.request.QParams.Report[E,Int]" id="54988">int</a><span class="delimiter">[</span><a title="" id="54990">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String =&gt; E" id="112179">e</a>: String =&gt; E<span class="delimiter">)</span> = <a href="#54969" title="(c: Option[String] =&gt; Option[Int], err: String =&gt; E)Option[String] =&gt; unfiltered.request.QParams.Report[E,Int]">watch</a><span class="delimiter">(</span><a href="#7802" title="unfiltered.request.Params.type">Params</a>.<a href="#35661" title="(os: Option[String])Option[Int]">int</a>, <a href="#112179" title="String =&gt; E">e</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[E](e: String =&gt; E)Option[String] =&gt; unfiltered.request.QParams.Report[E,Long]" id="54991">long</a><span class="delimiter">[</span><a title="" id="54993">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String =&gt; E" id="112190">e</a>: String =&gt; E<span class="delimiter">)</span> = <a href="#54969" title="(c: Option[String] =&gt; Option[Long], err: String =&gt; E)Option[String] =&gt; unfiltered.request.QParams.Report[E,Long]">watch</a><span class="delimiter">(</span><a href="#7802" title="unfiltered.request.Params.type">Params</a>.<a href="#35662" title="(os: Option[String])Option[Long]">long</a>, <a href="#112190" title="String =&gt; E">e</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[E](e: Int =&gt; E)Option[Int] =&gt; unfiltered.request.QParams.Report[E,Int]" id="54994">even</a><span class="delimiter">[</span><a title="" id="54996">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int =&gt; E" id="112201">e</a>: Int =&gt; E<span class="delimiter">)</span> = <a href="#54969" title="(c: Option[Int] =&gt; Option[Int], err: Int =&gt; E)Option[Int] =&gt; unfiltered.request.QParams.Report[E,Int]">watch</a><span class="delimiter">(</span><a href="#7802" title="unfiltered.request.Params.type">Params</a>.<a href="#35665" title="=&gt; Option[Int] =&gt; Option[Int]">even</a>, <a href="#112201" title="Int =&gt; E">e</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[E](e: Int =&gt; E)Option[Int] =&gt; unfiltered.request.QParams.Report[E,Int]" id="54997">odd</a><span class="delimiter">[</span><a title="" id="54999">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int =&gt; E" id="112210">e</a>: Int =&gt; E<span class="delimiter">)</span> = <a href="#54969" title="(c: Option[Int] =&gt; Option[Int], err: Int =&gt; E)Option[Int] =&gt; unfiltered.request.QParams.Report[E,Int]">watch</a><span class="delimiter">(</span><a href="#7802" title="unfiltered.request.Params.type">Params</a>.<a href="#35667" title="=&gt; Option[Int] =&gt; Option[Int]">odd</a>, <a href="#112210" title="Int =&gt; E">e</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[E]=&gt; Option[String] =&gt; unfiltered.request.QParams.Report[E,String]" id="55000">trimmed</a><span class="delimiter">[</span><a title="" id="55002">E</a><span class="delimiter">]</span> = <a href="#54981" title="[E, A, B](f: Option[A] =&gt; Option[B])Option[A] =&gt; unfiltered.request.QParams.Report[E,B]">ignore</a><span title="(f: Option[String] =&gt; Option[String])Option[String] =&gt; unfiltered.request.QParams.Report[E,String]" class="delimiter">[</span><a href="#55002" title="E">E</a>,<span title="String">String</span>,<span title="String">String</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#7802" title="unfiltered.request.Params.type">Params</a>.<a href="#35669" title="(s: Option[String])Option[String]">trimmed</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[E](e: E)Option[String] =&gt; unfiltered.request.QParams.Report[E,String]" id="55003">nonempty</a><span class="delimiter">[</span><a title="" id="55005">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="E" id="55546">e</a>: <a href="#55005" title="E">E</a><span class="delimiter">)</span> = <a href="#54969" title="(c: Option[String] =&gt; Option[String], err: String =&gt; E)Option[String] =&gt; unfiltered.request.QParams.Report[E,String]">watch</a><span class="delimiter">(</span><a href="#7802" title="unfiltered.request.Params.type">Params</a>.<a href="#35670" title="=&gt; Option[String] =&gt; Option[String]">nonempty</a>, <span class="delimiter">(</span>s: <span title="String">String</span><span class="delimiter">)</span> =&gt; <a href="#55546" title="E">e</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
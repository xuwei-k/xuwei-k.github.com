<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>oauth/unfiltered/oauth/oauth.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> unfiltered.oauth

<span class="keyword">import</span> unfiltered._
<span class="keyword">import</span> unfiltered.request._
<span class="keyword">import</span> unfiltered.response._
<span class="keyword">import</span> unfiltered.request.<span class="delimiter">{</span>HttpRequest =&gt; Req<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="unfiltered.oauth.OAuth.type" id="73851">OAuth</a> <a href="#11232" title="unfiltered.oauth.OAuth.type" class="delimiter">{</a>
  <span class="keyword">val</span> <a title="String" id="73410">ConsumerKey</a> = <span title="String(&quot;oauth_consumer_key&quot;)" class="string">&quot;oauth_consumer_key&quot;</span>
  <span class="keyword">val</span> <a title="String" id="73412">SignatureMethod</a> = <span title="String(&quot;oauth_signature_method&quot;)" class="string">&quot;oauth_signature_method&quot;</span>
  <span class="keyword">val</span> <a title="String" id="73414">Timestamp</a> = <span title="String(&quot;oauth_timestamp&quot;)" class="string">&quot;oauth_timestamp&quot;</span>
  <span class="keyword">val</span> <a title="String" id="73416">Nonce</a> = <span title="String(&quot;oauth_nonce&quot;)" class="string">&quot;oauth_nonce&quot;</span>
  <span class="keyword">val</span> <a title="String" id="73418">Callback</a> = <span title="String(&quot;oauth_callback&quot;)" class="string">&quot;oauth_callback&quot;</span>
  <span class="keyword">val</span> <a title="String" id="73420">Sig</a> = <span title="String(&quot;oauth_signature&quot;)" class="string">&quot;oauth_signature&quot;</span>
  <span class="keyword">val</span> <a title="String" id="73422">TokenKey</a> = <span title="String(&quot;oauth_token&quot;)" class="string">&quot;oauth_token&quot;</span>
  <span class="keyword">val</span> <a title="String" id="73424">Verifier</a> = <span title="String(&quot;oauth_verifier&quot;)" class="string">&quot;oauth_verifier&quot;</span>
  <span class="keyword">val</span> <a title="String" id="73426">Version</a> = <span title="String(&quot;oauth_version&quot;)" class="string">&quot;oauth_version&quot;</span>

  /** out-of-bounds callback value */
  <span class="keyword">val</span> <a title="String" id="73428">Oob</a> = <span title="String(&quot;oob&quot;)" class="string">&quot;oob&quot;</span>

  <span class="keyword">val</span> <a title="String" id="73430">XAuthorizedIdentity</a> = <span title="String(&quot;X-Authorized-Identity&quot;)" class="string">&quot;X-Authorized-Identity&quot;</span>

  /** Authorization: OAuth header extractor */
  <span class="keyword">object</span> <a title="unfiltered.oauth.OAuth.Header.type" id="73432">Header</a> <a href="#73433" title="unfiltered.oauth.OAuth.Header.type" class="delimiter">{</a>
    <span class="keyword">import</span> <a href="encoding.scala.html#11189" title="unfiltered.oauth.Encoding.type">Encoding</a>._
    <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="73490">KeyVal</a> = <span title="String(&quot;[ ]?(\\w+)=\&quot;([\\w|:|\\/|.|%|-]+)\&quot; &quot;)" class="string">&quot;&quot;&quot;[ ]?(\w+)=&quot;([\w|:|\/|.|%|-]+)&quot; &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">trim</span>.<span title="=&gt; scala.util.matching.Regex">r</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Set[String]" id="73492">keys</a> = <span title="=&gt; scala.collection.immutable.Set.type">Set</span>.<span title="scala.collection.immutable.Set[String]">empty</span> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <span title="String(&quot;realm&quot;)" class="string">&quot;realm&quot;</span> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <a href="#73410" title="=&gt; String">ConsumerKey</a> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <a href="#73422" title="=&gt; String">TokenKey</a> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <a href="#73412" title="=&gt; String">SignatureMethod</a> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span>
      <a href="#73420" title="=&gt; String">Sig</a> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <a href="#73414" title="=&gt; String">Timestamp</a> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <a href="#73416" title="=&gt; String">Nonce</a> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <a href="#73418" title="=&gt; String">Callback</a> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <a href="#73424" title="=&gt; String">Verifier</a> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <a href="#73426" title="=&gt; String">Version</a>

    <span class="keyword">def</span> <a title="(hvals: Seq[String])scala.collection.immutable.Map[String,Seq[String]]" id="73494">apply</a><span class="delimiter">(</span><a title="Seq[String]" id="73697">hvals</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
      <span title="(elems: (String, Seq[String])*)scala.collection.immutable.Map[String,Seq[String]]">Map</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#73697" title="Seq[String]">hvals</a> <span title="(f: String =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],String,Seq[String]])Seq[String]">map</span> <span class="delimiter">{</span> <a href="#73717" title="String">_</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;OAuth &quot;)" class="string">&quot;OAuth &quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="delimiter">}</span> <span title="(f: String =&gt; scala.collection.GenTraversableOnce[(String, Seq[String])])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],(String, Seq[String]),Seq[(String, Seq[String])]])Seq[(String, Seq[String])]">flatMap</span> <a href="#73769" title="String" class="delimiter">{</a>
        <span class="keyword">case</span> <a href="#73490" title="(target: Any)Option[List[String]]">KeyVal</a><span class="delimiter">(</span><a title="String" id="73771">k</a>, <a title="String" id="73772">v</a><span class="delimiter">)</span> <span class="keyword">if</span><span class="delimiter">(</span><a href="#73492" title="=&gt; scala.collection.immutable.Set[String]">keys</a>.<span title="(elem: String)Boolean">contains</span><span class="delimiter">(</span><a href="#73771" title="String">k</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <span title="(elems: (String, Seq[String])*)Seq[(String, Seq[String])]">Seq</span><a href="#123207" title="(x: Seq[(String, Seq[String])])Seq[(String, Seq[String])]" class="delimiter">(</a><span class="delimiter">(</span><a href="#73771" title="(x: String)ArrowAssoc[String]">k</a> <span title="(y: Seq[String])(String, Seq[String])">-&gt;</span> <span title="(elems: String*)Seq[String]">Seq</span><span class="delimiter">(</span><a href="encoding.scala.html#73022" title="(encoded: String)(implicit encoding: String)String">decode</a><a href="encoding.scala.html#73019" title="=&gt; String" class="delimiter">(</a><a href="#73772" title="String">v</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> b =&gt; <a href="#123207" title="(x: Seq[(String, Seq[String])])Seq[(String, Seq[String])]">Nil</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>: _*<span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(hvals: Seq[String])Some[scala.collection.immutable.Map[String,Seq[String]]]" id="73495">unapply</a><span class="delimiter">(</span><a title="Seq[String]" id="73823">hvals</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="(x: scala.collection.immutable.Map[String,Seq[String]])Some[scala.collection.immutable.Map[String,Seq[String]]]">Some</span><span class="delimiter">(</span><a href="#73494" title="(hvals: Seq[String])scala.collection.immutable.Map[String,Seq[String]]">apply</a><span class="delimiter">(</span><a href="#73823" title="Seq[String]">hvals</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span title="AnyRef" class="delimiter">}</span>

/** Defines end points for oauth interation */
<span title="AnyRef" class="keyword">trait</span> <a title="trait OAuthPaths extends AnyRef" id="11323">OAuthPaths</a> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="=&gt; String" id="73475">RequestTokenPath</a>: <span title="String">String</span>
  <span class="keyword">val</span> <a title="=&gt; String" id="73476">AuthorizationPath</a>: <span title="String">String</span>
  <span class="keyword">val</span> <a title="=&gt; String" id="73477">AccessTokenPath</a>: <span title="String">String</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">trait</span> <a title="trait DefaultOAuthPaths extends AnyRef with unfiltered.oauth.OAuthPaths" id="11179">DefaultOAuthPaths</a> <span title="Unit" class="keyword">extends</span> <a href="#11323" title="unfiltered.oauth.OAuthPaths">OAuthPaths</a> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="String" id="73479">RequestTokenPath</a> = <span title="String(&quot;/request_token&quot;)" class="string">&quot;/request_token&quot;</span>
  <span class="keyword">val</span> <a title="String" id="73481">AuthorizationPath</a> = <span title="String(&quot;/authorize&quot;)" class="string">&quot;/authorize&quot;</span>
  <span class="keyword">val</span> <a title="String" id="73483">AccessTokenPath</a> = <span title="String(&quot;/access_token&quot;)" class="string">&quot;/access_token&quot;</span>
<span class="delimiter">}</span>

/** Formatting for validation messages */
<span class="keyword">trait</span> <a title="trait Messages extends AnyRef" id="11212">Messages</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(param: String)String" id="73470">blankMsg</a><span class="delimiter">(</span><a title="String" id="73856">param</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span>
  <span class="keyword">def</span> <a title="(param: String)String" id="73471">requiredMsg</a><span class="delimiter">(</span><a title="String" id="73857">param</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">trait</span> <a title="trait DefaultMessages extends AnyRef with unfiltered.oauth.Messages" id="11176">DefaultMessages</a> <span title="Unit" class="keyword">extends</span> <a href="#11212" title="unfiltered.oauth.Messages">Messages</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(param: String)String" id="73473">blankMsg</a><span class="delimiter">(</span><a title="String" id="73860">param</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s can not be blank&quot;</span> <span title="(args: Any*)String">format</span> <a href="#73860" title="String">param</a>
  <span class="keyword">def</span> <a title="(param: String)String" id="73474">requiredMsg</a><span class="delimiter">(</span><a title="String" id="73866">param</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s is required&quot;</span> <span title="(args: Any*)String">format</span> <a href="#73866" title="String">param</a>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait Protected extends AnyRef with unfiltered.oauth.OAuthProvider with unfiltered.filter.Plan" id="11404">Protected</a> <span title="Unit" class="keyword">extends</span> <a href="#11347" title="unfiltered.oauth.OAuthProvider">OAuthProvider</a> <span class="keyword">with</span> unfiltered.filter.<a href="../../../filter/unfiltered/filter/plans.scala.html#8581" title="unfiltered.filter.Plan">Plan</a> <span class="delimiter">{</span>
  self: OAuthStores <span class="keyword">with</span> Messages =&gt;
  <span class="keyword">import</span> unfiltered.filter.request.ContextPath
  <span class="keyword">import</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#7910" title="unfiltered.request.QParams.type">QParams</a>._
  <span class="keyword">import</span> <a href="#73851" title="unfiltered.oauth.OAuth.type">OAuth</a>._

  <span class="keyword">def</span> <a title="=&gt; PartialFunction[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest],unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]]" id="73877">intent</a> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest],unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]] with Serializable" id="74443" class="delimiter">{</a>
    <span class="keyword">case</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#35646" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[scala.collection.immutable.Map[String,Seq[String]]]">Params</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="73926">params</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#57198" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" id="73927">request</a> =&gt;
      <span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,Seq[String]]" id="73928">headers</a> = <a href="../../../unfiltered/unfiltered/unfiltered/request/headers.scala.html#17611" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[String]">Authorization</a><span title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">(</span><a href="#73927" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
         <span class="keyword">case</span> Some<a href="#123232" title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">(</a><a href="#123233" title="String" id="73934">a</a><span class="delimiter">)</span> =&gt; <a href="#73851" title="unfiltered.oauth.OAuth.type">OAuth</a>.<a href="#73494" title="(hvals: Seq[String])scala.collection.immutable.Map[String,Seq[String]]">Header</a><a href="#123235" title="(x: scala.collection.immutable.Map[String,Seq[String]])scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">(</a><a href="#73934" title="String">a</a>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.WrappedArray[String]" class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
         <span class="keyword">case</span> _ =&gt; <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><a href="#123235" title="(x: scala.collection.immutable.Map[String,Seq[String]])scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]" id="73929">expected</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Option[String]" id="73978">oauth_consumer_key</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="73999">oauth_signature_method</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73412" title="=&gt; String">SignatureMethod</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73412" title="=&gt; String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73412" title="=&gt; String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="74020">timestamp</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="74041">nonce</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="74062">token</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="74083">signature</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73420" title="=&gt; String">Sig</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73420" title="=&gt; String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73420" title="=&gt; String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="74116">version</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73426" title="=&gt; String">Version</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54976" title="(p: String =&gt; Boolean, err: String =&gt; String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">pred</a> <span class="delimiter">(</span> <a href="#74093" title="String">_</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;1.0&quot;)" class="string">&quot;1.0&quot;</span>, <span title="String(&quot;invalid oauth version &quot;)" class="string">&quot;invalid oauth version &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#74099" title="String">_</a> <span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[Option[String]] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54964" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#74109" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>,<span title="String">String</span><span class="delimiter">]</span>
        <a title="Option[Option[String]]" id="74131">realm</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><span title="String(&quot;realm&quot;)" class="string">&quot;realm&quot;</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55528" title="(f: Option[Option[String]] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54964" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#74123" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="String">String</span><span class="delimiter">]</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <a href="#73439" title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse">protect</a><a href="#123254" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#73927" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#12733" title="=&gt; String">method</a>, <a href="#73927" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#12727" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>.<span title="()StringBuffer">getRequestURL</span>.<span title="()String">toString</span>, <a href="#73926" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#73928" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Failure<a href="#123248" title="~&gt; extends AnyRef with unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>_, _<span class="delimiter">)</span> =&gt;
            <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#9590" title="unfiltered.response.Unauthorized.type">Unauthorized</a> <a href="#123254" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/headers.scala.html#54841" title="(value: String*)unfiltered.response.ResponseHeader">WWWAuthenticate</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;OAuth realm=\&quot;%s\&quot;&quot;</span> <span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#74131" title="Option[Option[String]]">realm</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#123240" title="Any" class="delimiter">(</a><a href="#123241" title="Option[String]" id="74243">value</a><span class="delimiter">)</span> =&gt; <a href="#123243" title="(x: Any)Any">value</a>
              <span class="keyword">case</span> _ =&gt; <a href="#73927" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#12727" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>.<span title="()StringBuffer">getRequestURL</span>.<a href="#123243" title="(x: Any)Any">toString</a>
            <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> Authorized<a href="#123248" title="~&gt; extends AnyRef with unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#74254" title="String" id="74272">user</a><span class="delimiter">)</span> =&gt;
            <a href="#73927" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#12727" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>.<span title="(x$1: String, x$2: Any)Unit">setAttribute</span><span class="delimiter">(</span><a href="#73430" title="=&gt; String">XAuthorizedIdentity</a>, <a href="#74272" title="String">user</a><span class="delimiter">)</span>
            <a href="../../../unfiltered/unfiltered/unfiltered/response/pass.scala.html#9308" title="unfiltered.response.Pass.type">Pass</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55534" title="(params: unfiltered.request.Params.Map)unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]">expected</a><a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54941" title="(r: unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]])unfiltered.request.QParams.QueryResultX[String,unfiltered.response.ResponseFunction[Any]]" class="delimiter">(</a><a href="#73926" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#73928" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55858" title="(handler: unfiltered.request.QParams.Log[String] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">orFail</a> <span class="delimiter">{</span> <a title="unfiltered.request.QParams.Log[String]" id="74371">errors</a> =&gt;
        <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#8900" title="unfiltered.response.BadRequest.type">BadRequest</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#22177" title="(that: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/writers.scala.html#54423" title="(content: String)unfiltered.response.ResponseString">ResponseString</a><span class="delimiter">(</span><a href="#74371" title="unfiltered.request.QParams.Log[String]">errors</a>.<span title="(f: unfiltered.request.QParams.Fail[String] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[unfiltered.request.QParams.Fail[String]],String,List[String]])List[String]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">{</span> <a href="#74397" title="unfiltered.request.QParams.Fail[String]">_</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55845" title="=&gt; String">error</a> <span class="delimiter">}</span> <span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;. &quot;)" class="string">&quot;. &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait OAuthed extends AnyRef with unfiltered.oauth.OAuthProvider with unfiltered.filter.Plan" id="11320">OAuthed</a> <span title="Unit" class="keyword">extends</span> <a href="#11347" title="unfiltered.oauth.OAuthProvider">OAuthProvider</a> <span class="keyword">with</span> unfiltered.filter.<a href="../../../filter/unfiltered/filter/plans.scala.html#8581" title="unfiltered.filter.Plan">Plan</a> <span class="delimiter">{</span>
  self: OAuthStores <span class="keyword">with</span> Messages <span class="keyword">with</span> OAuthPaths =&gt;
  <span class="keyword">import</span> unfiltered.filter.request.ContextPath
  <span class="keyword">import</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#7910" title="unfiltered.request.QParams.type">QParams</a>._
  <span class="keyword">import</span> <a href="#73851" title="unfiltered.oauth.OAuth.type">OAuth</a>._

  <span class="keyword">def</span> <a title="=&gt; PartialFunction[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest],unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]]" id="73452">intent</a> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest],unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]] with Serializable" id="75871" class="delimiter">{</a>
    <span class="keyword">case</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/methods.scala.html#34957" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]]">POST</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span><a href="../../../filter/unfiltered/filter/request/paths.scala.html#45774" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(String, String)]">ContextPath</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span>_, <a href="#73475" title="=&gt; String">RequestTokenPath</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#57198" title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">&amp;</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#35646" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[scala.collection.immutable.Map[String,Seq[String]]]">Params</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="74588">params</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#57198" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" id="74589">request</a> =&gt;
       <span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,Seq[String]]" id="74590">headers</a> = <a href="../../../unfiltered/unfiltered/unfiltered/request/headers.scala.html#17611" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[String]">Authorization</a><span title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">(</span><a href="#74589" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
         <span class="keyword">case</span> Some<a href="#123284" title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">(</a><a href="#123285" title="String" id="74596">a</a><span class="delimiter">)</span> =&gt; <a href="#73851" title="unfiltered.oauth.OAuth.type">OAuth</a>.<a href="#73494" title="(hvals: Seq[String])scala.collection.immutable.Map[String,Seq[String]]">Header</a><a href="#123287" title="(x: scala.collection.immutable.Map[String,Seq[String]])scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">(</a><a href="#74596" title="String">a</a>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.WrappedArray[String]" class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
         <span class="keyword">case</span> _ =&gt; <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><a href="#123287" title="(x: scala.collection.immutable.Map[String,Seq[String]])scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]" id="74591">expected</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Option[String]" id="74640">consumer_key</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="74661">oauth_signature_method</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73412" title="=&gt; String">SignatureMethod</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73412" title="=&gt; String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73412" title="=&gt; String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="74682">timestamp</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="74703">nonce</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="74724">callback</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73418" title="=&gt; String">Callback</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73418" title="=&gt; String">Callback</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73418" title="=&gt; String">Callback</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="74745">signature</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73420" title="=&gt; String">Sig</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73420" title="=&gt; String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73420" title="=&gt; String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="74778">version</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73426" title="=&gt; String">Version</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54976" title="(p: String =&gt; Boolean, err: String =&gt; String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">pred</a> <span class="delimiter">(</span> <a href="#74755" title="String">_</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;1.0&quot;)" class="string">&quot;1.0&quot;</span>, <span title="String(&quot;invalid oauth version &quot;)" class="string">&quot;invalid oauth version &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#74761" title="String">_</a> <span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55528" title="(f: Option[Option[String]] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54964" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#74771" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>,<span title="String">String</span><span class="delimiter">]</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        // TODO how to extract the full url and not rely on underlying
        <a href="#73440" title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse">requestToken</a><a href="#123296" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#74589" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#12733" title="=&gt; String">method</a>, <a href="#74589" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#12727" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>.<span title="()StringBuffer">getRequestURL</span>.<span title="()String">toString</span>, <a href="#74588" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#74590" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Failure<a href="#123292" title="~&gt; extends AnyRef with unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#74205" title="Int" id="74845">status</a>, <a href="responses.scala.html#74207" title="String" id="74846">msg</a><span class="delimiter">)</span> =&gt; <a href="#73453" title="(status: Int, msg: String)unfiltered.response.ResponseFunction[Any]">fail</a><a href="#123296" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#74845" title="Int">status</a>, <a href="#74846" title="String">msg</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="#123292" title="~&gt; extends AnyRef with unfiltered.response.ResponseFunction[Any]">resp</a>: OAuthResponseWriter =&gt; <a href="#123294" title="unfiltered.oauth.OAuthResponseWriter">resp</a> <a href="#123296" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/types.scala.html#9059" title="unfiltered.response.FormEncodedContent.type">FormEncodedContent</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55534" title="(params: unfiltered.request.Params.Map)unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]">expected</a><a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54941" title="(r: unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]])unfiltered.request.QParams.QueryResultX[String,unfiltered.response.ResponseFunction[Any]]" class="delimiter">(</a><a href="#74588" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#74590" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55858" title="(handler: unfiltered.request.QParams.Log[String] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">orFail</a> <span class="delimiter">{</span> <a title="unfiltered.request.QParams.Log[String]" id="74973">errors</a> =&gt;
        <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#8900" title="unfiltered.response.BadRequest.type">BadRequest</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#22177" title="(that: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/writers.scala.html#54423" title="(content: String)unfiltered.response.ResponseString">ResponseString</a><span class="delimiter">(</span><a href="#74973" title="unfiltered.request.QParams.Log[String]">errors</a>.<span title="(f: unfiltered.request.QParams.Fail[String] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[unfiltered.request.QParams.Fail[String]],String,List[String]])List[String]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">{</span> <a href="#74999" title="unfiltered.request.QParams.Fail[String]">_</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55845" title="=&gt; String">error</a> <span class="delimiter">}</span> <span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;. &quot;)" class="string">&quot;. &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">case</span> <a href="../../../filter/unfiltered/filter/request/paths.scala.html#45774" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(String, String)]">ContextPath</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span>_, <a href="#73476" title="=&gt; String">AuthorizationPath</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#57198" title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">&amp;</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#35646" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[scala.collection.immutable.Map[String,Seq[String]]]">Params</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="75099">params</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#57198" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" id="75100">request</a> =&gt;
      <span class="keyword">val</span> <a title="unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]" id="75101">expected</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Option[String]" id="75123">token</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55528" title="(f: Option[String] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <a href="#73441" title="(tokenKey: String, request: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])unfiltered.oauth.OAuthResponse">authorize</a><a href="#123321" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#75123" title="Option[String]">token</a>.<span title="=&gt; String">get</span>, <a href="#75100" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Failure<a href="#123316" title="~&gt; extends AnyRef with unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#74205" title="Int" id="75133">code</a>, <a href="responses.scala.html#74207" title="String" id="75134">msg</a><span class="delimiter">)</span> =&gt; <a href="#73453" title="(status: Int, msg: String)unfiltered.response.ResponseFunction[Any]">fail</a><a href="#123321" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#75133" title="Int">code</a>, <a href="#75134" title="String">msg</a><span class="delimiter">)</span>
          <span class="keyword">case</span> HostResponse<a href="#123316" title="~&gt; extends AnyRef with unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#75145" title="unfiltered.response.ResponseFunction[Nothing]" id="75167">resp</a><span class="delimiter">)</span> =&gt; <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#9251" title="unfiltered.response.Ok.type">Ok</a> <a href="#123321" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <span class="delimiter">(</span><a href="#75167" title="unfiltered.response.ResponseFunction[Nothing]">resp</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="unfiltered.response.ResponseFunction[Any]" class="delimiter">[</span><a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#9439" title="unfiltered.response.ResponseFunction[Any]">ResponseFunction</a><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
          <span class="keyword">case</span> AuthorizeResponse<a href="#123316" title="~&gt; extends AnyRef with unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#75186" title="String" id="75219">callback</a>, <a href="responses.scala.html#75188" title="String" id="75220">token</a>, <a href="responses.scala.html#75190" title="String" id="75221">verifier</a><span class="delimiter">)</span> =&gt; <a href="#123321" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">callback</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#73851" title="unfiltered.oauth.OAuth.type">OAuth</a>.<a href="#73428" title="unfiltered.response.ResponseFunction[Any]">Oob</a> =&gt; <a href="stores.scala.html#73469" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#75223" title="(verifier: String)unfiltered.response.ResponseFunction[Any]">oobResponse</a><a href="#123308" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#75221" title="String">verifier</a><span class="delimiter">)</span>
            <span class="keyword">case</span> _ =&gt; <a href="../../../unfiltered/unfiltered/unfiltered/response/redirect.scala.html#75238" title="(loc: String)unfiltered.response.Redirect">Redirect</a><a href="#123308" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s%soauth_token=%s&amp;oauth_verifier=%s&quot;</span> <span title="(args: Any*)String">format</span><span class="delimiter">(</span>
              <a href="#75219" title="String">callback</a>, <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="#75219" title="String">callback</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;?&quot;)" class="string">&quot;?&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="String(&quot;&amp;&quot;)" class="string">&quot;&amp;&quot;</span> <span class="keyword">else</span> <span title="String(&quot;?&quot;)" class="string">&quot;?&quot;</span>, <a href="#75220" title="String">token</a>, <a href="#75221" title="String">verifier</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55534" title="(params: unfiltered.request.Params.Map)unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]">expected</a><a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54941" title="(r: unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]])unfiltered.request.QParams.QueryResultX[String,unfiltered.response.ResponseFunction[Any]]" class="delimiter">(</a><a href="#75099" title="scala.collection.immutable.Map[String,Seq[String]]">params</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55858" title="(handler: unfiltered.request.QParams.Log[String] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">orFail</a> <span class="delimiter">{</span> <a title="unfiltered.request.QParams.Log[String]" id="75288">errors</a> =&gt;
        <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#8900" title="unfiltered.response.BadRequest.type">BadRequest</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#22177" title="(that: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/writers.scala.html#54423" title="(content: String)unfiltered.response.ResponseString">ResponseString</a><span class="delimiter">(</span><a href="#75288" title="unfiltered.request.QParams.Log[String]">errors</a>.<span title="(f: unfiltered.request.QParams.Fail[String] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[unfiltered.request.QParams.Fail[String]],String,List[String]])List[String]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">{</span> <a href="#75314" title="unfiltered.request.QParams.Fail[String]">_</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55845" title="=&gt; String">error</a> <span class="delimiter">}</span> <span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;. &quot;)" class="string">&quot;. &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">case</span> request @ <a href="../../../unfiltered/unfiltered/unfiltered/request/methods.scala.html#34957" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]]">POST</a><span class="delimiter">(</span><a href="../../../filter/unfiltered/filter/request/paths.scala.html#45774" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(String, String)]">ContextPath</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span>_, <a href="#73477" title="=&gt; String">AccessTokenPath</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#57198" title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">&amp;</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#35646" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[scala.collection.immutable.Map[String,Seq[String]]]">Params</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="75395">params</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
      <span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,Seq[String]]" id="75396">headers</a> = <a href="../../../unfiltered/unfiltered/unfiltered/request/headers.scala.html#17611" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[String]">Authorization</a><span title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">(</span><a href="#123346" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
         <span class="keyword">case</span> Some<a href="#123327" title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">(</a><a href="#123328" title="String" id="75402">a</a><span class="delimiter">)</span> =&gt; <a href="#73851" title="unfiltered.oauth.OAuth.type">OAuth</a>.<a href="#73494" title="(hvals: Seq[String])scala.collection.immutable.Map[String,Seq[String]]">Header</a><a href="#123330" title="(x: scala.collection.immutable.Map[String,Seq[String]])scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">(</a><a href="#75402" title="String">a</a>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.WrappedArray[String]" class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
         <span class="keyword">case</span> _ =&gt; <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><a href="#123330" title="(x: scala.collection.immutable.Map[String,Seq[String]])scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]" id="75397">expected</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Option[String]" id="75445">consumer_key</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="75466">oauth_signature_method</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73412" title="=&gt; String">SignatureMethod</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73412" title="=&gt; String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73412" title="=&gt; String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="75487">timestamp</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="75508">nonce</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="75529">token</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="75550">verifier</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73424" title="=&gt; String">Verifier</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73424" title="=&gt; String">Verifier</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73424" title="=&gt; String">Verifier</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="75571">signature</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73420" title="=&gt; String">Sig</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55003" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#73470" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#73420" title="=&gt; String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#73471" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#73420" title="=&gt; String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="75604">version</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#73426" title="=&gt; String">Version</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54976" title="(p: String =&gt; Boolean, err: String =&gt; String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">pred</a> <span class="delimiter">(</span> <a href="#75581" title="String">_</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;1.0&quot;)" class="string">&quot;1.0&quot;</span>, <span title="String(&quot;invalid oauth version &quot;)" class="string">&quot;invalid oauth version &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#75587" title="String">_</a> <span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55528" title="(f: Option[Option[String]] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54964" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#75597" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>,<span title="String">String</span><span class="delimiter">]</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <a href="#73444" title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse">accessToken</a><a href="#123341" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#123346" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#12733" title="=&gt; String">method</a>, <a href="#123346" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#12727" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>.<span title="()StringBuffer">getRequestURL</span>.<span title="()String">toString</span>, <a href="#75395" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#75396" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Failure<a href="#123335" title="~&gt; extends AnyRef with unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#74205" title="Int" id="75671">code</a>, <a href="responses.scala.html#74207" title="String" id="75672">msg</a><span class="delimiter">)</span> =&gt; <a href="#73453" title="(status: Int, msg: String)unfiltered.response.ResponseFunction[Any]">fail</a><a href="#123341" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#75671" title="Int">code</a>, <a href="#75672" title="String">msg</a><span class="delimiter">)</span>
          <span class="keyword">case</span> resp@AccessResponse<a href="#123335" title="~&gt; extends AnyRef with unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>_, _<span class="delimiter">)</span> =&gt;
            <a href="#123339" title="unfiltered.oauth.AccessResponse">resp</a> <a href="#123341" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/types.scala.html#9059" title="unfiltered.response.FormEncodedContent.type">FormEncodedContent</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55534" title="(params: unfiltered.request.Params.Map)unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]">expected</a><a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54941" title="(r: unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]])unfiltered.request.QParams.QueryResultX[String,unfiltered.response.ResponseFunction[Any]]" class="delimiter">(</a><a href="#75395" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#75396" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55858" title="(handler: unfiltered.request.QParams.Log[String] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">orFail</a> <span class="delimiter">{</span> <a title="unfiltered.request.QParams.Log[String]" id="75807">fails</a> =&gt;
        <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#8900" title="unfiltered.response.BadRequest.type">BadRequest</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#22177" title="(that: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/writers.scala.html#54423" title="(content: String)unfiltered.response.ResponseString">ResponseString</a><span class="delimiter">(</span><a href="#75807" title="unfiltered.request.QParams.Log[String]">fails</a>.<span title="(f: unfiltered.request.QParams.Fail[String] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[unfiltered.request.QParams.Fail[String]],String,List[String]])List[String]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">{</span> <a href="#75833" title="unfiltered.request.QParams.Fail[String]">_</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55845" title="=&gt; String">error</a> <span class="delimiter">}</span> <span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;. &quot;)" class="string">&quot;. &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(status: Int, msg: String)unfiltered.response.ResponseFunction[Any]" id="73453">fail</a><span class="delimiter">(</span><a title="Int" id="74847">status</a>: <span title="Int">Int</span>, <a title="String" id="74848">msg</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#74853" title="(code: Int)unfiltered.response.Status">Status</a><span class="delimiter">(</span><a href="#74847" title="Int">status</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#22177" title="(that: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/writers.scala.html#54423" title="(content: String)unfiltered.response.ResponseString">ResponseString</a><span class="delimiter">(</span><a href="#74848" title="String">msg</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

/** Configured OAuthed class that satisfies requirements for OAuthStores */
<span class="keyword">case class</span> <a title="(stores: unfiltered.oauth.OAuthStores)unfiltered.oauth.OAuth" id="76106">OAuth</a><a href="#76106" title="Product" class="delimiter">(</a><a title="unfiltered.oauth.OAuthStores" id="76091">stores</a>: <a href="stores.scala.html#11356" title="unfiltered.oauth.OAuthStores">OAuthStores</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11320" title="unfiltered.oauth.OAuthed">OAuthed</a>
     <span class="keyword">with</span> <a href="stores.scala.html#11356" title="unfiltered.oauth.OAuthStores">OAuthStores</a> <span class="keyword">with</span> <a href="#11176" title="unfiltered.oauth.DefaultMessages">DefaultMessages</a> <span class="keyword">with</span> <a href="#11179" title="unfiltered.oauth.DefaultOAuthPaths">DefaultOAuthPaths</a> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="unfiltered.oauth.NonceStore" id="73458">nonces</a> = <a href="#76091" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#73466" title="=&gt; unfiltered.oauth.NonceStore">nonces</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.TokenStore" id="73460">tokens</a> = <a href="#76091" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.ConsumerStore" id="73462">consumers</a> = <a href="#76091" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#73468" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.UserHost" id="73464">users</a> = <a href="#76091" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#73469" title="=&gt; unfiltered.oauth.UserHost">users</a>
<span class="delimiter">}</span>

<span class="keyword">case class</span> <a title="class Protection extends AnyRef with unfiltered.oauth.Protected with unfiltered.oauth.OAuthStores with unfiltered.oauth.DefaultMessages with Product with Serializable" id="77134">Protection</a><a href="#77134" title="Product" class="delimiter">(</a><a title="unfiltered.oauth.OAuthStores" id="77115">stores</a>: <a href="stores.scala.html#11356" title="unfiltered.oauth.OAuthStores">OAuthStores</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11404" title="unfiltered.oauth.Protected">Protected</a>
    <span class="keyword">with</span> <a href="stores.scala.html#11356" title="unfiltered.oauth.OAuthStores">OAuthStores</a> <span class="keyword">with</span> <a href="#11176" title="unfiltered.oauth.DefaultMessages">DefaultMessages</a> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="unfiltered.oauth.NonceStore" id="76119">nonces</a> = <a href="#77115" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#73466" title="=&gt; unfiltered.oauth.NonceStore">nonces</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.TokenStore" id="76121">tokens</a> = <a href="#77115" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.ConsumerStore" id="76123">consumers</a> = <a href="#77115" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#73468" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.UserHost" id="76125">users</a> = <a href="#77115" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#73469" title="=&gt; unfiltered.oauth.UserHost">users</a>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait OAuthProvider extends AnyRef" id="11347">OAuthProvider</a> <span title="Unit" class="delimiter">{</span> self: OAuthStores =&gt;
  <span class="keyword">import</span> <a href="#73851" title="unfiltered.oauth.OAuth.type">OAuth</a>._

  <span class="keyword">def</span> <a title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse" id="73439">protect</a><span class="delimiter">(</span><a title="String" id="74132">method</a>: <span title="String">String</span>, <a title="String" id="74133">url</a>: <span title="String">String</span>, <a title="Map[String,Seq[String]]" id="74134">p</a>: <span title="Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="responses.scala.html#11350" title="unfiltered.oauth.OAuthResponse">OAuthResponse</a> =
    <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="#73446" title="(consumer: String, timestamp: String, nonce: String)Boolean">nonceValid</a><span class="delimiter">(</span><a href="#74134" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#74134" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#74134" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="unfiltered.oauth.Consumer" id="76267">consumer</a> &lt;- <a href="stores.scala.html#73468" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>.<a href="consumers.scala.html#73376" title="(key: String)Option[unfiltered.oauth.Consumer]">get</a><span title="(f: unfiltered.oauth.Consumer =&gt; unfiltered.oauth.OAuthResponse)Option[unfiltered.oauth.OAuthResponse]" class="delimiter">(</span><a href="#74134" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76086" title="(tokenId: String)Option[unfiltered.oauth.Token]">get</a><span title="unfiltered.oauth.OAuthResponse" class="delimiter">(</span><a href="#74134" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#123544" title="unfiltered.oauth.OAuthResponse" class="delimiter">(</a>AccessToken<a href="#123546" title="=&gt; unfiltered.oauth.Token" class="delimiter">(</a>tokenKey, <a href="tokens.scala.html#76306" title="String" id="76344">tokenSecret</a>, <a href="tokens.scala.html#76308" title="String" id="76345">user</a>, <a href="tokens.scala.html#76310" title="String" id="76346">consumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#123549" title="(x: unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse" class="keyword">if</a><span class="delimiter">(</span><a href="#76346" title="String">consumerKey</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#76267" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#73373" title="=&gt; String">key</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="signatures.scala.html#11456" title="unfiltered.oauth.Signatures.type">Signatures</a>.<a href="signatures.scala.html#76364" title="(method: String, url: String, p: unfiltered.oauth.Signatures.Params, consumerSec: String, tokenSec: String)Boolean">verify</a><span class="delimiter">(</span><a href="#74132" title="String">method</a>, <a href="#74133" title="String">url</a>, <a href="#74134" title="Map[String,Seq[String]]">p</a>, <a href="#76267" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#73374" title="=&gt; String">secret</a>, <a href="#76344" title="String">tokenSecret</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="responses.scala.html#74250" title="(user: String)unfiltered.oauth.Authorized">Authorized</a><span class="delimiter">(</span><a href="#76345" title="String">user</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid signature&quot;)" class="string">&quot;invalid signature&quot;</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid token&quot;)" class="string">&quot;invalid token&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt; <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><a href="#123549" title="(x: unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse" class="delimiter">(</a><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid token&quot;)" class="string">&quot;invalid token&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span> <span title="(default: =&gt; unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse">getOrElse</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid consumer&quot;)" class="string">&quot;invalid consumer&quot;</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid nonce&quot;)" class="string">&quot;invalid nonce&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse" id="73440">requestToken</a><span class="delimiter">(</span><a title="String" id="74779">method</a>: <span title="String">String</span>, <a title="String" id="74780">url</a>: <span title="String">String</span>, <a title="Map[String,Seq[String]]" id="74781">p</a>: <span title="Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="responses.scala.html#11350" title="unfiltered.oauth.OAuthResponse">OAuthResponse</a> =
    <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="#73446" title="(consumer: String, timestamp: String, nonce: String)Boolean">nonceValid</a><span class="delimiter">(</span><a href="#74781" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#74781" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#74781" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="unfiltered.oauth.Consumer" id="76625">consumer</a> &lt;- <a href="stores.scala.html#73468" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>.<a href="consumers.scala.html#73376" title="(key: String)Option[unfiltered.oauth.Consumer]">get</a><span title="(f: unfiltered.oauth.Consumer =&gt; unfiltered.oauth.OAuthResponse)Option[unfiltered.oauth.OAuthResponse]" class="delimiter">(</span><a href="#74781" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="signatures.scala.html#11456" title="unfiltered.oauth.Signatures.type">Signatures</a>.<a href="signatures.scala.html#76364" title="(method: String, url: String, p: unfiltered.oauth.Signatures.Params, consumerSec: String, tokenSec: String)Boolean">verify</a><span class="delimiter">(</span><a href="#74779" title="String">method</a>, <a href="#74780" title="String">url</a>, <a href="#74781" title="Map[String,Seq[String]]">p</a>, <a href="#76625" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#73374" title="=&gt; String">secret</a>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
         <span class="keyword">val</span> <a href="#123556" title="(x: (String, String))(String, String)" class="delimiter">(</a><a href="#123554" title="String" id="76627">key</a>, <a href="#123554" title="String" id="76628">secret</a><span class="delimiter">)</span> = <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76083" title="=&gt; (String, String)">generate</a>
         <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76085" title="(token: unfiltered.oauth.Token)unfiltered.oauth.Token">put</a><span class="delimiter">(</span><a href="tokens.scala.html#76643" title="(key: String, secret: String, consumerKey: String, callback: String)unfiltered.oauth.RequestToken">RequestToken</a><span class="delimiter">(</span><a href="#76627" title="String">key</a>, <a href="#76628" title="String">secret</a>, <a href="#76625" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#73373" title="=&gt; String">key</a>, <a href="#74781" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73418" title="=&gt; String">Callback</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
         <a href="responses.scala.html#76696" title="(oauth_token: String, oauth_token_secret: String, oauth_callback_confirmed: Boolean)unfiltered.oauth.TokenResponse">TokenResponse</a><span class="delimiter">(</span><a href="#76627" title="String">key</a>, <a href="#76628" title="String">secret</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid signature&quot;)" class="string">&quot;invalid signature&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span> <span title="(default: =&gt; unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse">getOrElse</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid consumer&quot;)" class="string">&quot;invalid consumer&quot;</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid nonce&quot;)" class="string">&quot;invalid nonce&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[T](tokenKey: String, request: unfiltered.request.HttpRequest[T])unfiltered.oauth.OAuthResponse" id="73441">authorize</a><span class="delimiter">[</span><a title="" id="73443">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="75124">tokenKey</a>: <span title="String">String</span>, <a title="unfiltered.request.HttpRequest[T]" id="75125">request</a>: <a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#7615" title="unfiltered.request.HttpRequest[T]">Req</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="responses.scala.html#11350" title="unfiltered.oauth.OAuthResponse">OAuthResponse</a> =
    <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76086" title="(tokenId: String)Option[unfiltered.oauth.Token]">get</a><span title="unfiltered.oauth.OAuthResponse" class="delimiter">(</span><a href="#75124" title="String">tokenKey</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<a href="#123576" title="unfiltered.oauth.OAuthResponse" class="delimiter">(</a>RequestToken<a href="#123578" title="=&gt; unfiltered.oauth.Token" class="delimiter">(</a><a href="tokens.scala.html#76653" title="String" id="76754">key</a>, <a href="tokens.scala.html#76655" title="String" id="76755">secret</a>, <a href="tokens.scala.html#76657" title="String" id="76756">consumerKey</a>, <a href="tokens.scala.html#76659" title="String" id="76757">callback</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <a href="stores.scala.html#73468" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>.<a href="consumers.scala.html#73376" title="(key: String)Option[unfiltered.oauth.Consumer]">get</a><a href="#123581" title="(x: unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse" class="delimiter">(</a><a href="#76756" title="String">consumerKey</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Some<a href="#123568" title="unfiltered.oauth.OAuthResponse" class="delimiter">(</a><a href="#123569" title="unfiltered.oauth.Consumer" id="76759">consumer</a><span class="delimiter">)</span> =&gt;
            <a href="stores.scala.html#73469" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#75226" title="(r: unfiltered.request.HttpRequest[T])Option[unfiltered.oauth.UserLike]">current</a><a href="#123571" title="(x: unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse" class="delimiter">(</a><a href="#75125" title="unfiltered.request.HttpRequest[T]">request</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#123560" title="unfiltered.oauth.OAuthResponse" class="delimiter">(</a><a href="#123561" title="unfiltered.oauth.UserLike" id="76767">user</a><span class="delimiter">)</span> =&gt;
                <a href="#123563" title="(x: unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse" class="keyword">if</a><span class="delimiter">(</span><a href="stores.scala.html#73469" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#75229" title="(token: String, r: unfiltered.request.HttpRequest[T])Boolean">accepted</a><span class="delimiter">(</span><a href="#75124" title="String">tokenKey</a>, <a href="#75125" title="unfiltered.request.HttpRequest[T]">request</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <span class="keyword">val</span> <a title="String" id="76778">verifier</a> = <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76084" title="=&gt; String">generateVerifier</a>
                  <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76085" title="(token: unfiltered.oauth.Token)unfiltered.oauth.Token">put</a><span class="delimiter">(</span><a href="tokens.scala.html#76788" title="(key: String, secret: String, consumerKey: String, user: String, verifier: String)unfiltered.oauth.AuthorizedRequestToken">AuthorizedRequestToken</a><span class="delimiter">(</span><a href="#76754" title="String">key</a>, <a href="#76755" title="String">secret</a>, <a href="#76756" title="String">consumerKey</a>, <a href="#76767" title="unfiltered.oauth.UserLike">user</a>.<a href="users.scala.html#76838" title="=&gt; String">id</a>, <a href="#76778" title="String">verifier</a><span class="delimiter">)</span><span class="delimiter">)</span>
                  <a href="responses.scala.html#75180" title="(oauth_callback: String, oauth_token: String, oauth_verifier: String)unfiltered.oauth.AuthorizeResponse">AuthorizeResponse</a><span class="delimiter">(</span><a href="#76757" title="String">callback</a>, <a href="#76754" title="String">key</a>, <a href="#76778" title="String">verifier</a><span class="delimiter">)</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <span title="unfiltered.oauth.HostResponse[Any]" class="keyword">if</span><span class="delimiter">(</span><a href="stores.scala.html#73469" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#75232" title="(token: String, r: unfiltered.request.HttpRequest[T])Boolean">denied</a><span class="delimiter">(</span><a href="#75124" title="String">tokenKey</a>, <a href="#75125" title="unfiltered.request.HttpRequest[T]">request</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76087" title="(tokenId: String)Unit">delete</a><span class="delimiter">(</span><a href="#75124" title="String">tokenKey</a><span class="delimiter">)</span>
                  <a href="responses.scala.html#75137" title="(p: unfiltered.response.ResponseFunction[Any])unfiltered.oauth.HostResponse[Any]">HostResponse</a><span class="delimiter">(</span><a href="stores.scala.html#73469" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#75224" title="(consumer: unfiltered.oauth.Consumer)unfiltered.response.ResponseFunction[Any]">deniedConfirmation</a><span class="delimiter">(</span><a href="#76759" title="unfiltered.oauth.Consumer">consumer</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <a href="responses.scala.html#75137" title="(p: unfiltered.response.ResponseFunction[Any])unfiltered.oauth.HostResponse[Any]">HostResponse</a><span class="delimiter">(</span><a href="stores.scala.html#73469" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#75225" title="(token: String, consumer: unfiltered.oauth.Consumer)unfiltered.response.ResponseFunction[Any]">requestAcceptance</a><span class="delimiter">(</span><a href="#75124" title="String">tokenKey</a>, <a href="#76759" title="unfiltered.oauth.Consumer">consumer</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> _ =&gt;
                // ask user to sign in
                <a href="responses.scala.html#75137" title="(p: unfiltered.response.ResponseFunction[Any])unfiltered.oauth.HostResponse[Any]">HostResponse</a><a href="#123563" title="(x: unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse" class="delimiter">(</a><a href="stores.scala.html#73469" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#75222" title="(token: String)unfiltered.response.ResponseFunction[Any]">login</a><span class="delimiter">(</span><a href="#75124" title="String">tokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="keyword">case</span> _ =&gt; <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><a href="#123571" title="(x: unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse" class="delimiter">(</a><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid consumer&quot;)" class="string">&quot;invalid consumer&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> _ =&gt; <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><a href="#123581" title="(x: unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse" class="delimiter">(</a><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid token&quot;)" class="string">&quot;invalid token&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse" id="73444">accessToken</a><span class="delimiter">(</span><a title="String" id="75605">method</a>: <span title="String">String</span>, <a title="String" id="75606">url</a>: <span title="String">String</span>, <a title="Map[String,Seq[String]]" id="75607">p</a>: <span title="Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="responses.scala.html#11350" title="unfiltered.oauth.OAuthResponse">OAuthResponse</a> =
    <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="#73446" title="(consumer: String, timestamp: String, nonce: String)Boolean">nonceValid</a><span class="delimiter">(</span><a href="#75607" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#75607" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73414" title="=&gt; String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#75607" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73416" title="=&gt; String">Nonce</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="unfiltered.oauth.Consumer" id="76970">consumer</a> &lt;- <a href="stores.scala.html#73468" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>.<a href="consumers.scala.html#73376" title="(key: String)Option[unfiltered.oauth.Consumer]">get</a><span title="(f: unfiltered.oauth.Consumer =&gt; Option[unfiltered.oauth.OAuthResponse])Option[unfiltered.oauth.OAuthResponse]" class="delimiter">(</span><a href="#75607" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73410" title="=&gt; String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a title="unfiltered.oauth.Token" id="76998">token</a> &lt;- <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76086" title="(tokenId: String)Option[unfiltered.oauth.Token]">get</a><span title="(f: unfiltered.oauth.Token =&gt; unfiltered.oauth.OAuthResponse)Option[unfiltered.oauth.OAuthResponse]" class="delimiter">(</span><a href="#75607" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73422" title="=&gt; String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <a href="#76998" title="unfiltered.oauth.Token">token</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> AuthorizedRequestToken<a href="#123592" title="unfiltered.oauth.OAuthResponse" class="delimiter">(</a>key, secret, consumerKey, <a href="tokens.scala.html#76822" title="String" id="77036">user</a>, <a href="tokens.scala.html#76824" title="String" id="77037">verifier</a><span class="delimiter">)</span> =&gt;
          <a href="#123595" title="(x: unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse" class="keyword">if</a><span class="delimiter">(</span><a href="#77037" title="String">verifier</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#75607" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#73424" title="=&gt; String">Verifier</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="signatures.scala.html#11456" title="unfiltered.oauth.Signatures.type">Signatures</a>.<a href="signatures.scala.html#76364" title="(method: String, url: String, p: unfiltered.oauth.Signatures.Params, consumerSec: String, tokenSec: String)Boolean">verify</a><span class="delimiter">(</span><a href="#75605" title="String">method</a>, <a href="#75606" title="String">url</a>, <a href="#75607" title="Map[String,Seq[String]]">p</a>, <a href="#76970" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#73374" title="=&gt; String">secret</a>, <a href="#76998" title="unfiltered.oauth.Token">token</a>.<a href="tokens.scala.html#76299" title="=&gt; String">secret</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a href="#123588" title="(x: (String, String))(String, String)" class="delimiter">(</a><a href="#123586" title="String" id="77066">key</a>, <a href="#123586" title="String" id="77067">secret</a><span class="delimiter">)</span> = <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76083" title="=&gt; (String, String)">generate</a>
              <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76087" title="(tokenId: String)Unit">delete</a><span class="delimiter">(</span><a href="#76998" title="unfiltered.oauth.Token">token</a>.<a href="tokens.scala.html#76298" title="=&gt; String">key</a><span class="delimiter">)</span>
              <a href="stores.scala.html#73467" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#76085" title="(token: unfiltered.oauth.Token)unfiltered.oauth.Token">put</a><span class="delimiter">(</span><a href="tokens.scala.html#76295" title="(key: String, secret: String, user: String, consumerKey: String)unfiltered.oauth.AccessToken">AccessToken</a><span class="delimiter">(</span><a href="#77066" title="String">key</a>, <a href="#77067" title="String">secret</a>, <a href="#77036" title="String">user</a>, <a href="#76970" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#73373" title="=&gt; String">key</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="responses.scala.html#75676" title="(oauth_token: String, oauth_token_secret: String)unfiltered.oauth.AccessResponse">AccessResponse</a><span class="delimiter">(</span><a href="#77066" title="String">key</a>, <a href="#77067" title="String">secret</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid signature&quot;)" class="string">&quot;invalid signature&quot;</span><span class="delimiter">)</span>
          <span class="keyword">else</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid verifier&quot;)" class="string">&quot;invalid verifier&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt; <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><a href="#123595" title="(x: unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse" class="delimiter">(</a><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid token&quot;)" class="string">&quot;invalid token&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span> <span title="(default: =&gt; unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse">getOrElse</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid consumer or token&quot;)" class="string">&quot;invalid consumer or token&quot;</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#73445" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="String(&quot;invalid nonce&quot;)" class="string">&quot;invalid nonce&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse" id="73445">challenge</a><span class="delimiter">(</span><a title="Int" id="76521">status</a>: <span title="Int">Int</span>, <a title="String" id="76522">msg</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="responses.scala.html#11350" title="unfiltered.oauth.OAuthResponse">OAuthResponse</a> = <a href="responses.scala.html#74200" title="(status: Int, msg: String)unfiltered.oauth.Failure">Failure</a><span class="delimiter">(</span><a href="#76521" title="Int">status</a>, <a href="#76522" title="String">msg</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(consumer: String, timestamp: String, nonce: String)Boolean" id="73446">nonceValid</a><span class="delimiter">(</span><a title="String" id="76159">consumer</a>: <span title="String">String</span>, <a title="String" id="76160">timestamp</a>: <span title="String">String</span>, <a title="String" id="76161">nonce</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="stores.scala.html#73466" title="=&gt; unfiltered.oauth.NonceStore">nonces</a>.<a href="nonces.scala.html#73401" title="(consumer: String, timestamp: String, nonce: String)Boolean">put</a><span class="delimiter">(</span><a href="#76159" title="String">consumer</a>, <a href="#76160" title="String">timestamp</a>, <a href="#76161" title="String">nonce</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
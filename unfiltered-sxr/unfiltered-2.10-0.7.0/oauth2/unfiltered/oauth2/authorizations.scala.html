<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>oauth2/unfiltered/oauth2/authorizations.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> unfiltered.oauth2

<span class="keyword">import</span> unfiltered._
<span class="keyword">import</span> unfiltered.request._
<span class="keyword">import</span> unfiltered.response._
<span class="keyword">import</span> unfiltered.request.<span class="delimiter">{</span> HttpRequest =&gt; Req <span class="delimiter">}</span>
<span class="keyword">import</span> unfiltered.filter.request.ContextPath // work on removing this dep

<span class="keyword">object</span> <a title="unfiltered.oauth2.OAuthorization.type" id="85752">OAuthorization</a> <a href="#11920" title="unfiltered.oauth2.OAuthorization.type" class="delimiter">{</a>

  <span class="keyword">val</span> <a title="String" id="81279">RedirectURI</a> = <span title="String(&quot;redirect_uri&quot;)" class="string">&quot;redirect_uri&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81281">ClientId</a> = <span title="String(&quot;client_id&quot;)" class="string">&quot;client_id&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81283">ClientSecret</a> = <span title="String(&quot;client_secret&quot;)" class="string">&quot;client_secret&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81285">Scope</a> = <span title="String(&quot;scope&quot;)" class="string">&quot;scope&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81287">State</a> = <span title="String(&quot;state&quot;)" class="string">&quot;state&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81289">GrantType</a> = <span title="String(&quot;grant_type&quot;)" class="string">&quot;grant_type&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81291">AuthorizationCode</a> = <span title="String(&quot;authorization_code&quot;)" class="string">&quot;authorization_code&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81293">PasswordType</a> = <span title="String(&quot;password&quot;)" class="string">&quot;password&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81295">Password</a> = <span title="String(&quot;password&quot;)" class="string">&quot;password&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81297">Username</a> = <span title="String(&quot;username&quot;)" class="string">&quot;username&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81299">ClientCredentials</a> = <span title="String(&quot;client_credentials&quot;)" class="string">&quot;client_credentials&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81301">OwnerCredentials</a> = <span title="String(&quot;password&quot;)" class="string">&quot;password&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81303">RefreshToken</a> = <span title="String(&quot;refresh_token&quot;)" class="string">&quot;refresh_token&quot;</span>

  <span class="keyword">val</span> <a title="String" id="81305">ResponseType</a> = <span title="String(&quot;response_type&quot;)" class="string">&quot;response_type&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81307">Code</a> = <span title="String(&quot;code&quot;)" class="string">&quot;code&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81309">TokenKey</a> = <span title="String(&quot;token&quot;)" class="string">&quot;token&quot;</span>

  // errors

  /**
   * @see [[http://tools.ietf.org/html/draft-ietf-oauth-v2-20#section-4.1.2.1]]
   * @see [[http://tools.ietf.org/html/draft-ietf-oauth-v2-20#section-4.2.2.1]]
   */
  <span class="keyword">val</span> <a title="String" id="81311">Error</a> = <span title="String(&quot;error&quot;)" class="string">&quot;error&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81313">InvalidClient</a> = <span title="String(&quot;invalid_client&quot;)" class="string">&quot;invalid_client&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81315">InvalidRequest</a> = <span title="String(&quot;invalid_request&quot;)" class="string">&quot;invalid_request&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81317">UnauthorizedClient</a> = <span title="String(&quot;unauthorized_client&quot;)" class="string">&quot;unauthorized_client&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81319">AccessDenied</a> = <span title="String(&quot;access_denied&quot;)" class="string">&quot;access_denied&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81321">UnsupportedResponseType</a> = <span title="String(&quot;unsupported_response_type&quot;)" class="string">&quot;unsupported_response_type&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81323">UnsupportedGrantType</a> = <span title="String(&quot;unsupported_grant_type&quot;)" class="string">&quot;unsupported_grant_type&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81325">InvalidScope</a> = <span title="String(&quot;invalid_scope&quot;)" class="string">&quot;invalid_scope&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81327">ErrorDescription</a> = <span title="String(&quot;error_description&quot;)" class="string">&quot;error_description&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81329">ErrorURI</a> = <span title="String(&quot;error_uri&quot;)" class="string">&quot;error_uri&quot;</span>

  <span class="keyword">val</span> <a title="String" id="81331">AccessTokenKey</a> = <span title="String(&quot;access_token&quot;)" class="string">&quot;access_token&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81333">TokenType</a> = <span title="String(&quot;token_type&quot;)" class="string">&quot;token_type&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81335">ExpiresIn</a> = <span title="String(&quot;expires_in&quot;)" class="string">&quot;expires_in&quot;</span>
<span class="delimiter">}</span>

/** Paths for authorization and token access */
<span title="AnyRef" class="keyword">trait</span> <a title="trait AuthorizationEndpoints extends AnyRef" id="11558">AuthorizationEndpoints</a> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="=&gt; String" id="85710">AuthorizePath</a>: <span title="String">String</span>
  <span class="keyword">val</span> <a title="=&gt; String" id="85711">TokenPath</a>: <span title="String">String</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">trait</span> <a title="trait DefaultAuthorizationPaths extends AnyRef with unfiltered.oauth2.AuthorizationEndpoints" id="11822">DefaultAuthorizationPaths</a> <span title="Unit" class="keyword">extends</span> <a href="#11558" title="unfiltered.oauth2.AuthorizationEndpoints">AuthorizationEndpoints</a> <span class="delimiter">{</span>
  /**
   * @see [[http://tools.ietf.org/html/draft-ietf-oauth-v2-20#section-3]]
   */
  <span class="keyword">val</span> <a title="String" id="85713">AuthorizePath</a> = <span title="String(&quot;/authorize&quot;)" class="string">&quot;/authorize&quot;</span>

  /**
   * @see [[http://tools.ietf.org/html/draft-ietf-oauth-v2-20#section-3]]
   * @see [[http://tools.ietf.org/html/draft-ietf-oauth-v2-20#section-3.2]]
   */
  <span class="keyword">val</span> <a title="String" id="85715">TokenPath</a> = <span title="String(&quot;/token&quot;)" class="string">&quot;/token&quot;</span>
<span class="delimiter">}</span>

/** Customized parameter validation message */
<span class="keyword">trait</span> <a title="trait ValidationMessages extends AnyRef" id="12005">ValidationMessages</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(what: String)String" id="85717">requiredMsg</a><span class="delimiter">(</span><a title="String" id="85757">what</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">trait</span> <a title="trait DefaultValidationMessages extends AnyRef with unfiltered.oauth2.ValidationMessages" id="11825">DefaultValidationMessages</a> <span title="Unit" class="keyword">extends</span> <a href="#12005" title="unfiltered.oauth2.ValidationMessages">ValidationMessages</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(what: String)String" id="85719">requiredMsg</a><span class="delimiter">(</span><a title="String" id="85760">what</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s is required&quot;</span> <span title="(args: Any*)String">format</span> <a href="#85760" title="String">what</a>
<span class="delimiter">}</span>

/** Configured Authorization server module */
<span class="keyword">case class</span> <a title="(auth: unfiltered.oauth2.AuthorizationServer)unfiltered.oauth2.OAuthorization" id="85786">OAuthorization</a><a href="#85786" title="Product" class="delimiter">(</a><span class="keyword">val</span> <a title="unfiltered.oauth2.AuthorizationServer" id="85771">auth</a>: <a href="AuthorizationServer.scala.html#11573" title="unfiltered.oauth2.AuthorizationServer">AuthorizationServer</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11762" title="unfiltered.oauth2.Authorized">Authorized</a>
     <span class="keyword">with</span> <a href="#11822" title="unfiltered.oauth2.DefaultAuthorizationPaths">DefaultAuthorizationPaths</a> <span class="keyword">with</span> <a href="#11825" title="unfiltered.oauth2.DefaultValidationMessages">DefaultValidationMessages</a>

<span class="keyword">trait</span> <a title="trait Spaces extends AnyRef" id="11993">Spaces</a> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(raw: String)Seq[String]" id="85796">spaceDecoder</a><span class="delimiter">(</span><a title="String" id="85799">raw</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#85799" title="String">raw</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;\\s+&quot;)" class="string">&quot;&quot;&quot;\s+&quot;&quot;&quot;</span>,<span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span class="delimiter">)</span>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span class="delimiter">)</span>.<span title="=&gt; Seq[String]">toSeq</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(scopes: Seq[String])String" id="85797">spaceEncoder</a><span class="delimiter">(</span><a title="Seq[String]" id="85877">scopes</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#85877" title="Seq[String]">scopes</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;+&quot;)" class="string">&quot;+&quot;</span><span class="delimiter">)</span>

<span class="delimiter">}</span>


/** A composition of components which respond to authorization requests.
 *  This trait provides default implementations of Oauth `Flows`. To override these,
 *  simply override a target Flows callback methods */
<span title="AnyRef" class="keyword">trait</span> <a title="trait Authorized extends AnyRef with unfiltered.oauth2.AuthorizationProvider with unfiltered.oauth2.AuthorizationEndpoints with unfiltered.oauth2.Formatting with unfiltered.oauth2.ValidationMessages with unfiltered.oauth2.Flows with unfiltered.filter.Plan" id="11762">Authorized</a> <span title="Unit" class="keyword">extends</span> <a href="AuthorizationServer.scala.html#11561" title="unfiltered.oauth2.AuthorizationProvider">AuthorizationProvider</a>
  <span class="keyword">with</span> <a href="#11558" title="unfiltered.oauth2.AuthorizationEndpoints">AuthorizationEndpoints</a> <span class="keyword">with</span> <a href="responses.scala.html#11843" title="unfiltered.oauth2.Formatting">Formatting</a>
  <span class="keyword">with</span> <a href="#12005" title="unfiltered.oauth2.ValidationMessages">ValidationMessages</a> <span class="keyword">with</span> <a href="flows.scala.html#11834" title="unfiltered.oauth2.Flows">Flows</a>
  <span class="keyword">with</span> unfiltered.filter.<a href="../../../filter/unfiltered/filter/plans.scala.html#8581" title="unfiltered.filter.Plan">Plan</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#7910" title="unfiltered.request.QParams.type">QParams</a>._
  <span class="keyword">import</span> <a href="#85752" title="unfiltered.oauth2.OAuthorization.type">OAuthorization</a>._

  /** Syntactic sugar for appending query strings to paths */
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit unfiltered.oauth2.Authorized.s2qs : (uri: String)AnyRef{def ?(qs: String): String}" id="85693">s2qs</a><span class="delimiter">(</span><a title="String" id="85882">uri</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#85885" title="AnyRef{def ?(qs: String): String}" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef" id="85885" class="delimiter">{</a>
     <span class="keyword">def</span> <a title="(qs: String)String" id="85887">?</a><span class="delimiter">(</span><a title="String" id="85888">qs</a>: <span title="String">String</span><span class="delimiter">)</span> =
       <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s%s%s&quot;</span> <span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#85882" title="String">uri</a>, <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="#85882" title="String">uri</a>.<span title="(x$1: String)Int">indexOf</span><span class="delimiter">(</span><span title="String(&quot;?&quot;)" class="string">&quot;?&quot;</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="String(&quot;&amp;&quot;)" class="string">&quot;&amp;&quot;</span> <span class="keyword">else</span> <span title="String(&quot;?&quot;)" class="string">&quot;?&quot;</span>, <a href="#85888" title="String">qs</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** @return a function which builds a
   *  response for an accept token request */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(accessToken: String, tokenType: Option[String], expiresIn: Option[Int], refreshToken: Option[String], scope: Seq[String], extras: Iterable[(String, String)])unfiltered.response.ResponseFunction[Any]" id="85694">accessResponder</a><span class="delimiter">(</span>
    <a title="String" id="85914">accessToken</a>: <span title="String">String</span>,
    <a title="Option[String]" id="85915">tokenType</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span>,
    <a title="Option[Int]" id="85916">expiresIn</a>: <span title="Option[Int]">Option</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>,
    <a title="Option[String]" id="85917">refreshToken</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span>,
    <a title="Seq[String]" id="85918">scope</a>:<span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span>,
    <a title="Iterable[(String, String)]" id="85919">extras</a>: <span title="Iterable[(String, String)]">Iterable</span><span class="delimiter">[</span><span class="delimiter">(</span>String, String<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span> =
      <a href="../../../unfiltered/unfiltered/unfiltered/response/headers.scala.html#54841" title="(value: String*)unfiltered.response.ResponseHeader">CacheControl</a><span class="delimiter">(</span><span title="String(&quot;no-store&quot;)" class="string">&quot;no-store&quot;</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#22177" title="(that: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/headers.scala.html#54841" title="(value: String*)unfiltered.response.ResponseHeader">Pragma</a><span class="delimiter">(</span><span title="String(&quot;no-cache&quot;)" class="string">&quot;no-cache&quot;</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#22177" title="(that: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a>
        <a href="responses.scala.html#85724" title="(kvs: Iterable[(String, String)])unfiltered.response.ResponseFunction[Any]">Json</a><span class="delimiter">(</span><span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><span class="delimiter">(</span><a href="#81331" title="(x: String)ArrowAssoc[String]">AccessTokenKey</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#85914" title="String">accessToken</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
          <a href="#85915" title="Option[String]">tokenType</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81333" title="(x: String)ArrowAssoc[String]">TokenType</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#86071" title="String">_</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
          <a href="#85916" title="Option[Int]">expiresIn</a>.<span title="(f: Int =&gt; (String, String))Option[(String, String)]">map</span> <span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81335" title="(x: String)ArrowAssoc[String]">ExpiresIn</a> <span title="(y: String)(String, String)">-&gt;</span> <span class="delimiter">(</span><a href="#86193" title="Int">_</a>:<span title="Int">Int</span><span class="delimiter">)</span>.<span title="()String">toString</span><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
             <a href="#85917" title="Option[String]">refreshToken</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span> <span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81303" title="(x: String)ArrowAssoc[String]">RefreshToken</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#86315" title="String">_</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
             <span class="delimiter">(</span><a href="#85918" title="Seq[String]">scope</a> <span class="keyword">match</span> <span class="delimiter">{</span>
               <span class="keyword">case</span> <a href="#123965" title="(x: Seq[String])Some[Seq[String]]">Seq</a><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#123969" title="(x: Option[String])Option[String]">None</a>
               <span class="keyword">case</span> xs =&gt; <span title="(x: String)Some[String]">Some</span><a href="#123969" title="(x: Option[String])Option[String]" class="delimiter">(</a><a href="#85697" title="(scopes: Seq[String])String">spaceEncoder</a><span class="delimiter">(</span><a href="#123965" title="Seq[String]">xs</a><span class="delimiter">)</span><span class="delimiter">)</span>
             <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span> <span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81285" title="(x: String)ArrowAssoc[String]">Scope</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#86465" title="String">_</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span> <a href="#85919" title="Iterable[(String, String)]">extras</a><span class="delimiter">)</span>

  /** @return a function which builds a
   *  response for error responses */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]" id="85695">errorResponder</a><span class="delimiter">(</span>
    <a title="String" id="86616">error</a>: <span title="String">String</span>, <a title="String" id="86617">desc</a>: <span title="String">String</span>,
    <a title="Option[String]" id="86618">euri</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="Option[String]" id="86619">state</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
      <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#8900" title="unfiltered.response.BadRequest.type">BadRequest</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#22177" title="(that: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/headers.scala.html#54841" title="(value: String*)unfiltered.response.ResponseHeader">CacheControl</a><span class="delimiter">(</span><span title="String(&quot;no-store&quot;)" class="string">&quot;no-store&quot;</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#22177" title="(that: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/headers.scala.html#54841" title="(value: String*)unfiltered.response.ResponseHeader">Pragma</a><span class="delimiter">(</span><span title="String(&quot;no-cache&quot;)" class="string">&quot;no-cache&quot;</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#22177" title="(that: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">~&gt;</a>
        <a href="responses.scala.html#85724" title="(kvs: Iterable[(String, String)])unfiltered.response.ResponseFunction[Any]">Json</a><span class="delimiter">(</span><span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><span class="delimiter">(</span><a href="#81311" title="(x: String)ArrowAssoc[String]">Error</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#86616" title="String">error</a>, <a href="#81327" title="(x: String)ArrowAssoc[String]">ErrorDescription</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#86617" title="String">desc</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
          <a href="#86618" title="Option[String]">euri</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span> <span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81329" title="(x: String)ArrowAssoc[String]">ErrorURI</a> <span title="(y: String)(String, String)">-&gt;</span> <span class="delimiter">(</span><a href="#86730" title="String">_</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
          <a href="#86619" title="Option[String]">state</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span> <span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81287" title="(x: String)ArrowAssoc[String]">State</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#86845" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(raw: String)Seq[String]" id="85696">spaceDecoder</a><span class="delimiter">(</span><a title="String" id="86925">raw</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#86925" title="String">raw</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;\\s+&quot;)" class="string">&quot;&quot;&quot;\s+&quot;&quot;&quot;</span>,<span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span class="delimiter">)</span>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="String(&quot; &quot;)" class="string">&quot; &quot;</span><span class="delimiter">)</span>.<span title="=&gt; Seq[String]">toSeq</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(scopes: Seq[String])String" id="85697">spaceEncoder</a><span class="delimiter">(</span><a title="Seq[String]" id="86445">scopes</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#86445" title="Seq[String]">scopes</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;+&quot;)" class="string">&quot;+&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(req: unfiltered.request.HttpRequest[Any], responseType: Seq[String], clientId: String, redirectUri: String, scope: Seq[String], state: Option[String])unfiltered.response.ResponseFunction[Any]" id="85698">onAuthCode</a><span class="delimiter">(</span>
    <a title="unfiltered.request.HttpRequest[Any]" id="87003">req</a>: <a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#7615" title="unfiltered.request.HttpRequest[Any]">HttpRequest</a><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="Seq[String]" id="87004">responseType</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="String" id="87005">clientId</a>: <span title="String">String</span>,
    <a title="String" id="87006">redirectUri</a>: <span title="String">String</span>, <a title="Seq[String]" id="87007">scope</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="Option[String]" id="87008">state</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
      <a href="AuthorizationServer.scala.html#81230" title="(r: unfiltered.oauth2.AuthorizationRequest)unfiltered.oauth2.AuthorizationResponse">auth</a><span title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</span><a href="requests.scala.html#81367" title="(req: unfiltered.request.HttpRequest[Any], responseTypes: Seq[String], clientId: String, redirectURI: String, scope: Seq[String], state: Option[String])unfiltered.oauth2.AuthorizationCodeRequest[Any]">AuthorizationCodeRequest</a><span class="delimiter">(</span>
        <a href="#87003" title="unfiltered.request.HttpRequest[Any]">req</a>, <a href="#87004" title="Seq[String]">responseType</a>, <a href="#87005" title="String">clientId</a>, <a href="#87006" title="String">redirectUri</a>, <a href="#87007" title="Seq[String]">scope</a>, <a href="#87008" title="Option[String]">state</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>

          <span class="keyword">case</span> ServiceResponse<a href="#123978" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81456" title="unfiltered.response.ResponseFunction[Any]" id="87065">resp</a><span class="delimiter">)</span> =&gt; <a href="#123983" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">resp</a>

          <span class="keyword">case</span> AuthorizationCodeResponse<a href="#123978" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81561" title="String" id="87088">code</a>, <a href="responses.scala.html#81563" title="Option[String]" id="87089">state</a><span class="delimiter">)</span> =&gt;
            <a href="../../../unfiltered/unfiltered/unfiltered/response/redirect.scala.html#75238" title="(loc: String)unfiltered.response.Redirect">Redirect</a><a href="#123983" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#85693" title="implicit unfiltered.oauth2.Authorized.s2qs : (uri: String)AnyRef{def ?(qs: String): String}">redirectUri</a> <a href="#85912" title="(qs: String)String">?</a> <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;code=%s%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span>
              <a href="#87088" title="String">code</a>, <a href="#87089" title="Option[String]">state</a>.<span title="(f: String =&gt; String)Option[String]">map</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&amp;state=%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#87101" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">)</span>

          <span class="keyword">case</span> ErrorResponse<a href="#123978" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81504" title="String" id="87143">error</a>, <a href="responses.scala.html#81506" title="String" id="87144">desc</a>, <a href="responses.scala.html#81508" title="Option[String]" id="87145">euri</a>, <a href="responses.scala.html#81510" title="Option[String]" id="87146">state</a><span class="delimiter">)</span> =&gt;
            <a href="../../../unfiltered/unfiltered/unfiltered/response/redirect.scala.html#75238" title="(loc: String)unfiltered.response.Redirect">Redirect</a><a href="#123983" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#85693" title="implicit unfiltered.oauth2.Authorized.s2qs : (uri: String)AnyRef{def ?(qs: String): String}">redirectUri</a> <a href="#85912" title="(qs: String)String">?</a> <a href="responses.scala.html#85723" title="(kvs: Iterable[(String, String)])String">qstr</a><span class="delimiter">(</span>
              <span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><span class="delimiter">(</span><a href="#81311" title="(x: String)ArrowAssoc[String]">Error</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#87143" title="String">error</a>, <a href="#81327" title="(x: String)ArrowAssoc[String]">ErrorDescription</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#87144" title="String">desc</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
              <a href="#87145" title="Option[String]">euri</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81329" title="(x: String)ArrowAssoc[String]">ErrorURI</a> <span title="(y: String)(String, String)">-&gt;</span> <span class="delimiter">(</span><a href="#87278" title="String">_</a>:<span title="String">String</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
              <a href="#87146" title="Option[String]">state</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81287" title="(x: String)ArrowAssoc[String]">State</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#87393" title="String">_</a><span class="delimiter">)</span>
            <span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> _ =&gt; <a href="#123983" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">BadRequest</a>
        <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(req: unfiltered.request.HttpRequest[Any], responseType: Seq[String], clientId: String, redirectUri: String, scope: Seq[String], state: Option[String])unfiltered.response.ResponseFunction[Any]" id="85699">onToken</a><span class="delimiter">(</span>
    <a title="unfiltered.request.HttpRequest[Any]" id="87470">req</a>: <a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#7615" title="unfiltered.request.HttpRequest[Any]">HttpRequest</a><span class="delimiter">[</span>Any<span class="delimiter">]</span>, 
    <a title="Seq[String]" id="87471">responseType</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span>,
    <a title="String" id="87472">clientId</a>: <span title="String">String</span>,
    <a title="String" id="87473">redirectUri</a>: <span title="String">String</span>, <a title="Seq[String]" id="87474">scope</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span>,
    <a title="Option[String]" id="87475">state</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="AuthorizationServer.scala.html#81230" title="(r: unfiltered.oauth2.AuthorizationRequest)unfiltered.oauth2.AuthorizationResponse">auth</a><span title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</span><a href="requests.scala.html#81675" title="(req: unfiltered.request.HttpRequest[Any], responseTypes: Seq[String], clientId: String, redirectURI: String, scope: Seq[String], state: Option[String])unfiltered.oauth2.ImplicitAuthorizationRequest[Any]">ImplicitAuthorizationRequest</a><span class="delimiter">(</span>
      <a href="#87470" title="unfiltered.request.HttpRequest[Any]">req</a>, <a href="#87471" title="Seq[String]">responseType</a>, <a href="#87472" title="String">clientId</a>, <a href="#87473" title="String">redirectUri</a>, <a href="#87474" title="Seq[String]">scope</a>, <a href="#87475" title="Option[String]">state</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> ServiceResponse<a href="#124003" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81456" title="unfiltered.response.ResponseFunction[Any]" id="87517">cr</a><span class="delimiter">)</span> =&gt; <a href="#124008" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">cr</a>
        <span class="keyword">case</span> ImplicitAccessTokenResponse<a href="#124003" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
          <a href="responses.scala.html#85171" title="String" id="87556">accessToken</a>, <a href="responses.scala.html#85173" title="Option[String]" id="87557">tokenType</a>, <a href="responses.scala.html#85175" title="Option[Int]" id="87558">expiresIn</a>, <a href="responses.scala.html#85177" title="Seq[String]" id="87559">scope</a>, <a href="responses.scala.html#85179" title="Option[String]" id="87560">state</a>, <a href="responses.scala.html#85181" title="Iterable[(String, String)]" id="87561">extras</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="String" id="87562">fragment</a> = <a href="responses.scala.html#85723" title="(kvs: Iterable[(String, String)])String">qstr</a><span class="delimiter">(</span>
            <span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><span class="delimiter">(</span><a href="#81331" title="(x: String)ArrowAssoc[String]">AccessTokenKey</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#87556" title="String">accessToken</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
              <a href="#87557" title="Option[String]">tokenType</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81333" title="(x: String)ArrowAssoc[String]">TokenType</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#87628" title="String">_</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
              <a href="#87558" title="Option[Int]">expiresIn</a>.<span title="(f: Int =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81335" title="(x: String)ArrowAssoc[String]">ExpiresIn</a> <span title="(y: String)(String, String)">-&gt;</span> <span class="delimiter">(</span><a href="#87743" title="Int">_</a>:<span title="Int">Int</span><span class="delimiter">)</span>.<span title="()String">toString</span><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
              <span class="delimiter">(</span><a href="#87559" title="Seq[String]">scope</a> <span class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <a href="#123990" title="(x: Seq[String])Some[Seq[String]]">Seq</a><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#123994" title="(x: Option[String])Option[String]">None</a>
                <span class="keyword">case</span> xs =&gt; <span title="(x: String)Some[String]">Some</span><a href="#123994" title="(x: Option[String])Option[String]" class="delimiter">(</a><a href="#85697" title="(scopes: Seq[String])String">spaceEncoder</a><span class="delimiter">(</span><a href="#123990" title="Seq[String]">xs</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81285" title="(x: String)ArrowAssoc[String]">Scope</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#87888" title="String">_</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
              <a href="#87560" title="Option[String]">state</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81287" title="(x: String)ArrowAssoc[String]">State</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#88003" title="String">_</a> <span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span> <a href="#87561" title="Iterable[(String, String)]">extras</a>
            <span class="delimiter">)</span>
          <a href="../../../unfiltered/unfiltered/unfiltered/response/redirect.scala.html#75238" title="(loc: String)unfiltered.response.Redirect">Redirect</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s#%s&quot;</span> <span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#87473" title="String">redirectUri</a>, <a href="#87562" title="String">fragment</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> ErrorResponse<a href="#124003" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81504" title="String" id="88149">error</a>, <a href="responses.scala.html#81506" title="String" id="88150">desc</a>, <a href="responses.scala.html#81508" title="Option[String]" id="88151">euri</a>, <a href="responses.scala.html#81510" title="Option[String]" id="88152">state</a><span class="delimiter">)</span> =&gt;
          <a href="../../../unfiltered/unfiltered/unfiltered/response/redirect.scala.html#75238" title="(loc: String)unfiltered.response.Redirect">Redirect</a><a href="#124008" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s#%s&quot;</span> <span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#87473" title="String">redirectUri</a>, <a href="responses.scala.html#85723" title="(kvs: Iterable[(String, String)])String">qstr</a><span class="delimiter">(</span>
            <span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><span class="delimiter">(</span><a href="#81311" title="(x: String)ArrowAssoc[String]">Error</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#88149" title="String">error</a>, <a href="#81327" title="(x: String)ArrowAssoc[String]">ErrorDescription</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#88150" title="String">desc</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
              <a href="#88151" title="Option[String]">euri</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81329" title="(x: String)ArrowAssoc[String]">ErrorURI</a> <span title="(y: String)(String, String)">-&gt;</span> <span class="delimiter">(</span><a href="#88239" title="String">_</a>:<span title="String">String</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
              <a href="#88152" title="Option[String]">state</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81287" title="(x: String)ArrowAssoc[String]">State</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#88354" title="String">_</a><span class="delimiter">)</span>
            <span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt; <a href="#124008" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">BadRequest</a>
      <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(req: unfiltered.request.HttpRequest[Any], responseType: Seq[String], clientId: String, redirectUri: String, scope: Seq[String], state: Option[String])unfiltered.response.ResponseFunction[Any]" id="85700">onUnsupportedAuth</a><span class="delimiter">(</span>
    <a title="unfiltered.request.HttpRequest[Any]" id="88431">req</a>: <a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#7615" title="unfiltered.request.HttpRequest[Any]">HttpRequest</a><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="Seq[String]" id="88432">responseType</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="String" id="88433">clientId</a>: <span title="String">String</span>,
    <a title="String" id="88434">redirectUri</a>: <span title="String">String</span>, <a title="Seq[String]" id="88435">scope</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="Option[String]" id="88436">state</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="AuthorizationServer.scala.html#81230" title="(r: unfiltered.oauth2.AuthorizationRequest)unfiltered.oauth2.AuthorizationResponse">auth</a><span title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</span><a href="requests.scala.html#85241" title="(req: unfiltered.request.HttpRequest[Any], responseTypes: Seq[String], clientId: String, redirectURI: String, scope: Seq[String], state: Option[String])unfiltered.oauth2.IndeterminateAuthorizationRequest[Any]">IndeterminateAuthorizationRequest</a><span class="delimiter">(</span>
      <a href="#88431" title="unfiltered.request.HttpRequest[Any]">req</a>, <a href="#88432" title="Seq[String]">responseType</a>, <a href="#88433" title="String">clientId</a>, <a href="#88434" title="String">redirectUri</a>, <a href="#88435" title="Seq[String]">scope</a>, <a href="#88436" title="Option[String]">state</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> ServiceResponse<a href="#124015" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81456" title="unfiltered.response.ResponseFunction[Any]" id="88472">cr</a><span class="delimiter">)</span> =&gt; <a href="#124019" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">cr</a>
      <span class="keyword">case</span> ErrorResponse<a href="#124015" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81504" title="String" id="88473">error</a>, <a href="responses.scala.html#81506" title="String" id="88474">desc</a>, <a href="responses.scala.html#81508" title="Option[String]" id="88475">euri</a>, <a href="responses.scala.html#81510" title="Option[String]" id="88476">state</a><span class="delimiter">)</span> =&gt;
        <a href="../../../unfiltered/unfiltered/unfiltered/response/redirect.scala.html#75238" title="(loc: String)unfiltered.response.Redirect">Redirect</a><a href="#124019" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#85693" title="implicit unfiltered.oauth2.Authorized.s2qs : (uri: String)AnyRef{def ?(qs: String): String}">redirectUri</a> <a href="#85912" title="(qs: String)String">?</a> <a href="responses.scala.html#85723" title="(kvs: Iterable[(String, String)])String">qstr</a><span class="delimiter">(</span>
          <span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><span class="delimiter">(</span><a href="#81311" title="(x: String)ArrowAssoc[String]">Error</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#88473" title="String">error</a>, <a href="#81327" title="(x: String)ArrowAssoc[String]">ErrorDescription</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#88474" title="String">desc</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
            <a href="#88475" title="Option[String]">euri</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81329" title="(x: String)ArrowAssoc[String]">ErrorURI</a> <span title="(y: String)(String, String)">-&gt;</span> <span class="delimiter">(</span><a href="#88560" title="String">_</a>:<span title="String">String</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, String)])scala.collection.immutable.Map[String,String]">++</span>
            <a href="#88476" title="Option[String]">state</a>.<span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#81287" title="(x: String)ArrowAssoc[String]">State</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#88675" title="String">_</a><span class="delimiter">)</span>
          <span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> _ =&gt; <a href="#124019" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">BadRequest</a>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(clientId: String, clientSecret: String, scope: Seq[String])unfiltered.response.ResponseFunction[Any]" id="85701">onClientCredentials</a><span class="delimiter">(</span><a title="String" id="88752">clientId</a>: <span title="String">String</span>, <a title="String" id="88753">clientSecret</a>: <span title="String">String</span>, <a title="Seq[String]" id="88754">scope</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="AuthorizationServer.scala.html#81231" title="(r: unfiltered.oauth2.AccessRequest)unfiltered.oauth2.AccessResponse">auth</a><a href="#124030" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="requests.scala.html#85560" title="(clientId: String, secret: String, scope: Seq[String])unfiltered.oauth2.ClientCredentialsRequest">ClientCredentialsRequest</a><span class="delimiter">(</span>
      <a href="#88752" title="String">clientId</a>, <a href="#88753" title="String">clientSecret</a>, <a href="#88754" title="Seq[String]">scope</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> AccessTokenResponse<a href="#124025" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
          <a href="responses.scala.html#85461" title="String" id="88819">accessToken</a>, <a href="responses.scala.html#85463" title="Option[String]" id="88820">tokenType</a>, <a href="responses.scala.html#85465" title="Option[Int]" id="88821">expiresIn</a>, <a href="responses.scala.html#85467" title="Option[String]" id="88822">refreshToken</a>, <a href="responses.scala.html#85469" title="Seq[String]" id="88823">scope</a>, _, <a href="responses.scala.html#85473" title="Iterable[(String, String)]" id="88824">extras</a><span class="delimiter">)</span> =&gt;
            <a href="#85694" title="(accessToken: String, tokenType: Option[String], expiresIn: Option[Int], refreshToken: Option[String], scope: Seq[String], extras: Iterable[(String, String)])unfiltered.response.ResponseFunction[Any]">accessResponder</a><a href="#124030" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
              <a href="#88819" title="String">accessToken</a>, <a href="#88820" title="Option[String]">tokenType</a>, <a href="#88821" title="Option[Int]">expiresIn</a>, <a href="#88822" title="Option[String]">refreshToken</a>, <a href="#88823" title="Seq[String]">scope</a>, <a href="#88824" title="Iterable[(String, String)]">extras</a>
            <span class="delimiter">)</span>
        <span class="keyword">case</span> ErrorResponse<a href="#124025" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81504" title="String" id="88825">error</a>, <a href="responses.scala.html#81506" title="String" id="88826">desc</a>, <a href="responses.scala.html#81508" title="Option[String]" id="88827">euri</a>, <a href="responses.scala.html#81510" title="Option[String]" id="88828">state</a><span class="delimiter">)</span> =&gt;
          <a href="#85695" title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">errorResponder</a><a href="#124030" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#88825" title="String">error</a>, <a href="#88826" title="String">desc</a>, <a href="#88827" title="Option[String]">euri</a>, <a href="#88828" title="Option[String]">state</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(userName: String, password: String, clientId: String, clientSecret: String, scope: Seq[String])unfiltered.response.ResponseFunction[Any]" id="85702">onPassword</a><span class="delimiter">(</span>
    <a title="String" id="88829">userName</a>: <span title="String">String</span>, <a title="String" id="88830">password</a>: <span title="String">String</span>,
    <a title="String" id="88831">clientId</a>: <span title="String">String</span>, <a title="String" id="88832">clientSecret</a>: <span title="String">String</span>, <a title="Seq[String]" id="88833">scope</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="AuthorizationServer.scala.html#81231" title="(r: unfiltered.oauth2.AccessRequest)unfiltered.oauth2.AccessResponse">auth</a><a href="#124040" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="requests.scala.html#85612" title="(userName: String, password: String, clientId: String, clientSecret: String, scope: Seq[String])unfiltered.oauth2.PasswordRequest">PasswordRequest</a><span class="delimiter">(</span>
      <a href="#88829" title="String">userName</a>, <a href="#88830" title="String">password</a>, <a href="#88831" title="String">clientId</a>, <a href="#88832" title="String">clientSecret</a>, <a href="#88833" title="Seq[String]">scope</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> AccessTokenResponse<a href="#124035" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
          <a href="responses.scala.html#85461" title="String" id="88864">accessToken</a>, <a href="responses.scala.html#85463" title="Option[String]" id="88865">tokenType</a>, <a href="responses.scala.html#85465" title="Option[Int]" id="88866">expiresIn</a>, <a href="responses.scala.html#85467" title="Option[String]" id="88867">refreshToken</a>, <a href="responses.scala.html#85469" title="Seq[String]" id="88868">scope</a>, _, <a href="responses.scala.html#85473" title="Iterable[(String, String)]" id="88869">extras</a><span class="delimiter">)</span> =&gt;
            <a href="#85694" title="(accessToken: String, tokenType: Option[String], expiresIn: Option[Int], refreshToken: Option[String], scope: Seq[String], extras: Iterable[(String, String)])unfiltered.response.ResponseFunction[Any]">accessResponder</a><a href="#124040" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
              <a href="#88864" title="String">accessToken</a>, <a href="#88865" title="Option[String]">tokenType</a>, <a href="#88866" title="Option[Int]">expiresIn</a>, <a href="#88867" title="Option[String]">refreshToken</a>, <a href="#88868" title="Seq[String]">scope</a>, <a href="#88869" title="Iterable[(String, String)]">extras</a>
            <span class="delimiter">)</span>
        <span class="keyword">case</span> ErrorResponse<a href="#124035" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81504" title="String" id="88870">error</a>, <a href="responses.scala.html#81506" title="String" id="88871">desc</a>, <a href="responses.scala.html#81508" title="Option[String]" id="88872">euri</a>, <a href="responses.scala.html#81510" title="Option[String]" id="88873">state</a><span class="delimiter">)</span> =&gt;
          <a href="#85695" title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">errorResponder</a><a href="#124040" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#88870" title="String">error</a>, <a href="#88871" title="String">desc</a>, <a href="#88872" title="Option[String]">euri</a>, <a href="#88873" title="Option[String]">state</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(code: String, redirectUri: String, clientId: String, clientSecret: String)unfiltered.response.ResponseFunction[Any]" id="85703">onGrantAuthCode</a><span class="delimiter">(</span><a title="String" id="88874">code</a>: <span title="String">String</span>, <a title="String" id="88875">redirectUri</a>: <span title="String">String</span>, <a title="String" id="88876">clientId</a>: <span title="String">String</span>, <a title="String" id="88877">clientSecret</a>: <span title="String">String</span><span class="delimiter">)</span> =
     <a href="AuthorizationServer.scala.html#81231" title="(r: unfiltered.oauth2.AccessRequest)unfiltered.oauth2.AccessResponse">auth</a><a href="#124050" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="requests.scala.html#85344" title="(code: String, redirectURI: String, clientId: String, clientSecret: String)unfiltered.oauth2.AccessTokenRequest">AccessTokenRequest</a><span class="delimiter">(</span><a href="#88874" title="String">code</a>, <a href="#88875" title="String">redirectUri</a>, <a href="#88876" title="String">clientId</a>, <a href="#88877" title="String">clientSecret</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
       <span class="keyword">case</span> AccessTokenResponse<a href="#124045" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
         <a href="responses.scala.html#85461" title="String" id="88904">accessToken</a>, <a href="responses.scala.html#85463" title="Option[String]" id="88905">tokenType</a>, <a href="responses.scala.html#85465" title="Option[Int]" id="88906">expiresIn</a>, <a href="responses.scala.html#85467" title="Option[String]" id="88907">refreshToken</a>, <a href="responses.scala.html#85469" title="Seq[String]" id="88908">scope</a>, _, <a href="responses.scala.html#85473" title="Iterable[(String, String)]" id="88909">extras</a><span class="delimiter">)</span> =&gt;
           <a href="#85694" title="(accessToken: String, tokenType: Option[String], expiresIn: Option[Int], refreshToken: Option[String], scope: Seq[String], extras: Iterable[(String, String)])unfiltered.response.ResponseFunction[Any]">accessResponder</a><a href="#124050" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
             <a href="#88904" title="String">accessToken</a>, <a href="#88905" title="Option[String]">tokenType</a>, <a href="#88906" title="Option[Int]">expiresIn</a>, <a href="#88907" title="Option[String]">refreshToken</a>, <a href="#88908" title="Seq[String]">scope</a>, <a href="#88909" title="Iterable[(String, String)]">extras</a>
           <span class="delimiter">)</span>
       <span class="keyword">case</span> ErrorResponse<a href="#124045" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81504" title="String" id="88910">error</a>, <a href="responses.scala.html#81506" title="String" id="88911">desc</a>, <a href="responses.scala.html#81508" title="Option[String]" id="88912">euri</a>, <a href="responses.scala.html#81510" title="Option[String]" id="88913">state</a><span class="delimiter">)</span> =&gt;
         <a href="#85695" title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">errorResponder</a><a href="#124050" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#88910" title="String">error</a>, <a href="#88911" title="String">desc</a>, <a href="#88912" title="Option[String]">euri</a>, <a href="#88913" title="Option[String]">state</a><span class="delimiter">)</span>
     <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(refreshToken: String, clientId: String, clientSecret: String, scope: Seq[String])unfiltered.response.ResponseFunction[Any]" id="85704">onRefresh</a><span class="delimiter">(</span><a title="String" id="88914">refreshToken</a>: <span title="String">String</span>, <a title="String" id="88915">clientId</a>: <span title="String">String</span>, <a title="String" id="88916">clientSecret</a>: <span title="String">String</span>, <a title="Seq[String]" id="88917">scope</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="AuthorizationServer.scala.html#81231" title="(r: unfiltered.oauth2.AccessRequest)unfiltered.oauth2.AccessResponse">auth</a><a href="#124060" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="requests.scala.html#85493" title="(refreshToken: String, clientId: String, clientSecret: String, scope: Seq[String])unfiltered.oauth2.RefreshTokenRequest">RefreshTokenRequest</a><span class="delimiter">(</span>
      <a href="#88914" title="String">refreshToken</a>, <a href="#88915" title="String">clientId</a>, <a href="#88916" title="String">clientSecret</a>, <a href="#88917" title="Seq[String]">scope</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> AccessTokenResponse<a href="#124055" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
          <a href="responses.scala.html#85461" title="String" id="88944">accessToken</a>, <a href="responses.scala.html#85463" title="Option[String]" id="88945">tokenType</a>, <a href="responses.scala.html#85465" title="Option[Int]" id="88946">expiresIn</a>, <a href="responses.scala.html#85467" title="Option[String]" id="88947">refreshToken</a>, <a href="responses.scala.html#85469" title="Seq[String]" id="88948">scope</a>, _, <a href="responses.scala.html#85473" title="Iterable[(String, String)]" id="88949">extras</a><span class="delimiter">)</span> =&gt;
            <a href="#85694" title="(accessToken: String, tokenType: Option[String], expiresIn: Option[Int], refreshToken: Option[String], scope: Seq[String], extras: Iterable[(String, String)])unfiltered.response.ResponseFunction[Any]">accessResponder</a><a href="#124060" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
              <a href="#88944" title="String">accessToken</a>, <a href="#88945" title="Option[String]">tokenType</a>, <a href="#88946" title="Option[Int]">expiresIn</a>, <a href="#88947" title="Option[String]">refreshToken</a>, <a href="#88948" title="Seq[String]">scope</a>, <a href="#88949" title="Iterable[(String, String)]">extras</a>
            <span class="delimiter">)</span>
        <span class="keyword">case</span> ErrorResponse<a href="#124055" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="responses.scala.html#81504" title="String" id="88950">error</a>, <a href="responses.scala.html#81506" title="String" id="88951">desc</a>, <a href="responses.scala.html#81508" title="Option[String]" id="88952">euri</a>, <a href="responses.scala.html#81510" title="Option[String]" id="88953">state</a><span class="delimiter">)</span> =&gt;
          <a href="#85695" title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">errorResponder</a><a href="#124060" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#88950" title="String">error</a>, <a href="#88951" title="String">desc</a>, <a href="#88952" title="Option[String]">euri</a>, <a href="#88953" title="Option[String]">state</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; PartialFunction[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest],unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]]" id="85705">intent</a> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest],unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]] with Serializable" id="90074" class="delimiter">{</a>
    <span class="keyword">case</span> req @ <a href="../../../filter/unfiltered/filter/request/paths.scala.html#45774" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(String, String)]">ContextPath</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span>_, <a href="#85710" title="=&gt; String">AuthorizePath</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#57198" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#35646" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[scala.collection.immutable.Map[String,Seq[String]]]">Params</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="89003">params</a><span class="delimiter">)</span> =&gt;
      <span class="keyword">val</span> <a title="unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]" id="89004">expected</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Option[Seq[String]]" id="89040">responseType</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81305" title="=&gt; String">ResponseType</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55531" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81305" title="=&gt; String">ResponseType</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[Seq[String]] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a>
                          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54969" title="(c: Option[String] =&gt; Option[Seq[String]], err: String =&gt; String)Option[String] =&gt; unfiltered.request.QParams.Report[String,Seq[String]]">watch</a><span class="delimiter">(</span><a href="#89024" title="Option[String]">_</a>.<span title="(f: String =&gt; Seq[String])Option[Seq[String]]">map</span><span class="delimiter">(</span><a href="#85696" title="(raw: String)Seq[String]">spaceDecoder</a><span class="delimiter">)</span>, <a title="String" id="89032">e</a> =&gt; <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <a title="Option[String]" id="89055">clientId</a>     &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81281" title="=&gt; String">ClientId</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81281" title="=&gt; String">ClientId</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="89069">redirectURI</a>  &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81279" title="=&gt; String">RedirectURI</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81279" title="=&gt; String">RedirectURI</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[Seq[String]]" id="89097">scope</a>        &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81285" title="=&gt; String">Scope</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[Seq[String]] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54969" title="(c: Option[String] =&gt; Option[Seq[String]], err: String =&gt; String)Option[String] =&gt; unfiltered.request.QParams.Report[String,Seq[String]]">watch</a><span class="delimiter">(</span><a href="#89080" title="Option[String]">_</a>.<span title="(f: String =&gt; Seq[String])Option[Seq[String]]">map</span><span class="delimiter">(</span><a href="#85696" title="(raw: String)Seq[String]">spaceDecoder</a><span class="delimiter">)</span>, <a title="String" id="89088">e</a> =&gt; <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="89112">state</a>        &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81287" title="=&gt; String">State</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55528" title="(f: Option[Option[String]] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54964" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#89104" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="String">String</span><span class="delimiter">]</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <a href="#124065" title="(_1: String, _2: Seq[String])(String, Seq[String])" class="delimiter">(</a><a href="#89069" title="Option[String]">redirectURI</a>.<span title="=&gt; String">get</span>, <a href="#89040" title="Option[Seq[String]]">responseType</a>.<span title="=&gt; Seq[String]">get</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span class="delimiter">(</span><a href="#124065" title="String" id="89121">ruri</a>, <a href="#124065" title="Seq[String]" id="89122">rtx</a><span class="delimiter">)</span> <span class="keyword">if</span><span class="delimiter">(</span><a href="#89122" title="Seq[String]">rtx</a> <span title="(elem: Any)Boolean">contains</span><span class="delimiter">(</span><a href="#81307" title="=&gt; String">Code</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            <a href="#85698" title="(req: unfiltered.request.HttpRequest[Any], responseType: Seq[String], clientId: String, redirectUri: String, scope: Seq[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">onAuthCode</a><a href="#124067" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#124224" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">req</a>, <a href="#89122" title="Seq[String]">rtx</a>, <a href="#89055" title="Option[String]">clientId</a>.<span title="=&gt; String">get</span>, <a href="#89121" title="String">ruri</a>, <a href="#89097" title="Option[Seq[String]]">scope</a>.<span title="(default: =&gt; Seq[String])Seq[String]">getOrElse</span><span class="delimiter">(</span><span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span>, <a href="#89112" title="Option[Option[String]]">state</a>.<span title="=&gt; Option[String]">get</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="delimiter">(</span><a href="#124065" title="String" id="89130">ruri</a>, <a href="#124065" title="Seq[String]" id="89131">rtx</a><span class="delimiter">)</span> <span class="keyword">if</span><span class="delimiter">(</span><a href="#89131" title="Seq[String]">rtx</a> <span title="(elem: Any)Boolean">contains</span><span class="delimiter">(</span><a href="#81309" title="=&gt; String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            <a href="#85699" title="(req: unfiltered.request.HttpRequest[Any], responseType: Seq[String], clientId: String, redirectUri: String, scope: Seq[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">onToken</a><a href="#124067" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#124224" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">req</a>, <a href="#89131" title="Seq[String]">rtx</a>, <a href="#89055" title="Option[String]">clientId</a>.<span title="=&gt; String">get</span>, <a href="#89130" title="String">ruri</a>, <a href="#89097" title="Option[Seq[String]]">scope</a>.<span title="(default: =&gt; Seq[String])Seq[String]">getOrElse</span><span class="delimiter">(</span><span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span>, <a href="#89112" title="Option[Option[String]]">state</a>.<span title="=&gt; Option[String]">get</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="delimiter">(</span><a href="#124065" title="String" id="89137">ruri</a>, <a href="#124065" title="Seq[String]" id="89138">unsupported</a><span class="delimiter">)</span> =&gt;
            <a href="#85700" title="(req: unfiltered.request.HttpRequest[Any], responseType: Seq[String], clientId: String, redirectUri: String, scope: Seq[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">onUnsupportedAuth</a><a href="#124067" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#124224" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">req</a>, <a href="#89138" title="Seq[String]">unsupported</a>, <a href="#89055" title="Option[String]">clientId</a>.<span title="=&gt; String">get</span>, <a href="#89137" title="String">ruri</a>, <a href="#89097" title="Option[Seq[String]]">scope</a>.<span title="(default: =&gt; Seq[String])Seq[String]">getOrElse</span><span class="delimiter">(</span><span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span>, <a href="#89112" title="Option[Option[String]]">state</a>.<span title="=&gt; Option[String]">get</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55534" title="(params: unfiltered.request.Params.Map)unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]">expected</a><a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54941" title="(r: unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]])unfiltered.request.QParams.QueryResultX[String,unfiltered.response.ResponseFunction[Any]]" class="delimiter">(</a><a href="#89003" title="scala.collection.immutable.Map[String,Seq[String]]">params</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55858" title="(handler: unfiltered.request.QParams.Log[String] =&gt; unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse])unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]">orFail</a> <span class="delimiter">{</span> <a title="unfiltered.request.QParams.Log[String]" id="89181">errs</a> =&gt;
        <a href="#89003" title="(key: String)Seq[String]">params</a><span title="unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]" class="delimiter">(</span><a href="#81279" title="=&gt; String">RedirectURI</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#124103" title="(x: Seq[String])Some[Seq[String]]">Seq</a><span class="delimiter">(</span><a title="String" id="89213">uri</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="String" id="89214">qs</a> = <a href="responses.scala.html#85723" title="(kvs: Iterable[(String, String)])String">qstr</a><span class="delimiter">(</span><span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><span class="delimiter">(</span>
              <a href="#81311" title="(x: String)ArrowAssoc[String]">Error</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#81315" title="=&gt; String">InvalidRequest</a>,
              <a href="#81327" title="(x: String)ArrowAssoc[String]">ErrorDescription</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#89181" title="unfiltered.request.QParams.Log[String]">errs</a>.<span title="(f: unfiltered.request.QParams.Fail[String] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[unfiltered.request.QParams.Fail[String]],String,List[String]])List[String]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">{</span> <a href="#89265" title="unfiltered.request.QParams.Fail[String]">_</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55845" title="=&gt; String">error</a> <span class="delimiter">}</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span>
            <span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#89003" title="(key: String)Seq[String]">params</a><span title="unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]" class="delimiter">(</span><a href="#81305" title="=&gt; String">ResponseType</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="#124073" title="(x: Seq[String])Some[Seq[String]]">Seq</a><span class="delimiter">(</span><a href="#81309" title="(idx: Int)String">TokenKey</a><span class="delimiter">)</span> =&gt;
                 <a href="../../../unfiltered/unfiltered/unfiltered/response/redirect.scala.html#75238" title="(loc: String)unfiltered.response.Redirect">Redirect</a><a href="#124083" title="(x: unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse])unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]" class="delimiter">(</a><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s#%s&quot;</span> <span title="(args: Any*)String">format</span><span class="delimiter">(</span>
                   <a href="#89213" title="String">uri</a>, <a href="#89214" title="String">qs</a>
                 <span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> _ =&gt; <a href="../../../unfiltered/unfiltered/unfiltered/response/redirect.scala.html#75238" title="(loc: String)unfiltered.response.Redirect">Redirect</a><a href="#124083" title="(x: unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse])unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]" class="delimiter">(</a><a href="#85693" title="implicit unfiltered.oauth2.Authorized.s2qs : (uri: String)AnyRef{def ?(qs: String): String}">uri</a> <a href="#85912" title="(qs: String)String">?</a> <a href="#89214" title="String">qs</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="keyword">case</span> _ =&gt; <a href="AuthorizationServer.scala.html#81219" title="=&gt; unfiltered.oauth2.AuthorizationServer">auth</a>.<a href="AuthorizationServer.scala.html#81225" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])unfiltered.response.ResponseFunction[Any]">mismatchedRedirectUri</a><a href="#124107" title="(x: unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse])unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]" class="delimiter">(</a><a href="#124224" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">req</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="keyword">case</span> req @ <a href="../../../unfiltered/unfiltered/unfiltered/request/methods.scala.html#34957" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]]">POST</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span><a href="../../../filter/unfiltered/filter/request/paths.scala.html#45774" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(String, String)]">ContextPath</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span>_, <a href="#85711" title="=&gt; String">TokenPath</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#57198" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#35646" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[scala.collection.immutable.Map[String,Seq[String]]]">Params</a><span title="=&gt; unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="89386">params</a><span class="delimiter">)</span> =&gt;
      <span class="keyword">val</span> <a title="unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]" id="89387">expected</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Option[String]" id="89403">grantType</a>     &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81289" title="=&gt; String">GrantType</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81289" title="=&gt; String">GrantType</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="89418">code</a>          &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81307" title="=&gt; String">Code</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[Option[String]] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54964" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#89410" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="String">String</span><span class="delimiter">]</span>
        <a title="Option[String]" id="89433">clientId</a>      &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81281" title="=&gt; String">ClientId</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81281" title="=&gt; String">ClientId</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="89448">redirectURI</a>   &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81279" title="=&gt; String">RedirectURI</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[Option[String]] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54964" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#89440" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="String">String</span><span class="delimiter">]</span>
        // clientSecret is not recommended to be passed as a parameter by instead
        // encoded in a basic auth header http://tools.ietf.org/html/draft-ietf-oauth-v2-16#section-3.1
        <a title="Option[String]" id="89463">clientSecret</a>  &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81283" title="=&gt; String">ClientSecret</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54959" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81283" title="=&gt; String">ClientSecret</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="89478">refreshToken</a>  &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81303" title="=&gt; String">RefreshToken</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[Option[String]] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54964" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#89470" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="String">String</span><span class="delimiter">]</span>
        <a title="Option[Seq[String]]" id="89506">scope</a>         &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81285" title="=&gt; String">Scope</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[Seq[String]] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54969" title="(c: Option[String] =&gt; Option[Seq[String]], err: String =&gt; String)Option[String] =&gt; unfiltered.request.QParams.Report[String,Seq[String]]">watch</a><span class="delimiter">(</span><a href="#89489" title="Option[String]">_</a>.<span title="(f: String =&gt; Seq[String])Option[Seq[String]]">map</span><span class="delimiter">(</span><a href="#85696" title="(raw: String)Seq[String]">spaceDecoder</a><span class="delimiter">)</span>, <a title="String" id="89497">e</a> =&gt; <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="89521">userName</a>      &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81297" title="=&gt; String">Username</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55522" title="(f: Option[Option[String]] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54964" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#89513" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="String">String</span><span class="delimiter">]</span>
        <a title="Option[Option[String]]" id="89535">password</a>      &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54951" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#81295" title="=&gt; String">Password</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55528" title="(f: Option[Option[String]] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54964" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#89528" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="String">String</span><span class="delimiter">]</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>

        <a href="#89403" title="Option[String]">grantType</a>.<span title="=&gt; String">get</span> <span class="keyword">match</span> <span class="delimiter">{</span>

          <span class="keyword">case</span> <a href="#81299" title="unfiltered.response.ResponseFunction[Any]">ClientCredentials</a> =&gt;
            <a href="#85701" title="(clientId: String, clientSecret: String, scope: Seq[String])unfiltered.response.ResponseFunction[Any]">onClientCredentials</a><a href="#124176" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#89433" title="Option[String]">clientId</a>.<span title="=&gt; String">get</span>, <a href="#89463" title="Option[String]">clientSecret</a>.<span title="=&gt; String">get</span>, <a href="#89506" title="Option[Seq[String]]">scope</a>.<span title="(default: =&gt; Seq[String])Seq[String]">getOrElse</span><span class="delimiter">(</span><span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <a href="#81295" title="unfiltered.response.ResponseFunction[Any]">Password</a> =&gt;
            <a href="#124176" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#89521" title="Option[Option[String]]">userName</a>.<span title="=&gt; Option[String]">get</span>, <a href="#89535" title="Option[Option[String]]">password</a>.<span title="=&gt; Option[String]">get</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span class="delimiter">(</span>Some<a href="#124124" title="=&gt; Option[String]" class="delimiter">(</a><a href="#124127" title="String" id="89550">u</a><span class="delimiter">)</span>, Some<a href="#124124" title="=&gt; Option[String]" class="delimiter">(</a><a href="#124128" title="String" id="89552">pw</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
                <a href="#85702" title="(userName: String, password: String, clientId: String, clientSecret: String, scope: Seq[String])unfiltered.response.ResponseFunction[Any]">onPassword</a><a href="#124130" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#89550" title="String">u</a>, <a href="#89552" title="String">pw</a>, <a href="#89433" title="Option[String]">clientId</a>.<span title="=&gt; String">get</span>, <a href="#89463" title="Option[String]">clientSecret</a>.<span title="=&gt; String">get</span>, <a href="#89506" title="Option[Seq[String]]">scope</a>.<span title="(default: =&gt; Seq[String])Seq[String]">getOrElse</span><span class="delimiter">(</span><span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> _ =&gt;
                <a href="#85695" title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">errorResponder</a><a href="#124130" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
                  <a href="#81315" title="=&gt; String">InvalidRequest</a>,
                  <span class="delimiter">(</span><a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81297" title="=&gt; String">Username</a><span class="delimiter">)</span> <a href="#89556" title="(x: String)List[String]">::</a> <a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81295" title="=&gt; String">Password</a><span class="delimiter">)</span> <a href="#89557" title="(x: String)List[String]">::</a> <span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot; and &quot;)" class="string">&quot; and &quot;</span><span class="delimiter">)</span>,
                  <a href="AuthorizationServer.scala.html#81219" title="=&gt; unfiltered.oauth2.AuthorizationServer">auth</a>.<a href="AuthorizationServer.scala.html#81228" title="(error: String)Option[String]">errUri</a><span class="delimiter">(</span><a href="#81315" title="=&gt; String">InvalidRequest</a><span class="delimiter">)</span>, <span title="None.type">None</span>
                <span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> <a href="#81303" title="unfiltered.response.ResponseFunction[Any]">RefreshToken</a> =&gt;
            <a href="#89478" title="Option[Option[String]]">refreshToken</a>.<a href="#124176" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">get</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#124135" title="unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#124136" title="String" id="89572">rtoken</a><span class="delimiter">)</span> =&gt;
                <a href="#85704" title="(refreshToken: String, clientId: String, clientSecret: String, scope: Seq[String])unfiltered.response.ResponseFunction[Any]">onRefresh</a><a href="#124138" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#89572" title="String">rtoken</a>, <a href="#89433" title="Option[String]">clientId</a>.<span title="=&gt; String">get</span>, <a href="#89463" title="Option[String]">clientSecret</a>.<span title="=&gt; String">get</span>, <a href="#89506" title="Option[Seq[String]]">scope</a>.<span title="(default: =&gt; Seq[String])Seq[String]">getOrElse</span><span class="delimiter">(</span><span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> _ =&gt; <a href="#85695" title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">errorResponder</a><a href="#124138" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#81315" title="=&gt; String">InvalidRequest</a>, <a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81303" title="=&gt; String">RefreshToken</a><span class="delimiter">)</span>, <span title="None.type">None</span>, <span title="None.type">None</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> <a href="#81291" title="unfiltered.response.ResponseFunction[Any]">AuthorizationCode</a> =&gt;
            <a href="#124176" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#89418" title="Option[Option[String]]">code</a>.<span title="=&gt; Option[String]">get</span>, <a href="#89448" title="Option[Option[String]]">redirectURI</a>.<span title="=&gt; Option[String]">get</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span class="delimiter">(</span>Some<a href="#124143" title="=&gt; Option[String]" class="delimiter">(</a><a href="#124146" title="String" id="89585">c</a><span class="delimiter">)</span>, Some<a href="#124143" title="=&gt; Option[String]" class="delimiter">(</a><a href="#124147" title="String" id="89587">r</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
                <a href="#85703" title="(code: String, redirectUri: String, clientId: String, clientSecret: String)unfiltered.response.ResponseFunction[Any]">onGrantAuthCode</a><a href="#124149" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a><a href="#89585" title="String">c</a>, <a href="#89587" title="String">r</a>, <a href="#89433" title="Option[String]">clientId</a>.<span title="=&gt; String">get</span>, <a href="#89463" title="Option[String]">clientSecret</a>.<span title="=&gt; String">get</span><span class="delimiter">)</span>
              <span class="keyword">case</span> _ =&gt;
                <a href="#85695" title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">errorResponder</a><a href="#124149" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
                  <a href="#81315" title="=&gt; String">InvalidRequest</a>,
                  <span class="delimiter">(</span><a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81307" title="=&gt; String">Code</a><span class="delimiter">)</span> <a href="#89588" title="(x: String)List[String]">::</a> <a href="#85717" title="(what: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#81279" title="=&gt; String">RedirectURI</a><span class="delimiter">)</span> <a href="#89589" title="(x: String)List[String]">::</a> <span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot; and &quot;)" class="string">&quot; and &quot;</span><span class="delimiter">)</span>,
                  <a href="AuthorizationServer.scala.html#81219" title="=&gt; unfiltered.oauth2.AuthorizationServer">auth</a>.<a href="AuthorizationServer.scala.html#81228" title="(error: String)Option[String]">errUri</a><span class="delimiter">(</span><a href="#81315" title="=&gt; String">InvalidRequest</a><span class="delimiter">)</span>, <span title="None.type">None</span>
                <span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="keyword">case</span> unsupported =&gt;
            // note the oauth2 spec does allow for extension grant types,
            // this implementation currently does not
            <a href="#85695" title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">errorResponder</a><a href="#124176" title="(x: unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]" class="delimiter">(</a>
              <a href="#81323" title="=&gt; String">UnsupportedGrantType</a>, <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s is unsupported&quot;</span> <span title="(args: Any*)String">format</span> <a href="#124154" title="String">unsupported</a>,
              <a href="AuthorizationServer.scala.html#81219" title="=&gt; unfiltered.oauth2.AuthorizationServer">auth</a>.<a href="AuthorizationServer.scala.html#81228" title="(error: String)Option[String]">errUri</a><span class="delimiter">(</span><a href="#81323" title="=&gt; String">UnsupportedGrantType</a><span class="delimiter">)</span>, <span title="None.type">None</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    // here, we are combining requests parameters with basic authentication headers
    // the preferred way of providing client credentials is through 
    // basic auth but this is not required. The following folds basic auth data
    // into the params ensuring there is no conflict in transports
     <span class="keyword">val</span> <a title="Either[String,Map[String,Seq[String]]]" id="89388">combinedParams</a> = <span class="delimiter">(</span>
       <span class="delimiter">(</span><span title="(b: scala.collection.immutable.Map[String,Seq[String]])scala.util.Right[Nothing,scala.collection.immutable.Map[String,Seq[String]]]">Right</span><span class="delimiter">(</span><a href="#89386" title="scala.collection.immutable.Map[String,Seq[String]]">params</a><span class="delimiter">)</span>: <span title="Either[String,Map[String,Seq[String]]]">Either</span><span class="delimiter">[</span>String, Map<span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <a href="#89616" title="(z: Either[String,Map[String,Seq[String]]])(op: (Either[String,Map[String,Seq[String]]], (String, String)) =&gt; Either[String,Map[String,Seq[String]]])Either[String,Map[String,Seq[String]]]">/:</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/auths.scala.html#89627" title="(r: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[(String, String)]">BasicAuth</a><span title="(xo: Option[(String, String)])Iterable[(String, String)]" class="delimiter">(</span><a href="#124224" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">req</a><span class="delimiter">)</span>
     <span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="Either[String,Map[String,Seq[String]]]" id="89809">a</a>,<a title="(String, String)" id="89810">e</a><span class="delimiter">)</span> =&gt; <a href="#89810" title="(String, String)">e</a> <span class="keyword">match</span> <span class="delimiter">{</span>
       <span class="keyword">case</span> <span class="delimiter">(</span><a href="#124217" title="String" id="89813">clientId</a>, <a href="#124217" title="String" id="89814">clientSecret</a><span class="delimiter">)</span> =&gt;
         <span class="keyword">val</span> <a title="scala.util.Right[Nothing,scala.collection.immutable.Map[String,Seq[String]]]" id="89815">preferred</a> = <span title="(b: scala.collection.immutable.Map[String,Seq[String]])scala.util.Right[Nothing,scala.collection.immutable.Map[String,Seq[String]]]">Right</span><span class="delimiter">(</span>
           <a href="#89809" title="Either[String,Map[String,Seq[String]]]">a</a>.<span title="=&gt; scala.util.Either.RightProjection[String,Map[String,Seq[String]]]">right</span>.<span title="=&gt; Map[String,Seq[String]]">get</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <span title="(elems: (String, Seq[String])*)scala.collection.immutable.Map[String,Seq[String]]">Map</span><span class="delimiter">(</span><a href="#81281" title="(x: String)ArrowAssoc[String]">ClientId</a> <span title="(y: Seq[String])(String, Seq[String])">-&gt;</span> <span title="(elems: String*)Seq[String]">Seq</span><span class="delimiter">(</span><a href="#89813" title="String">clientId</a><span class="delimiter">)</span>, <a href="#81283" title="(x: String)ArrowAssoc[String]">ClientSecret</a><span title="(y: Seq[String])(String, Seq[String])">-&gt;</span> <span title="(elems: String*)Seq[String]">Seq</span><span class="delimiter">(</span><a href="#89814" title="String">clientSecret</a><span class="delimiter">)</span><span class="delimiter">)</span>
         <span class="delimiter">)</span>
         <a href="#89809" title="Either[String,Map[String,Seq[String]]]">a</a>.<span title="=&gt; scala.util.Either.RightProjection[String,Map[String,Seq[String]]]">right</span>.<span title="(key: String)Seq[String]">get</span><span title="Either[String,Map[String,Seq[String]]]" class="delimiter">(</span><a href="#81281" title="=&gt; String">ClientId</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
           <span class="keyword">case</span> <a href="#124196" title="(x: Seq[String])Some[Seq[String]]">Seq</a><span class="delimiter">(</span><a title="String" id="89971">id</a><span class="delimiter">)</span> =&gt;
             <a href="#124200" title="(x: Either[String,Map[String,Seq[String]]])Either[String,Map[String,Seq[String]]]" class="keyword">if</a><span class="delimiter">(</span><a href="#89971" title="String">id</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#89813" title="String">clientId</a><span class="delimiter">)</span> <a href="#89815" title="scala.util.Right[Nothing,scala.collection.immutable.Map[String,Seq[String]]]">preferred</a> <span class="keyword">else</span> <span title="(a: String)scala.util.Left[String,Nothing]">Left</span><span class="delimiter">(</span><span title="String(&quot;client ids did not match&quot;)" class="string">&quot;client ids did not match&quot;</span><span class="delimiter">)</span>
           <span class="keyword">case</span> _ =&gt; <a href="#124200" title="(x: Either[String,Map[String,Seq[String]]])Either[String,Map[String,Seq[String]]]">preferred</a>
         <span class="delimiter">}</span>
       <span class="keyword">case</span> _ =&gt; <a href="#124219" title="(x: Either[String,Map[String,Seq[String]]])Either[String,Map[String,Seq[String]]]">a</a>
     <span class="delimiter">}</span><span class="delimiter">)</span>

     <a href="#89388" title="Either[String,Map[String,Seq[String]]]">combinedParams</a> <span title="(fa: String =&gt; unfiltered.response.ResponseFunction[Any], fb: Map[String,Seq[String]] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">fold</span><span class="delimiter">(</span><span class="delimiter">{</span> <a title="String" id="89986">err</a> =&gt;
       <a href="#85695" title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">errorResponder</a><span class="delimiter">(</span><a href="#81315" title="=&gt; String">InvalidRequest</a>, <a href="#89986" title="String">err</a>, <span title="None.type">None</span>, <span title="None.type">None</span><span class="delimiter">)</span>
     <span class="delimiter">}</span>, <span class="delimiter">{</span> <a title="Map[String,Seq[String]]" id="89988">mixed</a> =&gt;
       <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55534" title="(params: unfiltered.request.Params.Map)unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]]">expected</a><a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#54941" title="(r: unfiltered.request.QParams.QueryResult[String,unfiltered.response.ResponseFunction[Any]])unfiltered.request.QParams.QueryResultX[String,unfiltered.response.ResponseFunction[Any]]" class="delimiter">(</a><a href="#89988" title="Map[String,Seq[String]]">mixed</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55858" title="(handler: unfiltered.request.QParams.Log[String] =&gt; unfiltered.response.ResponseFunction[Any])unfiltered.response.ResponseFunction[Any]">orFail</a> <span class="delimiter">{</span> <a title="unfiltered.request.QParams.Log[String]" id="90020">errs</a> =&gt;
         <a href="#85695" title="(error: String, desc: String, euri: Option[String], state: Option[String])unfiltered.response.ResponseFunction[Any]">errorResponder</a><span class="delimiter">(</span><a href="#81315" title="=&gt; String">InvalidRequest</a>, <a href="#90020" title="unfiltered.request.QParams.Log[String]">errs</a>.<span title="(f: unfiltered.request.QParams.Fail[String] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[unfiltered.request.QParams.Fail[String]],String,List[String]])List[String]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">{</span> <a href="#90037" title="unfiltered.request.QParams.Fail[String]">_</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#55845" title="=&gt; String">error</a> <span class="delimiter">}</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span>, <span title="None.type">None</span>, <span title="None.type">None</span><span class="delimiter">)</span>
       <span class="delimiter">}</span>
     <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>oauth2/unfiltered/oauth2/AuthorizationServer.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> unfiltered.oauth2

<span class="keyword">import</span> unfiltered.request.HttpRequest

<span class="keyword">trait</span> <a title="trait AuthorizationProvider extends AnyRef" id="11561">AuthorizationProvider</a> <span class="delimiter">{</span> <span class="keyword">val</span> <a title="=&gt; unfiltered.oauth2.AuthorizationServer" id="81219">auth</a>: <a href="#11573" title="unfiltered.oauth2.AuthorizationServer">AuthorizationServer</a> <span class="delimiter">}</span>

<span title="AnyRef" class="keyword">object</span> <a title="unfiltered.oauth2.AuthorizationServer.type" id="11574">AuthorizationServer</a> <a href="#11575" title="unfiltered.oauth2.AuthorizationServer.type" class="delimiter">{</a>
  <span class="keyword">val</span> <a title="String" id="81233">InvalidRedirectURIMsg</a> = <span title="String(&quot;invalid redirect_uri&quot;)" class="string">&quot;invalid redirect_uri&quot;</span>
  <span class="keyword">val</span> <a title="String" id="81235">UnknownClientMsg</a> = <span title="String(&quot;unknown client&quot;)" class="string">&quot;unknown client&quot;</span>
<span class="delimiter">}</span>

/**
 * @see [[http://tools.ietf.org/html/draft-ietf-oauth-v2-20#section-1.1]]
 */
<span title="AnyRef" class="keyword">trait</span> <a title="trait AuthorizationServer extends AnyRef" id="11573">AuthorizationServer</a> <span title="Unit" class="delimiter">{</span>
  self: ClientStore <span class="keyword">with</span> TokenStore <span class="keyword">with</span> Service =&gt;
  <span class="keyword">import</span> <a href="authorizations.scala.html#11919" title="unfiltered.oauth2.OAuthorization.type">OAuthorization</a>._
  <span class="keyword">import</span> <a href="#11574" title="unfiltered.oauth2.AuthorizationServer.type">AuthorizationServer</a>._

  <span class="keyword">def</span> <a title="[T](req: unfiltered.request.HttpRequest[T])unfiltered.response.ResponseFunction[Any]" id="81225">mismatchedRedirectUri</a><span class="delimiter">[</span><a title="" id="81227">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.HttpRequest[T]" id="81339">req</a>: <a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#7615" title="unfiltered.request.HttpRequest[T]">HttpRequest</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="services.scala.html#81255" title="(req: unfiltered.request.HttpRequest[T], uri: Option[String], client: Option[unfiltered.oauth2.Client])unfiltered.response.ResponseFunction[Any]">invalidRedirectUri</a><span class="delimiter">(</span><a href="#81339" title="unfiltered.request.HttpRequest[T]">req</a>, <span title="None.type">None</span>, <span title="None.type">None</span><span class="delimiter">)</span>

  /** todo: rectify this design */
  <span class="keyword">def</span> <a title="(error: String)Option[String]" id="81228">errUri</a><span class="delimiter">(</span><a title="String" id="81357">error</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="#81357" title="String">error</a><span class="delimiter">)</span>

  /** Some servers may wish to override this with custom redirect_url
   *  validation rules. We are being lenient here by checking the base
   *  of the registered redirect_uri. The spec recommends using the `state`
   *  param for per-request customization.
   * @return true if valid, false otherwise
   * @see [[http://tools.ietf.org/html/draft-ietf-oauth-v2-22#section-3.1.2.2]]
   */
  <span class="keyword">def</span> <a title="(provided: String, client: unfiltered.oauth2.Client)Boolean" id="81229">validRedirectUri</a><span class="delimiter">(</span><a title="String" id="81360">provided</a>: <span title="String">String</span>, <a title="unfiltered.oauth2.Client" id="81361">client</a>: <a href="clients.scala.html#11807" title="unfiltered.oauth2.Client">Client</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
    <span title="=&gt; Boolean">!</span><a href="#81360" title="String">provided</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;#&quot;)" class="string">&quot;#&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#81360" title="String">provided</a>.<span title="(x$1: String)Boolean">startsWith</span><span class="delimiter">(</span><a href="#81361" title="unfiltered.oauth2.Client">client</a>.<a href="clients.scala.html#81352" title="=&gt; String">redirectUri</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(r: unfiltered.oauth2.AuthorizationRequest)unfiltered.oauth2.AuthorizationResponse" id="81230">apply</a><span class="delimiter">(</span><a title="unfiltered.oauth2.AuthorizationRequest" id="81364">r</a>: <a href="requests.scala.html#11564" title="unfiltered.oauth2.AuthorizationRequest">AuthorizationRequest</a><span class="delimiter">)</span>: <a href="responses.scala.html#11567" title="unfiltered.oauth2.AuthorizationResponse">AuthorizationResponse</a> = <a href="#81364" title="unfiltered.oauth2.AuthorizationRequest">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>

    <span class="keyword">case</span> AuthorizationCodeRequest<a href="#123864" title="unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="requests.scala.html#81380" title="unfiltered.request.HttpRequest[Any]" id="81440">req</a>, <a href="requests.scala.html#81382" title="Seq[String]" id="81441">responseTypes</a>, <a href="requests.scala.html#81384" title="String" id="81442">clientId</a>,
                                  <a href="requests.scala.html#81386" title="String" id="81443">redirectUri</a>, <a href="requests.scala.html#81388" title="Seq[String]" id="81444">scope</a>, <a href="requests.scala.html#81390" title="Option[String]" id="81445">state</a><span class="delimiter">)</span> =&gt;
      <a href="clients.scala.html#81240" title="(clientId: String, secret: Option[String])Option[unfiltered.oauth2.Client]">client</a><a href="#123869" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="#81442" title="String">clientId</a>, <span title="None.type">None</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#123832" title="unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="#123833" title="unfiltered.oauth2.Client" id="81449">client</a><span class="delimiter">)</span> =&gt;
          <a href="#123835" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="keyword">if</a><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#81229" title="(provided: String, client: unfiltered.oauth2.Client)Boolean">validRedirectUri</a><span class="delimiter">(</span><a href="#81443" title="String">redirectUri</a>, <a href="#81449" title="unfiltered.oauth2.Client">client</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="responses.scala.html#81452" title="(handler: unfiltered.response.ResponseFunction[Any])unfiltered.oauth2.ServiceResponse">ServiceResponse</a><span class="delimiter">(</span>
            <a href="services.scala.html#81255" title="(req: unfiltered.request.HttpRequest[Any], uri: Option[String], client: Option[unfiltered.oauth2.Client])unfiltered.response.ResponseFunction[Any]">invalidRedirectUri</a><span class="delimiter">(</span><a href="#81440" title="unfiltered.request.HttpRequest[Any]">req</a>, <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#81443" title="String">redirectUri</a><span class="delimiter">)</span>, <span title="(x: unfiltered.oauth2.Client)Some[unfiltered.oauth2.Client]">Some</span><span class="delimiter">(</span><a href="#81449" title="unfiltered.oauth2.Client">client</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">)</span> <span class="keyword">else</span> <span title="unfiltered.oauth2.AuthorizationResponse" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="services.scala.html#81272" title="(scopes: Seq[String])Boolean">validScopes</a><span class="delimiter">(</span><a href="#81444" title="Seq[String]">scope</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><span class="delimiter">(</span><a href="authorizations.scala.html#81325" title="=&gt; String">InvalidScope</a>, <span title="String(&quot;invalid scope&quot;)" class="string">&quot;invalid scope&quot;</span>,
                          <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81325" title="=&gt; String">InvalidScope</a><span class="delimiter">)</span>, <a href="#81445" title="Option[String]">state</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="services.scala.html#81262" title="(r: unfiltered.request.HttpRequest[Any])Option[unfiltered.oauth2.ResourceOwner]">resourceOwner</a><span title="unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</span><a href="#81440" title="unfiltered.request.HttpRequest[Any]">req</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#123824" title="unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="#123825" title="unfiltered.oauth2.ResourceOwner" id="81540">owner</a><span class="delimiter">)</span> =&gt;
                 <a href="#123827" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="keyword">if</a><span class="delimiter">(</span><a href="services.scala.html#81269" title="(r: unfiltered.request.HttpRequest[Any])Boolean">denied</a><span class="delimiter">(</span><a href="#81440" title="unfiltered.request.HttpRequest[Any]">req</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><span class="delimiter">(</span>
                   <a href="authorizations.scala.html#81319" title="=&gt; String">AccessDenied</a>, <span title="String(&quot;user denied request&quot;)" class="string">&quot;user denied request&quot;</span>,
                   <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81319" title="=&gt; String">AccessDenied</a><span class="delimiter">)</span>, <a href="#81445" title="Option[String]">state</a><span class="delimiter">)</span>
                 <span class="keyword">else</span> <span title="unfiltered.oauth2.AuthorizationResponse" class="keyword">if</span><span class="delimiter">(</span><a href="services.scala.html#81266" title="(r: unfiltered.request.HttpRequest[Any])Boolean">accepted</a><span class="delimiter">(</span><a href="#81440" title="unfiltered.request.HttpRequest[Any]">req</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                    <a href="responses.scala.html#81555" title="(code: String, state: Option[String])unfiltered.oauth2.AuthorizationCodeResponse">AuthorizationCodeResponse</a><span class="delimiter">(</span>
                      <a href="tokens.scala.html#81245" title="(responseTypes: Seq[String], owner: unfiltered.oauth2.ResourceOwner, client: unfiltered.oauth2.Client, scope: Seq[String], redirectUri: String)String">generateAuthorizationCode</a><span class="delimiter">(</span><a href="#81441" title="Seq[String]">responseTypes</a>,
                                                <a href="#81540" title="unfiltered.oauth2.ResourceOwner">owner</a>,
                                                <a href="#81449" title="unfiltered.oauth2.Client">client</a>,
                                                <a href="#81444" title="Seq[String]">scope</a>,
                                                <a href="#81443" title="String">redirectUri</a><span class="delimiter">)</span>,
                      <a href="#81445" title="Option[String]">state</a><span class="delimiter">)</span>
                 <span class="delimiter">}</span>
                 <span class="keyword">else</span> <a href="responses.scala.html#81452" title="(handler: unfiltered.response.ResponseFunction[Any])unfiltered.oauth2.ServiceResponse">ServiceResponse</a><span class="delimiter">(</span><a href="services.scala.html#81252" title="(requestBundle: unfiltered.oauth2.RequestBundle[Any])unfiltered.response.ResponseFunction[Any]">requestAuthorization</a><span class="delimiter">(</span>
                   <a href="services.scala.html#81582" title="(request: unfiltered.request.HttpRequest[Any], responseTypes: Seq[String], client: unfiltered.oauth2.Client, owner: Option[unfiltered.oauth2.ResourceOwner], redirectUri: String, scope: Seq[String], state: Option[String])unfiltered.oauth2.RequestBundle[Any]">RequestBundle</a><span class="delimiter">(</span><a href="#81440" title="unfiltered.request.HttpRequest[Any]">req</a>, <a href="#81441" title="Seq[String]">responseTypes</a>, <a href="#81449" title="unfiltered.oauth2.Client">client</a>,
                                 <span title="(x: unfiltered.oauth2.ResourceOwner)Some[unfiltered.oauth2.ResourceOwner]">Some</span><span class="delimiter">(</span><a href="#81540" title="unfiltered.oauth2.ResourceOwner">owner</a><span class="delimiter">)</span>, <a href="#81443" title="String">redirectUri</a>, <a href="#81444" title="Seq[String]">scope</a>, <a href="#81445" title="Option[String]">state</a><span class="delimiter">)</span>
                 <span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81452" title="(handler: unfiltered.response.ResponseFunction[Any])unfiltered.oauth2.ServiceResponse">ServiceResponse</a><a href="#123827" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a>
                <a href="services.scala.html#81249" title="(requestBundle: unfiltered.oauth2.RequestBundle[Any])unfiltered.response.ResponseFunction[Any]">login</a><span class="delimiter">(</span><a href="services.scala.html#81582" title="(request: unfiltered.request.HttpRequest[Any], responseTypes: Seq[String], client: unfiltered.oauth2.Client, owner: Option[unfiltered.oauth2.ResourceOwner], redirectUri: String, scope: Seq[String], state: Option[String])unfiltered.oauth2.RequestBundle[Any]">RequestBundle</a><span class="delimiter">(</span><a href="#81440" title="unfiltered.request.HttpRequest[Any]">req</a>, <a href="#81441" title="Seq[String]">responseTypes</a>,
                                    <a href="#81449" title="unfiltered.oauth2.Client">client</a>, <span title="None.type">None</span>, <a href="#81443" title="String">redirectUri</a>,
                                    <a href="#81444" title="Seq[String]">scope</a>, <a href="#81445" title="Option[String]">state</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <span class="delimiter">}</span>
        <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81452" title="(handler: unfiltered.response.ResponseFunction[Any])unfiltered.oauth2.ServiceResponse">ServiceResponse</a><a href="#123835" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="services.scala.html#81258" title="(req: unfiltered.request.HttpRequest[Any])unfiltered.response.ResponseFunction[Any]">invalidClient</a><span class="delimiter">(</span><a href="#81440" title="unfiltered.request.HttpRequest[Any]">req</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">case</span> ImplicitAuthorizationRequest<a href="#123864" title="unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="requests.scala.html#81688" title="unfiltered.request.HttpRequest[Any]" id="81748">req</a>, <a href="requests.scala.html#81690" title="Seq[String]" id="81749">responseTypes</a>, <a href="requests.scala.html#81692" title="String" id="81750">clientId</a>,
                                      <a href="requests.scala.html#81694" title="String" id="81751">redirectUri</a>, <a href="requests.scala.html#81696" title="Seq[String]" id="81752">scope</a>, <a href="requests.scala.html#81698" title="Option[String]" id="81753">state</a><span class="delimiter">)</span> =&gt;
      <a href="clients.scala.html#81240" title="(clientId: String, secret: Option[String])Option[unfiltered.oauth2.Client]">client</a><a href="#123869" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="#81750" title="String">clientId</a>, <span title="None.type">None</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#123848" title="unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="#123849" title="unfiltered.oauth2.Client" id="81755">c</a><span class="delimiter">)</span> =&gt;
          <a href="#123851" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="keyword">if</a><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#81229" title="(provided: String, client: unfiltered.oauth2.Client)Boolean">validRedirectUri</a><span class="delimiter">(</span><a href="#81751" title="String">redirectUri</a>, <a href="#81755" title="unfiltered.oauth2.Client">c</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="responses.scala.html#81452" title="(handler: unfiltered.response.ResponseFunction[Any])unfiltered.oauth2.ServiceResponse">ServiceResponse</a><span class="delimiter">(</span>
            <a href="services.scala.html#81255" title="(req: unfiltered.request.HttpRequest[Any], uri: Option[String], client: Option[unfiltered.oauth2.Client])unfiltered.response.ResponseFunction[Any]">invalidRedirectUri</a><span class="delimiter">(</span><a href="#81748" title="unfiltered.request.HttpRequest[Any]">req</a>, <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#81751" title="String">redirectUri</a><span class="delimiter">)</span>, <span title="(x: unfiltered.oauth2.Client)Some[unfiltered.oauth2.Client]">Some</span><span class="delimiter">(</span><a href="#81755" title="unfiltered.oauth2.Client">c</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">)</span>
          <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="services.scala.html#81262" title="(r: unfiltered.request.HttpRequest[Any])Option[unfiltered.oauth2.ResourceOwner]">resourceOwner</a><span title="unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</span><a href="#81748" title="unfiltered.request.HttpRequest[Any]">req</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#123840" title="unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="#123841" title="unfiltered.oauth2.ResourceOwner" id="81779">owner</a><span class="delimiter">)</span> =&gt;
                <a href="#123843" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="keyword">if</a><span class="delimiter">(</span><a href="services.scala.html#81269" title="(r: unfiltered.request.HttpRequest[Any])Boolean">denied</a><span class="delimiter">(</span><a href="#81748" title="unfiltered.request.HttpRequest[Any]">req</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="responses.scala.html#81518" title="Option[String]" id="85109">ErrorResponse</a><span class="delimiter">(</span><a href="authorizations.scala.html#81319" title="String" id="81783">AccessDenied</a>,
                                              <a title="String" id="81784" class="string">&quot;user denied request&quot;</a>,
                                              state = <a href="#81753" title="Option[String]" id="81785">state</a><span class="delimiter">)</span>
                <span class="keyword">else</span> <span title="unfiltered.oauth2.AuthorizationResponse" class="keyword">if</span><span class="delimiter">(</span><a href="services.scala.html#81266" title="(r: unfiltered.request.HttpRequest[Any])Boolean">accepted</a><span class="delimiter">(</span><a href="#81748" title="unfiltered.request.HttpRequest[Any]">req</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <span class="keyword">val</span> <a title="unfiltered.oauth2.Token" id="85113">t</a> = <a href="tokens.scala.html#81246" title="(responseTypes: Seq[String], owner: unfiltered.oauth2.ResourceOwner, client: unfiltered.oauth2.Client, scope: Seq[String], redirectUri: String)unfiltered.oauth2.Token">generateImplicitAccessToken</a><span class="delimiter">(</span><a href="#81749" title="Seq[String]">responseTypes</a>, <a href="#81779" title="unfiltered.oauth2.ResourceOwner">owner</a>,
                                                      <a href="#81755" title="unfiltered.oauth2.Client">c</a>, <a href="#81752" title="Seq[String]">scope</a>, <a href="#81751" title="String">redirectUri</a><span class="delimiter">)</span>
                  <a href="responses.scala.html#85139" title="(accessToken: String, tokenType: Option[String], expiresIn: Option[Int], scope: Seq[String], state: Option[String], extras: Iterable[(String, String)])unfiltered.oauth2.ImplicitAccessTokenResponse">ImplicitAccessTokenResponse</a><span class="delimiter">(</span>
                    <a href="#85113" title="unfiltered.oauth2.Token">t</a>.<a href="tokens.scala.html#85120" title="=&gt; String">value</a>, <a href="#85113" title="unfiltered.oauth2.Token">t</a>.<a href="tokens.scala.html#85124" title="=&gt; Option[String]">tokenType</a>, <a href="#85113" title="unfiltered.oauth2.Token">t</a>.<a href="tokens.scala.html#85126" title="=&gt; Option[Int]">expiresIn</a>, <a href="#81752" title="Seq[String]">scope</a>, <a href="#81753" title="Option[String]">state</a>, <a href="#85113" title="unfiltered.oauth2.Token">t</a>.<a href="tokens.scala.html#85128" title="=&gt; Iterable[(String, String)]">extras</a>
                  <span class="delimiter">)</span>
                <span class="delimiter">}</span>
                <span class="keyword">else</span> <a href="responses.scala.html#81452" title="(handler: unfiltered.response.ResponseFunction[Any])unfiltered.oauth2.ServiceResponse">ServiceResponse</a><span class="delimiter">(</span><a href="services.scala.html#81252" title="(requestBundle: unfiltered.oauth2.RequestBundle[Any])unfiltered.response.ResponseFunction[Any]">requestAuthorization</a><span class="delimiter">(</span>
                  <a href="services.scala.html#81582" title="(request: unfiltered.request.HttpRequest[Any], responseTypes: Seq[String], client: unfiltered.oauth2.Client, owner: Option[unfiltered.oauth2.ResourceOwner], redirectUri: String, scope: Seq[String], state: Option[String])unfiltered.oauth2.RequestBundle[Any]">RequestBundle</a><span class="delimiter">(</span><a href="#81748" title="unfiltered.request.HttpRequest[Any]">req</a>, <a href="#81749" title="Seq[String]">responseTypes</a>, <a href="#81755" title="unfiltered.oauth2.Client">c</a>, <span title="(x: unfiltered.oauth2.ResourceOwner)Some[unfiltered.oauth2.ResourceOwner]">Some</span><span class="delimiter">(</span><a href="#81779" title="unfiltered.oauth2.ResourceOwner">owner</a><span class="delimiter">)</span>,
                                <a href="#81751" title="String">redirectUri</a>, <a href="#81752" title="Seq[String]">scope</a>, <a href="#81753" title="Option[String]">state</a><span class="delimiter">)</span>
                <span class="delimiter">)</span><span class="delimiter">)</span>
             <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81452" title="(handler: unfiltered.response.ResponseFunction[Any])unfiltered.oauth2.ServiceResponse">ServiceResponse</a><a href="#123843" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="services.scala.html#81249" title="(requestBundle: unfiltered.oauth2.RequestBundle[Any])unfiltered.response.ResponseFunction[Any]">login</a><span class="delimiter">(</span>
               <a href="services.scala.html#81582" title="(request: unfiltered.request.HttpRequest[Any], responseTypes: Seq[String], client: unfiltered.oauth2.Client, owner: Option[unfiltered.oauth2.ResourceOwner], redirectUri: String, scope: Seq[String], state: Option[String])unfiltered.oauth2.RequestBundle[Any]">RequestBundle</a><span class="delimiter">(</span><a href="#81748" title="unfiltered.request.HttpRequest[Any]">req</a>, <a href="#81749" title="Seq[String]">responseTypes</a>, <a href="#81755" title="unfiltered.oauth2.Client">c</a>, <span title="None.type">None</span>,
                             <a href="#81751" title="String">redirectUri</a>, <a href="#81752" title="Seq[String]">scope</a>, <a href="#81753" title="Option[String]">state</a><span class="delimiter">)</span>
             <span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81452" title="(handler: unfiltered.response.ResponseFunction[Any])unfiltered.oauth2.ServiceResponse">ServiceResponse</a><a href="#123851" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="services.scala.html#81258" title="(req: unfiltered.request.HttpRequest[Any])unfiltered.response.ResponseFunction[Any]">invalidClient</a><span class="delimiter">(</span><a href="#81748" title="unfiltered.request.HttpRequest[Any]">req</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">case</span> IndeterminateAuthorizationRequest<a href="#123864" title="unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a>
      <a href="requests.scala.html#85254" title="unfiltered.request.HttpRequest[Any]" id="85314">req</a>, <a href="requests.scala.html#85256" title="Seq[String]" id="85315">responseTypes</a>, <a href="requests.scala.html#85258" title="String" id="85316">clientId</a>, <a href="requests.scala.html#85260" title="String" id="85317">redirectUri</a>, scope, <a href="requests.scala.html#85264" title="Option[String]" id="85319">state</a><span class="delimiter">)</span> =&gt;
        <a href="clients.scala.html#81240" title="(clientId: String, secret: Option[String])Option[unfiltered.oauth2.Client]">client</a><a href="#123869" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="#85316" title="String">clientId</a>, <span title="None.type">None</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Some<a href="#123856" title="unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="#123857" title="unfiltered.oauth2.Client" id="85321">c</a><span class="delimiter">)</span> =&gt;
            <a href="#123859" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="keyword">if</a><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#81229" title="(provided: String, client: unfiltered.oauth2.Client)Boolean">validRedirectUri</a><span class="delimiter">(</span><a href="#85317" title="String">redirectUri</a>, <a href="#85321" title="unfiltered.oauth2.Client">c</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="responses.scala.html#81452" title="(handler: unfiltered.response.ResponseFunction[Any])unfiltered.oauth2.ServiceResponse">ServiceResponse</a><span class="delimiter">(</span>
              <a href="services.scala.html#81255" title="(req: unfiltered.request.HttpRequest[Any], uri: Option[String], client: Option[unfiltered.oauth2.Client])unfiltered.response.ResponseFunction[Any]">invalidRedirectUri</a><span class="delimiter">(</span><a href="#85314" title="unfiltered.request.HttpRequest[Any]">req</a>, <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#85317" title="String">redirectUri</a><span class="delimiter">)</span>, <span title="(x: unfiltered.oauth2.Client)Some[unfiltered.oauth2.Client]">Some</span><span class="delimiter">(</span><a href="#85321" title="unfiltered.oauth2.Client">c</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">)</span>
            <span class="keyword">else</span> <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><span class="delimiter">(</span>
              <a href="authorizations.scala.html#81321" title="=&gt; String">UnsupportedResponseType</a>, <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;unsupported response type(s) %s&quot;</span> <span title="(args: Any*)String">format</span> <a href="#85315" title="Seq[String]">responseTypes</a>,
              <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81321" title="=&gt; String">UnsupportedResponseType</a><span class="delimiter">)</span>, <a href="#85319" title="Option[String]">state</a><span class="delimiter">)</span>
          <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81452" title="(handler: unfiltered.response.ResponseFunction[Any])unfiltered.oauth2.ServiceResponse">ServiceResponse</a><a href="#123859" title="(x: unfiltered.oauth2.AuthorizationResponse)unfiltered.oauth2.AuthorizationResponse" class="delimiter">(</a><a href="services.scala.html#81258" title="(req: unfiltered.request.HttpRequest[Any])unfiltered.response.ResponseFunction[Any]">invalidClient</a><span class="delimiter">(</span><a href="#85314" title="unfiltered.request.HttpRequest[Any]">req</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(r: unfiltered.oauth2.AccessRequest)unfiltered.oauth2.AccessResponse" id="81231">apply</a><span class="delimiter">(</span><a title="unfiltered.oauth2.AccessRequest" id="85341">r</a>: <a href="requests.scala.html#11522" title="unfiltered.oauth2.AccessRequest">AccessRequest</a><span class="delimiter">)</span>: <a href="responses.scala.html#11525" title="unfiltered.oauth2.AccessResponse">AccessResponse</a> = <a href="#85341" title="unfiltered.oauth2.AccessRequest">r</a> <span class="keyword">match</span> <span class="delimiter">{</span>

    <span class="keyword">case</span> AccessTokenRequest<a href="#123936" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="requests.scala.html#85351" title="String" id="85390">code</a>, <a href="requests.scala.html#85353" title="String" id="85391">redirectUri</a>, <a href="requests.scala.html#85355" title="String" id="85392">clientId</a>, <a href="requests.scala.html#85357" title="String" id="85393">clientSecret</a><span class="delimiter">)</span> =&gt;
      <a href="clients.scala.html#81240" title="(clientId: String, secret: Option[String])Option[unfiltered.oauth2.Client]">client</a><a href="#123942" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#85392" title="String">clientId</a>, <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#85393" title="String">clientSecret</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#123883" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#123884" title="unfiltered.oauth2.Client" id="85398">client</a><span class="delimiter">)</span> =&gt;
          <a href="#123886" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="keyword">if</a><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#81229" title="(provided: String, client: unfiltered.oauth2.Client)Boolean">validRedirectUri</a><span class="delimiter">(</span><a href="#85391" title="String">redirectUri</a>, <a href="#85398" title="unfiltered.oauth2.Client">client</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><span class="delimiter">(</span>
            <a href="authorizations.scala.html#81313" title="=&gt; String">InvalidClient</a>, <span title="String(&quot;invalid redirect uri&quot;)" class="string">&quot;invalid redirect uri&quot;</span>, <span title="None.type">None</span>, <span title="None.type">None</span>
          <span class="delimiter">)</span>
          <span class="keyword">else</span>  <span class="delimiter">{</span>
            <a href="tokens.scala.html#81243" title="(code: String)Option[unfiltered.oauth2.Token]">token</a><span title="unfiltered.oauth2.AccessResponse" class="delimiter">(</span><a href="#85390" title="String">code</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#123875" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#123876" title="unfiltered.oauth2.Token" id="85401">token</a><span class="delimiter">)</span> =&gt;
                // tokens redirectUri must be exact match to the one provided
                // in order further bind the access request to the auth request
                <a href="#123878" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="keyword">if</a><span class="delimiter">(</span><a href="#85401" title="unfiltered.oauth2.Token">token</a>.<a href="tokens.scala.html#85121" title="=&gt; String">clientId</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#85398" title="unfiltered.oauth2.Client">client</a>.<a href="clients.scala.html#81350" title="=&gt; String">id</a> <span title="(x: Boolean)Boolean">||</span> <a href="#85401" title="unfiltered.oauth2.Token">token</a>.<a href="tokens.scala.html#85122" title="=&gt; String">redirectUri</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#85391" title="String">redirectUri</a><span class="delimiter">)</span>
                  <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><span class="delimiter">(</span>
                    <a href="authorizations.scala.html#81317" title="=&gt; String">UnauthorizedClient</a>, <span title="String(&quot;client not authorized&quot;)" class="string">&quot;client not authorized&quot;</span>, <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81317" title="=&gt; String">UnauthorizedClient</a><span class="delimiter">)</span>, <span title="None.type">None</span>
                  <span class="delimiter">)</span>
                <span class="keyword">else</span> <span class="delimiter">{</span>
                  <span class="keyword">val</span> <a title="unfiltered.oauth2.Token" id="85412">t</a> = <a href="tokens.scala.html#81244" title="(codeToken: unfiltered.oauth2.Token)unfiltered.oauth2.Token">exchangeAuthorizationCode</a><span class="delimiter">(</span><a href="#85401" title="unfiltered.oauth2.Token">token</a><span class="delimiter">)</span>
                  <a href="responses.scala.html#85425" title="(accessToken: String, tokenType: Option[String], expiresIn: Option[Int], refreshToken: Option[String], scope: Seq[String], state: Option[String], extras: Iterable[(String, String)])unfiltered.oauth2.AccessTokenResponse">AccessTokenResponse</a><span class="delimiter">(</span>
                    <a href="#85412" title="unfiltered.oauth2.Token">t</a>.<a href="tokens.scala.html#85120" title="=&gt; String">value</a>, <a href="#85412" title="unfiltered.oauth2.Token">t</a>.<a href="tokens.scala.html#85124" title="=&gt; Option[String]">tokenType</a>, <a href="#85412" title="unfiltered.oauth2.Token">t</a>.<a href="tokens.scala.html#85126" title="=&gt; Option[Int]">expiresIn</a>, <a href="#85412" title="unfiltered.oauth2.Token">t</a>.<a href="tokens.scala.html#85125" title="=&gt; Option[String]">refresh</a>, <span title="scala.collection.immutable.Nil.type">Nil</span>, <span title="None.type">None</span>, <a href="#85412" title="unfiltered.oauth2.Token">t</a>.<a href="tokens.scala.html#85128" title="=&gt; Iterable[(String, String)]">extras</a>
                 <span class="delimiter">)</span>
                <span class="delimiter">}</span>
              <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><a href="#123878" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a>
                <a href="authorizations.scala.html#81315" title="=&gt; String">InvalidRequest</a>, <span title="String(&quot;unknown code&quot;)" class="string">&quot;unknown code&quot;</span>, <span title="None.type">None</span>, <span title="None.type">None</span>
              <span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><a href="#123886" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a>
          <a href="authorizations.scala.html#81315" title="=&gt; String">InvalidRequest</a>, <a href="#81235" title="=&gt; String">UnknownClientMsg</a>, <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81315" title="=&gt; String">InvalidRequest</a><span class="delimiter">)</span>, <span title="None.type">None</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">case</span> RefreshTokenRequest<a href="#123936" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="requests.scala.html#85500" title="String" id="85539">rToken</a>, <a href="requests.scala.html#85502" title="String" id="85540">clientId</a>, <a href="requests.scala.html#85504" title="String" id="85541">clientSecret</a>, <a href="requests.scala.html#85506" title="Seq[String]" id="85542">scope</a><span class="delimiter">)</span> =&gt;
        <a href="clients.scala.html#81240" title="(clientId: String, secret: Option[String])Option[unfiltered.oauth2.Client]">client</a><a href="#123942" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#85540" title="String">clientId</a>, <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#85541" title="String">clientSecret</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Some<a href="#123899" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a>c<span class="delimiter">)</span> =&gt;
             <a href="tokens.scala.html#81242" title="(refreshToken: String)Option[unfiltered.oauth2.Token]">refreshToken</a><a href="#123902" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#85539" title="String">rToken</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
               <span class="keyword">case</span> Some<a href="#123891" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#123892" title="unfiltered.oauth2.Token" id="85550">t</a><span class="delimiter">)</span> =&gt;
                 <a href="#123894" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="keyword">if</a><span class="delimiter">(</span><a href="#85550" title="unfiltered.oauth2.Token">t</a>.<a href="tokens.scala.html#85121" title="=&gt; String">clientId</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#85540" title="String">clientId</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                   <span class="keyword">val</span> <a title="unfiltered.oauth2.Token" id="85556">r</a> = <a href="tokens.scala.html#81241" title="(other: unfiltered.oauth2.Token)unfiltered.oauth2.Token">refresh</a><span class="delimiter">(</span><a href="#85550" title="unfiltered.oauth2.Token">t</a><span class="delimiter">)</span>
                   <a href="responses.scala.html#85425" title="(accessToken: String, tokenType: Option[String], expiresIn: Option[Int], refreshToken: Option[String], scope: Seq[String], state: Option[String], extras: Iterable[(String, String)])unfiltered.oauth2.AccessTokenResponse">AccessTokenResponse</a><span class="delimiter">(</span>
                     <a href="#85556" title="unfiltered.oauth2.Token">r</a>.<a href="tokens.scala.html#85120" title="=&gt; String">value</a>, <a href="#85556" title="unfiltered.oauth2.Token">r</a>.<a href="tokens.scala.html#85124" title="=&gt; Option[String]">tokenType</a>, <a href="#85556" title="unfiltered.oauth2.Token">r</a>.<a href="tokens.scala.html#85126" title="=&gt; Option[Int]">expiresIn</a>, <a href="#85556" title="unfiltered.oauth2.Token">r</a>.<a href="tokens.scala.html#85125" title="=&gt; Option[String]">refresh</a>, <a href="#85542" title="Seq[String]">scope</a>, <span title="None.type">None</span>, <a href="#85556" title="unfiltered.oauth2.Token">r</a>.<a href="tokens.scala.html#85128" title="=&gt; Iterable[(String, String)]">extras</a>
                   <span class="delimiter">)</span>
                 <span class="delimiter">}</span> <span class="keyword">else</span> <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><span class="delimiter">(</span>
                   <a href="authorizations.scala.html#81317" title="=&gt; String">UnauthorizedClient</a>, <span title="String(&quot;refresh token does not belong to client&quot;)" class="string">&quot;refresh token does not belong to client&quot;</span>,
                   <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81317" title="=&gt; String">UnauthorizedClient</a><span class="delimiter">)</span>, <span title="None.type">None</span>
                 <span class="delimiter">)</span>
               <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><a href="#123894" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a>
                 <a href="authorizations.scala.html#81315" title="=&gt; String">InvalidRequest</a>, <span title="String(&quot;unknown request token&quot;)" class="string">&quot;unknown request token&quot;</span>, <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81315" title="=&gt; String">InvalidRequest</a><span class="delimiter">)</span>, <span title="None.type">None</span><span class="delimiter">)</span>
             <span class="delimiter">}</span>
          <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><a href="#123902" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="authorizations.scala.html#81313" title="=&gt; String">InvalidClient</a>, <a href="#81235" title="=&gt; String">UnknownClientMsg</a>, <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81313" title="=&gt; String">InvalidClient</a><span class="delimiter">)</span>, <span title="None.type">None</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

    <span class="keyword">case</span> ClientCredentialsRequest<a href="#123936" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="requests.scala.html#85566" title="String" id="85599">clientId</a>, <a href="requests.scala.html#85568" title="String" id="85600">clientSecret</a>, <a href="requests.scala.html#85570" title="Seq[String]" id="85601">scope</a><span class="delimiter">)</span> =&gt;
      <a href="clients.scala.html#81240" title="(clientId: String, secret: Option[String])Option[unfiltered.oauth2.Client]">client</a><a href="#123942" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#85599" title="String">clientId</a>, <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#85600" title="String">clientSecret</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#123907" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#123908" title="unfiltered.oauth2.Client" id="85606">c</a><span class="delimiter">)</span> =&gt;
           <span class="keyword">val</span> <a title="unfiltered.oauth2.Token" id="85607">tok</a> = <a href="tokens.scala.html#81247" title="(client: unfiltered.oauth2.Client, scope: Seq[String])unfiltered.oauth2.Token">generateClientToken</a><span class="delimiter">(</span><a href="#85606" title="unfiltered.oauth2.Client">c</a>, <a href="#85601" title="Seq[String]">scope</a><span class="delimiter">)</span>
           <a href="responses.scala.html#85425" title="(accessToken: String, tokenType: Option[String], expiresIn: Option[Int], refreshToken: Option[String], scope: Seq[String], state: Option[String], extras: Iterable[(String, String)])unfiltered.oauth2.AccessTokenResponse">AccessTokenResponse</a><span class="delimiter">(</span>
             <a href="#85607" title="unfiltered.oauth2.Token">tok</a>.<a href="tokens.scala.html#85120" title="=&gt; String">value</a>, <a href="#85607" title="unfiltered.oauth2.Token">tok</a>.<a href="tokens.scala.html#85124" title="=&gt; Option[String]">tokenType</a>, <a href="#85607" title="unfiltered.oauth2.Token">tok</a>.<a href="tokens.scala.html#85126" title="=&gt; Option[Int]">expiresIn</a>, <a href="#85607" title="unfiltered.oauth2.Token">tok</a>.<a href="tokens.scala.html#85125" title="=&gt; Option[String]">refresh</a>,
             <span title="scala.collection.immutable.Nil.type">Nil</span>/* no scope for client */, <span title="None.type">None</span>/* no state for client*/, <a href="#85607" title="unfiltered.oauth2.Token">tok</a>.<a href="tokens.scala.html#85128" title="=&gt; Iterable[(String, String)]">extras</a>
           <span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><a href="#123910" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="authorizations.scala.html#81315" title="=&gt; String">InvalidRequest</a>, <a href="#81235" title="=&gt; String">UnknownClientMsg</a>, <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81313" title="=&gt; String">InvalidClient</a><span class="delimiter">)</span>, <span title="None.type">None</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">case</span> PasswordRequest<a href="#123936" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="requests.scala.html#85620" title="String" id="85665">userName</a>, <a href="requests.scala.html#85622" title="String" id="85666">password</a>, <a href="requests.scala.html#85624" title="String" id="85667">clientId</a>, <a href="requests.scala.html#85626" title="String" id="85668">clientSecret</a>, <a href="requests.scala.html#85628" title="Seq[String]" id="85669">scope</a><span class="delimiter">)</span> =&gt;
      <a href="clients.scala.html#81240" title="(clientId: String, secret: Option[String])Option[unfiltered.oauth2.Client]">client</a><a href="#123942" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#85667" title="String">clientId</a>, <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#85668" title="String">clientSecret</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#123928" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#123929" title="unfiltered.oauth2.Client" id="85674">c</a><span class="delimiter">)</span> =&gt;
          <a href="services.scala.html#81265" title="(userName: String, password: String)Option[unfiltered.oauth2.ResourceOwner]">resourceOwner</a><a href="#123931" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#85665" title="String">userName</a>, <a href="#85666" title="String">password</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> Some<a href="#123915" title="unfiltered.oauth2.AccessResponse" class="delimiter">(</a><a href="#123916" title="unfiltered.oauth2.ResourceOwner" id="85682">owner</a><span class="delimiter">)</span> =&gt;
              <span class="keyword">val</span> <a title="unfiltered.oauth2.Token" id="85683">tok</a> = <a href="tokens.scala.html#81248" title="(owner: unfiltered.oauth2.ResourceOwner, client: unfiltered.oauth2.Client, scope: Seq[String])unfiltered.oauth2.Token">generatePasswordToken</a><span class="delimiter">(</span><a href="#85682" title="unfiltered.oauth2.ResourceOwner">owner</a>, <a href="#85674" title="unfiltered.oauth2.Client">c</a>, <a href="#85669" title="Seq[String]">scope</a><span class="delimiter">)</span>
              <a href="responses.scala.html#85425" title="(accessToken: String, tokenType: Option[String], expiresIn: Option[Int], refreshToken: Option[String], scope: Seq[String], state: Option[String], extras: Iterable[(String, String)])unfiltered.oauth2.AccessTokenResponse">AccessTokenResponse</a><span class="delimiter">(</span>
                <a href="#85683" title="unfiltered.oauth2.Token">tok</a>.<a href="tokens.scala.html#85120" title="=&gt; String">value</a>, <a href="#85683" title="unfiltered.oauth2.Token">tok</a>.<a href="tokens.scala.html#85124" title="=&gt; Option[String]">tokenType</a>, <a href="#85683" title="unfiltered.oauth2.Token">tok</a>.<a href="tokens.scala.html#85126" title="=&gt; Option[Int]">expiresIn</a>, <a href="#85683" title="unfiltered.oauth2.Token">tok</a>.<a href="tokens.scala.html#85125" title="=&gt; Option[String]">refresh</a>, <a href="#85669" title="Seq[String]">scope</a>, <span title="None.type">None</span>, <a href="#85683" title="unfiltered.oauth2.Token">tok</a>.<a href="tokens.scala.html#85128" title="=&gt; Iterable[(String, String)]">extras</a>
              <span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="#123915" title="unfiltered.oauth2.AccessResponse">None</a> =&gt; <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><a href="#123920" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a>
              <a href="authorizations.scala.html#81315" title="=&gt; String">InvalidRequest</a>, <a href="authorizations.scala.html#81317" title="=&gt; String">UnauthorizedClient</a>, <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81313" title="=&gt; String">InvalidClient</a><span class="delimiter">)</span>, <span title="None.type">None</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> _ =&gt; <a href="responses.scala.html#81494" title="(error: String, desc: String, uri: Option[String], state: Option[String])unfiltered.oauth2.ErrorResponse">ErrorResponse</a><a href="#123931" title="(x: unfiltered.oauth2.AccessResponse)unfiltered.oauth2.AccessResponse" class="delimiter">(</a>
          <a href="authorizations.scala.html#81315" title="=&gt; String">InvalidRequest</a>, <a href="#81235" title="=&gt; String">UnknownClientMsg</a>, <a href="services.scala.html#81261" title="(error: String)Option[String]">errorUri</a><span class="delimiter">(</span><a href="authorizations.scala.html#81313" title="=&gt; String">InvalidClient</a><span class="delimiter">)</span>, <span title="None.type">None</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
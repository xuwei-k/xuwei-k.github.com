<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>actor/akka/io/TcpListener.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>

package akka.io

import java.nio.channels.<span class="delimiter">{</span> SocketChannel, SelectionKey, ServerSocketChannel <span class="delimiter">}</span>
import java.net.InetSocketAddress
import scala.annotation.tailrec
import scala.util.control.NonFatal
import akka.actor._
import akka.io.<a href="SelectionHandler.scala.html#akka.io.SelectionHandler" title="akka.io.SelectionHandler.type">SelectionHandler</a>._
import akka.io.<a href="Tcp.scala.html#akka.io.Tcp" title="akka.io.Tcp.type">Tcp</a>._
import akka.dispatch.<span class="delimiter">{</span> UnboundedMessageQueueSemantics, RequiresMessageQueue <span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>io<span class="delimiter">]</span> object <a title="akka.io.TcpListener.type" id="akka.io.TcpListener">TcpListener</a> <a href="#akka.io.TcpListener" title="akka.io.TcpListener.type" class="delimiter">{</a>

  final case class <a title="class RegisterIncoming extends AnyRef with akka.io.SelectionHandler.HasFailureMessage with akka.actor.NoSerializationVerificationNeeded with Product with Serializable" id="akka.io.TcpListener.RegisterIncoming.readResolve">RegisterIncoming</a><span title="Product" class="delimiter">(</span><a title="java.nio.channels.SocketChannel" id="akka.io.TcpListener;RegisterIncoming.channel">channel</a>: <span title="java.nio.channels.SocketChannel">SocketChannel</span><span class="delimiter">)</span> extends <a href="SelectionHandler.scala.html#akka.io.SelectionHandler;HasFailureMessage" title="akka.io.SelectionHandler.HasFailureMessage">HasFailureMessage</a> with <a href="../actor/Actor.scala.html#akka.actor;NoSerializationVerificationNeeded" title="akka.actor.NoSerializationVerificationNeeded">NoSerializationVerificationNeeded</a> <span class="delimiter">{</span>
    def <a title="=&gt; akka.io.TcpListener.FailedRegisterIncoming" id="akka.io.TcpListener;RegisterIncoming.failureMessage">failureMessage</a> = <a href="#akka.io.TcpListener.FailedRegisterIncoming.readResolve" title="(channel: java.nio.channels.SocketChannel)akka.io.TcpListener.FailedRegisterIncoming">FailedRegisterIncoming</a><span class="delimiter">(</span><a href="#akka.io.TcpListener;RegisterIncoming.channel" title="=&gt; java.nio.channels.SocketChannel">channel</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  final case class <a title="class FailedRegisterIncoming extends AnyRef with akka.actor.NoSerializationVerificationNeeded with Product with Serializable" id="akka.io.TcpListener.FailedRegisterIncoming.readResolve">FailedRegisterIncoming</a><span title="Product" class="delimiter">(</span><a title="java.nio.channels.SocketChannel" id="akka.io.TcpListener;FailedRegisterIncoming.channel">channel</a>: <span title="java.nio.channels.SocketChannel">SocketChannel</span><span class="delimiter">)</span> extends <a href="../actor/Actor.scala.html#akka.actor;NoSerializationVerificationNeeded" title="akka.actor.NoSerializationVerificationNeeded">NoSerializationVerificationNeeded</a>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>io<span class="delimiter">]</span> class <a title="class TcpListener extends AnyRef with akka.actor.Actor with akka.actor.ActorLogging with akka.dispatch.RequiresMessageQueue[akka.dispatch.UnboundedMessageQueueSemantics]" id="akka.io;TcpListener">TcpListener</a><a href="#akka.io;TcpListener" title="akka.io.TcpListener" class="delimiter">(</a><a title="akka.actor.ActorRef" id="akka.io;TcpListener.selectorRouter">selectorRouter</a>: <a href="../actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a>,
                              <a title="akka.io.TcpExt" id="akka.io;TcpListener.tcp">tcp</a>: <a href="Tcp.scala.html#akka.io;TcpExt" title="akka.io.TcpExt">TcpExt</a>,
                              <a title="akka.io.ChannelRegistry" id="akka.io;TcpListener.channelRegistry">channelRegistry</a>: <a href="SelectionHandler.scala.html#akka.io;ChannelRegistry" title="akka.io.ChannelRegistry">ChannelRegistry</a>,
                              <a title="akka.actor.ActorRef" id="akka.io;TcpListener.bindCommander">bindCommander</a>: <a href="../actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a>,
                              <a title="akka.io.Tcp.Bind" id="akka.io;TcpListener.bind">bind</a>: <a href="Tcp.scala.html#akka.io.Tcp;Bind" title="akka.io.Tcp.Bind">Bind</a><span class="delimiter">)</span>
  extends <a href="../actor/Actor.scala.html#akka.actor;Actor" title="akka.actor.Actor">Actor</a> with <a href="../actor/Actor.scala.html#akka.actor;ActorLogging" title="akka.actor.ActorLogging">ActorLogging</a> with <a href="../dispatch/Mailbox.scala.html#akka.dispatch;RequiresMessageQueue" title="akka.dispatch.RequiresMessageQueue[akka.dispatch.UnboundedMessageQueueSemantics]">RequiresMessageQueue</a><span class="delimiter">[</span>UnboundedMessageQueueSemantics<span class="delimiter">]</span> <span class="delimiter">{</span>

  import <a href="#akka.io.TcpListener" title="akka.io.TcpListener.type">TcpListener</a>._
  import <a href="#akka.io;TcpListener.tcp" title="akka.io.TcpExt">tcp</a>.<a href="Tcp.scala.html#akka.io;TcpExt.Settings" title="=&gt; TcpListener.this.tcp.Settings">Settings</a>._

  <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../actor/ActorCell.scala.html#akka.actor;ActorContext.watch" title="(subject: akka.actor.ActorRef)akka.actor.ActorRef">watch</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.handler" title="=&gt; akka.actor.ActorRef">handler</a><span class="delimiter">)</span> <span class="comment">// sign death pact</span>

  val <a title="java.nio.channels.ServerSocketChannel" id="akka.io;TcpListener.channel">channel</a> = <span title="java.nio.channels.ServerSocketChannel.type">ServerSocketChannel</span>.<span title="()java.nio.channels.ServerSocketChannel">open</span>
  <a href="#akka.io;TcpListener.channel" title="=&gt; java.nio.channels.ServerSocketChannel">channel</a>.<span title="(x$1: Boolean)java.nio.channels.SelectableChannel">configureBlocking</span><span class="delimiter">(</span>false<span class="delimiter">)</span>

  var <a title="Int" id="akka.io;TcpListener.acceptLimit_=">acceptLimit</a> = if <span class="delimiter">(</span><a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.pullMode" title="=&gt; Boolean">pullMode</a><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> else <a href="Tcp.scala.html#akka.io;TcpExt;Settings.BatchAcceptLimit" title="=&gt; Int">BatchAcceptLimit</a>

  val <a title="Any" id="akka.io;TcpListener.localAddress">localAddress</a> =
    try <span class="delimiter">{</span>
      val <a title="java.net.ServerSocket" id="akka.io;TcpListener.localAddress.socket">socket</a> = <a href="#akka.io;TcpListener.channel" title="=&gt; java.nio.channels.ServerSocketChannel">channel</a>.<span title="()java.net.ServerSocket">socket</span>
      <a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.options" title="=&gt; scala.collection.immutable.Traversable[akka.io.Inet.SocketOption]">options</a>.<span title="(f: akka.io.Inet.SocketOption =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#akka.io;TcpListener.localAddress.$anonfun.x$1" title="akka.io.Inet.SocketOption">_</a>.<a href="Inet.scala.html#akka.io.Inet;SocketOption.beforeServerSocketBind" title="(ss: java.net.ServerSocket)Unit">beforeServerSocketBind</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.localAddress.socket" title="java.net.ServerSocket">socket</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.io;TcpListener.localAddress.socket" title="java.net.ServerSocket">socket</a>.<span title="(x$1: java.net.SocketAddress, x$2: Int)Unit">bind</span><span class="delimiter">(</span><a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.localAddress" title="=&gt; java.net.InetSocketAddress">localAddress</a>, <a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.backlog" title="=&gt; Int">backlog</a><span class="delimiter">)</span>
      val <a title="java.net.InetSocketAddress" id="akka.io;TcpListener.localAddress.ret">ret</a> = <a href="#akka.io;TcpListener.localAddress.socket" title="java.net.ServerSocket">socket</a>.<span title="()java.net.SocketAddress">getLocalSocketAddress</span> match <span class="delimiter">{</span>
        case <a title="java.net.InetSocketAddress" id="akka.io;TcpListener.localAddress.ret.isa">isa</a>: <span title="java.net.InetSocketAddress">InetSocketAddress</span> â‡’ <a href="#akka.io;TcpListener.localAddress.ret.isa" title="java.net.InetSocketAddress">isa</a>
        case <a title="java.net.SocketAddress" id="akka.io;TcpListener.localAddress.ret.x">x</a>                      â‡’ throw new <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;bound to unknown SocketAddress [&quot;)">bound to unknown SocketAddress [$</span><a href="#akka.io;TcpListener.localAddress.ret.x" title="java.net.SocketAddress">x</a><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#akka.io;TcpListener.channelRegistry" title="akka.io.ChannelRegistry">channelRegistry</a>.<a href="SelectionHandler.scala.html#akka.io;ChannelRegistry.register" title="(channel: java.nio.channels.SelectableChannel, initialOps: Int)(implicit channelActor: akka.actor.ActorRef)Unit">register</a><a href="../actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef" class="delimiter">(</a><a href="#akka.io;TcpListener.channel" title="=&gt; java.nio.channels.ServerSocketChannel">channel</a>, if <span class="delimiter">(</span><a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.pullMode" title="=&gt; Boolean">pullMode</a><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> else SelectionKey.<span title="Int(16)">OP_ACCEPT</span><span class="delimiter">)</span>
      <a href="../actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../event/Logging.scala.html#akka.event;LoggingAdapter.debug(dc73c33c91)" title="(template: String, arg1: Any)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Successfully bound to {}&quot;)" class="string">&quot;Successfully bound to {}&quot;</span>, <a href="#akka.io;TcpListener.localAddress.ret" title="java.net.InetSocketAddress">ret</a><span class="delimiter">)</span>
      <a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.options" title="=&gt; scala.collection.immutable.Traversable[akka.io.Inet.SocketOption]">options</a>.<span title="(f: akka.io.Inet.SocketOption =&gt; Unit)Unit">foreach</span> <a href="#akka.io;TcpListener.localAddress.$anonfun.x0$1" title="Unit" class="delimiter">{</a>
        case <a title="akka.io.Inet.SocketOptionV2" id="akka.io;TcpListener.localAddress.$anonfun.o">o</a>: Inet.<a href="Inet.scala.html#akka.io.Inet;SocketOptionV2" title="akka.io.Inet.SocketOptionV2">SocketOptionV2</a> â‡’ <a href="#akka.io;TcpListener.localAddress.$anonfun.o" title="akka.io.Inet.SocketOptionV2">o</a>.<a href="Inet.scala.html#akka.io.Inet;SocketOptionV2.afterBind(d5a26cee7b)" title="(s: java.net.ServerSocket)Unit">afterBind</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.channel" title="=&gt; java.nio.channels.ServerSocketChannel">channel</a>.<span title="()java.net.ServerSocket">socket</span><span class="delimiter">)</span>
        case _                      â‡’
      <span class="delimiter">}</span>
      <a href="#akka.io;TcpListener.localAddress.ret" title="java.net.InetSocketAddress">ret</a>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a href="#akka.io;TcpListener.localAddress.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="akka.io;TcpListener.localAddress.e">e</a><span class="delimiter">)</span> â‡’
        <a href="../actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">bindCommander</a> <a href="../actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Command.failureMessage" title="=&gt; akka.io.Tcp.CommandFailed">failureMessage</a>
        <a href="../actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../event/Logging.scala.html#akka.event;LoggingAdapter.error(134e35740d)" title="(cause: Throwable, template: String, arg1: Any)Unit">error</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.localAddress.e" title="Throwable">e</a>, <span title="String(&quot;Bind failed for TCP channel on endpoint [{}]&quot;)" class="string">&quot;Bind failed for TCP channel on endpoint [{}]&quot;</span>, <a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.localAddress" title="=&gt; java.net.InetSocketAddress">localAddress</a><span class="delimiter">)</span>
        <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../actor/ActorRefProvider.scala.html#akka.actor;ActorRefFactory.stop" title="(actor: akka.actor.ActorRef)Unit">stop</a><span class="delimiter">(</span><a href="../actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  override def <a title="=&gt; akka.actor.SupervisorStrategy" id="akka.io;TcpListener.supervisorStrategy">supervisorStrategy</a> = <a href="SelectionHandler.scala.html#akka.io.SelectionHandler" title="akka.io.SelectionHandler.type">SelectionHandler</a>.<a href="SelectionHandler.scala.html#akka.io.SelectionHandler.connectionSupervisorStrategy" title="=&gt; akka.actor.SupervisorStrategy">connectionSupervisorStrategy</a>

  def <a title="=&gt; TcpListener.this.Receive" id="akka.io;TcpListener.receive">receive</a>: <span title="TcpListener.this.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.io;TcpListener.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case <a title="akka.io.ChannelRegistration" id="akka.io;TcpListener.receive;$anonfun.isDefinedAt.registration">registration</a>: <a href="SelectionHandler.scala.html#akka.io;ChannelRegistration" title="akka.io.ChannelRegistration">ChannelRegistration</a> â‡’
      <a href="../actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">bindCommander</a> <a href="../actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="Tcp.scala.html#akka.io.Tcp;Bound" title="(localAddress: java.net.InetSocketAddress)akka.io.Tcp.Bound">Bound</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.channel" title="=&gt; java.nio.channels.ServerSocketChannel">channel</a>.<span title="()java.net.ServerSocket">socket</span>.<span title="()java.net.SocketAddress">getLocalSocketAddress</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.net.InetSocketAddress" class="delimiter">[</span><span title="java.net.InetSocketAddress">InetSocketAddress</span><span class="delimiter">]</span><span class="delimiter">)</span>
      <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../actor/ActorCell.scala.html#akka.actor;ActorContext.become(07b70b901c)" title="(behavior: akka.actor.Actor.Receive)Unit">become</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.bound" title="(registration: akka.io.ChannelRegistration)TcpListener.this.Receive">bound</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.receive;$anonfun.isDefinedAt.registration" title="akka.io.ChannelRegistration">registration</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(registration: akka.io.ChannelRegistration)TcpListener.this.Receive" id="akka.io;TcpListener.bound">bound</a><span class="delimiter">(</span><a title="akka.io.ChannelRegistration" id="akka.io;TcpListener.bound.registration">registration</a>: <a href="SelectionHandler.scala.html#akka.io;ChannelRegistration" title="akka.io.ChannelRegistration">ChannelRegistration</a><span class="delimiter">)</span>: <span title="TcpListener.this.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.io;TcpListener.bound;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case <a href="SelectionHandler.scala.html#akka.io.SelectionHandler.ChannelAcceptable" title="akka.io.SelectionHandler.ChannelAcceptable.type">ChannelAcceptable</a> â‡’
      <a href="#akka.io;TcpListener.acceptLimit_=" title="(x$1: Int)Unit">acceptLimit</a> = <a href="#akka.io;TcpListener.acceptAllPending" title="(registration: akka.io.ChannelRegistration, limit: Int)Int">acceptAllPending</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.bound.registration" title="akka.io.ChannelRegistration">registration</a>, <a href="#akka.io;TcpListener.acceptLimit_=" title="=&gt; Int">acceptLimit</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#akka.io;TcpListener.acceptLimit_=" title="=&gt; Int">acceptLimit</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#akka.io;TcpListener.bound.registration" title="akka.io.ChannelRegistration">registration</a>.<a href="SelectionHandler.scala.html#akka.io;ChannelRegistration.enableInterest" title="(op: Int)Unit">enableInterest</a><span class="delimiter">(</span>SelectionKey.<span title="Int(16)">OP_ACCEPT</span><span class="delimiter">)</span>

    case ResumeAccepting<span class="delimiter">(</span><a title="Int" id="akka.io;TcpListener.bound;$anonfun.isDefinedAt.batchSize">batchSize</a><span class="delimiter">)</span> â‡’
      <a href="#akka.io;TcpListener.acceptLimit_=" title="(x$1: Int)Unit">acceptLimit</a> = <a href="#akka.io;TcpListener.bound;$anonfun.isDefinedAt.batchSize" title="Int">batchSize</a>
      <a href="#akka.io;TcpListener.bound.registration" title="akka.io.ChannelRegistration">registration</a>.<a href="SelectionHandler.scala.html#akka.io;ChannelRegistration.enableInterest" title="(op: Int)Unit">enableInterest</a><span class="delimiter">(</span>SelectionKey.<span title="Int(16)">OP_ACCEPT</span><span class="delimiter">)</span>

    case FailedRegisterIncoming<span class="delimiter">(</span><a title="java.nio.channels.SocketChannel" id="akka.io;TcpListener.bound;$anonfun.isDefinedAt.socketChannel">socketChannel</a><span class="delimiter">)</span> â‡’
      <a href="../actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../event/Logging.scala.html#akka.event;LoggingAdapter.warning(cc2e600322)" title="(message: String)Unit">warning</a><span class="delimiter">(</span><span title="String(&quot;Could not register incoming connection since selector capacity limit is reached, closing connection&quot;)" class="string">&quot;Could not register incoming connection since selector capacity limit is reached, closing connection&quot;</span><span class="delimiter">)</span>
      try <a href="#akka.io;TcpListener.bound;$anonfun.isDefinedAt.socketChannel" title="java.nio.channels.SocketChannel">socketChannel</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
      catch <span class="delimiter">{</span>
        case <a href="#akka.io;TcpListener.bound;$anonfun.applyOrElse.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="akka.io;TcpListener.bound;$anonfun.applyOrElse.e">e</a><span class="delimiter">)</span> â‡’ <a href="../actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../event/Logging.scala.html#akka.event;LoggingAdapter.debug(dc73c33c91)" title="(template: String, arg1: Any)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Error closing socket channel: {}&quot;)" class="string">&quot;Error closing socket channel: {}&quot;</span>, <a href="#akka.io;TcpListener.bound;$anonfun.applyOrElse.e" title="Throwable">e</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    case <a href="Tcp.scala.html#akka.io.Tcp.Unbind" title="akka.io.Tcp.Unbind.type">Unbind</a> â‡’
      <a href="../actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../event/Logging.scala.html#akka.event;LoggingAdapter.debug(dc73c33c91)" title="(template: String, arg1: Any)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Unbinding endpoint {}&quot;)" class="string">&quot;Unbinding endpoint {}&quot;</span>, <a href="#akka.io;TcpListener.localAddress" title="=&gt; Any">localAddress</a><span class="delimiter">)</span>
      <a href="#akka.io;TcpListener.channel" title="=&gt; java.nio.channels.ServerSocketChannel">channel</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="../actor/Actor.scala.html#akka.actor;Actor.sender" title="()akka.actor.ActorRef">sender</a><a href="../actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef" class="delimiter">(</a><span class="delimiter">)</span> <a href="../actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="Tcp.scala.html#akka.io.Tcp.Unbound" title="akka.io.Tcp.Unbound.type">Unbound</a>
      <a href="../actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../event/Logging.scala.html#akka.event;LoggingAdapter.debug(dc73c33c91)" title="(template: String, arg1: Any)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Unbound endpoint {}, stopping listener&quot;)" class="string">&quot;Unbound endpoint {}, stopping listener&quot;</span>, <a href="#akka.io;TcpListener.localAddress" title="=&gt; Any">localAddress</a><span class="delimiter">)</span>
      <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../actor/ActorRefProvider.scala.html#akka.actor;ActorRefFactory.stop" title="(actor: akka.actor.ActorRef)Unit">stop</a><span class="delimiter">(</span><a href="../actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  @tailrec final def <a title="(registration: akka.io.ChannelRegistration, limit: Int)Int" id="akka.io;TcpListener.acceptAllPending">acceptAllPending</a><span class="delimiter">(</span><a title="akka.io.ChannelRegistration" id="akka.io;TcpListener.acceptAllPending.registration">registration</a>: <a href="SelectionHandler.scala.html#akka.io;ChannelRegistration" title="akka.io.ChannelRegistration">ChannelRegistration</a>, <a title="Int" id="akka.io;TcpListener.acceptAllPending.limit">limit</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    val <a title="java.nio.channels.SocketChannel" id="akka.io;TcpListener.acceptAllPending.socketChannel">socketChannel</a> =
      if <span class="delimiter">(</span><a href="#akka.io;TcpListener.acceptAllPending.limit" title="Int">limit</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        try <a href="#akka.io;TcpListener.channel" title="=&gt; java.nio.channels.ServerSocketChannel">channel</a>.<span title="()java.nio.channels.SocketChannel">accept</span><span class="delimiter">(</span><span class="delimiter">)</span>
        catch <span class="delimiter">{</span>
          case <a href="#akka.io;TcpListener.acceptAllPending.socketChannel.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="akka.io;TcpListener.acceptAllPending.socketChannel.e">e</a><span class="delimiter">)</span> â‡’ <span class="delimiter">{</span> <a href="../actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../event/Logging.scala.html#akka.event;LoggingAdapter.error(de736aeaab)" title="(cause: Throwable, message: String)Unit">error</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.acceptAllPending.socketChannel.e" title="Throwable">e</a>, <span title="String(&quot;Accept error: could not accept new connection&quot;)" class="string">&quot;Accept error: could not accept new connection&quot;</span><span class="delimiter">)</span>; null <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> else null
    if <span class="delimiter">(</span><a href="#akka.io;TcpListener.acceptAllPending.socketChannel" title="java.nio.channels.SocketChannel">socketChannel</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../event/Logging.scala.html#akka.event;LoggingAdapter.debug(cc2e600322)" title="(message: String)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;New connection accepted&quot;)" class="string">&quot;New connection accepted&quot;</span><span class="delimiter">)</span>
      <a href="#akka.io;TcpListener.acceptAllPending.socketChannel" title="java.nio.channels.SocketChannel">socketChannel</a>.<span title="(x$1: Boolean)java.nio.channels.SelectableChannel">configureBlocking</span><span class="delimiter">(</span>false<span class="delimiter">)</span>
      def <a title="(registry: akka.io.ChannelRegistry)akka.actor.Props" id="akka.io;TcpListener.acceptAllPending.props">props</a><span class="delimiter">(</span><a title="akka.io.ChannelRegistry" id="akka.io;TcpListener.acceptAllPending.props.registry">registry</a>: <a href="SelectionHandler.scala.html#akka.io;ChannelRegistry" title="akka.io.ChannelRegistry">ChannelRegistry</a><span class="delimiter">)</span> =
        <a href="../actor/Props.scala.html#akka.actor.Props.apply(0870a176b3)" title="(clazz: Class[_], args: Any*)akka.actor.Props">Props</a><span class="delimiter">(</span>classOf<span title="Class[akka.io.TcpIncomingConnection](classOf[akka.io.TcpIncomingConnection])" class="delimiter">[</span>TcpIncomingConnection<span class="delimiter">]</span>, <a href="#akka.io;TcpListener.tcp" title="akka.io.TcpExt">tcp</a>, <a href="#akka.io;TcpListener.acceptAllPending.socketChannel" title="java.nio.channels.SocketChannel">socketChannel</a>, <a href="#akka.io;TcpListener.acceptAllPending.props.registry" title="akka.io.ChannelRegistry">registry</a>, <a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.handler" title="=&gt; akka.actor.ActorRef">handler</a>, <a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.options" title="=&gt; scala.collection.immutable.Traversable[akka.io.Inet.SocketOption]">options</a>, <a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.pullMode" title="=&gt; Boolean">pullMode</a><span class="delimiter">)</span>
      <a href="../actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">selectorRouter</a> <a href="../actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="SelectionHandler.scala.html#akka.io.SelectionHandler;WorkerForCommand" title="(apiCommand: akka.io.SelectionHandler.HasFailureMessage, commander: akka.actor.ActorRef, childProps: akka.io.ChannelRegistry =&gt; akka.actor.Props)akka.io.SelectionHandler.WorkerForCommand">WorkerForCommand</a><span class="delimiter">(</span><a href="#akka.io.TcpListener.RegisterIncoming.readResolve" title="(channel: java.nio.channels.SocketChannel)akka.io.TcpListener.RegisterIncoming">RegisterIncoming</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.acceptAllPending.socketChannel" title="java.nio.channels.SocketChannel">socketChannel</a><span class="delimiter">)</span>, <a href="../actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>, <a href="#akka.io;TcpListener.acceptAllPending.props" title="(registry: akka.io.ChannelRegistry)akka.actor.Props">props</a><span class="delimiter">)</span>
      <a href="#akka.io;TcpListener.acceptAllPending" title="(registration: akka.io.ChannelRegistration, limit: Int)Int">acceptAllPending</a><span class="delimiter">(</span><a href="#akka.io;TcpListener.acceptAllPending.registration" title="akka.io.ChannelRegistration">registration</a>, <a href="#akka.io;TcpListener.acceptAllPending.limit" title="Int">limit</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#akka.io;TcpListener.bind" title="akka.io.Tcp.Bind">bind</a>.<a href="Tcp.scala.html#akka.io.Tcp;Bind.pullMode" title="=&gt; Boolean">pullMode</a><span class="delimiter">)</span> <a href="#akka.io;TcpListener.acceptAllPending.limit" title="Int">limit</a> else <a href="Tcp.scala.html#akka.io;TcpExt;Settings.BatchAcceptLimit" title="=&gt; Int">BatchAcceptLimit</a>
  <span class="delimiter">}</span>

  override def <a title="()Unit" id="akka.io;TcpListener.postStop">postStop</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#akka.io;TcpListener.channel" title="=&gt; java.nio.channels.ServerSocketChannel">channel</a>.<span title="()Boolean">isOpen</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../event/Logging.scala.html#akka.event;LoggingAdapter.debug(cc2e600322)" title="(message: String)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Closing serverSocketChannel after being stopped&quot;)" class="string">&quot;Closing serverSocketChannel after being stopped&quot;</span><span class="delimiter">)</span>
        <a href="#akka.io;TcpListener.channel" title="=&gt; java.nio.channels.ServerSocketChannel">channel</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a href="#akka.io;TcpListener.postStop.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="akka.io;TcpListener.postStop.e">e</a><span class="delimiter">)</span> â‡’ <a href="../actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../event/Logging.scala.html#akka.event;LoggingAdapter.debug(dc73c33c91)" title="(template: String, arg1: Any)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Error closing ServerSocketChannel: {}&quot;)" class="string">&quot;Error closing ServerSocketChannel: {}&quot;</span>, <a href="#akka.io;TcpListener.postStop.e" title="Throwable">e</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>actor/akka/event/EventBusUnsubscribers.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
package akka.event

import akka.actor._
import akka.event.<a href="Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.simpleName
import java.util.concurrent.atomic.AtomicInteger

<span class="comment">/**
 * INTERNAL API
 *
 * Watches all actors which subscribe on the given eventStream, and unsubscribes them from it when they are Terminated.
 *
 * Assumptions note:
 * We do not guarantee happens-before in the EventStream when 2 threads subscribe(a) / unsubscribe(a) on the same actor,
 * thus the messages sent to this actor may appear to be reordered - this is fine, because the worst-case is starting to
 * needlessly watch the actor which will not cause trouble for the stream. This is a trade-off between slowing down
 * subscribe calls * because of the need of linearizing the history message sequence and the possibility of sometimes
 * watching a few actors too much - we opt for the 2nd choice here.
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> class <a title="class EventStreamUnsubscriber extends AnyRef with akka.actor.Actor" id="akka.event;EventStreamUnsubscriber">EventStreamUnsubscriber</a><a href="#akka.event;EventStreamUnsubscriber" title="akka.event.EventStreamUnsubscriber" class="delimiter">(</a><a title="akka.event.EventStream" id="akka.event;EventStreamUnsubscriber.eventStream">eventStream</a>: <a href="EventStream.scala.html#akka.event;EventStream" title="akka.event.EventStream">EventStream</a>, <a title="Boolean" id="akka.event.EventStreamUnsubscriber.<init>$default$2">debug</a>: <span title="Boolean">Boolean</span> = false<span class="delimiter">)</span> extends <a href="../actor/Actor.scala.html#akka.actor;Actor" title="akka.actor.Actor">Actor</a> <span class="delimiter">{</span>

  import <a href="#akka.event.EventStreamUnsubscriber" title="akka.event.EventStreamUnsubscriber.type">EventStreamUnsubscriber</a>._

  override def <a title="()Unit" id="akka.event;EventStreamUnsubscriber.preStart">preStart</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#akka.event.EventStreamUnsubscriber.<init>$default$2" title="Boolean">debug</a><span class="delimiter">)</span> <a href="#akka.event;EventStreamUnsubscriber.eventStream" title="akka.event.EventStream">eventStream</a>.<a href="EventBus.scala.html#akka.event;SubchannelClassification.publish(de973626dc)" title="(event: EventStreamUnsubscriber.this.eventStream.Event)Unit">publish</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.<a href="Logging.scala.html#akka.event.Logging;Debug" title="(logSource: String, logClass: Class[_], message: Any)akka.event.Logging.Debug">Debug</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging.simpleName(77f1808904)" title="(clazz: Class[_])String">simpleName</a><span class="delimiter">(</span><a href="#akka.event;EventStreamUnsubscriber" title="()Class[_]">getClass</a><span class="delimiter">)</span>, <a href="#akka.event;EventStreamUnsubscriber" title="()Class[_]">getClass</a>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;registering unsubscriber with &quot;)">registering unsubscriber with $</span><a href="#akka.event;EventStreamUnsubscriber.eventStream" title="akka.event.EventStream">eventStream</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#akka.event;EventStreamUnsubscriber.eventStream" title="akka.event.EventStream">eventStream</a> <a href="EventStream.scala.html#akka.event;EventStream.initUnsubscriber" title="(unsubscriber: akka.actor.ActorRef)Boolean">initUnsubscriber</a> <a href="../actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>
  <span class="delimiter">}</span>

  def <a title="=&gt; PartialFunction[Any,Unit]" id="akka.event;EventStreamUnsubscriber.receive">receive</a> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.event;EventStreamUnsubscriber.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case Register<span class="delimiter">(</span><span title="akka.actor.ActorRef">actor</span><span class="delimiter">)</span> ⇒
      if <span class="delimiter">(</span><a href="#akka.event.EventStreamUnsubscriber.<init>$default$2" title="Boolean">debug</a><span class="delimiter">)</span> <a href="#akka.event;EventStreamUnsubscriber.eventStream" title="akka.event.EventStream">eventStream</a>.<a href="EventBus.scala.html#akka.event;SubchannelClassification.publish(de973626dc)" title="(event: EventStreamUnsubscriber.this.eventStream.Event)Unit">publish</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.<a href="Logging.scala.html#akka.event.Logging;Debug" title="(logSource: String, logClass: Class[_], message: Any)akka.event.Logging.Debug">Debug</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging.simpleName(77f1808904)" title="(clazz: Class[_])String">simpleName</a><span class="delimiter">(</span><a href="#akka.event;EventStreamUnsubscriber" title="()Class[_]">getClass</a><span class="delimiter">)</span>, <a href="#akka.event;EventStreamUnsubscriber" title="()Class[_]">getClass</a>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;watching &quot;)">watching $</span><span title="akka.actor.ActorRef">actor</span><span title="String(&quot; in order to unsubscribe from EventStream when it terminates&quot;)" class="string"> in order to unsubscribe from EventStream when it terminates&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a> <a href="../actor/ActorCell.scala.html#akka.actor;ActorContext.watch" title="(subject: akka.actor.ActorRef)akka.actor.ActorRef">watch</a> <span title="akka.actor.ActorRef">actor</span>

    case UnregisterIfNoMoreSubscribedChannels<span class="delimiter">(</span><span title="akka.actor.ActorRef">actor</span><span class="delimiter">)</span> if <a href="#akka.event;EventStreamUnsubscriber.eventStream" title="akka.event.EventStream">eventStream</a>.<a href="EventBus.scala.html#akka.event;SubchannelClassification.hasSubscriptions" title="(subscriber: EventStreamUnsubscriber.this.eventStream.Subscriber)Boolean">hasSubscriptions</a><span class="delimiter">(</span><span title="akka.actor.ActorRef">actor</span><span class="delimiter">)</span> ⇒
    <span class="comment">// do nothing</span>
    <span class="comment">// hasSubscriptions can be slow, but it's better for this actor to take the hit than the EventStream</span>

    case UnregisterIfNoMoreSubscribedChannels<span class="delimiter">(</span><span title="akka.actor.ActorRef">actor</span><span class="delimiter">)</span> ⇒
      if <span class="delimiter">(</span><a href="#akka.event.EventStreamUnsubscriber.<init>$default$2" title="Boolean">debug</a><span class="delimiter">)</span> <a href="#akka.event;EventStreamUnsubscriber.eventStream" title="akka.event.EventStream">eventStream</a>.<a href="EventBus.scala.html#akka.event;SubchannelClassification.publish(de973626dc)" title="(event: EventStreamUnsubscriber.this.eventStream.Event)Unit">publish</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.<a href="Logging.scala.html#akka.event.Logging;Debug" title="(logSource: String, logClass: Class[_], message: Any)akka.event.Logging.Debug">Debug</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging.simpleName(77f1808904)" title="(clazz: Class[_])String">simpleName</a><span class="delimiter">(</span><a href="#akka.event;EventStreamUnsubscriber" title="()Class[_]">getClass</a><span class="delimiter">)</span>, <a href="#akka.event;EventStreamUnsubscriber" title="()Class[_]">getClass</a>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;unwatching &quot;)">unwatching $</span><span title="akka.actor.ActorRef">actor</span><span title="String(&quot;, since has no subscriptions&quot;)" class="string">, since has no subscriptions&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a> <a href="../actor/ActorCell.scala.html#akka.actor;ActorContext.unwatch" title="(subject: akka.actor.ActorRef)akka.actor.ActorRef">unwatch</a> <span title="akka.actor.ActorRef">actor</span>

    case Terminated<span class="delimiter">(</span><span title="akka.actor.ActorRef">actor</span><span class="delimiter">)</span> ⇒
      if <span class="delimiter">(</span><a href="#akka.event.EventStreamUnsubscriber.<init>$default$2" title="Boolean">debug</a><span class="delimiter">)</span> <a href="#akka.event;EventStreamUnsubscriber.eventStream" title="akka.event.EventStream">eventStream</a>.<a href="EventBus.scala.html#akka.event;SubchannelClassification.publish(de973626dc)" title="(event: EventStreamUnsubscriber.this.eventStream.Event)Unit">publish</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.<a href="Logging.scala.html#akka.event.Logging;Debug" title="(logSource: String, logClass: Class[_], message: Any)akka.event.Logging.Debug">Debug</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging.simpleName(77f1808904)" title="(clazz: Class[_])String">simpleName</a><span class="delimiter">(</span><a href="#akka.event;EventStreamUnsubscriber" title="()Class[_]">getClass</a><span class="delimiter">)</span>, <a href="#akka.event;EventStreamUnsubscriber" title="()Class[_]">getClass</a>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;unsubscribe &quot;)">unsubscribe $</span><span title="akka.actor.ActorRef">actor</span><span title="String(&quot; from &quot;)"> from $</span><a href="#akka.event;EventStreamUnsubscriber.eventStream" title="akka.event.EventStream">eventStream</a><span title="String(&quot;, because it was terminated&quot;)" class="string">, because it was terminated&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.event;EventStreamUnsubscriber.eventStream" title="akka.event.EventStream">eventStream</a> <a href="EventStream.scala.html#akka.event;EventStream.unsubscribe(134bd64d81)" title="(subscriber: akka.actor.ActorRef)Unit">unsubscribe</a> <span title="akka.actor.ActorRef">actor</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 *
 * Provides factory for [[akka.event.EventStreamUnsubscriber]] actors with **unique names**.
 * This is needed if someone spins up more [[EventStream]]s using the same [[akka.actor.ActorSystem]],
 * each stream gets it's own unsubscriber.
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> object <a title="akka.event.EventStreamUnsubscriber.type" id="akka.event.EventStreamUnsubscriber">EventStreamUnsubscriber</a> <a href="#akka.event.EventStreamUnsubscriber" title="akka.event.EventStreamUnsubscriber.type" class="delimiter">{</a>

  private val <a title="java.util.concurrent.atomic.AtomicInteger" id="akka.event.EventStreamUnsubscriber.unsubscribersCount">unsubscribersCount</a> = new <span title="java.util.concurrent.atomic.AtomicInteger">AtomicInteger</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

  final case class <a title="class Register extends AnyRef with Product with Serializable" id="akka.event.EventStreamUnsubscriber.Register.readResolve">Register</a><a href="#akka.event.EventStreamUnsubscriber.Register.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.ActorRef" id="akka.event.EventStreamUnsubscriber;Register.actor">actor</a>: <a href="../actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a><span class="delimiter">)</span>

  final case class <a title="class UnregisterIfNoMoreSubscribedChannels extends AnyRef with Product with Serializable" id="akka.event.EventStreamUnsubscriber.UnregisterIfNoMoreSubscribedChannels.readResolve">UnregisterIfNoMoreSubscribedChannels</a><a href="#akka.event.EventStreamUnsubscriber.UnregisterIfNoMoreSubscribedChannels.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.ActorRef" id="akka.event.EventStreamUnsubscriber;UnregisterIfNoMoreSubscribedChannels.actor">actor</a>: <a href="../actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a><span class="delimiter">)</span>

  private def <a title="(eventStream: akka.event.EventStream, debug: Boolean)akka.actor.Props" id="akka.event.EventStreamUnsubscriber.props">props</a><span class="delimiter">(</span><a title="akka.event.EventStream" id="akka.event.EventStreamUnsubscriber.props.eventStream">eventStream</a>: <a href="EventStream.scala.html#akka.event;EventStream" title="akka.event.EventStream">EventStream</a>, <a title="Boolean" id="akka.event.EventStreamUnsubscriber.props.debug">debug</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> =
    <a href="../actor/Props.scala.html#akka.actor.Props.apply(0870a176b3)" title="(clazz: Class[_], args: Any*)akka.actor.Props">Props</a><span class="delimiter">(</span>classOf<span title="Class[akka.event.EventStreamUnsubscriber](classOf[akka.event.EventStreamUnsubscriber])" class="delimiter">[</span>EventStreamUnsubscriber<span class="delimiter">]</span>, <a href="#akka.event.EventStreamUnsubscriber.props.eventStream" title="akka.event.EventStream">eventStream</a>, <a href="#akka.event.EventStreamUnsubscriber.props.debug" title="Boolean">debug</a><span class="delimiter">)</span>

  def <a title="(system: akka.actor.ActorSystem, stream: akka.event.EventStream)akka.actor.ActorRef" id="akka.event.EventStreamUnsubscriber.start">start</a><span class="delimiter">(</span><a title="akka.actor.ActorSystem" id="akka.event.EventStreamUnsubscriber.start.system">system</a>: <a href="../actor/ActorSystem.scala.html#akka.actor;ActorSystem" title="akka.actor.ActorSystem">ActorSystem</a>, <a title="akka.event.EventStream" id="akka.event.EventStreamUnsubscriber.start.stream">stream</a>: <a href="EventStream.scala.html#akka.event;EventStream" title="akka.event.EventStream">EventStream</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    val <a title="Boolean" id="akka.event.EventStreamUnsubscriber.start.debug">debug</a> = <a href="#akka.event.EventStreamUnsubscriber.start.system" title="akka.actor.ActorSystem">system</a>.<a href="../actor/ActorSystem.scala.html#akka.actor;ActorSystem.settings" title="=&gt; akka.actor.ActorSystem.Settings">settings</a>.<a href="../actor/ActorSystem.scala.html#akka.actor.ActorSystem;Settings.config" title="=&gt; com.typesafe.config.Config">config</a>.<span title="(x$1: String)Boolean">getBoolean</span><span class="delimiter">(</span><span title="String(&quot;akka.actor.debug.event-stream&quot;)" class="string">&quot;akka.actor.debug.event-stream&quot;</span><span class="delimiter">)</span>
    <a href="#akka.event.EventStreamUnsubscriber.start.system" title="akka.actor.ActorSystem">system</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.actor.ExtendedActorSystem" class="delimiter">[</span><a href="../actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem" title="akka.actor.ExtendedActorSystem">ExtendedActorSystem</a><span class="delimiter">]</span>
      .<a href="../actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem.systemActorOf" title="(props: akka.actor.Props, name: String)akka.actor.ActorRef">systemActorOf</a><span class="delimiter">(</span><a href="#akka.event.EventStreamUnsubscriber.props" title="(eventStream: akka.event.EventStream, debug: Boolean)akka.actor.Props">props</a><span class="delimiter">(</span><a href="#akka.event.EventStreamUnsubscriber.start.stream" title="akka.event.EventStream">stream</a>, <a href="#akka.event.EventStreamUnsubscriber.start.debug" title="Boolean">debug</a><span class="delimiter">)</span>, <span title="String(&quot;eventStreamUnsubscriber-&quot;)" class="string">&quot;eventStreamUnsubscriber-&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#akka.event.EventStreamUnsubscriber.unsubscribersCount" title="=&gt; java.util.concurrent.atomic.AtomicInteger">unsubscribersCount</a>.<span title="()Int">incrementAndGet</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 *
 * Watches all actors which subscribe on the given event stream, and unsubscribes them from it when they are Terminated.
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> class <a title="class ActorClassificationUnsubscriber extends AnyRef with akka.actor.Actor with akka.actor.Stash" id="akka.event;ActorClassificationUnsubscriber">ActorClassificationUnsubscriber</a><a href="#akka.event;ActorClassificationUnsubscriber" title="akka.event.ActorClassificationUnsubscriber" class="delimiter">(</a><a title="akka.event.ManagedActorClassification" id="akka.event;ActorClassificationUnsubscriber.bus">bus</a>: <a href="EventBus.scala.html#akka.event;ManagedActorClassification" title="akka.event.ManagedActorClassification">ManagedActorClassification</a>, <a title="Boolean" id="akka.event;ActorClassificationUnsubscriber.debug">debug</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> extends <a href="../actor/Actor.scala.html#akka.actor;Actor" title="akka.actor.Actor">Actor</a> with <a href="../actor/Stash.scala.html#akka.actor;Stash" title="akka.actor.Stash">Stash</a> <span class="delimiter">{</span>

  import <a href="#akka.event.ActorClassificationUnsubscriber" title="akka.event.ActorClassificationUnsubscriber.type">ActorClassificationUnsubscriber</a>._

  private var <a title="Int" id="akka.event;ActorClassificationUnsubscriber.atSeq_=">atSeq</a> = <span title="Int(0)" class="int">0</span>
  private def <a title="=&gt; Int" id="akka.event;ActorClassificationUnsubscriber.nextSeq">nextSeq</a> = <a href="#akka.event;ActorClassificationUnsubscriber.atSeq_=" title="=&gt; Int">atSeq</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>

  override def <a title="()Unit" id="akka.event;ActorClassificationUnsubscriber.preStart">preStart</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    super.<a href="../actor/Actor.scala.html#akka.actor;Actor.preStart" title="()Unit">preStart</a><span class="delimiter">(</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.event;ActorClassificationUnsubscriber.debug" title="Boolean">debug</a><span class="delimiter">)</span> <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a>.<a href="../actor/ActorSystem.scala.html#akka.actor;ActorSystem.eventStream" title="=&gt; akka.event.EventStream">eventStream</a>.<a href="EventBus.scala.html#akka.event;SubchannelClassification.publish(de973626dc)" title="(event: Object)Unit">publish</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.<a href="Logging.scala.html#akka.event.Logging;Debug" title="(logSource: String, logClass: Class[_], message: Any)akka.event.Logging.Debug">Debug</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging.simpleName(77f1808904)" title="(clazz: Class[_])String">simpleName</a><span class="delimiter">(</span><a href="#akka.event;ActorClassificationUnsubscriber" title="()Class[_]">getClass</a><span class="delimiter">)</span>, <a href="#akka.event;ActorClassificationUnsubscriber" title="()Class[_]">getClass</a>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;will monitor &quot;)">will monitor $</span><a href="#akka.event;ActorClassificationUnsubscriber.bus" title="akka.event.ManagedActorClassification">bus</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="=&gt; PartialFunction[Any,Unit]" id="akka.event;ActorClassificationUnsubscriber.receive">receive</a> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.event;ActorClassificationUnsubscriber.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case Register<span class="delimiter">(</span><span title="akka.actor.ActorRef">actor</span>, <span title="Int">seq</span><span class="delimiter">)</span> if <span title="Int">seq</span> <span title="(x: Int)Boolean">==</span> <a href="#akka.event;ActorClassificationUnsubscriber.nextSeq" title="=&gt; Int">nextSeq</a> ⇒
      if <span class="delimiter">(</span><a href="#akka.event;ActorClassificationUnsubscriber.debug" title="Boolean">debug</a><span class="delimiter">)</span> <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a>.<a href="../actor/ActorSystem.scala.html#akka.actor;ActorSystem.eventStream" title="=&gt; akka.event.EventStream">eventStream</a>.<a href="EventBus.scala.html#akka.event;SubchannelClassification.publish(de973626dc)" title="(event: Object)Unit">publish</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.<a href="Logging.scala.html#akka.event.Logging;Debug" title="(logSource: String, logClass: Class[_], message: Any)akka.event.Logging.Debug">Debug</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging.simpleName(77f1808904)" title="(clazz: Class[_])String">simpleName</a><span class="delimiter">(</span><a href="#akka.event;ActorClassificationUnsubscriber" title="()Class[_]">getClass</a><span class="delimiter">)</span>, <a href="#akka.event;ActorClassificationUnsubscriber" title="()Class[_]">getClass</a>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;registered watch for &quot;)">registered watch for $</span><span title="akka.actor.ActorRef">actor</span><span title="String(&quot; in &quot;)"> in $</span><a href="#akka.event;ActorClassificationUnsubscriber.bus" title="akka.event.ManagedActorClassification">bus</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a> <a href="../actor/ActorCell.scala.html#akka.actor;ActorContext.watch" title="(subject: akka.actor.ActorRef)akka.actor.ActorRef">watch</a> <span title="akka.actor.ActorRef">actor</span>
      <a href="#akka.event;ActorClassificationUnsubscriber.atSeq_=" title="(x$1: Int)Unit">atSeq</a> = <a href="#akka.event;ActorClassificationUnsubscriber.nextSeq" title="=&gt; Int">nextSeq</a>
      <a href="../actor/Stash.scala.html#akka.actor;StashSupport.unstashAll(aa97cb1b3d)" title="()Unit">unstashAll</a><span class="delimiter">(</span><span class="delimiter">)</span>

    case <a title="akka.event.ActorClassificationUnsubscriber.Register" id="akka.event;ActorClassificationUnsubscriber.receive;$anonfun.isDefinedAt.reg">reg</a>: <a href="#akka.event.ActorClassificationUnsubscriber.Register.readResolve" title="akka.event.ActorClassificationUnsubscriber.Register">Register</a> ⇒
      <a href="../actor/Stash.scala.html#akka.actor;StashSupport.stash" title="()Unit">stash</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span>

    case Unregister<span class="delimiter">(</span><span title="akka.actor.ActorRef">actor</span>, <span title="Int">seq</span><span class="delimiter">)</span> if <span title="Int">seq</span> <span title="(x: Int)Boolean">==</span> <a href="#akka.event;ActorClassificationUnsubscriber.nextSeq" title="=&gt; Int">nextSeq</a> ⇒
      if <span class="delimiter">(</span><a href="#akka.event;ActorClassificationUnsubscriber.debug" title="Boolean">debug</a><span class="delimiter">)</span> <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a>.<a href="../actor/ActorSystem.scala.html#akka.actor;ActorSystem.eventStream" title="=&gt; akka.event.EventStream">eventStream</a>.<a href="EventBus.scala.html#akka.event;SubchannelClassification.publish(de973626dc)" title="(event: Object)Unit">publish</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.<a href="Logging.scala.html#akka.event.Logging;Debug" title="(logSource: String, logClass: Class[_], message: Any)akka.event.Logging.Debug">Debug</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging.simpleName(77f1808904)" title="(clazz: Class[_])String">simpleName</a><span class="delimiter">(</span><a href="#akka.event;ActorClassificationUnsubscriber" title="()Class[_]">getClass</a><span class="delimiter">)</span>, <a href="#akka.event;ActorClassificationUnsubscriber" title="()Class[_]">getClass</a>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;unregistered watch of &quot;)">unregistered watch of $</span><span title="akka.actor.ActorRef">actor</span><span title="String(&quot; in &quot;)"> in $</span><a href="#akka.event;ActorClassificationUnsubscriber.bus" title="akka.event.ManagedActorClassification">bus</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a> <a href="../actor/ActorCell.scala.html#akka.actor;ActorContext.unwatch" title="(subject: akka.actor.ActorRef)akka.actor.ActorRef">unwatch</a> <span title="akka.actor.ActorRef">actor</span>
      <a href="#akka.event;ActorClassificationUnsubscriber.atSeq_=" title="(x$1: Int)Unit">atSeq</a> = <a href="#akka.event;ActorClassificationUnsubscriber.nextSeq" title="=&gt; Int">nextSeq</a>
      <a href="../actor/Stash.scala.html#akka.actor;StashSupport.unstashAll(aa97cb1b3d)" title="()Unit">unstashAll</a><span class="delimiter">(</span><span class="delimiter">)</span>

    case <a title="akka.event.ActorClassificationUnsubscriber.Unregister" id="akka.event;ActorClassificationUnsubscriber.receive;$anonfun.isDefinedAt.unreg">unreg</a>: <a href="#akka.event.ActorClassificationUnsubscriber.Unregister.readResolve" title="akka.event.ActorClassificationUnsubscriber.Unregister">Unregister</a> ⇒
      <a href="../actor/Stash.scala.html#akka.actor;StashSupport.stash" title="()Unit">stash</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span>

    case Terminated<span class="delimiter">(</span><span title="akka.actor.ActorRef">actor</span><span class="delimiter">)</span> ⇒
      if <span class="delimiter">(</span><a href="#akka.event;ActorClassificationUnsubscriber.debug" title="Boolean">debug</a><span class="delimiter">)</span> <a href="../actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a>.<a href="../actor/ActorSystem.scala.html#akka.actor;ActorSystem.eventStream" title="=&gt; akka.event.EventStream">eventStream</a>.<a href="EventBus.scala.html#akka.event;SubchannelClassification.publish(de973626dc)" title="(event: Object)Unit">publish</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.<a href="Logging.scala.html#akka.event.Logging;Debug" title="(logSource: String, logClass: Class[_], message: Any)akka.event.Logging.Debug">Debug</a><span class="delimiter">(</span><a href="Logging.scala.html#akka.event.Logging.simpleName(77f1808904)" title="(clazz: Class[_])String">simpleName</a><span class="delimiter">(</span><a href="#akka.event;ActorClassificationUnsubscriber" title="()Class[_]">getClass</a><span class="delimiter">)</span>, <a href="#akka.event;ActorClassificationUnsubscriber" title="()Class[_]">getClass</a>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;actor &quot;)">actor $</span><span title="akka.actor.ActorRef">actor</span><span title="String(&quot; has terminated, unsubscribing it from &quot;)"> has terminated, unsubscribing it from $</span><a href="#akka.event;ActorClassificationUnsubscriber.bus" title="akka.event.ManagedActorClassification">bus</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="comment">// the `unsubscribe` will trigger another `Unregister(actor, _)` message to this unsubscriber;</span>
      <span class="comment">// but since that actor is terminated, there cannot be any harm in processing an Unregister for it.</span>
      <a href="#akka.event;ActorClassificationUnsubscriber.bus" title="akka.event.ManagedActorClassification">bus</a> <a href="EventBus.scala.html#akka.event;ManagedActorClassification.unsubscribe(c173c16b4f)" title="(subscriber: ActorClassificationUnsubscriber.this.bus.Subscriber)Unit">unsubscribe</a> <span title="akka.actor.ActorRef">actor</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 *
 * Provides factory for [[akka.event.ActorClassificationUnsubscriber]] actors with **unique names**.
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> object <a title="akka.event.ActorClassificationUnsubscriber.type" id="akka.event.ActorClassificationUnsubscriber">ActorClassificationUnsubscriber</a> <a href="#akka.event.ActorClassificationUnsubscriber" title="akka.event.ActorClassificationUnsubscriber.type" class="delimiter">{</a>

  private val <a title="java.util.concurrent.atomic.AtomicInteger" id="akka.event.ActorClassificationUnsubscriber.unsubscribersCount">unsubscribersCount</a> = new <span title="java.util.concurrent.atomic.AtomicInteger">AtomicInteger</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

  final case class <a title="class Register extends AnyRef with Product with Serializable" id="akka.event.ActorClassificationUnsubscriber.Register.readResolve">Register</a><a href="#akka.event.ActorClassificationUnsubscriber.Register.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.ActorRef" id="akka.event.ActorClassificationUnsubscriber;Register.actor">actor</a>: <a href="../actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a>, <a title="Int" id="akka.event.ActorClassificationUnsubscriber;Register.seq">seq</a>: <span title="Int">Int</span><span class="delimiter">)</span>
  final case class <a title="class Unregister extends AnyRef with Product with Serializable" id="akka.event.ActorClassificationUnsubscriber.Unregister.readResolve">Unregister</a><a href="#akka.event.ActorClassificationUnsubscriber.Unregister.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.ActorRef" id="akka.event.ActorClassificationUnsubscriber;Unregister.actor">actor</a>: <a href="../actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a>, <a title="Int" id="akka.event.ActorClassificationUnsubscriber;Unregister.seq">seq</a>: <span title="Int">Int</span><span class="delimiter">)</span>

  def <a title="(system: akka.actor.ActorSystem, bus: akka.event.ManagedActorClassification, debug: Boolean)akka.actor.ActorRef" id="akka.event.ActorClassificationUnsubscriber.start">start</a><span class="delimiter">(</span><a title="akka.actor.ActorSystem" id="akka.event.ActorClassificationUnsubscriber.start.system">system</a>: <a href="../actor/ActorSystem.scala.html#akka.actor;ActorSystem" title="akka.actor.ActorSystem">ActorSystem</a>, <a title="akka.event.ManagedActorClassification" id="akka.event.ActorClassificationUnsubscriber.start.bus">bus</a>: <a href="EventBus.scala.html#akka.event;ManagedActorClassification" title="akka.event.ManagedActorClassification">ManagedActorClassification</a>, <a title="Boolean" id="akka.event.ActorClassificationUnsubscriber.start$default$3">debug</a>: <span title="Boolean">Boolean</span> = false<span class="delimiter">)</span> = <span class="delimiter">{</span>
    val <span title="Boolean">debug</span> = <a href="#akka.event.ActorClassificationUnsubscriber.start.system" title="akka.actor.ActorSystem">system</a>.<a href="../actor/ActorSystem.scala.html#akka.actor;ActorSystem.settings" title="=&gt; akka.actor.ActorSystem.Settings">settings</a>.<a href="../actor/ActorSystem.scala.html#akka.actor.ActorSystem;Settings.config" title="=&gt; com.typesafe.config.Config">config</a>.<span title="(x$1: String)Boolean">getBoolean</span><span class="delimiter">(</span><span title="String(&quot;akka.actor.debug.event-stream&quot;)" class="string">&quot;akka.actor.debug.event-stream&quot;</span><span class="delimiter">)</span>
    <a href="#akka.event.ActorClassificationUnsubscriber.start.system" title="akka.actor.ActorSystem">system</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.actor.ExtendedActorSystem" class="delimiter">[</span><a href="../actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem" title="akka.actor.ExtendedActorSystem">ExtendedActorSystem</a><span class="delimiter">]</span>
      .<a href="../actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem.systemActorOf" title="(props: akka.actor.Props, name: String)akka.actor.ActorRef">systemActorOf</a><span class="delimiter">(</span><a href="#akka.event.ActorClassificationUnsubscriber.props" title="(eventBus: akka.event.ManagedActorClassification, debug: Boolean)akka.actor.Props">props</a><span class="delimiter">(</span><a href="#akka.event.ActorClassificationUnsubscriber.start.bus" title="akka.event.ManagedActorClassification">bus</a>, <span title="Boolean">debug</span><span class="delimiter">)</span>, <span title="String(&quot;actorClassificationUnsubscriber-&quot;)" class="string">&quot;actorClassificationUnsubscriber-&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#akka.event.ActorClassificationUnsubscriber.unsubscribersCount" title="=&gt; java.util.concurrent.atomic.AtomicInteger">unsubscribersCount</a>.<span title="()Int">incrementAndGet</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="(eventBus: akka.event.ManagedActorClassification, debug: Boolean)akka.actor.Props" id="akka.event.ActorClassificationUnsubscriber.props">props</a><span class="delimiter">(</span><a title="akka.event.ManagedActorClassification" id="akka.event.ActorClassificationUnsubscriber.props.eventBus">eventBus</a>: <a href="EventBus.scala.html#akka.event;ManagedActorClassification" title="akka.event.ManagedActorClassification">ManagedActorClassification</a>, <a title="Boolean" id="akka.event.ActorClassificationUnsubscriber.props.debug">debug</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> = <a href="../actor/Props.scala.html#akka.actor.Props.apply(0870a176b3)" title="(clazz: Class[_], args: Any*)akka.actor.Props">Props</a><span class="delimiter">(</span>classOf<span title="Class[akka.event.ActorClassificationUnsubscriber](classOf[akka.event.ActorClassificationUnsubscriber])" class="delimiter">[</span>ActorClassificationUnsubscriber<span class="delimiter">]</span>, <a href="#akka.event.ActorClassificationUnsubscriber.props.eventBus" title="akka.event.ManagedActorClassification">eventBus</a>, <a href="#akka.event.ActorClassificationUnsubscriber.props.debug" title="Boolean">debug</a><span class="delimiter">)</span>

<span class="delimiter">}</span>


        </pre>
    </body>
</html>

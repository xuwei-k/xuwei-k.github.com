<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>distributed-data-experimental/akka/cluster/ddata/ORSet.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
package akka.cluster.ddata

import scala.annotation.tailrec
import scala.collection.immutable.TreeMap

import akka.cluster.Cluster
import akka.cluster.UniqueAddress
import akka.util.HashCode

<span class="comment">// TODO this class can be optimized, but I wanted to start with correct functionality and comparability with riak_dt_orswot</span>

object <a title="akka.cluster.ddata.ORSet.type" id="akka.cluster.ddata.ORSet.readResolve">ORSet</a> <a href="#akka.cluster.ddata.ORSet.readResolve" title="akka.cluster.ddata.ORSet.type" class="delimiter">{</a>
  private val <a title="akka.cluster.ddata.ORSet[Any]" id="akka.cluster.ddata.ORSet._empty">_empty</a>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[Any]">ORSet</a><span class="delimiter">[</span>Any<span class="delimiter">]</span> = new <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[Any]">ORSet</a><span class="delimiter">(</span><span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="scala.collection.immutable.Map[Any,Nothing]">empty</span>, <a href="VersionVector.scala.html#akka.cluster.ddata.VersionVector" title="akka.cluster.ddata.VersionVector.type">VersionVector</a>.<a href="VersionVector.scala.html#akka.cluster.ddata.VersionVector.empty" title="=&gt; akka.cluster.ddata.VersionVector">empty</a><span class="delimiter">)</span>
  def <a title="[A]=&gt; akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata.ORSet.empty">empty</a><span class="delimiter">[</span><a title="" id="akka.cluster.ddata.ORSet.empty;A">A</a><span class="delimiter">]</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#akka.cluster.ddata.ORSet._empty" title="=&gt; akka.cluster.ddata.ORSet[Any]">_empty</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.cluster.ddata.ORSet[A]" class="delimiter">[</span><a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>
  def <a title="()akka.cluster.ddata.ORSet[Any]" id="akka.cluster.ddata.ORSet.apply">apply</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[Any]">ORSet</a><span class="delimiter">[</span>Any<span class="delimiter">]</span> = <a href="#akka.cluster.ddata.ORSet._empty" title="=&gt; akka.cluster.ddata.ORSet[Any]">_empty</a>
  <span class="comment">/**
   * Java API
   */</span>
  def <a title="[A]()akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata.ORSet.create">create</a><span class="delimiter">[</span><a title="" id="akka.cluster.ddata.ORSet.create;A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#akka.cluster.ddata.ORSet.empty" title="[A]=&gt; akka.cluster.ddata.ORSet[A]">empty</a><span title="akka.cluster.ddata.ORSet[A]" class="delimiter">[</span><a href="#akka.cluster.ddata.ORSet.create;A" title="A">A</a><span class="delimiter">]</span>

  <span class="comment">/**
   * Extract the [[ORSet#elements]].
   */</span>
  def <a title="[A](s: akka.cluster.ddata.ORSet[A])Option[Set[A]]" id="akka.cluster.ddata.ORSet.unapply(a96225132a)">unapply</a><span class="delimiter">[</span><a title="" id="akka.cluster.ddata.ORSet.unapply(a96225132a);A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata.ORSet.unapply(a96225132a).s">s</a>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[Set[A]]">Option</span><span class="delimiter">[</span>Set<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="(x: Set[A])Some[Set[A]]">Some</span><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.unapply(a96225132a).s" title="akka.cluster.ddata.ORSet[A]">s</a>.<a href="#akka.cluster.ddata;ORSet.elements" title="=&gt; Set[A]">elements</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Extract the [[ORSet#elements]] of an `ORSet`.
   */</span>
  def <a title="(a: akka.cluster.ddata.ReplicatedData)Option[Set[Any]]" id="akka.cluster.ddata.ORSet.unapply(8ae11feff2)">unapply</a><span class="delimiter">(</span><a title="akka.cluster.ddata.ReplicatedData" id="akka.cluster.ddata.ORSet.unapply(8ae11feff2).a">a</a>: <a href="ReplicatedData.scala.html#akka.cluster.ddata;ReplicatedData" title="akka.cluster.ddata.ReplicatedData">ReplicatedData</a><span class="delimiter">)</span>: <span title="Option[Set[Any]]">Option</span><span class="delimiter">[</span>Set<span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#akka.cluster.ddata.ORSet.unapply(8ae11feff2).a" title="akka.cluster.ddata.ReplicatedData">a</a> match <span class="delimiter">{</span>
    case <a title="akka.cluster.ddata.ORSet[Any] @unchecked" id="akka.cluster.ddata.ORSet.unapply(8ae11feff2).s">s</a>: ORSet<span class="delimiter">[</span>Any<span class="delimiter">]</span> @<a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[Any] @unchecked">unchecked</a> ⇒ <span title="(x: Set[Any])Some[Set[Any]]">Some</span><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.unapply(8ae11feff2).s" title="akka.cluster.ddata.ORSet[Any] @unchecked">s</a>.<a href="#akka.cluster.ddata;ORSet.elements" title="=&gt; Set[Any]">elements</a><span class="delimiter">)</span>
    case _                        ⇒ <span title="None.type">None</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * INTERNAL API
   */</span>
  private<span class="delimiter">[</span>akka<span class="delimiter">]</span>type <a title="akka.cluster.ddata.VersionVector" id="akka.cluster.ddata.ORSet;Dot">Dot</a> = <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.VersionVector">VersionVector</a>

  <span class="comment">/**
   * INTERNAL API
   * Subtract the `vvector` from the `dot`.
   * What this means is that any (node, version) pair in
   * `dot` that is &amp;lt;= an entry in `vvector` is removed from `dot`.
   * Example [{a, 3}, {b, 2}, {d, 14}, {g, 22}] -
   *         [{a, 4}, {b, 1}, {c, 1}, {d, 14}, {e, 5}, {f, 2}] =
   *         [{b, 2}, {g, 22}]
   */</span>
  private<span class="delimiter">[</span>akka<span class="delimiter">]</span> def <a title="(dot: akka.cluster.ddata.ORSet.Dot, vvector: akka.cluster.ddata.VersionVector)akka.cluster.ddata.ORSet.Dot" id="akka.cluster.ddata.ORSet.subtractDots">subtractDots</a><span class="delimiter">(</span><a title="akka.cluster.ddata.ORSet.Dot" id="akka.cluster.ddata.ORSet.subtractDots.dot">dot</a>: <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.ORSet.Dot">Dot</a>, <a title="akka.cluster.ddata.VersionVector" id="akka.cluster.ddata.ORSet.subtractDots.vvector">vvector</a>: <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.VersionVector">VersionVector</a><span class="delimiter">)</span>: <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.ORSet.Dot">Dot</a> = <span class="delimiter">{</span>

    @tailrec def <a title="(remaining: List[(akka.cluster.UniqueAddress, Long)], acc: List[(akka.cluster.UniqueAddress, Long)])List[(akka.cluster.UniqueAddress, Long)]" id="akka.cluster.ddata.ORSet.subtractDots.dropDots">dropDots</a><span class="delimiter">(</span><a title="List[(akka.cluster.UniqueAddress, Long)]" id="akka.cluster.ddata.ORSet.subtractDots.dropDots.remaining">remaining</a>: <span title="List[(akka.cluster.UniqueAddress, Long)]">List</span><span class="delimiter">[</span><span class="delimiter">(</span>UniqueAddress, Long<span class="delimiter">)</span><span class="delimiter">]</span>, <a title="List[(akka.cluster.UniqueAddress, Long)]" id="akka.cluster.ddata.ORSet.subtractDots.dropDots.acc">acc</a>: <span title="List[(akka.cluster.UniqueAddress, Long)]">List</span><span class="delimiter">[</span><span class="delimiter">(</span>UniqueAddress, Long<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[(akka.cluster.UniqueAddress, Long)]">List</span><span class="delimiter">[</span><span class="delimiter">(</span>UniqueAddress, Long<span class="delimiter">)</span><span class="delimiter">]</span> =
      <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.remaining" title="List[(akka.cluster.UniqueAddress, Long)]">remaining</a> match <span class="delimiter">{</span>
        case <span title="scala.collection.immutable.Nil.type">Nil</span> ⇒ <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.acc" title="List[(akka.cluster.UniqueAddress, Long)]">acc</a>
        case <span class="delimiter">(</span><a title="(akka.cluster.UniqueAddress, Long)" id="akka.cluster.ddata.ORSet.subtractDots.dropDots.d">d</a> @ <span class="delimiter">(</span><a title="akka.cluster.UniqueAddress" id="akka.cluster.ddata.ORSet.subtractDots.dropDots.node">node</a>, <a title="Long" id="akka.cluster.ddata.ORSet.subtractDots.dropDots.v1">v1</a><span class="delimiter">)</span><span class="delimiter">)</span> :: <a title="List[(akka.cluster.UniqueAddress, Long)]" id="akka.cluster.ddata.ORSet.subtractDots.dropDots.rest">rest</a> ⇒
          <a href="#akka.cluster.ddata.ORSet.subtractDots.vvector" title="akka.cluster.ddata.VersionVector">vvector</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.versions" title="=&gt; scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">versions</a>.<span title="(key: akka.cluster.UniqueAddress)Option[Long]">get</span><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.node" title="akka.cluster.UniqueAddress">node</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><a title="Long" id="akka.cluster.ddata.ORSet.subtractDots.dropDots.v2">v2</a><span class="delimiter">)</span> if <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.v2" title="Long">v2</a> <span title="(x: Long)Boolean">&gt;=</span> <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.v1" title="Long">v1</a> ⇒
              <span class="comment">// dot is dominated by version vector, drop it</span>
              <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots" title="(remaining: List[(akka.cluster.UniqueAddress, Long)], acc: List[(akka.cluster.UniqueAddress, Long)])List[(akka.cluster.UniqueAddress, Long)]">dropDots</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.rest" title="List[(akka.cluster.UniqueAddress, Long)]">rest</a>, <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.acc" title="List[(akka.cluster.UniqueAddress, Long)]">acc</a><span class="delimiter">)</span>
            case _ ⇒
              <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots" title="(remaining: List[(akka.cluster.UniqueAddress, Long)], acc: List[(akka.cluster.UniqueAddress, Long)])List[(akka.cluster.UniqueAddress, Long)]">dropDots</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.rest" title="List[(akka.cluster.UniqueAddress, Long)]">rest</a>, <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.d" title="(akka.cluster.UniqueAddress, Long)">d</a> <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.x$1" title="(x: (akka.cluster.UniqueAddress, Long))List[(akka.cluster.UniqueAddress, Long)]">::</a> <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots.acc" title="List[(akka.cluster.UniqueAddress, Long)]">acc</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    val <a title="List[(akka.cluster.UniqueAddress, Long)]" id="akka.cluster.ddata.ORSet.subtractDots.newDots">newDots</a> = <a href="#akka.cluster.ddata.ORSet.subtractDots.dropDots" title="(remaining: List[(akka.cluster.UniqueAddress, Long)], acc: List[(akka.cluster.UniqueAddress, Long)])List[(akka.cluster.UniqueAddress, Long)]">dropDots</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.subtractDots.dot" title="akka.cluster.ddata.ORSet.Dot">dot</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.versions" title="=&gt; scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">versions</a>.<span title="=&gt; List[(akka.cluster.UniqueAddress, Long)]">toList</span>, <span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span>
    new <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.VersionVector">VersionVector</a><span class="delimiter">(</span>versions = <span title="scala.collection.immutable.TreeMap.type">TreeMap</span>.<span title="[A, B](implicit ord: Ordering[A])scala.collection.immutable.TreeMap[A,B]">empty</span><span title="(implicit ord: Ordering[akka.cluster.UniqueAddress])scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]" class="delimiter">[</span><a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;UniqueAddress" title="akka.cluster.UniqueAddress">UniqueAddress</a>, <span title="Long">Long</span><span class="delimiter">]</span> <span title="(xs: scala.collection.GenTraversableOnce[(akka.cluster.UniqueAddress, Long)])scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">++</span> <a href="#akka.cluster.ddata.ORSet.subtractDots.newDots" title="List[(akka.cluster.UniqueAddress, Long)]">newDots</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * INTERNAL API
   * @see [[ORSet#merge]]
   */</span>
  private<span class="delimiter">[</span>akka<span class="delimiter">]</span> def <a title="[A](commonKeys: Set[A], lhs: akka.cluster.ddata.ORSet[A], rhs: akka.cluster.ddata.ORSet[A])Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata.ORSet.mergeCommonKeys">mergeCommonKeys</a><span class="delimiter">[</span><a title="" id="akka.cluster.ddata.ORSet.mergeCommonKeys;A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Set[A]" id="akka.cluster.ddata.ORSet.mergeCommonKeys.commonKeys">commonKeys</a>: <span title="Set[A]">Set</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata.ORSet.mergeCommonKeys.lhs">lhs</a>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata.ORSet.mergeCommonKeys.rhs">rhs</a>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Map[A,akka.cluster.ddata.ORSet.Dot]">Map</span><span class="delimiter">[</span>A, ORSet.Dot<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.commonKeys" title="Set[A]">commonKeys</a>.<span title="(z: scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot])(op: (scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot], A) =&gt; scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot])scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">foldLeft</span><span class="delimiter">(</span><span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]" class="delimiter">[</span><a href="#akka.cluster.ddata.ORSet.mergeCommonKeys;A" title="A">A</a>, ORSet.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.ORSet.Dot">Dot</a><span class="delimiter">]</span><span class="delimiter">)</span> <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.x0$1" title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]" class="delimiter">{</a>
      case <span class="delimiter">(</span><a title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.acc">acc</a>, <a title="A" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.k">k</a><span class="delimiter">)</span> ⇒
        val <a title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.lhsDots">lhsDots</a> = <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.lhs" title="akka.cluster.ddata.ORSet[A]">lhs</a>.<a href="#akka.cluster.ddata;ORSet.elementsMap" title="(key: A)akka.cluster.ddata.ORSet.Dot">elementsMap</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.k" title="A">k</a><span class="delimiter">)</span>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.versions" title="=&gt; scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">versions</a>
        val <a title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.rhsDots">rhsDots</a> = <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.rhs" title="akka.cluster.ddata.ORSet[A]">rhs</a>.<a href="#akka.cluster.ddata;ORSet.elementsMap" title="(key: A)akka.cluster.ddata.ORSet.Dot">elementsMap</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.k" title="A">k</a><span class="delimiter">)</span>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.versions" title="=&gt; scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">versions</a>
        val <a title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDots">commonDots</a> = <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.lhsDots" title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">lhsDots</a>.<span title="(p: ((akka.cluster.UniqueAddress, Long)) =&gt; Boolean)scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">filter</span> <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDots.$anonfun.x0$2" title="Boolean" class="delimiter">{</a>
          case <span class="delimiter">(</span><a title="akka.cluster.UniqueAddress" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDots.$anonfun.thisDotNode">thisDotNode</a>, <a title="Long" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDots.$anonfun.v">v</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.rhsDots" title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">rhsDots</a>.<span title="(key: akka.cluster.UniqueAddress)Option[Long]">get</span><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDots.$anonfun.thisDotNode" title="akka.cluster.UniqueAddress">thisDotNode</a><span class="delimiter">)</span>.<span title="(p: Long =&gt; Boolean)Boolean">exists</span><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDots.$anonfun.$anonfun.x$2" title="Long">_</a> <span title="(x: Long)Boolean">==</span> <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDots.$anonfun.v" title="Long">v</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        val <a title="Iterable[akka.cluster.UniqueAddress]" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDotsKeys">commonDotsKeys</a> = <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDots" title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">commonDots</a>.<span title="=&gt; Iterable[akka.cluster.UniqueAddress]">keys</span>
        val lhsUniqueDots = <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.lhsDots" title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">lhsDots</a> <a title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.lhsUniqueDots">--</a> <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDotsKeys" title="Iterable[akka.cluster.UniqueAddress]">commonDotsKeys</a>
        val rhsUniqueDots = <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.rhsDots" title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">rhsDots</a> <a title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.rhsUniqueDots">--</a> <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDotsKeys" title="Iterable[akka.cluster.UniqueAddress]">commonDotsKeys</a>
        val <a title="akka.cluster.ddata.ORSet.Dot" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.lhsKeep">lhsKeep</a> = <a href="#akka.cluster.ddata.ORSet.readResolve" title="akka.cluster.ddata.ORSet.type">ORSet</a>.<a href="#akka.cluster.ddata.ORSet.subtractDots" title="(dot: akka.cluster.ddata.ORSet.Dot, vvector: akka.cluster.ddata.VersionVector)akka.cluster.ddata.ORSet.Dot">subtractDots</a><span class="delimiter">(</span>new <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.VersionVector">VersionVector</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.lhsUniqueDots" title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">lhsUniqueDots</a><span class="delimiter">)</span>, <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.rhs" title="akka.cluster.ddata.ORSet[A]">rhs</a>.<a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a><span class="delimiter">)</span>
        val <a title="akka.cluster.ddata.ORSet.Dot" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.rhsKeep">rhsKeep</a> = <a href="#akka.cluster.ddata.ORSet.readResolve" title="akka.cluster.ddata.ORSet.type">ORSet</a>.<a href="#akka.cluster.ddata.ORSet.subtractDots" title="(dot: akka.cluster.ddata.ORSet.Dot, vvector: akka.cluster.ddata.VersionVector)akka.cluster.ddata.ORSet.Dot">subtractDots</a><span class="delimiter">(</span>new <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.VersionVector">VersionVector</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.rhsUniqueDots" title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">rhsUniqueDots</a><span class="delimiter">)</span>, <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.lhs" title="akka.cluster.ddata.ORSet[A]">lhs</a>.<a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a><span class="delimiter">)</span>
        val <a title="akka.cluster.ddata.VersionVector" id="akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.merged">merged</a> = <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.lhsKeep" title="akka.cluster.ddata.ORSet.Dot">lhsKeep</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.merge" title="(that: akka.cluster.ddata.VersionVector)akka.cluster.ddata.VersionVector">merge</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.rhsKeep" title="akka.cluster.ddata.ORSet.Dot">rhsKeep</a><span class="delimiter">)</span>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.merge" title="(that: akka.cluster.ddata.VersionVector)akka.cluster.ddata.VersionVector">merge</a><span class="delimiter">(</span>new <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.VersionVector">VersionVector</a><span class="delimiter">(</span>versions = <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.commonDots" title="scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">commonDots</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="comment">// Perfectly possible that an item in both sets should be dropped</span>
        if <span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.merged" title="akka.cluster.ddata.VersionVector">merged</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.versions" title="=&gt; scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">versions</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.acc" title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">acc</a>
        else <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.acc" title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">acc</a>.<span title="(key: A, value: akka.cluster.ddata.ORSet.Dot)scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">updated</span><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.k" title="A">k</a>, <a href="#akka.cluster.ddata.ORSet.mergeCommonKeys.$anonfun.merged" title="akka.cluster.ddata.VersionVector">merged</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * INTERNAL API
   * @see [[ORSet#merge]]
   */</span>
  private<span class="delimiter">[</span>akka<span class="delimiter">]</span> def <a title="[A](keys: Set[A], elementsMap: Map[A,akka.cluster.ddata.ORSet.Dot], vvector: akka.cluster.ddata.VersionVector, accumulator: Map[A,akka.cluster.ddata.ORSet.Dot])Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata.ORSet.mergeDisjointKeys">mergeDisjointKeys</a><span class="delimiter">[</span><a title="" id="akka.cluster.ddata.ORSet.mergeDisjointKeys;A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Set[A]" id="akka.cluster.ddata.ORSet.mergeDisjointKeys.keys">keys</a>: <span title="Set[A]">Set</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata.ORSet.mergeDisjointKeys.elementsMap">elementsMap</a>: <span title="Map[A,akka.cluster.ddata.ORSet.Dot]">Map</span><span class="delimiter">[</span>A, ORSet.Dot<span class="delimiter">]</span>, <a title="akka.cluster.ddata.VersionVector" id="akka.cluster.ddata.ORSet.mergeDisjointKeys.vvector">vvector</a>: <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.VersionVector">VersionVector</a>,
                                         <a title="Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata.ORSet.mergeDisjointKeys.accumulator">accumulator</a>: <span title="Map[A,akka.cluster.ddata.ORSet.Dot]">Map</span><span class="delimiter">[</span>A, ORSet.Dot<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Map[A,akka.cluster.ddata.ORSet.Dot]">Map</span><span class="delimiter">[</span>A, ORSet.Dot<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.keys" title="Set[A]">keys</a>.<span title="(z: Map[A,akka.cluster.ddata.ORSet.Dot])(op: (Map[A,akka.cluster.ddata.ORSet.Dot], A) =&gt; Map[A,akka.cluster.ddata.ORSet.Dot])Map[A,akka.cluster.ddata.ORSet.Dot]">foldLeft</span><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.accumulator" title="Map[A,akka.cluster.ddata.ORSet.Dot]">accumulator</a><span class="delimiter">)</span> <a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.x0$3" title="Map[A,akka.cluster.ddata.ORSet.Dot]" class="delimiter">{</a>
      case <span class="delimiter">(</span><a title="Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.acc">acc</a>, <a title="A" id="akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.k">k</a><span class="delimiter">)</span> ⇒
        val <a title="akka.cluster.ddata.ORSet.Dot" id="akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.dots">dots</a> = <a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.elementsMap" title="(key: A)akka.cluster.ddata.ORSet.Dot">elementsMap</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.k" title="A">k</a><span class="delimiter">)</span>
        if <span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.vvector" title="akka.cluster.ddata.VersionVector">vvector</a> <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.>" title="(that: akka.cluster.ddata.VersionVector)Boolean">&gt;</a> <a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.dots" title="akka.cluster.ddata.ORSet.Dot">dots</a> <span title="(x: Boolean)Boolean">||</span> <a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.vvector" title="akka.cluster.ddata.VersionVector">vvector</a> <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.==(5ee00e394f)" title="(that: akka.cluster.ddata.VersionVector)Boolean">==</a> <a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.dots" title="akka.cluster.ddata.ORSet.Dot">dots</a><span class="delimiter">)</span>
          <a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.acc" title="Map[A,akka.cluster.ddata.ORSet.Dot]">acc</a>
        else <span class="delimiter">{</span>
          <span class="comment">// Optimise the set of stored dots to include only those unseen</span>
          val <a title="akka.cluster.ddata.ORSet.Dot" id="akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.newDots">newDots</a> = <a href="#akka.cluster.ddata.ORSet.subtractDots" title="(dot: akka.cluster.ddata.ORSet.Dot, vvector: akka.cluster.ddata.VersionVector)akka.cluster.ddata.ORSet.Dot">subtractDots</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.dots" title="akka.cluster.ddata.ORSet.Dot">dots</a>, <a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.vvector" title="akka.cluster.ddata.VersionVector">vvector</a><span class="delimiter">)</span>
          <a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.acc" title="Map[A,akka.cluster.ddata.ORSet.Dot]">acc</a>.<span title="(key: A, value: akka.cluster.ddata.ORSet.Dot)scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">updated</span><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.k" title="A">k</a>, <a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys.$anonfun.newDots" title="akka.cluster.ddata.ORSet.Dot">newDots</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Implements a 'Observed Remove Set' CRDT, also called a 'OR-Set'.
 * Elements can be added and removed any number of times. Concurrent add wins
 * over remove.
 *
 * It is not implemented as in the paper
 * &lt;a href=&quot;http://hal.upmc.fr/file/index/docid/555588/filename/techreport.pdf&quot;&gt;A comprehensive study of Convergent and Commutative Replicated Data Types&lt;/a&gt;.
 * This is more space efficient and doesn't accumulate garbage for removed elements.
 * It is described in the paper
 * &lt;a href=&quot;https://hal.inria.fr/file/index/docid/738680/filename/RR-8083.pdf&quot;&gt;An optimized conflict-free replicated set&lt;/a&gt;
 * The implementation is inspired by the Riak DT &lt;a href=&quot;https://github.com/basho/riak_dt/blob/develop/src/riak_dt_orswot.erl&quot;&gt;
 * riak_dt_orswot&lt;/a&gt;.
 *
 * The ORSet has a version vector that is incremented when an element is added to
 * the set. The `node -&amp;gt; count` pair for that increment is stored against the
 * element as its &quot;birth dot&quot;. Every time the element is re-added to the set,
 * its &quot;birth dot&quot; is updated to that of the `node -&amp;gt; count` version vector entry
 * resulting from the add. When an element is removed, we simply drop it, no tombstones.
 *
 * When an element exists in replica A and not replica B, is it because A added
 * it and B has not yet seen that, or that B removed it and A has not yet seen that?
 * In this implementation we compare the `dot` of the present element to the version vector
 * in the Set it is absent from. If the element dot is not &quot;seen&quot; by the Set version vector,
 * that means the other set has yet to see this add, and the item is in the merged
 * Set. If the Set version vector dominates the dot, that means the other Set has removed this
 * element already, and the item is not in the merged Set.
 *
 * This class is immutable, i.e. &quot;modifying&quot; methods return a new instance.
 */</span>
@SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
final class <a title="class ORSet[A] extends AnyRef with akka.cluster.ddata.ReplicatedData with akka.cluster.ddata.ReplicatedDataSerialization with akka.cluster.ddata.RemovedNodePruning" id="akka.cluster.ddata;ORSet">ORSet</a><span class="delimiter">[</span><a title="" id="akka.cluster.ddata;ORSet;A">A</a><span class="delimiter">]</span> private<span class="delimiter">[</span>akka<span class="delimiter">]</span> <span class="delimiter">(</span>
  private<span class="delimiter">[</span>akka<span class="delimiter">]</span> val <a title="Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata;ORSet.elementsMap">elementsMap</a>: <span title="Map[A,akka.cluster.ddata.ORSet.Dot]">Map</span><span class="delimiter">[</span>A, ORSet.Dot<span class="delimiter">]</span>,
  private<span class="delimiter">[</span>akka<span class="delimiter">]</span> val <a title="akka.cluster.ddata.VersionVector" id="akka.cluster.ddata;ORSet.vvector">vvector</a>: <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.VersionVector">VersionVector</a><span class="delimiter">)</span>
  extends <a href="ReplicatedData.scala.html#akka.cluster.ddata;ReplicatedData" title="akka.cluster.ddata.ReplicatedData">ReplicatedData</a> with <a href="ReplicatedData.scala.html#akka.cluster.ddata;ReplicatedDataSerialization" title="akka.cluster.ddata.ReplicatedDataSerialization">ReplicatedDataSerialization</a> with <a href="ReplicatedData.scala.html#akka.cluster.ddata;RemovedNodePruning" title="akka.cluster.ddata.RemovedNodePruning">RemovedNodePruning</a> <span class="delimiter">{</span>

  type <a title="akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet;T">T</a> = <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span>

  <span class="comment">/**
   * Scala API
   */</span>
  def <a title="=&gt; Set[A]" id="akka.cluster.ddata;ORSet.elements">elements</a>: <span title="Set[A]">Set</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>.<span title="=&gt; scala.collection.immutable.Set[A]">keySet</span>

  <span class="comment">/**
   * Java API
   */</span>
  def <a title="()java.util.Set[A]" id="akka.cluster.ddata;ORSet.getElements">getElements</a><span class="delimiter">(</span><span class="delimiter">)</span>: java.util.<span title="java.util.Set[A]">Set</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    import scala.collection.<span title="scala.collection.JavaConverters.type">JavaConverters</span>._
    <a href="#akka.cluster.ddata;ORSet.elements" title="(s: scala.collection.Set[A])scala.collection.convert.Decorators.AsJava[java.util.Set[A]]">elements</a>.<span title="=&gt; java.util.Set[A]">asJava</span>
  <span class="delimiter">}</span>

  def <a title="(a: A)Boolean" id="akka.cluster.ddata;ORSet.contains">contains</a><span class="delimiter">(</span><a title="A" id="akka.cluster.ddata;ORSet.contains.a">a</a>: <a href="#akka.cluster.ddata;ORSet;A" title="A">A</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>.<span title="(key: A)Boolean">contains</span><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.contains.a" title="A">a</a><span class="delimiter">)</span>

  def <a title="=&gt; Boolean" id="akka.cluster.ddata;ORSet.isEmpty">isEmpty</a>: <span title="Boolean">Boolean</span> = <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>.<span title="=&gt; Boolean">isEmpty</span>

  def <a title="=&gt; Int" id="akka.cluster.ddata;ORSet.size">size</a>: <span title="Int">Int</span> = <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>.<span title="=&gt; Int">size</span>

  <span class="comment">/**
   * Adds an element to the set
   */</span>
  def <a title="(element: A)(implicit node: akka.cluster.Cluster)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.+">+</a><span class="delimiter">(</span><a title="A" id="akka.cluster.ddata;ORSet.+.element">element</a>: <a href="#akka.cluster.ddata;ORSet;A" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span>implicit <a title="akka.cluster.Cluster" id="akka.cluster.ddata;ORSet.+.node">node</a>: <a href="../../../../cluster/akka/cluster/Cluster.scala.html#akka.cluster;Cluster" title="akka.cluster.Cluster">Cluster</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#akka.cluster.ddata;ORSet.add(78a49f9213)" title="(node: akka.cluster.Cluster, element: A)akka.cluster.ddata.ORSet[A]">add</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.+.node" title="akka.cluster.Cluster">node</a>, <a href="#akka.cluster.ddata;ORSet.+.element" title="A">element</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Adds an element to the set
   */</span>
  def <a title="(node: akka.cluster.Cluster, element: A)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.add(78a49f9213)">add</a><span class="delimiter">(</span><a title="akka.cluster.Cluster" id="akka.cluster.ddata;ORSet.add(78a49f9213).node">node</a>: <a href="../../../../cluster/akka/cluster/Cluster.scala.html#akka.cluster;Cluster" title="akka.cluster.Cluster">Cluster</a>, <a title="A" id="akka.cluster.ddata;ORSet.add(78a49f9213).element">element</a>: <a href="#akka.cluster.ddata;ORSet;A" title="A">A</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#akka.cluster.ddata;ORSet.add(1da810d452)" title="(node: akka.cluster.UniqueAddress, element: A)akka.cluster.ddata.ORSet[A]">add</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.add(78a49f9213).node" title="akka.cluster.Cluster">node</a>.<a href="../../../../cluster/akka/cluster/Cluster.scala.html#akka.cluster;Cluster.selfUniqueAddress" title="=&gt; akka.cluster.UniqueAddress">selfUniqueAddress</a>, <a href="#akka.cluster.ddata;ORSet.add(78a49f9213).element" title="A">element</a><span class="delimiter">)</span>

  <span class="comment">/**
   * INTERNAL API
   */</span>
  private<span class="delimiter">[</span>akka<span class="delimiter">]</span> def <a title="(node: akka.cluster.UniqueAddress, element: A)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.add(1da810d452)">add</a><span class="delimiter">(</span><a title="akka.cluster.UniqueAddress" id="akka.cluster.ddata;ORSet.add(1da810d452).node">node</a>: <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;UniqueAddress" title="akka.cluster.UniqueAddress">UniqueAddress</a>, <a title="A" id="akka.cluster.ddata;ORSet.add(1da810d452).element">element</a>: <a href="#akka.cluster.ddata;ORSet;A" title="A">A</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val newVvector = <a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a> <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.+(328a6d964b)" title="akka.cluster.ddata.VersionVector" id="akka.cluster.ddata;ORSet.add(1da810d452).newVvector">+</a> <a href="#akka.cluster.ddata;ORSet.add(1da810d452).node" title="akka.cluster.UniqueAddress">node</a>
    val <a title="akka.cluster.ddata.VersionVector" id="akka.cluster.ddata;ORSet.add(1da810d452).newDot">newDot</a> = new <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.VersionVector">VersionVector</a><span class="delimiter">(</span>versions = <span title="(elems: (akka.cluster.UniqueAddress, Long)*)(implicit ord: Ordering[akka.cluster.UniqueAddress])scala.collection.immutable.TreeMap[akka.cluster.UniqueAddress,Long]">TreeMap</span><span title="(implicit evidence$1: akka.cluster.UniqueAddress =&gt; Comparable[akka.cluster.UniqueAddress])scala.math.Ordering[akka.cluster.UniqueAddress]" class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.add(1da810d452).node" title="(self: akka.cluster.UniqueAddress)ArrowAssoc[akka.cluster.UniqueAddress]">node</a> <span title="(y: Long)(akka.cluster.UniqueAddress, Long)">-&gt;</span> <a href="#akka.cluster.ddata;ORSet.add(1da810d452).newVvector" title="akka.cluster.ddata.VersionVector">newVvector</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.versions" title="(key: akka.cluster.UniqueAddress)Long">versions</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.add(1da810d452).node" title="akka.cluster.UniqueAddress">node</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    new <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">(</span>elementsMap = <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>.<span title="(key: A, value: akka.cluster.ddata.ORSet.Dot)scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">updated</span><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.add(1da810d452).element" title="A">element</a>, <a href="#akka.cluster.ddata;ORSet.add(1da810d452).newDot" title="akka.cluster.ddata.VersionVector">newDot</a><span class="delimiter">)</span>, vvector = <a href="#akka.cluster.ddata;ORSet.add(1da810d452).newVvector" title="akka.cluster.ddata.VersionVector">newVvector</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Removes an element from the set.
   */</span>
  def <a title="(element: A)(implicit node: akka.cluster.Cluster)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.-">-</a><span class="delimiter">(</span><a title="A" id="akka.cluster.ddata;ORSet.-.element">element</a>: <a href="#akka.cluster.ddata;ORSet;A" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span>implicit <a title="akka.cluster.Cluster" id="akka.cluster.ddata;ORSet.-.node">node</a>: <a href="../../../../cluster/akka/cluster/Cluster.scala.html#akka.cluster;Cluster" title="akka.cluster.Cluster">Cluster</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#akka.cluster.ddata;ORSet.remove(78a49f9213)" title="(node: akka.cluster.Cluster, element: A)akka.cluster.ddata.ORSet[A]">remove</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.-.node" title="akka.cluster.Cluster">node</a>, <a href="#akka.cluster.ddata;ORSet.-.element" title="A">element</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Removes an element from the set.
   */</span>
  def <a title="(node: akka.cluster.Cluster, element: A)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.remove(78a49f9213)">remove</a><span class="delimiter">(</span><a title="akka.cluster.Cluster" id="akka.cluster.ddata;ORSet.remove(78a49f9213).node">node</a>: <a href="../../../../cluster/akka/cluster/Cluster.scala.html#akka.cluster;Cluster" title="akka.cluster.Cluster">Cluster</a>, <a title="A" id="akka.cluster.ddata;ORSet.remove(78a49f9213).element">element</a>: <a href="#akka.cluster.ddata;ORSet;A" title="A">A</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#akka.cluster.ddata;ORSet.remove(1da810d452)" title="(node: akka.cluster.UniqueAddress, element: A)akka.cluster.ddata.ORSet[A]">remove</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.remove(78a49f9213).node" title="akka.cluster.Cluster">node</a>.<a href="../../../../cluster/akka/cluster/Cluster.scala.html#akka.cluster;Cluster.selfUniqueAddress" title="=&gt; akka.cluster.UniqueAddress">selfUniqueAddress</a>, <a href="#akka.cluster.ddata;ORSet.remove(78a49f9213).element" title="A">element</a><span class="delimiter">)</span>

  <span class="comment">/**
   * INTERNAL API
   */</span>
  private<span class="delimiter">[</span>akka<span class="delimiter">]</span> def <a title="(node: akka.cluster.UniqueAddress, element: A)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.remove(1da810d452)">remove</a><span class="delimiter">(</span><a title="akka.cluster.UniqueAddress" id="akka.cluster.ddata;ORSet.remove(1da810d452).node">node</a>: <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;UniqueAddress" title="akka.cluster.UniqueAddress">UniqueAddress</a>, <a title="A" id="akka.cluster.ddata;ORSet.remove(1da810d452).element">element</a>: <a href="#akka.cluster.ddata;ORSet;A" title="A">A</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="#akka.cluster.ddata;ORSet.copy" title="(elementsMap: Map[A,akka.cluster.ddata.ORSet.Dot], vvector: akka.cluster.ddata.VersionVector)akka.cluster.ddata.ORSet[A]">copy</a><span class="delimiter">(</span>elementsMap = <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a> <span title="(key: A)scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">-</span> <a href="#akka.cluster.ddata;ORSet.remove(1da810d452).element" title="A">element</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Removes all elements from the set, but keeps the history.
   * This has the same result as using [[#remove]] for each
   * element, but it is more efficient.
   */</span>
  def <a title="(node: akka.cluster.Cluster)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.clear(6614d2a7d6)">clear</a><span class="delimiter">(</span><a title="akka.cluster.Cluster" id="akka.cluster.ddata;ORSet.clear(6614d2a7d6).node">node</a>: <a href="../../../../cluster/akka/cluster/Cluster.scala.html#akka.cluster;Cluster" title="akka.cluster.Cluster">Cluster</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#akka.cluster.ddata;ORSet.clear(c0adb2eda6)" title="(node: akka.cluster.UniqueAddress)akka.cluster.ddata.ORSet[A]">clear</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.clear(6614d2a7d6).node" title="akka.cluster.Cluster">node</a>.<a href="../../../../cluster/akka/cluster/Cluster.scala.html#akka.cluster;Cluster.selfUniqueAddress" title="=&gt; akka.cluster.UniqueAddress">selfUniqueAddress</a><span class="delimiter">)</span>

  <span class="comment">/**
   * INTERNAL API
   */</span>
  private<span class="delimiter">[</span>akka<span class="delimiter">]</span> def <a title="(node: akka.cluster.UniqueAddress)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.clear(c0adb2eda6)">clear</a><span class="delimiter">(</span><a title="akka.cluster.UniqueAddress" id="akka.cluster.ddata;ORSet.clear(c0adb2eda6).node">node</a>: <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;UniqueAddress" title="akka.cluster.UniqueAddress">UniqueAddress</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#akka.cluster.ddata;ORSet.copy" title="(elementsMap: Map[A,akka.cluster.ddata.ORSet.Dot], vvector: akka.cluster.ddata.VersionVector)akka.cluster.ddata.ORSet[A]">copy</a><span class="delimiter">(</span>elementsMap = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="scala.collection.immutable.Map[A,Nothing]">empty</span><span class="delimiter">)</span>

  <span class="comment">/**
   * When element is in this Set but not in that Set:
   * Compare the &quot;birth dot&quot; of the present element to the version vector in the Set it is absent from.
   * If the element dot is not &quot;seen&quot; by other Set version vector, that means the other set has yet to
   * see this add, and the element is to be in the merged Set.
   * If the other Set version vector dominates the dot, that means the other Set has removed
   * the element already, and the element is not to be in the merged Set.
   *
   * When element in both this Set and in that Set:
   * Some dots may still need to be shed. If this Set has dots that the other Set does not have,
   * and the other Set version vector dominates those dots, then we need to drop those dots.
   * Keep only common dots, and dots that are not dominated by the other sides version vector
   */</span>
  override def <a title="(that: akka.cluster.ddata.ORSet[A])akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.merge">merge</a><span class="delimiter">(</span><a title="akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.merge.that">that</a>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="scala.collection.immutable.Set[A]" id="akka.cluster.ddata;ORSet.merge.thisKeys">thisKeys</a> = <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>.<span title="=&gt; scala.collection.immutable.Set[A]">keySet</span>
    val <a title="scala.collection.immutable.Set[A]" id="akka.cluster.ddata;ORSet.merge.thatKeys">thatKeys</a> = <a href="#akka.cluster.ddata;ORSet.merge.that" title="akka.cluster.ddata.ORSet[A]">that</a>.<a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>.<span title="=&gt; scala.collection.immutable.Set[A]">keySet</span>
    val <a title="scala.collection.immutable.Set[A]" id="akka.cluster.ddata;ORSet.merge.commonKeys">commonKeys</a> = <a href="#akka.cluster.ddata;ORSet.merge.thisKeys" title="scala.collection.immutable.Set[A]">thisKeys</a>.<span title="(that: scala.collection.GenSet[A])scala.collection.immutable.Set[A]">intersect</span><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.merge.thatKeys" title="scala.collection.immutable.Set[A]">thatKeys</a><span class="delimiter">)</span>
    val thisUniqueKeys = <a href="#akka.cluster.ddata;ORSet.merge.thisKeys" title="scala.collection.immutable.Set[A]">thisKeys</a> <a title="scala.collection.immutable.Set[A]" id="akka.cluster.ddata;ORSet.merge.thisUniqueKeys">--</a> <a href="#akka.cluster.ddata;ORSet.merge.commonKeys" title="scala.collection.immutable.Set[A]">commonKeys</a>
    val thatUniqueKeys = <a href="#akka.cluster.ddata;ORSet.merge.thatKeys" title="scala.collection.immutable.Set[A]">thatKeys</a> <a title="scala.collection.immutable.Set[A]" id="akka.cluster.ddata;ORSet.merge.thatUniqueKeys">--</a> <a href="#akka.cluster.ddata;ORSet.merge.commonKeys" title="scala.collection.immutable.Set[A]">commonKeys</a>

    val <a title="Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata;ORSet.merge.entries00">entries00</a> = <a href="#akka.cluster.ddata.ORSet.readResolve" title="akka.cluster.ddata.ORSet.type">ORSet</a>.<a href="#akka.cluster.ddata.ORSet.mergeCommonKeys" title="(commonKeys: Set[A], lhs: akka.cluster.ddata.ORSet[A], rhs: akka.cluster.ddata.ORSet[A])Map[A,akka.cluster.ddata.ORSet.Dot]">mergeCommonKeys</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.merge.commonKeys" title="scala.collection.immutable.Set[A]">commonKeys</a>, this, <a href="#akka.cluster.ddata;ORSet.merge.that" title="akka.cluster.ddata.ORSet[A]">that</a><span class="delimiter">)</span>
    val <a title="Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata;ORSet.merge.entries0">entries0</a> = <a href="#akka.cluster.ddata.ORSet.readResolve" title="akka.cluster.ddata.ORSet.type">ORSet</a>.<a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys" title="(keys: Set[A], elementsMap: Map[A,akka.cluster.ddata.ORSet.Dot], vvector: akka.cluster.ddata.VersionVector, accumulator: Map[A,akka.cluster.ddata.ORSet.Dot])Map[A,akka.cluster.ddata.ORSet.Dot]">mergeDisjointKeys</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.merge.thisUniqueKeys" title="scala.collection.immutable.Set[A]">thisUniqueKeys</a>, this.<a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>, <a href="#akka.cluster.ddata;ORSet.merge.that" title="akka.cluster.ddata.ORSet[A]">that</a>.<a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a>, <a href="#akka.cluster.ddata;ORSet.merge.entries00" title="Map[A,akka.cluster.ddata.ORSet.Dot]">entries00</a><span class="delimiter">)</span>
    val <a title="Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata;ORSet.merge.entries">entries</a> = <a href="#akka.cluster.ddata.ORSet.readResolve" title="akka.cluster.ddata.ORSet.type">ORSet</a>.<a href="#akka.cluster.ddata.ORSet.mergeDisjointKeys" title="(keys: Set[A], elementsMap: Map[A,akka.cluster.ddata.ORSet.Dot], vvector: akka.cluster.ddata.VersionVector, accumulator: Map[A,akka.cluster.ddata.ORSet.Dot])Map[A,akka.cluster.ddata.ORSet.Dot]">mergeDisjointKeys</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.merge.thatUniqueKeys" title="scala.collection.immutable.Set[A]">thatUniqueKeys</a>, <a href="#akka.cluster.ddata;ORSet.merge.that" title="akka.cluster.ddata.ORSet[A]">that</a>.<a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>, this.<a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a>, <a href="#akka.cluster.ddata;ORSet.merge.entries0" title="Map[A,akka.cluster.ddata.ORSet.Dot]">entries0</a><span class="delimiter">)</span>
    val <a title="akka.cluster.ddata.VersionVector" id="akka.cluster.ddata;ORSet.merge.mergedVvector">mergedVvector</a> = this.<a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.merge" title="(that: akka.cluster.ddata.VersionVector)akka.cluster.ddata.VersionVector">merge</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.merge.that" title="akka.cluster.ddata.ORSet[A]">that</a>.<a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a><span class="delimiter">)</span>

    new <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.merge.entries" title="Map[A,akka.cluster.ddata.ORSet.Dot]">entries</a>, <a href="#akka.cluster.ddata;ORSet.merge.mergedVvector" title="akka.cluster.ddata.VersionVector">mergedVvector</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="(removedNode: akka.cluster.UniqueAddress)Boolean" id="akka.cluster.ddata;ORSet.needPruningFrom">needPruningFrom</a><span class="delimiter">(</span><a title="akka.cluster.UniqueAddress" id="akka.cluster.ddata;ORSet.needPruningFrom.removedNode">removedNode</a>: <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;UniqueAddress" title="akka.cluster.UniqueAddress">UniqueAddress</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
    <a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.needPruningFrom" title="(removedNode: akka.cluster.UniqueAddress)Boolean">needPruningFrom</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.needPruningFrom.removedNode" title="akka.cluster.UniqueAddress">removedNode</a><span class="delimiter">)</span>

  override def <a title="(removedNode: akka.cluster.UniqueAddress, collapseInto: akka.cluster.UniqueAddress)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.prune">prune</a><span class="delimiter">(</span><a title="akka.cluster.UniqueAddress" id="akka.cluster.ddata;ORSet.prune.removedNode">removedNode</a>: <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;UniqueAddress" title="akka.cluster.UniqueAddress">UniqueAddress</a>, <a title="akka.cluster.UniqueAddress" id="akka.cluster.ddata;ORSet.prune.collapseInto">collapseInto</a>: <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;UniqueAddress" title="akka.cluster.UniqueAddress">UniqueAddress</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata;ORSet.prune.pruned">pruned</a> = <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>.<span title="(z: scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot])(op: (scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot], (A, akka.cluster.ddata.ORSet.Dot)) =&gt; scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot])scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">foldLeft</span><span class="delimiter">(</span><span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]" class="delimiter">[</span><a href="#akka.cluster.ddata;ORSet;A" title="A">A</a>, ORSet.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.ORSet.Dot">Dot</a><span class="delimiter">]</span><span class="delimiter">)</span> <a href="#akka.cluster.ddata;ORSet.prune.pruned.$anonfun.x0$4" title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]" class="delimiter">{</a>
      case <span class="delimiter">(</span><a title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata;ORSet.prune.pruned.$anonfun.acc">acc</a>, <span class="delimiter">(</span><a title="A" id="akka.cluster.ddata;ORSet.prune.pruned.$anonfun.elem">elem</a>, <a title="akka.cluster.ddata.ORSet.Dot" id="akka.cluster.ddata;ORSet.prune.pruned.$anonfun.dot">dot</a><span class="delimiter">)</span><span class="delimiter">)</span> ⇒
        if <span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.prune.pruned.$anonfun.dot" title="akka.cluster.ddata.ORSet.Dot">dot</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.needPruningFrom" title="(removedNode: akka.cluster.UniqueAddress)Boolean">needPruningFrom</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.prune.removedNode" title="akka.cluster.UniqueAddress">removedNode</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#akka.cluster.ddata;ORSet.prune.pruned.$anonfun.acc" title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">acc</a>.<span title="(key: A, value: akka.cluster.ddata.ORSet.Dot)scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">updated</span><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.prune.pruned.$anonfun.elem" title="A">elem</a>, <a href="#akka.cluster.ddata;ORSet.prune.pruned.$anonfun.dot" title="akka.cluster.ddata.ORSet.Dot">dot</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.prune" title="(removedNode: akka.cluster.UniqueAddress, collapseInto: akka.cluster.UniqueAddress)akka.cluster.ddata.VersionVector">prune</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.prune.removedNode" title="akka.cluster.UniqueAddress">removedNode</a>, <a href="#akka.cluster.ddata;ORSet.prune.collapseInto" title="akka.cluster.UniqueAddress">collapseInto</a><span class="delimiter">)</span><span class="delimiter">)</span>
        else <a href="#akka.cluster.ddata;ORSet.prune.pruned.$anonfun.acc" title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">acc</a>
    <span class="delimiter">}</span>
    if <span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.prune.pruned" title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">pruned</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
      <a href="#akka.cluster.ddata;ORSet.copy$default$1" title="Map[A,akka.cluster.ddata.ORSet.Dot] @scala.reflect.internal.annotations.uncheckedBounds" id="akka.cluster.ddata;ORSet.prune.x$4">copy</a><span class="delimiter">(</span>vvector = <a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.prune" title="(removedNode: akka.cluster.UniqueAddress, collapseInto: akka.cluster.UniqueAddress)akka.cluster.ddata.VersionVector">prune</a><a title="akka.cluster.ddata.VersionVector" id="akka.cluster.ddata;ORSet.prune.x$3" class="delimiter">(</a><a href="#akka.cluster.ddata;ORSet.prune.removedNode" title="akka.cluster.UniqueAddress">removedNode</a>, <a href="#akka.cluster.ddata;ORSet.prune.collapseInto" title="akka.cluster.UniqueAddress">collapseInto</a><span class="delimiter">)</span><span class="delimiter">)</span>
    else <span class="delimiter">{</span>
      <span class="comment">// re-add elements that were pruned, to bump dots to right vvector</span>
      val <a title="akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.prune.newSet">newSet</a> = new <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">(</span>elementsMap = <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a> <span title="(xs: scala.collection.GenTraversableOnce[(A, akka.cluster.ddata.ORSet.Dot)])scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">++</span> <a href="#akka.cluster.ddata;ORSet.prune.pruned" title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">pruned</a>, vvector = <a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.prune" title="(removedNode: akka.cluster.UniqueAddress, collapseInto: akka.cluster.UniqueAddress)akka.cluster.ddata.VersionVector">prune</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.prune.removedNode" title="akka.cluster.UniqueAddress">removedNode</a>, <a href="#akka.cluster.ddata;ORSet.prune.collapseInto" title="akka.cluster.UniqueAddress">collapseInto</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.cluster.ddata;ORSet.prune.pruned" title="scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">pruned</a>.<span title="=&gt; Iterable[A]">keys</span>.<span title="(z: akka.cluster.ddata.ORSet[A])(op: (akka.cluster.ddata.ORSet[A], A) =&gt; akka.cluster.ddata.ORSet[A])akka.cluster.ddata.ORSet[A]">foldLeft</span><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.prune.newSet" title="akka.cluster.ddata.ORSet[A]">newSet</a><span class="delimiter">)</span> <a href="#akka.cluster.ddata;ORSet.prune.$anonfun.x0$5" title="akka.cluster.ddata.ORSet[A]" class="delimiter">{</a>
        case <span class="delimiter">(</span><a title="akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.prune.$anonfun.s">s</a>, <a title="A" id="akka.cluster.ddata;ORSet.prune.$anonfun.elem">elem</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.ddata;ORSet.prune.$anonfun.s" title="akka.cluster.ddata.ORSet[A]">s</a>.<a href="#akka.cluster.ddata;ORSet.add(1da810d452)" title="(node: akka.cluster.UniqueAddress, element: A)akka.cluster.ddata.ORSet[A]">add</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.prune.collapseInto" title="akka.cluster.UniqueAddress">collapseInto</a>, <a href="#akka.cluster.ddata;ORSet.prune.$anonfun.elem" title="A">elem</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  override def <a title="(removedNode: akka.cluster.UniqueAddress)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.pruningCleanup">pruningCleanup</a><span class="delimiter">(</span><a title="akka.cluster.UniqueAddress" id="akka.cluster.ddata;ORSet.pruningCleanup.removedNode">removedNode</a>: <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;UniqueAddress" title="akka.cluster.UniqueAddress">UniqueAddress</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata;ORSet.pruningCleanup.updated">updated</a> = <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>.<span title="(z: Map[A,akka.cluster.ddata.ORSet.Dot])(op: (Map[A,akka.cluster.ddata.ORSet.Dot], (A, akka.cluster.ddata.ORSet.Dot)) =&gt; Map[A,akka.cluster.ddata.ORSet.Dot])Map[A,akka.cluster.ddata.ORSet.Dot]">foldLeft</span><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a><span class="delimiter">)</span> <a href="#akka.cluster.ddata;ORSet.pruningCleanup.updated.$anonfun.x0$6" title="Map[A,akka.cluster.ddata.ORSet.Dot]" class="delimiter">{</a>
      case <span class="delimiter">(</span><a title="Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata;ORSet.pruningCleanup.updated.$anonfun.acc">acc</a>, <span class="delimiter">(</span><a title="A" id="akka.cluster.ddata;ORSet.pruningCleanup.updated.$anonfun.elem">elem</a>, <a title="akka.cluster.ddata.ORSet.Dot" id="akka.cluster.ddata;ORSet.pruningCleanup.updated.$anonfun.dot">dot</a><span class="delimiter">)</span><span class="delimiter">)</span> ⇒
        if <span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.pruningCleanup.updated.$anonfun.dot" title="akka.cluster.ddata.ORSet.Dot">dot</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.needPruningFrom" title="(removedNode: akka.cluster.UniqueAddress)Boolean">needPruningFrom</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.pruningCleanup.removedNode" title="akka.cluster.UniqueAddress">removedNode</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#akka.cluster.ddata;ORSet.pruningCleanup.updated.$anonfun.acc" title="Map[A,akka.cluster.ddata.ORSet.Dot]">acc</a>.<span title="(key: A, value: akka.cluster.ddata.ORSet.Dot)scala.collection.immutable.Map[A,akka.cluster.ddata.ORSet.Dot]">updated</span><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.pruningCleanup.updated.$anonfun.elem" title="A">elem</a>, <a href="#akka.cluster.ddata;ORSet.pruningCleanup.updated.$anonfun.dot" title="akka.cluster.ddata.ORSet.Dot">dot</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.pruningCleanup" title="(removedNode: akka.cluster.UniqueAddress)akka.cluster.ddata.VersionVector">pruningCleanup</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.pruningCleanup.removedNode" title="akka.cluster.UniqueAddress">removedNode</a><span class="delimiter">)</span><span class="delimiter">)</span>
        else <a href="#akka.cluster.ddata;ORSet.pruningCleanup.updated.$anonfun.acc" title="Map[A,akka.cluster.ddata.ORSet.Dot]">acc</a>
    <span class="delimiter">}</span>
    new <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.pruningCleanup.updated" title="Map[A,akka.cluster.ddata.ORSet.Dot]">updated</a>, <a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a>.<a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.pruningCleanup" title="(removedNode: akka.cluster.UniqueAddress)akka.cluster.ddata.VersionVector">pruningCleanup</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.pruningCleanup.removedNode" title="akka.cluster.UniqueAddress">removedNode</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="(elementsMap: Map[A,akka.cluster.ddata.ORSet.Dot], vvector: akka.cluster.ddata.VersionVector)akka.cluster.ddata.ORSet[A]" id="akka.cluster.ddata;ORSet.copy">copy</a><span class="delimiter">(</span><a title="Map[A,akka.cluster.ddata.ORSet.Dot]" id="akka.cluster.ddata;ORSet.copy$default$1">elementsMap</a>: <span title="Map[A,akka.cluster.ddata.ORSet.Dot]">Map</span><span class="delimiter">[</span>A, ORSet.Dot<span class="delimiter">]</span> = this.<a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>, <a title="akka.cluster.ddata.VersionVector" id="akka.cluster.ddata;ORSet.copy$default$2">vvector</a>: <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector" title="akka.cluster.ddata.VersionVector">VersionVector</a> = this.<a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a><span class="delimiter">)</span>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    new <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[A]">ORSet</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.copy$default$1" title="Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>, <a href="#akka.cluster.ddata;ORSet.copy$default$2" title="akka.cluster.ddata.VersionVector">vvector</a><span class="delimiter">)</span>

  <span class="comment">// this class cannot be a `case class` because we need different `unapply`</span>

  override def <a title="()String" id="akka.cluster.ddata;ORSet.toString">toString</a>: <span title="String">String</span> = <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;OR&quot;)">OR$</span><a href="#akka.cluster.ddata;ORSet.elements" title="=&gt; Set[A]">elements</a><span title="String(&quot;&quot;)" class="string">&quot;</span>

  override def <a title="(o: Any)Boolean" id="akka.cluster.ddata;ORSet.equals">equals</a><span class="delimiter">(</span><a title="Any" id="akka.cluster.ddata;ORSet.equals.o">o</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#akka.cluster.ddata;ORSet.equals.o" title="Any">o</a> match <span class="delimiter">{</span>
    case <a title="akka.cluster.ddata.ORSet[_]" id="akka.cluster.ddata;ORSet.equals.other">other</a>: <a href="#akka.cluster.ddata;ORSet" title="akka.cluster.ddata.ORSet[_]">ORSet</a><span class="delimiter">[</span>_<span class="delimiter">]</span> ⇒ <a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a> <a href="VersionVector.scala.html#akka.cluster.ddata;VersionVector.==(5ee00e394f)" title="(that: akka.cluster.ddata.VersionVector)Boolean">==</a> <a href="#akka.cluster.ddata;ORSet.equals.other" title="akka.cluster.ddata.ORSet[_]">other</a>.<a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a> <span title="(x$1: Any)Boolean">==</span> <a href="#akka.cluster.ddata;ORSet.equals.other" title="akka.cluster.ddata.ORSet[_]">other</a>.<a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[_,akka.cluster.ddata.ORSet.Dot]">elementsMap</a>
    case _               ⇒ false
  <span class="delimiter">}</span>

  override def <a title="()Int" id="akka.cluster.ddata;ORSet.hashCode">hashCode</a>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    var <a title="Int" id="akka.cluster.ddata;ORSet.hashCode.result">result</a> = <a href="../../../../actor/akka/util/HashCode.scala.html#akka.util.HashCode" title="akka.util.HashCode.type">HashCode</a>.<a href="../../../../actor/akka/util/HashCode.scala.html#akka.util.HashCode.SEED" title="=&gt; Int">SEED</a>
    <a href="#akka.cluster.ddata;ORSet.hashCode.result" title="Int">result</a> = <a href="../../../../actor/akka/util/HashCode.scala.html#akka.util.HashCode" title="akka.util.HashCode.type">HashCode</a>.<a href="../../../../actor/akka/util/HashCode.scala.html#akka.util.HashCode.hash(54166408db)" title="(seed: Int, any: Any)Int">hash</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.hashCode.result" title="Int">result</a>, <a href="#akka.cluster.ddata;ORSet.elementsMap" title="=&gt; Map[A,akka.cluster.ddata.ORSet.Dot]">elementsMap</a><span class="delimiter">)</span>
    <a href="#akka.cluster.ddata;ORSet.hashCode.result" title="Int">result</a> = <a href="../../../../actor/akka/util/HashCode.scala.html#akka.util.HashCode" title="akka.util.HashCode.type">HashCode</a>.<a href="../../../../actor/akka/util/HashCode.scala.html#akka.util.HashCode.hash(54166408db)" title="(seed: Int, any: Any)Int">hash</a><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSet.hashCode.result" title="Int">result</a>, <a href="#akka.cluster.ddata;ORSet.vvector" title="=&gt; akka.cluster.ddata.VersionVector">vvector</a><span class="delimiter">)</span>
    <a href="#akka.cluster.ddata;ORSet.hashCode.result" title="Int">result</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

object <a title="akka.cluster.ddata.ORSetKey.type" id="akka.cluster.ddata.ORSetKey.readResolve">ORSetKey</a> <a href="#akka.cluster.ddata.ORSetKey.readResolve" title="akka.cluster.ddata.ORSetKey.type" class="delimiter">{</a>
  def <a title="[A](id: String)akka.cluster.ddata.Key[akka.cluster.ddata.ORSet[A]]" id="akka.cluster.ddata.ORSetKey.create">create</a><span class="delimiter">[</span><a title="" id="akka.cluster.ddata.ORSetKey.create;A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="akka.cluster.ddata.ORSetKey.create.id">id</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="Key.scala.html#akka.cluster.ddata;Key" title="akka.cluster.ddata.Key[akka.cluster.ddata.ORSet[A]]">Key</a><span class="delimiter">[</span>ORSet<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#akka.cluster.ddata;ORSetKey.canEqual" title="(_id: String)akka.cluster.ddata.ORSetKey[A]">ORSetKey</a><span class="delimiter">(</span><a href="#akka.cluster.ddata.ORSetKey.create.id" title="String">id</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

@SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
final case class <a href="#akka.cluster.ddata;ORSetKey.copy$default$1" title="[A](_id: String)akka.cluster.ddata.ORSetKey[A]" id="akka.cluster.ddata;ORSetKey.canEqual">ORSetKey</a><span class="delimiter">[</span><a title="" id="akka.cluster.ddata;ORSetKey.copy$default$1;A">A</a><span class="delimiter">]</span><span title="Product" class="delimiter">(</span><a title="String" id="akka.cluster.ddata;ORSetKey.copy$default$1">_id</a>: <span title="String">String</span><span class="delimiter">)</span> extends <a href="Key.scala.html#akka.cluster.ddata;Key" title="akka.cluster.ddata.Key[akka.cluster.ddata.ORSet[A]]">Key</a><span class="delimiter">[</span>ORSet<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#akka.cluster.ddata;ORSetKey.copy$default$1" title="String">_id</a><span class="delimiter">)</span> with <a href="ReplicatedData.scala.html#akka.cluster.ddata;ReplicatedDataSerialization" title="akka.cluster.ddata.ReplicatedDataSerialization">ReplicatedDataSerialization</a>

        </pre>
    </body>
</html>

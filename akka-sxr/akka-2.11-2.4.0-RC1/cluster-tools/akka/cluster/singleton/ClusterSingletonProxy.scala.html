<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>cluster-tools/akka/cluster/singleton/ClusterSingletonProxy.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>

package akka.cluster.singleton

import akka.actor._
import akka.cluster.<span class="delimiter">{</span> MemberStatus, Cluster, Member <span class="delimiter">}</span>
import scala.collection.immutable
import akka.cluster.<a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent" title="akka.cluster.ClusterEvent.type">ClusterEvent</a>._
import akka.cluster.<a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent" title="akka.cluster.ClusterEvent.type">ClusterEvent</a>.MemberRemoved
import akka.cluster.<a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent" title="akka.cluster.ClusterEvent.type">ClusterEvent</a>.MemberUp
import akka.actor.RootActorPath
import akka.cluster.<a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent" title="akka.cluster.ClusterEvent.type">ClusterEvent</a>.CurrentClusterState
import akka.cluster.<a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent" title="akka.cluster.ClusterEvent.type">ClusterEvent</a>.MemberExited
import scala.concurrent.duration._
import scala.<span title="language.type">language</span>.postfixOps
import com.typesafe.config.Config
import akka.actor.NoSerializationVerificationNeeded
import akka.event.Logging

object <a title="akka.cluster.singleton.ClusterSingletonProxySettings.type" id="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> <a href="#akka.cluster.singleton.ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings.type" class="delimiter">{</a>

  <span class="comment">/**
   * Create settings from the default configuration
   * `akka.cluster.singleton-proxy`.
   */</span>
  def <a title="(system: akka.actor.ActorSystem)akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton.ClusterSingletonProxySettings.apply(519f9bc88e)">apply</a><span class="delimiter">(</span><a title="akka.actor.ActorSystem" id="akka.cluster.singleton.ClusterSingletonProxySettings.apply(519f9bc88e).system">system</a>: <a href="../../../../actor/akka/actor/ActorSystem.scala.html#akka.actor;ActorSystem" title="akka.actor.ActorSystem">ActorSystem</a><span class="delimiter">)</span>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> =
    <a href="#akka.cluster.singleton.ClusterSingletonProxySettings.apply(48db959c2e)" title="(config: com.typesafe.config.Config)akka.cluster.singleton.ClusterSingletonProxySettings">apply</a><span class="delimiter">(</span><a href="#akka.cluster.singleton.ClusterSingletonProxySettings.apply(519f9bc88e).system" title="akka.actor.ActorSystem">system</a>.<a href="../../../../actor/akka/actor/ActorSystem.scala.html#akka.actor;ActorSystem.settings" title="=&gt; akka.actor.ActorSystem.Settings">settings</a>.<a href="../../../../actor/akka/actor/ActorSystem.scala.html#akka.actor.ActorSystem;Settings.config" title="=&gt; com.typesafe.config.Config">config</a>.<span title="(x$1: String)com.typesafe.config.Config">getConfig</span><span class="delimiter">(</span><span title="String(&quot;akka.cluster.singleton-proxy&quot;)" class="string">&quot;akka.cluster.singleton-proxy&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Create settings from a configuration with the same layout as
   * the default configuration `akka.cluster.singleton-proxy`.
   */</span>
  def <a title="(config: com.typesafe.config.Config)akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton.ClusterSingletonProxySettings.apply(48db959c2e)">apply</a><span class="delimiter">(</span><a title="com.typesafe.config.Config" id="akka.cluster.singleton.ClusterSingletonProxySettings.apply(48db959c2e).config">config</a>: <span title="com.typesafe.config.Config">Config</span><span class="delimiter">)</span>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> =
    new <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a><span class="delimiter">(</span>
      singletonName = <a href="#akka.cluster.singleton.ClusterSingletonProxySettings.apply(48db959c2e).config" title="com.typesafe.config.Config">config</a>.<span title="(x$1: String)String">getString</span><span class="delimiter">(</span><span title="String(&quot;singleton-name&quot;)" class="string">&quot;singleton-name&quot;</span><span class="delimiter">)</span>,
      role = <a href="#akka.cluster.singleton.ClusterSingletonProxySettings.roleOption" title="(role: String)Option[String]">roleOption</a><span class="delimiter">(</span><a href="#akka.cluster.singleton.ClusterSingletonProxySettings.apply(48db959c2e).config" title="com.typesafe.config.Config">config</a>.<span title="(x$1: String)String">getString</span><span class="delimiter">(</span><span title="String(&quot;role&quot;)" class="string">&quot;role&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>,
      singletonIdentificationInterval = <a href="#akka.cluster.singleton.ClusterSingletonProxySettings.apply(48db959c2e).config" title="com.typesafe.config.Config">config</a>.<span title="(x$1: String, x$2: java.util.concurrent.TimeUnit)Long">getDuration</span><span title="implicit scala.concurrent.duration.package.DurationLong : (n: Long)concurrent.duration.DurationLong" class="delimiter">(</span><span title="String(&quot;singleton-identification-interval&quot;)" class="string">&quot;singleton-identification-interval&quot;</span>, <span title="java.util.concurrent.TimeUnit(MILLISECONDS)">MILLISECONDS</span><span class="delimiter">)</span>.<span title="=&gt; scala.concurrent.duration.FiniteDuration">millis</span>,
      bufferSize = <a href="#akka.cluster.singleton.ClusterSingletonProxySettings.apply(48db959c2e).config" title="com.typesafe.config.Config">config</a>.<span title="(x$1: String)Int">getInt</span><span class="delimiter">(</span><span title="String(&quot;buffer-size&quot;)" class="string">&quot;buffer-size&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Java API: Create settings from the default configuration
   * `akka.cluster.singleton-proxy`.
   */</span>
  def <a title="(system: akka.actor.ActorSystem)akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton.ClusterSingletonProxySettings.create(519f9bc88e)">create</a><span class="delimiter">(</span><a title="akka.actor.ActorSystem" id="akka.cluster.singleton.ClusterSingletonProxySettings.create(519f9bc88e).system">system</a>: <a href="../../../../actor/akka/actor/ActorSystem.scala.html#akka.actor;ActorSystem" title="akka.actor.ActorSystem">ActorSystem</a><span class="delimiter">)</span>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> = <a href="#akka.cluster.singleton.ClusterSingletonProxySettings.apply(519f9bc88e)" title="(system: akka.actor.ActorSystem)akka.cluster.singleton.ClusterSingletonProxySettings">apply</a><span class="delimiter">(</span><a href="#akka.cluster.singleton.ClusterSingletonProxySettings.create(519f9bc88e).system" title="akka.actor.ActorSystem">system</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Java API: Create settings from a configuration with the same layout as
   * the default configuration `akka.cluster.singleton-proxy`.
   */</span>
  def <a title="(config: com.typesafe.config.Config)akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton.ClusterSingletonProxySettings.create(48db959c2e)">create</a><span class="delimiter">(</span><a title="com.typesafe.config.Config" id="akka.cluster.singleton.ClusterSingletonProxySettings.create(48db959c2e).config">config</a>: <span title="com.typesafe.config.Config">Config</span><span class="delimiter">)</span>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> = <a href="#akka.cluster.singleton.ClusterSingletonProxySettings.apply(48db959c2e)" title="(config: com.typesafe.config.Config)akka.cluster.singleton.ClusterSingletonProxySettings">apply</a><span class="delimiter">(</span><a href="#akka.cluster.singleton.ClusterSingletonProxySettings.create(48db959c2e).config" title="com.typesafe.config.Config">config</a><span class="delimiter">)</span>

  <span class="comment">/**
   * INTERNAL API
   */</span>
  private<span class="delimiter">[</span>akka<span class="delimiter">]</span> def <a title="(role: String)Option[String]" id="akka.cluster.singleton.ClusterSingletonProxySettings.roleOption">roleOption</a><span class="delimiter">(</span><a title="String" id="akka.cluster.singleton.ClusterSingletonProxySettings.roleOption.role">role</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> =
    if <span class="delimiter">(</span><a href="#akka.cluster.singleton.ClusterSingletonProxySettings.roleOption.role" title="String">role</a> <span title="(x$1: Any)Boolean">==</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span title="None.type">None</span> else <span title="(x: String)Option[String]">Option</span><span class="delimiter">(</span><a href="#akka.cluster.singleton.ClusterSingletonProxySettings.roleOption.role" title="String">role</a><span class="delimiter">)</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * @param singletonName The actor name of the singleton actor that is started by the [[ClusterSingletonManager]].
 * @param role The role of the cluster nodes where the singleton can be deployed. If None, then any node will do.
 * @param singletonIdentificationInterval Interval at which the proxy will try to resolve the singleton instance.
 * @param bufferSize If the location of the singleton is unknown the proxy will buffer this number of messages
 *   and deliver them when the singleton is identified. When the buffer is full old messages will be dropped
 *   when new messages are sent viea the proxy. Use 0 to disable buffering, i.e. messages will be dropped
 *   immediately if the location of the singleton is unknown.
 */</span>
final class <a title="class ClusterSingletonProxySettings extends AnyRef with akka.actor.NoSerializationVerificationNeeded" id="akka.cluster.singleton;ClusterSingletonProxySettings">ClusterSingletonProxySettings</a><a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings" class="delimiter">(</a>
  val <a title="String" id="akka.cluster.singleton;ClusterSingletonProxySettings.singletonName">singletonName</a>: <span title="String">String</span>,
  val <a title="Option[String]" id="akka.cluster.singleton;ClusterSingletonProxySettings.role">role</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span>,
  val <a title="scala.concurrent.duration.FiniteDuration" id="akka.cluster.singleton;ClusterSingletonProxySettings.singletonIdentificationInterval">singletonIdentificationInterval</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span>,
  val <a title="Int" id="akka.cluster.singleton;ClusterSingletonProxySettings.bufferSize">bufferSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> extends <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;NoSerializationVerificationNeeded" title="akka.actor.NoSerializationVerificationNeeded">NoSerializationVerificationNeeded</a> <span class="delimiter">{</span>

  <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxySettings.bufferSize" title="=&gt; Int">bufferSize</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.bufferSize" title="=&gt; Int">bufferSize</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(10000)" class="int">10000</span>, <span title="String(&quot;bufferSize must be &gt;= 0 and &lt;= 10000&quot;)" class="string">&quot;bufferSize must be &gt;= 0 and &lt;= 10000&quot;</span><span class="delimiter">)</span>

  def <a title="(name: String)akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton;ClusterSingletonProxySettings.withSingletonName">withSingletonName</a><span class="delimiter">(</span><a title="String" id="akka.cluster.singleton;ClusterSingletonProxySettings.withSingletonName.name">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy" title="(singletonName: String, role: Option[String], singletonIdentificationInterval: scala.concurrent.duration.FiniteDuration, bufferSize: Int)akka.cluster.singleton.ClusterSingletonProxySettings">copy</a><span class="delimiter">(</span>singletonName = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.withSingletonName.name" title="String">name</a><span class="delimiter">)</span>

  def <a title="(role: String)akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton;ClusterSingletonProxySettings.withRole(c7c0c5b3a2)">withRole</a><span class="delimiter">(</span><a title="String" id="akka.cluster.singleton;ClusterSingletonProxySettings.withRole(c7c0c5b3a2).role">role</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$1" title="String" id="akka.cluster.singleton;ClusterSingletonProxySettings.withRole(c7c0c5b3a2).x$7">copy</a><span class="delimiter">(</span>role = <a href="#akka.cluster.singleton.ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings.type">ClusterSingletonProxySettings</a>.<a href="#akka.cluster.singleton.ClusterSingletonProxySettings.roleOption" title="(role: String)Option[String]">roleOption</a><a title="Option[String] @scala.reflect.internal.annotations.uncheckedBounds" id="akka.cluster.singleton;ClusterSingletonProxySettings.withRole(c7c0c5b3a2).x$4" class="delimiter">(</a><a href="#akka.cluster.singleton;ClusterSingletonProxySettings.withRole(c7c0c5b3a2).role" title="String">role</a><span class="delimiter">)</span><span class="delimiter">)</span>

  def <a title="(role: Option[String])akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton;ClusterSingletonProxySettings.withRole(4df0f2a916)">withRole</a><span class="delimiter">(</span><a title="Option[String]" id="akka.cluster.singleton;ClusterSingletonProxySettings.withRole(4df0f2a916).role">role</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$1" title="String" id="akka.cluster.singleton;ClusterSingletonProxySettings.withRole(4df0f2a916).x$11">copy</a><span class="delimiter">(</span>role = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.withRole(4df0f2a916).role" title="Option[String] @scala.reflect.internal.annotations.uncheckedBounds" id="akka.cluster.singleton;ClusterSingletonProxySettings.withRole(4df0f2a916).x$8">role</a><span class="delimiter">)</span>

  def <a title="(singletonIdentificationInterval: scala.concurrent.duration.FiniteDuration)akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton;ClusterSingletonProxySettings.withSingletonIdentificationInterval">withSingletonIdentificationInterval</a><span class="delimiter">(</span><a title="scala.concurrent.duration.FiniteDuration" id="akka.cluster.singleton;ClusterSingletonProxySettings.withSingletonIdentificationInterval.singletonIdentificationInterval">singletonIdentificationInterval</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span><span class="delimiter">)</span>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> =
    <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$1" title="String" id="akka.cluster.singleton;ClusterSingletonProxySettings.withSingletonIdentificationInterval.x$15">copy</a><span class="delimiter">(</span>singletonIdentificationInterval = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.withSingletonIdentificationInterval.singletonIdentificationInterval" title="scala.concurrent.duration.FiniteDuration" id="akka.cluster.singleton;ClusterSingletonProxySettings.withSingletonIdentificationInterval.x$12">singletonIdentificationInterval</a><span class="delimiter">)</span>

  def <a title="(bufferSize: Int)akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton;ClusterSingletonProxySettings.withBufferSize">withBufferSize</a><span class="delimiter">(</span><a title="Int" id="akka.cluster.singleton;ClusterSingletonProxySettings.withBufferSize.bufferSize">bufferSize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> =
    <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$1" title="String" id="akka.cluster.singleton;ClusterSingletonProxySettings.withBufferSize.x$19">copy</a><span class="delimiter">(</span>bufferSize = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.withBufferSize.bufferSize" title="Int" id="akka.cluster.singleton;ClusterSingletonProxySettings.withBufferSize.x$16">bufferSize</a><span class="delimiter">)</span>

  private def <a title="(singletonName: String, role: Option[String], singletonIdentificationInterval: scala.concurrent.duration.FiniteDuration, bufferSize: Int)akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton;ClusterSingletonProxySettings.copy">copy</a><span class="delimiter">(</span><a title="String" id="akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$1">singletonName</a>: <span title="String">String</span> = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$1" title="String">singletonName</a>,
                   <a title="Option[String]" id="akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$2">role</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$2" title="Option[String]">role</a>,
                   <a title="scala.concurrent.duration.FiniteDuration" id="akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$3">singletonIdentificationInterval</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span> = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$3" title="scala.concurrent.duration.FiniteDuration">singletonIdentificationInterval</a>,
                   <a title="Int" id="akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$4">bufferSize</a>: <span title="Int">Int</span> = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$4" title="Int">bufferSize</a><span class="delimiter">)</span>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a> =
    new <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$1" title="String">singletonName</a>, <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$2" title="Option[String]">role</a>, <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$3" title="scala.concurrent.duration.FiniteDuration">singletonIdentificationInterval</a>, <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.copy$default$4" title="Int">bufferSize</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

object <a title="akka.cluster.singleton.ClusterSingletonProxy.type" id="akka.cluster.singleton.ClusterSingletonProxy">ClusterSingletonProxy</a> <a href="#akka.cluster.singleton.ClusterSingletonProxy" title="akka.cluster.singleton.ClusterSingletonProxy.type" class="delimiter">{</a>
  <span class="comment">/**
   * Scala API: Factory method for `ClusterSingletonProxy` [[akka.actor.Props]].
   *
   * @param singletonManagerPath The logical path of the singleton manager, e.g. `/user/singletonManager`,
   *   which ends with the name you defined in `actorOf` when creating the [[ClusterSingletonManager]].
   * @param settings see [[ClusterSingletonProxySettings]]
   */</span>
  def <a title="(singletonManagerPath: String, settings: akka.cluster.singleton.ClusterSingletonProxySettings)akka.actor.Props" id="akka.cluster.singleton.ClusterSingletonProxy.props">props</a><span class="delimiter">(</span><a title="String" id="akka.cluster.singleton.ClusterSingletonProxy.props.singletonManagerPath">singletonManagerPath</a>: <span title="String">String</span>, <a title="akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton.ClusterSingletonProxy.props.settings">settings</a>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a><span class="delimiter">)</span>: <a href="../../../../actor/akka/actor/Props.scala.html#akka.actor;Props" title="akka.actor.Props">Props</a> =
    <a href="../../../../actor/akka/actor/Props.scala.html#akka.actor.Props.apply(b09a6a316b)" title="(creator: =&gt; akka.cluster.singleton.ClusterSingletonProxy)(implicit evidence$2: scala.reflect.ClassTag[akka.cluster.singleton.ClusterSingletonProxy])akka.actor.Props">Props</a><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[akka.cluster.singleton.ClusterSingletonProxy]" class="delimiter">(</span>new <a href="#akka.cluster.singleton;ClusterSingletonProxy" title="akka.cluster.singleton.ClusterSingletonProxy">ClusterSingletonProxy</a><span class="delimiter">(</span><a href="#akka.cluster.singleton.ClusterSingletonProxy.props.singletonManagerPath" title="String">singletonManagerPath</a>, <a href="#akka.cluster.singleton.ClusterSingletonProxy.props.settings" title="akka.cluster.singleton.ClusterSingletonProxySettings">settings</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../actor/akka/actor/Props.scala.html#akka.actor;Props.withDeploy" title="(d: akka.actor.Deploy)akka.actor.Props">withDeploy</a><span class="delimiter">(</span><a href="../../../../actor/akka/actor/Deployer.scala.html#akka.actor.Deploy" title="akka.actor.Deploy.type">Deploy</a>.<a href="../../../../actor/akka/actor/Deployer.scala.html#akka.actor.Deploy.local" title="=&gt; akka.actor.Deploy">local</a><span class="delimiter">)</span>

  private case object <a href="#akka.cluster.singleton.ClusterSingletonProxy.TryToIdentifySingleton.productElement.x$1" title="akka.cluster.singleton.ClusterSingletonProxy.TryToIdentifySingleton.type" id="akka.cluster.singleton.ClusterSingletonProxy.TryToIdentifySingleton.readResolve">TryToIdentifySingleton</a>

<a href="#akka.cluster.singleton.ClusterSingletonProxy.TryToIdentifySingleton.readResolve" title="akka.cluster.singleton.ClusterSingletonProxy.TryToIdentifySingleton.type" class="delimiter">}</a>

<span class="comment">/**
 * The `ClusterSingletonProxy` works together with the [[akka.cluster.singleton.ClusterSingletonManager]] to provide a
 * distributed proxy to the singleton actor.
 *
 * The proxy can be started on every node where the singleton needs to be reached and used as if it were the singleton
 * itself. It will then act as a router to the currently running singleton instance. If the singleton is not currently
 * available, e.g., during hand off or startup, the proxy will buffer the messages sent to the singleton and then deliver
 * them when the singleton is finally available. The size of the buffer is configurable and it can be disabled by using
 * a buffer size of 0. When the buffer is full old messages will be dropped when new messages are sent via the proxy.
 *
 * The proxy works by keeping track of the oldest cluster member. When a new oldest member is identified, e.g. because
 * the older one left the cluster, or at startup, the proxy will try to identify the singleton on the oldest member by
 * periodically sending an [[akka.actor.Identify]] message until the singleton responds with its
 * [[akka.actor.ActorIdentity]].
 *
 * Note that this is a best effort implementation: messages can always be lost due to the distributed nature of the
 * actors involved.
 */</span>
final class <a title="class ClusterSingletonProxy extends AnyRef with akka.actor.Actor with akka.actor.ActorLogging" id="akka.cluster.singleton;ClusterSingletonProxy">ClusterSingletonProxy</a><a href="#akka.cluster.singleton;ClusterSingletonProxy" title="akka.cluster.singleton.ClusterSingletonProxy" class="delimiter">(</a><a title="String" id="akka.cluster.singleton;ClusterSingletonProxy.singletonManagerPath">singletonManagerPath</a>: <span title="String">String</span>, <a title="akka.cluster.singleton.ClusterSingletonProxySettings" id="akka.cluster.singleton;ClusterSingletonProxy.settings">settings</a>: <a href="#akka.cluster.singleton;ClusterSingletonProxySettings" title="akka.cluster.singleton.ClusterSingletonProxySettings">ClusterSingletonProxySettings</a><span class="delimiter">)</span> extends <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor" title="akka.actor.Actor">Actor</a> with <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorLogging" title="akka.actor.ActorLogging">ActorLogging</a> <span class="delimiter">{</span>
  import <a href="#akka.cluster.singleton;ClusterSingletonProxy.settings" title="akka.cluster.singleton.ClusterSingletonProxySettings">settings</a>._
  val <a title="Array[String]" id="akka.cluster.singleton;ClusterSingletonProxy.singletonPath">singletonPath</a> = <span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.singletonManagerPath" title="String">singletonManagerPath</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.settings" title="akka.cluster.singleton.ClusterSingletonProxySettings">settings</a>.<a href="#akka.cluster.singleton;ClusterSingletonProxySettings.singletonName" title="=&gt; String">singletonName</a><span class="delimiter">)</span>.<span title="(x$1: String)Array[String]">split</span><span class="delimiter">(</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span class="delimiter">)</span>
  var <a title="Int" id="akka.cluster.singleton;ClusterSingletonProxy.identifyCounter_=">identifyCounter</a> = <span title="Int(0)" class="int">0</span>
  var <a title="String" id="akka.cluster.singleton;ClusterSingletonProxy.identifyId_=">identifyId</a> = <a href="#akka.cluster.singleton;ClusterSingletonProxy.createIdentifyId" title="(i: Int)String">createIdentifyId</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.identifyCounter_=" title="=&gt; Int">identifyCounter</a><span class="delimiter">)</span>
  def <a title="(i: Int)String" id="akka.cluster.singleton;ClusterSingletonProxy.createIdentifyId">createIdentifyId</a><span class="delimiter">(</span><a title="Int" id="akka.cluster.singleton;ClusterSingletonProxy.createIdentifyId.i">i</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span title="String(&quot;identify-singleton-&quot;)" class="string">&quot;identify-singleton-&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.singletonPath" title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]">singletonPath</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.createIdentifyId.i" title="Int">i</a>
  var <a title="Option[akka.actor.Cancellable]" id="akka.cluster.singleton;ClusterSingletonProxy.identifyTimer_=">identifyTimer</a>: <span title="Option[akka.actor.Cancellable]">Option</span><span class="delimiter">[</span>Cancellable<span class="delimiter">]</span> = <span title="None.type">None</span>

  val <a title="akka.cluster.Cluster" id="akka.cluster.singleton;ClusterSingletonProxy.cluster">cluster</a> = <a href="../../../../actor/akka/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.cluster.Cluster">Cluster</a><span class="delimiter">(</span><a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a><span class="delimiter">)</span>
  var <a title="Option[akka.actor.ActorRef]" id="akka.cluster.singleton;ClusterSingletonProxy.singleton_=">singleton</a>: <span title="Option[akka.actor.ActorRef]">Option</span><span class="delimiter">[</span>ActorRef<span class="delimiter">]</span> = <span title="None.type">None</span>
  <span class="comment">// sort by age, oldest first</span>
  val <a title="scala.math.Ordering[akka.cluster.Member]" id="akka.cluster.singleton;ClusterSingletonProxy.ageOrdering">ageOrdering</a> = <span title="=&gt; math.Ordering.type">Ordering</span>.<span title="[T](cmp: (T, T) =&gt; Boolean)scala.math.Ordering[T]">fromLessThan</span><span title="(cmp: (akka.cluster.Member, akka.cluster.Member) =&gt; Boolean)scala.math.Ordering[akka.cluster.Member]" class="delimiter">[</span><a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;Member" title="akka.cluster.Member">Member</a><span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="delimiter">(</span><a title="akka.cluster.Member" id="akka.cluster.singleton;ClusterSingletonProxy.ageOrdering.$anonfun.a">a</a>, <a title="akka.cluster.Member" id="akka.cluster.singleton;ClusterSingletonProxy.ageOrdering.$anonfun.b">b</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.singleton;ClusterSingletonProxy.ageOrdering.$anonfun.a" title="akka.cluster.Member">a</a>.<a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;Member.isOlderThan" title="(other: akka.cluster.Member)Boolean">isOlderThan</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.ageOrdering.$anonfun.b" title="akka.cluster.Member">b</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  var <a title="scala.collection.immutable.SortedSet[akka.cluster.Member]" id="akka.cluster.singleton;ClusterSingletonProxy.membersByAge_=">membersByAge</a>: immutable.<span title="scala.collection.immutable.SortedSet[akka.cluster.Member]">SortedSet</span><span class="delimiter">[</span>Member<span class="delimiter">]</span> = immutable.<span title="scala.collection.immutable.SortedSet.type">SortedSet</span>.<span title="(implicit ord: Ordering[akka.cluster.Member])scala.collection.immutable.SortedSet[akka.cluster.Member]">empty</span><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.ageOrdering" title="=&gt; scala.math.Ordering[akka.cluster.Member]">ageOrdering</a><span class="delimiter">)</span>

  var <a title="java.util.LinkedList[(Any, akka.actor.ActorRef)]" id="akka.cluster.singleton;ClusterSingletonProxy.buffer_=">buffer</a> = new java.util.<span title="java.util.LinkedList[(Any, akka.actor.ActorRef)]">LinkedList</span><span class="delimiter">[</span><span class="delimiter">(</span>Any, ActorRef<span class="delimiter">)</span><span class="delimiter">]</span>

  <span class="comment">// subscribe to MemberEvent, re-subscribe when restart</span>
  override def <a title="()Unit" id="akka.cluster.singleton;ClusterSingletonProxy.preStart">preStart</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.cancelTimer" title="()Unit">cancelTimer</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.cluster" title="=&gt; akka.cluster.Cluster">cluster</a>.<a href="../../../../cluster/akka/cluster/Cluster.scala.html#akka.cluster;Cluster.subscribe(6cfb44d410)" title="(subscriber: akka.actor.ActorRef, to: Class[_]*)Unit">subscribe</a><span class="delimiter">(</span><a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>, classOf<span title="Class[akka.cluster.ClusterEvent.MemberEvent](classOf[akka.cluster.ClusterEvent$$MemberEvent])" class="delimiter">[</span>MemberEvent<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="()Unit" id="akka.cluster.singleton;ClusterSingletonProxy.postStop">postStop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.cancelTimer" title="()Unit">cancelTimer</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.cluster" title="=&gt; akka.cluster.Cluster">cluster</a>.<a href="../../../../cluster/akka/cluster/Cluster.scala.html#akka.cluster;Cluster.unsubscribe(134bd64d81)" title="(subscriber: akka.actor.ActorRef)Unit">unsubscribe</a><span class="delimiter">(</span><a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="()Unit" id="akka.cluster.singleton;ClusterSingletonProxy.cancelTimer">cancelTimer</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.identifyTimer_=" title="=&gt; Option[akka.actor.Cancellable]">identifyTimer</a>.<span title="(f: akka.actor.Cancellable =&gt; Boolean)Unit">foreach</span><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.cancelTimer.$anonfun.x$1" title="akka.actor.Cancellable">_</a>.<a href="../../../../actor/akka/actor/Scheduler.scala.html#akka.actor;Cancellable.cancel" title="()Boolean">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.identifyTimer_=" title="(x$1: Option[akka.actor.Cancellable])Unit">identifyTimer</a> = <span title="None.type">None</span>
  <span class="delimiter">}</span>

  def <a title="(member: akka.cluster.Member)Boolean" id="akka.cluster.singleton;ClusterSingletonProxy.matchingRole">matchingRole</a><span class="delimiter">(</span><a title="akka.cluster.Member" id="akka.cluster.singleton;ClusterSingletonProxy.matchingRole.member">member</a>: <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;Member" title="akka.cluster.Member">Member</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.role" title="=&gt; Option[String]">role</a> match <span class="delimiter">{</span>
    case <span title="None.type">None</span>    ⇒ true
    case Some<span class="delimiter">(</span><a title="String" id="akka.cluster.singleton;ClusterSingletonProxy.matchingRole.r">r</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.singleton;ClusterSingletonProxy.matchingRole.member" title="akka.cluster.Member">member</a>.<a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;Member.hasRole" title="(role: String)Boolean">hasRole</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.matchingRole.r" title="String">r</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(state: akka.cluster.ClusterEvent.CurrentClusterState)Unit" id="akka.cluster.singleton;ClusterSingletonProxy.handleInitial">handleInitial</a><span class="delimiter">(</span><a title="akka.cluster.ClusterEvent.CurrentClusterState" id="akka.cluster.singleton;ClusterSingletonProxy.handleInitial.state">state</a>: <a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent;CurrentClusterState" title="akka.cluster.ClusterEvent.CurrentClusterState">CurrentClusterState</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.trackChange" title="(block: () =&gt; Unit)Unit">trackChange</a> <span class="delimiter">{</span>
      <span class="delimiter">(</span><span class="delimiter">)</span> ⇒
        <a href="#akka.cluster.singleton;ClusterSingletonProxy.membersByAge_=" title="(x$1: scala.collection.immutable.SortedSet[akka.cluster.Member])Unit">membersByAge</a> = immutable.<span title="scala.collection.immutable.SortedSet.type">SortedSet</span>.<span title="(implicit ord: Ordering[akka.cluster.Member])scala.collection.immutable.SortedSet[akka.cluster.Member]">empty</span><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.ageOrdering" title="=&gt; scala.math.Ordering[akka.cluster.Member]">ageOrdering</a><span class="delimiter">)</span> <span title="(elems: scala.collection.GenTraversableOnce[akka.cluster.Member])scala.collection.immutable.SortedSet[akka.cluster.Member]">++</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.handleInitial.state" title="akka.cluster.ClusterEvent.CurrentClusterState">state</a>.<a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent;CurrentClusterState.members" title="=&gt; scala.collection.immutable.SortedSet[akka.cluster.Member]">members</a>.<span title="(pf: PartialFunction[akka.cluster.Member,akka.cluster.Member])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.SortedSet[akka.cluster.Member],akka.cluster.Member,scala.collection.immutable.SortedSet[akka.cluster.Member]])scala.collection.immutable.SortedSet[akka.cluster.Member]">collect</span> <a title="&lt;$anon: akka.cluster.Member =&gt; akka.cluster.Member&gt; extends scala.runtime.AbstractPartialFunction[akka.cluster.Member,akka.cluster.Member] with Serializable" id="akka.cluster.singleton;ClusterSingletonProxy.handleInitial.$anonfun;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
          case <a title="akka.cluster.Member" id="akka.cluster.singleton;ClusterSingletonProxy.handleInitial.$anonfun;$anonfun.isDefinedAt.m">m</a> if <a href="#akka.cluster.singleton;ClusterSingletonProxy.handleInitial.$anonfun;$anonfun.isDefinedAt.m" title="akka.cluster.Member">m</a>.<a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;Member.status" title="=&gt; akka.cluster.MemberStatus">status</a> <span title="(x$1: Any)Boolean">==</span> <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster.MemberStatus" title="akka.cluster.MemberStatus.type">MemberStatus</a>.<a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster.MemberStatus.Up" title="akka.cluster.MemberStatus.Up.type">Up</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.matchingRole" title="(member: akka.cluster.Member)Boolean">matchingRole</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.handleInitial.$anonfun;$anonfun.isDefinedAt.m" title="akka.cluster.Member">m</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.singleton;ClusterSingletonProxy.handleInitial.$anonfun;$anonfun.isDefinedAt.m" title="akka.cluster.Member">m</a>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Discard old singleton ActorRef and send a periodic message to self to identify the singleton.
   */</span>
  def <a title="()Unit" id="akka.cluster.singleton;ClusterSingletonProxy.identifySingleton">identifySingleton</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    import <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.dispatcher
    <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../../../../actor/akka/event/Logging.scala.html#akka.event;LoggingAdapter.debug(cc2e600322)" title="(message: String)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Creating singleton identification timer...&quot;)" class="string">&quot;Creating singleton identification timer...&quot;</span><span class="delimiter">)</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.identifyCounter_=" title="(x$1: Int)Unit">identifyCounter</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.identifyId_=" title="(x$1: String)Unit">identifyId</a> = <a href="#akka.cluster.singleton;ClusterSingletonProxy.createIdentifyId" title="(i: Int)String">createIdentifyId</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.identifyCounter_=" title="=&gt; Int">identifyCounter</a><span class="delimiter">)</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.singleton_=" title="(x$1: Option[akka.actor.ActorRef])Unit">singleton</a> = <span title="None.type">None</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.cancelTimer" title="()Unit">cancelTimer</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.identifyTimer_=" title="(x$1: Option[akka.actor.Cancellable])Unit">identifyTimer</a> = <span title="(x: akka.actor.Cancellable)Some[akka.actor.Cancellable]">Some</span><span class="delimiter">(</span><a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a>.<a href="../../../../actor/akka/actor/ActorSystem.scala.html#akka.actor;ActorSystem.scheduler" title="=&gt; akka.actor.Scheduler">scheduler</a>.<a href="../../../../actor/akka/actor/Scheduler.scala.html#akka.actor;Scheduler.schedule(abf8206fc2)" title="(initialDelay: scala.concurrent.duration.FiniteDuration, interval: scala.concurrent.duration.FiniteDuration, receiver: akka.actor.ActorRef, message: Any)(implicit executor: scala.concurrent.ExecutionContext, implicit sender: akka.actor.ActorRef)akka.actor.Cancellable">schedule</a><a href="../../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.dispatcher" title="=&gt; scala.concurrent.ExecutionContextExecutor" class="delimiter">(</a><span title="implicit scala.concurrent.duration.package.DurationInt : (n: Int)concurrent.duration.DurationInt" class="int">0</span> <span title="=&gt; scala.concurrent.duration.FiniteDuration">milliseconds</span>, <a href="#akka.cluster.singleton;ClusterSingletonProxySettings.singletonIdentificationInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">singletonIdentificationInterval</a>, <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>, <a href="#akka.cluster.singleton.ClusterSingletonProxy" title="akka.cluster.singleton.ClusterSingletonProxy.type">ClusterSingletonProxy</a>.<a href="#akka.cluster.singleton.ClusterSingletonProxy.TryToIdentifySingleton.readResolve" title="akka.cluster.singleton.ClusterSingletonProxy.TryToIdentifySingleton.type">TryToIdentifySingleton</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(block: () =&gt; Unit)Unit" id="akka.cluster.singleton;ClusterSingletonProxy.trackChange">trackChange</a><span class="delimiter">(</span><a title="() =&gt; Unit" id="akka.cluster.singleton;ClusterSingletonProxy.trackChange.block">block</a>: <span class="delimiter">(</span><span class="delimiter">)</span> ⇒ Unit<span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    val <a title="Option[akka.cluster.Member]" id="akka.cluster.singleton;ClusterSingletonProxy.trackChange.before">before</a> = <a href="#akka.cluster.singleton;ClusterSingletonProxy.membersByAge_=" title="=&gt; scala.collection.immutable.SortedSet[akka.cluster.Member]">membersByAge</a>.<span title="=&gt; Option[akka.cluster.Member]">headOption</span>
    <a href="#akka.cluster.singleton;ClusterSingletonProxy.trackChange.block" title="()Unit">block</a><span class="delimiter">(</span><span class="delimiter">)</span>
    val <a title="Option[akka.cluster.Member]" id="akka.cluster.singleton;ClusterSingletonProxy.trackChange.after">after</a> = <a href="#akka.cluster.singleton;ClusterSingletonProxy.membersByAge_=" title="=&gt; scala.collection.immutable.SortedSet[akka.cluster.Member]">membersByAge</a>.<span title="=&gt; Option[akka.cluster.Member]">headOption</span>
    <span class="comment">// if the head has changed, I need to find the new singleton</span>
    if <span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.trackChange.before" title="Option[akka.cluster.Member]">before</a> <span title="(x$1: Any)Boolean">!=</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.trackChange.after" title="Option[akka.cluster.Member]">after</a><span class="delimiter">)</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.identifySingleton" title="()Unit">identifySingleton</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Adds new member if it has the right role.
   * @param m New cluster member.
   */</span>
  def <a title="(m: akka.cluster.Member)Unit" id="akka.cluster.singleton;ClusterSingletonProxy.add">add</a><span class="delimiter">(</span><a title="akka.cluster.Member" id="akka.cluster.singleton;ClusterSingletonProxy.add.m">m</a>: <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;Member" title="akka.cluster.Member">Member</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.matchingRole" title="(member: akka.cluster.Member)Boolean">matchingRole</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.add.m" title="akka.cluster.Member">m</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.cluster.singleton;ClusterSingletonProxy.trackChange" title="(block: () =&gt; Unit)Unit">trackChange</a> <span class="delimiter">{</span>
        <span class="delimiter">(</span><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.singleton;ClusterSingletonProxy.membersByAge_=" title="(x$1: scala.collection.immutable.SortedSet[akka.cluster.Member])Unit">membersByAge</a> <span title="(elem: akka.cluster.Member)scala.collection.immutable.SortedSet[akka.cluster.Member]">+=</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.add.m" title="akka.cluster.Member">m</a>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Removes a member.
   * @param m Cluster member to remove.
   */</span>
  def <a title="(m: akka.cluster.Member)Unit" id="akka.cluster.singleton;ClusterSingletonProxy.remove">remove</a><span class="delimiter">(</span><a title="akka.cluster.Member" id="akka.cluster.singleton;ClusterSingletonProxy.remove.m">m</a>: <a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;Member" title="akka.cluster.Member">Member</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.matchingRole" title="(member: akka.cluster.Member)Boolean">matchingRole</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.remove.m" title="akka.cluster.Member">m</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.cluster.singleton;ClusterSingletonProxy.trackChange" title="(block: () =&gt; Unit)Unit">trackChange</a> <span class="delimiter">{</span>
        <span class="delimiter">(</span><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.singleton;ClusterSingletonProxy.membersByAge_=" title="(x$1: scala.collection.immutable.SortedSet[akka.cluster.Member])Unit">membersByAge</a> <span title="(elem: akka.cluster.Member)scala.collection.immutable.SortedSet[akka.cluster.Member]">-=</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.remove.m" title="akka.cluster.Member">m</a>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="=&gt; PartialFunction[Any,Unit]" id="akka.cluster.singleton;ClusterSingletonProxy.receive">receive</a> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    <span class="comment">// cluster logic</span>
    case <a title="akka.cluster.ClusterEvent.CurrentClusterState" id="akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.state">state</a>: <a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent;CurrentClusterState" title="akka.cluster.ClusterEvent.CurrentClusterState">CurrentClusterState</a> ⇒ <a href="#akka.cluster.singleton;ClusterSingletonProxy.handleInitial" title="(state: akka.cluster.ClusterEvent.CurrentClusterState)Unit">handleInitial</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.state" title="akka.cluster.ClusterEvent.CurrentClusterState">state</a><span class="delimiter">)</span>
    case MemberUp<span class="delimiter">(</span><a title="akka.cluster.Member" id="akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.m">m</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.singleton;ClusterSingletonProxy.add" title="(m: akka.cluster.Member)Unit">add</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.m" title="akka.cluster.Member">m</a><span class="delimiter">)</span>
    case <a title="akka.cluster.ClusterEvent.MemberEvent" id="akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.mEvent">mEvent</a>: <a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent;MemberEvent" title="akka.cluster.ClusterEvent.MemberEvent">MemberEvent</a> if <a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.mEvent" title="akka.cluster.ClusterEvent.MemberEvent">mEvent</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent;MemberExited" title="akka.cluster.ClusterEvent.MemberExited">MemberExited</a><span class="delimiter">]</span> <span title="(x: Boolean)Boolean">||</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.mEvent" title="akka.cluster.ClusterEvent.MemberEvent">mEvent</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent;MemberRemoved" title="akka.cluster.ClusterEvent.MemberRemoved">MemberRemoved</a><span class="delimiter">]</span> ⇒ <a href="#akka.cluster.singleton;ClusterSingletonProxy.remove" title="(m: akka.cluster.Member)Unit">remove</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.mEvent" title="akka.cluster.ClusterEvent.MemberEvent">mEvent</a>.<a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent;MemberEvent.member" title="=&gt; akka.cluster.Member">member</a><span class="delimiter">)</span>
    case _: <a href="../../../../cluster/akka/cluster/ClusterEvent.scala.html#akka.cluster.ClusterEvent;MemberEvent" title="akka.cluster.ClusterEvent.MemberEvent">MemberEvent</a> ⇒ <span class="comment">// do nothing</span>

    <span class="comment">// singleton identification logic</span>
    case ActorIdentity<span class="delimiter">(</span><a title="Any" id="akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.identifyId">identifyId</a>, Some<span class="delimiter">(</span><a title="akka.actor.ActorRef" id="akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.s">s</a><span class="delimiter">)</span><span class="delimiter">)</span> ⇒
      <span class="comment">// if the new singleton is defined, deliver all buffered messages</span>
      <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../../../../actor/akka/event/Logging.scala.html#akka.event;LoggingAdapter.info(dc73c33c91)" title="(template: String, arg1: Any)Unit">info</a><span class="delimiter">(</span><span title="String(&quot;Singleton identified at [{}]&quot;)" class="string">&quot;Singleton identified at [{}]&quot;</span>, <span title="akka.actor.ActorRef">s</span>.<a href="../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef.path" title="=&gt; akka.actor.ActorPath">path</a><span class="delimiter">)</span>
      <a href="#akka.cluster.singleton;ClusterSingletonProxy.singleton_=" title="(x$1: Option[akka.actor.ActorRef])Unit">singleton</a> = <span title="(x: akka.actor.ActorRef)Some[akka.actor.ActorRef]">Some</span><span class="delimiter">(</span><span title="akka.actor.ActorRef">s</span><span class="delimiter">)</span>
      <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.watch" title="(subject: akka.actor.ActorRef)akka.actor.ActorRef">watch</a><span class="delimiter">(</span><span title="akka.actor.ActorRef">s</span><span class="delimiter">)</span>
      <a href="#akka.cluster.singleton;ClusterSingletonProxy.cancelTimer" title="()Unit">cancelTimer</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.cluster.singleton;ClusterSingletonProxy.sendBuffered" title="()Unit">sendBuffered</a><span class="delimiter">(</span><span class="delimiter">)</span>
    case _: <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorIdentity" title="akka.actor.ActorIdentity">ActorIdentity</a> ⇒ <span class="comment">// do nothing</span>
    case <a href="#akka.cluster.singleton.ClusterSingletonProxy" title="akka.cluster.singleton.ClusterSingletonProxy.type">ClusterSingletonProxy</a>.<a href="#akka.cluster.singleton.ClusterSingletonProxy.TryToIdentifySingleton.readResolve" title="akka.cluster.singleton.ClusterSingletonProxy.TryToIdentifySingleton.type">TryToIdentifySingleton</a> if <a href="#akka.cluster.singleton;ClusterSingletonProxy.identifyTimer_=" title="=&gt; Option[akka.actor.Cancellable]">identifyTimer</a>.<span title="=&gt; Boolean">isDefined</span> ⇒
      <a href="#akka.cluster.singleton;ClusterSingletonProxy.membersByAge_=" title="=&gt; scala.collection.immutable.SortedSet[akka.cluster.Member]">membersByAge</a>.<span title="=&gt; Option[akka.cluster.Member]">headOption</span>.<span title="(f: akka.cluster.Member =&gt; Unit)Unit">foreach</span> <span title="Boolean(true)" class="delimiter">{</span>
        <a title="akka.cluster.Member" id="akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.applyOrElse.$anonfun.oldest">oldest</a> ⇒
          val singletonAddress = <a href="../../../../actor/akka/actor/ActorPath.scala.html#akka.actor;RootActorPath" title="(address: akka.actor.Address, name: String)akka.actor.RootActorPath">RootActorPath</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.applyOrElse.$anonfun.oldest" title="akka.cluster.Member">oldest</a>.<a href="../../../../cluster/akka/cluster/Member.scala.html#akka.cluster;Member.address" title="=&gt; akka.actor.Address">address</a><span class="delimiter">)</span> <a href="../../../../actor/akka/actor/ActorPath.scala.html#akka.actor;ActorPath./(214d397cb8)" title="akka.actor.ActorPath" id="akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.applyOrElse.$anonfun.singletonAddress">/</a> <a href="#akka.cluster.singleton;ClusterSingletonProxy.singletonPath" title="(xs: Array[String])scala.collection.mutable.WrappedArray[String]">singletonPath</a>
          <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../../../../actor/akka/event/Logging.scala.html#akka.event;LoggingAdapter.debug(dc73c33c91)" title="(template: String, arg1: Any)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Trying to identify singleton at [{}]&quot;)" class="string">&quot;Trying to identify singleton at [{}]&quot;</span>, <a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.applyOrElse.$anonfun.singletonAddress" title="akka.actor.ActorPath">singletonAddress</a><span class="delimiter">)</span>
          <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../../actor/akka/actor/ActorRefProvider.scala.html#akka.actor;ActorRefFactory.actorSelection(e44b8bc960)" title="(path: akka.actor.ActorPath)akka.actor.ActorSelection">actorSelection</a><a href="../../../../actor/akka/actor/ActorSelection.scala.html#akka.actor.ActorSelection.toScala" title="implicit akka.actor.ActorSelection.toScala : (sel: akka.actor.ActorSelection)akka.actor.ScalaActorSelection" class="delimiter">(</a><a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.applyOrElse.$anonfun.singletonAddress" title="akka.actor.ActorPath">singletonAddress</a><span class="delimiter">)</span> <a href="../../../../actor/akka/actor/ActorSelection.scala.html#akka.actor;ScalaActorSelection.!" title="(msg: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Identify" title="(messageId: Any)akka.actor.Identify">Identify</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.identifyId_=" title="=&gt; String">identifyId</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    case Terminated<span class="delimiter">(</span><a title="akka.actor.ActorRef" id="akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.ref">ref</a><span class="delimiter">)</span> ⇒
      if <span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.singleton_=" title="=&gt; Option[akka.actor.ActorRef]">singleton</a>.<span title="(p: akka.actor.ActorRef =&gt; Boolean)Boolean">exists</span><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.applyOrElse.$anonfun.x$2" title="akka.actor.ActorRef">_</a> <span title="(x$1: Any)Boolean">==</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.ref" title="akka.actor.ActorRef">ref</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// buffering mode, identification of new will start when old node is removed</span>
        <a href="#akka.cluster.singleton;ClusterSingletonProxy.singleton_=" title="(x$1: Option[akka.actor.ActorRef])Unit">singleton</a> = <span title="None.type">None</span>
      <span class="delimiter">}</span>

    <span class="comment">// forwarding/stashing logic</span>
    case <a title="Any" id="akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.msg">msg</a>: <span title="Any">Any</span> ⇒
      <a href="#akka.cluster.singleton;ClusterSingletonProxy.singleton_=" title="=&gt; Option[akka.actor.ActorRef]">singleton</a> match <span class="delimiter">{</span>
        case Some<span class="delimiter">(</span><span title="akka.actor.ActorRef">s</span><span class="delimiter">)</span> ⇒
          if <span class="delimiter">(</span><a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../../../../actor/akka/event/Logging.scala.html#akka.event;LoggingAdapter.isDebugEnabled" title="=&gt; Boolean">isDebugEnabled</a><span class="delimiter">)</span>
            <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../../../../actor/akka/event/Logging.scala.html#akka.event;LoggingAdapter.debug(2f488eb77c)" title="(template: String, arg1: Any, arg2: Any)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Forwarding message of type [{}] to current singleton instance at [{}]: {}&quot;)" class="string">&quot;Forwarding message of type [{}] to current singleton instance at [{}]: {}&quot;</span>,
              <a href="../../../../actor/akka/event/Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.<a href="../../../../actor/akka/event/Logging.scala.html#akka.event.Logging.simpleName(09be6fff70)" title="(obj: AnyRef)String">simpleName</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.msg" title="Any">msg</a>.<span title="()Class[_]">getClass</span>.<span title="()String">getName</span><span class="delimiter">)</span>, <span title="akka.actor.ActorRef">s</span>.<a href="../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef.path" title="=&gt; akka.actor.ActorPath">path</a><span class="delimiter">)</span>
          <span title="akka.actor.ActorRef">s</span> <a href="../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef.forward" title="(message: Any)(implicit context: akka.actor.ActorContext)Unit">forward</a> <a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.msg" title="Any">msg</a>
        case <span title="None.type">None</span> ⇒
          <a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef)" title="(msg: Any)Unit">buffer</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.receive;$anonfun.isDefinedAt.msg" title="Any">msg</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(msg: Any)Unit" id="akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef)">buffer</a><span class="delimiter">(</span><a title="Any" id="akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef).msg">msg</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    if <span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.settings" title="akka.cluster.singleton.ClusterSingletonProxySettings">settings</a>.<a href="#akka.cluster.singleton;ClusterSingletonProxySettings.bufferSize" title="=&gt; Int">bufferSize</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../../../../actor/akka/event/Logging.scala.html#akka.event;LoggingAdapter.debug(dc73c33c91)" title="(template: String, arg1: Any)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Singleton not available and buffering is disabled, dropping message [{}]&quot;)" class="string">&quot;Singleton not available and buffering is disabled, dropping message [{}]&quot;</span>, <a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef).msg" title="Any">msg</a>.<span title="()Class[_]">getClass</span>.<span title="()String">getName</span><span class="delimiter">)</span>
    else if <span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer_=" title="=&gt; java.util.LinkedList[(Any, akka.actor.ActorRef)]">buffer</a>.<span title="()Int">size</span> <span title="(x: Int)Boolean">==</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.settings" title="akka.cluster.singleton.ClusterSingletonProxySettings">settings</a>.<a href="#akka.cluster.singleton;ClusterSingletonProxySettings.bufferSize" title="=&gt; Int">bufferSize</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef).m.m" title="Any" id="akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef).m" class="delimiter">(</a><a title="Any" id="akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef).m.m">m</a>, _<span class="delimiter">)</span> = <a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer_=" title="=&gt; java.util.LinkedList[(Any, akka.actor.ActorRef)]">buffer</a>.<span title="()(Any, akka.actor.ActorRef)">removeFirst</span><span title="(Any, akka.actor.ActorRef) @unchecked" class="delimiter">(</span><span class="delimiter">)</span>
      <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../../../../actor/akka/event/Logging.scala.html#akka.event;LoggingAdapter.debug(dc73c33c91)" title="(template: String, arg1: Any)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Singleton not available, buffer is full, dropping first message [{}]&quot;)" class="string">&quot;Singleton not available, buffer is full, dropping first message [{}]&quot;</span>, <a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef).m" title="Any">m</a>.<span title="()Class[_]">getClass</span>.<span title="()String">getName</span><span class="delimiter">)</span>
      <a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer_=" title="=&gt; java.util.LinkedList[(Any, akka.actor.ActorRef)]">buffer</a>.<span title="(x$1: (Any, akka.actor.ActorRef))Unit">addLast</span><span class="delimiter">(</span><span title="(_1: Any, _2: akka.actor.ActorRef)(Any, akka.actor.ActorRef)" class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef).msg" title="Any">msg</a>, <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.sender" title="()akka.actor.ActorRef">sender</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> else <span class="delimiter">{</span>
      <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../../../../actor/akka/event/Logging.scala.html#akka.event;LoggingAdapter.debug(dc73c33c91)" title="(template: String, arg1: Any)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Singleton not available, buffering message type [{}]&quot;)" class="string">&quot;Singleton not available, buffering message type [{}]&quot;</span>, <a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef).msg" title="Any">msg</a>.<span title="()Class[_]">getClass</span>.<span title="()String">getName</span><span class="delimiter">)</span>
      <a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer_=" title="=&gt; java.util.LinkedList[(Any, akka.actor.ActorRef)]">buffer</a>.<span title="(x$1: (Any, akka.actor.ActorRef))Unit">addLast</span><span class="delimiter">(</span><span title="(_1: Any, _2: akka.actor.ActorRef)(Any, akka.actor.ActorRef)" class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer(95eb915eef).msg" title="Any">msg</a>, <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.sender" title="()akka.actor.ActorRef">sender</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  def <a title="()Unit" id="akka.cluster.singleton;ClusterSingletonProxy.sendBuffered">sendBuffered</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="../../../../actor/akka/actor/Actor.scala.html#akka.actor;ActorLogging.log" title="=&gt; akka.event.LoggingAdapter">log</a>.<a href="../../../../actor/akka/event/Logging.scala.html#akka.event;LoggingAdapter.debug(cc2e600322)" title="(message: String)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Sending buffered messages to current singleton instance&quot;)" class="string">&quot;Sending buffered messages to current singleton instance&quot;</span><span class="delimiter">)</span>
    val <a title="akka.actor.ActorRef" id="akka.cluster.singleton;ClusterSingletonProxy.sendBuffered.target">target</a> = <a href="#akka.cluster.singleton;ClusterSingletonProxy.singleton_=" title="=&gt; Option[akka.actor.ActorRef]">singleton</a>.<span title="=&gt; akka.actor.ActorRef">get</span>
    while <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer_=" title="=&gt; java.util.LinkedList[(Any, akka.actor.ActorRef)]">buffer</a>.<span title="()Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#akka.cluster.singleton;ClusterSingletonProxy.sendBuffered.while$1" title="()Unit" class="delimiter">{</a>
      val <a href="#akka.cluster.singleton;ClusterSingletonProxy.sendBuffered.msg" title="(Any, akka.actor.ActorRef)" class="delimiter">(</a><a href="#akka.cluster.singleton;ClusterSingletonProxy.sendBuffered.x$3" title="Any" id="akka.cluster.singleton;ClusterSingletonProxy.sendBuffered.msg">msg</a>, <a href="#akka.cluster.singleton;ClusterSingletonProxy.sendBuffered.x$3" title="akka.actor.ActorRef" id="akka.cluster.singleton;ClusterSingletonProxy.sendBuffered.snd">snd</a><span class="delimiter">)</span> = <a href="#akka.cluster.singleton;ClusterSingletonProxy.buffer_=" title="=&gt; java.util.LinkedList[(Any, akka.actor.ActorRef)]">buffer</a>.<span title="()(Any, akka.actor.ActorRef)">removeFirst</span><span title="(Any, akka.actor.ActorRef) @unchecked" class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.cluster.singleton;ClusterSingletonProxy.sendBuffered.target" title="akka.actor.ActorRef">target</a>.<a href="../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef.tell" title="(msg: Any, sender: akka.actor.ActorRef)Unit">tell</a><span class="delimiter">(</span><a href="#akka.cluster.singleton;ClusterSingletonProxy.sendBuffered.msg" title="Any">msg</a>, <a href="#akka.cluster.singleton;ClusterSingletonProxy.sendBuffered.snd" title="akka.actor.ActorRef">snd</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

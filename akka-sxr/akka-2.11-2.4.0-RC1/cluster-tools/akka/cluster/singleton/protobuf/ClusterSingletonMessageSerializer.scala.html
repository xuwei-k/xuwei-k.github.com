<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>cluster-tools/akka/cluster/singleton/protobuf/ClusterSingletonMessageSerializer.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
package akka.cluster.singleton.protobuf

import akka.actor.ExtendedActorSystem
import akka.cluster.singleton.<a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager" title="akka.cluster.singleton.ClusterSingletonManager.type">ClusterSingletonManager</a>.<a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal" title="akka.cluster.singleton.ClusterSingletonManager.Internal.type">Internal</a>.HandOverDone
import akka.cluster.singleton.<a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager" title="akka.cluster.singleton.ClusterSingletonManager.type">ClusterSingletonManager</a>.<a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal" title="akka.cluster.singleton.ClusterSingletonManager.Internal.type">Internal</a>.HandOverInProgress
import akka.cluster.singleton.<a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager" title="akka.cluster.singleton.ClusterSingletonManager.type">ClusterSingletonManager</a>.<a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal" title="akka.cluster.singleton.ClusterSingletonManager.Internal.type">Internal</a>.HandOverToMe
import akka.cluster.singleton.<a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager" title="akka.cluster.singleton.ClusterSingletonManager.type">ClusterSingletonManager</a>.<a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal" title="akka.cluster.singleton.ClusterSingletonManager.Internal.type">Internal</a>.TakeOverFromMe
import akka.serialization.BaseSerializer
import akka.serialization.SerializationExtension
import akka.serialization.SerializerWithStringManifest

<span class="comment">/**
 * INTERNAL API: Serializer of ClusterSingleton messages.
 * It is actually not using protobuf, but if we add more messages to
 * the ClusterSingleton we want to make protobuf representations of them.
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> class <a title="class ClusterSingletonMessageSerializer extends akka.serialization.SerializerWithStringManifest with akka.serialization.BaseSerializer" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer">ClusterSingletonMessageSerializer</a><a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer" title="akka.cluster.singleton.protobuf.ClusterSingletonMessageSerializer" class="delimiter">(</a>val <a title="akka.actor.ExtendedActorSystem" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.system">system</a>: <a href="../../../../../actor/akka/actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem" title="akka.actor.ExtendedActorSystem">ExtendedActorSystem</a><span class="delimiter">)</span>
  extends <a href="../../../../../actor/akka/serialization/Serializer.scala.html#akka.serialization;SerializerWithStringManifest" title="akka.serialization.SerializerWithStringManifest">SerializerWithStringManifest</a> with <a href="../../../../../actor/akka/serialization/Serializer.scala.html#akka.serialization;BaseSerializer" title="akka.serialization.BaseSerializer">BaseSerializer</a> <span class="delimiter">{</span>

  private lazy val <a title="akka.serialization.Serialization" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.serialization">serialization</a> = <a href="../../../../../actor/akka/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.serialization.Serialization">SerializationExtension</a><span class="delimiter">(</span><a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.system" title="=&gt; akka.actor.ExtendedActorSystem">system</a><span class="delimiter">)</span>

  private val <a title="String" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.HandOverToMeManifest">HandOverToMeManifest</a> = <span title="String(&quot;A&quot;)" class="string">&quot;A&quot;</span>
  private val <a title="String" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.HandOverInProgressManifest">HandOverInProgressManifest</a> = <span title="String(&quot;B&quot;)" class="string">&quot;B&quot;</span>
  private val <a title="String" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.HandOverDoneManifest">HandOverDoneManifest</a> = <span title="String(&quot;C&quot;)" class="string">&quot;C&quot;</span>
  private val <a title="String" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.TakeOverFromMeManifest">TakeOverFromMeManifest</a> = <span title="String(&quot;D&quot;)" class="string">&quot;D&quot;</span>

  private val <a title="Array[Byte]" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.emptyByteArray">emptyByteArray</a> = <span title="Array.type">Array</span>.<span title="[T](implicit evidence$1: scala.reflect.ClassTag[T])Array[T]">empty</span><span title="(implicit evidence$1: scala.reflect.ClassTag[Byte])Array[Byte]" class="delimiter">[</span><span title="Byte">Byte</span><span class="delimiter">]</span>

  private val <a title="scala.collection.immutable.HashMap[String,Array[Byte] =&gt; AnyRef]" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinaryMap">fromBinaryMap</a> = collection.immutable.<span title="[A, B](elems: (A, B)*)scala.collection.immutable.HashMap[A,B]">HashMap</span><span title="(elems: (String, Array[Byte] =&gt; AnyRef)*)scala.collection.immutable.HashMap[String,Array[Byte] =&gt; AnyRef]" class="delimiter">[</span><span title="String">String</span>, Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span> ⇒ AnyRef<span class="delimiter">]</span><span class="delimiter">(</span>
    <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.HandOverToMeManifest" title="(self: String)ArrowAssoc[String]">HandOverToMeManifest</a> <span title="(y: Array[Byte] =&gt; akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverToMe.type)(String, Array[Byte] =&gt; akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverToMe.type)">-&gt;</span> <span class="delimiter">{</span> <a title="Array[Byte]" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinaryMap.$anonfun.x$1">_</a> ⇒ <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverToMe" title="akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverToMe.type">HandOverToMe</a> <span class="delimiter">}</span>,
    <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.HandOverInProgressManifest" title="(self: String)ArrowAssoc[String]">HandOverInProgressManifest</a> <span title="(y: Array[Byte] =&gt; akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverInProgress.type)(String, Array[Byte] =&gt; akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverInProgress.type)">-&gt;</span> <span class="delimiter">{</span> <a title="Array[Byte]" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinaryMap.$anonfun.x$2">_</a> ⇒ <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverInProgress" title="akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverInProgress.type">HandOverInProgress</a> <span class="delimiter">}</span>,
    <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.HandOverDoneManifest" title="(self: String)ArrowAssoc[String]">HandOverDoneManifest</a> <span title="(y: Array[Byte] =&gt; akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverDone.type)(String, Array[Byte] =&gt; akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverDone.type)">-&gt;</span> <span class="delimiter">{</span> <a title="Array[Byte]" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinaryMap.$anonfun.x$3">_</a> ⇒ <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverDone" title="akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverDone.type">HandOverDone</a> <span class="delimiter">}</span>,
    <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.TakeOverFromMeManifest" title="(self: String)ArrowAssoc[String]">TakeOverFromMeManifest</a> <span title="(y: Array[Byte] =&gt; akka.cluster.singleton.ClusterSingletonManager.Internal.TakeOverFromMe.type)(String, Array[Byte] =&gt; akka.cluster.singleton.ClusterSingletonManager.Internal.TakeOverFromMe.type)">-&gt;</span> <span class="delimiter">{</span> <a title="Array[Byte]" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinaryMap.$anonfun.x$4">_</a> ⇒ <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.TakeOverFromMe" title="akka.cluster.singleton.ClusterSingletonManager.Internal.TakeOverFromMe.type">TakeOverFromMe</a> <span class="delimiter">}</span><span class="delimiter">)</span>

  override def <a title="(obj: AnyRef)String" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.manifest">manifest</a><span class="delimiter">(</span><a title="AnyRef" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.manifest.obj">obj</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.manifest.obj" title="AnyRef">obj</a> match <span class="delimiter">{</span>
    case <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverToMe" title="akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverToMe.type">HandOverToMe</a>       ⇒ <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.HandOverToMeManifest" title="=&gt; String">HandOverToMeManifest</a>
    case <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverInProgress" title="akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverInProgress.type">HandOverInProgress</a> ⇒ <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.HandOverInProgressManifest" title="=&gt; String">HandOverInProgressManifest</a>
    case <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverDone" title="akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverDone.type">HandOverDone</a>       ⇒ <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.HandOverDoneManifest" title="=&gt; String">HandOverDoneManifest</a>
    case <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.TakeOverFromMe" title="akka.cluster.singleton.ClusterSingletonManager.Internal.TakeOverFromMe.type">TakeOverFromMe</a>     ⇒ <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.TakeOverFromMeManifest" title="=&gt; String">TakeOverFromMeManifest</a>
    case _ ⇒
      throw new <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Can\'t serialize object of type &quot;)">Can't serialize object of type $</span><span class="delimiter">{</span><a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.manifest.obj" title="AnyRef">obj</a>.<span title="()Class[_]">getClass</span><span class="delimiter">}</span><span title="String(&quot; in [&quot;)"> in [$</span><span class="delimiter">{</span><a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer" title="()Class[_]">getClass</a>.<span title="()String">getName</span><span class="delimiter">}</span><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="(obj: AnyRef)Array[Byte]" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.toBinary">toBinary</a><span class="delimiter">(</span><a title="AnyRef" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.toBinary.obj">obj</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span> = <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.toBinary.obj" title="AnyRef">obj</a> match <span class="delimiter">{</span>
    case <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverToMe" title="akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverToMe.type">HandOverToMe</a>       ⇒ <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.emptyByteArray" title="=&gt; Array[Byte]">emptyByteArray</a>
    case <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverInProgress" title="akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverInProgress.type">HandOverInProgress</a> ⇒ <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.emptyByteArray" title="=&gt; Array[Byte]">emptyByteArray</a>
    case <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverDone" title="akka.cluster.singleton.ClusterSingletonManager.Internal.HandOverDone.type">HandOverDone</a>       ⇒ <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.emptyByteArray" title="=&gt; Array[Byte]">emptyByteArray</a>
    case <a href="../ClusterSingletonManager.scala.html#akka.cluster.singleton.ClusterSingletonManager.Internal.TakeOverFromMe" title="akka.cluster.singleton.ClusterSingletonManager.Internal.TakeOverFromMe.type">TakeOverFromMe</a>     ⇒ <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.emptyByteArray" title="=&gt; Array[Byte]">emptyByteArray</a>
    case _ ⇒
      throw new <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Can\'t serialize object of type &quot;)">Can't serialize object of type $</span><span class="delimiter">{</span><a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.toBinary.obj" title="AnyRef">obj</a>.<span title="()Class[_]">getClass</span><span class="delimiter">}</span><span title="String(&quot; in [&quot;)"> in [$</span><span class="delimiter">{</span><a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer" title="()Class[_]">getClass</a>.<span title="()String">getName</span><span class="delimiter">}</span><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="(bytes: Array[Byte], manifest: String)AnyRef" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinary(4478669bff)">fromBinary</a><span class="delimiter">(</span><a title="Array[Byte]" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinary(4478669bff).bytes">bytes</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="String" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinary(4478669bff).manifest">manifest</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> =
    <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinaryMap" title="=&gt; scala.collection.immutable.HashMap[String,Array[Byte] =&gt; AnyRef]">fromBinaryMap</a>.<span title="(key: String)Option[Array[Byte] =&gt; AnyRef]">get</span><span class="delimiter">(</span><a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinary(4478669bff).manifest" title="String">manifest</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="Array[Byte] =&gt; AnyRef" id="akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinary(4478669bff).f">f</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinary(4478669bff).f" title="(v1: Array[Byte])AnyRef">f</a><span class="delimiter">(</span><a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinary(4478669bff).bytes" title="Array[Byte]">bytes</a><span class="delimiter">)</span>
      case <span title="None.type">None</span> ⇒ throw new <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span>
        <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Unimplemented deserialization of message with manifest [&quot;)">Unimplemented deserialization of message with manifest [$</span><a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer.fromBinary(4478669bff).manifest" title="String">manifest</a><span title="String(&quot;] in [&quot;)">] in [$</span><span class="delimiter">{</span><a href="#akka.cluster.singleton.protobuf;ClusterSingletonMessageSerializer" title="()Class[_]">getClass</a>.<span title="()String">getName</span><span class="delimiter">}</span><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>

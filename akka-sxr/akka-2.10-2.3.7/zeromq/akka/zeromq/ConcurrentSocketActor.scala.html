<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>zeromq/akka/zeromq/ConcurrentSocketActor.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> akka.zeromq

<span class="keyword">import</span> org.zeromq.<span title="org.zeromq.ZMQ.type">ZMQ</span>.<span class="delimiter">{</span> Socket, Poller <span class="delimiter">}</span>
<span class="keyword">import</span> org.zeromq.<span class="delimiter">{</span> ZMQ ⇒ JZMQ <span class="delimiter">}</span>
<span class="keyword">import</span> akka.actor._
<span class="keyword">import</span> scala.collection.immutable
<span class="keyword">import</span> scala.annotation.tailrec
<span class="keyword">import</span> scala.concurrent.<span class="delimiter">{</span> Promise, Future <span class="delimiter">}</span>
<span class="keyword">import</span> scala.concurrent.duration.Duration
<span class="keyword">import</span> scala.collection.mutable.ListBuffer
<span class="keyword">import</span> scala.util.control.NonFatal
<span class="keyword">import</span> akka.event.Logging
<span class="keyword">import</span> java.util.concurrent.TimeUnit
<span class="keyword">import</span> akka.util.ByteString

<span class="keyword">private</span><span class="delimiter">[</span>zeromq<span class="delimiter">]</span> <span class="keyword">object</span> <a title="akka.zeromq.ConcurrentSocketActor.type" id="akka.zeromq.ConcurrentSocketActor">ConcurrentSocketActor</a> <a href="#akka.zeromq.ConcurrentSocketActor" title="akka.zeromq.ConcurrentSocketActor.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait PollMsg extends AnyRef" id="akka.zeromq.ConcurrentSocketActor;PollMsg">PollMsg</a>
  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#akka.zeromq.ConcurrentSocketActor.Poll.productElement.x$1" title="akka.zeromq.ConcurrentSocketActor.Poll.type" id="akka.zeromq.ConcurrentSocketActor.Poll.readResolve">Poll</a> <span title="Product" class="keyword">extends</span> <a href="#akka.zeromq.ConcurrentSocketActor;PollMsg" title="akka.zeromq.ConcurrentSocketActor.PollMsg">PollMsg</a>
  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#akka.zeromq.ConcurrentSocketActor.PollCareful.productElement.x$1" title="akka.zeromq.ConcurrentSocketActor.PollCareful.type" id="akka.zeromq.ConcurrentSocketActor.PollCareful.readResolve">PollCareful</a> <span title="Product" class="keyword">extends</span> <a href="#akka.zeromq.ConcurrentSocketActor;PollMsg" title="akka.zeromq.ConcurrentSocketActor.PollMsg">PollMsg</a>

  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#akka.zeromq.ConcurrentSocketActor.Flush.productElement.x$1" title="akka.zeromq.ConcurrentSocketActor.Flush.type" id="akka.zeromq.ConcurrentSocketActor.Flush.readResolve">Flush</a>

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class NoSocketHandleException extends Exception" id="akka.zeromq.ConcurrentSocketActor;NoSocketHandleException">NoSocketHandleException</a><a href="#akka.zeromq.ConcurrentSocketActor;NoSocketHandleException" title="akka.zeromq.ConcurrentSocketActor.NoSocketHandleException" class="delimiter">(</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="Exception">Exception</span><span class="delimiter">(</span><span title="String(&quot;Couldn\'t create a zeromq socket.&quot;)" class="string">&quot;Couldn't create a zeromq socket.&quot;</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="akka.zeromq.Context" id="akka.zeromq.ConcurrentSocketActor.DefaultContext">DefaultContext</a> = <a href="SocketOption.scala.html#akka.zeromq.Context.apply" title="(numIoThreads: Int)akka.zeromq.Context">Context</a><span class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>
<span title="AnyRef" class="keyword">private</span><span class="delimiter">[</span>zeromq<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class ConcurrentSocketActor extends AnyRef with akka.actor.Actor" id="akka.zeromq;ConcurrentSocketActor">ConcurrentSocketActor</a><a href="#akka.zeromq;ConcurrentSocketActor" title="akka.zeromq.ConcurrentSocketActor" class="delimiter">(</a><a title="scala.collection.immutable.Seq[akka.zeromq.SocketOption]" id="akka.zeromq;ConcurrentSocketActor.params">params</a>: immutable.<span title="scala.collection.immutable.Seq[akka.zeromq.SocketOption]">Seq</span><span class="delimiter">[</span>SocketOption<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor" title="akka.actor.Actor">Actor</a> <span class="delimiter">{</span>

  <span class="keyword">import</span> <a href="#akka.zeromq.ConcurrentSocketActor" title="akka.zeromq.ConcurrentSocketActor.type">ConcurrentSocketActor</a>._
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="akka.zeromq.Context" id="akka.zeromq;ConcurrentSocketActor.zmqContext">zmqContext</a> = <a href="#akka.zeromq;ConcurrentSocketActor.params" title="scala.collection.immutable.Seq[akka.zeromq.SocketOption]">params</a> <span title="(pf: PartialFunction[akka.zeromq.SocketOption,akka.zeromq.Context])Option[akka.zeromq.Context]">collectFirst</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[akka.zeromq.SocketOption,akka.zeromq.Context] with Serializable" id="akka.zeromq;ConcurrentSocketActor.zmqContext;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a> <span class="keyword">case</span> <a title="akka.zeromq.Context" id="akka.zeromq;ConcurrentSocketActor.zmqContext;$anonfun.isDefinedAt.c">c</a>: <a href="SocketOption.scala.html#akka.zeromq;Context" title="akka.zeromq.Context">Context</a> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.zmqContext;$anonfun.isDefinedAt.c" title="akka.zeromq.Context">c</a> <span class="delimiter">}</span> <span title="(default: =&gt; akka.zeromq.Context)akka.zeromq.Context">getOrElse</span> <a href="#akka.zeromq.ConcurrentSocketActor.DefaultContext" title="=&gt; akka.zeromq.Context">DefaultContext</a>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="akka.zeromq.Deserializer" id="akka.zeromq;ConcurrentSocketActor.deserializer_=">deserializer</a> = <a href="#akka.zeromq;ConcurrentSocketActor.params" title="scala.collection.immutable.Seq[akka.zeromq.SocketOption]">params</a> <span title="(pf: PartialFunction[akka.zeromq.SocketOption,akka.zeromq.Deserializer])Option[akka.zeromq.Deserializer]">collectFirst</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[akka.zeromq.SocketOption,akka.zeromq.Deserializer] with Serializable" id="akka.zeromq;ConcurrentSocketActor.deserializer;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a> <span class="keyword">case</span> <a title="akka.zeromq.Deserializer" id="akka.zeromq;ConcurrentSocketActor.deserializer;$anonfun.isDefinedAt.d">d</a>: <a href="SocketOption.scala.html#akka.zeromq;Deserializer" title="akka.zeromq.Deserializer">Deserializer</a> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.deserializer;$anonfun.isDefinedAt.d" title="akka.zeromq.Deserializer">d</a> <span class="delimiter">}</span> <span title="(default: =&gt; akka.zeromq.Deserializer)akka.zeromq.Deserializer">getOrElse</span> <span title="akka.zeromq.ZMQMessageDeserializer" class="keyword">new</span> <a href="ZMQMessageDeserializer.scala.html#akka.zeromq;ZMQMessageDeserializer" title="akka.zeromq.ZMQMessageDeserializer">ZMQMessageDeserializer</a>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="akka.zeromq.SocketType.ZMQSocketType" id="akka.zeromq;ConcurrentSocketActor.socketType">socketType</a> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="SocketOption.scala.html#akka.zeromq.SocketType" title="akka.zeromq.SocketType.type">SocketType</a>.<span class="delimiter">{</span> ZMQSocketType ⇒ ST <span class="delimiter">}</span>
    <a href="#akka.zeromq;ConcurrentSocketActor.params" title="scala.collection.immutable.Seq[akka.zeromq.SocketOption]">params</a>.<span title="(pf: PartialFunction[akka.zeromq.SocketOption,akka.zeromq.SocketType.ZMQSocketType])Option[akka.zeromq.SocketType.ZMQSocketType]">collectFirst</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[akka.zeromq.SocketOption,akka.zeromq.SocketType.ZMQSocketType] with Serializable" id="akka.zeromq;ConcurrentSocketActor.socketType;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a> <span class="keyword">case</span> <a title="akka.zeromq.SocketType.ZMQSocketType" id="akka.zeromq;ConcurrentSocketActor.socketType;$anonfun.isDefinedAt.t">t</a>: <a href="SocketOption.scala.html#akka.zeromq.SocketType;ZMQSocketType" title="akka.zeromq.SocketType.ZMQSocketType">ST</a> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socketType;$anonfun.isDefinedAt.t" title="akka.zeromq.SocketType.ZMQSocketType">t</a> <span class="delimiter">}</span>.<span title="(default: =&gt; akka.zeromq.SocketType.ZMQSocketType)akka.zeromq.SocketType.ZMQSocketType">getOrElse</span><span class="delimiter">(</span><span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="String(&quot;A socket type is required&quot;)" class="string">&quot;A socket type is required&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="org.zeromq.ZMQ.Socket" id="akka.zeromq;ConcurrentSocketActor.socket">socket</a>: <span title="org.zeromq.ZMQ.Socket">Socket</span> = <a href="#akka.zeromq;ConcurrentSocketActor.zmqContext" title="=&gt; akka.zeromq.Context">zmqContext</a>.<a href="SocketOption.scala.html#akka.zeromq;Context.socket" title="(socketType: akka.zeromq.SocketType.ZMQSocketType)org.zeromq.ZMQ.Socket">socket</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.socketType" title="=&gt; akka.zeromq.SocketType.ZMQSocketType">socketType</a><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="org.zeromq.ZMQ.Poller" id="akka.zeromq;ConcurrentSocketActor.poller">poller</a>: <span title="org.zeromq.ZMQ.Poller">Poller</span> = <a href="#akka.zeromq;ConcurrentSocketActor.zmqContext" title="=&gt; akka.zeromq.Context">zmqContext</a>.<a href="SocketOption.scala.html#akka.zeromq;Context.poller" title="=&gt; org.zeromq.ZMQ.Poller">poller</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[scala.collection.immutable.Seq[akka.util.ByteString]]" id="akka.zeromq;ConcurrentSocketActor.pendingSends">pendingSends</a> = <span title="scala.collection.mutable.ListBuffer[scala.collection.immutable.Seq[akka.util.ByteString]]" class="keyword">new</span> <span title="scala.collection.mutable.ListBuffer[scala.collection.immutable.Seq[akka.util.ByteString]]">ListBuffer</span><span class="delimiter">[</span>immutable.Seq<span class="delimiter">[</span>ByteString<span class="delimiter">]</span><span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="=&gt; PartialFunction[Any,Unit]" id="akka.zeromq;ConcurrentSocketActor.receive">receive</a> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.zeromq;ConcurrentSocketActor.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    <span class="keyword">case</span> <a title="akka.zeromq.ConcurrentSocketActor.PollMsg" id="akka.zeromq;ConcurrentSocketActor.receive;$anonfun.isDefinedAt.m">m</a>: <a href="#akka.zeromq.ConcurrentSocketActor;PollMsg" title="akka.zeromq.ConcurrentSocketActor.PollMsg">PollMsg</a>         ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.doPoll" title="(mode: akka.zeromq.ConcurrentSocketActor.PollMsg, togo: Int)Unit">doPoll</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.receive;$anonfun.isDefinedAt.m" title="akka.zeromq.ConcurrentSocketActor.PollMsg">m</a><span class="delimiter">)</span>
    <span class="keyword">case</span> ZMQMessage<span class="delimiter">(</span><a title="scala.collection.immutable.Seq[akka.util.ByteString]" id="akka.zeromq;ConcurrentSocketActor.receive;$anonfun.isDefinedAt.frames">frames</a><span class="delimiter">)</span> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.handleRequest" title="(msg: akka.zeromq.Request)Unit">handleRequest</a><span title="Boolean(true)" class="delimiter">(</span><a href="SocketOption.scala.html#akka.zeromq;Send" title="(frames: scala.collection.immutable.Seq[akka.util.ByteString])akka.zeromq.Send">Send</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.receive;$anonfun.isDefinedAt.frames" title="scala.collection.immutable.Seq[akka.util.ByteString]">frames</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="akka.zeromq.Request" id="akka.zeromq;ConcurrentSocketActor.receive;$anonfun.isDefinedAt.r">r</a>: <a href="SocketOption.scala.html#akka.zeromq;Request" title="akka.zeromq.Request">Request</a>         ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.handleRequest" title="(msg: akka.zeromq.Request)Unit">handleRequest</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.receive;$anonfun.isDefinedAt.r" title="akka.zeromq.Request">r</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="#akka.zeromq.ConcurrentSocketActor.Flush.readResolve" title="akka.zeromq.ConcurrentSocketActor.Flush.type">Flush</a>              ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.flush" title="()Unit">flush</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Terminated<span class="delimiter">(</span>_<span class="delimiter">)</span>      ⇒ <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a> <a href="../../../actor/akka/actor/ActorRefProvider.scala.html#akka.actor;ActorRefFactory.stop" title="(actor: akka.actor.ActorRef)Unit">stop</a> <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(msg: akka.zeromq.Request)Unit" id="akka.zeromq;ConcurrentSocketActor.handleRequest">handleRequest</a><span class="delimiter">(</span><a title="akka.zeromq.Request" id="akka.zeromq;ConcurrentSocketActor.handleRequest.msg">msg</a>: <a href="SocketOption.scala.html#akka.zeromq;Request" title="akka.zeromq.Request">Request</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.zeromq;ConcurrentSocketActor.handleRequest.msg" title="akka.zeromq.Request">msg</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Send<span class="delimiter">(</span><a title="scala.collection.immutable.Seq[akka.util.ByteString]" id="akka.zeromq;ConcurrentSocketActor.handleRequest.frames">frames</a><span class="delimiter">)</span> ⇒
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.handleRequest.frames" title="scala.collection.immutable.Seq[akka.util.ByteString]">frames</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Boolean" id="akka.zeromq;ConcurrentSocketActor.handleRequest.flushNow">flushNow</a> = <a href="#akka.zeromq;ConcurrentSocketActor.pendingSends" title="=&gt; scala.collection.mutable.ListBuffer[scala.collection.immutable.Seq[akka.util.ByteString]]">pendingSends</a>.<span title="=&gt; Boolean">isEmpty</span>
        <a href="#akka.zeromq;ConcurrentSocketActor.pendingSends" title="=&gt; scala.collection.mutable.ListBuffer[scala.collection.immutable.Seq[akka.util.ByteString]]">pendingSends</a>.<span title="(elems: scala.collection.immutable.Seq[akka.util.ByteString]*)Unit">append</span><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.handleRequest.frames" title="scala.collection.immutable.Seq[akka.util.ByteString]">frames</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.handleRequest.flushNow" title="Boolean">flushNow</a><span class="delimiter">)</span> <a href="#akka.zeromq;ConcurrentSocketActor.flush" title="()Unit">flush</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="keyword">case</span> <a title="akka.zeromq.SocketOption" id="akka.zeromq;ConcurrentSocketActor.handleRequest.opt">opt</a>: <a href="SocketOption.scala.html#akka.zeromq;SocketOption" title="akka.zeromq.SocketOption">SocketOption</a>    ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.handleSocketOption" title="(msg: akka.zeromq.SocketOption)Unit">handleSocketOption</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.handleRequest.opt" title="akka.zeromq.SocketOption">opt</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="akka.zeromq.SocketOptionQuery" id="akka.zeromq;ConcurrentSocketActor.handleRequest.q">q</a>: <a href="SocketOption.scala.html#akka.zeromq;SocketOptionQuery" title="akka.zeromq.SocketOptionQuery">SocketOptionQuery</a> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.handleSocketOptionQuery" title="(msg: akka.zeromq.SocketOptionQuery)Unit">handleSocketOptionQuery</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.handleRequest.q" title="akka.zeromq.SocketOptionQuery">q</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(msg: akka.zeromq.SocketConnectOption)Unit" id="akka.zeromq;ConcurrentSocketActor.handleConnectOption">handleConnectOption</a><span class="delimiter">(</span><a title="akka.zeromq.SocketConnectOption" id="akka.zeromq;ConcurrentSocketActor.handleConnectOption.msg">msg</a>: <a href="SocketOption.scala.html#akka.zeromq;SocketConnectOption" title="akka.zeromq.SocketConnectOption">SocketConnectOption</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.zeromq;ConcurrentSocketActor.handleConnectOption.msg" title="akka.zeromq.SocketConnectOption">msg</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Connect<span class="delimiter">(</span><span title="String">endpoint</span><span class="delimiter">)</span> ⇒ <span class="delimiter">{</span> <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: String)Unit">connect</span><span class="delimiter">(</span><span title="String">endpoint</span><span class="delimiter">)</span>; <a href="#akka.zeromq;ConcurrentSocketActor.notifyListener" title="(message: Any)Unit">notifyListener</a><span class="delimiter">(</span><a href="Response.scala.html#akka.zeromq.Connecting" title="akka.zeromq.Connecting.type">Connecting</a><span class="delimiter">)</span> <span class="delimiter">}</span>
    <span class="keyword">case</span> Bind<span class="delimiter">(</span><span title="String">endpoint</span><span class="delimiter">)</span>    ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: String)Unit">bind</span><span class="delimiter">(</span><span title="String">endpoint</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(msg: akka.zeromq.PubSubOption)Unit" id="akka.zeromq;ConcurrentSocketActor.handlePubSubOption">handlePubSubOption</a><span class="delimiter">(</span><a title="akka.zeromq.PubSubOption" id="akka.zeromq;ConcurrentSocketActor.handlePubSubOption.msg">msg</a>: <a href="SocketOption.scala.html#akka.zeromq;PubSubOption" title="akka.zeromq.PubSubOption">PubSubOption</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.zeromq;ConcurrentSocketActor.handlePubSubOption.msg" title="akka.zeromq.PubSubOption">msg</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Subscribe<span class="delimiter">(</span><span title="akka.util.ByteString">topic</span><span class="delimiter">)</span>   ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Array[Byte])Unit">subscribe</span><span class="delimiter">(</span><span title="akka.util.ByteString">topic</span>.<a href="../../../actor/akka/util/ByteString.scala.html#akka.util;ByteString.toArray(89cec3ba6b)" title="(implicit arg0: scala.reflect.ClassTag[Byte])Array[Byte]">toArray</a><span class="delimiter">)</span>
    <span class="keyword">case</span> Unsubscribe<span class="delimiter">(</span><span title="akka.util.ByteString">topic</span><span class="delimiter">)</span> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Array[Byte])Unit">unsubscribe</span><span class="delimiter">(</span><span title="akka.util.ByteString">topic</span>.<a href="../../../actor/akka/util/ByteString.scala.html#akka.util;ByteString.toArray(89cec3ba6b)" title="(implicit arg0: scala.reflect.ClassTag[Byte])Array[Byte]">toArray</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(msg: akka.zeromq.SocketOption)Unit" id="akka.zeromq;ConcurrentSocketActor.handleSocketOption">handleSocketOption</a><span class="delimiter">(</span><a title="akka.zeromq.SocketOption" id="akka.zeromq;ConcurrentSocketActor.handleSocketOption.msg">msg</a>: <a href="SocketOption.scala.html#akka.zeromq;SocketOption" title="akka.zeromq.SocketOption">SocketOption</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.zeromq;ConcurrentSocketActor.handleSocketOption.msg" title="akka.zeromq.SocketOption">msg</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="akka.zeromq.SocketMeta" id="akka.zeromq;ConcurrentSocketActor.handleSocketOption.x">x</a>: <a href="SocketOption.scala.html#akka.zeromq;SocketMeta" title="akka.zeromq.SocketMeta">SocketMeta</a>               ⇒ <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalStateException" class="keyword">new</span> <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;SocketMeta &quot;)" class="string">&quot;SocketMeta &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#akka.zeromq;ConcurrentSocketActor.handleSocketOption.x" title="akka.zeromq.SocketMeta">x</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; only allowed for setting up a socket&quot;)" class="string">&quot; only allowed for setting up a socket&quot;</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="akka.zeromq.SocketConnectOption" id="akka.zeromq;ConcurrentSocketActor.handleSocketOption.c">c</a>: <a href="SocketOption.scala.html#akka.zeromq;SocketConnectOption" title="akka.zeromq.SocketConnectOption">SocketConnectOption</a>      ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.handleConnectOption" title="(msg: akka.zeromq.SocketConnectOption)Unit">handleConnectOption</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.handleSocketOption.c" title="akka.zeromq.SocketConnectOption">c</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="akka.zeromq.PubSubOption" id="akka.zeromq;ConcurrentSocketActor.handleSocketOption.ps">ps</a>: <a href="SocketOption.scala.html#akka.zeromq;PubSubOption" title="akka.zeromq.PubSubOption">PubSubOption</a>            ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.handlePubSubOption" title="(msg: akka.zeromq.PubSubOption)Unit">handlePubSubOption</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.handleSocketOption.ps" title="akka.zeromq.PubSubOption">ps</a><span class="delimiter">)</span>
    <span class="keyword">case</span> Linger<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>               ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setLinger</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> ReconnectIVL<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>         ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setReconnectIVL</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Backlog<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>              ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setBacklog</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> ReconnectIVLMax<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>      ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setReconnectIVLMax</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> MaxMsgSize<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>           ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setMaxMsgSize</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> SendHighWatermark<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>    ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setSndHWM</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> ReceiveHighWatermark<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setRcvHWM</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> HighWatermark<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>        ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setHWM</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Swap<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>                 ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setSwap</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Affinity<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>             ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setAffinity</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Identity<span class="delimiter">(</span><span title="Array[Byte]">value</span><span class="delimiter">)</span>             ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Array[Byte])Unit">setIdentity</span><span class="delimiter">(</span><span title="Array[Byte]">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Rate<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>                 ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setRate</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> RecoveryInterval<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>     ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setRecoveryInterval</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> MulticastLoop<span class="delimiter">(</span><span title="Boolean">value</span><span class="delimiter">)</span>        ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Boolean)Unit">setMulticastLoop</span><span class="delimiter">(</span><span title="Boolean">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> MulticastHops<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>        ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setMulticastHops</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> SendBufferSize<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>       ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setSendBufferSize</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> ReceiveBufferSize<span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>    ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Long)Unit">setReceiveBufferSize</span><span class="delimiter">(</span><span title="Long">value</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="akka.zeromq.Deserializer" id="akka.zeromq;ConcurrentSocketActor.handleSocketOption.d">d</a>: <a href="SocketOption.scala.html#akka.zeromq;Deserializer" title="akka.zeromq.Deserializer">Deserializer</a>             ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.deserializer_=" title="(x$1: akka.zeromq.Deserializer)Unit">deserializer</a> = <a href="#akka.zeromq;ConcurrentSocketActor.handleSocketOption.d" title="akka.zeromq.Deserializer">d</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(msg: akka.zeromq.SocketOptionQuery)Unit" id="akka.zeromq;ConcurrentSocketActor.handleSocketOptionQuery">handleSocketOptionQuery</a><span class="delimiter">(</span><a title="akka.zeromq.SocketOptionQuery" id="akka.zeromq;ConcurrentSocketActor.handleSocketOptionQuery.msg">msg</a>: <a href="SocketOption.scala.html#akka.zeromq;SocketOptionQuery" title="akka.zeromq.SocketOptionQuery">SocketOptionQuery</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.sender" title="()akka.actor.ActorRef">sender</a><a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef" class="delimiter">(</a><span class="delimiter">)</span> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.handleSocketOptionQuery.msg" title="akka.zeromq.SocketOptionQuery">msg</a> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.Linger" title="akka.zeromq.Linger.type">Linger</a>               ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getLinger</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.ReconnectIVL" title="akka.zeromq.ReconnectIVL.type">ReconnectIVL</a>         ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getReconnectIVL</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.Backlog" title="akka.zeromq.Backlog.type">Backlog</a>              ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getBacklog</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.ReconnectIVLMax" title="akka.zeromq.ReconnectIVLMax.type">ReconnectIVLMax</a>      ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getReconnectIVLMax</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.MaxMsgSize" title="akka.zeromq.MaxMsgSize.type">MaxMsgSize</a>           ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getMaxMsgSize</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.SendHighWatermark" title="akka.zeromq.SendHighWatermark.type">SendHighWatermark</a>    ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getSndHWM</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.ReceiveHighWatermark" title="akka.zeromq.ReceiveHighWatermark.type">ReceiveHighWatermark</a> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getRcvHWM</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.Swap" title="akka.zeromq.Swap.type">Swap</a>                 ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getSwap</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.Affinity" title="akka.zeromq.Affinity.type">Affinity</a>             ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getAffinity</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.Identity" title="akka.zeromq.Identity.type">Identity</a>             ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Array[Byte]">getIdentity</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.Rate" title="akka.zeromq.Rate.type">Rate</a>                 ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getRate</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.RecoveryInterval" title="akka.zeromq.RecoveryInterval.type">RecoveryInterval</a>     ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getRecoveryInterval</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.MulticastLoop" title="akka.zeromq.MulticastLoop.type">MulticastLoop</a>        ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Boolean">hasMulticastLoop</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.MulticastHops" title="akka.zeromq.MulticastHops.type">MulticastHops</a>        ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getMulticastHops</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.SendBufferSize" title="akka.zeromq.SendBufferSize.type">SendBufferSize</a>       ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getSendBufferSize</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.ReceiveBufferSize" title="akka.zeromq.ReceiveBufferSize.type">ReceiveBufferSize</a>    ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getReceiveBufferSize</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.FileDescriptor" title="akka.zeromq.FileDescriptor.type">FileDescriptor</a>       ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Long">getFD</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="akka.zeromq;ConcurrentSocketActor.preStart">preStart</a> <span class="delimiter">{</span>
    <a href="#akka.zeromq;ConcurrentSocketActor.watchListener" title="()Unit">watchListener</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.zeromq;ConcurrentSocketActor.setupSocket" title="()Unit">setupSocket</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.zeromq;ConcurrentSocketActor.poller" title="=&gt; org.zeromq.ZMQ.Poller">poller</a>.<span title="(x$1: org.zeromq.ZMQ.Socket, x$2: Int)Int">register</span><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>, <span title="org.zeromq.ZMQ.Poller.type">Poller</span>.<span title="Int">POLLIN</span><span class="delimiter">)</span>
    <a href="#akka.zeromq;ConcurrentSocketActor.setupConnection" title="()Unit">setupConnection</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">import</span> <a href="SocketOption.scala.html#akka.zeromq.SocketType" title="akka.zeromq.SocketType.type">SocketType</a>._
    <a href="#akka.zeromq;ConcurrentSocketActor.socketType" title="=&gt; akka.zeromq.SocketType.ZMQSocketType">socketType</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.SocketType.Pub" title="akka.zeromq.SocketType.Pub.type">Pub</a> | <a href="SocketOption.scala.html#akka.zeromq.SocketType.Push" title="akka.zeromq.SocketType.Push.type">Push</a>                          ⇒ <span class="comment">// don’t poll</span>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.SocketType.Sub" title="akka.zeromq.SocketType.Sub.type">Sub</a> | <a href="SocketOption.scala.html#akka.zeromq.SocketType.Pull" title="akka.zeromq.SocketType.Pull.type">Pull</a> | <a href="SocketOption.scala.html#akka.zeromq.SocketType.Pair" title="akka.zeromq.SocketType.Pair.type">Pair</a> | <a href="SocketOption.scala.html#akka.zeromq.SocketType.Dealer" title="akka.zeromq.SocketType.Dealer.type">Dealer</a> | <a href="SocketOption.scala.html#akka.zeromq.SocketType.Router" title="akka.zeromq.SocketType.Router.type">Router</a> ⇒ <a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.zeromq.ConcurrentSocketActor.Poll.readResolve" title="akka.zeromq.ConcurrentSocketActor.Poll.type">Poll</a>
      <span class="keyword">case</span> <a href="SocketOption.scala.html#akka.zeromq.SocketType.Req" title="akka.zeromq.SocketType.Req.type">Req</a> | <a href="SocketOption.scala.html#akka.zeromq.SocketType.Rep" title="akka.zeromq.SocketType.Rep.type">Rep</a>                           ⇒ <a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.zeromq.ConcurrentSocketActor.PollCareful.readResolve" title="akka.zeromq.ConcurrentSocketActor.PollCareful.type">PollCareful</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="akka.zeromq;ConcurrentSocketActor.setupConnection">setupConnection</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.zeromq;ConcurrentSocketActor.params" title="scala.collection.immutable.Seq[akka.zeromq.SocketOption]">params</a> <span title="(p: akka.zeromq.SocketOption =&gt; Boolean)scala.collection.immutable.Seq[akka.zeromq.SocketOption]">filter</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.setupConnection.$anonfun.x$1" title="akka.zeromq.SocketOption">_</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="SocketOption.scala.html#akka.zeromq;SocketConnectOption" title="akka.zeromq.SocketConnectOption">SocketConnectOption</a><span class="delimiter">]</span><span class="delimiter">)</span> <span title="(f: akka.zeromq.SocketOption =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.zeromq;ConcurrentSocketActor.setupConnection.$anonfun.x$2" title="akka.zeromq.SocketOption">_</a> <span class="delimiter">}</span>
    <a href="#akka.zeromq;ConcurrentSocketActor.params" title="scala.collection.immutable.Seq[akka.zeromq.SocketOption]">params</a> <span title="(p: akka.zeromq.SocketOption =&gt; Boolean)scala.collection.immutable.Seq[akka.zeromq.SocketOption]">filter</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.setupConnection.$anonfun.x$3" title="akka.zeromq.SocketOption">_</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="SocketOption.scala.html#akka.zeromq;PubSubOption" title="akka.zeromq.PubSubOption">PubSubOption</a><span class="delimiter">]</span><span class="delimiter">)</span> <span title="(f: akka.zeromq.SocketOption =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.zeromq;ConcurrentSocketActor.setupConnection.$anonfun.x$4" title="akka.zeromq.SocketOption">_</a> <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="akka.zeromq;ConcurrentSocketActor.setupSocket">setupSocket</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#akka.zeromq;ConcurrentSocketActor.params" title="scala.collection.immutable.Seq[akka.zeromq.SocketOption]">params</a> <span title="(f: akka.zeromq.SocketOption =&gt; Unit)Unit">foreach</span> <a href="#akka.zeromq;ConcurrentSocketActor.setupSocket.$anonfun.x0$1" title="Unit" class="delimiter">{</a>
    <span class="keyword">case</span> _: <a href="SocketOption.scala.html#akka.zeromq;SocketConnectOption" title="akka.zeromq.SocketConnectOption">SocketConnectOption</a> | _: <a href="SocketOption.scala.html#akka.zeromq;PubSubOption" title="akka.zeromq.PubSubOption">PubSubOption</a> | _: <a href="SocketOption.scala.html#akka.zeromq;SocketMeta" title="akka.zeromq.SocketMeta">SocketMeta</a> ⇒ <span class="comment">// ignore, handled differently</span>
    <span class="keyword">case</span> <a title="akka.zeromq.SocketOption" id="akka.zeromq;ConcurrentSocketActor.setupSocket.$anonfun.m">m</a> ⇒ <a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.zeromq;ConcurrentSocketActor.setupSocket.$anonfun.m" title="akka.zeromq.SocketOption">m</a>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(reason: Throwable, message: Option[Any])Unit" id="akka.zeromq;ConcurrentSocketActor.preRestart">preRestart</a><span class="delimiter">(</span><a title="Throwable" id="akka.zeromq;ConcurrentSocketActor.preRestart.reason">reason</a>: <span title="Throwable">Throwable</span>, <a title="Option[Any]" id="akka.zeromq;ConcurrentSocketActor.preRestart.message">message</a>: <span title="Option[Any]">Option</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.children" title="=&gt; scala.collection.immutable.Iterable[akka.actor.ActorRef]">children</a> <span title="(f: akka.actor.ActorRef =&gt; Unit)Unit">foreach</span> <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../actor/akka/actor/ActorRefProvider.scala.html#akka.actor;ActorRefFactory.stop" title="(actor: akka.actor.ActorRef)Unit">stop</a> <span class="comment">//Do not call postStop</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(reason: Throwable)Unit" id="akka.zeromq;ConcurrentSocketActor.postRestart">postRestart</a><span class="delimiter">(</span><a title="Throwable" id="akka.zeromq;ConcurrentSocketActor.postRestart.reason">reason</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span> <span class="comment">// Do nothing</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="akka.zeromq;ConcurrentSocketActor.postStop">postStop</a>: <span title="Unit">Unit</span> = <span class="keyword">try</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.zeromq;ConcurrentSocketActor.poller" title="=&gt; org.zeromq.ZMQ.Poller">poller</a>.<span title="(x$1: org.zeromq.ZMQ.Socket)Unit">unregister</span><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a><span class="delimiter">)</span>
      <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Unit">close</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span> <span class="keyword">finally</span> <a href="#akka.zeromq;ConcurrentSocketActor.notifyListener" title="(message: Any)Unit">notifyListener</a><span class="delimiter">(</span><a href="Response.scala.html#akka.zeromq.Closed" title="akka.zeromq.Closed.type">Closed</a><span class="delimiter">)</span>

  @tailrec <span class="keyword">private</span> <span class="keyword">def</span> <a title="(i: scala.collection.immutable.Seq[akka.util.ByteString])Boolean" id="akka.zeromq;ConcurrentSocketActor.flushMessage">flushMessage</a><span class="delimiter">(</span><a title="scala.collection.immutable.Seq[akka.util.ByteString]" id="akka.zeromq;ConcurrentSocketActor.flushMessage.i">i</a>: immutable.<span title="scala.collection.immutable.Seq[akka.util.ByteString]">Seq</span><span class="delimiter">[</span>ByteString<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
    <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.flushMessage.i" title="scala.collection.immutable.Seq[akka.util.ByteString]">i</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
      <span title="Boolean(true)" class="keyword">true</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="akka.util.ByteString" id="akka.zeromq;ConcurrentSocketActor.flushMessage.head">head</a> = <a href="#akka.zeromq;ConcurrentSocketActor.flushMessage.i" title="scala.collection.immutable.Seq[akka.util.ByteString]">i</a>.<span title="=&gt; akka.util.ByteString">head</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.Seq[akka.util.ByteString]" id="akka.zeromq;ConcurrentSocketActor.flushMessage.tail">tail</a> = <a href="#akka.zeromq;ConcurrentSocketActor.flushMessage.i" title="scala.collection.immutable.Seq[akka.util.ByteString]">i</a>.<span title="=&gt; scala.collection.immutable.Seq[akka.util.ByteString]">tail</span>
      <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Array[Byte], x$2: Int)Boolean">send</span><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.flushMessage.head" title="akka.util.ByteString">head</a>.<a href="../../../actor/akka/util/ByteString.scala.html#akka.util;ByteString.toArray(89cec3ba6b)" title="(implicit arg0: scala.reflect.ClassTag[Byte])Array[Byte]">toArray</a>, <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.flushMessage.tail" title="scala.collection.immutable.Seq[akka.util.ByteString]">tail</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span title="org.zeromq.ZMQ.type">JZMQ</span>.<span title="Int">SNDMORE</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#akka.zeromq;ConcurrentSocketActor.flushMessage" title="(i: scala.collection.immutable.Seq[akka.util.ByteString])Boolean">flushMessage</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.flushMessage.tail" title="scala.collection.immutable.Seq[akka.util.ByteString]">tail</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#akka.zeromq;ConcurrentSocketActor.pendingSends" title="=&gt; scala.collection.mutable.ListBuffer[scala.collection.immutable.Seq[akka.util.ByteString]]">pendingSends</a>.<span title="(elems: scala.collection.immutable.Seq[akka.util.ByteString]*)Unit">prepend</span><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.flushMessage.i" title="scala.collection.immutable.Seq[akka.util.ByteString]">i</a><span class="delimiter">)</span> <span class="comment">// Reenqueue the rest of the message so the next flush takes care of it</span>
        <a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.zeromq.ConcurrentSocketActor.Flush.readResolve" title="akka.zeromq.ConcurrentSocketActor.Flush.type">Flush</a>
        <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  @tailrec <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="akka.zeromq;ConcurrentSocketActor.flush">flush</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.pendingSends" title="=&gt; scala.collection.mutable.ListBuffer[scala.collection.immutable.Seq[akka.util.ByteString]]">pendingSends</a>.<span title="=&gt; Boolean">nonEmpty</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#akka.zeromq;ConcurrentSocketActor.flushMessage" title="(i: scala.collection.immutable.Seq[akka.util.ByteString])Boolean">flushMessage</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.pendingSends" title="=&gt; scala.collection.mutable.ListBuffer[scala.collection.immutable.Seq[akka.util.ByteString]]">pendingSends</a>.<span title="(n: Int)scala.collection.immutable.Seq[akka.util.ByteString]">remove</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#akka.zeromq;ConcurrentSocketActor.flush" title="()Unit">flush</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="comment">// Flush while things are going well</span>

  <span class="comment">// this is a “PollMsg=&gt;Unit” which either polls or schedules Poll, depending on the sign of the timeout</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="akka.zeromq.ConcurrentSocketActor.PollMsg =&gt; Unit" id="akka.zeromq;ConcurrentSocketActor.doPollTimeout">doPollTimeout</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="akka.zeromq.ZeroMQExtension" id="akka.zeromq;ConcurrentSocketActor.doPollTimeout.ext">ext</a> = <a href="../../../actor/akka/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.zeromq.ZeroMQExtension">ZeroMQExtension</a><span class="delimiter">(</span><a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Option[scala.concurrent.duration.FiniteDuration]" id="akka.zeromq;ConcurrentSocketActor.doPollTimeout.fromConfig">fromConfig</a> = <a href="#akka.zeromq;ConcurrentSocketActor.params" title="scala.collection.immutable.Seq[akka.zeromq.SocketOption]">params</a> <span title="(pf: PartialFunction[akka.zeromq.SocketOption,scala.concurrent.duration.FiniteDuration])Option[scala.concurrent.duration.FiniteDuration]">collectFirst</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[akka.zeromq.SocketOption,scala.concurrent.duration.FiniteDuration] with Serializable" id="akka.zeromq;ConcurrentSocketActor.doPollTimeout.fromConfig;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a> <span class="keyword">case</span> PollTimeoutDuration<span class="delimiter">(</span><a title="scala.concurrent.duration.FiniteDuration" id="akka.zeromq;ConcurrentSocketActor.doPollTimeout.fromConfig;$anonfun.isDefinedAt.duration">duration</a><span class="delimiter">)</span> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.fromConfig;$anonfun.isDefinedAt.duration" title="scala.concurrent.duration.FiniteDuration">duration</a> <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="scala.concurrent.duration.FiniteDuration" id="akka.zeromq;ConcurrentSocketActor.doPollTimeout.duration">duration</a> = <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.fromConfig" title="Option[scala.concurrent.duration.FiniteDuration]">fromConfig</a> <span title="(default: =&gt; scala.concurrent.duration.FiniteDuration)scala.concurrent.duration.FiniteDuration">getOrElse</span> <a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.ext" title="akka.zeromq.ZeroMQExtension">ext</a>.<a href="ZeroMQExtension.scala.html#akka.zeromq;ZeroMQExtension.DefaultPollTimeout" title="=&gt; scala.concurrent.duration.FiniteDuration">DefaultPollTimeout</a><span class="delimiter">)</span>
    <span title="akka.zeromq.ConcurrentSocketActor.PollMsg =&gt; Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.duration" title="scala.concurrent.duration.FiniteDuration">duration</a> <span title="(that: scala.concurrent.duration.Duration)Boolean">&gt;</span> <span title="scala.concurrent.duration.Duration.type">Duration</span>.<span title="=&gt; scala.concurrent.duration.FiniteDuration">Zero</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">// for positive timeout values, do poll (i.e. block this thread)</span>
      <span class="keyword">val</span> <a title="Long" id="akka.zeromq;ConcurrentSocketActor.doPollTimeout.pollLength">pollLength</a> = <a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.duration" title="scala.concurrent.duration.FiniteDuration">duration</a>.<span title="(u: scala.concurrent.duration.TimeUnit)Double">toUnit</span><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.ext" title="akka.zeromq.ZeroMQExtension">ext</a>.<a href="ZeroMQExtension.scala.html#akka.zeromq;ZeroMQExtension.pollTimeUnit" title="=&gt; java.util.concurrent.TimeUnit">pollTimeUnit</a><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span>
      <span class="delimiter">(</span>msg: <a href="#akka.zeromq.ConcurrentSocketActor;PollMsg" title="akka.zeromq.ConcurrentSocketActor.PollMsg">PollMsg</a><span class="delimiter">)</span> ⇒
        <a href="#akka.zeromq;ConcurrentSocketActor.poller" title="=&gt; org.zeromq.ZMQ.Poller">poller</a>.<span title="(x$1: Long)Long">poll</span><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.pollLength" title="Long">pollLength</a><span class="delimiter">)</span>
        <a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.$anonfun.msg" title="akka.zeromq.ConcurrentSocketActor.PollMsg">msg</a>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.concurrent.duration.FiniteDuration" id="akka.zeromq;ConcurrentSocketActor.doPollTimeout.d">d</a> = <span title="=&gt; scala.concurrent.duration.FiniteDuration">-</span><a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.duration" title="scala.concurrent.duration.FiniteDuration">duration</a>

      <span class="delimiter">{</span> <span class="delimiter">(</span>msg: <a href="#akka.zeromq.ConcurrentSocketActor;PollMsg" title="akka.zeromq.ConcurrentSocketActor.PollMsg">PollMsg</a><span class="delimiter">)</span> ⇒
        <span class="comment">// for negative timeout values, schedule Poll token -duration into the future</span>
        <span class="keyword">import</span> <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.dispatcher
        <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a>.<a href="../../../actor/akka/actor/ActorSystem.scala.html#akka.actor;ActorSystem.scheduler" title="=&gt; akka.actor.Scheduler">scheduler</a>.<a href="../../../actor/akka/actor/Scheduler.scala.html#akka.actor;Scheduler.scheduleOnce(a2d55b51db)" title="(delay: scala.concurrent.duration.FiniteDuration, receiver: akka.actor.ActorRef, message: Any)(implicit executor: scala.concurrent.ExecutionContext, implicit sender: akka.actor.ActorRef)akka.actor.Cancellable">scheduleOnce</a><a href="../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.dispatcher" title="=&gt; scala.concurrent.ExecutionContextExecutor" class="delimiter">(</a><a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.d" title="scala.concurrent.duration.FiniteDuration">d</a>, <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>, <a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout.$anonfun.msg" title="akka.zeromq.ConcurrentSocketActor.PollMsg">msg</a><span class="delimiter">)</span>
        <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  @tailrec <span class="keyword">private</span> <span class="keyword">def</span> <a title="(mode: akka.zeromq.ConcurrentSocketActor.PollMsg, togo: Int)Unit" id="akka.zeromq;ConcurrentSocketActor.doPoll">doPoll</a><span class="delimiter">(</span><a title="akka.zeromq.ConcurrentSocketActor.PollMsg" id="akka.zeromq;ConcurrentSocketActor.doPoll.mode">mode</a>: <a href="#akka.zeromq.ConcurrentSocketActor;PollMsg" title="akka.zeromq.ConcurrentSocketActor.PollMsg">PollMsg</a>, <a title="Int" id="akka.zeromq;ConcurrentSocketActor.doPoll$default$2">togo</a>: <span title="Int">Int</span> = <span title="Int(10)" class="int">10</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.doPoll$default$2" title="Int">togo</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.zeromq;ConcurrentSocketActor.doPoll.mode" title="akka.zeromq.ConcurrentSocketActor.PollMsg">mode</a>
    <span class="keyword">else</span> <a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage" title="(mode: akka.zeromq.ConcurrentSocketActor.PollMsg, currentFrames: Vector[akka.util.ByteString])scala.collection.immutable.Seq[akka.util.ByteString]">receiveMessage</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.doPoll.mode" title="akka.zeromq.ConcurrentSocketActor.PollMsg">mode</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#akka.zeromq;ConcurrentSocketActor.doPoll.<unapply-selector>" title="(x: Seq[akka.util.ByteString])Some[Seq[akka.util.ByteString]]">Seq</a><span class="delimiter">(</span><span class="delimiter">)</span>  ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.doPollTimeout" title="(v1: akka.zeromq.ConcurrentSocketActor.PollMsg)Unit">doPollTimeout</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.doPoll.mode" title="akka.zeromq.ConcurrentSocketActor.PollMsg">mode</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="scala.collection.immutable.Seq[akka.util.ByteString]" id="akka.zeromq;ConcurrentSocketActor.doPoll.frames">frames</a> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.notifyListener" title="(message: Any)Unit">notifyListener</a><span class="delimiter">(</span><a href="SocketOption.scala.html#akka.zeromq;Deserializer.apply" title="(frames: scala.collection.immutable.Seq[akka.util.ByteString])Any">deserializer</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.doPoll.frames" title="scala.collection.immutable.Seq[akka.util.ByteString]">frames</a><span class="delimiter">)</span><span class="delimiter">)</span>; <a href="#akka.zeromq;ConcurrentSocketActor.doPoll" title="(mode: akka.zeromq.ConcurrentSocketActor.PollMsg, togo: Int)Unit">doPoll</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.doPoll.mode" title="akka.zeromq.ConcurrentSocketActor.PollMsg">mode</a>, <a href="#akka.zeromq;ConcurrentSocketActor.doPoll$default$2" title="Int">togo</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  @tailrec <span class="keyword">private</span> <span class="keyword">def</span> <a title="(mode: akka.zeromq.ConcurrentSocketActor.PollMsg, currentFrames: Vector[akka.util.ByteString])scala.collection.immutable.Seq[akka.util.ByteString]" id="akka.zeromq;ConcurrentSocketActor.receiveMessage">receiveMessage</a><span class="delimiter">(</span><a title="akka.zeromq.ConcurrentSocketActor.PollMsg" id="akka.zeromq;ConcurrentSocketActor.receiveMessage.mode">mode</a>: <a href="#akka.zeromq.ConcurrentSocketActor;PollMsg" title="akka.zeromq.ConcurrentSocketActor.PollMsg">PollMsg</a>, <a title="Vector[akka.util.ByteString]" id="akka.zeromq;ConcurrentSocketActor.receiveMessage$default$2">currentFrames</a>: <span title="Vector[akka.util.ByteString]">Vector</span><span class="delimiter">[</span>ByteString<span class="delimiter">]</span> = <span title="=&gt; collection.immutable.Vector.type">Vector</span>.<span title="scala.collection.immutable.Vector[Nothing]">empty</span><span class="delimiter">)</span>: immutable.<span title="scala.collection.immutable.Seq[akka.util.ByteString]">Seq</span><span class="delimiter">[</span>ByteString<span class="delimiter">]</span> =
    <span title="scala.collection.immutable.Seq[akka.util.ByteString]" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage.mode" title="akka.zeromq.ConcurrentSocketActor.PollMsg">mode</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.zeromq.ConcurrentSocketActor.PollCareful.readResolve" title="akka.zeromq.ConcurrentSocketActor.PollCareful.type">PollCareful</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.poller" title="=&gt; org.zeromq.ZMQ.Poller">poller</a>.<span title="(x$1: Long)Long">poll</span><span class="delimiter">(</span><span title="Long(0L)" class="int">0</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="scala.collection.immutable.Seq[akka.util.ByteString]" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage$default$2" title="Vector[akka.util.ByteString]">currentFrames</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage$default$2" title="Vector[akka.util.ByteString]">currentFrames</a> <span class="keyword">else</span> <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalStateException" class="keyword">new</span> <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;Received partial transmission!&quot;)" class="string">&quot;Received partial transmission!&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="(x$1: Int)Array[Byte]">recv</span><span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage.mode" title="akka.zeromq.ConcurrentSocketActor.PollMsg">mode</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.zeromq.ConcurrentSocketActor.Poll.readResolve" title="akka.zeromq.ConcurrentSocketActor.Poll.type">Poll</a><span class="delimiter">)</span> <span title="org.zeromq.ZMQ.type">JZMQ</span>.<span title="Int">NOBLOCK</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="scala.collection.immutable.Seq[akka.util.ByteString]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Null(null)" class="keyword">null</span> ⇒ <span class="comment">/*EAGAIN*/</span>
          <span title="scala.collection.immutable.Seq[akka.util.ByteString]" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage$default$2" title="Vector[akka.util.ByteString]">currentFrames</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage$default$2" title="Vector[akka.util.ByteString]">currentFrames</a> <span class="keyword">else</span> <a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage" title="(mode: akka.zeromq.ConcurrentSocketActor.PollMsg, currentFrames: Vector[akka.util.ByteString])scala.collection.immutable.Seq[akka.util.ByteString]">receiveMessage</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage.mode" title="akka.zeromq.ConcurrentSocketActor.PollMsg">mode</a>, <a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage$default$2" title="Vector[akka.util.ByteString]">currentFrames</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a title="Array[Byte]" id="akka.zeromq;ConcurrentSocketActor.receiveMessage.bytes">bytes</a> ⇒
          <span class="keyword">val</span> <a title="scala.collection.immutable.Vector[akka.util.ByteString]" id="akka.zeromq;ConcurrentSocketActor.receiveMessage.frames">frames</a> = <a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage$default$2" title="Vector[akka.util.ByteString]">currentFrames</a> <span title="(elem: akka.util.ByteString)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector[akka.util.ByteString],akka.util.ByteString,scala.collection.immutable.Vector[akka.util.ByteString]])scala.collection.immutable.Vector[akka.util.ByteString]">:+</span> <a href="../../../actor/akka/util/ByteString.scala.html#akka.util.ByteString.apply(a619a7682d)" title="(bytes: Array[Byte])akka.util.ByteString">ByteString</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage.bytes" title="Array[Byte]">bytes</a><span class="delimiter">)</span>
          <span title="scala.collection.immutable.Seq[akka.util.ByteString]" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.socket" title="=&gt; org.zeromq.ZMQ.Socket">socket</a>.<span title="()Boolean">hasReceiveMore</span><span class="delimiter">)</span> <a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage" title="(mode: akka.zeromq.ConcurrentSocketActor.PollMsg, currentFrames: Vector[akka.util.ByteString])scala.collection.immutable.Seq[akka.util.ByteString]">receiveMessage</a><span class="delimiter">(</span><a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage.mode" title="akka.zeromq.ConcurrentSocketActor.PollMsg">mode</a>, <a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage.frames" title="scala.collection.immutable.Vector[akka.util.ByteString]">frames</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#akka.zeromq;ConcurrentSocketActor.receiveMessage.frames" title="scala.collection.immutable.Vector[akka.util.ByteString]">frames</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Option[akka.actor.ActorRef]" id="akka.zeromq;ConcurrentSocketActor.listenerOpt">listenerOpt</a> = <a href="#akka.zeromq;ConcurrentSocketActor.params" title="scala.collection.immutable.Seq[akka.zeromq.SocketOption]">params</a> <span title="(pf: PartialFunction[akka.zeromq.SocketOption,akka.actor.ActorRef])Option[akka.actor.ActorRef]">collectFirst</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[akka.zeromq.SocketOption,akka.actor.ActorRef] with Serializable" id="akka.zeromq;ConcurrentSocketActor.listenerOpt;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a> <span class="keyword">case</span> Listener<span class="delimiter">(</span><a title="akka.actor.ActorRef" id="akka.zeromq;ConcurrentSocketActor.listenerOpt;$anonfun.isDefinedAt.l">l</a><span class="delimiter">)</span> ⇒ <a href="#akka.zeromq;ConcurrentSocketActor.listenerOpt;$anonfun.isDefinedAt.l" title="akka.actor.ActorRef">l</a> <span class="delimiter">}</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="akka.zeromq;ConcurrentSocketActor.watchListener">watchListener</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.zeromq;ConcurrentSocketActor.listenerOpt" title="=&gt; Option[akka.actor.ActorRef]">listenerOpt</a> <span title="(f: akka.actor.ActorRef =&gt; akka.actor.ActorRef)Unit">foreach</span> <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.watch" title="(subject: akka.actor.ActorRef)akka.actor.ActorRef">watch</a>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(message: Any)Unit" id="akka.zeromq;ConcurrentSocketActor.notifyListener">notifyListener</a><span class="delimiter">(</span><a title="Any" id="akka.zeromq;ConcurrentSocketActor.notifyListener.message">message</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.zeromq;ConcurrentSocketActor.listenerOpt" title="=&gt; Option[akka.actor.ActorRef]">listenerOpt</a> <span title="(f: akka.actor.ActorRef =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">_</a> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.zeromq;ConcurrentSocketActor.notifyListener.message" title="Any">message</a> <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

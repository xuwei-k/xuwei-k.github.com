<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>akka-cluster/cluster/ClusterMetricsCollector.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>

<span class="keyword">package</span> akka.cluster

<span class="keyword">import</span> java.io.Closeable
<span class="keyword">import</span> java.lang.<span title="System.type">System</span>.<span class="delimiter">{</span> currentTimeMillis ⇒ newTimestamp <span class="delimiter">}</span>
<span class="keyword">import</span> java.lang.management.<span class="delimiter">{</span> OperatingSystemMXBean, MemoryMXBean, ManagementFactory <span class="delimiter">}</span>
<span class="keyword">import</span> java.lang.reflect.InvocationTargetException
<span class="keyword">import</span> java.lang.reflect.Method
<span class="keyword">import</span> scala.collection.immutable
<span class="keyword">import</span> scala.concurrent.duration._
<span class="keyword">import</span> scala.concurrent.forkjoin.ThreadLocalRandom
<span class="keyword">import</span> scala.util.<span class="delimiter">{</span> Try, Success, Failure <span class="delimiter">}</span>
<span class="keyword">import</span> akka.ConfigurationException
<span class="keyword">import</span> akka.actor.Actor
<span class="keyword">import</span> akka.actor.ActorLogging
<span class="keyword">import</span> akka.actor.ActorRef
<span class="keyword">import</span> akka.actor.ActorSystem
<span class="keyword">import</span> akka.actor.Address
<span class="keyword">import</span> akka.actor.DynamicAccess
<span class="keyword">import</span> akka.actor.ExtendedActorSystem
<span class="keyword">import</span> akka.cluster.<a href="Member.scala.html#akka.cluster.MemberStatus" title="akka.cluster.MemberStatus.type">MemberStatus</a>.Up
<span class="keyword">import</span> akka.event.Logging
<span class="keyword">import</span> java.lang.management.MemoryUsage

<span class="comment">/**
 * INTERNAL API.
 *
 * Cluster metrics is primarily for load-balancing of nodes. It controls metrics sampling
 * at a regular frequency, prepares highly variable data for further analysis by other entities,
 * and publishes the latest cluster metrics data around the node ring and local eventStream
 * to assist in determining the need to redirect traffic to the least-loaded nodes.
 *
 * Metrics sampling is delegated to the [[akka.cluster.MetricsCollector]].
 *
 * Smoothing of the data for each monitored process is delegated to the
 * [[akka.cluster.EWMA]] for exponential weighted moving average.
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>cluster<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class ClusterMetricsCollector extends AnyRef with akka.actor.Actor with akka.actor.ActorLogging" id="akka.cluster;ClusterMetricsCollector">ClusterMetricsCollector</a><a href="#akka.cluster;ClusterMetricsCollector" title="akka.cluster.ClusterMetricsCollector" class="delimiter">(</a><a title="akka.actor.ActorRef" id="akka.cluster;ClusterMetricsCollector.publisher">publisher</a>: <a href="../../akka-actor/actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../akka-actor/actor/Actor.scala.html#akka.actor;Actor" title="akka.actor.Actor">Actor</a> <span class="keyword">with</span> <a href="../../akka-actor/actor/Actor.scala.html#akka.actor;ActorLogging" title="akka.actor.ActorLogging">ActorLogging</a> <span class="delimiter">{</span>

  <span class="keyword">import</span> <a href="ClusterDaemon.scala.html#akka.cluster.InternalClusterAction" title="akka.cluster.InternalClusterAction.type">InternalClusterAction</a>._
  <span class="keyword">import</span> <a href="ClusterEvent.scala.html#akka.cluster.ClusterEvent" title="akka.cluster.ClusterEvent.type">ClusterEvent</a>._
  <span class="keyword">import</span> <a href="Member.scala.html#akka.cluster.Member" title="akka.cluster.Member.type">Member</a>.addressOrdering
  <span class="keyword">import</span> <a href="../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.dispatcher
  <span class="keyword">val</span> <a title="akka.cluster.Cluster" id="akka.cluster;ClusterMetricsCollector.cluster">cluster</a> = <a href="../../akka-actor/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.cluster.Cluster">Cluster</a><span class="delimiter">(</span><a href="../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../akka-actor/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a><span class="delimiter">)</span>
  <span class="keyword">import</span> <a href="#akka.cluster;ClusterMetricsCollector.cluster" title="=&gt; akka.cluster.Cluster">cluster</a>.<span class="delimiter">{</span> selfAddress, scheduler, settings <span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="#akka.cluster;ClusterMetricsCollector.cluster" title="=&gt; akka.cluster.Cluster">cluster</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.settings" title="=&gt; akka.cluster.ClusterSettings">settings</a>._
  <span class="keyword">import</span> <a href="#akka.cluster;ClusterMetricsCollector.cluster" title="=&gt; akka.cluster.Cluster">cluster</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.InfoLogger" title="ClusterMetricsCollector.this.cluster.InfoLogger.type">InfoLogger</a>._

  <span class="comment">/**
   * The node ring gossipped that contains only members that are Up.
   */</span>
  <span class="keyword">var</span> <a title="scala.collection.immutable.SortedSet[akka.actor.Address]" id="akka.cluster;ClusterMetricsCollector.nodes_=">nodes</a>: immutable.<span title="scala.collection.immutable.SortedSet[akka.actor.Address]">SortedSet</span><span class="delimiter">[</span>Address<span class="delimiter">]</span> = immutable.<span title="scala.collection.immutable.SortedSet.type">SortedSet</span>.<a href="Member.scala.html#akka.cluster.Member.addressOrdering" title="(implicit ord: Ordering[akka.actor.Address])scala.collection.immutable.SortedSet[akka.actor.Address]">empty</a>

  <span class="comment">/**
   * The latest metric values with their statistical data.
   */</span>
  <span class="keyword">var</span> <a title="akka.cluster.MetricsGossip" id="akka.cluster;ClusterMetricsCollector.latestGossip_=">latestGossip</a>: <a href="#akka.cluster;MetricsGossip.equals" title="akka.cluster.MetricsGossip">MetricsGossip</a> = <a href="#akka.cluster.MetricsGossip.readResolve" title="akka.cluster.MetricsGossip.type">MetricsGossip</a>.<a href="#akka.cluster.MetricsGossip.empty" title="=&gt; akka.cluster.MetricsGossip">empty</a>

  <span class="comment">/**
   * The metrics collector that samples data on the node.
   */</span>
  <span class="keyword">val</span> <a title="akka.cluster.MetricsCollector" id="akka.cluster;ClusterMetricsCollector.collector">collector</a>: <a href="#akka.cluster;MetricsCollector" title="akka.cluster.MetricsCollector">MetricsCollector</a> = <a href="#akka.cluster.MetricsCollector.apply" title="(system: akka.actor.ExtendedActorSystem, settings: akka.cluster.ClusterSettings)akka.cluster.MetricsCollector">MetricsCollector</a><span class="delimiter">(</span><a href="../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../akka-actor/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.actor.ExtendedActorSystem" class="delimiter">[</span><a href="../../akka-actor/actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem" title="akka.actor.ExtendedActorSystem">ExtendedActorSystem</a><span class="delimiter">]</span>, <a href="Cluster.scala.html#akka.cluster;Cluster.settings" title="=&gt; akka.cluster.ClusterSettings">settings</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Start periodic gossip to random nodes in cluster
   */</span>
  <span class="keyword">val</span> <a title="akka.actor.Cancellable" id="akka.cluster;ClusterMetricsCollector.gossipTask">gossipTask</a> = <a href="Cluster.scala.html#akka.cluster;Cluster.scheduler" title="=&gt; akka.actor.Scheduler">scheduler</a>.<a href="../../akka-actor/actor/Scheduler.scala.html#akka.actor;Scheduler.schedule(abf8206fc2)" title="(initialDelay: scala.concurrent.duration.FiniteDuration, interval: scala.concurrent.duration.FiniteDuration, receiver: akka.actor.ActorRef, message: Any)(implicit executor: scala.concurrent.ExecutionContext, implicit sender: akka.actor.ActorRef)akka.actor.Cancellable">schedule</a><a href="../../akka-actor/actor/ActorCell.scala.html#akka.actor;ActorContext.dispatcher" title="=&gt; scala.concurrent.ExecutionContextExecutor" class="delimiter">(</a><a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.PeriodicTasksInitialDelay" title="=&gt; scala.concurrent.duration.FiniteDuration">PeriodicTasksInitialDelay</a> <span title="(other: scala.concurrent.duration.FiniteDuration)scala.concurrent.duration.FiniteDuration">max</span> <a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsGossipInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">MetricsGossipInterval</a>,
    <a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsGossipInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">MetricsGossipInterval</a>, <a href="../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>, <a href="ClusterDaemon.scala.html#akka.cluster.InternalClusterAction.GossipTick" title="akka.cluster.InternalClusterAction.GossipTick.type">GossipTick</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Start periodic metrics collection
   */</span>
  <span class="keyword">val</span> <a title="akka.actor.Cancellable" id="akka.cluster;ClusterMetricsCollector.metricsTask">metricsTask</a> = <a href="Cluster.scala.html#akka.cluster;Cluster.scheduler" title="=&gt; akka.actor.Scheduler">scheduler</a>.<a href="../../akka-actor/actor/Scheduler.scala.html#akka.actor;Scheduler.schedule(abf8206fc2)" title="(initialDelay: scala.concurrent.duration.FiniteDuration, interval: scala.concurrent.duration.FiniteDuration, receiver: akka.actor.ActorRef, message: Any)(implicit executor: scala.concurrent.ExecutionContext, implicit sender: akka.actor.ActorRef)akka.actor.Cancellable">schedule</a><a href="../../akka-actor/actor/ActorCell.scala.html#akka.actor;ActorContext.dispatcher" title="=&gt; scala.concurrent.ExecutionContextExecutor" class="delimiter">(</a><a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.PeriodicTasksInitialDelay" title="=&gt; scala.concurrent.duration.FiniteDuration">PeriodicTasksInitialDelay</a> <span title="(other: scala.concurrent.duration.FiniteDuration)scala.concurrent.duration.FiniteDuration">max</span> <a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">MetricsInterval</a>,
    <a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">MetricsInterval</a>, <a href="../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>, <a href="ClusterDaemon.scala.html#akka.cluster.InternalClusterAction.MetricsTick" title="akka.cluster.InternalClusterAction.MetricsTick.type">MetricsTick</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="akka.cluster;ClusterMetricsCollector.preStart">preStart</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster;ClusterMetricsCollector.cluster" title="=&gt; akka.cluster.Cluster">cluster</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.subscribe(6cfb44d410)" title="(subscriber: akka.actor.ActorRef, to: Class[_]*)Unit">subscribe</a><span class="delimiter">(</span><a href="../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>, classOf<span title="Class[akka.cluster.ClusterEvent.MemberEvent](classOf[akka.cluster.ClusterEvent$$MemberEvent])" class="delimiter">[</span>MemberEvent<span class="delimiter">]</span>, classOf<span title="Class[akka.cluster.ClusterEvent.ReachabilityEvent](classOf[akka.cluster.ClusterEvent$$ReachabilityEvent])" class="delimiter">[</span>ReachabilityEvent<span class="delimiter">]</span><span class="delimiter">)</span>
    <a href="Cluster.scala.html#akka.cluster;Cluster.InfoLogger.logInfo(cc2e600322)" title="(message: String)Unit">logInfo</a><span class="delimiter">(</span><span title="String(&quot;Metrics collection has started successfully&quot;)" class="string">&quot;Metrics collection has started successfully&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; PartialFunction[Any,Unit]" id="akka.cluster;ClusterMetricsCollector.receive">receive</a> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.cluster;ClusterMetricsCollector.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    <span class="keyword">case</span> <a href="ClusterDaemon.scala.html#akka.cluster.InternalClusterAction.GossipTick" title="akka.cluster.InternalClusterAction.GossipTick.type">GossipTick</a>                 ⇒ <a href="#akka.cluster;ClusterMetricsCollector.gossip" title="()Unit">gossip</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="ClusterDaemon.scala.html#akka.cluster.InternalClusterAction.MetricsTick" title="akka.cluster.InternalClusterAction.MetricsTick.type">MetricsTick</a>                ⇒ <a href="#akka.cluster;ClusterMetricsCollector.collect" title="()Unit">collect</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="akka.cluster.MetricsGossipEnvelope" id="akka.cluster;ClusterMetricsCollector.receive;$anonfun.isDefinedAt.msg">msg</a>: <a href="#akka.cluster.MetricsGossipEnvelope.readResolve" title="akka.cluster.MetricsGossipEnvelope">MetricsGossipEnvelope</a> ⇒ <a href="#akka.cluster;ClusterMetricsCollector.receiveGossip" title="(envelope: akka.cluster.MetricsGossipEnvelope)Unit">receiveGossip</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.receive;$anonfun.isDefinedAt.msg" title="akka.cluster.MetricsGossipEnvelope">msg</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="akka.cluster.ClusterEvent.CurrentClusterState" id="akka.cluster;ClusterMetricsCollector.receive;$anonfun.isDefinedAt.state">state</a>: <a href="ClusterEvent.scala.html#akka.cluster.ClusterEvent;CurrentClusterState" title="akka.cluster.ClusterEvent.CurrentClusterState">CurrentClusterState</a> ⇒ <a href="#akka.cluster;ClusterMetricsCollector.receiveState" title="(state: akka.cluster.ClusterEvent.CurrentClusterState)Unit">receiveState</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.receive;$anonfun.isDefinedAt.state" title="akka.cluster.ClusterEvent.CurrentClusterState">state</a><span class="delimiter">)</span>
    <span class="keyword">case</span> MemberUp<span class="delimiter">(</span><span title="akka.cluster.Member">m</span><span class="delimiter">)</span>                ⇒ <a href="#akka.cluster;ClusterMetricsCollector.addMember" title="(member: akka.cluster.Member)Unit">addMember</a><span title="Boolean(true)" class="delimiter">(</span><span title="akka.cluster.Member">m</span><span class="delimiter">)</span>
    <span class="keyword">case</span> MemberRemoved<span class="delimiter">(</span><span title="akka.cluster.Member">m</span>, _<span class="delimiter">)</span>        ⇒ <a href="#akka.cluster;ClusterMetricsCollector.removeMember" title="(member: akka.cluster.Member)Unit">removeMember</a><span title="Boolean(true)" class="delimiter">(</span><span title="akka.cluster.Member">m</span><span class="delimiter">)</span>
    <span class="keyword">case</span> MemberExited<span class="delimiter">(</span><span title="akka.cluster.Member">m</span><span class="delimiter">)</span>            ⇒ <a href="#akka.cluster;ClusterMetricsCollector.removeMember" title="(member: akka.cluster.Member)Unit">removeMember</a><span title="Boolean(true)" class="delimiter">(</span><span title="akka.cluster.Member">m</span><span class="delimiter">)</span>
    <span class="keyword">case</span> UnreachableMember<span class="delimiter">(</span><span title="akka.cluster.Member">m</span><span class="delimiter">)</span>       ⇒ <a href="#akka.cluster;ClusterMetricsCollector.removeMember" title="(member: akka.cluster.Member)Unit">removeMember</a><span title="Boolean(true)" class="delimiter">(</span><span title="akka.cluster.Member">m</span><span class="delimiter">)</span>
    <span class="keyword">case</span> ReachableMember<span class="delimiter">(</span><span title="akka.cluster.Member">m</span><span class="delimiter">)</span>         ⇒ <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="akka.cluster.Member">m</span>.<a href="Member.scala.html#akka.cluster;Member.status" title="=&gt; akka.cluster.MemberStatus">status</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="Member.scala.html#akka.cluster.MemberStatus.Up" title="akka.cluster.MemberStatus.Up.type">Up</a><span class="delimiter">)</span> <a href="#akka.cluster;ClusterMetricsCollector.addMember" title="(member: akka.cluster.Member)Unit">addMember</a><span class="delimiter">(</span><span title="akka.cluster.Member">m</span><span class="delimiter">)</span>
    <span class="keyword">case</span> _: <a href="ClusterEvent.scala.html#akka.cluster.ClusterEvent;MemberEvent" title="akka.cluster.ClusterEvent.MemberEvent">MemberEvent</a>             ⇒ <span class="comment">// not interested in other types of MemberEvent</span>

  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="akka.cluster;ClusterMetricsCollector.postStop">postStop</a>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster;ClusterMetricsCollector.cluster" title="=&gt; akka.cluster.Cluster">cluster</a> <a href="Cluster.scala.html#akka.cluster;Cluster.unsubscribe(134bd64d81)" title="(subscriber: akka.actor.ActorRef)Unit">unsubscribe</a> <a href="../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>
    <a href="#akka.cluster;ClusterMetricsCollector.gossipTask" title="=&gt; akka.actor.Cancellable">gossipTask</a>.<a href="../../akka-actor/actor/Scheduler.scala.html#akka.actor;Cancellable.cancel" title="()Boolean">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.cluster;ClusterMetricsCollector.metricsTask" title="=&gt; akka.actor.Cancellable">metricsTask</a>.<a href="../../akka-actor/actor/Scheduler.scala.html#akka.actor;Cancellable.cancel" title="()Boolean">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.cluster;ClusterMetricsCollector.collector" title="=&gt; akka.cluster.MetricsCollector">collector</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Adds a member to the node ring.
   */</span>
  <span class="keyword">def</span> <a title="(member: akka.cluster.Member)Unit" id="akka.cluster;ClusterMetricsCollector.addMember">addMember</a><span class="delimiter">(</span><a title="akka.cluster.Member" id="akka.cluster;ClusterMetricsCollector.addMember.member">member</a>: <a href="Member.scala.html#akka.cluster;Member" title="akka.cluster.Member">Member</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.cluster;ClusterMetricsCollector.nodes_=" title="(x$1: scala.collection.immutable.SortedSet[akka.actor.Address])Unit">nodes</a> <span title="(elem: akka.actor.Address)scala.collection.immutable.SortedSet[akka.actor.Address]">+=</span> <a href="#akka.cluster;ClusterMetricsCollector.addMember.member" title="akka.cluster.Member">member</a>.<a href="Member.scala.html#akka.cluster;Member.address" title="=&gt; akka.actor.Address">address</a>

  <span class="comment">/**
   * Removes a member from the member node ring.
   */</span>
  <span class="keyword">def</span> <a title="(member: akka.cluster.Member)Unit" id="akka.cluster;ClusterMetricsCollector.removeMember">removeMember</a><span class="delimiter">(</span><a title="akka.cluster.Member" id="akka.cluster;ClusterMetricsCollector.removeMember.member">member</a>: <a href="Member.scala.html#akka.cluster;Member" title="akka.cluster.Member">Member</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster;ClusterMetricsCollector.nodes_=" title="(x$1: scala.collection.immutable.SortedSet[akka.actor.Address])Unit">nodes</a> <span title="(elem: akka.actor.Address)scala.collection.immutable.SortedSet[akka.actor.Address]">-=</span> <a href="#akka.cluster;ClusterMetricsCollector.removeMember.member" title="akka.cluster.Member">member</a>.<a href="Member.scala.html#akka.cluster;Member.address" title="=&gt; akka.actor.Address">address</a>
    <a href="#akka.cluster;ClusterMetricsCollector.latestGossip_=" title="(x$1: akka.cluster.MetricsGossip)Unit">latestGossip</a> = <a href="#akka.cluster;ClusterMetricsCollector.latestGossip_=" title="=&gt; akka.cluster.MetricsGossip">latestGossip</a> <a href="#akka.cluster;MetricsGossip.remove" title="(node: akka.actor.Address)akka.cluster.MetricsGossip">remove</a> <a href="#akka.cluster;ClusterMetricsCollector.removeMember.member" title="akka.cluster.Member">member</a>.<a href="Member.scala.html#akka.cluster;Member.address" title="=&gt; akka.actor.Address">address</a>
    <a href="#akka.cluster;ClusterMetricsCollector.publish" title="()Unit">publish</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Updates the initial node ring for those nodes that are [[akka.cluster.MemberStatus.Up]].
   */</span>
  <span class="keyword">def</span> <a title="(state: akka.cluster.ClusterEvent.CurrentClusterState)Unit" id="akka.cluster;ClusterMetricsCollector.receiveState">receiveState</a><span class="delimiter">(</span><a title="akka.cluster.ClusterEvent.CurrentClusterState" id="akka.cluster;ClusterMetricsCollector.receiveState.state">state</a>: <a href="ClusterEvent.scala.html#akka.cluster.ClusterEvent;CurrentClusterState" title="akka.cluster.ClusterEvent.CurrentClusterState">CurrentClusterState</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a href="#akka.cluster;ClusterMetricsCollector.nodes_=" title="(x$1: scala.collection.immutable.SortedSet[akka.actor.Address])Unit">nodes</a> = <a href="#akka.cluster;ClusterMetricsCollector.receiveState.state" title="akka.cluster.ClusterEvent.CurrentClusterState">state</a>.<a href="ClusterEvent.scala.html#akka.cluster.ClusterEvent;CurrentClusterState.members" title="=&gt; scala.collection.immutable.SortedSet[akka.cluster.Member]">members</a> <a href="Member.scala.html#akka.cluster.Member.addressOrdering" title="(pf: PartialFunction[akka.cluster.Member,akka.actor.Address])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.SortedSet[akka.cluster.Member],akka.actor.Address,scala.collection.immutable.SortedSet[akka.actor.Address]])scala.collection.immutable.SortedSet[akka.actor.Address]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[akka.cluster.Member,akka.actor.Address] with Serializable" id="akka.cluster;ClusterMetricsCollector.receiveState;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a> <span class="keyword">case</span> <a title="akka.cluster.Member" id="akka.cluster;ClusterMetricsCollector.receiveState;$anonfun.isDefinedAt.m">m</a> <span class="keyword">if</span> <a href="#akka.cluster;ClusterMetricsCollector.receiveState;$anonfun.isDefinedAt.m" title="akka.cluster.Member">m</a>.<a href="Member.scala.html#akka.cluster;Member.status" title="=&gt; akka.cluster.MemberStatus">status</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="Member.scala.html#akka.cluster.MemberStatus.Up" title="akka.cluster.MemberStatus.Up.type">Up</a> ⇒ <a href="#akka.cluster;ClusterMetricsCollector.receiveState;$anonfun.isDefinedAt.m" title="akka.cluster.Member">m</a>.<a href="Member.scala.html#akka.cluster;Member.address" title="=&gt; akka.actor.Address">address</a> <span class="delimiter">}</span>

  <span class="comment">/**
   * Samples the latest metrics for the node, updates metrics statistics in
   * [[akka.cluster.MetricsGossip]], and publishes the change to the event bus.
   *
   * @see [[akka.cluster.ClusterMetricsCollector.collect( )]]
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="akka.cluster;ClusterMetricsCollector.collect">collect</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster;ClusterMetricsCollector.latestGossip_=" title="(x$1: akka.cluster.MetricsGossip)Unit">latestGossip</a> <a href="#akka.cluster;MetricsGossip.:+" title="(newNodeMetrics: akka.cluster.NodeMetrics)akka.cluster.MetricsGossip">:+=</a> <a href="#akka.cluster;ClusterMetricsCollector.collector" title="=&gt; akka.cluster.MetricsCollector">collector</a>.<a href="#akka.cluster;MetricsCollector.sample" title="()akka.cluster.NodeMetrics">sample</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.cluster;ClusterMetricsCollector.publish" title="()Unit">publish</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Receives changes from peer nodes, merges remote with local gossip nodes, then publishes
   * changes to the event stream for load balancing router consumption, and gossip back.
   */</span>
  <span class="keyword">def</span> <a title="(envelope: akka.cluster.MetricsGossipEnvelope)Unit" id="akka.cluster;ClusterMetricsCollector.receiveGossip">receiveGossip</a><span class="delimiter">(</span><a title="akka.cluster.MetricsGossipEnvelope" id="akka.cluster;ClusterMetricsCollector.receiveGossip.envelope">envelope</a>: <a href="#akka.cluster.MetricsGossipEnvelope.readResolve" title="akka.cluster.MetricsGossipEnvelope">MetricsGossipEnvelope</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="comment">// remote node might not have same view of member nodes, this side should only care</span>
    <span class="comment">// about nodes that are known here, otherwise removed nodes can come back</span>
    <span class="keyword">val</span> <a title="akka.cluster.MetricsGossip" id="akka.cluster;ClusterMetricsCollector.receiveGossip.otherGossip">otherGossip</a> = <a href="#akka.cluster;ClusterMetricsCollector.receiveGossip.envelope" title="akka.cluster.MetricsGossipEnvelope">envelope</a>.<a href="#akka.cluster;MetricsGossipEnvelope.gossip" title="=&gt; akka.cluster.MetricsGossip">gossip</a>.<a href="#akka.cluster;MetricsGossip.filter" title="(includeNodes: Set[akka.actor.Address])akka.cluster.MetricsGossip">filter</a><span class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.nodes_=" title="=&gt; scala.collection.immutable.SortedSet[akka.actor.Address]">nodes</a><span class="delimiter">)</span>
    <a href="#akka.cluster;ClusterMetricsCollector.latestGossip_=" title="(x$1: akka.cluster.MetricsGossip)Unit">latestGossip</a> = <a href="#akka.cluster;ClusterMetricsCollector.latestGossip_=" title="=&gt; akka.cluster.MetricsGossip">latestGossip</a> <a href="#akka.cluster;MetricsGossip.merge" title="(otherGossip: akka.cluster.MetricsGossip)akka.cluster.MetricsGossip">merge</a> <a href="#akka.cluster;ClusterMetricsCollector.receiveGossip.otherGossip" title="akka.cluster.MetricsGossip">otherGossip</a>
    <span class="comment">// changes will be published in the period collect task</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.cluster;ClusterMetricsCollector.receiveGossip.envelope" title="akka.cluster.MetricsGossipEnvelope">envelope</a>.<a href="#akka.cluster;MetricsGossipEnvelope.reply" title="=&gt; Boolean">reply</a><span class="delimiter">)</span>
      <a href="#akka.cluster;ClusterMetricsCollector.replyGossipTo" title="(address: akka.actor.Address)Unit">replyGossipTo</a><span class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.receiveGossip.envelope" title="akka.cluster.MetricsGossipEnvelope">envelope</a>.<a href="#akka.cluster;MetricsGossipEnvelope.from" title="=&gt; akka.actor.Address">from</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Gossip to peer nodes.
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="akka.cluster;ClusterMetricsCollector.gossip">gossip</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.cluster;ClusterMetricsCollector.selectRandomNode" title="(addresses: scala.collection.immutable.IndexedSeq[akka.actor.Address])Option[akka.actor.Address]">selectRandomNode</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.nodes_=" title="=&gt; scala.collection.immutable.SortedSet[akka.actor.Address]">nodes</a> <span title="(elem: akka.actor.Address)scala.collection.immutable.SortedSet[akka.actor.Address]">-</span> <a href="Cluster.scala.html#akka.cluster;Cluster.selfAddress" title="=&gt; akka.actor.Address">selfAddress</a><span class="delimiter">)</span>.<span title="=&gt; Vector[akka.actor.Address]">toVector</span><span class="delimiter">)</span> <span title="(f: akka.actor.Address =&gt; Unit)Unit">foreach</span> <a href="#akka.cluster;ClusterMetricsCollector.gossipTo" title="(address: akka.actor.Address)Unit">gossipTo</a>

  <span class="keyword">def</span> <a title="(address: akka.actor.Address)Unit" id="akka.cluster;ClusterMetricsCollector.gossipTo">gossipTo</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.cluster;ClusterMetricsCollector.gossipTo.address">address</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a href="#akka.cluster;ClusterMetricsCollector.sendGossip" title="(address: akka.actor.Address, envelope: akka.cluster.MetricsGossipEnvelope)Unit">sendGossip</a><span class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.gossipTo.address" title="akka.actor.Address">address</a>, <a href="#akka.cluster.MetricsGossipEnvelope.readResolve" title="(from: akka.actor.Address, gossip: akka.cluster.MetricsGossip, reply: Boolean)akka.cluster.MetricsGossipEnvelope">MetricsGossipEnvelope</a><span class="delimiter">(</span><a href="Cluster.scala.html#akka.cluster;Cluster.selfAddress" title="=&gt; akka.actor.Address">selfAddress</a>, <a href="#akka.cluster;ClusterMetricsCollector.latestGossip_=" title="=&gt; akka.cluster.MetricsGossip">latestGossip</a>, reply = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(address: akka.actor.Address)Unit" id="akka.cluster;ClusterMetricsCollector.replyGossipTo">replyGossipTo</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.cluster;ClusterMetricsCollector.replyGossipTo.address">address</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a href="#akka.cluster;ClusterMetricsCollector.sendGossip" title="(address: akka.actor.Address, envelope: akka.cluster.MetricsGossipEnvelope)Unit">sendGossip</a><span class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.replyGossipTo.address" title="akka.actor.Address">address</a>, <a href="#akka.cluster.MetricsGossipEnvelope.readResolve" title="(from: akka.actor.Address, gossip: akka.cluster.MetricsGossip, reply: Boolean)akka.cluster.MetricsGossipEnvelope">MetricsGossipEnvelope</a><span class="delimiter">(</span><a href="Cluster.scala.html#akka.cluster;Cluster.selfAddress" title="=&gt; akka.actor.Address">selfAddress</a>, <a href="#akka.cluster;ClusterMetricsCollector.latestGossip_=" title="=&gt; akka.cluster.MetricsGossip">latestGossip</a>, reply = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(address: akka.actor.Address, envelope: akka.cluster.MetricsGossipEnvelope)Unit" id="akka.cluster;ClusterMetricsCollector.sendGossip">sendGossip</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.cluster;ClusterMetricsCollector.sendGossip.address">address</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.cluster.MetricsGossipEnvelope" id="akka.cluster;ClusterMetricsCollector.sendGossip.envelope">envelope</a>: <a href="#akka.cluster.MetricsGossipEnvelope.readResolve" title="akka.cluster.MetricsGossipEnvelope">MetricsGossipEnvelope</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a href="../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../akka-actor/actor/ActorRefProvider.scala.html#akka.actor;ActorRefFactory.actorSelection(271eeb39be)" title="(path: String)akka.actor.ActorSelection">actorSelection</a><a href="../../akka-actor/actor/ActorSelection.scala.html#akka.actor.ActorSelection.toScala" title="implicit akka.actor.ActorSelection.toScala : (sel: akka.actor.ActorSelection)akka.actor.ScalaActorSelection" class="delimiter">(</a><a href="../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>.<a href="../../akka-actor/actor/ActorRef.scala.html#akka.actor;ActorRef.path" title="=&gt; akka.actor.ActorPath">path</a>.<a href="../../akka-actor/actor/ActorPath.scala.html#akka.actor;ActorPath.toStringWithAddress" title="(address: akka.actor.Address)String">toStringWithAddress</a><span class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.sendGossip.address" title="akka.actor.Address">address</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../akka-actor/actor/ActorSelection.scala.html#akka.actor;ScalaActorSelection.!" title="(msg: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.cluster;ClusterMetricsCollector.sendGossip.envelope" title="akka.cluster.MetricsGossipEnvelope">envelope</a>

  <span class="keyword">def</span> <a title="(addresses: scala.collection.immutable.IndexedSeq[akka.actor.Address])Option[akka.actor.Address]" id="akka.cluster;ClusterMetricsCollector.selectRandomNode">selectRandomNode</a><span class="delimiter">(</span><a title="scala.collection.immutable.IndexedSeq[akka.actor.Address]" id="akka.cluster;ClusterMetricsCollector.selectRandomNode.addresses">addresses</a>: immutable.<span title="scala.collection.immutable.IndexedSeq[akka.actor.Address]">IndexedSeq</span><span class="delimiter">[</span>Address<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[akka.actor.Address]">Option</span><span class="delimiter">[</span>Address<span class="delimiter">]</span> =
    <span title="Option[akka.actor.Address]" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.selectRandomNode.addresses" title="scala.collection.immutable.IndexedSeq[akka.actor.Address]">addresses</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span title="None.type">None</span> <span class="keyword">else</span> <span title="(x: akka.actor.Address)Some[akka.actor.Address]">Some</span><span class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.selectRandomNode.addresses" title="(idx: Int)akka.actor.Address">addresses</a><span class="delimiter">(</span><span title="scala.concurrent.forkjoin.ThreadLocalRandom.type">ThreadLocalRandom</span>.<span title="()scala.concurrent.forkjoin.ThreadLocalRandom">current</span> <span title="(x$1: Int)Int">nextInt</span> <a href="#akka.cluster;ClusterMetricsCollector.selectRandomNode.addresses" title="scala.collection.immutable.IndexedSeq[akka.actor.Address]">addresses</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Publishes to the event stream.
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="akka.cluster;ClusterMetricsCollector.publish">publish</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">publisher</a> <a href="../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="ClusterDaemon.scala.html#akka.cluster.InternalClusterAction;PublishEvent" title="(event: akka.cluster.ClusterEvent.ClusterDomainEvent)akka.cluster.InternalClusterAction.PublishEvent">PublishEvent</a><span class="delimiter">(</span><a href="ClusterEvent.scala.html#akka.cluster.ClusterEvent;ClusterMetricsChanged" title="(nodeMetrics: Set[akka.cluster.NodeMetrics])akka.cluster.ClusterEvent.ClusterMetricsChanged">ClusterMetricsChanged</a><span class="delimiter">(</span><a href="#akka.cluster;ClusterMetricsCollector.latestGossip_=" title="=&gt; akka.cluster.MetricsGossip">latestGossip</a>.<a href="#akka.cluster;MetricsGossip.copy$default$1" title="=&gt; Set[akka.cluster.NodeMetrics]">nodes</a><span class="delimiter">)</span><span class="delimiter">)</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>cluster<span class="delimiter">]</span> <span class="keyword">object</span> <a title="akka.cluster.MetricsGossip.type" id="akka.cluster.MetricsGossip.readResolve">MetricsGossip</a> <a href="#akka.cluster.MetricsGossip.readResolve" title="akka.cluster.MetricsGossip.type" class="delimiter">{</a>
  <span class="keyword">val</span> <a title="akka.cluster.MetricsGossip" id="akka.cluster.MetricsGossip.empty">empty</a> = <a href="#akka.cluster;MetricsGossip.equals" title="(nodes: Set[akka.cluster.NodeMetrics])akka.cluster.MetricsGossip">MetricsGossip</a><span class="delimiter">(</span><span title="=&gt; scala.collection.immutable.Set.type">Set</span>.<span title="[A]=&gt; scala.collection.immutable.Set[A]">empty</span><span title="scala.collection.immutable.Set[akka.cluster.NodeMetrics]" class="delimiter">[</span><a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a><span class="delimiter">]</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 *
 * @param nodes metrics per node
 */</span>
@SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
<span class="keyword">private</span><span class="delimiter">[</span>cluster<span class="delimiter">]</span> <span class="keyword">case class</span> <a title="(nodes: Set[akka.cluster.NodeMetrics])akka.cluster.MetricsGossip" id="akka.cluster;MetricsGossip.equals">MetricsGossip</a><a href="#akka.cluster;MetricsGossip.equals" title="Product" class="delimiter">(</a><a title="Set[akka.cluster.NodeMetrics]" id="akka.cluster;MetricsGossip.copy$default$1">nodes</a>: <span title="Set[akka.cluster.NodeMetrics]">Set</span><span class="delimiter">[</span>NodeMetrics<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="comment">/**
   * Removes nodes if their correlating node ring members are not [[akka.cluster.MemberStatus.Up]]
   */</span>
  <span class="keyword">def</span> <a title="(node: akka.actor.Address)akka.cluster.MetricsGossip" id="akka.cluster;MetricsGossip.remove">remove</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.cluster;MetricsGossip.remove.node">node</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <a href="#akka.cluster;MetricsGossip.equals" title="akka.cluster.MetricsGossip">MetricsGossip</a> = <a href="#akka.cluster;MetricsGossip.equals" title="(nodes: Set[akka.cluster.NodeMetrics])akka.cluster.MetricsGossip">copy</a><span class="delimiter">(</span>nodes = <a href="#akka.cluster;MetricsGossip.copy$default$1" title="=&gt; Set[akka.cluster.NodeMetrics]">nodes</a> <span title="(p: akka.cluster.NodeMetrics =&gt; Boolean)scala.collection.immutable.Set[akka.cluster.NodeMetrics]">filterNot</span> <span class="delimiter">(</span><a href="#akka.cluster;MetricsGossip.remove.$anonfun.x$1" title="akka.cluster.NodeMetrics">_</a>.<a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.cluster;MetricsGossip.remove.node" title="akka.actor.Address">node</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Only the nodes that are in the `includeNodes` Set.
   */</span>
  <span class="keyword">def</span> <a title="(includeNodes: Set[akka.actor.Address])akka.cluster.MetricsGossip" id="akka.cluster;MetricsGossip.filter">filter</a><span class="delimiter">(</span><a title="Set[akka.actor.Address]" id="akka.cluster;MetricsGossip.filter.includeNodes">includeNodes</a>: <span title="Set[akka.actor.Address]">Set</span><span class="delimiter">[</span>Address<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#akka.cluster;MetricsGossip.equals" title="akka.cluster.MetricsGossip">MetricsGossip</a> =
    <a href="#akka.cluster;MetricsGossip.equals" title="(nodes: Set[akka.cluster.NodeMetrics])akka.cluster.MetricsGossip">copy</a><span class="delimiter">(</span>nodes = <a href="#akka.cluster;MetricsGossip.copy$default$1" title="=&gt; Set[akka.cluster.NodeMetrics]">nodes</a> <span title="(p: akka.cluster.NodeMetrics =&gt; Boolean)scala.collection.immutable.Set[akka.cluster.NodeMetrics]">filter</span> <span class="delimiter">{</span> <a href="#akka.cluster;MetricsGossip.filter.includeNodes" title="Set[akka.actor.Address]">includeNodes</a> <span title="(elem: akka.actor.Address)Boolean">contains</span> <a href="#akka.cluster;MetricsGossip.filter.$anonfun.x$2" title="akka.cluster.NodeMetrics">_</a>.<a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a> <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Adds new remote [[akka.cluster.NodeMetrics]] and merges existing from a remote gossip.
   */</span>
  <span class="keyword">def</span> <a title="(otherGossip: akka.cluster.MetricsGossip)akka.cluster.MetricsGossip" id="akka.cluster;MetricsGossip.merge">merge</a><span class="delimiter">(</span><a title="akka.cluster.MetricsGossip" id="akka.cluster;MetricsGossip.merge.otherGossip">otherGossip</a>: <a href="#akka.cluster;MetricsGossip.equals" title="akka.cluster.MetricsGossip">MetricsGossip</a><span class="delimiter">)</span>: <a href="#akka.cluster;MetricsGossip.equals" title="akka.cluster.MetricsGossip">MetricsGossip</a> =
    <a href="#akka.cluster;MetricsGossip.merge.otherGossip" title="akka.cluster.MetricsGossip">otherGossip</a>.<a href="#akka.cluster;MetricsGossip.copy$default$1" title="=&gt; Set[akka.cluster.NodeMetrics]">nodes</a>.<span title="(z: akka.cluster.MetricsGossip)(op: (akka.cluster.MetricsGossip, akka.cluster.NodeMetrics) =&gt; akka.cluster.MetricsGossip)akka.cluster.MetricsGossip">foldLeft</span><span class="delimiter">(</span><a href="#akka.cluster;MetricsGossip.equals" title="akka.cluster.MetricsGossip" class="keyword">this</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="akka.cluster.MetricsGossip" id="akka.cluster;MetricsGossip.merge.$anonfun.gossip">gossip</a>, <a title="akka.cluster.NodeMetrics" id="akka.cluster;MetricsGossip.merge.$anonfun.nodeMetrics">nodeMetrics</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster;MetricsGossip.merge.$anonfun.gossip" title="akka.cluster.MetricsGossip">gossip</a> <a href="#akka.cluster;MetricsGossip.:+" title="(newNodeMetrics: akka.cluster.NodeMetrics)akka.cluster.MetricsGossip">:+</a> <a href="#akka.cluster;MetricsGossip.merge.$anonfun.nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a> <span class="delimiter">}</span>

  <span class="comment">/**
   * Adds new local [[akka.cluster.NodeMetrics]], or merges an existing.
   */</span>
  <span class="keyword">def</span> <a title="(newNodeMetrics: akka.cluster.NodeMetrics)akka.cluster.MetricsGossip" id="akka.cluster;MetricsGossip.:+">:+</a><span class="delimiter">(</span><a title="akka.cluster.NodeMetrics" id="akka.cluster;MetricsGossip.:+.newNodeMetrics">newNodeMetrics</a>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a><span class="delimiter">)</span>: <a href="#akka.cluster;MetricsGossip.equals" title="akka.cluster.MetricsGossip">MetricsGossip</a> = <a href="#akka.cluster;MetricsGossip.nodeMetricsFor" title="(address: akka.actor.Address)Option[akka.cluster.NodeMetrics]">nodeMetricsFor</a><span class="delimiter">(</span><a href="#akka.cluster;MetricsGossip.:+.newNodeMetrics" title="akka.cluster.NodeMetrics">newNodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a><span class="delimiter">)</span> <span title="akka.cluster.MetricsGossip" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Some<span class="delimiter">(</span><a title="akka.cluster.NodeMetrics" id="akka.cluster;MetricsGossip.:+.existingNodeMetrics">existingNodeMetrics</a><span class="delimiter">)</span> ⇒
      <a href="#akka.cluster;MetricsGossip.equals" title="(nodes: Set[akka.cluster.NodeMetrics])akka.cluster.MetricsGossip">copy</a><span class="delimiter">(</span>nodes = <a href="#akka.cluster;MetricsGossip.copy$default$1" title="=&gt; Set[akka.cluster.NodeMetrics]">nodes</a> <span title="(elem: akka.cluster.NodeMetrics)scala.collection.immutable.Set[akka.cluster.NodeMetrics]">-</span> <a href="#akka.cluster;MetricsGossip.:+.existingNodeMetrics" title="akka.cluster.NodeMetrics">existingNodeMetrics</a> <span title="(elem: akka.cluster.NodeMetrics)scala.collection.immutable.Set[akka.cluster.NodeMetrics]">+</span> <span class="delimiter">(</span><a href="#akka.cluster;MetricsGossip.:+.existingNodeMetrics" title="akka.cluster.NodeMetrics">existingNodeMetrics</a> <a href="#akka.cluster;NodeMetrics.merge" title="(that: akka.cluster.NodeMetrics)akka.cluster.NodeMetrics">merge</a> <a href="#akka.cluster;MetricsGossip.:+.newNodeMetrics" title="akka.cluster.NodeMetrics">newNodeMetrics</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="None.type">None</span> ⇒ <a href="#akka.cluster;MetricsGossip.equals" title="(nodes: Set[akka.cluster.NodeMetrics])akka.cluster.MetricsGossip">copy</a><span class="delimiter">(</span>nodes = <a href="#akka.cluster;MetricsGossip.copy$default$1" title="=&gt; Set[akka.cluster.NodeMetrics]">nodes</a> <span title="(elem: akka.cluster.NodeMetrics)scala.collection.immutable.Set[akka.cluster.NodeMetrics]">+</span> <a href="#akka.cluster;MetricsGossip.:+.newNodeMetrics" title="akka.cluster.NodeMetrics">newNodeMetrics</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns [[akka.cluster.NodeMetrics]] for a node if exists.
   */</span>
  <span class="keyword">def</span> <a title="(address: akka.actor.Address)Option[akka.cluster.NodeMetrics]" id="akka.cluster;MetricsGossip.nodeMetricsFor">nodeMetricsFor</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.cluster;MetricsGossip.nodeMetricsFor.address">address</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <span title="Option[akka.cluster.NodeMetrics]">Option</span><span class="delimiter">[</span>NodeMetrics<span class="delimiter">]</span> = <a href="#akka.cluster;MetricsGossip.copy$default$1" title="=&gt; Set[akka.cluster.NodeMetrics]">nodes</a> <span title="(p: akka.cluster.NodeMetrics =&gt; Boolean)Option[akka.cluster.NodeMetrics]">find</span> <span class="delimiter">{</span> <a title="akka.cluster.NodeMetrics" id="akka.cluster;MetricsGossip.nodeMetricsFor.$anonfun.n">n</a> ⇒ <a href="#akka.cluster;MetricsGossip.nodeMetricsFor.$anonfun.n" title="akka.cluster.NodeMetrics">n</a>.<a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.cluster;MetricsGossip.nodeMetricsFor.address" title="akka.actor.Address">address</a> <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 * Envelope adding a sender address to the gossip.
 */</span>
@SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
<span class="keyword">private</span><span class="delimiter">[</span>cluster<span class="delimiter">]</span> <span class="keyword">case class</span> <a title="class MetricsGossipEnvelope extends AnyRef with akka.cluster.ClusterMessage with Product with Serializable" id="akka.cluster.MetricsGossipEnvelope.readResolve">MetricsGossipEnvelope</a><a href="#akka.cluster.MetricsGossipEnvelope.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.cluster;MetricsGossipEnvelope.from">from</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.cluster.MetricsGossip" id="akka.cluster;MetricsGossipEnvelope.gossip">gossip</a>: <a href="#akka.cluster;MetricsGossip.equals" title="akka.cluster.MetricsGossip">MetricsGossip</a>, <a title="Boolean" id="akka.cluster;MetricsGossipEnvelope.reply">reply</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="ClusterDaemon.scala.html#akka.cluster;ClusterMessage" title="akka.cluster.ClusterMessage">ClusterMessage</a>

<span class="keyword">private</span><span class="delimiter">[</span>cluster<span class="delimiter">]</span> <span class="keyword">object</span> <a title="akka.cluster.EWMA.type" id="akka.cluster.EWMA.readResolve">EWMA</a> <a href="#akka.cluster.EWMA.readResolve" title="akka.cluster.EWMA.type" class="delimiter">{</a>
  <span class="comment">/**
   * math.log(2)
   */</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Double" id="akka.cluster.EWMA.LogOf2">LogOf2</a> = <span title="Double(0.69315)" class="double">0.69315</span>

  <span class="comment">/**
   * Calculate the alpha (decay factor) used in [[akka.cluster.EWMA]]
   * from specified half-life and interval between observations.
   * Half-life is the interval over which the weights decrease by a factor of two.
   * The relevance of each data sample is halved for every passing half-life duration,
   * i.e. after 4 times the half-life, a data sample’s relevance is reduced to 6% of
   * its original relevance. The initial relevance of a data sample is given by
   * 1 – 0.5 ^ (collect-interval / half-life).
   */</span>
  <span class="keyword">def</span> <a title="(halfLife: scala.concurrent.duration.FiniteDuration, collectInterval: scala.concurrent.duration.FiniteDuration)Double" id="akka.cluster.EWMA.alpha">alpha</a><span class="delimiter">(</span><a title="scala.concurrent.duration.FiniteDuration" id="akka.cluster.EWMA.alpha.halfLife">halfLife</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span>, <a title="scala.concurrent.duration.FiniteDuration" id="akka.cluster.EWMA.alpha.collectInterval">collectInterval</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span><span class="delimiter">)</span>: <span title="Double">Double</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Long" id="akka.cluster.EWMA.alpha.halfLifeMillis">halfLifeMillis</a> = <a href="#akka.cluster.EWMA.alpha.halfLife" title="scala.concurrent.duration.FiniteDuration">halfLife</a>.<span title="=&gt; Long">toMillis</span>
    <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#akka.cluster.EWMA.alpha.halfLife" title="scala.concurrent.duration.FiniteDuration">halfLife</a>.<span title="=&gt; Long">toMillis</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span>, <span title="String(&quot;halfLife must be &gt; 0 s&quot;)" class="string">&quot;halfLife must be &gt; 0 s&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Double" id="akka.cluster.EWMA.alpha.decayRate">decayRate</a> = <a href="#akka.cluster.EWMA.LogOf2" title="=&gt; Double">LogOf2</a> <span title="(x: Long)Double">/</span> <a href="#akka.cluster.EWMA.alpha.halfLifeMillis" title="Long">halfLifeMillis</a>
    <span title="Int(1)" class="int">1</span> <span title="(x: Double)Double">-</span> math.<span title="(x: Double)Double">exp</span><span class="delimiter">(</span><span title="=&gt; Double">-</span><a href="#akka.cluster.EWMA.alpha.decayRate" title="Double">decayRate</a> <span title="(x: Long)Double">*</span> <a href="#akka.cluster.EWMA.alpha.collectInterval" title="scala.concurrent.duration.FiniteDuration">collectInterval</a>.<span title="=&gt; Long">toMillis</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * The exponentially weighted moving average (EWMA) approach captures short-term
 * movements in volatility for a conditional volatility forecasting model. By virtue
 * of its alpha, or decay factor, this provides a statistical streaming data model
 * that is exponentially biased towards newer entries.
 *
 * http://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average
 *
 * An EWMA only needs the most recent forecast value to be kept, as opposed to a standard
 * moving average model.
 *
 * INTERNAL API
 *
 * @param alpha decay factor, sets how quickly the exponential weighting decays for past data compared to new data,
 *   see http://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average
 *
 * @param value the current exponentially weighted moving average, e.g. Y(n - 1), or,
 *             the sampled value resulting from the previous smoothing iteration.
 *             This value is always used as the previous EWMA to calculate the new EWMA.
 *
 */</span>
@SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
<span class="keyword">private</span><span class="delimiter">[</span>cluster<span class="delimiter">]</span> <span class="keyword">case class</span> <a title="(value: Double, alpha: Double)akka.cluster.EWMA" id="akka.cluster;EWMA.equals">EWMA</a><a href="#akka.cluster;EWMA.equals" title="Product" class="delimiter">(</a><a title="Double" id="akka.cluster;EWMA.copy$default$1">value</a>: <span title="Double">Double</span>, <a title="Double" id="akka.cluster;EWMA.copy$default$2">alpha</a>: <span title="Double">Double</span><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><span title="Double(0.0)" class="double">0.0</span> <span title="(x: Double)Boolean">&lt;=</span> <a href="#akka.cluster;EWMA.copy$default$2" title="=&gt; Double">alpha</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#akka.cluster;EWMA.copy$default$2" title="=&gt; Double">alpha</a> <span title="(x: Double)Boolean">&lt;=</span> <span title="Double(1.0)" class="double">1.0</span>, <span title="String(&quot;alpha must be between 0.0 and 1.0&quot;)" class="string">&quot;alpha must be between 0.0 and 1.0&quot;</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Calculates the exponentially weighted moving average for a given monitored data set.
   *
   * @param xn the new data point
   * @return a new [[akka.cluster.EWMA]] with the updated value
   */</span>
  <span class="keyword">def</span> <a title="(xn: Double)akka.cluster.EWMA" id="akka.cluster;EWMA.:+">:+</a><span class="delimiter">(</span><a title="Double" id="akka.cluster;EWMA.:+.xn">xn</a>: <span title="Double">Double</span><span class="delimiter">)</span>: <a href="#akka.cluster;EWMA.equals" title="akka.cluster.EWMA">EWMA</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Double" id="akka.cluster;EWMA.:+.newValue">newValue</a> = <span class="delimiter">(</span><a href="#akka.cluster;EWMA.copy$default$2" title="=&gt; Double">alpha</a> <span title="(x: Double)Double">*</span> <a href="#akka.cluster;EWMA.:+.xn" title="Double">xn</a><span class="delimiter">)</span> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><span title="Int(1)" class="int">1</span> <span title="(x: Double)Double">-</span> <a href="#akka.cluster;EWMA.copy$default$2" title="=&gt; Double">alpha</a><span class="delimiter">)</span> <span title="(x: Double)Double">*</span> <a href="#akka.cluster;EWMA.copy$default$1" title="=&gt; Double">value</a>
    <span title="akka.cluster.EWMA" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.cluster;EWMA.:+.newValue" title="Double">newValue</a> <span title="(x: Double)Boolean">==</span> <a href="#akka.cluster;EWMA.copy$default$1" title="=&gt; Double">value</a><span class="delimiter">)</span> <a href="#akka.cluster;EWMA.equals" title="akka.cluster.EWMA" class="keyword">this</a> <span class="comment">// no change</span>
    <span class="keyword">else</span> <a href="#akka.cluster;EWMA.equals" title="(value: Double, alpha: Double)akka.cluster.EWMA">copy</a><span class="delimiter">(</span>value = <a href="#akka.cluster;EWMA.:+.newValue" title="Double">newValue</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * Metrics key/value.
 *
 * Equality of Metric is based on its name.
 *
 * @param name the metric name
 * @param value the metric value, which must be a valid numerical value,
 *   a valid value is neither negative nor NaN/Infinite.
 * @param average the data stream of the metric value, for trending over time. Metrics that are already
 *   averages (e.g. system load average) or finite (e.g. as number of processors), are not trended.
 */</span>
@SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
<span class="keyword">case class</span> <a title="class Metric extends AnyRef with akka.cluster.MetricNumericConverter with Product with Serializable" id="akka.cluster;Metric">Metric</a> <a href="#akka.cluster;Metric" title="Product" class="keyword">private</a><span class="delimiter">[</span>cluster<span class="delimiter">]</span> <span class="delimiter">(</span><a title="String" id="akka.cluster;Metric.name">name</a>: <span title="String">String</span>, <a title="Number" id="akka.cluster;Metric.value">value</a>: <span title="Number">Number</span>, <span class="keyword">private</span><span class="delimiter">[</span>cluster<span class="delimiter">]</span> <span class="keyword">val</span> <a title="Option[akka.cluster.EWMA]" id="akka.cluster;Metric.average">average</a>: <span title="Option[akka.cluster.EWMA]">Option</span><span class="delimiter">[</span>EWMA<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="#akka.cluster;MetricNumericConverter" title="akka.cluster.MetricNumericConverter">MetricNumericConverter</a> <span class="delimiter">{</span>

  <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#akka.cluster;MetricNumericConverter.defined" title="(value: Number)Boolean">defined</a><span class="delimiter">(</span><a href="#akka.cluster;Metric.value" title="=&gt; Number">value</a><span class="delimiter">)</span>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Invalid Metric [&quot;)">Invalid Metric [$</span><a href="#akka.cluster;Metric.name" title="=&gt; String">name</a><span title="String(&quot;] value [&quot;)">] value [$</span><a href="#akka.cluster;Metric.value" title="=&gt; Number">value</a><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Updates the data point, and if defined, updates the data stream (average).
   * Returns the updated metric.
   */</span>
  <span class="keyword">def</span> <a title="(latest: akka.cluster.Metric)akka.cluster.Metric" id="akka.cluster;Metric.:+">:+</a><span class="delimiter">(</span><a title="akka.cluster.Metric" id="akka.cluster;Metric.:+.latest">latest</a>: <a href="#akka.cluster;Metric" title="akka.cluster.Metric">Metric</a><span class="delimiter">)</span>: <a href="#akka.cluster;Metric" title="akka.cluster.Metric">Metric</a> =
    <span title="akka.cluster.Metric" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.cluster;Metric" title="Metric.this.type" class="keyword">this</a> <a href="#akka.cluster;Metric.sameAs" title="(that: akka.cluster.Metric)Boolean">sameAs</a> <a href="#akka.cluster;Metric.:+.latest" title="akka.cluster.Metric">latest</a><span class="delimiter">)</span> <a href="#akka.cluster;Metric.average" title="=&gt; Option[akka.cluster.EWMA]">average</a> <span title="akka.cluster.Metric" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><a title="akka.cluster.EWMA" id="akka.cluster;Metric.:+.avg">avg</a><span class="delimiter">)</span>                        ⇒ <a href="#akka.cluster;Metric.name" title="String" id="akka.cluster;Metric.:+.x$9">copy</a><span class="delimiter">(</span>value = <a href="#akka.cluster;Metric.:+.latest" title="akka.cluster.Metric">latest</a>.<a href="#akka.cluster;Metric.value" title="Number" id="akka.cluster;Metric.:+.x$7">value</a>, average = <span title="(x: akka.cluster.EWMA)Some[akka.cluster.EWMA]">Some</span><a title="Some[akka.cluster.EWMA]" id="akka.cluster;Metric.:+.x$8" class="delimiter">(</a><a href="#akka.cluster;Metric.:+.avg" title="akka.cluster.EWMA">avg</a> <a href="#akka.cluster;EWMA.:+" title="(xn: Double)akka.cluster.EWMA">:+</a> <a href="#akka.cluster;Metric.:+.latest" title="akka.cluster.Metric">latest</a>.<a href="#akka.cluster;Metric.value" title="=&gt; Number">value</a>.<span title="()Double">doubleValue</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="None.type">None</span> <span class="keyword">if</span> <a href="#akka.cluster;Metric.:+.latest" title="akka.cluster.Metric">latest</a>.<a href="#akka.cluster;Metric.average" title="=&gt; Option[akka.cluster.EWMA]">average</a>.<span title="=&gt; Boolean">isDefined</span> ⇒ <a href="#akka.cluster;Metric.name" title="String" id="akka.cluster;Metric.:+.x$12">copy</a><span class="delimiter">(</span>value = <a href="#akka.cluster;Metric.:+.latest" title="akka.cluster.Metric">latest</a>.<a href="#akka.cluster;Metric.value" title="Number" id="akka.cluster;Metric.:+.x$10">value</a>, average = <a href="#akka.cluster;Metric.:+.latest" title="akka.cluster.Metric">latest</a>.<a href="#akka.cluster;Metric.average" title="Option[akka.cluster.EWMA]" id="akka.cluster;Metric.:+.x$11">average</a><span class="delimiter">)</span>
      <span class="keyword">case</span> _                                ⇒ <a href="#akka.cluster;Metric.name" title="String" id="akka.cluster;Metric.:+.x$15">copy</a><span class="delimiter">(</span>value = <a href="#akka.cluster;Metric.:+.latest" title="akka.cluster.Metric">latest</a>.<a href="#akka.cluster;Metric.value" title="Number" id="akka.cluster;Metric.:+.x$13">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">else</span> <a href="#akka.cluster;Metric" title="akka.cluster.Metric" class="keyword">this</a>

  <span class="comment">/**
   * The numerical value of the average, if defined, otherwise the latest value
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Double" id="akka.cluster;Metric.smoothValue">smoothValue</a>: <span title="Double">Double</span> = <a href="#akka.cluster;Metric.average" title="=&gt; Option[akka.cluster.EWMA]">average</a> <span title="Double" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Some<span class="delimiter">(</span><a title="akka.cluster.EWMA" id="akka.cluster;Metric.smoothValue.avg">avg</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster;Metric.smoothValue.avg" title="akka.cluster.EWMA">avg</a>.<a href="#akka.cluster;EWMA.copy$default$1" title="=&gt; Double">value</a>
    <span class="keyword">case</span> <span title="None.type">None</span>      ⇒ <a href="#akka.cluster;Metric.value" title="=&gt; Number">value</a>.<span title="()Double">doubleValue</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * @return true if this value is smoothed
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="akka.cluster;Metric.isSmooth">isSmooth</a>: <span title="Boolean">Boolean</span> = <a href="#akka.cluster;Metric.average" title="=&gt; Option[akka.cluster.EWMA]">average</a>.<span title="=&gt; Boolean">isDefined</span>

  <span class="comment">/**
   * Returns true if &lt;code&gt;that&lt;/code&gt; is tracking the same metric as this.
   */</span>
  <span class="keyword">def</span> <a title="(that: akka.cluster.Metric)Boolean" id="akka.cluster;Metric.sameAs">sameAs</a><span class="delimiter">(</span><a title="akka.cluster.Metric" id="akka.cluster;Metric.sameAs.that">that</a>: <a href="#akka.cluster;Metric" title="akka.cluster.Metric">Metric</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#akka.cluster;Metric.name" title="=&gt; String">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.cluster;Metric.sameAs.that" title="akka.cluster.Metric">that</a>.<a href="#akka.cluster;Metric.name" title="=&gt; String">name</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Int" id="akka.cluster;Metric.hashCode">hashCode</a> = <a href="#akka.cluster;Metric.name" title="=&gt; String">name</a>.<span title="()Int">##</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(obj: Any)Boolean" id="akka.cluster;Metric.equals">equals</a><span class="delimiter">(</span><a title="Any" id="akka.cluster;Metric.equals.obj">obj</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <a href="#akka.cluster;Metric.equals.obj" title="Any">obj</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="akka.cluster.Metric" id="akka.cluster;Metric.equals.other">other</a>: <a href="#akka.cluster;Metric" title="akka.cluster.Metric">Metric</a> ⇒ <a href="#akka.cluster;Metric.sameAs" title="(that: akka.cluster.Metric)Boolean">sameAs</a><span class="delimiter">(</span><a href="#akka.cluster;Metric.equals.other" title="akka.cluster.Metric">other</a><span class="delimiter">)</span>
    <span class="keyword">case</span> _             ⇒ <span title="Boolean(false)" class="keyword">false</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * Factory for creating valid Metric instances.
 */</span>
<span class="keyword">object</span> <a title="akka.cluster.Metric.type" id="akka.cluster.Metric.readResolve">Metric</a> <a href="#akka.cluster.Metric.readResolve" title="akka.cluster.Metric.type" class="keyword">extends</a> <a href="#akka.cluster;MetricNumericConverter" title="akka.cluster.MetricNumericConverter">MetricNumericConverter</a> <span class="delimiter">{</span>

  <span class="comment">/**
   * Creates a new Metric instance if the value is valid, otherwise None
   * is returned. Invalid numeric values are negative and NaN/Infinite.
   */</span>
  <span class="keyword">def</span> <a title="(name: String, value: Number, decayFactor: Option[Double])Option[akka.cluster.Metric]" id="akka.cluster.Metric.create(76dd0c9bfe)">create</a><span class="delimiter">(</span><a title="String" id="akka.cluster.Metric.create(76dd0c9bfe).name">name</a>: <span title="String">String</span>, <a title="Number" id="akka.cluster.Metric.create(76dd0c9bfe).value">value</a>: <span title="Number">Number</span>, <a title="Option[Double]" id="akka.cluster.Metric.create(76dd0c9bfe).decayFactor">decayFactor</a>: <span title="Option[Double]">Option</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[akka.cluster.Metric]">Option</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> =
    <span title="Option[akka.cluster.Metric]" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.cluster;MetricNumericConverter.defined" title="(value: Number)Boolean">defined</a><span class="delimiter">(</span><a href="#akka.cluster.Metric.create(76dd0c9bfe).value" title="Number">value</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: akka.cluster.Metric)Some[akka.cluster.Metric]">Some</span><span class="delimiter">(</span><span title="akka.cluster.Metric" class="keyword">new</span> <a href="#akka.cluster;Metric" title="akka.cluster.Metric">Metric</a><span class="delimiter">(</span><a href="#akka.cluster.Metric.create(76dd0c9bfe).name" title="String">name</a>, <a href="#akka.cluster.Metric.create(76dd0c9bfe).value" title="Number">value</a>, <a href="#akka.cluster.Metric.ceateEWMA" title="(value: Double, decayFactor: Option[Double])Option[akka.cluster.EWMA]">ceateEWMA</a><span class="delimiter">(</span><a href="#akka.cluster.Metric.create(76dd0c9bfe).value" title="Number">value</a>.<span title="()Double">doubleValue</span>, <a href="#akka.cluster.Metric.create(76dd0c9bfe).decayFactor" title="Option[Double]">decayFactor</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="None.type">None</span>

  <span class="comment">/**
   * Creates a new Metric instance if the Try is successful and the value is valid,
   * otherwise None is returned. Invalid numeric values are negative and NaN/Infinite.
   */</span>
  <span class="keyword">def</span> <a title="(name: String, value: scala.util.Try[Number], decayFactor: Option[Double])Option[akka.cluster.Metric]" id="akka.cluster.Metric.create(df606f709d)">create</a><span class="delimiter">(</span><a title="String" id="akka.cluster.Metric.create(df606f709d).name">name</a>: <span title="String">String</span>, <a title="scala.util.Try[Number]" id="akka.cluster.Metric.create(df606f709d).value">value</a>: <span title="scala.util.Try[Number]">Try</span><span class="delimiter">[</span>Number<span class="delimiter">]</span>, <a title="Option[Double]" id="akka.cluster.Metric.create(df606f709d).decayFactor">decayFactor</a>: <span title="Option[Double]">Option</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[akka.cluster.Metric]">Option</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <a href="#akka.cluster.Metric.create(df606f709d).value" title="scala.util.Try[Number]">value</a> <span title="Option[akka.cluster.Metric]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Success<span class="delimiter">(</span><a title="Number" id="akka.cluster.Metric.create(df606f709d).v">v</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.Metric.create(76dd0c9bfe)" title="(name: String, value: Number, decayFactor: Option[Double])Option[akka.cluster.Metric]">create</a><span class="delimiter">(</span><a href="#akka.cluster.Metric.create(df606f709d).name" title="String">name</a>, <a href="#akka.cluster.Metric.create(df606f709d).v" title="Number">v</a>, <a href="#akka.cluster.Metric.create(df606f709d).decayFactor" title="Option[Double]">decayFactor</a><span class="delimiter">)</span>
    <span class="keyword">case</span> Failure<span class="delimiter">(</span>_<span class="delimiter">)</span> ⇒ <span title="None.type">None</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(value: Double, decayFactor: Option[Double])Option[akka.cluster.EWMA]" id="akka.cluster.Metric.ceateEWMA">ceateEWMA</a><span class="delimiter">(</span><a title="Double" id="akka.cluster.Metric.ceateEWMA.value">value</a>: <span title="Double">Double</span>, <a title="Option[Double]" id="akka.cluster.Metric.ceateEWMA.decayFactor">decayFactor</a>: <span title="Option[Double]">Option</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[akka.cluster.EWMA]">Option</span><span class="delimiter">[</span>EWMA<span class="delimiter">]</span> = <a href="#akka.cluster.Metric.ceateEWMA.decayFactor" title="Option[Double]">decayFactor</a> <span title="Option[akka.cluster.EWMA]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Some<span class="delimiter">(</span><a title="Double" id="akka.cluster.Metric.ceateEWMA.alpha">alpha</a><span class="delimiter">)</span> ⇒ <span title="(x: akka.cluster.EWMA)Some[akka.cluster.EWMA]">Some</span><span class="delimiter">(</span><a href="#akka.cluster;EWMA.equals" title="(value: Double, alpha: Double)akka.cluster.EWMA">EWMA</a><span class="delimiter">(</span><a href="#akka.cluster.Metric.ceateEWMA.value" title="Double">value</a>, <a href="#akka.cluster.Metric.ceateEWMA.alpha" title="Double">alpha</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="None.type">None</span>        ⇒ <span title="None.type">None</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * The snapshot of current sampled health metrics for any monitored process.
 * Collected and gossipped at regular intervals for dynamic cluster management strategies.
 *
 * Equality of NodeMetrics is based on its address.
 *
 * @param address [[akka.actor.Address]] of the node the metrics are gathered at
 * @param timestamp the time of sampling, in milliseconds since midnight, January 1, 1970 UTC
 * @param metrics the set of sampled [[akka.actor.Metric]]
 */</span>
@SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
<span class="keyword">case class</span> <a title="class NodeMetrics extends AnyRef with Product with Serializable" id="akka.cluster.NodeMetrics.readResolve">NodeMetrics</a><a href="#akka.cluster.NodeMetrics.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.cluster;NodeMetrics.address">address</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="Long" id="akka.cluster;NodeMetrics.timestamp">timestamp</a>: <span title="Long">Long</span>, <a title="Set[akka.cluster.Metric]" id="akka.cluster.NodeMetrics.apply$default$3">metrics</a>: <span title="Set[akka.cluster.Metric]">Set</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <span title="=&gt; scala.collection.immutable.Set.type">Set</span>.<span title="[A]=&gt; scala.collection.immutable.Set[A]">empty</span><span title="scala.collection.immutable.Set[akka.cluster.Metric]" class="delimiter">[</span><a href="#akka.cluster;Metric" title="akka.cluster.Metric">Metric</a><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="comment">/**
   * Returns the most recent data.
   */</span>
  <span class="keyword">def</span> <a title="(that: akka.cluster.NodeMetrics)akka.cluster.NodeMetrics" id="akka.cluster;NodeMetrics.merge">merge</a><span class="delimiter">(</span><a title="akka.cluster.NodeMetrics" id="akka.cluster;NodeMetrics.merge.that">that</a>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a><span class="delimiter">)</span>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a> = <span class="delimiter">{</span>
    <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.cluster;NodeMetrics.merge.that" title="akka.cluster.NodeMetrics">that</a>.<a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;merge only allowed for same address, [&quot;)">merge only allowed for same address, [$</span><a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a><span title="String(&quot;] != [&quot;)">] != [$</span><a href="#akka.cluster;NodeMetrics.merge.that" title="akka.cluster.NodeMetrics">that</a><span title="String(&quot;.address]&quot;)" class="string">.address]&quot;</span><span class="delimiter">)</span>
    <span title="akka.cluster.NodeMetrics" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.cluster;NodeMetrics.timestamp" title="=&gt; Long">timestamp</a> <span title="(x: Long)Boolean">&gt;=</span> <a href="#akka.cluster;NodeMetrics.merge.that" title="akka.cluster.NodeMetrics">that</a>.<a href="#akka.cluster;NodeMetrics.timestamp" title="=&gt; Long">timestamp</a><span class="delimiter">)</span> <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics" class="keyword">this</a> <span class="comment">// that is older</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="comment">// equality is based on the name of the Metric and Set doesn't replace existing element</span>
      <a href="#akka.cluster;NodeMetrics.address" title="akka.actor.Address" id="akka.cluster;NodeMetrics.merge.x$18">copy</a><span class="delimiter">(</span>metrics = <a href="#akka.cluster;NodeMetrics.merge.that" title="akka.cluster.NodeMetrics">that</a>.<a href="#akka.cluster.NodeMetrics.apply$default$3" title="=&gt; Set[akka.cluster.Metric]">metrics</a> <a title="scala.collection.immutable.Set[akka.cluster.Metric]" id="akka.cluster;NodeMetrics.merge.x$16">++</a> <a href="#akka.cluster.NodeMetrics.apply$default$3" title="=&gt; Set[akka.cluster.Metric]">metrics</a>, timestamp = <a href="#akka.cluster;NodeMetrics.merge.that" title="akka.cluster.NodeMetrics">that</a>.<a href="#akka.cluster;NodeMetrics.timestamp" title="Long" id="akka.cluster;NodeMetrics.merge.x$17">timestamp</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(key: String)Option[akka.cluster.Metric]" id="akka.cluster;NodeMetrics.metric">metric</a><span class="delimiter">(</span><a title="String" id="akka.cluster;NodeMetrics.metric.key">key</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Option[akka.cluster.Metric]">Option</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <a href="#akka.cluster.NodeMetrics.apply$default$3" title="=&gt; Set[akka.cluster.Metric]">metrics</a>.<span title="(pf: PartialFunction[akka.cluster.Metric,akka.cluster.Metric])Option[akka.cluster.Metric]">collectFirst</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[akka.cluster.Metric,akka.cluster.Metric] with Serializable" id="akka.cluster;NodeMetrics.metric;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a> <span class="keyword">case</span> <a title="akka.cluster.Metric" id="akka.cluster;NodeMetrics.metric;$anonfun.isDefinedAt.m">m</a> <span class="keyword">if</span> <a href="#akka.cluster;NodeMetrics.metric;$anonfun.isDefinedAt.m" title="akka.cluster.Metric">m</a>.<a href="#akka.cluster;Metric.name" title="=&gt; String">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.cluster;NodeMetrics.metric.key" title="String">key</a> ⇒ <a href="#akka.cluster;NodeMetrics.metric;$anonfun.isDefinedAt.m" title="akka.cluster.Metric">m</a> <span class="delimiter">}</span>

  <span class="comment">/**
   * Java API
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Iterable[akka.cluster.Metric]" id="akka.cluster;NodeMetrics.getMetrics">getMetrics</a>: java.lang.<span title="Iterable[akka.cluster.Metric]">Iterable</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> =
    scala.collection.<span title="scala.collection.JavaConverters.type">JavaConverters</span>.<span title="(i: Iterable[akka.cluster.Metric])scala.collection.convert.Decorators.AsJava[Iterable[akka.cluster.Metric]]">asJavaIterableConverter</span><span class="delimiter">(</span><a href="#akka.cluster.NodeMetrics.apply$default$3" title="=&gt; Set[akka.cluster.Metric]">metrics</a><span class="delimiter">)</span>.<span title="=&gt; Iterable[akka.cluster.Metric]">asJava</span>

  <span class="comment">/**
   * Returns true if &lt;code&gt;that&lt;/code&gt; address is the same as this
   */</span>
  <span class="keyword">def</span> <a title="(that: akka.cluster.NodeMetrics)Boolean" id="akka.cluster;NodeMetrics.sameAs">sameAs</a><span class="delimiter">(</span><a title="akka.cluster.NodeMetrics" id="akka.cluster;NodeMetrics.sameAs.that">that</a>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.cluster;NodeMetrics.sameAs.that" title="akka.cluster.NodeMetrics">that</a>.<a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Int" id="akka.cluster;NodeMetrics.hashCode">hashCode</a> = <a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a>.<span title="()Int">##</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(obj: Any)Boolean" id="akka.cluster;NodeMetrics.equals">equals</a><span class="delimiter">(</span><a title="Any" id="akka.cluster;NodeMetrics.equals.obj">obj</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <a href="#akka.cluster;NodeMetrics.equals.obj" title="Any">obj</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="akka.cluster.NodeMetrics" id="akka.cluster;NodeMetrics.equals.other">other</a>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a> ⇒ <a href="#akka.cluster;NodeMetrics.sameAs" title="(that: akka.cluster.NodeMetrics)Boolean">sameAs</a><span class="delimiter">(</span><a href="#akka.cluster;NodeMetrics.equals.other" title="akka.cluster.NodeMetrics">other</a><span class="delimiter">)</span>
    <span class="keyword">case</span> _                  ⇒ <span title="Boolean(false)" class="keyword">false</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * Definitions of the built-in standard metrics.
 *
 * The following extractors and data structures makes it easy to consume the
 * [[akka.cluster.NodeMetrics]] in for example load balancers.
 */</span>
<span class="keyword">object</span> <a title="akka.cluster.StandardMetrics.type" id="akka.cluster.StandardMetrics">StandardMetrics</a> <a href="#akka.cluster.StandardMetrics" title="akka.cluster.StandardMetrics.type" class="delimiter">{</a>

  <span class="comment">// Constants for the heap related Metric names</span>
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="String(&quot;heap-memory-used&quot;)" id="akka.cluster.StandardMetrics.HeapMemoryUsed">HeapMemoryUsed</a> = <span title="String(&quot;heap-memory-used&quot;)" class="string">&quot;heap-memory-used&quot;</span>
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="String(&quot;heap-memory-committed&quot;)" id="akka.cluster.StandardMetrics.HeapMemoryCommitted">HeapMemoryCommitted</a> = <span title="String(&quot;heap-memory-committed&quot;)" class="string">&quot;heap-memory-committed&quot;</span>
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="String(&quot;heap-memory-max&quot;)" id="akka.cluster.StandardMetrics.HeapMemoryMax">HeapMemoryMax</a> = <span title="String(&quot;heap-memory-max&quot;)" class="string">&quot;heap-memory-max&quot;</span>

  <span class="comment">// Constants for the cpu related Metric names</span>
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="String(&quot;system-load-average&quot;)" id="akka.cluster.StandardMetrics.SystemLoadAverage">SystemLoadAverage</a> = <span title="String(&quot;system-load-average&quot;)" class="string">&quot;system-load-average&quot;</span>
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="String(&quot;processors&quot;)" id="akka.cluster.StandardMetrics.Processors">Processors</a> = <span title="String(&quot;processors&quot;)" class="string">&quot;processors&quot;</span>
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="String(&quot;cpu-combined&quot;)" id="akka.cluster.StandardMetrics.CpuCombined">CpuCombined</a> = <span title="String(&quot;cpu-combined&quot;)" class="string">&quot;cpu-combined&quot;</span>

  <span class="keyword">object</span> <a title="akka.cluster.StandardMetrics.HeapMemory.type" id="akka.cluster.StandardMetrics.HeapMemory.readResolve">HeapMemory</a> <a href="#akka.cluster.StandardMetrics.HeapMemory.readResolve" title="akka.cluster.StandardMetrics.HeapMemory.type" class="delimiter">{</a>

    <span class="comment">/**
     * Given a NodeMetrics it returns the HeapMemory data if the nodeMetrics contains
     * necessary heap metrics.
     * @return if possible a tuple matching the HeapMemory constructor parameters
     */</span>
    <span class="keyword">def</span> <a title="(nodeMetrics: akka.cluster.NodeMetrics)Option[(akka.actor.Address, Long, Long, Long, Option[Long])]" id="akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5)">unapply</a><span class="delimiter">(</span><a title="akka.cluster.NodeMetrics" id="akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).nodeMetrics">nodeMetrics</a>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a><span class="delimiter">)</span>: <span title="Option[(akka.actor.Address, Long, Long, Long, Option[Long])]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span>Address, Long, Long, Long, Option<span class="delimiter">[</span>Long<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="akka.cluster.Metric" id="akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).$anonfun.used">used</a> ← <a href="#akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.metric" title="(key: String)Option[akka.cluster.Metric]">metric</a><span title="(f: akka.cluster.Metric =&gt; Option[(akka.actor.Address, Long, Long, Long, Option[Long])])Option[(akka.actor.Address, Long, Long, Long, Option[Long])]" class="delimiter">(</span><span title="String(&quot;heap-memory-used&quot;)">HeapMemoryUsed</span><span class="delimiter">)</span>
        <a title="akka.cluster.Metric" id="akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).$anonfun.$anonfun.committed">committed</a> ← <a href="#akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.metric" title="(key: String)Option[akka.cluster.Metric]">metric</a><span title="(f: akka.cluster.Metric =&gt; (akka.actor.Address, Long, Long, Long, Option[Long]))Option[(akka.actor.Address, Long, Long, Long, Option[Long])]" class="delimiter">(</span><span title="String(&quot;heap-memory-committed&quot;)">HeapMemoryCommitted</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="(_1: akka.actor.Address, _2: Long, _3: Long, _4: Long, _5: Option[Long])(akka.actor.Address, Long, Long, Long, Option[Long])" class="delimiter">(</span><a href="#akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a>, <a href="#akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.timestamp" title="=&gt; Long">timestamp</a>,
        <a href="#akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).$anonfun.used" title="akka.cluster.Metric">used</a>.<a href="#akka.cluster;Metric.smoothValue" title="implicit scala.Predef.double2Double : (x: Double)Double">smoothValue</a>.<span title="()Long">longValue</span>, <a href="#akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).$anonfun.$anonfun.committed" title="akka.cluster.Metric">committed</a>.<a href="#akka.cluster;Metric.smoothValue" title="implicit scala.Predef.double2Double : (x: Double)Double">smoothValue</a>.<span title="()Long">longValue</span>,
        <a href="#akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.metric" title="(key: String)Option[akka.cluster.Metric]">metric</a><span class="delimiter">(</span><span title="String(&quot;heap-memory-max&quot;)">HeapMemoryMax</span><span class="delimiter">)</span>.<span title="(f: akka.cluster.Metric =&gt; Long)Option[Long]">map</span><span class="delimiter">(</span><a href="#akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5).$anonfun.$anonfun.$anonfun.x$3" title="akka.cluster.Metric">_</a>.<a href="#akka.cluster;Metric.smoothValue" title="implicit scala.Predef.double2Double : (x: Double)Double">smoothValue</a>.<span title="()Long">longValue</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="comment">/**
   * Java API to extract HeapMemory data from nodeMetrics, if the nodeMetrics
   * contains necessary heap metrics, otherwise it returns null.
   */</span>
  <span class="keyword">def</span> <a title="(nodeMetrics: akka.cluster.NodeMetrics)akka.cluster.StandardMetrics.HeapMemory" id="akka.cluster.StandardMetrics.extractHeapMemory">extractHeapMemory</a><span class="delimiter">(</span><a title="akka.cluster.NodeMetrics" id="akka.cluster.StandardMetrics.extractHeapMemory.nodeMetrics">nodeMetrics</a>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a><span class="delimiter">)</span>: <a href="#akka.cluster.StandardMetrics;HeapMemory.equals" title="akka.cluster.StandardMetrics.HeapMemory">HeapMemory</a> = <a href="#akka.cluster.StandardMetrics.extractHeapMemory.nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a> <span title="akka.cluster.StandardMetrics.HeapMemory" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#akka.cluster.StandardMetrics.HeapMemory.unapply(d33dbba0b5)" title="(nodeMetrics: akka.cluster.NodeMetrics)Option[(akka.actor.Address, Long, Long, Long, Option[Long])]">HeapMemory</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.cluster.StandardMetrics.extractHeapMemory.address">address</a>, <a title="Long" id="akka.cluster.StandardMetrics.extractHeapMemory.timestamp">timestamp</a>, <a title="Long" id="akka.cluster.StandardMetrics.extractHeapMemory.used">used</a>, <a title="Long" id="akka.cluster.StandardMetrics.extractHeapMemory.committed">committed</a>, <a title="Option[Long]" id="akka.cluster.StandardMetrics.extractHeapMemory.max">max</a><span class="delimiter">)</span> ⇒
      <span class="comment">// note that above extractor returns tuple</span>
      <a href="#akka.cluster.StandardMetrics;HeapMemory.equals" title="(address: akka.actor.Address, timestamp: Long, used: Long, committed: Long, max: Option[Long])akka.cluster.StandardMetrics.HeapMemory">HeapMemory</a><span class="delimiter">(</span><a href="#akka.cluster.StandardMetrics.extractHeapMemory.address" title="akka.actor.Address">address</a>, <a href="#akka.cluster.StandardMetrics.extractHeapMemory.timestamp" title="Long">timestamp</a>, <a href="#akka.cluster.StandardMetrics.extractHeapMemory.used" title="Long">used</a>, <a href="#akka.cluster.StandardMetrics.extractHeapMemory.committed" title="Long">committed</a>, <a href="#akka.cluster.StandardMetrics.extractHeapMemory.max" title="Option[Long]">max</a><span class="delimiter">)</span>
    <span class="keyword">case</span> _ ⇒ <span title="Null(null)" class="keyword">null</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The amount of used and committed memory will always be &lt;= max if max is defined.
   * A memory allocation may fail if it attempts to increase the used memory such that used &gt; committed
   * even if used &lt;= max is true (e.g. when the system virtual memory is low).
   *
   * @param address [[akka.actor.Address]] of the node the metrics are gathered at
   * @param timestamp the time of sampling, in milliseconds since midnight, January 1, 1970 UTC
   * @param used the current sum of heap memory used from all heap memory pools (in bytes)
   * @param committed the current sum of heap memory guaranteed to be available to the JVM
   *   from all heap memory pools (in bytes). Committed will always be greater than or equal to used.
   * @param max the maximum amount of memory (in bytes) that can be used for JVM memory management.
   *   Can be undefined on some OS.
   */</span>
  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case class</span> <a title="(address: akka.actor.Address, timestamp: Long, used: Long, committed: Long, max: Option[Long])akka.cluster.StandardMetrics.HeapMemory" id="akka.cluster.StandardMetrics;HeapMemory.equals">HeapMemory</a><a href="#akka.cluster.StandardMetrics;HeapMemory.equals" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.cluster.StandardMetrics;HeapMemory.copy$default$1">address</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="Long" id="akka.cluster.StandardMetrics;HeapMemory.copy$default$2">timestamp</a>: <span title="Long">Long</span>, <a title="Long" id="akka.cluster.StandardMetrics;HeapMemory.copy$default$3">used</a>: <span title="Long">Long</span>, <a title="Long" id="akka.cluster.StandardMetrics;HeapMemory.copy$default$4">committed</a>: <span title="Long">Long</span>, <a title="Option[Long]" id="akka.cluster.StandardMetrics;HeapMemory.copy$default$5">max</a>: <span title="Option[Long]">Option</span><span class="delimiter">[</span>Long<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#akka.cluster.StandardMetrics;HeapMemory.copy$default$4" title="=&gt; Long">committed</a> <span title="(x: Long)Boolean">&gt;</span> <span title="Long(0L)" class="long">0L</span>, <span title="String(&quot;committed heap expected to be &gt; 0 bytes&quot;)" class="string">&quot;committed heap expected to be &gt; 0 bytes&quot;</span><span class="delimiter">)</span>
    <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#akka.cluster.StandardMetrics;HeapMemory.copy$default$5" title="=&gt; Option[Long]">max</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">||</span> <a href="#akka.cluster.StandardMetrics;HeapMemory.copy$default$5" title="=&gt; Option[Long]">max</a>.<span title="=&gt; Long">get</span> <span title="(x: Long)Boolean">&gt;</span> <span title="Long(0L)" class="long">0L</span>, <span title="String(&quot;max heap expected to be &gt; 0 bytes&quot;)" class="string">&quot;max heap expected to be &gt; 0 bytes&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="akka.cluster.StandardMetrics.Cpu.type" id="akka.cluster.StandardMetrics.Cpu.readResolve">Cpu</a> <a href="#akka.cluster.StandardMetrics.Cpu.readResolve" title="akka.cluster.StandardMetrics.Cpu.type" class="delimiter">{</a>

    <span class="comment">/**
     * Given a NodeMetrics it returns the Cpu data if the nodeMetrics contains
     * necessary cpu metrics.
     * @return if possible a tuple matching the Cpu constructor parameters
     */</span>
    <span class="keyword">def</span> <a title="(nodeMetrics: akka.cluster.NodeMetrics)Option[(akka.actor.Address, Long, Option[Double], Option[Double], Int)]" id="akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573)">unapply</a><span class="delimiter">(</span><a title="akka.cluster.NodeMetrics" id="akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573).nodeMetrics">nodeMetrics</a>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a><span class="delimiter">)</span>: <span title="Option[(akka.actor.Address, Long, Option[Double], Option[Double], Int)]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span>Address, Long, Option<span class="delimiter">[</span>Double<span class="delimiter">]</span>, Option<span class="delimiter">[</span>Double<span class="delimiter">]</span>, Int<span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="akka.cluster.Metric" id="akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573).$anonfun.processors">processors</a> ← <a href="#akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573).nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.metric" title="(key: String)Option[akka.cluster.Metric]">metric</a><span title="(f: akka.cluster.Metric =&gt; (akka.actor.Address, Long, Option[Double], Option[Double], Int))Option[(akka.actor.Address, Long, Option[Double], Option[Double], Int)]" class="delimiter">(</span><span title="String(&quot;processors&quot;)">Processors</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="(_1: akka.actor.Address, _2: Long, _3: Option[Double], _4: Option[Double], _5: Int)(akka.actor.Address, Long, Option[Double], Option[Double], Int)" class="delimiter">(</span><a href="#akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573).nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.address" title="=&gt; akka.actor.Address">address</a>, <a href="#akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573).nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.timestamp" title="=&gt; Long">timestamp</a>,
        <a href="#akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573).nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.metric" title="(key: String)Option[akka.cluster.Metric]">metric</a><span class="delimiter">(</span><span title="String(&quot;system-load-average&quot;)">SystemLoadAverage</span><span class="delimiter">)</span>.<span title="(f: akka.cluster.Metric =&gt; Double)Option[Double]">map</span><span class="delimiter">(</span><a href="#akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573).$anonfun.$anonfun.x$4" title="akka.cluster.Metric">_</a>.<a href="#akka.cluster;Metric.smoothValue" title="=&gt; Double">smoothValue</a><span class="delimiter">)</span>,
        <a href="#akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573).nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a>.<a href="#akka.cluster;NodeMetrics.metric" title="(key: String)Option[akka.cluster.Metric]">metric</a><span class="delimiter">(</span><span title="String(&quot;cpu-combined&quot;)">CpuCombined</span><span class="delimiter">)</span>.<span title="(f: akka.cluster.Metric =&gt; Double)Option[Double]">map</span><span class="delimiter">(</span><a href="#akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573).$anonfun.$anonfun.x$5" title="akka.cluster.Metric">_</a>.<a href="#akka.cluster;Metric.smoothValue" title="=&gt; Double">smoothValue</a><span class="delimiter">)</span>, <a href="#akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573).$anonfun.processors" title="akka.cluster.Metric">processors</a>.<a href="#akka.cluster;Metric.value" title="=&gt; Number">value</a>.<span title="()Int">intValue</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="comment">/**
   * Java API to extract Cpu data from nodeMetrics, if the nodeMetrics
   * contains necessary cpu metrics, otherwise it returns null.
   */</span>
  <span class="keyword">def</span> <a title="(nodeMetrics: akka.cluster.NodeMetrics)akka.cluster.StandardMetrics.Cpu" id="akka.cluster.StandardMetrics.extractCpu">extractCpu</a><span class="delimiter">(</span><a title="akka.cluster.NodeMetrics" id="akka.cluster.StandardMetrics.extractCpu.nodeMetrics">nodeMetrics</a>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a><span class="delimiter">)</span>: <a href="#akka.cluster.StandardMetrics;Cpu.equals" title="akka.cluster.StandardMetrics.Cpu">Cpu</a> = <a href="#akka.cluster.StandardMetrics.extractCpu.nodeMetrics" title="akka.cluster.NodeMetrics">nodeMetrics</a> <span title="akka.cluster.StandardMetrics.Cpu" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#akka.cluster.StandardMetrics.Cpu.unapply(6e61a56573)" title="(nodeMetrics: akka.cluster.NodeMetrics)Option[(akka.actor.Address, Long, Option[Double], Option[Double], Int)]">Cpu</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.cluster.StandardMetrics.extractCpu.address">address</a>, <a title="Long" id="akka.cluster.StandardMetrics.extractCpu.timestamp">timestamp</a>, <a title="Option[Double]" id="akka.cluster.StandardMetrics.extractCpu.systemLoadAverage">systemLoadAverage</a>, <a title="Option[Double]" id="akka.cluster.StandardMetrics.extractCpu.cpuCombined">cpuCombined</a>, <a title="Int" id="akka.cluster.StandardMetrics.extractCpu.processors">processors</a><span class="delimiter">)</span> ⇒
      <span class="comment">// note that above extractor returns tuple</span>
      <a href="#akka.cluster.StandardMetrics;Cpu.equals" title="(address: akka.actor.Address, timestamp: Long, systemLoadAverage: Option[Double], cpuCombined: Option[Double], processors: Int)akka.cluster.StandardMetrics.Cpu">Cpu</a><span class="delimiter">(</span><a href="#akka.cluster.StandardMetrics.extractCpu.address" title="akka.actor.Address">address</a>, <a href="#akka.cluster.StandardMetrics.extractCpu.timestamp" title="Long">timestamp</a>, <a href="#akka.cluster.StandardMetrics.extractCpu.systemLoadAverage" title="Option[Double]">systemLoadAverage</a>, <a href="#akka.cluster.StandardMetrics.extractCpu.cpuCombined" title="Option[Double]">cpuCombined</a>, <a href="#akka.cluster.StandardMetrics.extractCpu.processors" title="Int">processors</a><span class="delimiter">)</span>
    <span class="keyword">case</span> _ ⇒ <span title="Null(null)" class="keyword">null</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * @param address [[akka.actor.Address]] of the node the metrics are gathered at
   * @param timestamp the time of sampling, in milliseconds since midnight, January 1, 1970 UTC
   * @param systemLoadAverage OS-specific average load on the CPUs in the system, for the past 1 minute,
   *    The system is possibly nearing a bottleneck if the system load average is nearing number of cpus/cores.
   * @param cpuCombined combined CPU sum of User + Sys + Nice + Wait, in percentage ([0.0 - 1.0]. This
   *   metric can describe the amount of time the CPU spent executing code during n-interval and how
   *   much more it could theoretically.
   * @param processors the number of available processors
   */</span>
  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case class</span> <a title="(address: akka.actor.Address, timestamp: Long, systemLoadAverage: Option[Double], cpuCombined: Option[Double], processors: Int)akka.cluster.StandardMetrics.Cpu" id="akka.cluster.StandardMetrics;Cpu.equals">Cpu</a><a href="#akka.cluster.StandardMetrics;Cpu.equals" title="Product" class="delimiter">(</a>
    <a title="akka.actor.Address" id="akka.cluster.StandardMetrics;Cpu.copy$default$1">address</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>,
    <a title="Long" id="akka.cluster.StandardMetrics;Cpu.copy$default$2">timestamp</a>: <span title="Long">Long</span>,
    <a title="Option[Double]" id="akka.cluster.StandardMetrics;Cpu.copy$default$3">systemLoadAverage</a>: <span title="Option[Double]">Option</span><span class="delimiter">[</span>Double<span class="delimiter">]</span>,
    <a title="Option[Double]" id="akka.cluster.StandardMetrics;Cpu.copy$default$4">cpuCombined</a>: <span title="Option[Double]">Option</span><span class="delimiter">[</span>Double<span class="delimiter">]</span>,
    <a title="Int" id="akka.cluster.StandardMetrics;Cpu.copy$default$5">processors</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="delimiter">{</span>

    <a href="#akka.cluster.StandardMetrics;Cpu.copy$default$4" title="=&gt; Option[Double]">cpuCombined</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><a title="Double" id="akka.cluster.StandardMetrics;Cpu.<local Cpu>.x">x</a><span class="delimiter">)</span> ⇒ <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><span title="Double(0.0)" class="double">0.0</span> <span title="(x: Double)Boolean">&lt;=</span> <a href="#akka.cluster.StandardMetrics;Cpu.<local Cpu>.x" title="Double">x</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#akka.cluster.StandardMetrics;Cpu.<local Cpu>.x" title="Double">x</a> <span title="(x: Double)Boolean">&lt;=</span> <span title="Double(1.0)" class="double">1.0</span>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;cpuCombined must be between [0.0 - 1.0], was [&quot;)">cpuCombined must be between [0.0 - 1.0], was [$</span><a href="#akka.cluster.StandardMetrics;Cpu.<local Cpu>.x" title="Double">x</a><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="None.type">None</span>    ⇒
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 *
 * Encapsulates evaluation of validity of metric values, conversion of an actual metric value to
 * a [[akka.cluster.Metric]] for consumption by subscribed cluster entities.
 */</span>
<span title="AnyRef" class="keyword">private</span><span class="delimiter">[</span>cluster<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait MetricNumericConverter extends AnyRef" id="akka.cluster;MetricNumericConverter">MetricNumericConverter</a> <span title="Unit" class="delimiter">{</span>

  <span class="comment">/**
   * An defined value is neither negative nor NaN/Infinite:
   * &lt;ul&gt;&lt;li&gt;JMX system load average and max heap can be 'undefined' for certain OS, in which case a -1 is returned&lt;/li&gt;
   * &lt;li&gt;SIGAR combined CPU can occasionally return a NaN or Infinite (known bug)&lt;/li&gt;&lt;/ul&gt;
   */</span>
  <span class="keyword">def</span> <a title="(value: Number)Boolean" id="akka.cluster;MetricNumericConverter.defined">defined</a><span class="delimiter">(</span><a title="Number" id="akka.cluster;MetricNumericConverter.defined.value">value</a>: <span title="Number">Number</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#akka.cluster;MetricNumericConverter.convertNumber" title="(from: Any)Either[Long,Double]">convertNumber</a><span class="delimiter">(</span><a href="#akka.cluster;MetricNumericConverter.defined.value" title="Number">value</a><span class="delimiter">)</span> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Left<span class="delimiter">(</span><a title="Long" id="akka.cluster;MetricNumericConverter.defined.a">a</a><span class="delimiter">)</span>  ⇒ <a href="#akka.cluster;MetricNumericConverter.defined.a" title="Long">a</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span>
    <span class="keyword">case</span> Right<span class="delimiter">(</span><a title="Double" id="akka.cluster;MetricNumericConverter.defined.b">b</a><span class="delimiter">)</span> ⇒ <span title="=&gt; Boolean">!</span><span class="delimiter">(</span><a href="#akka.cluster;MetricNumericConverter.defined.b" title="Double">b</a> <span title="(x: Double)Boolean">&lt;</span> <span title="Double(0.0)" class="double">0.0</span> <span title="(x: Boolean)Boolean">||</span> <a href="#akka.cluster;MetricNumericConverter.defined.b" title="implicit scala.Predef.double2Double : (x: Double)Double">b</a>.<span title="()Boolean">isNaN</span> <span title="(x: Boolean)Boolean">||</span> <a href="#akka.cluster;MetricNumericConverter.defined.b" title="implicit scala.Predef.double2Double : (x: Double)Double">b</a>.<span title="()Boolean">isInfinite</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * May involve rounding or truncation.
   */</span>
  <span class="keyword">def</span> <a title="(from: Any)Either[Long,Double]" id="akka.cluster;MetricNumericConverter.convertNumber">convertNumber</a><span class="delimiter">(</span><a title="Any" id="akka.cluster;MetricNumericConverter.convertNumber.from">from</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Either[Long,Double]">Either</span><span class="delimiter">[</span>Long, Double<span class="delimiter">]</span> = <a href="#akka.cluster;MetricNumericConverter.convertNumber.from" title="Any">from</a> <span title="Either[Long,Double]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Int">n</span>: <span title="Int">Int</span>        ⇒ <span title="(a: Long)scala.util.Left[Long,Nothing]">Left</span><span class="delimiter">(</span><span title="=&gt; Long">n</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Long">n</span>: <span title="Long">Long</span>       ⇒ <span title="(a: Long)scala.util.Left[Long,Nothing]">Left</span><span class="delimiter">(</span><span title="Long">n</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Double">n</span>: <span title="Double">Double</span>     ⇒ <span title="(b: Double)scala.util.Right[Nothing,Double]">Right</span><span class="delimiter">(</span><span title="Double">n</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Float">n</span>: <span title="Float">Float</span>      ⇒ <span title="(b: Double)scala.util.Right[Nothing,Double]">Right</span><span class="delimiter">(</span><span title="=&gt; Double">n</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="BigInt">n</span>: <span title="BigInt">BigInt</span>     ⇒ <span title="(a: Long)scala.util.Left[Long,Nothing]">Left</span><span class="delimiter">(</span><span title="BigInt">n</span>.<span title="()Long">longValue</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="BigDecimal">n</span>: <span title="BigDecimal">BigDecimal</span> ⇒ <span title="(b: Double)scala.util.Right[Nothing,Double]">Right</span><span class="delimiter">(</span><span title="BigDecimal">n</span>.<span title="()Double">doubleValue</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="Any" id="akka.cluster;MetricNumericConverter.convertNumber.x">x</a>             ⇒ <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Not a number [&quot;)">Not a number [$</span><a href="#akka.cluster;MetricNumericConverter.convertNumber.x" title="Any">x</a><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * Implementations of cluster system metrics extends this trait.
 */</span>
<span title="AnyRef" class="keyword">trait</span> <a title="trait MetricsCollector extends Object with java.io.Closeable" id="akka.cluster;MetricsCollector">MetricsCollector</a> <span class="keyword">extends</span> <span title="java.io.Closeable">Closeable</span> <span class="delimiter">{</span>
  <span class="comment">/**
   * Samples and collects new data points.
   * This method is invoked periodically and should return
   * current metrics for this node.
   */</span>
  <span class="keyword">def</span> <a title="()akka.cluster.NodeMetrics" id="akka.cluster;MetricsCollector.sample">sample</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a>
<span class="delimiter">}</span>

<span class="comment">/**
 * Loads JVM and system metrics through JMX monitoring beans.
 *
 * @param address The [[akka.actor.Address]] of the node being sampled
 * @param decay how quickly the exponential weighting of past data is decayed
 */</span>
<span class="keyword">class</span> <a title="class JmxMetricsCollector extends Object with akka.cluster.MetricsCollector" id="akka.cluster;JmxMetricsCollector">JmxMetricsCollector</a><a href="#akka.cluster;JmxMetricsCollector" title="akka.cluster.JmxMetricsCollector" class="delimiter">(</a><a title="akka.actor.Address" id="akka.cluster;JmxMetricsCollector.address">address</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="Double" id="akka.cluster;JmxMetricsCollector.decayFactor">decayFactor</a>: <span title="Double">Double</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#akka.cluster;MetricsCollector" title="akka.cluster.MetricsCollector">MetricsCollector</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#akka.cluster.StandardMetrics" title="akka.cluster.StandardMetrics.type">StandardMetrics</a>._

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(cluster: akka.cluster.Cluster)akka.cluster.JmxMetricsCollector" id="akka.cluster;JmxMetricsCollector.<init>(39f2225335)" class="keyword">this</a><span class="delimiter">(</span><a title="akka.cluster.Cluster" id="akka.cluster;JmxMetricsCollector.<init>(39f2225335).cluster">cluster</a>: <a href="Cluster.scala.html#akka.cluster;Cluster" title="akka.cluster.Cluster">Cluster</a><span class="delimiter">)</span> =
    <a href="#akka.cluster;JmxMetricsCollector" title="JmxMetricsCollector.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#akka.cluster;JmxMetricsCollector.<init>(39f2225335).cluster" title="akka.cluster.Cluster">cluster</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.selfAddress" title="=&gt; akka.actor.Address">selfAddress</a>,
      <a href="#akka.cluster.EWMA.readResolve" title="akka.cluster.EWMA.type">EWMA</a>.<a href="#akka.cluster.EWMA.alpha" title="(halfLife: scala.concurrent.duration.FiniteDuration, collectInterval: scala.concurrent.duration.FiniteDuration)Double">alpha</a><span class="delimiter">(</span><a href="#akka.cluster;JmxMetricsCollector.<init>(39f2225335).cluster" title="akka.cluster.Cluster">cluster</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.settings" title="=&gt; akka.cluster.ClusterSettings">settings</a>.<a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsMovingAverageHalfLife" title="=&gt; scala.concurrent.duration.FiniteDuration">MetricsMovingAverageHalfLife</a>, <a href="#akka.cluster;JmxMetricsCollector.<init>(39f2225335).cluster" title="akka.cluster.Cluster">cluster</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.settings" title="=&gt; akka.cluster.ClusterSettings">settings</a>.<a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">MetricsInterval</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * This constructor is used when creating an instance from configured FQCN
   */</span>
  <span class="keyword">def</span> <a title="(system: akka.actor.ActorSystem)akka.cluster.JmxMetricsCollector" id="akka.cluster;JmxMetricsCollector.<init>(5d713eac4b)" class="keyword">this</a><span class="delimiter">(</span><a title="akka.actor.ActorSystem" id="akka.cluster;JmxMetricsCollector.<init>(5d713eac4b).system">system</a>: <a href="../../akka-actor/actor/ActorSystem.scala.html#akka.actor;ActorSystem" title="akka.actor.ActorSystem">ActorSystem</a><span class="delimiter">)</span> = <a href="#akka.cluster;JmxMetricsCollector.<init>(39f2225335)" title="(cluster: akka.cluster.Cluster)akka.cluster.JmxMetricsCollector" class="keyword">this</a><span class="delimiter">(</span><a href="../../akka-actor/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.cluster.Cluster">Cluster</a><span class="delimiter">(</span><a href="#akka.cluster;JmxMetricsCollector.<init>(5d713eac4b).system" title="akka.actor.ActorSystem">system</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Some[Double]" id="akka.cluster;JmxMetricsCollector.decayFactorOption">decayFactorOption</a> = <span title="(x: Double)Some[Double]">Some</span><span class="delimiter">(</span><a href="#akka.cluster;JmxMetricsCollector.decayFactor" title="Double">decayFactor</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.management.MemoryMXBean" id="akka.cluster;JmxMetricsCollector.memoryMBean">memoryMBean</a>: <span title="java.lang.management.MemoryMXBean">MemoryMXBean</span> = <span title="java.lang.management.ManagementFactory.type">ManagementFactory</span>.<span title="()java.lang.management.MemoryMXBean">getMemoryMXBean</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.management.OperatingSystemMXBean" id="akka.cluster;JmxMetricsCollector.osMBean">osMBean</a>: <span title="java.lang.management.OperatingSystemMXBean">OperatingSystemMXBean</span> = <span title="java.lang.management.ManagementFactory.type">ManagementFactory</span>.<span title="()java.lang.management.OperatingSystemMXBean">getOperatingSystemMXBean</span>

  <span class="comment">/**
   * Samples and collects new data points.
   * Creates a new instance each time.
   */</span>
  <span class="keyword">def</span> <a title="()akka.cluster.NodeMetrics" id="akka.cluster;JmxMetricsCollector.sample">sample</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#akka.cluster.NodeMetrics.readResolve" title="akka.cluster.NodeMetrics">NodeMetrics</a> = <a href="#akka.cluster.NodeMetrics.readResolve" title="(address: akka.actor.Address, timestamp: Long, metrics: Set[akka.cluster.Metric])akka.cluster.NodeMetrics">NodeMetrics</a><span class="delimiter">(</span><a href="#akka.cluster;JmxMetricsCollector.address" title="akka.actor.Address">address</a>, <span title="()Long">newTimestamp</span>, <a href="#akka.cluster;JmxMetricsCollector.metrics" title="=&gt; Set[akka.cluster.Metric]">metrics</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; Set[akka.cluster.Metric]" id="akka.cluster;JmxMetricsCollector.metrics">metrics</a>: <span title="Set[akka.cluster.Metric]">Set</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.lang.management.MemoryUsage" id="akka.cluster;JmxMetricsCollector.metrics.heap">heap</a> = <a href="#akka.cluster;JmxMetricsCollector.heapMemoryUsage" title="=&gt; java.lang.management.MemoryUsage">heapMemoryUsage</a>
    <span title="(elems: Option[akka.cluster.Metric]*)scala.collection.immutable.Set[Option[akka.cluster.Metric]]">Set</span><span class="delimiter">(</span><a href="#akka.cluster;JmxMetricsCollector.systemLoadAverage" title="=&gt; Option[akka.cluster.Metric]">systemLoadAverage</a>, <a href="#akka.cluster;JmxMetricsCollector.heapUsed" title="(heap: java.lang.management.MemoryUsage)Option[akka.cluster.Metric]">heapUsed</a><span class="delimiter">(</span><a href="#akka.cluster;JmxMetricsCollector.metrics.heap" title="java.lang.management.MemoryUsage">heap</a><span class="delimiter">)</span>, <a href="#akka.cluster;JmxMetricsCollector.heapCommitted" title="(heap: java.lang.management.MemoryUsage)Option[akka.cluster.Metric]">heapCommitted</a><span class="delimiter">(</span><a href="#akka.cluster;JmxMetricsCollector.metrics.heap" title="java.lang.management.MemoryUsage">heap</a><span class="delimiter">)</span>, <a href="#akka.cluster;JmxMetricsCollector.heapMax" title="(heap: java.lang.management.MemoryUsage)Option[akka.cluster.Metric]">heapMax</a><span class="delimiter">(</span><a href="#akka.cluster;JmxMetricsCollector.metrics.heap" title="java.lang.management.MemoryUsage">heap</a><span class="delimiter">)</span>, <a href="#akka.cluster;JmxMetricsCollector.processors" title="=&gt; Option[akka.cluster.Metric]">processors</a><span class="delimiter">)</span>.<a href="#akka.cluster;JmxMetricsCollector.metrics.$anonfun.xo" title="(implicit asTraversable: Option[akka.cluster.Metric] =&gt; scala.collection.GenTraversableOnce[akka.cluster.Metric])scala.collection.immutable.Set[akka.cluster.Metric]">flatten</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * JMX Returns the OS-specific average load on the CPUs in the system, for the past 1 minute.
   * On some systems the JMX OS system load average may not be available, in which case a -1 is
   * returned from JMX, and None is returned from this method.
   * Creates a new instance each time.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Option[akka.cluster.Metric]" id="akka.cluster;JmxMetricsCollector.systemLoadAverage">systemLoadAverage</a>: <span title="Option[akka.cluster.Metric]">Option</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <a href="#akka.cluster.Metric.readResolve" title="akka.cluster.Metric.type">Metric</a>.<a href="#akka.cluster.Metric.create(76dd0c9bfe)" title="(name: String, value: Number, decayFactor: Option[Double])Option[akka.cluster.Metric]">create</a><span class="delimiter">(</span>
    name = <span title="String(&quot;system-load-average&quot;)">SystemLoadAverage</span>,
    value = <a href="#akka.cluster;JmxMetricsCollector.osMBean" title="=&gt; java.lang.management.OperatingSystemMXBean">osMBean</a>.<span title="implicit scala.Predef.double2Double : (x: Double)Double">getSystemLoadAverage</span>,
    decayFactor = <span title="None.type">None</span><span class="delimiter">)</span>

  <span class="comment">/**
   * (JMX) Returns the number of available processors
   * Creates a new instance each time.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Option[akka.cluster.Metric]" id="akka.cluster;JmxMetricsCollector.processors">processors</a>: <span title="Option[akka.cluster.Metric]">Option</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <a href="#akka.cluster.Metric.readResolve" title="akka.cluster.Metric.type">Metric</a>.<a href="#akka.cluster.Metric.create(76dd0c9bfe)" title="(name: String, value: Number, decayFactor: Option[Double])Option[akka.cluster.Metric]">create</a><span class="delimiter">(</span>
    name = <span title="String(&quot;processors&quot;)">Processors</span>,
    value = <a href="#akka.cluster;JmxMetricsCollector.osMBean" title="=&gt; java.lang.management.OperatingSystemMXBean">osMBean</a>.<span title="implicit scala.Predef.int2Integer : (x: Int)Integer">getAvailableProcessors</span>,
    decayFactor = <span title="None.type">None</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Current heap to be passed in to heapUsed, heapCommitted and heapMax
   */</span>
  <span class="keyword">def</span> <a title="=&gt; java.lang.management.MemoryUsage" id="akka.cluster;JmxMetricsCollector.heapMemoryUsage">heapMemoryUsage</a>: <span title="java.lang.management.MemoryUsage">MemoryUsage</span> = <a href="#akka.cluster;JmxMetricsCollector.memoryMBean" title="=&gt; java.lang.management.MemoryMXBean">memoryMBean</a>.<span title="()java.lang.management.MemoryUsage">getHeapMemoryUsage</span>

  <span class="comment">/**
   * (JMX) Returns the current sum of heap memory used from all heap memory pools (in bytes).
   * Creates a new instance each time.
   */</span>
  <span class="keyword">def</span> <a title="(heap: java.lang.management.MemoryUsage)Option[akka.cluster.Metric]" id="akka.cluster;JmxMetricsCollector.heapUsed">heapUsed</a><span class="delimiter">(</span><a title="java.lang.management.MemoryUsage" id="akka.cluster;JmxMetricsCollector.heapUsed.heap">heap</a>: <span title="java.lang.management.MemoryUsage">MemoryUsage</span><span class="delimiter">)</span>: <span title="Option[akka.cluster.Metric]">Option</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <a href="#akka.cluster.Metric.readResolve" title="akka.cluster.Metric.type">Metric</a>.<a href="#akka.cluster.Metric.create(76dd0c9bfe)" title="(name: String, value: Number, decayFactor: Option[Double])Option[akka.cluster.Metric]">create</a><span class="delimiter">(</span>
    name = <span title="String(&quot;heap-memory-used&quot;)">HeapMemoryUsed</span>,
    value = <a href="#akka.cluster;JmxMetricsCollector.heapUsed.heap" title="java.lang.management.MemoryUsage">heap</a>.<span title="implicit scala.Predef.long2Long : (x: Long)Long">getUsed</span>,
    decayFactor = <a href="#akka.cluster;JmxMetricsCollector.decayFactorOption" title="=&gt; Some[Double]">decayFactorOption</a><span class="delimiter">)</span>

  <span class="comment">/**
   * (JMX) Returns the current sum of heap memory guaranteed to be available to the JVM
   * from all heap memory pools (in bytes).
   * Creates a new instance each time.
   */</span>
  <span class="keyword">def</span> <a title="(heap: java.lang.management.MemoryUsage)Option[akka.cluster.Metric]" id="akka.cluster;JmxMetricsCollector.heapCommitted">heapCommitted</a><span class="delimiter">(</span><a title="java.lang.management.MemoryUsage" id="akka.cluster;JmxMetricsCollector.heapCommitted.heap">heap</a>: <span title="java.lang.management.MemoryUsage">MemoryUsage</span><span class="delimiter">)</span>: <span title="Option[akka.cluster.Metric]">Option</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <a href="#akka.cluster.Metric.readResolve" title="akka.cluster.Metric.type">Metric</a>.<a href="#akka.cluster.Metric.create(76dd0c9bfe)" title="(name: String, value: Number, decayFactor: Option[Double])Option[akka.cluster.Metric]">create</a><span class="delimiter">(</span>
    name = <span title="String(&quot;heap-memory-committed&quot;)">HeapMemoryCommitted</span>,
    value = <a href="#akka.cluster;JmxMetricsCollector.heapCommitted.heap" title="java.lang.management.MemoryUsage">heap</a>.<span title="implicit scala.Predef.long2Long : (x: Long)Long">getCommitted</span>,
    decayFactor = <a href="#akka.cluster;JmxMetricsCollector.decayFactorOption" title="=&gt; Some[Double]">decayFactorOption</a><span class="delimiter">)</span>

  <span class="comment">/**
   * (JMX) Returns the maximum amount of memory (in bytes) that can be used
   * for JVM memory management. If not defined the metrics value is None, i.e.
   * never negative.
   * Creates a new instance each time.
   */</span>
  <span class="keyword">def</span> <a title="(heap: java.lang.management.MemoryUsage)Option[akka.cluster.Metric]" id="akka.cluster;JmxMetricsCollector.heapMax">heapMax</a><span class="delimiter">(</span><a title="java.lang.management.MemoryUsage" id="akka.cluster;JmxMetricsCollector.heapMax.heap">heap</a>: <span title="java.lang.management.MemoryUsage">MemoryUsage</span><span class="delimiter">)</span>: <span title="Option[akka.cluster.Metric]">Option</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <a href="#akka.cluster.Metric.readResolve" title="akka.cluster.Metric.type">Metric</a>.<a href="#akka.cluster.Metric.create(76dd0c9bfe)" title="(name: String, value: Number, decayFactor: Option[Double])Option[akka.cluster.Metric]">create</a><span class="delimiter">(</span>
    name = <span title="String(&quot;heap-memory-max&quot;)">HeapMemoryMax</span>,
    value = <a href="#akka.cluster;JmxMetricsCollector.heapMax.heap" title="java.lang.management.MemoryUsage">heap</a>.<span title="implicit scala.Predef.long2Long : (x: Long)Long">getMax</span>,
    decayFactor = <span title="None.type">None</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="akka.cluster;JmxMetricsCollector.close">close</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * Loads metrics through Hyperic SIGAR and JMX monitoring beans. This
 * loads wider and more accurate range of metrics compared to JmxMetricsCollector
 * by using SIGAR's native OS library.
 *
 * The constructor will by design throw exception if org.hyperic.sigar.Sigar can't be loaded, due
 * to missing classes or native libraries.
 *
 * @param address The [[akka.actor.Address]] of the node being sampled
 * @param decay how quickly the exponential weighting of past data is decayed
 * @param sigar the org.hyperic.Sigar instance
 */</span>
<span class="keyword">class</span> <a title="class SigarMetricsCollector extends akka.cluster.JmxMetricsCollector" id="akka.cluster;SigarMetricsCollector">SigarMetricsCollector</a><a href="#akka.cluster;SigarMetricsCollector" title="akka.cluster.SigarMetricsCollector" class="delimiter">(</a><a title="akka.actor.Address" id="akka.cluster;SigarMetricsCollector.address">address</a>: <a href="../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="Double" id="akka.cluster;SigarMetricsCollector.decayFactor">decayFactor</a>: <span title="Double">Double</span>, <a title="AnyRef" id="akka.cluster;SigarMetricsCollector.sigar">sigar</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="#akka.cluster;JmxMetricsCollector" title="akka.cluster.JmxMetricsCollector">JmxMetricsCollector</a><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.address" title="akka.actor.Address">address</a>, <a href="#akka.cluster;SigarMetricsCollector.decayFactor" title="Double">decayFactor</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">import</span> <a href="#akka.cluster.StandardMetrics" title="akka.cluster.StandardMetrics.type">StandardMetrics</a>._

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(cluster: akka.cluster.Cluster)akka.cluster.SigarMetricsCollector" id="akka.cluster;SigarMetricsCollector.<init>(c70347846f)" class="keyword">this</a><span class="delimiter">(</span><a title="akka.cluster.Cluster" id="akka.cluster;SigarMetricsCollector.<init>(c70347846f).cluster">cluster</a>: <a href="Cluster.scala.html#akka.cluster;Cluster" title="akka.cluster.Cluster">Cluster</a><span class="delimiter">)</span> =
    <a href="#akka.cluster;SigarMetricsCollector" title="SigarMetricsCollector.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.<init>(c70347846f).cluster" title="akka.cluster.Cluster">cluster</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.selfAddress" title="=&gt; akka.actor.Address">selfAddress</a>,
      <a href="#akka.cluster.EWMA.readResolve" title="akka.cluster.EWMA.type">EWMA</a>.<a href="#akka.cluster.EWMA.alpha" title="(halfLife: scala.concurrent.duration.FiniteDuration, collectInterval: scala.concurrent.duration.FiniteDuration)Double">alpha</a><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.<init>(c70347846f).cluster" title="akka.cluster.Cluster">cluster</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.settings" title="=&gt; akka.cluster.ClusterSettings">settings</a>.<a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsMovingAverageHalfLife" title="=&gt; scala.concurrent.duration.FiniteDuration">MetricsMovingAverageHalfLife</a>, <a href="#akka.cluster;SigarMetricsCollector.<init>(c70347846f).cluster" title="akka.cluster.Cluster">cluster</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.settings" title="=&gt; akka.cluster.ClusterSettings">settings</a>.<a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">MetricsInterval</a><span class="delimiter">)</span>,
      <a href="#akka.cluster;SigarMetricsCollector.<init>(c70347846f).cluster" title="akka.cluster.Cluster">cluster</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.system" title="=&gt; akka.actor.ExtendedActorSystem">system</a>.<a href="../../akka-actor/actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem.dynamicAccess" title="=&gt; akka.actor.DynamicAccess">dynamicAccess</a>.<a href="../../akka-actor/actor/DynamicAccess.scala.html#akka.actor;DynamicAccess.createInstanceFor(b43a2b150b)" title="[T](fqcn: String, args: scala.collection.immutable.Seq[(Class[_], AnyRef)])(implicit evidence$3: scala.reflect.ClassTag[T])scala.util.Try[T]">createInstanceFor</a><span title="(fqcn: String, args: scala.collection.immutable.Seq[(Class[_], AnyRef)])(implicit evidence$3: scala.reflect.ClassTag[AnyRef])scala.util.Try[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.ClassTag[AnyRef]" class="delimiter">(</span><span title="String(&quot;org.hyperic.sigar.Sigar&quot;)" class="string">&quot;org.hyperic.sigar.Sigar&quot;</span>, <span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span>.<span title="=&gt; AnyRef">get</span><span class="delimiter">)</span>

  <span class="comment">/**
   * This constructor is used when creating an instance from configured FQCN
   */</span>
  <span class="keyword">def</span> <a title="(system: akka.actor.ActorSystem)akka.cluster.SigarMetricsCollector" id="akka.cluster;SigarMetricsCollector.<init>(8e1978fbbb)" class="keyword">this</a><span class="delimiter">(</span><a title="akka.actor.ActorSystem" id="akka.cluster;SigarMetricsCollector.<init>(8e1978fbbb).system">system</a>: <a href="../../akka-actor/actor/ActorSystem.scala.html#akka.actor;ActorSystem" title="akka.actor.ActorSystem">ActorSystem</a><span class="delimiter">)</span> = <a href="#akka.cluster;SigarMetricsCollector.<init>(c70347846f)" title="(cluster: akka.cluster.Cluster)akka.cluster.SigarMetricsCollector" class="keyword">this</a><span class="delimiter">(</span><a href="../../akka-actor/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.cluster.Cluster">Cluster</a><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.<init>(8e1978fbbb).system" title="akka.actor.ActorSystem">system</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Some[Double]" id="akka.cluster;SigarMetricsCollector.decayFactorOption(497405da91)">decayFactorOption</a> = <span title="(x: Double)Some[Double]">Some</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.decayFactor" title="Double">decayFactor</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Array[Class[_]]" id="akka.cluster;SigarMetricsCollector.EmptyClassArray">EmptyClassArray</a>: <span title="Array[Class[_]]">Array</span><span class="delimiter">[</span><span class="delimiter">(</span>Class<span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> = <span title="Array.type">Array</span>.<span title="[T](implicit evidence$1: scala.reflect.ClassTag[T])Array[T]">empty</span><span title="(implicit evidence$1: scala.reflect.ClassTag[Class[_]])Array[Class[_]]" class="delimiter">[</span><span class="delimiter">(</span><span title="Class[_]">Class</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Option[java.lang.reflect.Method]" id="akka.cluster;SigarMetricsCollector.LoadAverage">LoadAverage</a>: <span title="Option[java.lang.reflect.Method]">Option</span><span class="delimiter">[</span>Method<span class="delimiter">]</span> = <a href="#akka.cluster;SigarMetricsCollector.createMethodFrom" title="(ref: AnyRef, method: String, types: Array[Class[_]])Option[java.lang.reflect.Method]">createMethodFrom</a><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.sigar" title="AnyRef">sigar</a>, <span title="String(&quot;getLoadAverage&quot;)" class="string">&quot;getLoadAverage&quot;</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Option[java.lang.reflect.Method]" id="akka.cluster;SigarMetricsCollector.Cpu">Cpu</a>: <span title="Option[java.lang.reflect.Method]">Option</span><span class="delimiter">[</span>Method<span class="delimiter">]</span> = <a href="#akka.cluster;SigarMetricsCollector.createMethodFrom" title="(ref: AnyRef, method: String, types: Array[Class[_]])Option[java.lang.reflect.Method]">createMethodFrom</a><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.sigar" title="AnyRef">sigar</a>, <span title="String(&quot;getCpuPerc&quot;)" class="string">&quot;getCpuPerc&quot;</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Option[java.lang.reflect.Method]" id="akka.cluster;SigarMetricsCollector.CombinedCpu">CombinedCpu</a>: <span title="Option[java.lang.reflect.Method]">Option</span><span class="delimiter">[</span>Method<span class="delimiter">]</span> = <span title="(r: =&gt; java.lang.reflect.Method)scala.util.Try[java.lang.reflect.Method]">Try</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.Cpu" title="=&gt; Option[java.lang.reflect.Method]">Cpu</a>.<span title="=&gt; java.lang.reflect.Method">get</span>.<span title="()Class[_]">getReturnType</span>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;getCombined&quot;)" class="string">&quot;getCombined&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Option[java.lang.reflect.Method]">toOption</span>

  <span class="comment">// Do something initially, in constructor, to make sure that the native library can be loaded.</span>
  <span class="comment">// This will by design throw exception if sigar isn't usable</span>
  <span class="keyword">val</span> <a title="Long" id="akka.cluster;SigarMetricsCollector.pid">pid</a>: <span title="Long">Long</span> = <a href="#akka.cluster;SigarMetricsCollector.createMethodFrom" title="(ref: AnyRef, method: String, types: Array[Class[_]])Option[java.lang.reflect.Method]">createMethodFrom</a><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.sigar" title="AnyRef">sigar</a>, <span title="String(&quot;getPid&quot;)" class="string">&quot;getPid&quot;</span><span class="delimiter">)</span> <span title="Long" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Some<span class="delimiter">(</span><a title="java.lang.reflect.Method" id="akka.cluster;SigarMetricsCollector.pid.method">method</a><span class="delimiter">)</span> ⇒
      <span class="keyword">try</span> <a href="#akka.cluster;SigarMetricsCollector.pid.method" title="java.lang.reflect.Method">method</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.sigar" title="AnyRef">sigar</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Long" class="delimiter">[</span><span title="Long">Long</span><span class="delimiter">]</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="java.lang.reflect.InvocationTargetException">e</span>: <span title="java.lang.reflect.InvocationTargetException">InvocationTargetException</span> <span class="keyword">if</span> <span title="java.lang.reflect.InvocationTargetException">e</span>.<span title="()Throwable">getCause</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="LinkageError">LinkageError</span><span class="delimiter">]</span> ⇒
          <span class="comment">// native libraries not in place</span>
          <span class="comment">// don't throw fatal LinkageError, but something harmless</span>
          <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="java.lang.reflect.InvocationTargetException">e</span>.<span title="()Throwable">getCause</span>.<span title="()String">toString</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="java.lang.reflect.InvocationTargetException">e</span>: <span title="java.lang.reflect.InvocationTargetException">InvocationTargetException</span> ⇒ <span title="Nothing" class="keyword">throw</span> <span title="java.lang.reflect.InvocationTargetException">e</span>.<span title="()Throwable">getCause</span>
      <span class="delimiter">}</span>
    <span class="keyword">case</span> <span title="None.type">None</span> ⇒ <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="String(&quot;Wrong version of Sigar, expected \'getPid\' method&quot;)" class="string">&quot;Wrong version of Sigar, expected 'getPid' method&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Set[akka.cluster.Metric]" id="akka.cluster;SigarMetricsCollector.metrics">metrics</a>: <span title="Set[akka.cluster.Metric]">Set</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#akka.cluster;SigarMetricsCollector" title="akka.cluster.SigarMetricsCollector" class="keyword">super</a>.<a href="#akka.cluster;JmxMetricsCollector.metrics" title="=&gt; Set[akka.cluster.Metric]">metrics</a>.<span title="(p: akka.cluster.Metric =&gt; Boolean)scala.collection.immutable.Set[akka.cluster.Metric]">filterNot</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.metrics.$anonfun.x$6" title="akka.cluster.Metric">_</a>.<a href="#akka.cluster;Metric.name" title="=&gt; String">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;system-load-average&quot;)">SystemLoadAverage</span><span class="delimiter">)</span> <span title="(elems: scala.collection.GenTraversableOnce[akka.cluster.Metric])scala.collection.immutable.Set[akka.cluster.Metric]">++</span> <span title="(elems: Option[akka.cluster.Metric]*)scala.collection.immutable.Set[Option[akka.cluster.Metric]]">Set</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.systemLoadAverage" title="=&gt; Option[akka.cluster.Metric]">systemLoadAverage</a>, <a href="#akka.cluster;SigarMetricsCollector.cpuCombined" title="=&gt; Option[akka.cluster.Metric]">cpuCombined</a><span class="delimiter">)</span>.<a href="#akka.cluster;SigarMetricsCollector.metrics.$anonfun.xo" title="(implicit asTraversable: Option[akka.cluster.Metric] =&gt; scala.collection.GenTraversableOnce[akka.cluster.Metric])scala.collection.immutable.Set[akka.cluster.Metric]">flatten</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * (SIGAR / JMX) Returns the OS-specific average load on the CPUs in the system, for the past 1 minute.
   * On some systems the JMX OS system load average may not be available, in which case a -1 is returned
   * from JMX, which means that None is returned from this method.
   * Hyperic SIGAR provides more precise values, thus, if the library is on the classpath, it is the default.
   * Creates a new instance each time.
   */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Option[akka.cluster.Metric]" id="akka.cluster;SigarMetricsCollector.systemLoadAverage">systemLoadAverage</a>: <span title="Option[akka.cluster.Metric]">Option</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <a href="#akka.cluster.Metric.readResolve" title="akka.cluster.Metric.type">Metric</a>.<a href="#akka.cluster.Metric.create(df606f709d)" title="(name: String, value: scala.util.Try[Number], decayFactor: Option[Double])Option[akka.cluster.Metric]">create</a><span class="delimiter">(</span>
    name = <span title="String(&quot;system-load-average&quot;)">SystemLoadAverage</span>,
    value = <span title="(r: =&gt; Number)scala.util.Try[Number]">Try</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.LoadAverage" title="=&gt; Option[java.lang.reflect.Method]">LoadAverage</a>.<span title="=&gt; java.lang.reflect.Method">get</span>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.sigar" title="AnyRef">sigar</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="(i: Int)AnyRef" class="delimiter">[</span><span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Number" class="delimiter">[</span><span title="Number">Number</span><span class="delimiter">]</span><span class="delimiter">)</span>,
    decayFactor = <span title="None.type">None</span><span class="delimiter">)</span> <span title="(alternative: =&gt; Option[akka.cluster.Metric])Option[akka.cluster.Metric]">orElse</span> <a href="#akka.cluster;SigarMetricsCollector" title="akka.cluster.SigarMetricsCollector" class="keyword">super</a>.<a href="#akka.cluster;JmxMetricsCollector.systemLoadAverage" title="=&gt; Option[akka.cluster.Metric]">systemLoadAverage</a>

  <span class="comment">/**
   * (SIGAR) Returns the combined CPU sum of User + Sys + Nice + Wait, in percentage. This metric can describe
   * the amount of time the CPU spent executing code during n-interval and how much more it could
   * theoretically. Note that 99% CPU utilization can be optimal or indicative of failure.
   *
   * In the data stream, this will sometimes return with a valid metric value, and sometimes as a NaN or Infinite.
   * Documented bug https://bugzilla.redhat.com/show_bug.cgi?id=749121 and several others.
   *
   * Creates a new instance each time.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Option[akka.cluster.Metric]" id="akka.cluster;SigarMetricsCollector.cpuCombined">cpuCombined</a>: <span title="Option[akka.cluster.Metric]">Option</span><span class="delimiter">[</span>Metric<span class="delimiter">]</span> = <a href="#akka.cluster.Metric.readResolve" title="akka.cluster.Metric.type">Metric</a>.<a href="#akka.cluster.Metric.create(df606f709d)" title="(name: String, value: scala.util.Try[Number], decayFactor: Option[Double])Option[akka.cluster.Metric]">create</a><span class="delimiter">(</span>
    name = <span title="String(&quot;cpu-combined&quot;)">CpuCombined</span>,
    value = <span title="(r: =&gt; Number)scala.util.Try[Number]">Try</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.CombinedCpu" title="=&gt; Option[java.lang.reflect.Method]">CombinedCpu</a>.<span title="=&gt; java.lang.reflect.Method">get</span>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.Cpu" title="=&gt; Option[java.lang.reflect.Method]">Cpu</a>.<span title="=&gt; java.lang.reflect.Method">get</span>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.sigar" title="AnyRef">sigar</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Number" class="delimiter">[</span><span title="Number">Number</span><span class="delimiter">]</span><span class="delimiter">)</span>,
    decayFactor = <a href="#akka.cluster;SigarMetricsCollector.decayFactorOption(497405da91)" title="=&gt; Some[Double]">decayFactorOption</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Releases any native resources associated with this instance.
   */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="akka.cluster;SigarMetricsCollector.close">close</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span title="(r: =&gt; Object)scala.util.Try[Object]">Try</span><span title="Unit" class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.createMethodFrom" title="(ref: AnyRef, method: String, types: Array[Class[_]])Option[java.lang.reflect.Method]">createMethodFrom</a><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.sigar" title="AnyRef">sigar</a>, <span title="String(&quot;close&quot;)" class="string">&quot;close&quot;</span><span class="delimiter">)</span>.<span title="=&gt; java.lang.reflect.Method">get</span>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.sigar" title="AnyRef">sigar</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ref: AnyRef, method: String, types: Array[Class[_]])Option[java.lang.reflect.Method]" id="akka.cluster;SigarMetricsCollector.createMethodFrom">createMethodFrom</a><span class="delimiter">(</span><a title="AnyRef" id="akka.cluster;SigarMetricsCollector.createMethodFrom.ref">ref</a>: <span title="AnyRef">AnyRef</span>, <a title="String" id="akka.cluster;SigarMetricsCollector.createMethodFrom.method">method</a>: <span title="String">String</span>, <a title="Array[Class[_]]" id="akka.cluster;SigarMetricsCollector.createMethodFrom$default$3">types</a>: <span title="Array[Class[_]]">Array</span><span class="delimiter">[</span><span class="delimiter">(</span>Class<span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> = <a href="#akka.cluster;SigarMetricsCollector.EmptyClassArray" title="=&gt; Array[Class[_]]">EmptyClassArray</a><span class="delimiter">)</span>: <span title="Option[java.lang.reflect.Method]">Option</span><span class="delimiter">[</span>Method<span class="delimiter">]</span> =
    <span title="(r: =&gt; java.lang.reflect.Method)scala.util.Try[java.lang.reflect.Method]">Try</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.createMethodFrom.ref" title="AnyRef">ref</a>.<span title="()Class[_]">getClass</span>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.createMethodFrom.method" title="String">method</a>, <a href="#akka.cluster;SigarMetricsCollector.createMethodFrom$default$3" title="Array[Class[_]]">types</a>: _*<span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Option[java.lang.reflect.Method]">toOption</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 * Factory to create configured MetricsCollector.
 * If instantiation of SigarMetricsCollector fails (missing class or native library)
 * it falls back to use JmxMetricsCollector.
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>cluster<span class="delimiter">]</span> <span class="keyword">object</span> <a title="akka.cluster.MetricsCollector.type" id="akka.cluster.MetricsCollector">MetricsCollector</a> <a href="#akka.cluster.MetricsCollector" title="akka.cluster.MetricsCollector.type" class="delimiter">{</a>
  <span class="keyword">def</span> <a title="(system: akka.actor.ExtendedActorSystem, settings: akka.cluster.ClusterSettings)akka.cluster.MetricsCollector" id="akka.cluster.MetricsCollector.apply">apply</a><span class="delimiter">(</span><a title="akka.actor.ExtendedActorSystem" id="akka.cluster.MetricsCollector.apply.system">system</a>: <a href="../../akka-actor/actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem" title="akka.actor.ExtendedActorSystem">ExtendedActorSystem</a>, <a title="akka.cluster.ClusterSettings" id="akka.cluster.MetricsCollector.apply.settings">settings</a>: <a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings" title="akka.cluster.ClusterSettings">ClusterSettings</a><span class="delimiter">)</span>: <a href="#akka.cluster;MetricsCollector" title="akka.cluster.MetricsCollector">MetricsCollector</a> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#akka.cluster.MetricsCollector.apply.settings" title="akka.cluster.ClusterSettings">settings</a>.<span class="delimiter">{</span> MetricsCollectorClass ⇒ fqcn <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="=&gt; akka.event.LoggingAdapter" id="akka.cluster.MetricsCollector.apply.log">log</a> = <a href="../../akka-actor/event/Logging.scala.html#akka.event.Logging.apply(882ba4a885)" title="(system: akka.actor.ActorSystem, logSource: String)(implicit evidence$3: akka.event.LogSource[String])akka.event.LoggingAdapter">Logging</a><a href="../../akka-actor/event/Logging.scala.html#akka.event.LogSource.fromString" title="=&gt; akka.event.LogSource[String]" class="delimiter">(</a><a href="#akka.cluster.MetricsCollector.apply.system" title="akka.actor.ExtendedActorSystem">system</a>, <span title="String(&quot;MetricsCollector&quot;)" class="string">&quot;MetricsCollector&quot;</span><span class="delimiter">)</span>
    <span title="akka.cluster.MetricsCollector" class="keyword">if</span> <span class="delimiter">(</span><a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsCollectorClass" title="=&gt; String">fqcn</a> <span title="(x$1: AnyRef)Boolean">==</span> classOf<span title="Class[akka.cluster.SigarMetricsCollector](classOf[akka.cluster.SigarMetricsCollector])" class="delimiter">[</span>SigarMetricsCollector<span class="delimiter">]</span>.<span title="()String">getName</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="(r: =&gt; akka.cluster.SigarMetricsCollector)scala.util.Try[akka.cluster.SigarMetricsCollector]">Try</span><span class="delimiter">(</span><a href="#akka.cluster;SigarMetricsCollector.<init>(8e1978fbbb)" title="(system: akka.actor.ActorSystem)akka.cluster.SigarMetricsCollector" class="keyword">new</a> <a href="#akka.cluster;SigarMetricsCollector" title="akka.cluster.SigarMetricsCollector">SigarMetricsCollector</a><span class="delimiter">(</span><a href="#akka.cluster.MetricsCollector.apply.system" title="akka.actor.ExtendedActorSystem">system</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="akka.cluster.MetricsCollector" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Success<span class="delimiter">(</span><a title="akka.cluster.SigarMetricsCollector" id="akka.cluster.MetricsCollector.apply.sigarCollector">sigarCollector</a><span class="delimiter">)</span> ⇒ <a href="#akka.cluster.MetricsCollector.apply.sigarCollector" title="akka.cluster.SigarMetricsCollector">sigarCollector</a>
        <span class="keyword">case</span> Failure<span class="delimiter">(</span><a title="Throwable" id="akka.cluster.MetricsCollector.apply.e">e</a><span class="delimiter">)</span> ⇒
          <a href="../../akka-actor/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.cluster.Cluster">Cluster</a><span class="delimiter">(</span><a href="#akka.cluster.MetricsCollector.apply.system" title="akka.actor.ExtendedActorSystem">system</a><span class="delimiter">)</span>.<a href="Cluster.scala.html#akka.cluster;Cluster.InfoLogger" title="akka.cluster.Cluster#InfoLogger.type">InfoLogger</a>.<a href="Cluster.scala.html#akka.cluster;Cluster.InfoLogger.logInfo(cc2e600322)" title="(message: String)Unit">logInfo</a><span class="delimiter">(</span>
            <span class="string">&quot;Metrics will be retreived from MBeans, and may be incorrect on some platforms. &quot;</span> +
              <span class="string">&quot;To increase metric accuracy add the 'sigar.jar' to the classpath and the appropriate &quot;</span> <span title="String(&quot;Metrics will be retreived from MBeans, and may be incorrect on some platforms. To increase metric accuracy add the \'sigar.jar\' to the classpath and the appropriate platform-specific native libary to \'java.library.path\'. Reason: &quot;)">+</span>
              <span class="string">&quot;platform-specific native libary to 'java.library.path'. Reason: &quot;</span> <span title="(x$1: Any)String">+</span>
              <a href="#akka.cluster.MetricsCollector.apply.e" title="Throwable">e</a>.<span title="()String">toString</span><span class="delimiter">)</span>
          <a href="#akka.cluster;JmxMetricsCollector.<init>(5d713eac4b)" title="(system: akka.actor.ActorSystem)akka.cluster.JmxMetricsCollector" class="keyword">new</a> <a href="#akka.cluster;JmxMetricsCollector" title="akka.cluster.JmxMetricsCollector">JmxMetricsCollector</a><span class="delimiter">(</span><a href="#akka.cluster.MetricsCollector.apply.system" title="akka.actor.ExtendedActorSystem">system</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#akka.cluster.MetricsCollector.apply.system" title="akka.actor.ExtendedActorSystem">system</a>.<a href="../../akka-actor/actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem.dynamicAccess" title="=&gt; akka.actor.DynamicAccess">dynamicAccess</a>.<a href="../../akka-actor/actor/DynamicAccess.scala.html#akka.actor;DynamicAccess.createInstanceFor(b43a2b150b)" title="[T](fqcn: String, args: scala.collection.immutable.Seq[(Class[_], AnyRef)])(implicit evidence$3: scala.reflect.ClassTag[T])scala.util.Try[T]">createInstanceFor</a><span title="(fqcn: String, args: scala.collection.immutable.Seq[(Class[_], AnyRef)])(implicit evidence$3: scala.reflect.ClassTag[akka.cluster.MetricsCollector])scala.util.Try[akka.cluster.MetricsCollector]" class="delimiter">[</span><a href="#akka.cluster;MetricsCollector" title="akka.cluster.MetricsCollector">MetricsCollector</a><span class="delimiter">]</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[akka.cluster.MetricsCollector]" class="delimiter">(</span><a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsCollectorClass" title="=&gt; String">fqcn</a>, <span title="(xs: (Class[akka.actor.ActorSystem], akka.actor.ExtendedActorSystem)*)List[(Class[akka.actor.ActorSystem], akka.actor.ExtendedActorSystem)]">List</span><span class="delimiter">(</span>classOf<span title="(x: Class[akka.actor.ActorSystem])ArrowAssoc[Class[akka.actor.ActorSystem]]" class="delimiter">[</span>ActorSystem<span class="delimiter">]</span> <span title="(y: akka.actor.ExtendedActorSystem)(Class[akka.actor.ActorSystem], akka.actor.ExtendedActorSystem)">-&gt;</span> <a href="#akka.cluster.MetricsCollector.apply.system" title="akka.actor.ExtendedActorSystem">system</a><span class="delimiter">)</span><span class="delimiter">)</span>.
        <span title="(f: PartialFunction[Throwable,akka.cluster.MetricsCollector])scala.util.Try[akka.cluster.MetricsCollector]">recover</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Throwable,Nothing] with Serializable" id="akka.cluster.MetricsCollector.apply;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
          <span class="keyword">case</span> <a title="Throwable" id="akka.cluster.MetricsCollector.apply;$anonfun.isDefinedAt.e">e</a> ⇒ <span title="Nothing" class="keyword">throw</span> <a href="../../akka-actor/AkkaException.scala.html#akka;ConfigurationException.<init>(3b0f220dea)" title="(msg: String)akka.ConfigurationException" class="keyword">new</a> <a href="../../akka-actor/AkkaException.scala.html#akka;ConfigurationException" title="akka.ConfigurationException">ConfigurationException</a><span class="delimiter">(</span><span title="String(&quot;Could not create custom metrics collector [&quot;)" class="string">&quot;Could not create custom metrics collector [&quot;</span> <span title="(x$1: Any)String">+</span> <a href="ClusterSettings.scala.html#akka.cluster;ClusterSettings.MetricsCollectorClass" title="=&gt; String">fqcn</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;] due to:&quot;)" class="string">&quot;] due to:&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#akka.cluster.MetricsCollector.apply;$anonfun.isDefinedAt.e" title="Throwable">e</a>.<span title="()String">toString</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>.<span title="=&gt; akka.cluster.MetricsCollector">get</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>

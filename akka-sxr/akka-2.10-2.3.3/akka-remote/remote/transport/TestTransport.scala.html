<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>akka-remote/remote/transport/TestTransport.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> akka.remote.transport

<span class="keyword">import</span> <a href="#akka.remote.transport.TestTransport" title="akka.remote.transport.TestTransport.type">TestTransport</a>._
<span class="keyword">import</span> akka.actor._
<span class="keyword">import</span> akka.remote.transport.<a href="Transport.scala.html#akka.remote.transport.AssociationHandle" title="akka.remote.transport.AssociationHandle.type">AssociationHandle</a>._
<span class="keyword">import</span> akka.remote.transport.<a href="Transport.scala.html#akka.remote.transport.Transport" title="akka.remote.transport.Transport.type">Transport</a>._
<span class="keyword">import</span> akka.util.ByteString
<span class="keyword">import</span> com.typesafe.config.Config
<span class="keyword">import</span> java.util.concurrent.<span class="delimiter">{</span> CopyOnWriteArrayList, ConcurrentHashMap <span class="delimiter">}</span>
<span class="keyword">import</span> scala.concurrent.duration._
<span class="keyword">import</span> scala.concurrent.<span class="delimiter">{</span> Await, Future, Promise <span class="delimiter">}</span>

<span class="keyword">import</span> scala.concurrent.<span title="scala.concurrent.ExecutionContext.type">ExecutionContext</span>.<span title="concurrent.ExecutionContext.Implicits.type">Implicits</span>.global

<span class="comment">/**
 * Transport implementation to be used for testing.
 *
 * The TestTransport is basically a shared memory between actor systems. The TestTransport could be programmed to
 * emulate different failure modes of a Transport implementation. TestTransport keeps a log of the activities it was
 * requested to do. This class is not optimized for performace and MUST not be used as an in-memory transport in
 * production systems.
 */</span>
<span class="keyword">class</span> <a title="class TestTransport extends AnyRef with akka.remote.transport.Transport" id="akka.remote.transport;TestTransport">TestTransport</a><a href="#akka.remote.transport;TestTransport" title="akka.remote.transport.TestTransport" class="delimiter">(</a>
  <span class="keyword">val</span> <a title="akka.actor.Address" id="akka.remote.transport;TestTransport.localAddress">localAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>,
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="akka.remote.transport.TestTransport.AssociationRegistry" id="akka.remote.transport;TestTransport.registry">registry</a>: <a href="#akka.remote.transport.TestTransport;AssociationRegistry" title="akka.remote.transport.TestTransport.AssociationRegistry">AssociationRegistry</a>,
  <span class="keyword">val</span> <a title="Int" id="akka.remote.transport.TestTransport.<init>$default$3">maximumPayloadBytes</a>: <span title="Int">Int</span> = <span title="Int(32000)" class="int">32000</span>,
  <span class="keyword">val</span> <a title="String" id="akka.remote.transport.TestTransport.<init>$default$4">schemeIdentifier</a>: <span title="String">String</span> = <span title="String(&quot;test&quot;)" class="string">&quot;test&quot;</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="Transport.scala.html#akka.remote.transport;Transport" title="akka.remote.transport.Transport">Transport</a> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(system: akka.actor.ExtendedActorSystem, conf: com.typesafe.config.Config)akka.remote.transport.TestTransport" id="akka.remote.transport;TestTransport.<init>(391e6e7fd9)" class="keyword">this</a><span class="delimiter">(</span><a title="akka.actor.ExtendedActorSystem" id="akka.remote.transport;TestTransport.<init>(391e6e7fd9).system">system</a>: <a href="../../../akka-actor/actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem" title="akka.actor.ExtendedActorSystem">ExtendedActorSystem</a>, <a title="com.typesafe.config.Config" id="akka.remote.transport;TestTransport.<init>(391e6e7fd9).conf">conf</a>: <span title="com.typesafe.config.Config">Config</span><span class="delimiter">)</span> = <span title="Unit" class="delimiter">{</span>
    <a href="#akka.remote.transport;TestTransport" title="TestTransport.this.type" class="keyword">this</a><span class="delimiter">(</span>
      <a href="../../../akka-actor/actor/Address.scala.html#akka.actor.AddressFromURIString.apply" title="(addr: String)akka.actor.Address">AddressFromURIString</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.<init>(391e6e7fd9).conf" title="com.typesafe.config.Config">conf</a>.<span title="(x$1: String)String">getString</span><span class="delimiter">(</span><span title="String(&quot;local-address&quot;)" class="string">&quot;local-address&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>,
      <a href="#akka.remote.transport.AssociationRegistry" title="akka.remote.transport.AssociationRegistry.type">AssociationRegistry</a>.<a href="#akka.remote.transport.AssociationRegistry.get" title="(key: String)akka.remote.transport.TestTransport.AssociationRegistry">get</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.<init>(391e6e7fd9).conf" title="com.typesafe.config.Config">conf</a>.<span title="(x$1: String)String">getString</span><span class="delimiter">(</span><span title="String(&quot;registry-key&quot;)" class="string">&quot;registry-key&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>,
      <a href="#akka.remote.transport;TestTransport.<init>(391e6e7fd9).conf" title="com.typesafe.config.Config">conf</a>.<span title="(x$1: String)Long">getBytes</span><span title="implicit scala.Predef.Long2long : (x: Long)Long" class="delimiter">(</span><span title="String(&quot;maximum-payload-bytes&quot;)" class="string">&quot;maximum-payload-bytes&quot;</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>,
      <a href="#akka.remote.transport;TestTransport.<init>(391e6e7fd9).conf" title="com.typesafe.config.Config">conf</a>.<span title="(x$1: String)String">getString</span><span class="delimiter">(</span><span title="String(&quot;scheme-identifier&quot;)" class="string">&quot;scheme-identifier&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">import</span> akka.remote.transport.<a href="#akka.remote.transport.TestTransport" title="akka.remote.transport.TestTransport.type">TestTransport</a>._

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(address: akka.actor.Address)Boolean" id="akka.remote.transport;TestTransport.isResponsibleFor">isResponsibleFor</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;TestTransport.isResponsibleFor.address">address</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener]" id="akka.remote.transport;TestTransport.associationListenerPromise">associationListenerPromise</a> = <span title="[T]()scala.concurrent.Promise[T]">Promise</span><span title="()scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener]" class="delimiter">[</span><a href="Transport.scala.html#akka.remote.transport.Transport;AssociationEventListener" title="akka.remote.transport.Transport.AssociationEventListener">AssociationEventListener</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; scala.concurrent.Future[(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])]" id="akka.remote.transport;TestTransport.defaultListen">defaultListen</a>: <span title="scala.concurrent.Future[(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])]">Future</span><span class="delimiter">[</span><span class="delimiter">(</span>Address, Promise<span class="delimiter">[</span>AssociationEventListener<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.registerTransport" title="(transport: akka.remote.transport.TestTransport, associationEventListenerFuture: scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])Unit">registerTransport</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport" title="akka.remote.transport.TestTransport" class="keyword">this</a>, <a href="#akka.remote.transport;TestTransport.associationListenerPromise" title="=&gt; scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener]">associationListenerPromise</a>.<span title="=&gt; scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener]">future</span><span class="delimiter">)</span>
    <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: (akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener]))scala.concurrent.Future[(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])]">successful</span><span class="delimiter">(</span><span title="(_1: akka.actor.Address, _2: scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])" class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.localAddress" title="=&gt; akka.actor.Address">localAddress</a>, <a href="#akka.remote.transport;TestTransport.associationListenerPromise" title="=&gt; scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener]">associationListenerPromise</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(remoteAddress: akka.actor.Address)scala.concurrent.Future[akka.remote.transport.AssociationHandle]" id="akka.remote.transport;TestTransport.defaultAssociate">defaultAssociate</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;TestTransport.defaultAssociate.remoteAddress">remoteAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <span title="scala.concurrent.Future[akka.remote.transport.AssociationHandle]">Future</span><span class="delimiter">[</span>AssociationHandle<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.transportFor" title="(address: akka.actor.Address)Option[(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]">transportFor</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.defaultAssociate.remoteAddress" title="akka.actor.Address">remoteAddress</a><span class="delimiter">)</span> <span title="scala.concurrent.Future[akka.remote.transport.AssociationHandle]" class="keyword">match</span> <span class="delimiter">{</span>

      <span class="keyword">case</span> Some<span class="delimiter">(</span><span class="delimiter">(</span><a title="akka.remote.transport.TestTransport" id="akka.remote.transport;TestTransport.defaultAssociate.remoteTransport">remoteTransport</a>, <a title="scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener]" id="akka.remote.transport;TestTransport.defaultAssociate.remoteListenerFuture">remoteListenerFuture</a><span class="delimiter">)</span><span class="delimiter">)</span> ⇒
        <span class="keyword">val</span> <a href="#akka.remote.transport;TestTransport.defaultAssociate.localHandle" title="(akka.remote.transport.TestAssociationHandle, akka.remote.transport.TestAssociationHandle)" class="delimiter">(</a><a href="#akka.remote.transport;TestTransport.defaultAssociate.x$1" title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport;TestTransport.defaultAssociate.localHandle">localHandle</a>, <a href="#akka.remote.transport;TestTransport.defaultAssociate.x$1" title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport;TestTransport.defaultAssociate.remoteHandle">remoteHandle</a><span class="delimiter">)</span> = <a href="#akka.remote.transport;TestTransport.createHandlePair" title="(remoteTransport: akka.remote.transport.TestTransport, remoteAddress: akka.actor.Address)(akka.remote.transport.TestAssociationHandle, akka.remote.transport.TestAssociationHandle)">createHandlePair</a><span title="(akka.remote.transport.TestAssociationHandle, akka.remote.transport.TestAssociationHandle) @unchecked" class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.defaultAssociate.remoteTransport" title="akka.remote.transport.TestTransport">remoteTransport</a>, <a href="#akka.remote.transport;TestTransport.defaultAssociate.remoteAddress" title="akka.actor.Address">remoteAddress</a><span class="delimiter">)</span>
        <a href="#akka.remote.transport;TestTransport.defaultAssociate.localHandle" title="akka.remote.transport.TestAssociationHandle">localHandle</a>.<a href="#akka.remote.transport;TestAssociationHandle.writable_=" title="(x$1: Boolean)Unit">writable</a> = <span title="Boolean(false)" class="keyword">false</span>
        <a href="#akka.remote.transport;TestTransport.defaultAssociate.remoteHandle" title="akka.remote.transport.TestAssociationHandle">remoteHandle</a>.<a href="#akka.remote.transport;TestAssociationHandle.writable_=" title="(x$1: Boolean)Unit">writable</a> = <span title="Boolean(false)" class="keyword">false</span>

        <span class="comment">// Pass a non-writable handle to remote first</span>
        <a href="#akka.remote.transport;TestTransport.defaultAssociate.remoteListenerFuture" title="scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener]">remoteListenerFuture</a> <span title="(f: akka.remote.transport.Transport.AssociationEventListener =&gt; scala.concurrent.Future[akka.remote.transport.AssociationHandle])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[akka.remote.transport.AssociationHandle]">flatMap</span> <a href="#akka.remote.transport;TestTransport.defaultAssociate.$anonfun.x0$2" title="scala.concurrent.Future[akka.remote.transport.AssociationHandle]" class="delimiter">{</a>
          <span class="keyword">case</span> <a title="akka.remote.transport.Transport.AssociationEventListener" id="akka.remote.transport;TestTransport.defaultAssociate.$anonfun.listener">listener</a> ⇒
            <a href="#akka.remote.transport;TestTransport.defaultAssociate.$anonfun.listener" title="akka.remote.transport.Transport.AssociationEventListener">listener</a> <a href="Transport.scala.html#akka.remote.transport.Transport;AssociationEventListener.notify(1d1bf972b0)" title="(ev: akka.remote.transport.Transport.AssociationEvent)Unit">notify</a> <a href="Transport.scala.html#akka.remote.transport.Transport;InboundAssociation" title="(association: akka.remote.transport.AssociationHandle)akka.remote.transport.Transport.InboundAssociation">InboundAssociation</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.defaultAssociate.remoteHandle" title="akka.remote.transport.TestAssociationHandle">remoteHandle</a><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="scala.concurrent.Future[akka.remote.transport.AssociationHandle.HandleEventListener]" id="akka.remote.transport;TestTransport.defaultAssociate.$anonfun.remoteHandlerFuture">remoteHandlerFuture</a> = <a href="#akka.remote.transport;TestTransport.defaultAssociate.remoteHandle" title="akka.remote.transport.TestAssociationHandle">remoteHandle</a>.<a href="#akka.remote.transport;TestAssociationHandle.readHandlerPromise" title="=&gt; scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">readHandlerPromise</a>.<span title="=&gt; scala.concurrent.Future[akka.remote.transport.AssociationHandle.HandleEventListener]">future</span>

            <span class="comment">// Registration of reader at local finishes the registration and enables communication</span>
            <span class="keyword">for</span> <span class="delimiter">{</span>
              <a title="akka.remote.transport.AssociationHandle.HandleEventListener" id="akka.remote.transport;TestTransport.defaultAssociate.$anonfun.$anonfun.remoteListener">remoteListener</a> ← <a href="#akka.remote.transport;TestTransport.defaultAssociate.$anonfun.remoteHandlerFuture" title="(f: akka.remote.transport.AssociationHandle.HandleEventListener =&gt; Unit)(implicit executor: scala.concurrent.ExecutionContext)Unit">remoteHandlerFuture</a>
              <a title="akka.remote.transport.AssociationHandle.HandleEventListener" id="akka.remote.transport;TestTransport.defaultAssociate.$anonfun.$anonfun.$anonfun.localListener">localListener</a> ← <a href="#akka.remote.transport;TestTransport.defaultAssociate.localHandle" title="akka.remote.transport.TestAssociationHandle">localHandle</a>.<a href="#akka.remote.transport;TestAssociationHandle.readHandlerPromise" title="=&gt; scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">readHandlerPromise</a>.<span title="(f: akka.remote.transport.AssociationHandle.HandleEventListener =&gt; Unit)(implicit executor: scala.concurrent.ExecutionContext)Unit">future</span>
            <span class="delimiter">}</span> <span class="delimiter">{</span>
              <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.registerListenerPair" title="(key: (akka.actor.Address, akka.actor.Address), listeners: (akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener))Unit">registerListenerPair</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.defaultAssociate.localHandle" title="akka.remote.transport.TestAssociationHandle">localHandle</a>.<a href="#akka.remote.transport;TestAssociationHandle.key" title="=&gt; (akka.actor.Address, akka.actor.Address)">key</a>, <span title="(_1: akka.remote.transport.AssociationHandle.HandleEventListener, _2: akka.remote.transport.AssociationHandle.HandleEventListener)(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)" class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.defaultAssociate.$anonfun.$anonfun.$anonfun.localListener" title="akka.remote.transport.AssociationHandle.HandleEventListener">localListener</a>, <a href="#akka.remote.transport;TestTransport.defaultAssociate.$anonfun.$anonfun.remoteListener" title="akka.remote.transport.AssociationHandle.HandleEventListener">remoteListener</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#akka.remote.transport;TestTransport.defaultAssociate.localHandle" title="akka.remote.transport.TestAssociationHandle">localHandle</a>.<a href="#akka.remote.transport;TestAssociationHandle.writable_=" title="(x$1: Boolean)Unit">writable</a> = <span title="Boolean(true)" class="keyword">true</span>
              <a href="#akka.remote.transport;TestTransport.defaultAssociate.remoteHandle" title="akka.remote.transport.TestAssociationHandle">remoteHandle</a>.<a href="#akka.remote.transport;TestAssociationHandle.writable_=" title="(x$1: Boolean)Unit">writable</a> = <span title="Boolean(true)" class="keyword">true</span>
            <span class="delimiter">}</span>

            <a href="#akka.remote.transport;TestTransport.defaultAssociate.$anonfun.remoteHandlerFuture" title="scala.concurrent.Future[akka.remote.transport.AssociationHandle.HandleEventListener]">remoteHandlerFuture</a>.<span title="(f: akka.remote.transport.AssociationHandle.HandleEventListener =&gt; akka.remote.transport.TestAssociationHandle)(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[akka.remote.transport.TestAssociationHandle]">map</span> <span title="=&gt; scala.concurrent.ExecutionContextExecutor" class="delimiter">{</span> <a title="akka.remote.transport.AssociationHandle.HandleEventListener" id="akka.remote.transport;TestTransport.defaultAssociate.$anonfun.$anonfun.x$2">_</a> ⇒ <a href="#akka.remote.transport;TestTransport.defaultAssociate.localHandle" title="akka.remote.transport.TestAssociationHandle">localHandle</a> <span class="delimiter">}</span>
        <span class="delimiter">}</span>

      <span class="keyword">case</span> <span title="None.type">None</span> ⇒
        <span title="scala.concurrent.Future.type">Future</span>.<span title="(exception: Throwable)scala.concurrent.Future[Nothing]">failed</span><span class="delimiter">(</span><span title="akka.remote.transport.Transport.InvalidAssociationException" class="keyword">new</span> <a href="Transport.scala.html#akka.remote.transport.Transport;InvalidAssociationException" title="akka.remote.transport.Transport.InvalidAssociationException">InvalidAssociationException</a><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;No registered transport: &quot;)">No registered transport: $</span><a href="#akka.remote.transport;TestTransport.defaultAssociate.remoteAddress" title="akka.actor.Address">remoteAddress</a><span title="String(&quot;&quot;)" class="string">&quot;</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(remoteTransport: akka.remote.transport.TestTransport, remoteAddress: akka.actor.Address)(akka.remote.transport.TestAssociationHandle, akka.remote.transport.TestAssociationHandle)" id="akka.remote.transport;TestTransport.createHandlePair">createHandlePair</a><span class="delimiter">(</span><a title="akka.remote.transport.TestTransport" id="akka.remote.transport;TestTransport.createHandlePair.remoteTransport">remoteTransport</a>: <a href="#akka.remote.transport;TestTransport" title="akka.remote.transport.TestTransport">TestTransport</a>, <a title="akka.actor.Address" id="akka.remote.transport;TestTransport.createHandlePair.remoteAddress">remoteAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <span title="(akka.remote.transport.TestAssociationHandle, akka.remote.transport.TestAssociationHandle)" class="delimiter">(</span>TestAssociationHandle, TestAssociationHandle<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport;TestTransport.createHandlePair.localHandle">localHandle</a> = <span title="akka.remote.transport.TestAssociationHandle" class="keyword">new</span> <a href="#akka.remote.transport.TestAssociationHandle.readResolve" title="akka.remote.transport.TestAssociationHandle">TestAssociationHandle</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.localAddress" title="=&gt; akka.actor.Address">localAddress</a>, <a href="#akka.remote.transport;TestTransport.createHandlePair.remoteAddress" title="akka.actor.Address">remoteAddress</a>, <a href="#akka.remote.transport;TestTransport" title="akka.remote.transport.TestTransport" class="keyword">this</a>, inbound = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport;TestTransport.createHandlePair.remoteHandle">remoteHandle</a> = <span title="akka.remote.transport.TestAssociationHandle" class="keyword">new</span> <a href="#akka.remote.transport.TestAssociationHandle.readResolve" title="akka.remote.transport.TestAssociationHandle">TestAssociationHandle</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.createHandlePair.remoteAddress" title="akka.actor.Address">remoteAddress</a>, <a href="#akka.remote.transport;TestTransport.localAddress" title="=&gt; akka.actor.Address">localAddress</a>, <a href="#akka.remote.transport;TestTransport.createHandlePair.remoteTransport" title="akka.remote.transport.TestTransport">remoteTransport</a>, inbound = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

    <span title="(_1: akka.remote.transport.TestAssociationHandle, _2: akka.remote.transport.TestAssociationHandle)(akka.remote.transport.TestAssociationHandle, akka.remote.transport.TestAssociationHandle)" class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.createHandlePair.localHandle" title="akka.remote.transport.TestAssociationHandle">localHandle</a>, <a href="#akka.remote.transport;TestTransport.createHandlePair.remoteHandle" title="akka.remote.transport.TestAssociationHandle">remoteHandle</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; scala.concurrent.Future[Boolean]" id="akka.remote.transport;TestTransport.defaultShutdown">defaultShutdown</a>: <span title="scala.concurrent.Future[Boolean]">Future</span><span class="delimiter">[</span>Boolean<span class="delimiter">]</span> = <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: Boolean)scala.concurrent.Future[Boolean]">successful</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

  <span class="comment">/**
   * The [[akka.remote.transport.TestTransport.SwitchableLoggedBehavior]] for the listen() method.
   */</span>
  <span class="keyword">val</span> <a title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[Unit,(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])]" id="akka.remote.transport;TestTransport.listenBehavior">listenBehavior</a> = <span title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[Unit,(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])]" class="keyword">new</span> <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior" title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[Unit,(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])]">SwitchableLoggedBehavior</a><span class="delimiter">[</span>Unit, <span class="delimiter">(</span>Address, Promise<span class="delimiter">[</span>AssociationEventListener<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="delimiter">(</span><a title="Unit" id="akka.remote.transport;TestTransport.listenBehavior.$anonfun.x$3">_</a><span class="delimiter">)</span> ⇒ <a href="#akka.remote.transport;TestTransport.defaultListen" title="=&gt; scala.concurrent.Future[(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])]">defaultListen</a>,
    <span class="delimiter">(</span><a title="Unit" id="akka.remote.transport;TestTransport.listenBehavior.$anonfun.x$4">_</a><span class="delimiter">)</span> ⇒ <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.logActivity" title="(activity: akka.remote.transport.TestTransport.Activity)Unit">logActivity</a><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport.ListenAttempt.readResolve" title="(boundAddress: akka.actor.Address)akka.remote.transport.TestTransport.ListenAttempt">ListenAttempt</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.localAddress" title="=&gt; akka.actor.Address">localAddress</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * The [[akka.remote.transport.TestTransport.SwitchableLoggedBehavior]] for the associate() method.
   */</span>
  <span class="keyword">val</span> <a title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[akka.actor.Address,akka.remote.transport.AssociationHandle]" id="akka.remote.transport;TestTransport.associateBehavior">associateBehavior</a> = <span title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[akka.actor.Address,akka.remote.transport.AssociationHandle]" class="keyword">new</span> <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior" title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[akka.actor.Address,akka.remote.transport.AssociationHandle]">SwitchableLoggedBehavior</a><span class="delimiter">[</span>Address, AssociationHandle<span class="delimiter">]</span><span class="delimiter">(</span>
    <a href="#akka.remote.transport;TestTransport.defaultAssociate" title="(remoteAddress: akka.actor.Address)scala.concurrent.Future[akka.remote.transport.AssociationHandle]">defaultAssociate</a> _,
    <span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;TestTransport.associateBehavior.$anonfun.remoteAddress">remoteAddress</a><span class="delimiter">)</span> ⇒ <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.logActivity" title="(activity: akka.remote.transport.TestTransport.Activity)Unit">logActivity</a><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport.AssociateAttempt.readResolve" title="(localAddress: akka.actor.Address, remoteAddress: akka.actor.Address)akka.remote.transport.TestTransport.AssociateAttempt">AssociateAttempt</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.localAddress" title="=&gt; akka.actor.Address">localAddress</a>, <a href="#akka.remote.transport;TestTransport.associateBehavior.$anonfun.remoteAddress" title="akka.actor.Address">remoteAddress</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * The [[akka.remote.transport.TestTransport.SwitchableLoggedBehavior]] for the shutdown() method.
   */</span>
  <span class="keyword">val</span> <a title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[Unit,Boolean]" id="akka.remote.transport;TestTransport.shutdownBehavior">shutdownBehavior</a> = <span title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[Unit,Boolean]" class="keyword">new</span> <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior" title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[Unit,Boolean]">SwitchableLoggedBehavior</a><span class="delimiter">[</span>Unit, Boolean<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="delimiter">(</span><a title="Unit" id="akka.remote.transport;TestTransport.shutdownBehavior.$anonfun.x$5">_</a><span class="delimiter">)</span> ⇒ <a href="#akka.remote.transport;TestTransport.defaultShutdown" title="=&gt; scala.concurrent.Future[Boolean]">defaultShutdown</a>,
    <span class="delimiter">(</span><a title="Unit" id="akka.remote.transport;TestTransport.shutdownBehavior.$anonfun.x$6">_</a><span class="delimiter">)</span> ⇒ <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.logActivity" title="(activity: akka.remote.transport.TestTransport.Activity)Unit">logActivity</a><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport.ShutdownAttempt.readResolve" title="(boundAddress: akka.actor.Address)akka.remote.transport.TestTransport.ShutdownAttempt">ShutdownAttempt</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.localAddress" title="=&gt; akka.actor.Address">localAddress</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.concurrent.Future[(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])]" id="akka.remote.transport;TestTransport.listen">listen</a>: <span title="scala.concurrent.Future[(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])]">Future</span><span class="delimiter">[</span><span class="delimiter">(</span>Address, Promise<span class="delimiter">[</span>AssociationEventListener<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> = <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.apply" title="(params: Unit)scala.concurrent.Future[(akka.actor.Address, scala.concurrent.Promise[akka.remote.transport.Transport.AssociationEventListener])]">listenBehavior</a><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(remoteAddress: akka.actor.Address)scala.concurrent.Future[akka.remote.transport.AssociationHandle]" id="akka.remote.transport;TestTransport.associate">associate</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;TestTransport.associate.remoteAddress">remoteAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <span title="scala.concurrent.Future[akka.remote.transport.AssociationHandle]">Future</span><span class="delimiter">[</span>AssociationHandle<span class="delimiter">]</span> = <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.apply" title="(params: akka.actor.Address)scala.concurrent.Future[akka.remote.transport.AssociationHandle]">associateBehavior</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.associate.remoteAddress" title="akka.actor.Address">remoteAddress</a><span class="delimiter">)</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()scala.concurrent.Future[Boolean]" id="akka.remote.transport;TestTransport.shutdown">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="scala.concurrent.Future[Boolean]">Future</span><span class="delimiter">[</span>Boolean<span class="delimiter">]</span> = <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.apply" title="(params: Unit)scala.concurrent.Future[Boolean]">shutdownBehavior</a><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(params: (akka.remote.transport.TestAssociationHandle, akka.util.ByteString))scala.concurrent.Future[Boolean]" id="akka.remote.transport;TestTransport.defaultWrite">defaultWrite</a><span class="delimiter">(</span><a title="(akka.remote.transport.TestAssociationHandle, akka.util.ByteString)" id="akka.remote.transport;TestTransport.defaultWrite.params">params</a>: <span title="(akka.remote.transport.TestAssociationHandle, akka.util.ByteString)" class="delimiter">(</span>TestAssociationHandle, ByteString<span class="delimiter">)</span><span class="delimiter">)</span>: <span title="scala.concurrent.Future[Boolean]">Future</span><span class="delimiter">[</span>Boolean<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.getRemoteReadHandlerFor" title="(localHandle: akka.remote.transport.TestAssociationHandle)Option[akka.remote.transport.AssociationHandle.HandleEventListener]">getRemoteReadHandlerFor</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.defaultWrite.params" title="(akka.remote.transport.TestAssociationHandle, akka.util.ByteString)">params</a>.<span title="=&gt; akka.remote.transport.TestAssociationHandle">_1</span><span class="delimiter">)</span> <span title="scala.concurrent.Future[Boolean]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><a title="akka.remote.transport.AssociationHandle.HandleEventListener" id="akka.remote.transport;TestTransport.defaultWrite.listener">listener</a><span class="delimiter">)</span> ⇒
        <a href="#akka.remote.transport;TestTransport.defaultWrite.listener" title="akka.remote.transport.AssociationHandle.HandleEventListener">listener</a> <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;HandleEventListener.notify(a3fa5b160e)" title="(ev: akka.remote.transport.AssociationHandle.HandleEvent)Unit">notify</a> <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;InboundPayload" title="(payload: akka.util.ByteString)akka.remote.transport.AssociationHandle.InboundPayload">InboundPayload</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.defaultWrite.params" title="(akka.remote.transport.TestAssociationHandle, akka.util.ByteString)">params</a>.<span title="=&gt; akka.util.ByteString">_2</span><span class="delimiter">)</span>
        <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: Boolean)scala.concurrent.Future[Boolean]">successful</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="None.type">None</span> ⇒
        <span title="scala.concurrent.Future.type">Future</span>.<span title="(exception: Throwable)scala.concurrent.Future[Nothing]">failed</span><span class="delimiter">(</span><span title="(x$1: String)IllegalStateException" class="keyword">new</span> <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;No association present&quot;)" class="string">&quot;No association present&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(handle: akka.remote.transport.TestAssociationHandle)scala.concurrent.Future[Unit]" id="akka.remote.transport;TestTransport.defaultDisassociate">defaultDisassociate</a><span class="delimiter">(</span><a title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport;TestTransport.defaultDisassociate.handle">handle</a>: <a href="#akka.remote.transport.TestAssociationHandle.readResolve" title="akka.remote.transport.TestAssociationHandle">TestAssociationHandle</a><span class="delimiter">)</span>: <span title="scala.concurrent.Future[Unit]">Future</span><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.deregisterAssociation" title="(key: (akka.actor.Address, akka.actor.Address))Option[(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]">deregisterAssociation</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.defaultDisassociate.handle" title="akka.remote.transport.TestAssociationHandle">handle</a>.<a href="#akka.remote.transport;TestAssociationHandle.key" title="=&gt; (akka.actor.Address, akka.actor.Address)">key</a><span class="delimiter">)</span>.<span title="(f: ((akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)) =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span>
      <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo" title="(handle: akka.remote.transport.TestAssociationHandle, listenerPair: (akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener))akka.remote.transport.AssociationHandle.HandleEventListener">remoteListenerRelativeTo</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.defaultDisassociate.handle" title="akka.remote.transport.TestAssociationHandle">handle</a>, <a href="#akka.remote.transport;TestTransport.defaultDisassociate.$anonfun.x$7" title="(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)">_</a><span class="delimiter">)</span> <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;HandleEventListener.notify(a3fa5b160e)" title="(ev: akka.remote.transport.AssociationHandle.HandleEvent)Unit">notify</a> <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;Disassociated" title="(info: akka.remote.transport.AssociationHandle.DisassociateInfo)akka.remote.transport.AssociationHandle.Disassociated">Disassociated</a><span class="delimiter">(</span><a href="Transport.scala.html#akka.remote.transport.AssociationHandle" title="akka.remote.transport.AssociationHandle.type">AssociationHandle</a>.<a href="Transport.scala.html#akka.remote.transport.AssociationHandle.Unknown" title="akka.remote.transport.AssociationHandle.Unknown.type">Unknown</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: Unit)scala.concurrent.Future[Unit]">successful</span><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The [[akka.remote.transport.TestTransport.SwitchableLoggedBehavior]] for the write() method on handles. All
   * handle calls pass through this call. Please note, that write operations return a Boolean synchronously, so
   * altering the behavior via pushDelayed will turn write to a blocking operation -- use of pushDelayed therefore
   * is not recommended.
   */</span>
  <span class="keyword">val</span> <a title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[(akka.remote.transport.TestAssociationHandle, akka.util.ByteString),Boolean]" id="akka.remote.transport;TestTransport.writeBehavior">writeBehavior</a> = <span title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[(akka.remote.transport.TestAssociationHandle, akka.util.ByteString),Boolean]" class="keyword">new</span> <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior" title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[(akka.remote.transport.TestAssociationHandle, akka.util.ByteString),Boolean]">SwitchableLoggedBehavior</a><span class="delimiter">[</span><span class="delimiter">(</span>TestAssociationHandle, ByteString<span class="delimiter">)</span>, Boolean<span class="delimiter">]</span><span class="delimiter">(</span>
    defaultBehavior = <span class="delimiter">{</span>
      <a href="#akka.remote.transport;TestTransport.defaultWrite" title="(params: (akka.remote.transport.TestAssociationHandle, akka.util.ByteString))scala.concurrent.Future[Boolean]">defaultWrite</a> _
    <span class="delimiter">}</span>,
    logCallback = <a href="#akka.remote.transport;TestTransport.writeBehavior.$anonfun.x0$1" title="Unit" class="delimiter">{</a>
      <span class="keyword">case</span> <span class="delimiter">(</span><a title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport;TestTransport.writeBehavior.$anonfun.handle">handle</a>, <a title="akka.util.ByteString" id="akka.remote.transport;TestTransport.writeBehavior.$anonfun.payload">payload</a><span class="delimiter">)</span> ⇒
        <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.logActivity" title="(activity: akka.remote.transport.TestTransport.Activity)Unit">logActivity</a><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport.WriteAttempt.readResolve" title="(sender: akka.actor.Address, recipient: akka.actor.Address, payload: akka.util.ByteString)akka.remote.transport.TestTransport.WriteAttempt">WriteAttempt</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.writeBehavior.$anonfun.handle" title="akka.remote.transport.TestAssociationHandle">handle</a>.<a href="#akka.remote.transport;TestAssociationHandle.localAddress" title="=&gt; akka.actor.Address">localAddress</a>, <a href="#akka.remote.transport;TestTransport.writeBehavior.$anonfun.handle" title="akka.remote.transport.TestAssociationHandle">handle</a>.<a href="#akka.remote.transport;TestAssociationHandle.remoteAddress" title="=&gt; akka.actor.Address">remoteAddress</a>, <a href="#akka.remote.transport;TestTransport.writeBehavior.$anonfun.payload" title="akka.util.ByteString">payload</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/**
   * The [[akka.remote.transport.TestTransport.SwitchableLoggedBehavior]] for the disassociate() method on handles. All
   * handle calls pass through this call.
   */</span>
  <span class="keyword">val</span> <a title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[akka.remote.transport.TestAssociationHandle,Unit]" id="akka.remote.transport;TestTransport.disassociateBehavior">disassociateBehavior</a> = <span title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[akka.remote.transport.TestAssociationHandle,Unit]" class="keyword">new</span> <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior" title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[akka.remote.transport.TestAssociationHandle,Unit]">SwitchableLoggedBehavior</a><span class="delimiter">[</span>TestAssociationHandle, Unit<span class="delimiter">]</span><span class="delimiter">(</span>
    defaultBehavior = <span class="delimiter">{</span>
      <a href="#akka.remote.transport;TestTransport.defaultDisassociate" title="(handle: akka.remote.transport.TestAssociationHandle)scala.concurrent.Future[Unit]">defaultDisassociate</a> _
    <span class="delimiter">}</span>,
    logCallback = <span class="delimiter">{</span>
      <span class="delimiter">(</span><a title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport;TestTransport.disassociateBehavior.$anonfun.handle">handle</a><span class="delimiter">)</span> ⇒
        <a href="#akka.remote.transport;TestTransport.registry" title="=&gt; akka.remote.transport.TestTransport.AssociationRegistry">registry</a>.<a href="#akka.remote.transport.TestTransport;AssociationRegistry.logActivity" title="(activity: akka.remote.transport.TestTransport.Activity)Unit">logActivity</a><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport.DisassociateAttempt.readResolve" title="(requester: akka.actor.Address, remote: akka.actor.Address)akka.remote.transport.TestTransport.DisassociateAttempt">DisassociateAttempt</a><span class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.disassociateBehavior.$anonfun.handle" title="akka.remote.transport.TestAssociationHandle">handle</a>.<a href="#akka.remote.transport;TestAssociationHandle.localAddress" title="=&gt; akka.actor.Address">localAddress</a>, <a href="#akka.remote.transport;TestTransport.disassociateBehavior.$anonfun.handle" title="akka.remote.transport.TestAssociationHandle">handle</a>.<a href="#akka.remote.transport;TestAssociationHandle.remoteAddress" title="=&gt; akka.actor.Address">remoteAddress</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="keyword">private</span><span class="delimiter">[</span>akka<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(handle: akka.remote.transport.TestAssociationHandle, payload: akka.util.ByteString)Boolean" id="akka.remote.transport;TestTransport.write">write</a><span class="delimiter">(</span><a title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport;TestTransport.write.handle">handle</a>: <a href="#akka.remote.transport.TestAssociationHandle.readResolve" title="akka.remote.transport.TestAssociationHandle">TestAssociationHandle</a>, <a title="akka.util.ByteString" id="akka.remote.transport;TestTransport.write.payload">payload</a>: <a href="../../../akka-actor/util/ByteString.scala.html#akka.util;ByteString" title="akka.util.ByteString">ByteString</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
    <span title="scala.concurrent.Await.type">Await</span>.<span title="(awaitable: scala.concurrent.Awaitable[Boolean], atMost: scala.concurrent.duration.Duration)Boolean">result</span><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.apply" title="(params: (akka.remote.transport.TestAssociationHandle, akka.util.ByteString))scala.concurrent.Future[Boolean]">writeBehavior</a><span class="delimiter">(</span><span title="(_1: akka.remote.transport.TestAssociationHandle, _2: akka.util.ByteString)(akka.remote.transport.TestAssociationHandle, akka.util.ByteString)" class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.write.handle" title="akka.remote.transport.TestAssociationHandle">handle</a>, <a href="#akka.remote.transport;TestTransport.write.payload" title="akka.util.ByteString">payload</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="implicit scala.concurrent.duration.package.DurationInt : (n: Int)concurrent.duration.DurationInt" class="int">3</span>.<span title="=&gt; scala.concurrent.duration.FiniteDuration">seconds</span><span class="delimiter">)</span>

  <span class="keyword">private</span><span class="delimiter">[</span>akka<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(handle: akka.remote.transport.TestAssociationHandle)Unit" id="akka.remote.transport;TestTransport.disassociate">disassociate</a><span class="delimiter">(</span><a title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport;TestTransport.disassociate.handle">handle</a>: <a href="#akka.remote.transport.TestAssociationHandle.readResolve" title="akka.remote.transport.TestAssociationHandle">TestAssociationHandle</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.apply" title="(params: akka.remote.transport.TestAssociationHandle)scala.concurrent.Future[Unit]">disassociateBehavior</a><span title="Unit" class="delimiter">(</span><a href="#akka.remote.transport;TestTransport.disassociate.handle" title="akka.remote.transport.TestAssociationHandle">handle</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="akka.remote.transport;TestTransport.toString">toString</a>: <span title="String">String</span> = <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;TestTransport(&quot;)">TestTransport($</span><a href="#akka.remote.transport;TestTransport.localAddress" title="=&gt; akka.actor.Address">localAddress</a><span title="String(&quot;)&quot;)" class="string">)&quot;</span>

<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="akka.remote.transport.TestTransport.type" id="akka.remote.transport.TestTransport">TestTransport</a> <a href="#akka.remote.transport.TestTransport" title="akka.remote.transport.TestTransport.type" class="delimiter">{</a>

  <span class="keyword">type</span> <a title="[A, B]A =&gt; scala.concurrent.Future[B]" id="akka.remote.transport.TestTransport;Behavior">Behavior</a><span class="delimiter">[</span><a title="" id="akka.remote.transport.TestTransport;Behavior;A">A</a>, <a title="" id="akka.remote.transport.TestTransport;Behavior;B">B</a><span class="delimiter">]</span> = <span class="delimiter">(</span>A<span class="delimiter">)</span> ⇒ Future<span class="delimiter">[</span>B<span class="delimiter">]</span>

  <span class="comment">/**
   * Test utility to make behavior of functions that return some Future[B] controllable from tests. This tool is able
   * to overwrite default behavior with any generic behavior, including failure, and exposes control to the timing of
   * the completition of the returned future.
   *
   * The utility is implemented as a stack of behaviors, where the behavior on the top of the stack represents the
   * currently active behavior. The bottom of the stack always contains the defaultBehavior which can not be popped
   * out.
   *
   * @param defaultBehavior
   *   The original behavior that might be overwritten. It is always possible to restore this behavior
   *
   * @param logCallback
   *   Function that will be called independently of the current active behavior
   *
   * @tparam A
   *   Parameter type of the wrapped function. If it takes multiple parameters it must be wrapped in a tuple.
   *
   * @tparam B
   *   Type parameter of the future that the original function returns.
   */</span>
  <span class="keyword">class</span> <a title="class SwitchableLoggedBehavior[A, B] extends AnyRef with A =&gt; scala.concurrent.Future[B]" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior">SwitchableLoggedBehavior</a><span class="delimiter">[</span><a title="" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior;A">A</a>, <a title="" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior;B">B</a><span class="delimiter">]</span><a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior" title="akka.remote.transport.TestTransport.SwitchableLoggedBehavior[A,B]" class="delimiter">(</a><a title="A =&gt; scala.concurrent.Future[B]" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.defaultBehavior">defaultBehavior</a>: <span title="A =&gt; scala.concurrent.Future[B]">Behavior</span><span class="delimiter">[</span>A, B<span class="delimiter">]</span>, <a title="A =&gt; Unit" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.logCallback">logCallback</a>: <span class="delimiter">(</span>A<span class="delimiter">)</span> ⇒ Unit<span class="delimiter">)</span> <span class="keyword">extends</span> <span title="A =&gt; scala.concurrent.Future[B]">Behavior</span><span class="delimiter">[</span>A, B<span class="delimiter">]</span> <span class="delimiter">{</span>

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.util.concurrent.CopyOnWriteArrayList[A =&gt; scala.concurrent.Future[B]]" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.behaviorStack">behaviorStack</a> = <span title="java.util.concurrent.CopyOnWriteArrayList[A =&gt; scala.concurrent.Future[B]]" class="keyword">new</span> <span title="java.util.concurrent.CopyOnWriteArrayList[A =&gt; scala.concurrent.Future[B]]">CopyOnWriteArrayList</span><span class="delimiter">[</span>Behavior<span class="delimiter">[</span>A, B<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.behaviorStack" title="=&gt; java.util.concurrent.CopyOnWriteArrayList[A =&gt; scala.concurrent.Future[B]]">behaviorStack</a>.<span title="(x$1: Int, x$2: A =&gt; scala.concurrent.Future[B])Unit">add</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.defaultBehavior" title="A =&gt; scala.concurrent.Future[B]">defaultBehavior</a><span class="delimiter">)</span>

    <span class="comment">/**
     * Changes the current behavior to the provided one.
     *
     * @param behavior
     *   Function that takes a parameter type A and returns a Future[B].
     */</span>
    <span class="keyword">def</span> <a title="(behavior: A =&gt; scala.concurrent.Future[B])Unit" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.push">push</a><span class="delimiter">(</span><a title="A =&gt; scala.concurrent.Future[B]" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.push.behavior">behavior</a>: <span title="A =&gt; scala.concurrent.Future[B]">Behavior</span><span class="delimiter">[</span>A, B<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.behaviorStack" title="=&gt; java.util.concurrent.CopyOnWriteArrayList[A =&gt; scala.concurrent.Future[B]]">behaviorStack</a>.<span title="(x$1: Int, x$2: A =&gt; scala.concurrent.Future[B])Unit">add</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.push.behavior" title="A =&gt; scala.concurrent.Future[B]">behavior</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Changes the behavior to return a completed future with the given constant value.
     *
     * @param c
     *   The constant the future will be completed with.
     */</span>
    <span class="keyword">def</span> <a title="(c: B)Unit" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushConstant">pushConstant</a><span class="delimiter">(</span><a title="B" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushConstant.c">c</a>: <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior;B" title="B">B</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.push" title="(behavior: A =&gt; scala.concurrent.Future[B])Unit">push</a> <span class="delimiter">{</span>
      <span class="delimiter">(</span><a title="A" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushConstant.$anonfun.x">x</a><span class="delimiter">)</span> ⇒ <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: B)scala.concurrent.Future[B]">successful</span><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushConstant.c" title="B">c</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Changes the current behavior to return a failed future containing the given Throwable.
     *
     * @param e
     *   The throwable the failed future will contain.
     */</span>
    <span class="keyword">def</span> <a title="(e: Throwable)Unit" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushError">pushError</a><span class="delimiter">(</span><a title="Throwable" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushError.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.push" title="(behavior: A =&gt; scala.concurrent.Future[B])Unit">push</a> <span class="delimiter">{</span>
      <span class="delimiter">(</span><a title="A" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushError.$anonfun.x">x</a><span class="delimiter">)</span> ⇒ <span title="scala.concurrent.Future.type">Future</span>.<span title="(exception: Throwable)scala.concurrent.Future[Nothing]">failed</span><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushError.e" title="Throwable">e</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Enables control of the completion of the previously active behavior. Wraps the previous behavior in a new
     * one, returns a control promise that starts the original behavior after the control promise is completed.
     *
     * @return
     *   A promise, which delays the completion of the original future until after this promise is completed.
     */</span>
    <span class="keyword">def</span> <a title="=&gt; scala.concurrent.Promise[Unit]" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushDelayed">pushDelayed</a>: <span title="scala.concurrent.Promise[Unit]">Promise</span><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.concurrent.Promise[Unit]" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushDelayed.controlPromise">controlPromise</a>: <span title="scala.concurrent.Promise[Unit]">Promise</span><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <span title="()scala.concurrent.Promise[Unit]">Promise</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="A =&gt; scala.concurrent.Future[B]" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushDelayed.originalBehavior">originalBehavior</a> = <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.currentBehavior" title="=&gt; A =&gt; scala.concurrent.Future[B]">currentBehavior</a>

      <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.push" title="(behavior: A =&gt; scala.concurrent.Future[B])Unit">push</a><span class="delimiter">(</span>
        <span class="delimiter">(</span>params: <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior;A" title="A">A</a><span class="delimiter">)</span> ⇒ <span class="keyword">for</span> <span class="delimiter">(</span><a title="Unit" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushDelayed.$anonfun.$anonfun.delayed">delayed</a> ← <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushDelayed.controlPromise" title="scala.concurrent.Promise[Unit]">controlPromise</a>.<span title="(f: Unit =&gt; scala.concurrent.Future[B])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[B]">future</span>; <a title="B" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushDelayed.$anonfun.$anonfun.$anonfun.original">original</a> ← <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushDelayed.originalBehavior" title="(v1: A)scala.concurrent.Future[B]">originalBehavior</a><span title="(f: B =&gt; B)(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[B]" class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushDelayed.$anonfun.params" title="A">params</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">yield</span> <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushDelayed.$anonfun.$anonfun.$anonfun.original" title="B">original</a><span class="delimiter">)</span>

      <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pushDelayed.controlPromise" title="scala.concurrent.Promise[Unit]">controlPromise</a>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Restores the previous behavior.
     */</span>
    <span class="keyword">def</span> <a title="()Unit" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.pop">pop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.behaviorStack" title="=&gt; java.util.concurrent.CopyOnWriteArrayList[A =&gt; scala.concurrent.Future[B]]">behaviorStack</a>.<span title="()Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.behaviorStack" title="=&gt; java.util.concurrent.CopyOnWriteArrayList[A =&gt; scala.concurrent.Future[B]]">behaviorStack</a>.<span title="(x$1: Int)A =&gt; scala.concurrent.Future[B]">remove</span><span title="Unit" class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; A =&gt; scala.concurrent.Future[B]" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.currentBehavior">currentBehavior</a> = <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.behaviorStack" title="=&gt; java.util.concurrent.CopyOnWriteArrayList[A =&gt; scala.concurrent.Future[B]]">behaviorStack</a>.<span title="(x$1: Int)A =&gt; scala.concurrent.Future[B]">get</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

    <span class="comment">/**
     * Applies the current behavior, and invokes the callback.
     *
     * @param params
     *   The parameters of this behavior.
     * @return
     *   The result of this behavior wrapped in a future.
     */</span>
    <span class="keyword">def</span> <a title="(params: A)scala.concurrent.Future[B]" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.apply">apply</a><span class="delimiter">(</span><a title="A" id="akka.remote.transport.TestTransport;SwitchableLoggedBehavior.apply.params">params</a>: <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior;A" title="A">A</a><span class="delimiter">)</span>: <span title="scala.concurrent.Future[B]">Future</span><span class="delimiter">[</span>B<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.logCallback" title="(v1: A)Unit">logCallback</a><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.apply.params" title="A">params</a><span class="delimiter">)</span>
      <a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.currentBehavior" title="(v1: A)scala.concurrent.Future[B]">currentBehavior</a><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;SwitchableLoggedBehavior.apply.params" title="A">params</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Base trait for activities that are logged by [[akka.remote.transport.TestTransport]].
   */</span>
  <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Activity extends AnyRef" id="akka.remote.transport.TestTransport;Activity">Activity</a>

  <span class="keyword">case class</span> <a title="class ListenAttempt extends AnyRef with akka.remote.transport.TestTransport.Activity with Product with Serializable" id="akka.remote.transport.TestTransport.ListenAttempt.readResolve">ListenAttempt</a><a href="#akka.remote.transport.TestTransport.ListenAttempt.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.remote.transport.TestTransport;ListenAttempt.boundAddress">boundAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#akka.remote.transport.TestTransport;Activity" title="akka.remote.transport.TestTransport.Activity">Activity</a>
  <span class="keyword">case class</span> <a title="class AssociateAttempt extends AnyRef with akka.remote.transport.TestTransport.Activity with Product with Serializable" id="akka.remote.transport.TestTransport.AssociateAttempt.readResolve">AssociateAttempt</a><a href="#akka.remote.transport.TestTransport.AssociateAttempt.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.remote.transport.TestTransport;AssociateAttempt.localAddress">localAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.actor.Address" id="akka.remote.transport.TestTransport;AssociateAttempt.remoteAddress">remoteAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#akka.remote.transport.TestTransport;Activity" title="akka.remote.transport.TestTransport.Activity">Activity</a>
  <span class="keyword">case class</span> <a title="class ShutdownAttempt extends AnyRef with akka.remote.transport.TestTransport.Activity with Product with Serializable" id="akka.remote.transport.TestTransport.ShutdownAttempt.readResolve">ShutdownAttempt</a><a href="#akka.remote.transport.TestTransport.ShutdownAttempt.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.remote.transport.TestTransport;ShutdownAttempt.boundAddress">boundAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#akka.remote.transport.TestTransport;Activity" title="akka.remote.transport.TestTransport.Activity">Activity</a>
  <span class="keyword">case class</span> <a title="class WriteAttempt extends AnyRef with akka.remote.transport.TestTransport.Activity with Product with Serializable" id="akka.remote.transport.TestTransport.WriteAttempt.readResolve">WriteAttempt</a><a href="#akka.remote.transport.TestTransport.WriteAttempt.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.remote.transport.TestTransport;WriteAttempt.sender">sender</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.actor.Address" id="akka.remote.transport.TestTransport;WriteAttempt.recipient">recipient</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.util.ByteString" id="akka.remote.transport.TestTransport;WriteAttempt.payload">payload</a>: <a href="../../../akka-actor/util/ByteString.scala.html#akka.util;ByteString" title="akka.util.ByteString">ByteString</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#akka.remote.transport.TestTransport;Activity" title="akka.remote.transport.TestTransport.Activity">Activity</a>
  <span class="keyword">case class</span> <a title="class DisassociateAttempt extends AnyRef with akka.remote.transport.TestTransport.Activity with Product with Serializable" id="akka.remote.transport.TestTransport.DisassociateAttempt.readResolve">DisassociateAttempt</a><a href="#akka.remote.transport.TestTransport.DisassociateAttempt.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.remote.transport.TestTransport;DisassociateAttempt.requester">requester</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.actor.Address" id="akka.remote.transport.TestTransport;DisassociateAttempt.remote">remote</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#akka.remote.transport.TestTransport;Activity" title="akka.remote.transport.TestTransport.Activity">Activity</a>

  <span class="comment">/**
   * Shared state among [[akka.remote.transport.TestTransport]] instances. Coordinates the transports and the means
   * of communication between them.
   */</span>
  <span class="keyword">class</span> <a title="class AssociationRegistry extends AnyRef" id="akka.remote.transport.TestTransport;AssociationRegistry">AssociationRegistry</a> <a href="#akka.remote.transport.TestTransport;AssociationRegistry" title="akka.remote.transport.TestTransport.AssociationRegistry" class="delimiter">{</a>

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.util.concurrent.CopyOnWriteArrayList[akka.remote.transport.TestTransport.Activity]" id="akka.remote.transport.TestTransport;AssociationRegistry.activityLog">activityLog</a> = <span title="java.util.concurrent.CopyOnWriteArrayList[akka.remote.transport.TestTransport.Activity]" class="keyword">new</span> <span title="java.util.concurrent.CopyOnWriteArrayList[akka.remote.transport.TestTransport.Activity]">CopyOnWriteArrayList</span><span class="delimiter">[</span>Activity<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.util.concurrent.ConcurrentHashMap[akka.actor.Address,(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]" id="akka.remote.transport.TestTransport;AssociationRegistry.transportTable">transportTable</a> = <span title="java.util.concurrent.ConcurrentHashMap[akka.actor.Address,(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]" class="keyword">new</span> <span title="java.util.concurrent.ConcurrentHashMap[akka.actor.Address,(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]">ConcurrentHashMap</span><span class="delimiter">[</span>Address, <span class="delimiter">(</span>TestTransport, Future<span class="delimiter">[</span>AssociationEventListener<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.util.concurrent.ConcurrentHashMap[(akka.actor.Address, akka.actor.Address),(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]" id="akka.remote.transport.TestTransport;AssociationRegistry.listenersTable">listenersTable</a> = <span title="java.util.concurrent.ConcurrentHashMap[(akka.actor.Address, akka.actor.Address),(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]" class="keyword">new</span> <span title="java.util.concurrent.ConcurrentHashMap[(akka.actor.Address, akka.actor.Address),(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]">ConcurrentHashMap</span><span class="delimiter">[</span><span class="delimiter">(</span>Address, Address<span class="delimiter">)</span>, <span class="delimiter">(</span>HandleEventListener, HandleEventListener<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">/**
     * Returns the remote endpoint for a pair of endpoints relative to the owner of the supplied handle.
     * @param handle the reference handle to determine the remote endpoint relative to
     * @param listenerPair pair of listeners in initiator, receiver order.
     * @return
     */</span>
    <span class="keyword">def</span> <a title="(handle: akka.remote.transport.TestAssociationHandle, listenerPair: (akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener))akka.remote.transport.AssociationHandle.HandleEventListener" id="akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo">remoteListenerRelativeTo</a><span class="delimiter">(</span><a title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo.handle">handle</a>: <a href="#akka.remote.transport.TestAssociationHandle.readResolve" title="akka.remote.transport.TestAssociationHandle">TestAssociationHandle</a>,
                                 <a title="(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)" id="akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo.listenerPair">listenerPair</a>: <span title="(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)" class="delimiter">(</span>HandleEventListener, HandleEventListener<span class="delimiter">)</span><span class="delimiter">)</span>: <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;HandleEventListener" title="akka.remote.transport.AssociationHandle.HandleEventListener">HandleEventListener</a> = <span class="delimiter">{</span>
      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo.listenerPair" title="(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)">listenerPair</a> <span title="akka.remote.transport.AssociationHandle.HandleEventListener" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span class="delimiter">(</span><a title="akka.remote.transport.AssociationHandle.HandleEventListener" id="akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo.initiator">initiator</a>, <a title="akka.remote.transport.AssociationHandle.HandleEventListener" id="akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo.receiver">receiver</a><span class="delimiter">)</span> ⇒ <span title="akka.remote.transport.AssociationHandle.HandleEventListener" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo.handle" title="akka.remote.transport.TestAssociationHandle">handle</a>.<a href="#akka.remote.transport;TestAssociationHandle.inbound" title="=&gt; Boolean">inbound</a><span class="delimiter">)</span> <a href="#akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo.initiator" title="akka.remote.transport.AssociationHandle.HandleEventListener">initiator</a> <span class="keyword">else</span> <a href="#akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo.receiver" title="akka.remote.transport.AssociationHandle.HandleEventListener">receiver</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Logs a transport activity.
     *
     * @param activity Activity to be logged.
     */</span>
    <span class="keyword">def</span> <a title="(activity: akka.remote.transport.TestTransport.Activity)Unit" id="akka.remote.transport.TestTransport;AssociationRegistry.logActivity">logActivity</a><span class="delimiter">(</span><a title="akka.remote.transport.TestTransport.Activity" id="akka.remote.transport.TestTransport;AssociationRegistry.logActivity.activity">activity</a>: <a href="#akka.remote.transport.TestTransport;Activity" title="akka.remote.transport.TestTransport.Activity">Activity</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.activityLog" title="=&gt; java.util.concurrent.CopyOnWriteArrayList[akka.remote.transport.TestTransport.Activity]">activityLog</a>.<span title="(x$1: akka.remote.transport.TestTransport.Activity)Boolean">add</span><span title="Unit" class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.logActivity.activity" title="akka.remote.transport.TestTransport.Activity">activity</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Takes a thread-safe snapshot of the current state of the activity log.
     *
     * @return Collection containing activities ordered left-to-right according to time (first element is earliest).
     */</span>
    <span class="keyword">def</span> <a title="=&gt; Seq[akka.remote.transport.TestTransport.Activity]" id="akka.remote.transport.TestTransport;AssociationRegistry.logSnapshot">logSnapshot</a>: <span title="Seq[akka.remote.transport.TestTransport.Activity]">Seq</span><span class="delimiter">[</span>Activity<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="List[akka.remote.transport.TestTransport.Activity]" id="akka.remote.transport.TestTransport;AssociationRegistry.logSnapshot.result">result</a> = List<span class="delimiter">[</span>Activity<span class="delimiter">]</span><span title="scala.collection.immutable.Nil.type" class="delimiter">(</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="java.util.Iterator[akka.remote.transport.TestTransport.Activity]" id="akka.remote.transport.TestTransport;AssociationRegistry.logSnapshot.it">it</a> = <a href="#akka.remote.transport.TestTransport;AssociationRegistry.activityLog" title="=&gt; java.util.concurrent.CopyOnWriteArrayList[akka.remote.transport.TestTransport.Activity]">activityLog</a>.<span title="()java.util.Iterator[akka.remote.transport.TestTransport.Activity]">iterator</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.logSnapshot.it" title="java.util.Iterator[akka.remote.transport.TestTransport.Activity]">it</a>.<span title="()Boolean">hasNext</span><span class="delimiter">)</span> <a href="#akka.remote.transport.TestTransport;AssociationRegistry.logSnapshot.result" title="List[akka.remote.transport.TestTransport.Activity]">result</a> <a href="#akka.remote.transport.TestTransport;AssociationRegistry.logSnapshot.while$1" title="(x: akka.remote.transport.TestTransport.Activity)List[akka.remote.transport.TestTransport.Activity]">::=</a> <a href="#akka.remote.transport.TestTransport;AssociationRegistry.logSnapshot.it" title="java.util.Iterator[akka.remote.transport.TestTransport.Activity]">it</a>.<span title="()akka.remote.transport.TestTransport.Activity">next</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.logSnapshot.result" title="List[akka.remote.transport.TestTransport.Activity]">result</a>.<span title="=&gt; List[akka.remote.transport.TestTransport.Activity]">reverse</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Clears the activity log.
     */</span>
    <span class="keyword">def</span> <a title="()Unit" id="akka.remote.transport.TestTransport;AssociationRegistry.clearLog">clearLog</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.activityLog" title="=&gt; java.util.concurrent.CopyOnWriteArrayList[akka.remote.transport.TestTransport.Activity]">activityLog</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Records a mapping between an address and the corresponding (transport, associationEventListener) pair.
     *
     * @param transport
     *   The transport that is to be registered. The address of this transport will be used as key.
     * @param associationEventListenerFuture
     *   The future that will be completed with the listener that will handle the events for the given transport.
     */</span>
    <span class="keyword">def</span> <a title="(transport: akka.remote.transport.TestTransport, associationEventListenerFuture: scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])Unit" id="akka.remote.transport.TestTransport;AssociationRegistry.registerTransport">registerTransport</a><span class="delimiter">(</span><a title="akka.remote.transport.TestTransport" id="akka.remote.transport.TestTransport;AssociationRegistry.registerTransport.transport">transport</a>: <a href="#akka.remote.transport;TestTransport" title="akka.remote.transport.TestTransport">TestTransport</a>, <a title="scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener]" id="akka.remote.transport.TestTransport;AssociationRegistry.registerTransport.associationEventListenerFuture">associationEventListenerFuture</a>: <span title="scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener]">Future</span><span class="delimiter">[</span>AssociationEventListener<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.transportTable" title="=&gt; java.util.concurrent.ConcurrentHashMap[akka.actor.Address,(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]">transportTable</a>.<span title="(x$1: akka.actor.Address, x$2: (akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener]))(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])">put</span><span title="Unit" class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.registerTransport.transport" title="akka.remote.transport.TestTransport">transport</a>.<a href="#akka.remote.transport;TestTransport.localAddress" title="=&gt; akka.actor.Address">localAddress</a>, <span title="(_1: akka.remote.transport.TestTransport, _2: scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])" class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.registerTransport.transport" title="akka.remote.transport.TestTransport">transport</a>, <a href="#akka.remote.transport.TestTransport;AssociationRegistry.registerTransport.associationEventListenerFuture" title="scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener]">associationEventListenerFuture</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Indicates if all given transports were successfully registered. No associations can be established between
     * transports that are not yet registered.
     *
     * @param addresses
     *   The listen addresses of transports that participate in the test case.
     * @return
     *   True if all transports are successfully registered.
     */</span>
    <span class="keyword">def</span> <a title="(addresses: akka.actor.Address*)Boolean" id="akka.remote.transport.TestTransport;AssociationRegistry.transportsReady">transportsReady</a><span class="delimiter">(</span><a title="akka.actor.Address*" id="akka.remote.transport.TestTransport;AssociationRegistry.transportsReady.addresses">addresses</a>: <span title="akka.actor.Address*">Address</span>*<span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.transportsReady.addresses" title="akka.actor.Address*">addresses</a> <span title="(p: akka.actor.Address =&gt; Boolean)Boolean">forall</span> <span class="delimiter">{</span>
        <a href="#akka.remote.transport.TestTransport;AssociationRegistry.transportTable" title="=&gt; java.util.concurrent.ConcurrentHashMap[akka.actor.Address,(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]">transportTable</a>.<span title="(x$1: Any)Boolean">containsKey</span><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.transportsReady.$anonfun.x$8" title="akka.actor.Address">_</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Registers a Future of two handle event listeners corresponding to the two endpoints of an association.
     *
     * @param key
     *   Ordered pair of addresses representing an association. First element must be the address of the initiator.
     * @param listeners
     *   The future containing the listeners that will be responsible for handling the events of the two endpoints of the
     *   association. Elements in the pair must be in the same order as the addresses in the key parameter.
     */</span>
    <span class="keyword">def</span> <a title="(key: (akka.actor.Address, akka.actor.Address), listeners: (akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener))Unit" id="akka.remote.transport.TestTransport;AssociationRegistry.registerListenerPair">registerListenerPair</a><span class="delimiter">(</span><a title="(akka.actor.Address, akka.actor.Address)" id="akka.remote.transport.TestTransport;AssociationRegistry.registerListenerPair.key">key</a>: <span title="(akka.actor.Address, akka.actor.Address)" class="delimiter">(</span>Address, Address<span class="delimiter">)</span>, <a title="(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)" id="akka.remote.transport.TestTransport;AssociationRegistry.registerListenerPair.listeners">listeners</a>: <span title="(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)" class="delimiter">(</span>HandleEventListener, HandleEventListener<span class="delimiter">)</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.listenersTable" title="=&gt; java.util.concurrent.ConcurrentHashMap[(akka.actor.Address, akka.actor.Address),(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]">listenersTable</a>.<span title="(x$1: (akka.actor.Address, akka.actor.Address), x$2: (akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener))(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)">put</span><span title="Unit" class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.registerListenerPair.key" title="(akka.actor.Address, akka.actor.Address)">key</a>, <a href="#akka.remote.transport.TestTransport;AssociationRegistry.registerListenerPair.listeners" title="(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)">listeners</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Removes an association.
     * @param key
     *   Ordered pair of addresses representing an association. First element is the address of the initiator.
     * @return
     *   The original entries.
     */</span>
    <span class="keyword">def</span> <a title="(key: (akka.actor.Address, akka.actor.Address))Option[(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]" id="akka.remote.transport.TestTransport;AssociationRegistry.deregisterAssociation">deregisterAssociation</a><span class="delimiter">(</span><a title="(akka.actor.Address, akka.actor.Address)" id="akka.remote.transport.TestTransport;AssociationRegistry.deregisterAssociation.key">key</a>: <span title="(akka.actor.Address, akka.actor.Address)" class="delimiter">(</span>Address, Address<span class="delimiter">)</span><span class="delimiter">)</span>: <span title="Option[(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span>HandleEventListener, HandleEventListener<span class="delimiter">)</span><span class="delimiter">]</span> =
      <span title="(x: (akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener))Option[(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]">Option</span><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.listenersTable" title="=&gt; java.util.concurrent.ConcurrentHashMap[(akka.actor.Address, akka.actor.Address),(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]">listenersTable</a>.<span title="(x$1: Any)(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)">remove</span><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.deregisterAssociation.key" title="(akka.actor.Address, akka.actor.Address)">key</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="comment">/**
     * Tests if an association was registered.
     *
     * @param initiatorAddress The initiator of the association.
     * @param remoteAddress The other address of the association.
     *
     * @return True if there is an association for the given addresses.
     */</span>
    <span class="keyword">def</span> <a title="(initiatorAddress: akka.actor.Address, remoteAddress: akka.actor.Address)Boolean" id="akka.remote.transport.TestTransport;AssociationRegistry.existsAssociation">existsAssociation</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport.TestTransport;AssociationRegistry.existsAssociation.initiatorAddress">initiatorAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.actor.Address" id="akka.remote.transport.TestTransport;AssociationRegistry.existsAssociation.remoteAddress">remoteAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.listenersTable" title="=&gt; java.util.concurrent.ConcurrentHashMap[(akka.actor.Address, akka.actor.Address),(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]">listenersTable</a>.<span title="(x$1: Any)Boolean">containsKey</span><span class="delimiter">(</span><span title="(_1: akka.actor.Address, _2: akka.actor.Address)(akka.actor.Address, akka.actor.Address)" class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.existsAssociation.initiatorAddress" title="akka.actor.Address">initiatorAddress</a>, <a href="#akka.remote.transport.TestTransport;AssociationRegistry.existsAssociation.remoteAddress" title="akka.actor.Address">remoteAddress</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Returns the event handler corresponding to the remote endpoint of the given local handle. In other words
     * it returns the listener that will receive InboundPayload events when {{{write()}}} is called on the given handle.
     *
     * @param localHandle The handle
     * @return The option that contains the Future for the listener if exists.
     */</span>
    <span class="keyword">def</span> <a title="(localHandle: akka.remote.transport.TestAssociationHandle)Option[akka.remote.transport.AssociationHandle.HandleEventListener]" id="akka.remote.transport.TestTransport;AssociationRegistry.getRemoteReadHandlerFor">getRemoteReadHandlerFor</a><span class="delimiter">(</span><a title="akka.remote.transport.TestAssociationHandle" id="akka.remote.transport.TestTransport;AssociationRegistry.getRemoteReadHandlerFor.localHandle">localHandle</a>: <a href="#akka.remote.transport.TestAssociationHandle.readResolve" title="akka.remote.transport.TestAssociationHandle">TestAssociationHandle</a><span class="delimiter">)</span>: <span title="Option[akka.remote.transport.AssociationHandle.HandleEventListener]">Option</span><span class="delimiter">[</span>HandleEventListener<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span title="(x: (akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener))Option[(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]">Option</span><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.listenersTable" title="=&gt; java.util.concurrent.ConcurrentHashMap[(akka.actor.Address, akka.actor.Address),(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]">listenersTable</a>.<span title="(x$1: Any)(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)">get</span><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.getRemoteReadHandlerFor.localHandle" title="akka.remote.transport.TestAssociationHandle">localHandle</a>.<a href="#akka.remote.transport;TestAssociationHandle.key" title="=&gt; (akka.actor.Address, akka.actor.Address)">key</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(f: ((akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)) =&gt; akka.remote.transport.AssociationHandle.HandleEventListener)Option[akka.remote.transport.AssociationHandle.HandleEventListener]">map</span> <span class="delimiter">{</span> <a href="#akka.remote.transport.TestTransport;AssociationRegistry.remoteListenerRelativeTo" title="(handle: akka.remote.transport.TestAssociationHandle, listenerPair: (akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener))akka.remote.transport.AssociationHandle.HandleEventListener">remoteListenerRelativeTo</a><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.getRemoteReadHandlerFor.localHandle" title="akka.remote.transport.TestAssociationHandle">localHandle</a>, <a href="#akka.remote.transport.TestTransport;AssociationRegistry.getRemoteReadHandlerFor.$anonfun.x$9" title="(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)">_</a><span class="delimiter">)</span> <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Returns the Transport bound to the given address.
     *
     * @param address The address bound to the transport.
     * @return The transport if exists.
     */</span>
    <span class="keyword">def</span> <a title="(address: akka.actor.Address)Option[(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]" id="akka.remote.transport.TestTransport;AssociationRegistry.transportFor">transportFor</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport.TestTransport;AssociationRegistry.transportFor.address">address</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <span title="Option[(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span>TestTransport, Future<span class="delimiter">[</span>AssociationEventListener<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> =
      <span title="(x: (akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener]))Option[(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]">Option</span><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.transportTable" title="=&gt; java.util.concurrent.ConcurrentHashMap[akka.actor.Address,(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]">transportTable</a>.<span title="(x$1: Any)(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])">get</span><span class="delimiter">(</span><a href="#akka.remote.transport.TestTransport;AssociationRegistry.transportFor.address" title="akka.actor.Address">address</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="comment">/**
     * Resets the state of the registry. ''Warning!'' This method is not atomic.
     */</span>
    <span class="keyword">def</span> <a title="()Unit" id="akka.remote.transport.TestTransport;AssociationRegistry.reset">reset</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.clearLog" title="()Unit">clearLog</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.transportTable" title="=&gt; java.util.concurrent.ConcurrentHashMap[akka.actor.Address,(akka.remote.transport.TestTransport, scala.concurrent.Future[akka.remote.transport.Transport.AssociationEventListener])]">transportTable</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.remote.transport.TestTransport;AssociationRegistry.listenersTable" title="=&gt; java.util.concurrent.ConcurrentHashMap[(akka.actor.Address, akka.actor.Address),(akka.remote.transport.AssociationHandle.HandleEventListener, akka.remote.transport.AssociationHandle.HandleEventListener)]">listenersTable</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span title="AnyRef" class="delimiter">}</span>

<span class="comment">/*
 NOTE: This is a global shared state between different actor systems. The purpose of this class is to allow dynamically
 loaded TestTransports to set up a shared AssociationRegistry. Extensions could not be used for this purpose, as the injection
 of the shared instance must happen during the startup time of the actor system. Association registries are looked
 up via a string key. Until we find a better way to inject an AssociationRegistry to multiple actor systems it is
 strongly recommended to use long, randomly generated strings to key the registry to avoid interference between tests.
*/</span>
<span title="AnyRef" class="keyword">object</span> <a title="akka.remote.transport.AssociationRegistry.type" id="akka.remote.transport.AssociationRegistry">AssociationRegistry</a> <a href="#akka.remote.transport.AssociationRegistry" title="akka.remote.transport.AssociationRegistry.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">val</span> <a title="scala.collection.mutable.Map[String,akka.remote.transport.TestTransport.AssociationRegistry]" id="akka.remote.transport.AssociationRegistry.registries">registries</a> = scala.collection.mutable.<span title="[A, B](elems: (A, B)*)scala.collection.mutable.Map[A,B]">Map</span><span title="(elems: (String, akka.remote.transport.TestTransport.AssociationRegistry)*)scala.collection.mutable.Map[String,akka.remote.transport.TestTransport.AssociationRegistry]" class="delimiter">[</span><span title="String">String</span>, <a href="#akka.remote.transport.TestTransport;AssociationRegistry" title="akka.remote.transport.TestTransport.AssociationRegistry">AssociationRegistry</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(key: String)akka.remote.transport.TestTransport.AssociationRegistry" id="akka.remote.transport.AssociationRegistry.get">get</a><span class="delimiter">(</span><a title="String" id="akka.remote.transport.AssociationRegistry.get.key">key</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#akka.remote.transport.TestTransport;AssociationRegistry" title="akka.remote.transport.TestTransport.AssociationRegistry">AssociationRegistry</a> = <span class="keyword">this</span>.<span title="(x$1: akka.remote.transport.TestTransport.AssociationRegistry)akka.remote.transport.TestTransport.AssociationRegistry">synchronized</span> <span class="delimiter">{</span>
    <a href="#akka.remote.transport.AssociationRegistry.registries" title="=&gt; scala.collection.mutable.Map[String,akka.remote.transport.TestTransport.AssociationRegistry]">registries</a>.<span title="(key: String, op: =&gt; akka.remote.transport.TestTransport.AssociationRegistry)akka.remote.transport.TestTransport.AssociationRegistry">getOrElseUpdate</span><span class="delimiter">(</span><a href="#akka.remote.transport.AssociationRegistry.get.key" title="String">key</a>, <span title="akka.remote.transport.TestTransport.AssociationRegistry" class="keyword">new</span> <a href="#akka.remote.transport.TestTransport;AssociationRegistry" title="akka.remote.transport.TestTransport.AssociationRegistry">AssociationRegistry</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="akka.remote.transport.AssociationRegistry.clear">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="keyword">this</span>.<span title="(x$1: Unit)Unit">synchronized</span> <span class="delimiter">{</span> <a href="#akka.remote.transport.AssociationRegistry.registries" title="=&gt; scala.collection.mutable.Map[String,akka.remote.transport.TestTransport.AssociationRegistry]">registries</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">case class</span> <a title="class TestAssociationHandle extends AnyRef with akka.remote.transport.AssociationHandle with Product with Serializable" id="akka.remote.transport.TestAssociationHandle.readResolve">TestAssociationHandle</a><a href="#akka.remote.transport.TestAssociationHandle.readResolve" title="Product" class="delimiter">(</a>
  <a title="akka.actor.Address" id="akka.remote.transport;TestAssociationHandle.localAddress">localAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>,
  <a title="akka.actor.Address" id="akka.remote.transport;TestAssociationHandle.remoteAddress">remoteAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>,
  <a title="akka.remote.transport.TestTransport" id="akka.remote.transport;TestAssociationHandle.transport">transport</a>: <a href="#akka.remote.transport;TestTransport" title="akka.remote.transport.TestTransport">TestTransport</a>,
  <a title="Boolean" id="akka.remote.transport;TestAssociationHandle.inbound">inbound</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="Transport.scala.html#akka.remote.transport;AssociationHandle" title="akka.remote.transport.AssociationHandle">AssociationHandle</a> <span class="delimiter">{</span>

  @volatile <span class="keyword">var</span> <a title="Boolean" id="akka.remote.transport;TestAssociationHandle.writable_=">writable</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="keyword">override</span> <span class="keyword">val</span> <a title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]" id="akka.remote.transport;TestAssociationHandle.readHandlerPromise">readHandlerPromise</a>: <span title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">Promise</span><span class="delimiter">[</span>HandleEventListener<span class="delimiter">]</span> = <span title="()scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">Promise</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(payload: akka.util.ByteString)Boolean" id="akka.remote.transport;TestAssociationHandle.write">write</a><span class="delimiter">(</span><a title="akka.util.ByteString" id="akka.remote.transport;TestAssociationHandle.write.payload">payload</a>: <a href="../../../akka-actor/util/ByteString.scala.html#akka.util;ByteString" title="akka.util.ByteString">ByteString</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
    <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;TestAssociationHandle.writable_=" title="=&gt; Boolean">writable</a><span class="delimiter">)</span> <a href="#akka.remote.transport;TestAssociationHandle.transport" title="=&gt; akka.remote.transport.TestTransport">transport</a>.<a href="#akka.remote.transport;TestTransport.write" title="(handle: akka.remote.transport.TestAssociationHandle, payload: akka.util.ByteString)Boolean">write</a><span class="delimiter">(</span><a href="#akka.remote.transport.TestAssociationHandle.readResolve" title="akka.remote.transport.TestAssociationHandle" class="keyword">this</a>, <a href="#akka.remote.transport;TestAssociationHandle.write.payload" title="akka.util.ByteString">payload</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="akka.remote.transport;TestAssociationHandle.disassociate">disassociate</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.remote.transport;TestAssociationHandle.transport" title="=&gt; akka.remote.transport.TestTransport">transport</a>.<a href="#akka.remote.transport;TestTransport.disassociate" title="(handle: akka.remote.transport.TestAssociationHandle)Unit">disassociate</a><span class="delimiter">(</span><a href="#akka.remote.transport.TestAssociationHandle.readResolve" title="akka.remote.transport.TestAssociationHandle" class="keyword">this</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Key used in [[akka.remote.transport.TestTransport.AssociationRegistry]] to identify associations. Contains an
   * ordered pair of addresses, where the first element of the pair is always the initiator of the association.
   */</span>
  <span class="keyword">val</span> <a title="(akka.actor.Address, akka.actor.Address)" id="akka.remote.transport;TestAssociationHandle.key">key</a> = <span title="(akka.actor.Address, akka.actor.Address)" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.remote.transport;TestAssociationHandle.inbound" title="=&gt; Boolean">inbound</a><span class="delimiter">)</span> <span title="(_1: akka.actor.Address, _2: akka.actor.Address)(akka.actor.Address, akka.actor.Address)" class="delimiter">(</span><a href="#akka.remote.transport;TestAssociationHandle.localAddress" title="=&gt; akka.actor.Address">localAddress</a>, <a href="#akka.remote.transport;TestAssociationHandle.remoteAddress" title="=&gt; akka.actor.Address">remoteAddress</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="(_1: akka.actor.Address, _2: akka.actor.Address)(akka.actor.Address, akka.actor.Address)" class="delimiter">(</span><a href="#akka.remote.transport;TestAssociationHandle.remoteAddress" title="=&gt; akka.actor.Address">remoteAddress</a>, <a href="#akka.remote.transport;TestAssociationHandle.localAddress" title="=&gt; akka.actor.Address">localAddress</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

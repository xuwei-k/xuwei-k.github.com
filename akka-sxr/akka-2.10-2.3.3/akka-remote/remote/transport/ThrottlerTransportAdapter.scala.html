<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>akka-remote/remote/transport/ThrottlerTransportAdapter.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> akka.remote.transport

<span class="keyword">import</span> akka.actor._
<span class="keyword">import</span> akka.pattern.<span class="delimiter">{</span> PromiseActorRef, ask, pipe <span class="delimiter">}</span>
<span class="keyword">import</span> akka.remote.transport.<a href="AbstractTransportAdapter.scala.html#akka.remote.transport.ActorTransportAdapter" title="akka.remote.transport.ActorTransportAdapter.type">ActorTransportAdapter</a>.AssociateUnderlying
<span class="keyword">import</span> akka.remote.transport.<a href="AkkaPduCodec.scala.html#akka.remote.transport.AkkaPduCodec" title="akka.remote.transport.AkkaPduCodec.type">AkkaPduCodec</a>.Associate
<span class="keyword">import</span> akka.remote.transport.<a href="Transport.scala.html#akka.remote.transport.AssociationHandle" title="akka.remote.transport.AssociationHandle.type">AssociationHandle</a>.<span class="delimiter">{</span> DisassociateInfo, ActorHandleEventListener, Disassociated, InboundPayload, HandleEventListener <span class="delimiter">}</span>
<span class="keyword">import</span> akka.remote.transport.<a href="#akka.remote.transport.ThrottlerManager" title="akka.remote.transport.ThrottlerManager.type">ThrottlerManager</a>.<span class="delimiter">{</span> Listener, Handle, ListenerAndMode, Checkin <span class="delimiter">}</span>
<span class="keyword">import</span> akka.remote.transport.<a href="#akka.remote.transport.ThrottlerTransportAdapter" title="akka.remote.transport.ThrottlerTransportAdapter.type">ThrottlerTransportAdapter</a>._
<span class="keyword">import</span> akka.remote.transport.<a href="Transport.scala.html#akka.remote.transport.Transport" title="akka.remote.transport.Transport.type">Transport</a>._
<span class="keyword">import</span> akka.util.<span class="delimiter">{</span> Timeout, ByteString <span class="delimiter">}</span>
<span class="keyword">import</span> java.util.concurrent.TimeUnit
<span class="keyword">import</span> java.util.concurrent.atomic.AtomicReference
<span class="keyword">import</span> scala.annotation.tailrec
<span class="keyword">import</span> scala.collection.immutable.Queue
<span class="keyword">import</span> scala.concurrent.<span class="delimiter">{</span> Future, Promise <span class="delimiter">}</span>
<span class="keyword">import</span> scala.concurrent.duration._
<span class="keyword">import</span> scala.math.min
<span class="keyword">import</span> scala.util.<span class="delimiter">{</span> Success, Failure <span class="delimiter">}</span>
<span class="keyword">import</span> scala.util.control.NonFatal
<span class="keyword">import</span> akka.dispatch.sysmsg.<span class="delimiter">{</span> Unwatch, Watch <span class="delimiter">}</span>
<span class="keyword">import</span> akka.dispatch.<span class="delimiter">{</span> UnboundedMessageQueueSemantics, RequiresMessageQueue <span class="delimiter">}</span>
<span class="keyword">import</span> akka.remote.RARP

<span class="keyword">class</span> <a title="class ThrottlerProvider extends AnyRef with akka.remote.transport.TransportAdapterProvider" id="akka.remote.transport;ThrottlerProvider">ThrottlerProvider</a> <a href="#akka.remote.transport;ThrottlerProvider" title="akka.remote.transport.ThrottlerProvider" class="keyword">extends</a> <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;TransportAdapterProvider" title="akka.remote.transport.TransportAdapterProvider">TransportAdapterProvider</a> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(wrappedTransport: akka.remote.transport.Transport, system: akka.actor.ExtendedActorSystem)akka.remote.transport.Transport" id="akka.remote.transport;ThrottlerProvider.create">create</a><span class="delimiter">(</span><a title="akka.remote.transport.Transport" id="akka.remote.transport;ThrottlerProvider.create.wrappedTransport">wrappedTransport</a>: <a href="Transport.scala.html#akka.remote.transport;Transport" title="akka.remote.transport.Transport">Transport</a>, <a title="akka.actor.ExtendedActorSystem" id="akka.remote.transport;ThrottlerProvider.create.system">system</a>: <a href="../../../akka-actor/actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem" title="akka.actor.ExtendedActorSystem">ExtendedActorSystem</a><span class="delimiter">)</span>: <a href="Transport.scala.html#akka.remote.transport;Transport" title="akka.remote.transport.Transport">Transport</a> =
    <span title="akka.remote.transport.ThrottlerTransportAdapter" class="keyword">new</span> <a href="#akka.remote.transport;ThrottlerTransportAdapter" title="akka.remote.transport.ThrottlerTransportAdapter">ThrottlerTransportAdapter</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerProvider.create.wrappedTransport" title="akka.remote.transport.Transport">wrappedTransport</a>, <a href="#akka.remote.transport;ThrottlerProvider.create.system" title="akka.actor.ExtendedActorSystem">system</a><span class="delimiter">)</span>

<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="akka.remote.transport.ThrottlerTransportAdapter.type" id="akka.remote.transport.ThrottlerTransportAdapter">ThrottlerTransportAdapter</a> <a href="#akka.remote.transport.ThrottlerTransportAdapter" title="akka.remote.transport.ThrottlerTransportAdapter.type" class="delimiter">{</a>
  <span class="keyword">val</span> <a title="String" id="akka.remote.transport.ThrottlerTransportAdapter.SchemeIdentifier">SchemeIdentifier</a> = <span title="String(&quot;trttl&quot;)" class="string">&quot;trttl&quot;</span>
  <span class="keyword">val</span> <a title="java.util.concurrent.atomic.AtomicInteger" id="akka.remote.transport.ThrottlerTransportAdapter.UniqueId">UniqueId</a> = <span title="java.util.concurrent.atomic.AtomicInteger" class="keyword">new</span> java.util.concurrent.atomic.<span title="java.util.concurrent.atomic.AtomicInteger">AtomicInteger</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

  <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Direction extends AnyRef" id="akka.remote.transport.ThrottlerTransportAdapter;Direction">Direction</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(other: akka.remote.transport.ThrottlerTransportAdapter.Direction)Boolean" id="akka.remote.transport.ThrottlerTransportAdapter;Direction.includes">includes</a><span class="delimiter">(</span><a title="akka.remote.transport.ThrottlerTransportAdapter.Direction" id="akka.remote.transport.ThrottlerTransportAdapter;Direction.includes.other">other</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">Direction</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="akka.remote.transport.ThrottlerTransportAdapter.Direction.type" id="akka.remote.transport.ThrottlerTransportAdapter.Direction">Direction</a> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.type" class="delimiter">{</a>

    @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
    <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.productElement.x$1" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.type" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.readResolve">Send</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">Direction</a> <span class="delimiter">{</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(other: akka.remote.transport.ThrottlerTransportAdapter.Direction)Boolean" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.includes">includes</a><span class="delimiter">(</span><a title="akka.remote.transport.ThrottlerTransportAdapter.Direction" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.includes.other">other</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">Direction</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.includes.other" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">other</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.type">Send</a> ⇒ <span title="Boolean(true)" class="keyword">true</span>
        <span class="keyword">case</span> _    ⇒ <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>

      <span class="comment">/**
       * Java API: get the singleton instance
       */</span>
      <span class="keyword">def</span> <a title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.type" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.getInstance">getInstance</a> = <span class="keyword">this</span>
    <span class="delimiter">}</span>

    @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
    <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.productElement.x$1" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.type" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.readResolve">Receive</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">Direction</a> <span class="delimiter">{</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(other: akka.remote.transport.ThrottlerTransportAdapter.Direction)Boolean" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.includes">includes</a><span class="delimiter">(</span><a title="akka.remote.transport.ThrottlerTransportAdapter.Direction" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.includes.other">other</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">Direction</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.includes.other" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">other</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.type">Receive</a> ⇒ <span title="Boolean(true)" class="keyword">true</span>
        <span class="keyword">case</span> _       ⇒ <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>

      <span class="comment">/**
       * Java API: get the singleton instance
       */</span>
      <span class="keyword">def</span> <a title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.type" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.getInstance">getInstance</a> = <span class="keyword">this</span>
    <span class="delimiter">}</span>

    @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
    <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Both.productElement.x$1" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.Both.type" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Both.readResolve">Both</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">Direction</a> <span class="delimiter">{</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(other: akka.remote.transport.ThrottlerTransportAdapter.Direction)Boolean" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Both.includes">includes</a><span class="delimiter">(</span><a title="akka.remote.transport.ThrottlerTransportAdapter.Direction" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Both.includes.other">other</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">Direction</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>

      <span class="comment">/**
       * Java API: get the singleton instance
       */</span>
      <span class="keyword">def</span> <a title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.Direction.Both.type" id="akka.remote.transport.ThrottlerTransportAdapter.Direction.Both.getInstance">getInstance</a> = <span class="keyword">this</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case class</span> <a title="class SetThrottle extends AnyRef with Product with Serializable" id="akka.remote.transport.ThrottlerTransportAdapter.SetThrottle.readResolve">SetThrottle</a><a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottle.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.remote.transport.ThrottlerTransportAdapter;SetThrottle.address">address</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.remote.transport.ThrottlerTransportAdapter.Direction" id="akka.remote.transport.ThrottlerTransportAdapter;SetThrottle.direction">direction</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">Direction</a>, <a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport.ThrottlerTransportAdapter;SetThrottle.mode">mode</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a><span class="delimiter">)</span>

  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.productElement.x$1" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type" id="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve">SetThrottleAck</a> <span title="Product" class="delimiter">{</span>
    <span class="comment">/**
     * Java API: get the singleton instance
     */</span>
    <span class="keyword">def</span> <a title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type" id="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.getInstance">getInstance</a> = <span class="keyword">this</span>
  <span class="delimiter">}</span>

  <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait ThrottleMode extends AnyRef with akka.actor.NoSerializationVerificationNeeded" id="akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode">ThrottleMode</a> <span class="keyword">extends</span> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;NoSerializationVerificationNeeded" title="akka.actor.NoSerializationVerificationNeeded">NoSerializationVerificationNeeded</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(nanoTimeOfSend: Long, tokens: Int)(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)" id="akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.tryConsumeTokens">tryConsumeTokens</a><span class="delimiter">(</span><a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.tryConsumeTokens.nanoTimeOfSend">nanoTimeOfSend</a>: <span title="Long">Long</span>, <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.tryConsumeTokens.tokens">tokens</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)" class="delimiter">(</span>ThrottleMode, Boolean<span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(currentNanoTime: Long, tokens: Int)scala.concurrent.duration.FiniteDuration" id="akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.timeToAvailable">timeToAvailable</a><span class="delimiter">(</span><a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.timeToAvailable.currentNanoTime">currentNanoTime</a>: <span title="Long">Long</span>, <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.timeToAvailable.tokens">tokens</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span>
  <span class="delimiter">}</span>

  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case class</span> <a title="class TokenBucket extends AnyRef with akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode with Product with Serializable" id="akka.remote.transport.ThrottlerTransportAdapter.TokenBucket.readResolve">TokenBucket</a><a href="#akka.remote.transport.ThrottlerTransportAdapter.TokenBucket.readResolve" title="Product" class="delimiter">(</a><a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.capacity">capacity</a>: <span title="Int">Int</span>, <a title="Double" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tokensPerSecond">tokensPerSecond</a>: <span title="Double">Double</span>, <a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.nanoTimeOfLastSend">nanoTimeOfLastSend</a>: <span title="Long">Long</span>, <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.availableTokens">availableTokens</a>: <span title="Int">Int</span><span class="delimiter">)</span>
    <span class="keyword">extends</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a> <span class="delimiter">{</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(nanoTimeOfSend: Long, tokens: Int)Boolean" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.isAvailable">isAvailable</a><span class="delimiter">(</span><a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.isAvailable.nanoTimeOfSend">nanoTimeOfSend</a>: <span title="Long">Long</span>, <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.isAvailable.tokens">tokens</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
      <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.isAvailable.tokens" title="Int">tokens</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.capacity" title="=&gt; Int">capacity</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.availableTokens" title="=&gt; Int">availableTokens</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Boolean(true)" class="keyword">true</span> <span class="comment">// Allow messages larger than capacity through, it will be recorded as negative tokens</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.availableTokens" title="=&gt; Int">availableTokens</a> <span title="(x: Int)Int">+</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tokensGenerated" title="(nanoTimeOfSend: Long)Int">tokensGenerated</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.isAvailable.nanoTimeOfSend" title="Long">nanoTimeOfSend</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.capacity" title="=&gt; Int">capacity</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&gt;=</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.isAvailable.tokens" title="Int">tokens</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(nanoTimeOfSend: Long, tokens: Int)(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens">tryConsumeTokens</a><span class="delimiter">(</span><a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens.nanoTimeOfSend">nanoTimeOfSend</a>: <span title="Long">Long</span>, <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens.tokens">tokens</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)" class="delimiter">(</span>ThrottleMode, Boolean<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="(akka.remote.transport.ThrottlerTransportAdapter.TokenBucket, Boolean)" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.isAvailable" title="(nanoTimeOfSend: Long, tokens: Int)Boolean">isAvailable</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens.nanoTimeOfSend" title="Long">nanoTimeOfSend</a>, <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens.tokens" title="Int">tokens</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="(_1: akka.remote.transport.ThrottlerTransportAdapter.TokenBucket, _2: Boolean)(akka.remote.transport.ThrottlerTransportAdapter.TokenBucket, Boolean)" class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter.TokenBucket.readResolve" title="TokenBucket.this.type" class="keyword">this</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.capacity" title="Int" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens.x$10">copy</a><span class="delimiter">(</span>
          nanoTimeOfLastSend = <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens.nanoTimeOfSend" title="Long" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens.x$7">nanoTimeOfSend</a>,
          availableTokens = <span title="(x: Int, y: Int)Int">min</span><a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens.x$8" class="delimiter">(</a><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.availableTokens" title="=&gt; Int">availableTokens</a> <span title="(x: Int)Int">-</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens.tokens" title="Int">tokens</a> <span title="(x: Int)Int">+</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tokensGenerated" title="(nanoTimeOfSend: Long)Int">tokensGenerated</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tryConsumeTokens.nanoTimeOfSend" title="Long">nanoTimeOfSend</a><span class="delimiter">)</span>, <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.capacity" title="=&gt; Int">capacity</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="(_1: akka.remote.transport.ThrottlerTransportAdapter.TokenBucket, _2: Boolean)(akka.remote.transport.ThrottlerTransportAdapter.TokenBucket, Boolean)" class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter.TokenBucket.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.TokenBucket" class="keyword">this</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(currentNanoTime: Long, tokens: Int)scala.concurrent.duration.FiniteDuration" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.timeToAvailable">timeToAvailable</a><span class="delimiter">(</span><a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.timeToAvailable.currentNanoTime">currentNanoTime</a>: <span title="Long">Long</span>, <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.timeToAvailable.tokens">tokens</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.timeToAvailable.needed">needed</a> = <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.timeToAvailable.tokens" title="Int">tokens</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.capacity" title="=&gt; Int">capacity</a><span class="delimiter">)</span> <span title="Int(1)" class="int">1</span> <span class="keyword">else</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.timeToAvailable.tokens" title="Int">tokens</a><span class="delimiter">)</span> <span title="(x: Int)Int">-</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tokensGenerated" title="(nanoTimeOfSend: Long)Int">tokensGenerated</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.timeToAvailable.currentNanoTime" title="Long">currentNanoTime</a><span class="delimiter">)</span>
      <span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.timeToAvailable.needed" title="Int">needed</a> <span title="implicit scala.concurrent.duration.package.DurationDouble : (d: Double)concurrent.duration.DurationDouble">/</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tokensPerSecond" title="=&gt; Double">tokensPerSecond</a><span class="delimiter">)</span>.<span title="=&gt; scala.concurrent.duration.FiniteDuration">seconds</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(nanoTimeOfSend: Long)Int" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tokensGenerated">tokensGenerated</a><span class="delimiter">(</span><a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tokensGenerated.nanoTimeOfSend">nanoTimeOfSend</a>: <span title="Long">Long</span><span class="delimiter">)</span>: <span title="Int">Int</span> =
      <span class="delimiter">(</span>TimeUnit.<span title="java.util.concurrent.TimeUnit(NANOSECONDS)">NANOSECONDS</span>.<span title="(x$1: Long)Long">toMillis</span><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tokensGenerated.nanoTimeOfSend" title="Long">nanoTimeOfSend</a> <span title="(x: Long)Long">-</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.nanoTimeOfLastSend" title="=&gt; Long">nanoTimeOfLastSend</a><span class="delimiter">)</span> <span title="(x: Double)Double">*</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;TokenBucket.tokensPerSecond" title="=&gt; Double">tokensPerSecond</a> <span title="(x: Double)Double">/</span> <span title="Double(1000.0)" class="double">1000.0</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>
  <span class="delimiter">}</span>

  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.productElement.x$1" title="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.type" id="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.readResolve">Unthrottled</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(nanoTimeOfSend: Long, tokens: Int)(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)" id="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.tryConsumeTokens">tryConsumeTokens</a><span class="delimiter">(</span><a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.tryConsumeTokens.nanoTimeOfSend">nanoTimeOfSend</a>: <span title="Long">Long</span>, <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.tryConsumeTokens.tokens">tokens</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)" class="delimiter">(</span>ThrottleMode, Boolean<span class="delimiter">)</span> = <span title="(_1: akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.type, _2: Boolean)(akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.type, Boolean)" class="delimiter">(</span><span class="keyword">this</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(currentNanoTime: Long, tokens: Int)scala.concurrent.duration.FiniteDuration" id="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.timeToAvailable">timeToAvailable</a><span class="delimiter">(</span><a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.timeToAvailable.currentNanoTime">currentNanoTime</a>: <span title="Long">Long</span>, <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.timeToAvailable.tokens">tokens</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span> = <span title="scala.concurrent.duration.Duration.type">Duration</span>.<span title="=&gt; scala.concurrent.duration.FiniteDuration">Zero</span>

    <span class="comment">/**
     * Java API: get the singleton instance
     */</span>
    <span class="keyword">def</span> <a title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.type" id="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.getInstance">getInstance</a> = <span class="keyword">this</span>

  <span class="delimiter">}</span>

  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Blackhole.productElement.x$1" title="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.type" id="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.readResolve">Blackhole</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(nanoTimeOfSend: Long, tokens: Int)(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)" id="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.tryConsumeTokens">tryConsumeTokens</a><span class="delimiter">(</span><a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.tryConsumeTokens.nanoTimeOfSend">nanoTimeOfSend</a>: <span title="Long">Long</span>, <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.tryConsumeTokens.tokens">tokens</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)" class="delimiter">(</span>ThrottleMode, Boolean<span class="delimiter">)</span> = <span title="(_1: akka.remote.transport.ThrottlerTransportAdapter.Blackhole.type, _2: Boolean)(akka.remote.transport.ThrottlerTransportAdapter.Blackhole.type, Boolean)" class="delimiter">(</span><span class="keyword">this</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(currentNanoTime: Long, tokens: Int)scala.concurrent.duration.FiniteDuration" id="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.timeToAvailable">timeToAvailable</a><span class="delimiter">(</span><a title="Long" id="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.timeToAvailable.currentNanoTime">currentNanoTime</a>: <span title="Long">Long</span>, <a title="Int" id="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.timeToAvailable.tokens">tokens</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span> = <span title="scala.concurrent.duration.Duration.type">Duration</span>.<span title="=&gt; scala.concurrent.duration.FiniteDuration">Zero</span>

    <span class="comment">/**
     * Java API: get the singleton instance
     */</span>
    <span class="keyword">def</span> <a title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.Blackhole.type" id="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.getInstance">getInstance</a> = <span class="keyword">this</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Management Command to force dissocation of an address.
   */</span>
  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case class</span> <a title="class ForceDisassociate extends AnyRef with Product with Serializable" id="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociate.readResolve">ForceDisassociate</a><a href="#akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociate.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.remote.transport.ThrottlerTransportAdapter;ForceDisassociate.address">address</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Management Command to force dissocation of an address with an explicit error.
   */</span>
  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case class</span> <a title="class ForceDisassociateExplicitly extends AnyRef with Product with Serializable" id="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateExplicitly.readResolve">ForceDisassociateExplicitly</a><a href="#akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateExplicitly.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.remote.transport.ThrottlerTransportAdapter;ForceDisassociateExplicitly.address">address</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.remote.transport.AssociationHandle.DisassociateInfo" id="akka.remote.transport.ThrottlerTransportAdapter;ForceDisassociateExplicitly.reason">reason</a>: <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;DisassociateInfo" title="akka.remote.transport.AssociationHandle.DisassociateInfo">DisassociateInfo</a><span class="delimiter">)</span>

  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.productElement.x$1" title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.type" id="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.readResolve">ForceDisassociateAck</a> <span title="Product" class="delimiter">{</span>
    <span class="comment">/**
     * Java API: get the singleton instance
     */</span>
    <span class="keyword">def</span> <a title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.type" id="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.getInstance">getInstance</a> = <span class="keyword">this</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">class</span> <a title="class ThrottlerTransportAdapter extends akka.remote.transport.ActorTransportAdapter" id="akka.remote.transport;ThrottlerTransportAdapter">ThrottlerTransportAdapter</a><a href="#akka.remote.transport;ThrottlerTransportAdapter" title="akka.remote.transport.ThrottlerTransportAdapter" class="delimiter">(</a><a title="akka.remote.transport.Transport" id="akka.remote.transport;ThrottlerTransportAdapter._wrappedTransport">_wrappedTransport</a>: <a href="Transport.scala.html#akka.remote.transport;Transport" title="akka.remote.transport.Transport">Transport</a>, <a title="akka.actor.ExtendedActorSystem" id="akka.remote.transport;ThrottlerTransportAdapter._system">_system</a>: <a href="../../../akka-actor/actor/ActorSystem.scala.html#akka.actor;ExtendedActorSystem" title="akka.actor.ExtendedActorSystem">ExtendedActorSystem</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;ActorTransportAdapter" title="akka.remote.transport.ActorTransportAdapter">ActorTransportAdapter</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerTransportAdapter._wrappedTransport" title="akka.remote.transport.Transport">_wrappedTransport</a>, <a href="#akka.remote.transport;ThrottlerTransportAdapter._system" title="akka.actor.ExtendedActorSystem">_system</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; String" id="akka.remote.transport;ThrottlerTransportAdapter.addedSchemeIdentifier">addedSchemeIdentifier</a> = <a href="#akka.remote.transport.ThrottlerTransportAdapter.SchemeIdentifier" title="=&gt; String">SchemeIdentifier</a>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Int" id="akka.remote.transport;ThrottlerTransportAdapter.maximumOverhead">maximumOverhead</a> = <span title="Int(0)" class="int">0</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; String" id="akka.remote.transport;ThrottlerTransportAdapter.managerName">managerName</a>: <span title="String">String</span> = <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;throttlermanager.&quot;)">throttlermanager.$</span><span class="delimiter">{</span><a href="AbstractTransportAdapter.scala.html#akka.remote.transport;AbstractTransportAdapter.wrappedTransport" title="=&gt; akka.remote.transport.Transport">wrappedTransport</a>.<a href="Transport.scala.html#akka.remote.transport;Transport.schemeIdentifier" title="=&gt; String">schemeIdentifier</a><span class="delimiter">}</span><span title="String(&quot;&quot;)">$</span><span class="delimiter">{</span><a href="#akka.remote.transport.ThrottlerTransportAdapter.UniqueId" title="=&gt; java.util.concurrent.atomic.AtomicInteger">UniqueId</a>.<span title="()Int">getAndIncrement</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; akka.actor.Props" id="akka.remote.transport;ThrottlerTransportAdapter.managerProps">managerProps</a>: <a href="../../../akka-actor/actor/Props.scala.html#akka.actor;Props" title="akka.actor.Props">Props</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="akka.remote.transport.Transport" id="akka.remote.transport;ThrottlerTransportAdapter.managerProps.wt">wt</a> = <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;AbstractTransportAdapter.wrappedTransport" title="=&gt; akka.remote.transport.Transport">wrappedTransport</a>
    <a href="../../../akka-actor/actor/Props.scala.html#akka.actor.Props.apply(0870a176b3)" title="(clazz: Class[_], args: Any*)akka.actor.Props">Props</a><span class="delimiter">(</span>classOf<span title="Class[akka.remote.transport.ThrottlerManager](classOf[akka.remote.transport.ThrottlerManager])" class="delimiter">[</span>ThrottlerManager<span class="delimiter">]</span>, <a href="#akka.remote.transport;ThrottlerTransportAdapter.managerProps.wt" title="akka.remote.transport.Transport">wt</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(cmd: Any)scala.concurrent.Future[Boolean]" id="akka.remote.transport;ThrottlerTransportAdapter.managementCommand">managementCommand</a><span class="delimiter">(</span><a title="Any" id="akka.remote.transport;ThrottlerTransportAdapter.managementCommand.cmd">cmd</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="scala.concurrent.Future[Boolean]">Future</span><span class="delimiter">[</span>Boolean<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="AbstractTransportAdapter.scala.html#akka.remote.transport.ActorTransportAdapter" title="akka.remote.transport.ActorTransportAdapter.type">ActorTransportAdapter</a>.AskTimeout
    <a href="#akka.remote.transport;ThrottlerTransportAdapter.managementCommand.cmd" title="Any">cmd</a> <span title="scala.concurrent.Future[Boolean]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottle" id="akka.remote.transport;ThrottlerTransportAdapter.managementCommand.s">s</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottle.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottle">SetThrottle</a>                 ⇒ <a href="../../../akka-actor/pattern/AskSupport.scala.html#akka.pattern;AskSupport.ask(13940b1e32)" title="implicit akka.pattern.AskSupport.ask : (actorRef: akka.actor.ActorRef)akka.pattern.AskableActorRef">manager</a> <a href="../../../akka-actor/pattern/AskSupport.scala.html#akka.pattern;AskableActorRef.?" title="(message: Any)(implicit timeout: akka.util.Timeout)scala.concurrent.Future[Any]">?</a> <a href="#akka.remote.transport;ThrottlerTransportAdapter.managementCommand.s" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottle">s</a> <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;AbstractTransportAdapter.ec" title="(f: Any =&gt; Boolean)(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[Boolean]">map</a> <a href="#akka.remote.transport;ThrottlerTransportAdapter.managementCommand.$anonfun.x0$1" title="Boolean" class="delimiter">{</a> <span class="keyword">case</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a> ⇒ <span title="Boolean(true)" class="keyword">true</span> <span class="delimiter">}</span>
      <span class="keyword">case</span> <span title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociate">f</span>: <a href="#akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociate.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociate">ForceDisassociate</a>           ⇒ <a href="../../../akka-actor/pattern/AskSupport.scala.html#akka.pattern;AskSupport.ask(13940b1e32)" title="implicit akka.pattern.AskSupport.ask : (actorRef: akka.actor.ActorRef)akka.pattern.AskableActorRef">manager</a> <a href="../../../akka-actor/pattern/AskSupport.scala.html#akka.pattern;AskableActorRef.?" title="(message: Any)(implicit timeout: akka.util.Timeout)scala.concurrent.Future[Any]">?</a> <span title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociate">f</span> <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;AbstractTransportAdapter.ec" title="(f: Any =&gt; Boolean)(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[Boolean]">map</a> <a href="#akka.remote.transport;ThrottlerTransportAdapter.managementCommand.$anonfun.x0$2" title="Boolean" class="delimiter">{</a> <span class="keyword">case</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.type">ForceDisassociateAck</a> ⇒ <span title="Boolean(true)" class="keyword">true</span> <span class="delimiter">}</span>
      <span class="keyword">case</span> <span title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateExplicitly">f</span>: <a href="#akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateExplicitly.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateExplicitly">ForceDisassociateExplicitly</a> ⇒ <a href="../../../akka-actor/pattern/AskSupport.scala.html#akka.pattern;AskSupport.ask(13940b1e32)" title="implicit akka.pattern.AskSupport.ask : (actorRef: akka.actor.ActorRef)akka.pattern.AskableActorRef">manager</a> <a href="../../../akka-actor/pattern/AskSupport.scala.html#akka.pattern;AskableActorRef.?" title="(message: Any)(implicit timeout: akka.util.Timeout)scala.concurrent.Future[Any]">?</a> <span title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateExplicitly">f</span> <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;AbstractTransportAdapter.ec" title="(f: Any =&gt; Boolean)(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[Boolean]">map</a> <a href="#akka.remote.transport;ThrottlerTransportAdapter.managementCommand.$anonfun.x0$3" title="Boolean" class="delimiter">{</a> <span class="keyword">case</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.type">ForceDisassociateAck</a> ⇒ <span title="Boolean(true)" class="keyword">true</span> <span class="delimiter">}</span>
      <span class="keyword">case</span> _                              ⇒ <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;AbstractTransportAdapter.wrappedTransport" title="=&gt; akka.remote.transport.Transport">wrappedTransport</a>.<a href="Transport.scala.html#akka.remote.transport;Transport.managementCommand" title="(cmd: Any)scala.concurrent.Future[Boolean]">managementCommand</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerTransportAdapter.managementCommand.cmd" title="Any">cmd</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>transport<span class="delimiter">]</span> <span class="keyword">object</span> <a title="akka.remote.transport.ThrottlerManager.type" id="akka.remote.transport.ThrottlerManager">ThrottlerManager</a> <a href="#akka.remote.transport.ThrottlerManager" title="akka.remote.transport.ThrottlerManager.type" class="delimiter">{</a>
  <span class="keyword">case class</span> <a title="class Checkin extends AnyRef with akka.actor.NoSerializationVerificationNeeded with Product with Serializable" id="akka.remote.transport.ThrottlerManager.Checkin.readResolve">Checkin</a><a href="#akka.remote.transport.ThrottlerManager.Checkin.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.Address" id="akka.remote.transport.ThrottlerManager;Checkin.origin">origin</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.remote.transport.ThrottlerHandle" id="akka.remote.transport.ThrottlerManager;Checkin.handle">handle</a>: <a href="#akka.remote.transport.ThrottlerHandle.readResolve" title="akka.remote.transport.ThrottlerHandle">ThrottlerHandle</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;NoSerializationVerificationNeeded" title="akka.actor.NoSerializationVerificationNeeded">NoSerializationVerificationNeeded</a>

  <span class="keyword">case class</span> <a title="class AssociateResult extends AnyRef with akka.actor.NoSerializationVerificationNeeded with Product with Serializable" id="akka.remote.transport.ThrottlerManager.AssociateResult.readResolve">AssociateResult</a><a href="#akka.remote.transport.ThrottlerManager.AssociateResult.readResolve" title="Product" class="delimiter">(</a><a title="akka.remote.transport.AssociationHandle" id="akka.remote.transport.ThrottlerManager;AssociateResult.handle">handle</a>: <a href="Transport.scala.html#akka.remote.transport;AssociationHandle" title="akka.remote.transport.AssociationHandle">AssociationHandle</a>, <a title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle]" id="akka.remote.transport.ThrottlerManager;AssociateResult.statusPromise">statusPromise</a>: <span title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle]">Promise</span><span class="delimiter">[</span>AssociationHandle<span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="keyword">extends</span> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;NoSerializationVerificationNeeded" title="akka.actor.NoSerializationVerificationNeeded">NoSerializationVerificationNeeded</a>

  <span class="keyword">case class</span> <a title="class ListenerAndMode extends AnyRef with akka.actor.NoSerializationVerificationNeeded with Product with Serializable" id="akka.remote.transport.ThrottlerManager.ListenerAndMode.readResolve">ListenerAndMode</a><a href="#akka.remote.transport.ThrottlerManager.ListenerAndMode.readResolve" title="Product" class="delimiter">(</a><a title="akka.remote.transport.AssociationHandle.HandleEventListener" id="akka.remote.transport.ThrottlerManager;ListenerAndMode.listener">listener</a>: <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;HandleEventListener" title="akka.remote.transport.AssociationHandle.HandleEventListener">HandleEventListener</a>, <a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport.ThrottlerManager;ListenerAndMode.mode">mode</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;NoSerializationVerificationNeeded" title="akka.actor.NoSerializationVerificationNeeded">NoSerializationVerificationNeeded</a>

  <span class="keyword">case class</span> <a title="class Handle extends AnyRef with akka.actor.NoSerializationVerificationNeeded with Product with Serializable" id="akka.remote.transport.ThrottlerManager.Handle.readResolve">Handle</a><a href="#akka.remote.transport.ThrottlerManager.Handle.readResolve" title="Product" class="delimiter">(</a><a title="akka.remote.transport.ThrottlerHandle" id="akka.remote.transport.ThrottlerManager;Handle.handle">handle</a>: <a href="#akka.remote.transport.ThrottlerHandle.readResolve" title="akka.remote.transport.ThrottlerHandle">ThrottlerHandle</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;NoSerializationVerificationNeeded" title="akka.actor.NoSerializationVerificationNeeded">NoSerializationVerificationNeeded</a>

  <span class="keyword">case class</span> <a title="class Listener extends AnyRef with akka.actor.NoSerializationVerificationNeeded with Product with Serializable" id="akka.remote.transport.ThrottlerManager.Listener.readResolve">Listener</a><a href="#akka.remote.transport.ThrottlerManager.Listener.readResolve" title="Product" class="delimiter">(</a><a title="akka.remote.transport.AssociationHandle.HandleEventListener" id="akka.remote.transport.ThrottlerManager;Listener.listener">listener</a>: <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;HandleEventListener" title="akka.remote.transport.AssociationHandle.HandleEventListener">HandleEventListener</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;NoSerializationVerificationNeeded" title="akka.actor.NoSerializationVerificationNeeded">NoSerializationVerificationNeeded</a>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
<span title="AnyRef" class="keyword">private</span><span class="delimiter">[</span>transport<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class ThrottlerManager extends akka.remote.transport.ActorTransportAdapterManager" id="akka.remote.transport;ThrottlerManager">ThrottlerManager</a><a href="#akka.remote.transport;ThrottlerManager" title="akka.remote.transport.ThrottlerManager" class="delimiter">(</a><a title="akka.remote.transport.Transport" id="akka.remote.transport;ThrottlerManager.wrappedTransport">wrappedTransport</a>: <a href="Transport.scala.html#akka.remote.transport;Transport" title="akka.remote.transport.Transport">Transport</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;ActorTransportAdapterManager" title="akka.remote.transport.ActorTransportAdapterManager">ActorTransportAdapterManager</a> <span class="delimiter">{</span>

  <span class="keyword">import</span> <a href="#akka.remote.transport.ThrottlerManager" title="akka.remote.transport.ThrottlerManager.type">ThrottlerManager</a>._
  <span class="keyword">import</span> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.dispatcher

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="scala.collection.immutable.Map[akka.actor.Address,(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)]" id="akka.remote.transport;ThrottlerManager.throttlingModes_=">throttlingModes</a> = <span title="[A, B](elems: (A, B)*)scala.collection.immutable.Map[A,B]">Map</span><span title="(elems: (akka.actor.Address, (akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction))*)scala.collection.immutable.Map[akka.actor.Address,(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)]" class="delimiter">[</span><a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <span title="(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)" class="delimiter">(</span>ThrottleMode, Direction<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="List[(akka.actor.Address, akka.remote.transport.ThrottlerHandle)]" id="akka.remote.transport;ThrottlerManager.handleTable_=">handleTable</a> = List<span class="delimiter">[</span><span class="delimiter">(</span>Address, ThrottlerHandle<span class="delimiter">)</span><span class="delimiter">]</span><span title="scala.collection.immutable.Nil.type" class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(address: akka.actor.Address)akka.actor.Address" id="akka.remote.transport;ThrottlerManager.nakedAddress">nakedAddress</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;ThrottlerManager.nakedAddress.address">address</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a> = <a href="#akka.remote.transport;ThrottlerManager.nakedAddress.address" title="akka.actor.Address">address</a>.<a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address.copy" title="(protocol: String, system: String, host: Option[String], port: Option[Int])akka.actor.Address">copy</a><span class="delimiter">(</span>protocol = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>, system = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; ThrottlerManager.this.Receive" id="akka.remote.transport;ThrottlerManager.ready">ready</a>: <span title="ThrottlerManager.this.Receive">Receive</span> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    <span class="keyword">case</span> InboundAssociation<span class="delimiter">(</span><span title="akka.remote.transport.AssociationHandle">handle</span><span class="delimiter">)</span> ⇒
      <span class="keyword">val</span> <span title="akka.remote.transport.ThrottlerHandle">wrappedHandle</span> = <a href="#akka.remote.transport;ThrottlerManager.wrapHandle" title="(originalHandle: akka.remote.transport.AssociationHandle, listener: akka.remote.transport.Transport.AssociationEventListener, inbound: Boolean)akka.remote.transport.ThrottlerHandle">wrapHandle</a><span class="delimiter">(</span><span title="akka.remote.transport.AssociationHandle">handle</span>, <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;ActorTransportAdapterManager.associationListener" title="=&gt; akka.remote.transport.Transport.AssociationEventListener">associationListener</a>, inbound = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
      <span title="akka.remote.transport.ThrottlerHandle">wrappedHandle</span>.<a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">throttlerActor</a> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottlerManager.Handle.readResolve" title="(handle: akka.remote.transport.ThrottlerHandle)akka.remote.transport.ThrottlerManager.Handle">Handle</a><span class="delimiter">(</span><span title="akka.remote.transport.ThrottlerHandle">wrappedHandle</span><span class="delimiter">)</span>
    <span class="keyword">case</span> AssociateUnderlying<span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.remoteAddress">remoteAddress</a>, <span title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle]">statusPromise</span><span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottlerManager.wrappedTransport" title="akka.remote.transport.Transport">wrappedTransport</a>.<a href="Transport.scala.html#akka.remote.transport;Transport.associate" title="(remoteAddress: akka.actor.Address)scala.concurrent.Future[akka.remote.transport.AssociationHandle]">associate</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.remoteAddress" title="akka.actor.Address">remoteAddress</a><span class="delimiter">)</span> <a href="../../../akka-actor/actor/ActorCell.scala.html#akka.actor;ActorContext.dispatcher" title="(func: scala.util.Try[akka.remote.transport.AssociationHandle] =&gt; Any)(implicit executor: scala.concurrent.ExecutionContext)Unit">onComplete</a> <a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.$anonfun.x0$4" title="Any" class="delimiter">{</a>
        <span class="comment">// Slight modification of pipe, only success is sent, failure is propagated to a separate future</span>
        <span class="keyword">case</span> Success<span class="delimiter">(</span><span title="akka.remote.transport.AssociationHandle">handle</span><span class="delimiter">)</span> ⇒ <a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottlerManager.AssociateResult.readResolve" title="(handle: akka.remote.transport.AssociationHandle, statusPromise: scala.concurrent.Promise[akka.remote.transport.AssociationHandle])akka.remote.transport.ThrottlerManager.AssociateResult">AssociateResult</a><span class="delimiter">(</span><span title="akka.remote.transport.AssociationHandle">handle</span>, <span title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle]">statusPromise</span><span class="delimiter">)</span>
        <span class="keyword">case</span> Failure<span class="delimiter">(</span><a title="Throwable" id="akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.$anonfun.e">e</a><span class="delimiter">)</span>      ⇒ <span title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle]">statusPromise</span>.<span title="(t: Throwable)statusPromise.type">failure</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.$anonfun.e" title="Throwable">e</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="comment">// Finished outbound association and got back the handle</span>
    <span class="keyword">case</span> AssociateResult<span class="delimiter">(</span><span title="akka.remote.transport.AssociationHandle">handle</span>, <span title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle]">statusPromise</span><span class="delimiter">)</span> ⇒
      <span class="keyword">val</span> <span title="akka.remote.transport.ThrottlerHandle">wrappedHandle</span> = <a href="#akka.remote.transport;ThrottlerManager.wrapHandle" title="(originalHandle: akka.remote.transport.AssociationHandle, listener: akka.remote.transport.Transport.AssociationEventListener, inbound: Boolean)akka.remote.transport.ThrottlerHandle">wrapHandle</a><span class="delimiter">(</span><span title="akka.remote.transport.AssociationHandle">handle</span>, <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;ActorTransportAdapterManager.associationListener" title="=&gt; akka.remote.transport.Transport.AssociationEventListener">associationListener</a>, inbound = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <span title="akka.actor.Address">naked</span> = <a href="#akka.remote.transport;ThrottlerManager.nakedAddress" title="(address: akka.actor.Address)akka.actor.Address">nakedAddress</a><span class="delimiter">(</span><span title="akka.remote.transport.AssociationHandle">handle</span>.<a href="Transport.scala.html#akka.remote.transport;AssociationHandle.remoteAddress" title="=&gt; akka.actor.Address">remoteAddress</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.inMode">inMode</a> = <a href="#akka.remote.transport;ThrottlerManager.getInboundMode" title="(nakedAddress: akka.actor.Address)akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">getInboundMode</a><span class="delimiter">(</span><span title="akka.actor.Address">naked</span><span class="delimiter">)</span>
      <span title="akka.remote.transport.ThrottlerHandle">wrappedHandle</span>.<a href="#akka.remote.transport;ThrottlerHandle.outboundThrottleMode" title="=&gt; java.util.concurrent.atomic.AtomicReference[akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode]">outboundThrottleMode</a>.<span title="(x$1: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Unit">set</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.getOutboundMode" title="(nakedAddress: akka.actor.Address)akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">getOutboundMode</a><span class="delimiter">(</span><span title="akka.actor.Address">naked</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="akka.remote.transport.ThrottlerHandle">wrappedHandle</span>.<a href="#akka.remote.transport;ThrottlerHandle.readHandlerPromise" title="=&gt; scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">readHandlerPromise</a>.<span title="=&gt; scala.concurrent.Future[akka.remote.transport.AssociationHandle.HandleEventListener]">future</span> <a href="../../../akka-actor/pattern/PipeToSupport.scala.html#akka.pattern;PipeToSupport.pipe" title="(future: scala.concurrent.Future[akka.remote.transport.ThrottlerManager.ListenerAndMode])(implicit executionContext: scala.concurrent.ExecutionContext)akka.pattern.PipeableFuture[akka.remote.transport.ThrottlerManager.ListenerAndMode]">map</a> <span class="delimiter">{</span> <a href="#akka.remote.transport.ThrottlerManager.ListenerAndMode.readResolve" title="(listener: akka.remote.transport.AssociationHandle.HandleEventListener, mode: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)akka.remote.transport.ThrottlerManager.ListenerAndMode">ListenerAndMode</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.$anonfun.x$1" title="akka.remote.transport.AssociationHandle.HandleEventListener">_</a>, <a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.inMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">inMode</a><span class="delimiter">)</span> <span class="delimiter">}</span> <a href="../../../akka-actor/pattern/PipeToSupport.scala.html#akka.pattern;PipeToSupport;PipeableFuture.pipeTo" title="(recipient: akka.actor.ActorRef)(implicit sender: akka.actor.ActorRef)scala.concurrent.Future[akka.remote.transport.ThrottlerManager.ListenerAndMode]">pipeTo</a> <span title="akka.remote.transport.ThrottlerHandle">wrappedHandle</span>.<a href="#akka.remote.transport;ThrottlerHandle.throttlerActor" title="=&gt; akka.actor.ActorRef">throttlerActor</a>
      <a href="#akka.remote.transport;ThrottlerManager.handleTable_=" title="(x$1: List[(akka.actor.Address, akka.remote.transport.ThrottlerHandle)])Unit">handleTable</a> <span title="(x: (akka.actor.Address, akka.remote.transport.ThrottlerHandle))List[(akka.actor.Address, akka.remote.transport.ThrottlerHandle)]">::=</span> <span title="(x: akka.actor.Address)ArrowAssoc[akka.actor.Address]">naked</span> <span title="(y: akka.remote.transport.ThrottlerHandle)(akka.actor.Address, akka.remote.transport.ThrottlerHandle)">-&gt;</span> <span title="akka.remote.transport.ThrottlerHandle">wrappedHandle</span>
      <span title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle]">statusPromise</span>.<span title="(v: akka.remote.transport.AssociationHandle)statusPromise.type">success</span><span title="Unit" class="delimiter">(</span><span title="akka.remote.transport.ThrottlerHandle">wrappedHandle</span><span class="delimiter">)</span>
    <span class="keyword">case</span> SetThrottle<span class="delimiter">(</span><span title="akka.actor.Address">address</span>, <a title="akka.remote.transport.ThrottlerTransportAdapter.Direction" id="akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.direction">direction</a>, <a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.mode">mode</a><span class="delimiter">)</span> ⇒
      <span class="keyword">val</span> <span title="akka.actor.Address">naked</span> = <a href="#akka.remote.transport;ThrottlerManager.nakedAddress" title="(address: akka.actor.Address)akka.actor.Address">nakedAddress</a><span class="delimiter">(</span><span title="akka.actor.Address">address</span><span class="delimiter">)</span>
      <a href="#akka.remote.transport;ThrottlerManager.throttlingModes_=" title="(x$1: scala.collection.immutable.Map[akka.actor.Address,(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)])Unit">throttlingModes</a> = <a href="#akka.remote.transport;ThrottlerManager.throttlingModes_=" title="=&gt; scala.collection.immutable.Map[akka.actor.Address,(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)]">throttlingModes</a>.<span title="(key: akka.actor.Address, value: (akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction))scala.collection.immutable.Map[akka.actor.Address,(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)]">updated</span><span class="delimiter">(</span><span title="akka.actor.Address">naked</span>, <span title="(_1: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, _2: akka.remote.transport.ThrottlerTransportAdapter.Direction)(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)" class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.mode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</a>, <a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">direction</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]" id="akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.ok">ok</a> = <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">successful</span><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a><span class="delimiter">)</span>
      <span title="scala.concurrent.Future.type">Future</span>.<span title="(in: List[scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]])(implicit cbf: scala.collection.generic.CanBuildFrom[List[scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]],akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type,List[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]], implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[List[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]]">sequence</span><a href="../../../akka-actor/actor/ActorCell.scala.html#akka.actor;ActorContext.dispatcher" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type,List[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]]" class="delimiter">(</a><a href="#akka.remote.transport;ThrottlerManager.handleTable_=" title="=&gt; List[(akka.actor.Address, akka.remote.transport.ThrottlerHandle)]">handleTable</a> <span title="(f: ((akka.actor.Address, akka.remote.transport.ThrottlerHandle)) =&gt; scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type])(implicit bf: scala.collection.generic.CanBuildFrom[List[(akka.actor.Address, akka.remote.transport.ThrottlerHandle)],scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type],List[scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]]])List[scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]]">map</span> <a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.$anonfun.x0$5" title="scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]" class="delimiter">{</a>
        <span class="keyword">case</span> <span class="delimiter">(</span><span title="akka.actor.Address">`naked`</span>, <span title="akka.remote.transport.ThrottlerHandle">handle</span><span class="delimiter">)</span> ⇒ <a href="#akka.remote.transport;ThrottlerManager.setMode(1ba03e051e)" title="(handle: akka.remote.transport.ThrottlerHandle, mode: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, direction: akka.remote.transport.ThrottlerTransportAdapter.Direction)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">setMode</a><span class="delimiter">(</span><span title="akka.remote.transport.ThrottlerHandle">handle</span>, <a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.mode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</a>, <a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">direction</a><span class="delimiter">)</span>
        <span class="keyword">case</span> _                 ⇒ <a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.ok" title="scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">ok</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="(f: List[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type] =&gt; akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type)(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">map</span><a href="../../../akka-actor/pattern/PipeToSupport.scala.html#akka.pattern;PipeToSupport.pipe" title="(future: scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type])(implicit executionContext: scala.concurrent.ExecutionContext)akka.pattern.PipeableFuture[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]" class="delimiter">(</a><a title="List[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]" id="akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.$anonfun.x$2">_</a> ⇒ <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a><span class="delimiter">)</span> <a href="../../../akka-actor/pattern/PipeToSupport.scala.html#akka.pattern;PipeToSupport;PipeableFuture.pipeTo" title="(recipient: akka.actor.ActorRef)(implicit sender: akka.actor.ActorRef)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">pipeTo</a> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.sender" title="()akka.actor.ActorRef">sender</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> ForceDisassociate<span class="delimiter">(</span><span title="akka.actor.Address">address</span><span class="delimiter">)</span> ⇒
      <span class="keyword">val</span> <span title="akka.actor.Address">naked</span> = <a href="#akka.remote.transport;ThrottlerManager.nakedAddress" title="(address: akka.actor.Address)akka.actor.Address">nakedAddress</a><span class="delimiter">(</span><span title="akka.actor.Address">address</span><span class="delimiter">)</span>
      <a href="#akka.remote.transport;ThrottlerManager.handleTable_=" title="=&gt; List[(akka.actor.Address, akka.remote.transport.ThrottlerHandle)]">handleTable</a> <span title="(f: ((akka.actor.Address, akka.remote.transport.ThrottlerHandle)) =&gt; Unit)Unit">foreach</span> <a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.$anonfun.x0$6" title="Unit" class="delimiter">{</a>
        <span class="keyword">case</span> <span class="delimiter">(</span><span title="akka.actor.Address">`naked`</span>, <span title="akka.remote.transport.ThrottlerHandle">handle</span><span class="delimiter">)</span> ⇒ <span title="akka.remote.transport.ThrottlerHandle">handle</span>.<a href="#akka.remote.transport;ThrottlerHandle.disassociate" title="()Unit">disassociate</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">case</span> _                 ⇒
      <span class="delimiter">}</span>
      <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.sender" title="()akka.actor.ActorRef">sender</a><a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef" class="delimiter">(</a><span class="delimiter">)</span> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.type">ForceDisassociateAck</a>
    <span class="keyword">case</span> ForceDisassociateExplicitly<span class="delimiter">(</span><span title="akka.actor.Address">address</span>, <a title="akka.remote.transport.AssociationHandle.DisassociateInfo" id="akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.reason">reason</a><span class="delimiter">)</span> ⇒
      <span class="keyword">val</span> <span title="akka.actor.Address">naked</span> = <a href="#akka.remote.transport;ThrottlerManager.nakedAddress" title="(address: akka.actor.Address)akka.actor.Address">nakedAddress</a><span class="delimiter">(</span><span title="akka.actor.Address">address</span><span class="delimiter">)</span>
      <a href="#akka.remote.transport;ThrottlerManager.handleTable_=" title="=&gt; List[(akka.actor.Address, akka.remote.transport.ThrottlerHandle)]">handleTable</a> <span title="(f: ((akka.actor.Address, akka.remote.transport.ThrottlerHandle)) =&gt; Unit)Unit">foreach</span> <a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.applyOrElse.$anonfun.x0$7" title="Unit" class="delimiter">{</a>
        <span class="keyword">case</span> <span class="delimiter">(</span><span title="akka.actor.Address">`naked`</span>, <span title="akka.remote.transport.ThrottlerHandle">handle</span><span class="delimiter">)</span> ⇒ <span title="akka.remote.transport.ThrottlerHandle">handle</span>.<a href="#akka.remote.transport;ThrottlerHandle.disassociateWithFailure" title="(reason: akka.remote.transport.AssociationHandle.DisassociateInfo)Unit">disassociateWithFailure</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.reason" title="akka.remote.transport.AssociationHandle.DisassociateInfo">reason</a><span class="delimiter">)</span>
        <span class="keyword">case</span> _                 ⇒
      <span class="delimiter">}</span>
      <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.sender" title="()akka.actor.ActorRef">sender</a><a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef" class="delimiter">(</a><span class="delimiter">)</span> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.ForceDisassociateAck.type">ForceDisassociateAck</a>

    <span class="keyword">case</span> Checkin<span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.origin">origin</a>, <span title="akka.remote.transport.ThrottlerHandle">handle</span><span class="delimiter">)</span> ⇒
      <span class="keyword">val</span> <span title="akka.actor.Address">naked</span>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a> = <a href="#akka.remote.transport;ThrottlerManager.nakedAddress" title="(address: akka.actor.Address)akka.actor.Address">nakedAddress</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.ready;$anonfun.isDefinedAt.origin" title="akka.actor.Address">origin</a><span class="delimiter">)</span>
      <a href="#akka.remote.transport;ThrottlerManager.handleTable_=" title="(x$1: List[(akka.actor.Address, akka.remote.transport.ThrottlerHandle)])Unit">handleTable</a> <span title="(x: (akka.actor.Address, akka.remote.transport.ThrottlerHandle))List[(akka.actor.Address, akka.remote.transport.ThrottlerHandle)]">::=</span> <span title="(x: akka.actor.Address)ArrowAssoc[akka.actor.Address]">naked</span> <span title="(y: akka.remote.transport.ThrottlerHandle)(akka.actor.Address, akka.remote.transport.ThrottlerHandle)">-&gt;</span> <span title="akka.remote.transport.ThrottlerHandle">handle</span>
      <a href="#akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c)" title="(nakedAddress: akka.actor.Address, handle: akka.remote.transport.ThrottlerHandle)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">setMode</a><span title="Unit" class="delimiter">(</span><span title="akka.actor.Address">naked</span>, <span title="akka.remote.transport.ThrottlerHandle">handle</span><span class="delimiter">)</span>

  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(nakedAddress: akka.actor.Address)akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerManager.getInboundMode">getInboundMode</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;ThrottlerManager.getInboundMode.nakedAddress">nakedAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a> = <span class="delimiter">{</span>
    <a href="#akka.remote.transport;ThrottlerManager.throttlingModes_=" title="=&gt; scala.collection.immutable.Map[akka.actor.Address,(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)]">throttlingModes</a>.<span title="(key: akka.actor.Address)Option[(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)]">get</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.getInboundMode.nakedAddress" title="akka.actor.Address">nakedAddress</a><span class="delimiter">)</span> <span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><span class="delimiter">(</span><a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerManager.getInboundMode.mode">mode</a>, <a title="akka.remote.transport.ThrottlerTransportAdapter.Direction" id="akka.remote.transport;ThrottlerManager.getInboundMode.direction">direction</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#akka.remote.transport;ThrottlerManager.getInboundMode.direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">direction</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction.includes" title="(other: akka.remote.transport.ThrottlerTransportAdapter.Direction)Boolean">includes</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.type">Direction</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.type">Receive</a><span class="delimiter">)</span> ⇒ <a href="#akka.remote.transport;ThrottlerManager.getInboundMode.mode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</a>
      <span class="keyword">case</span> _ ⇒ <a href="#akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.type">Unthrottled</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(nakedAddress: akka.actor.Address)akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerManager.getOutboundMode">getOutboundMode</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;ThrottlerManager.getOutboundMode.nakedAddress">nakedAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a><span class="delimiter">)</span>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a> = <span class="delimiter">{</span>
    <a href="#akka.remote.transport;ThrottlerManager.throttlingModes_=" title="=&gt; scala.collection.immutable.Map[akka.actor.Address,(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)]">throttlingModes</a>.<span title="(key: akka.actor.Address)Option[(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)]">get</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.getOutboundMode.nakedAddress" title="akka.actor.Address">nakedAddress</a><span class="delimiter">)</span> <span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><span class="delimiter">(</span><a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerManager.getOutboundMode.mode">mode</a>, <a title="akka.remote.transport.ThrottlerTransportAdapter.Direction" id="akka.remote.transport;ThrottlerManager.getOutboundMode.direction">direction</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#akka.remote.transport;ThrottlerManager.getOutboundMode.direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">direction</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction.includes" title="(other: akka.remote.transport.ThrottlerTransportAdapter.Direction)Boolean">includes</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.type">Direction</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.type">Send</a><span class="delimiter">)</span> ⇒ <a href="#akka.remote.transport;ThrottlerManager.getOutboundMode.mode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</a>
      <span class="keyword">case</span> _ ⇒ <a href="#akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.type">Unthrottled</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(nakedAddress: akka.actor.Address, handle: akka.remote.transport.ThrottlerHandle)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]" id="akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c)">setMode</a><span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c).nakedAddress">nakedAddress</a>: <a href="../../../akka-actor/actor/Address.scala.html#akka.actor;Address" title="akka.actor.Address">Address</a>, <a title="akka.remote.transport.ThrottlerHandle" id="akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c).handle">handle</a>: <a href="#akka.remote.transport.ThrottlerHandle.readResolve" title="akka.remote.transport.ThrottlerHandle">ThrottlerHandle</a><span class="delimiter">)</span>: <span title="scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">Future</span><span class="delimiter">[</span>SetThrottleAck.<span class="keyword">type</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#akka.remote.transport;ThrottlerManager.throttlingModes_=" title="=&gt; scala.collection.immutable.Map[akka.actor.Address,(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)]">throttlingModes</a>.<span title="(key: akka.actor.Address)Option[(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, akka.remote.transport.ThrottlerTransportAdapter.Direction)]">get</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c).nakedAddress" title="akka.actor.Address">nakedAddress</a><span class="delimiter">)</span> <span title="scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><span class="delimiter">(</span><a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c).mode">mode</a>, <a title="akka.remote.transport.ThrottlerTransportAdapter.Direction" id="akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c).direction">direction</a><span class="delimiter">)</span><span class="delimiter">)</span> ⇒ <a href="#akka.remote.transport;ThrottlerManager.setMode(1ba03e051e)" title="(handle: akka.remote.transport.ThrottlerHandle, mode: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, direction: akka.remote.transport.ThrottlerTransportAdapter.Direction)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">setMode</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c).handle" title="akka.remote.transport.ThrottlerHandle">handle</a>, <a href="#akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c).mode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</a>, <a href="#akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c).direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">direction</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="None.type">None</span>                    ⇒ <a href="#akka.remote.transport;ThrottlerManager.setMode(1ba03e051e)" title="(handle: akka.remote.transport.ThrottlerHandle, mode: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, direction: akka.remote.transport.ThrottlerTransportAdapter.Direction)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">setMode</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.setMode(04f6b31b6c).handle" title="akka.remote.transport.ThrottlerHandle">handle</a>, <a href="#akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.type">Unthrottled</a>, <a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.type">Direction</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Both.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.Both.type">Both</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(handle: akka.remote.transport.ThrottlerHandle, mode: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, direction: akka.remote.transport.ThrottlerTransportAdapter.Direction)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]" id="akka.remote.transport;ThrottlerManager.setMode(1ba03e051e)">setMode</a><span class="delimiter">(</span><a title="akka.remote.transport.ThrottlerHandle" id="akka.remote.transport;ThrottlerManager.setMode(1ba03e051e).handle">handle</a>: <a href="#akka.remote.transport.ThrottlerHandle.readResolve" title="akka.remote.transport.ThrottlerHandle">ThrottlerHandle</a>, <a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerManager.setMode(1ba03e051e).mode">mode</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a>, <a title="akka.remote.transport.ThrottlerTransportAdapter.Direction" id="akka.remote.transport;ThrottlerManager.setMode(1ba03e051e).direction">direction</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">Direction</a><span class="delimiter">)</span>: <span title="scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">Future</span><span class="delimiter">[</span>SetThrottleAck.<span class="keyword">type</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.setMode(1ba03e051e).direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">direction</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction.includes" title="(other: akka.remote.transport.ThrottlerTransportAdapter.Direction)Boolean">includes</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.type">Direction</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.Send.type">Send</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.remote.transport;ThrottlerManager.setMode(1ba03e051e).handle" title="akka.remote.transport.ThrottlerHandle">handle</a>.<a href="#akka.remote.transport;ThrottlerHandle.outboundThrottleMode" title="=&gt; java.util.concurrent.atomic.AtomicReference[akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode]">outboundThrottleMode</a>.<span title="(x$1: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Unit">set</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.setMode(1ba03e051e).mode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</a><span class="delimiter">)</span>
    <span title="scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.setMode(1ba03e051e).direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction">direction</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;Direction.includes" title="(other: akka.remote.transport.ThrottlerTransportAdapter.Direction)Boolean">includes</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.type">Direction</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Direction.Receive.type">Receive</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion" title="(target: akka.actor.ActorRef, mode: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)(implicit timeout: akka.util.Timeout)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">askModeWithDeathCompletion</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.setMode(1ba03e051e).handle" title="akka.remote.transport.ThrottlerHandle">handle</a>.<a href="#akka.remote.transport;ThrottlerHandle.throttlerActor" title="=&gt; akka.actor.ActorRef">throttlerActor</a>, <a href="#akka.remote.transport;ThrottlerManager.setMode(1ba03e051e).mode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="AbstractTransportAdapter.scala.html#akka.remote.transport.ActorTransportAdapter" title="akka.remote.transport.ActorTransportAdapter.type">ActorTransportAdapter</a>.<a href="AbstractTransportAdapter.scala.html#akka.remote.transport.ActorTransportAdapter.AskTimeout" title="=&gt; akka.util.Timeout">AskTimeout</a><span class="delimiter">)</span>
    <span class="keyword">else</span>
      <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">successful</span><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(target: akka.actor.ActorRef, mode: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)(implicit timeout: akka.util.Timeout)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]" id="akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion">askModeWithDeathCompletion</a><span class="delimiter">(</span><a title="akka.actor.ActorRef" id="akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.target">target</a>: <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a>, <a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.mode">mode</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="akka.util.Timeout" id="akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.timeout">timeout</a>: <a href="../../../akka-actor/util/Timeout.scala.html#akka.util;Timeout" title="akka.util.Timeout">Timeout</a><span class="delimiter">)</span>: <span title="scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">Future</span><span class="delimiter">[</span>SetThrottleAck.<span class="keyword">type</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span title="scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.target" title="akka.actor.ActorRef">target</a>.<a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ActorRef.isTerminated" title="=&gt; Boolean">isTerminated</a><span class="delimiter">)</span> <span title="scala.concurrent.Future.type">Future</span> <span title="(result: akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">successful</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="akka.actor.InternalActorRef" id="akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.internalTarget">internalTarget</a> = <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.target" title="akka.actor.ActorRef">target</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.actor.InternalActorRef" class="delimiter">[</span><a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;InternalActorRef" title="akka.actor.InternalActorRef">InternalActorRef</a><span class="delimiter">]</span>
      <span class="keyword">val</span> <a title="akka.pattern.PromiseActorRef" id="akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.ref">ref</a> = <a href="../../../akka-actor/pattern/AskSupport.scala.html#akka.pattern.PromiseActorRef.apply" title="(provider: akka.actor.ActorRefProvider, timeout: akka.util.Timeout, targetName: String)akka.pattern.PromiseActorRef">PromiseActorRef</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.internalTarget" title="akka.actor.InternalActorRef">internalTarget</a>.<a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;InternalActorRef.provider" title="=&gt; akka.actor.ActorRefProvider">provider</a>, <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.timeout" title="akka.util.Timeout">timeout</a>, <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.target" title="akka.actor.ActorRef">target</a>.<a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ActorRef.toString" title="()String">toString</a><span class="delimiter">)</span>
      <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.internalTarget" title="akka.actor.InternalActorRef">internalTarget</a>.<a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;InternalActorRef.sendSystemMessage" title="(message: akka.dispatch.sysmsg.SystemMessage)Unit">sendSystemMessage</a><span class="delimiter">(</span><a href="../../../akka-actor/dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Watch" title="(watchee: akka.actor.InternalActorRef, watcher: akka.actor.InternalActorRef)akka.dispatch.sysmsg.Watch">Watch</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.internalTarget" title="akka.actor.InternalActorRef">internalTarget</a>, <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.ref" title="akka.pattern.PromiseActorRef">ref</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.target" title="akka.actor.ActorRef">target</a>.<a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ActorRef.tell" title="(msg: Any, sender: akka.actor.ActorRef)Unit">tell</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.mode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</a>, <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.ref" title="akka.pattern.PromiseActorRef">ref</a><span class="delimiter">)</span>
      <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.ref" title="akka.pattern.PromiseActorRef">ref</a>.<a href="../../../akka-actor/pattern/AskSupport.scala.html#akka.pattern;PromiseActorRef.result" title="=&gt; scala.concurrent.Promise[Any]">result</a>.<span title="=&gt; scala.concurrent.Future[Any]">future</span>.<span title="(s: Any =&gt; akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type, f: Throwable =&gt; Throwable)(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type]">transform</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.$anonfun.x0$8" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type" class="delimiter">{</a>
        <span class="keyword">case</span> Terminated<span class="delimiter">(</span><span title="akka.actor.ActorRef">t</span><span class="delimiter">)</span> <span class="keyword">if</span> <span title="akka.actor.ActorRef">t</span>.<a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ActorRef.path" title="=&gt; akka.actor.ActorPath">path</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.target" title="akka.actor.ActorRef">target</a>.<a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ActorRef.path" title="=&gt; akka.actor.ActorPath">path</a> ⇒ <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a>
        <span class="keyword">case</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a>                         ⇒ <span class="delimiter">{</span> <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.internalTarget" title="akka.actor.InternalActorRef">internalTarget</a>.<a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;InternalActorRef.sendSystemMessage" title="(message: akka.dispatch.sysmsg.SystemMessage)Unit">sendSystemMessage</a><span class="delimiter">(</span><a href="../../../akka-actor/dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Unwatch" title="(watchee: akka.actor.ActorRef, watcher: akka.actor.ActorRef)akka.dispatch.sysmsg.Unwatch">Unwatch</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.target" title="akka.actor.ActorRef">target</a>, <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.ref" title="akka.pattern.PromiseActorRef">ref</a><span class="delimiter">)</span><span class="delimiter">)</span>; <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a> <span class="delimiter">}</span>
      <span class="delimiter">}</span>, <span title="Throwable">t</span> ⇒ <span class="delimiter">{</span> <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.internalTarget" title="akka.actor.InternalActorRef">internalTarget</a>.<a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;InternalActorRef.sendSystemMessage" title="(message: akka.dispatch.sysmsg.SystemMessage)Unit">sendSystemMessage</a><span class="delimiter">(</span><a href="../../../akka-actor/dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Unwatch" title="(watchee: akka.actor.ActorRef, watcher: akka.actor.ActorRef)akka.dispatch.sysmsg.Unwatch">Unwatch</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.target" title="akka.actor.ActorRef">target</a>, <a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.ref" title="akka.pattern.PromiseActorRef">ref</a><span class="delimiter">)</span><span class="delimiter">)</span>; <span title="Throwable">t</span> <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerManager.askModeWithDeathCompletion.ref" title="akka.pattern.PromiseActorRef">ref</a>.<a href="../../../akka-actor/pattern/AskSupport.scala.html#akka.pattern;PromiseActorRef.internalCallingThreadExecutionContext" title="=&gt; scala.concurrent.ExecutionContext">internalCallingThreadExecutionContext</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(originalHandle: akka.remote.transport.AssociationHandle, listener: akka.remote.transport.Transport.AssociationEventListener, inbound: Boolean)akka.remote.transport.ThrottlerHandle" id="akka.remote.transport;ThrottlerManager.wrapHandle">wrapHandle</a><span class="delimiter">(</span><a title="akka.remote.transport.AssociationHandle" id="akka.remote.transport;ThrottlerManager.wrapHandle.originalHandle">originalHandle</a>: <a href="Transport.scala.html#akka.remote.transport;AssociationHandle" title="akka.remote.transport.AssociationHandle">AssociationHandle</a>, <a title="akka.remote.transport.Transport.AssociationEventListener" id="akka.remote.transport;ThrottlerManager.wrapHandle.listener">listener</a>: <a href="Transport.scala.html#akka.remote.transport.Transport;AssociationEventListener" title="akka.remote.transport.Transport.AssociationEventListener">AssociationEventListener</a>, <a title="Boolean" id="akka.remote.transport;ThrottlerManager.wrapHandle.inbound">inbound</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>: <a href="#akka.remote.transport.ThrottlerHandle.readResolve" title="akka.remote.transport.ThrottlerHandle">ThrottlerHandle</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="akka.actor.ActorRef" id="akka.remote.transport;ThrottlerManager.wrapHandle.managerRef">managerRef</a> = <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>
    <a href="#akka.remote.transport.ThrottlerHandle.readResolve" title="(_wrappedHandle: akka.remote.transport.AssociationHandle, throttlerActor: akka.actor.ActorRef)akka.remote.transport.ThrottlerHandle">ThrottlerHandle</a><span class="delimiter">(</span>
      <a href="#akka.remote.transport;ThrottlerManager.wrapHandle.originalHandle" title="akka.remote.transport.AssociationHandle">originalHandle</a>,
      <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../akka-actor/actor/ActorRefProvider.scala.html#akka.actor;ActorRefFactory.actorOf(874c98419a)" title="(props: akka.actor.Props, name: String)akka.actor.ActorRef">actorOf</a><span class="delimiter">(</span>
        <a href="../../../akka-actor/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.remote.RARP">RARP</a><span class="delimiter">(</span><a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../akka-actor/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a><span class="delimiter">)</span>.<a href="../Remoting.scala.html#akka.remote;RARP.configureDispatcher" title="(props: akka.actor.Props)akka.actor.Props">configureDispatcher</a><span class="delimiter">(</span>
          <a href="../../../akka-actor/actor/Props.scala.html#akka.actor.Props.apply(0870a176b3)" title="(clazz: Class[_], args: Any*)akka.actor.Props">Props</a><span class="delimiter">(</span>classOf<span title="Class[akka.remote.transport.ThrottledAssociation](classOf[akka.remote.transport.ThrottledAssociation])" class="delimiter">[</span>ThrottledAssociation<span class="delimiter">]</span>, <a href="#akka.remote.transport;ThrottlerManager.wrapHandle.managerRef" title="akka.actor.ActorRef">managerRef</a>, <a href="#akka.remote.transport;ThrottlerManager.wrapHandle.listener" title="akka.remote.transport.Transport.AssociationEventListener">listener</a>, <a href="#akka.remote.transport;ThrottlerManager.wrapHandle.originalHandle" title="akka.remote.transport.AssociationHandle">originalHandle</a>, <a href="#akka.remote.transport;ThrottlerManager.wrapHandle.inbound" title="Boolean">inbound</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../akka-actor/actor/Props.scala.html#akka.actor;Props.withDeploy" title="(d: akka.actor.Deploy)akka.actor.Props">withDeploy</a><span class="delimiter">(</span><a href="../../../akka-actor/actor/Deployer.scala.html#akka.actor.Deploy" title="akka.actor.Deploy.type">Deploy</a>.<a href="../../../akka-actor/actor/Deployer.scala.html#akka.actor.Deploy.local" title="=&gt; akka.actor.Deploy">local</a><span class="delimiter">)</span>,
        <span title="String(&quot;throttler&quot;)" class="string">&quot;throttler&quot;</span> <span title="(x$1: Any)String">+</span> <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;ActorTransportAdapterManager.nextId" title="()Long">nextId</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>transport<span class="delimiter">]</span> <span class="keyword">object</span> <a title="akka.remote.transport.ThrottledAssociation.type" id="akka.remote.transport.ThrottledAssociation">ThrottledAssociation</a> <a href="#akka.remote.transport.ThrottledAssociation" title="akka.remote.transport.ThrottledAssociation.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">val</span> <a title="String(&quot;dequeue&quot;)" id="akka.remote.transport.ThrottledAssociation.DequeueTimerName">DequeueTimerName</a> = <span title="String(&quot;dequeue&quot;)" class="string">&quot;dequeue&quot;</span>

  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottledAssociation.Dequeue.productElement.x$1" title="akka.remote.transport.ThrottledAssociation.Dequeue.type" id="akka.remote.transport.ThrottledAssociation.Dequeue.readResolve">Dequeue</a>

  <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait ThrottlerState extends AnyRef" id="akka.remote.transport.ThrottledAssociation;ThrottlerState">ThrottlerState</a>

  <span class="comment">// --- Chain of states for inbound associations</span>

  <span class="comment">// Waiting for the ThrottlerHandle coupled with the throttler actor.</span>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottledAssociation.WaitExposedHandle.productElement.x$1" title="akka.remote.transport.ThrottledAssociation.WaitExposedHandle.type" id="akka.remote.transport.ThrottledAssociation.WaitExposedHandle.readResolve">WaitExposedHandle</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottledAssociation;ThrottlerState" title="akka.remote.transport.ThrottledAssociation.ThrottlerState">ThrottlerState</a>
  <span class="comment">// Waiting for the ASSOCIATE message that contains the origin address of the remote endpoint</span>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottledAssociation.WaitOrigin.productElement.x$1" title="akka.remote.transport.ThrottledAssociation.WaitOrigin.type" id="akka.remote.transport.ThrottledAssociation.WaitOrigin.readResolve">WaitOrigin</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottledAssociation;ThrottlerState" title="akka.remote.transport.ThrottledAssociation.ThrottlerState">ThrottlerState</a>
  <span class="comment">// After origin is known and a Checkin message is sent to the manager, we must wait for the ThrottlingMode for the</span>
  <span class="comment">// address</span>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottledAssociation.WaitMode.productElement.x$1" title="akka.remote.transport.ThrottledAssociation.WaitMode.type" id="akka.remote.transport.ThrottledAssociation.WaitMode.readResolve">WaitMode</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottledAssociation;ThrottlerState" title="akka.remote.transport.ThrottledAssociation.ThrottlerState">ThrottlerState</a>
  <span class="comment">// After all information is known, the throttler must wait for the upstream listener to be able to forward messages</span>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottledAssociation.WaitUpstreamListener.productElement.x$1" title="akka.remote.transport.ThrottledAssociation.WaitUpstreamListener.type" id="akka.remote.transport.ThrottledAssociation.WaitUpstreamListener.readResolve">WaitUpstreamListener</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottledAssociation;ThrottlerState" title="akka.remote.transport.ThrottledAssociation.ThrottlerState">ThrottlerState</a>

  <span class="comment">// --- States for outbound associations</span>

  <span class="comment">// Waiting for the tuple containing the upstream listener and ThrottleMode</span>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottledAssociation.WaitModeAndUpstreamListener.productElement.x$1" title="akka.remote.transport.ThrottledAssociation.WaitModeAndUpstreamListener.type" id="akka.remote.transport.ThrottledAssociation.WaitModeAndUpstreamListener.readResolve">WaitModeAndUpstreamListener</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottledAssociation;ThrottlerState" title="akka.remote.transport.ThrottledAssociation.ThrottlerState">ThrottlerState</a>

  <span class="comment">// Fully initialized state</span>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottledAssociation.Throttling.productElement.x$1" title="akka.remote.transport.ThrottledAssociation.Throttling.type" id="akka.remote.transport.ThrottledAssociation.Throttling.readResolve">Throttling</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottledAssociation;ThrottlerState" title="akka.remote.transport.ThrottledAssociation.ThrottlerState">ThrottlerState</a>

  <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait ThrottlerData extends AnyRef" id="akka.remote.transport.ThrottledAssociation;ThrottlerData">ThrottlerData</a>
  <span class="keyword">case object</span> <a href="#akka.remote.transport.ThrottledAssociation.Uninitialized.productElement.x$1" title="akka.remote.transport.ThrottledAssociation.Uninitialized.type" id="akka.remote.transport.ThrottledAssociation.Uninitialized.readResolve">Uninitialized</a> <span title="Product" class="keyword">extends</span> <a href="#akka.remote.transport.ThrottledAssociation;ThrottlerData" title="akka.remote.transport.ThrottledAssociation.ThrottlerData">ThrottlerData</a>
  <span class="keyword">case class</span> <a title="class ExposedHandle extends AnyRef with akka.remote.transport.ThrottledAssociation.ThrottlerData with Product with Serializable" id="akka.remote.transport.ThrottledAssociation.ExposedHandle.readResolve">ExposedHandle</a><a href="#akka.remote.transport.ThrottledAssociation.ExposedHandle.readResolve" title="Product" class="delimiter">(</a><a title="akka.remote.transport.ThrottlerHandle" id="akka.remote.transport.ThrottledAssociation;ExposedHandle.handle">handle</a>: <a href="#akka.remote.transport.ThrottlerHandle.readResolve" title="akka.remote.transport.ThrottlerHandle">ThrottlerHandle</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#akka.remote.transport.ThrottledAssociation;ThrottlerData" title="akka.remote.transport.ThrottledAssociation.ThrottlerData">ThrottlerData</a>

  <span class="keyword">case class</span> <a title="class FailWith extends AnyRef with Product with Serializable" id="akka.remote.transport.ThrottledAssociation.FailWith.readResolve">FailWith</a><a href="#akka.remote.transport.ThrottledAssociation.FailWith.readResolve" title="Product" class="delimiter">(</a><a title="akka.remote.transport.AssociationHandle.DisassociateInfo" id="akka.remote.transport.ThrottledAssociation;FailWith.reason">reason</a>: <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;DisassociateInfo" title="akka.remote.transport.AssociationHandle.DisassociateInfo">DisassociateInfo</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
<span title="AnyRef" class="keyword">private</span><span class="delimiter">[</span>transport<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class ThrottledAssociation extends AnyRef with akka.actor.Actor with akka.actor.LoggingFSM[akka.remote.transport.ThrottledAssociation.ThrottlerState,akka.remote.transport.ThrottledAssociation.ThrottlerData] with akka.dispatch.RequiresMessageQueue[akka.dispatch.UnboundedMessageQueueSemantics]" id="akka.remote.transport;ThrottledAssociation">ThrottledAssociation</a><a href="#akka.remote.transport;ThrottledAssociation" title="akka.remote.transport.ThrottledAssociation" class="delimiter">(</a>
  <span class="keyword">val</span> <a title="akka.actor.ActorRef" id="akka.remote.transport;ThrottledAssociation.manager">manager</a>: <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a>,
  <span class="keyword">val</span> <a title="akka.remote.transport.Transport.AssociationEventListener" id="akka.remote.transport;ThrottledAssociation.associationHandler">associationHandler</a>: <a href="Transport.scala.html#akka.remote.transport.Transport;AssociationEventListener" title="akka.remote.transport.Transport.AssociationEventListener">AssociationEventListener</a>,
  <span class="keyword">val</span> <a title="akka.remote.transport.AssociationHandle" id="akka.remote.transport;ThrottledAssociation.originalHandle">originalHandle</a>: <a href="Transport.scala.html#akka.remote.transport;AssociationHandle" title="akka.remote.transport.AssociationHandle">AssociationHandle</a>,
  <span class="keyword">val</span> <a title="Boolean" id="akka.remote.transport;ThrottledAssociation.inbound">inbound</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor" title="akka.actor.Actor">Actor</a> <span class="keyword">with</span> <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;LoggingFSM" title="akka.actor.LoggingFSM[akka.remote.transport.ThrottledAssociation.ThrottlerState,akka.remote.transport.ThrottledAssociation.ThrottlerData]">LoggingFSM</a><span class="delimiter">[</span>ThrottledAssociation.ThrottlerState, ThrottledAssociation.ThrottlerData<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="../../../akka-actor/dispatch/Mailbox.scala.html#akka.dispatch;RequiresMessageQueue" title="akka.dispatch.RequiresMessageQueue[akka.dispatch.UnboundedMessageQueueSemantics]">RequiresMessageQueue</a><span class="delimiter">[</span>UnboundedMessageQueueSemantics<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#akka.remote.transport.ThrottledAssociation" title="akka.remote.transport.ThrottledAssociation.type">ThrottledAssociation</a>._
  <span class="keyword">import</span> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.dispatcher

  <span class="keyword">var</span> <a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=">inboundThrottleMode</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a> = _
  <span class="keyword">var</span> <a title="scala.collection.immutable.Queue[akka.util.ByteString]" id="akka.remote.transport;ThrottledAssociation.throttledMessages_=">throttledMessages</a> = <span title="scala.collection.immutable.Queue.type">Queue</span>.<span title="[A]=&gt; scala.collection.immutable.Queue[A]">empty</span><span title="scala.collection.immutable.Queue[akka.util.ByteString]" class="delimiter">[</span><a href="../../../akka-actor/util/ByteString.scala.html#akka.util;ByteString" title="akka.util.ByteString">ByteString</a><span class="delimiter">]</span>
  <span class="keyword">var</span> <a title="akka.remote.transport.AssociationHandle.HandleEventListener" id="akka.remote.transport;ThrottledAssociation.upstreamListener_=">upstreamListener</a>: <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;HandleEventListener" title="akka.remote.transport.AssociationHandle.HandleEventListener">HandleEventListener</a> = _

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="akka.remote.transport;ThrottledAssociation.postStop">postStop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.remote.transport;ThrottledAssociation.originalHandle" title="=&gt; akka.remote.transport.AssociationHandle">originalHandle</a>.<a href="Transport.scala.html#akka.remote.transport;AssociationHandle.disassociate" title="()Unit">disassociate</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.inbound" title="=&gt; Boolean">inbound</a><span class="delimiter">)</span> <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.startWith" title="(stateName: akka.remote.transport.ThrottledAssociation.ThrottlerState, stateData: akka.remote.transport.ThrottledAssociation.ThrottlerData, timeout: ThrottledAssociation.this.Timeout)Unit">startWith</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.WaitExposedHandle.readResolve" title="akka.remote.transport.ThrottledAssociation.WaitExposedHandle.type">WaitExposedHandle</a>, <a href="#akka.remote.transport.ThrottledAssociation.Uninitialized.readResolve" title="akka.remote.transport.ThrottledAssociation.Uninitialized.type">Uninitialized</a><span class="delimiter">)</span> <span class="keyword">else</span> <span class="delimiter">{</span>
    <a href="#akka.remote.transport;ThrottledAssociation.originalHandle" title="=&gt; akka.remote.transport.AssociationHandle">originalHandle</a>.<a href="Transport.scala.html#akka.remote.transport;AssociationHandle.readHandlerPromise" title="=&gt; scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">readHandlerPromise</a>.<span title="(v: akka.remote.transport.AssociationHandle.HandleEventListener)scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">success</span><span class="delimiter">(</span><a href="Transport.scala.html#akka.remote.transport.AssociationHandle;ActorHandleEventListener" title="(actor: akka.actor.ActorRef)akka.remote.transport.AssociationHandle.ActorHandleEventListener">ActorHandleEventListener</a><span class="delimiter">(</span><a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.startWith" title="(stateName: akka.remote.transport.ThrottledAssociation.ThrottlerState, stateData: akka.remote.transport.ThrottledAssociation.ThrottlerData, timeout: ThrottledAssociation.this.Timeout)Unit">startWith</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.WaitModeAndUpstreamListener.readResolve" title="akka.remote.transport.ThrottledAssociation.WaitModeAndUpstreamListener.type">WaitModeAndUpstreamListener</a>, <a href="#akka.remote.transport.ThrottledAssociation.Uninitialized.readResolve" title="akka.remote.transport.ThrottledAssociation.Uninitialized.type">Uninitialized</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.when" title="(stateName: akka.remote.transport.ThrottledAssociation.ThrottlerState, stateTimeout: scala.concurrent.duration.FiniteDuration)(stateFunction: ThrottledAssociation.this.StateFunction)Unit">when</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.WaitExposedHandle.readResolve" title="akka.remote.transport.ThrottledAssociation.WaitExposedHandle.type">WaitExposedHandle</a><span class="delimiter">)</span> <span title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[ThrottledAssociation.this.Event,ThrottledAssociation.this.State] with Serializable" class="delimiter">{</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span>Handle<span class="delimiter">(</span><a title="akka.remote.transport.ThrottlerHandle" id="akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.isDefinedAt.handle">handle</a><span class="delimiter">)</span>, <a href="#akka.remote.transport.ThrottledAssociation.Uninitialized.readResolve" title="akka.remote.transport.ThrottledAssociation.Uninitialized.type">Uninitialized</a><span class="delimiter">)</span> ⇒
      <span class="comment">// register to downstream layer and wait for origin</span>
      <a href="#akka.remote.transport;ThrottledAssociation.originalHandle" title="=&gt; akka.remote.transport.AssociationHandle">originalHandle</a>.<a href="Transport.scala.html#akka.remote.transport;AssociationHandle.readHandlerPromise" title="=&gt; scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">readHandlerPromise</a>.<span title="(v: akka.remote.transport.AssociationHandle.HandleEventListener)scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">success</span><span class="delimiter">(</span><a href="Transport.scala.html#akka.remote.transport.AssociationHandle;ActorHandleEventListener" title="(actor: akka.actor.ActorRef)akka.remote.transport.AssociationHandle.ActorHandleEventListener">ActorHandleEventListener</a><span class="delimiter">(</span><a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.goto" title="(nextStateName: akka.remote.transport.ThrottledAssociation.ThrottlerState)ThrottledAssociation.this.State">goto</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.WaitOrigin.readResolve" title="akka.remote.transport.ThrottledAssociation.WaitOrigin.type">WaitOrigin</a><span class="delimiter">)</span> <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor.FSM;State.using" title="(nextStateDate: akka.remote.transport.ThrottledAssociation.ThrottlerData)akka.actor.FSM.State[akka.remote.transport.ThrottledAssociation.ThrottlerState,akka.remote.transport.ThrottledAssociation.ThrottlerData]">using</a> <a href="#akka.remote.transport.ThrottledAssociation.ExposedHandle.readResolve" title="(handle: akka.remote.transport.ThrottlerHandle)akka.remote.transport.ThrottledAssociation.ExposedHandle">ExposedHandle</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.isDefinedAt.handle" title="akka.remote.transport.ThrottlerHandle">handle</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.when" title="(stateName: akka.remote.transport.ThrottledAssociation.ThrottlerState, stateTimeout: scala.concurrent.duration.FiniteDuration)(stateFunction: ThrottledAssociation.this.StateFunction)Unit">when</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.WaitOrigin.readResolve" title="akka.remote.transport.ThrottledAssociation.WaitOrigin.type">WaitOrigin</a><span class="delimiter">)</span> <span title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[ThrottledAssociation.this.Event,ThrottledAssociation.this.State] with Serializable" class="delimiter">{</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span>InboundPayload<span class="delimiter">(</span><span title="akka.util.ByteString">p</span><span class="delimiter">)</span>, ExposedHandle<span class="delimiter">(</span><span title="akka.remote.transport.ThrottlerHandle">exposedHandle</span><span class="delimiter">)</span><span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="(x$1: scala.collection.immutable.Queue[akka.util.ByteString])Unit">throttledMessages</a> = <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a> <span title="(elem: akka.util.ByteString)scala.collection.immutable.Queue[akka.util.ByteString]">enqueue</span> <span title="akka.util.ByteString">p</span>
      <a href="#akka.remote.transport;ThrottledAssociation.peekOrigin" title="(b: akka.util.ByteString)Option[akka.actor.Address]">peekOrigin</a><span class="delimiter">(</span><span title="akka.util.ByteString">p</span><span class="delimiter">)</span> <span title="ThrottledAssociation.this.State" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<span class="delimiter">(</span><a title="akka.actor.Address" id="akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.origin">origin</a><span class="delimiter">)</span> ⇒
          <a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">manager</a> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottlerManager.Checkin.readResolve" title="(origin: akka.actor.Address, handle: akka.remote.transport.ThrottlerHandle)akka.remote.transport.ThrottlerManager.Checkin">Checkin</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.origin" title="akka.actor.Address">origin</a>, <span title="akka.remote.transport.ThrottlerHandle">exposedHandle</span><span class="delimiter">)</span>
          <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.goto" title="(nextStateName: akka.remote.transport.ThrottledAssociation.ThrottlerState)ThrottledAssociation.this.State">goto</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.WaitMode.readResolve" title="akka.remote.transport.ThrottledAssociation.WaitMode.type">WaitMode</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="None.type">None</span> ⇒ <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stay" title="()ThrottledAssociation.this.State">stay</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.when" title="(stateName: akka.remote.transport.ThrottledAssociation.ThrottlerState, stateTimeout: scala.concurrent.duration.FiniteDuration)(stateFunction: ThrottledAssociation.this.StateFunction)Unit">when</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.WaitMode.readResolve" title="akka.remote.transport.ThrottledAssociation.WaitMode.type">WaitMode</a><span class="delimiter">)</span> <span title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[ThrottledAssociation.this.Event,ThrottledAssociation.this.State] with Serializable" class="delimiter">{</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span>InboundPayload<span class="delimiter">(</span><span title="akka.util.ByteString">p</span><span class="delimiter">)</span>, _<span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="(x$1: scala.collection.immutable.Queue[akka.util.ByteString])Unit">throttledMessages</a> = <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a> <span title="(elem: akka.util.ByteString)scala.collection.immutable.Queue[akka.util.ByteString]">enqueue</span> <span title="akka.util.ByteString">p</span>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stay" title="()ThrottledAssociation.this.State">stay</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span><span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</span>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a>, ExposedHandle<span class="delimiter">(</span><span title="akka.remote.transport.ThrottlerHandle">exposedHandle</span><span class="delimiter">)</span><span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="(x$1: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Unit">inboundThrottleMode</a> = <span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</span>
      <span class="keyword">try</span> <span title="ThrottledAssociation.this.State" class="keyword">if</span> <span class="delimiter">(</span><span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Blackhole.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.type">Blackhole</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="(x$1: scala.collection.immutable.Queue[akka.util.ByteString])Unit">throttledMessages</a> = <span title="scala.collection.immutable.Queue.type">Queue</span>.<span title="[A]=&gt; scala.collection.immutable.Queue[A]">empty</span><span title="scala.collection.immutable.Queue[akka.util.ByteString]" class="delimiter">[</span><a href="../../../akka-actor/util/ByteString.scala.html#akka.util;ByteString" title="akka.util.ByteString">ByteString</a><span class="delimiter">]</span>
        <span title="akka.remote.transport.ThrottlerHandle">exposedHandle</span>.<a href="#akka.remote.transport;ThrottlerHandle.disassociate" title="()Unit">disassociate</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stop(65b4a2ce7c)" title="()ThrottledAssociation.this.State">stop</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#akka.remote.transport;ThrottledAssociation.associationHandler" title="=&gt; akka.remote.transport.Transport.AssociationEventListener">associationHandler</a> <a href="Transport.scala.html#akka.remote.transport.Transport;AssociationEventListener.notify(1d1bf972b0)" title="(ev: akka.remote.transport.Transport.AssociationEvent)Unit">notify</a> <a href="Transport.scala.html#akka.remote.transport.Transport;InboundAssociation" title="(association: akka.remote.transport.AssociationHandle)akka.remote.transport.Transport.InboundAssociation">InboundAssociation</a><span class="delimiter">(</span><span title="akka.remote.transport.ThrottlerHandle">exposedHandle</span><span class="delimiter">)</span>
        <span title="akka.remote.transport.ThrottlerHandle">exposedHandle</span>.<a href="#akka.remote.transport;ThrottlerHandle.readHandlerPromise" title="=&gt; scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">readHandlerPromise</a>.<span title="=&gt; scala.concurrent.Future[akka.remote.transport.AssociationHandle.HandleEventListener]">future</span>.<span title="(f: akka.remote.transport.AssociationHandle.HandleEventListener =&gt; akka.remote.transport.ThrottlerManager.Listener)(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[akka.remote.transport.ThrottlerManager.Listener]">map</span><a href="../../../akka-actor/pattern/PipeToSupport.scala.html#akka.pattern;PipeToSupport.pipe" title="(future: scala.concurrent.Future[akka.remote.transport.ThrottlerManager.Listener])(implicit executionContext: scala.concurrent.ExecutionContext)akka.pattern.PipeableFuture[akka.remote.transport.ThrottlerManager.Listener]" class="delimiter">(</a><a href="#akka.remote.transport.ThrottlerManager.Listener.readResolve" title="(listener: akka.remote.transport.AssociationHandle.HandleEventListener)akka.remote.transport.ThrottlerManager.Listener">Listener</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.$anonfun.x$3" title="akka.remote.transport.AssociationHandle.HandleEventListener">_</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../akka-actor/pattern/PipeToSupport.scala.html#akka.pattern;PipeToSupport;PipeableFuture.pipeTo" title="(recipient: akka.actor.ActorRef)(implicit sender: akka.actor.ActorRef)scala.concurrent.Future[akka.remote.transport.ThrottlerManager.Listener]">pipeTo</a> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>
        <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.goto" title="(nextStateName: akka.remote.transport.ThrottledAssociation.ThrottlerState)ThrottledAssociation.this.State">goto</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.WaitUpstreamListener.readResolve" title="akka.remote.transport.ThrottledAssociation.WaitUpstreamListener.type">WaitUpstreamListener</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">finally</span> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.sender" title="()akka.actor.ActorRef">sender</a><a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef" class="delimiter">(</a><span class="delimiter">)</span> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a>
  <span class="delimiter">}</span>

  <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.when" title="(stateName: akka.remote.transport.ThrottledAssociation.ThrottlerState, stateTimeout: scala.concurrent.duration.FiniteDuration)(stateFunction: ThrottledAssociation.this.StateFunction)Unit">when</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.WaitUpstreamListener.readResolve" title="akka.remote.transport.ThrottledAssociation.WaitUpstreamListener.type">WaitUpstreamListener</a><span class="delimiter">)</span> <span title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[ThrottledAssociation.this.Event,ThrottledAssociation.this.State] with Serializable" class="delimiter">{</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span>InboundPayload<span class="delimiter">(</span><span title="akka.util.ByteString">p</span><span class="delimiter">)</span>, _<span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="(x$1: scala.collection.immutable.Queue[akka.util.ByteString])Unit">throttledMessages</a> = <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a> <span title="(elem: akka.util.ByteString)scala.collection.immutable.Queue[akka.util.ByteString]">enqueue</span> <span title="akka.util.ByteString">p</span>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stay" title="()ThrottledAssociation.this.State">stay</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span>Listener<span class="delimiter">(</span><span title="akka.remote.transport.AssociationHandle.HandleEventListener">listener</span><span class="delimiter">)</span>, _<span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.upstreamListener_=" title="(x$1: akka.remote.transport.AssociationHandle.HandleEventListener)Unit">upstreamListener</a> = <span title="akka.remote.transport.AssociationHandle.HandleEventListener">listener</span>
      <a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottledAssociation.Dequeue.readResolve" title="akka.remote.transport.ThrottledAssociation.Dequeue.type">Dequeue</a>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.goto" title="(nextStateName: akka.remote.transport.ThrottledAssociation.ThrottlerState)ThrottledAssociation.this.State">goto</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.Throttling.readResolve" title="akka.remote.transport.ThrottledAssociation.Throttling.type">Throttling</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.when" title="(stateName: akka.remote.transport.ThrottledAssociation.ThrottlerState, stateTimeout: scala.concurrent.duration.FiniteDuration)(stateFunction: ThrottledAssociation.this.StateFunction)Unit">when</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.WaitModeAndUpstreamListener.readResolve" title="akka.remote.transport.ThrottledAssociation.WaitModeAndUpstreamListener.type">WaitModeAndUpstreamListener</a><span class="delimiter">)</span> <span title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[ThrottledAssociation.this.Event,ThrottledAssociation.this.State] with Serializable" class="delimiter">{</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span>ListenerAndMode<span class="delimiter">(</span><span title="akka.remote.transport.AssociationHandle.HandleEventListener">listener</span>: <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;HandleEventListener" title="akka.remote.transport.AssociationHandle.HandleEventListener">HandleEventListener</a>, <span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</span>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a><span class="delimiter">)</span>, _<span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.upstreamListener_=" title="(x$1: akka.remote.transport.AssociationHandle.HandleEventListener)Unit">upstreamListener</a> = <span title="akka.remote.transport.AssociationHandle.HandleEventListener">listener</span>
      <a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="(x$1: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Unit">inboundThrottleMode</a> = <span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</span>
      <a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottledAssociation.Dequeue.readResolve" title="akka.remote.transport.ThrottledAssociation.Dequeue.type">Dequeue</a>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.goto" title="(nextStateName: akka.remote.transport.ThrottledAssociation.ThrottlerState)ThrottledAssociation.this.State">goto</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.Throttling.readResolve" title="akka.remote.transport.ThrottledAssociation.Throttling.type">Throttling</a><span class="delimiter">)</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span>InboundPayload<span class="delimiter">(</span><span title="akka.util.ByteString">p</span><span class="delimiter">)</span>, _<span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="(x$1: scala.collection.immutable.Queue[akka.util.ByteString])Unit">throttledMessages</a> = <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a> <span title="(elem: akka.util.ByteString)scala.collection.immutable.Queue[akka.util.ByteString]">enqueue</span> <span title="akka.util.ByteString">p</span>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stay" title="()ThrottledAssociation.this.State">stay</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.when" title="(stateName: akka.remote.transport.ThrottledAssociation.ThrottlerState, stateTimeout: scala.concurrent.duration.FiniteDuration)(stateFunction: ThrottledAssociation.this.StateFunction)Unit">when</a><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.Throttling.readResolve" title="akka.remote.transport.ThrottledAssociation.Throttling.type">Throttling</a><span class="delimiter">)</span> <span title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[ThrottledAssociation.this.Event,ThrottledAssociation.this.State] with Serializable" class="delimiter">{</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span><span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</span>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a>, _<span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="(x$1: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Unit">inboundThrottleMode</a> = <span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Blackhole.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.type">Blackhole</a><span class="delimiter">)</span> <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="(x$1: scala.collection.immutable.Queue[akka.util.ByteString])Unit">throttledMessages</a> = <span title="scala.collection.immutable.Queue.type">Queue</span>.<span title="[A]=&gt; scala.collection.immutable.Queue[A]">empty</span><span title="scala.collection.immutable.Queue[akka.util.ByteString]" class="delimiter">[</span><a href="../../../akka-actor/util/ByteString.scala.html#akka.util;ByteString" title="akka.util.ByteString">ByteString</a><span class="delimiter">]</span>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.cancelTimer" title="(name: String)Unit">cancelTimer</a><span class="delimiter">(</span><span title="String(&quot;dequeue&quot;)">DequeueTimerName</span><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span>
        <a href="#akka.remote.transport;ThrottledAssociation.scheduleDequeue" title="(delay: scala.concurrent.duration.FiniteDuration)Unit">scheduleDequeue</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">inboundThrottleMode</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.timeToAvailable" title="(currentNanoTime: Long, tokens: Int)scala.concurrent.duration.FiniteDuration">timeToAvailable</a><span class="delimiter">(</span><span title="System.type">System</span>.<span title="()Long">nanoTime</span><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a>.<span title="=&gt; akka.util.ByteString">head</span>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.sender" title="()akka.actor.ActorRef">sender</a><a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef" class="delimiter">(</a><span class="delimiter">)</span> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stay" title="()ThrottledAssociation.this.State">stay</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span>InboundPayload<span class="delimiter">(</span><span title="akka.util.ByteString">p</span><span class="delimiter">)</span>, _<span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay" title="(payload: akka.util.ByteString)Unit">forwardOrDelay</a><span class="delimiter">(</span><span title="akka.util.ByteString">p</span><span class="delimiter">)</span>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stay" title="()ThrottledAssociation.this.State">stay</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">case</span> Event<span class="delimiter">(</span><a href="#akka.remote.transport.ThrottledAssociation.Dequeue.readResolve" title="akka.remote.transport.ThrottledAssociation.Dequeue.type">Dequeue</a>, _<span class="delimiter">)</span> ⇒
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a href="#akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.payload" title="(akka.util.ByteString, scala.collection.immutable.Queue[akka.util.ByteString])" class="delimiter">(</a><a href="#akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.x$4" title="akka.util.ByteString" id="akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.payload">payload</a>, <a href="#akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.x$4" title="scala.collection.immutable.Queue[akka.util.ByteString]" id="akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.newqueue">newqueue</a><span class="delimiter">)</span> = <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a>.<span title="=&gt; (akka.util.ByteString, scala.collection.immutable.Queue[akka.util.ByteString])">dequeue</span>
        <a href="#akka.remote.transport;ThrottledAssociation.upstreamListener_=" title="=&gt; akka.remote.transport.AssociationHandle.HandleEventListener">upstreamListener</a> <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;HandleEventListener.notify(a3fa5b160e)" title="(ev: akka.remote.transport.AssociationHandle.HandleEvent)Unit">notify</a> <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;InboundPayload" title="(payload: akka.util.ByteString)akka.remote.transport.AssociationHandle.InboundPayload">InboundPayload</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.payload" title="akka.util.ByteString">payload</a><span class="delimiter">)</span>
        <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="(x$1: scala.collection.immutable.Queue[akka.util.ByteString])Unit">throttledMessages</a> = <a href="#akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.newqueue" title="scala.collection.immutable.Queue[akka.util.ByteString]">newqueue</a>
        <a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="(x$1: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Unit">inboundThrottleMode</a> = <a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">inboundThrottleMode</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.tryConsumeTokens" title="(nanoTimeOfSend: Long, tokens: Int)(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)">tryConsumeTokens</a><span class="delimiter">(</span><span title="System.type">System</span>.<span title="()Long">nanoTime</span><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="#akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.applyOrElse.payload" title="akka.util.ByteString">payload</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span>.<span title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">_1</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span>
          <a href="#akka.remote.transport;ThrottledAssociation.scheduleDequeue" title="(delay: scala.concurrent.duration.FiniteDuration)Unit">scheduleDequeue</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">inboundThrottleMode</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.timeToAvailable" title="(currentNanoTime: Long, tokens: Int)scala.concurrent.duration.FiniteDuration">timeToAvailable</a><span class="delimiter">(</span><span title="System.type">System</span>.<span title="()Long">nanoTime</span><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a>.<span title="=&gt; akka.util.ByteString">head</span>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stay" title="()ThrottledAssociation.this.State">stay</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="delimiter">}</span>

  <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.whenUnhandled" title="(stateFunction: ThrottledAssociation.this.StateFunction)Unit">whenUnhandled</a> <span title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[ThrottledAssociation.this.Event,ThrottledAssociation.this.State] with Serializable" class="delimiter">{</span>
    <span class="comment">// we should always set the throttling mode</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span><span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</span>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a>, _<span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="(x$1: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Unit">inboundThrottleMode</a> = <span title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">mode</span>
      <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor;Actor.sender" title="()akka.actor.ActorRef">sender</a><a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef" class="delimiter">(</a><span class="delimiter">)</span> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.SetThrottleAck.type">SetThrottleAck</a>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stay" title="()ThrottledAssociation.this.State">stay</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span>Disassociated<span class="delimiter">(</span><a title="akka.remote.transport.AssociationHandle.DisassociateInfo" id="akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.isDefinedAt.info">info</a><span class="delimiter">)</span>, _<span class="delimiter">)</span> ⇒
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stop(65b4a2ce7c)" title="()ThrottledAssociation.this.State">stop</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span> <span class="comment">// not notifying the upstream handler is intentional: we are relying on heartbeating</span>
    <span class="keyword">case</span> Event<span class="delimiter">(</span>FailWith<span class="delimiter">(</span><a title="akka.remote.transport.AssociationHandle.DisassociateInfo" id="akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.isDefinedAt.reason">reason</a><span class="delimiter">)</span>, _<span class="delimiter">)</span> ⇒
      <a href="#akka.remote.transport;ThrottledAssociation.upstreamListener_=" title="=&gt; akka.remote.transport.AssociationHandle.HandleEventListener">upstreamListener</a> <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;HandleEventListener.notify(a3fa5b160e)" title="(ev: akka.remote.transport.AssociationHandle.HandleEvent)Unit">notify</a> <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;Disassociated" title="(info: akka.remote.transport.AssociationHandle.DisassociateInfo)akka.remote.transport.AssociationHandle.Disassociated">Disassociated</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.<local ThrottledAssociation>;$anonfun.isDefinedAt.reason" title="akka.remote.transport.AssociationHandle.DisassociateInfo">reason</a><span class="delimiter">)</span>
      <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.stop(65b4a2ce7c)" title="()ThrottledAssociation.this.State">stop</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">// This method captures ASSOCIATE packets and extracts the origin address</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(b: akka.util.ByteString)Option[akka.actor.Address]" id="akka.remote.transport;ThrottledAssociation.peekOrigin">peekOrigin</a><span class="delimiter">(</span><a title="akka.util.ByteString" id="akka.remote.transport;ThrottledAssociation.peekOrigin.b">b</a>: <a href="../../../akka-actor/util/ByteString.scala.html#akka.util;ByteString" title="akka.util.ByteString">ByteString</a><span class="delimiter">)</span>: <span title="Option[akka.actor.Address]">Option</span><span class="delimiter">[</span>Address<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="AkkaPduCodec.scala.html#akka.remote.transport.AkkaPduProtobufCodec" title="akka.remote.transport.AkkaPduProtobufCodec.type">AkkaPduProtobufCodec</a>.<a href="AkkaPduCodec.scala.html#akka.remote.transport.AkkaPduProtobufCodec.decodePdu" title="(raw: akka.util.ByteString)akka.remote.transport.AkkaPduCodec.AkkaPdu">decodePdu</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.peekOrigin.b" title="akka.util.ByteString">b</a><span class="delimiter">)</span> <span title="Option[akka.actor.Address]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Associate<span class="delimiter">(</span><a title="akka.remote.transport.HandshakeInfo" id="akka.remote.transport;ThrottledAssociation.peekOrigin.info">info</a><span class="delimiter">)</span> ⇒ <span title="(x: akka.actor.Address)Some[akka.actor.Address]">Some</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.peekOrigin.info" title="akka.remote.transport.HandshakeInfo">info</a>.<a href="AkkaProtocolTransport.scala.html#akka.remote.transport;HandshakeInfo.origin" title="=&gt; akka.actor.Address">origin</a><span class="delimiter">)</span>
        <span class="keyword">case</span> _               ⇒ <span title="None.type">None</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="comment">// This layer should not care about malformed packets. Also, this also useful for testing, because</span>
      <span class="comment">// arbitrary payload could be passed in</span>
      <span class="keyword">case</span> <a href="#akka.remote.transport;ThrottledAssociation.peekOrigin.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="akka.remote.transport;ThrottledAssociation.peekOrigin.e">e</a><span class="delimiter">)</span> ⇒ <span title="None.type">None</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(payload: akka.util.ByteString)Unit" id="akka.remote.transport;ThrottledAssociation.forwardOrDelay">forwardOrDelay</a><span class="delimiter">(</span><a title="akka.util.ByteString" id="akka.remote.transport;ThrottledAssociation.forwardOrDelay.payload">payload</a>: <a href="../../../akka-actor/util/ByteString.scala.html#akka.util;ByteString" title="akka.util.ByteString">ByteString</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">inboundThrottleMode</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Blackhole.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.type">Blackhole</a><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span>
      <span class="comment">// Do nothing</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Int" id="akka.remote.transport;ThrottledAssociation.forwardOrDelay.tokens">tokens</a> = <a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.payload" title="akka.util.ByteString">payload</a>.<span title="=&gt; Int">length</span>
        <span class="keyword">val</span> <a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.newbucket" title="(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)" class="delimiter">(</a><a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.x$5" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottledAssociation.forwardOrDelay.newbucket">newbucket</a>, <a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.x$5" title="Boolean" id="akka.remote.transport;ThrottledAssociation.forwardOrDelay.success">success</a><span class="delimiter">)</span> = <a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">inboundThrottleMode</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.tryConsumeTokens" title="(nanoTimeOfSend: Long, tokens: Int)(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)">tryConsumeTokens</a><span title="(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean) @unchecked" class="delimiter">(</span><span title="System.type">System</span>.<span title="()Long">nanoTime</span><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.tokens" title="Int">tokens</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.success" title="Boolean">success</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="(x$1: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Unit">inboundThrottleMode</a> = <a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.newbucket" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">newbucket</a>
          <a href="#akka.remote.transport;ThrottledAssociation.upstreamListener_=" title="=&gt; akka.remote.transport.AssociationHandle.HandleEventListener">upstreamListener</a> <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;HandleEventListener.notify(a3fa5b160e)" title="(ev: akka.remote.transport.AssociationHandle.HandleEvent)Unit">notify</a> <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;InboundPayload" title="(payload: akka.util.ByteString)akka.remote.transport.AssociationHandle.InboundPayload">InboundPayload</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.payload" title="akka.util.ByteString">payload</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="(x$1: scala.collection.immutable.Queue[akka.util.ByteString])Unit">throttledMessages</a> = <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a>.<span title="(elem: akka.util.ByteString)scala.collection.immutable.Queue[akka.util.ByteString]">enqueue</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.payload" title="akka.util.ByteString">payload</a><span class="delimiter">)</span>
          <a href="#akka.remote.transport;ThrottledAssociation.scheduleDequeue" title="(delay: scala.concurrent.duration.FiniteDuration)Unit">scheduleDequeue</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">inboundThrottleMode</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.timeToAvailable" title="(currentNanoTime: Long, tokens: Int)scala.concurrent.duration.FiniteDuration">timeToAvailable</a><span class="delimiter">(</span><span title="System.type">System</span>.<span title="()Long">nanoTime</span><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.tokens" title="Int">tokens</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="(x$1: scala.collection.immutable.Queue[akka.util.ByteString])Unit">throttledMessages</a> = <a href="#akka.remote.transport;ThrottledAssociation.throttledMessages_=" title="=&gt; scala.collection.immutable.Queue[akka.util.ByteString]">throttledMessages</a>.<span title="(elem: akka.util.ByteString)scala.collection.immutable.Queue[akka.util.ByteString]">enqueue</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottledAssociation.forwardOrDelay.payload" title="akka.util.ByteString">payload</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(delay: scala.concurrent.duration.FiniteDuration)Unit" id="akka.remote.transport;ThrottledAssociation.scheduleDequeue">scheduleDequeue</a><span class="delimiter">(</span><a title="scala.concurrent.duration.FiniteDuration" id="akka.remote.transport;ThrottledAssociation.scheduleDequeue.delay">delay</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.remote.transport;ThrottledAssociation.inboundThrottleMode_=" title="=&gt; akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">inboundThrottleMode</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Blackhole.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.type">Blackhole</a>                   ⇒ <span class="comment">// Do nothing</span>
    <span class="keyword">case</span> _ <span class="keyword">if</span> <a href="#akka.remote.transport;ThrottledAssociation.scheduleDequeue.delay" title="scala.concurrent.duration.FiniteDuration">delay</a> <span title="(that: scala.concurrent.duration.Duration)Boolean">&lt;=</span> <span title="scala.concurrent.duration.Duration.type">Duration</span>.<span title="=&gt; scala.concurrent.duration.FiniteDuration">Zero</span> ⇒ <a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.remote.transport.ThrottledAssociation.Dequeue.readResolve" title="akka.remote.transport.ThrottledAssociation.Dequeue.type">Dequeue</a>
    <span class="keyword">case</span> _                           ⇒ <a href="../../../akka-actor/actor/FSM.scala.html#akka.actor;FSM.setTimer" title="(name: String, msg: Any, timeout: scala.concurrent.duration.FiniteDuration, repeat: Boolean)Unit">setTimer</a><span class="delimiter">(</span><span title="String(&quot;dequeue&quot;)">DequeueTimerName</span>, <a href="#akka.remote.transport.ThrottledAssociation.Dequeue.readResolve" title="akka.remote.transport.ThrottledAssociation.Dequeue.type">Dequeue</a>, <a href="#akka.remote.transport;ThrottledAssociation.scheduleDequeue.delay" title="scala.concurrent.duration.FiniteDuration">delay</a>, repeat = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>transport<span class="delimiter">]</span> <span class="keyword">case class</span> <a title="class ThrottlerHandle extends akka.remote.transport.AbstractTransportAdapterHandle with Product with Serializable" id="akka.remote.transport.ThrottlerHandle.readResolve">ThrottlerHandle</a><a href="AbstractTransportAdapter.scala.html#akka.remote.transport;AbstractTransportAdapterHandle.<init>(cfb8773fb8)" title="Product" class="delimiter">(</a><a title="akka.remote.transport.AssociationHandle" id="akka.remote.transport;ThrottlerHandle._wrappedHandle">_wrappedHandle</a>: <a href="Transport.scala.html#akka.remote.transport;AssociationHandle" title="akka.remote.transport.AssociationHandle">AssociationHandle</a>, <a title="akka.actor.ActorRef" id="akka.remote.transport;ThrottlerHandle.throttlerActor">throttlerActor</a>: <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;AbstractTransportAdapterHandle" title="akka.remote.transport.AbstractTransportAdapterHandle">AbstractTransportAdapterHandle</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerHandle._wrappedHandle" title="akka.remote.transport.AssociationHandle">_wrappedHandle</a>, <a href="#akka.remote.transport.ThrottlerTransportAdapter.SchemeIdentifier" title="=&gt; String">SchemeIdentifier</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">private</span><span class="delimiter">[</span>transport<span class="delimiter">]</span> <span class="keyword">val</span> <a title="java.util.concurrent.atomic.AtomicReference[akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode]" id="akka.remote.transport;ThrottlerHandle.outboundThrottleMode">outboundThrottleMode</a> = <span title="java.util.concurrent.atomic.AtomicReference[akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode]" class="keyword">new</span> <span title="java.util.concurrent.atomic.AtomicReference[akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode]">AtomicReference</span><span class="delimiter">[</span>ThrottleMode<span class="delimiter">]</span><span class="delimiter">(</span><a href="#akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Unthrottled.type">Unthrottled</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">val</span> <a title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]" id="akka.remote.transport;ThrottlerHandle.readHandlerPromise">readHandlerPromise</a>: <span title="scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">Promise</span><span class="delimiter">[</span>HandleEventListener<span class="delimiter">]</span> = <span title="()scala.concurrent.Promise[akka.remote.transport.AssociationHandle.HandleEventListener]">Promise</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(payload: akka.util.ByteString)Boolean" id="akka.remote.transport;ThrottlerHandle.write">write</a><span class="delimiter">(</span><a title="akka.util.ByteString" id="akka.remote.transport;ThrottlerHandle.write.payload">payload</a>: <a href="../../../akka-actor/util/ByteString.scala.html#akka.util;ByteString" title="akka.util.ByteString">ByteString</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="akka.remote.transport;ThrottlerHandle.write.tokens">tokens</a> = <a href="#akka.remote.transport;ThrottlerHandle.write.payload" title="akka.util.ByteString">payload</a>.<span title="=&gt; Int">length</span>

    @tailrec <span class="keyword">def</span> <a title="(currentBucket: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Boolean" id="akka.remote.transport;ThrottlerHandle.write.tryConsume">tryConsume</a><span class="delimiter">(</span><a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerHandle.write.tryConsume.currentBucket">currentBucket</a>: <a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">ThrottleMode</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Long" id="akka.remote.transport;ThrottlerHandle.write.tryConsume.timeOfSend">timeOfSend</a> = <span title="System.type">System</span>.<span title="()Long">nanoTime</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a href="#akka.remote.transport;ThrottlerHandle.write.tryConsume.newBucket" title="(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)" class="delimiter">(</a><a href="#akka.remote.transport;ThrottlerHandle.write.tryConsume.x$6" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerHandle.write.tryConsume.newBucket">newBucket</a>, <a href="#akka.remote.transport;ThrottlerHandle.write.tryConsume.x$6" title="Boolean" id="akka.remote.transport;ThrottlerHandle.write.tryConsume.allow">allow</a><span class="delimiter">)</span> = <a href="#akka.remote.transport;ThrottlerHandle.write.tryConsume.currentBucket" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">currentBucket</a>.<a href="#akka.remote.transport.ThrottlerTransportAdapter;ThrottleMode.tryConsumeTokens" title="(nanoTimeOfSend: Long, tokens: Int)(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean)">tryConsumeTokens</a><span title="(akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, Boolean) @unchecked" class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerHandle.write.tryConsume.timeOfSend" title="Long">timeOfSend</a>, <a href="#akka.remote.transport;ThrottlerHandle.write.tokens" title="Int">tokens</a><span class="delimiter">)</span>
      <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerHandle.write.tryConsume.allow" title="Boolean">allow</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerHandle.outboundThrottleMode" title="=&gt; java.util.concurrent.atomic.AtomicReference[akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode]">outboundThrottleMode</a>.<span title="(x$1: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode, x$2: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Boolean">compareAndSet</span><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerHandle.write.tryConsume.currentBucket" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">currentBucket</a>, <a href="#akka.remote.transport;ThrottlerHandle.write.tryConsume.newBucket" title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">newBucket</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Boolean(true)" class="keyword">true</span>
        <span class="keyword">else</span> <a href="#akka.remote.transport;ThrottlerHandle.write.tryConsume" title="(currentBucket: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Boolean">tryConsume</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerHandle.outboundThrottleMode" title="=&gt; java.util.concurrent.atomic.AtomicReference[akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode]">outboundThrottleMode</a>.<span title="()akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">get</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span>

    <a href="#akka.remote.transport;ThrottlerHandle.outboundThrottleMode" title="=&gt; java.util.concurrent.atomic.AtomicReference[akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode]">outboundThrottleMode</a>.<span title="()akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">get</span> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#akka.remote.transport.ThrottlerTransportAdapter.Blackhole.readResolve" title="akka.remote.transport.ThrottlerTransportAdapter.Blackhole.type">Blackhole</a> ⇒ <span title="Boolean(true)" class="keyword">true</span>
      <span class="keyword">case</span> <a title="akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode" id="akka.remote.transport;ThrottlerHandle.write.bucket">bucket</a> @ _ ⇒
        <span class="keyword">val</span> <a title="Boolean" id="akka.remote.transport;ThrottlerHandle.write.success">success</a> = <a href="#akka.remote.transport;ThrottlerHandle.write.tryConsume" title="(currentBucket: akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode)Boolean">tryConsume</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerHandle.outboundThrottleMode" title="=&gt; java.util.concurrent.atomic.AtomicReference[akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode]">outboundThrottleMode</a>.<span title="()akka.remote.transport.ThrottlerTransportAdapter.ThrottleMode">get</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerHandle.write.success" title="Boolean">success</a><span class="delimiter">)</span> <a href="AbstractTransportAdapter.scala.html#akka.remote.transport;AbstractTransportAdapterHandle.wrappedHandle" title="=&gt; akka.remote.transport.AssociationHandle">wrappedHandle</a>.<a href="Transport.scala.html#akka.remote.transport;AssociationHandle.write" title="(payload: akka.util.ByteString)Boolean">write</a><span class="delimiter">(</span><a href="#akka.remote.transport;ThrottlerHandle.write.payload" title="akka.util.ByteString">payload</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
      <span class="comment">// FIXME: this depletes the token bucket even when no write happened!! See #2825</span>
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="akka.remote.transport;ThrottlerHandle.disassociate">disassociate</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="akka.actor.ScalaActorRef" id="akka.remote.transport;ThrottlerHandle.disassociate.qual$1">throttlerActor</a> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!$default$2" title="akka.actor.ActorRef" id="akka.remote.transport;ThrottlerHandle.disassociate.x$12">!</a> <a href="../../../akka-actor/actor/Actor.scala.html#akka.actor.PoisonPill" title="akka.actor.PoisonPill.type" id="akka.remote.transport;ThrottlerHandle.disassociate.x$11">PoisonPill</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(reason: akka.remote.transport.AssociationHandle.DisassociateInfo)Unit" id="akka.remote.transport;ThrottlerHandle.disassociateWithFailure">disassociateWithFailure</a><span class="delimiter">(</span><a title="akka.remote.transport.AssociationHandle.DisassociateInfo" id="akka.remote.transport;ThrottlerHandle.disassociateWithFailure.reason">reason</a>: <a href="Transport.scala.html#akka.remote.transport.AssociationHandle;DisassociateInfo" title="akka.remote.transport.AssociationHandle.DisassociateInfo">DisassociateInfo</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="../../../akka-actor/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="akka.actor.ScalaActorRef" id="akka.remote.transport;ThrottlerHandle.disassociateWithFailure.qual$2">throttlerActor</a> <a href="../../../akka-actor/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!$default$2" title="akka.actor.ActorRef" id="akka.remote.transport;ThrottlerHandle.disassociateWithFailure.x$14">!</a> <a href="#akka.remote.transport.ThrottledAssociation" title="akka.remote.transport.ThrottledAssociation.type">ThrottledAssociation</a>.<a href="#akka.remote.transport.ThrottledAssociation.FailWith.readResolve" title="(reason: akka.remote.transport.AssociationHandle.DisassociateInfo)akka.remote.transport.ThrottledAssociation.FailWith">FailWith</a><a title="akka.remote.transport.ThrottledAssociation.FailWith" id="akka.remote.transport;ThrottlerHandle.disassociateWithFailure.x$13" class="delimiter">(</a><a href="#akka.remote.transport;ThrottlerHandle.disassociateWithFailure.reason" title="akka.remote.transport.AssociationHandle.DisassociateInfo">reason</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>akka-actor/actor/dungeon/Dispatch.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>

<span class="keyword">package</span> akka.actor.dungeon

<span class="keyword">import</span> scala.annotation.tailrec
<span class="keyword">import</span> akka.dispatch.<span class="delimiter">{</span> MessageDispatcher, Mailbox, Envelope <span class="delimiter">}</span>
<span class="keyword">import</span> akka.dispatch.sysmsg._
<span class="keyword">import</span> akka.event.<a href="../../event/Logging.scala.html#akka.event.Logging" title="akka.event.Logging.type">Logging</a>.Error
<span class="keyword">import</span> akka.util.Unsafe
<span class="keyword">import</span> akka.actor._
<span class="keyword">import</span> akka.serialization.SerializationExtension
<span class="keyword">import</span> scala.util.control.NonFatal
<span class="keyword">import</span> scala.util.control.<span title="scala.util.control.Exception.type">Exception</span>.Catcher
<span class="keyword">import</span> akka.dispatch.MailboxType
<span class="keyword">import</span> akka.dispatch.ProducesMessageQueue

<span class="keyword">private</span><span class="delimiter">[</span>akka<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait Dispatch extends AnyRef" id="akka.actor.dungeon;Dispatch">Dispatch</a> <span title="Unit" class="delimiter">{</span> <span class="keyword">this</span>: ActorCell ⇒

  @volatile <span class="keyword">private</span> <span class="keyword">var</span> <a title="akka.dispatch.Mailbox" id="akka.actor.dungeon;Dispatch._mailboxDoNotCallMeDirectly_=">_mailboxDoNotCallMeDirectly</a>: <a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox" title="akka.dispatch.Mailbox">Mailbox</a> = _ <span class="comment">//This must be volatile since it isn't protected by the mailbox status</span>

  @inline <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; akka.dispatch.Mailbox" id="akka.actor.dungeon;Dispatch.mailbox">mailbox</a>: <a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox" title="akka.dispatch.Mailbox">Mailbox</a> = <a href="../../util/Unsafe.java.html#akka.util.Unsafe" title="akka.util.Unsafe.type">Unsafe</a>.<a href="../../util/Unsafe.java.html#akka.util.Unsafe.instance" title="sun.misc.Unsafe">instance</a>.<span title="(x$1: Any, x$2: Long)Object">getObjectVolatile</span><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a>, <span title="akka.actor.dungeon.AbstractActorCell.type">AbstractActorCell</span>.<span title="Long">mailboxOffset</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.dispatch.Mailbox" class="delimiter">[</span><a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox" title="akka.dispatch.Mailbox">Mailbox</a><span class="delimiter">]</span>

  @tailrec <span class="keyword">final</span> <span class="keyword">def</span> <a title="(newMailbox: akka.dispatch.Mailbox)akka.dispatch.Mailbox" id="akka.actor.dungeon;Dispatch.swapMailbox">swapMailbox</a><span class="delimiter">(</span><a title="akka.dispatch.Mailbox" id="akka.actor.dungeon;Dispatch.swapMailbox.newMailbox">newMailbox</a>: <a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox" title="akka.dispatch.Mailbox">Mailbox</a><span class="delimiter">)</span>: <a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox" title="akka.dispatch.Mailbox">Mailbox</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="akka.dispatch.Mailbox" id="akka.actor.dungeon;Dispatch.swapMailbox.oldMailbox">oldMailbox</a> = <a href="#akka.actor.dungeon;Dispatch.mailbox" title="=&gt; akka.dispatch.Mailbox">mailbox</a>
    <span title="akka.dispatch.Mailbox" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="../../util/Unsafe.java.html#akka.util.Unsafe" title="akka.util.Unsafe.type">Unsafe</a>.<a href="../../util/Unsafe.java.html#akka.util.Unsafe.instance" title="sun.misc.Unsafe">instance</a>.<span title="(x$1: Any, x$2: Long, x$3: Any, x$4: Any)Boolean">compareAndSwapObject</span><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a>, <span title="akka.actor.dungeon.AbstractActorCell.type">AbstractActorCell</span>.<span title="Long">mailboxOffset</span>, <a href="#akka.actor.dungeon;Dispatch.swapMailbox.oldMailbox" title="akka.dispatch.Mailbox">oldMailbox</a>, <a href="#akka.actor.dungeon;Dispatch.swapMailbox.newMailbox" title="akka.dispatch.Mailbox">newMailbox</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#akka.actor.dungeon;Dispatch.swapMailbox" title="(newMailbox: akka.dispatch.Mailbox)akka.dispatch.Mailbox">swapMailbox</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.swapMailbox.newMailbox" title="akka.dispatch.Mailbox">newMailbox</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#akka.actor.dungeon;Dispatch.swapMailbox.oldMailbox" title="akka.dispatch.Mailbox">oldMailbox</a>
  <span class="delimiter">}</span>

  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="akka.actor.dungeon;Dispatch.hasMessages">hasMessages</a>: <span title="Boolean">Boolean</span> = <a href="#akka.actor.dungeon;Dispatch.mailbox" title="=&gt; akka.dispatch.Mailbox">mailbox</a>.<a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox.hasMessages" title="=&gt; Boolean">hasMessages</a>

  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="akka.actor.dungeon;Dispatch.numberOfMessages">numberOfMessages</a>: <span title="Int">Int</span> = <a href="#akka.actor.dungeon;Dispatch.mailbox" title="=&gt; akka.dispatch.Mailbox">mailbox</a>.<a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox.numberOfMessages" title="=&gt; Int">numberOfMessages</a>

  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="akka.actor.dungeon;Dispatch.isTerminated">isTerminated</a>: <span title="Boolean">Boolean</span> = <a href="#akka.actor.dungeon;Dispatch.mailbox" title="=&gt; akka.dispatch.Mailbox">mailbox</a>.<a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox.isClosed" title="=&gt; Boolean">isClosed</a>

  <span class="comment">/**
   * Initialize this cell, i.e. set up mailboxes and supervision. The UID must be
   * reasonably different from the previous UID of a possible actor with the same path,
   * which can be achieved by using ThreadLocalRandom.current.nextInt().
   */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(sendSupervise: Boolean, mailboxType: akka.dispatch.MailboxType)Dispatch.this.type" id="akka.actor.dungeon;Dispatch.init">init</a><span class="delimiter">(</span><a title="Boolean" id="akka.actor.dungeon;Dispatch.init.sendSupervise">sendSupervise</a>: <span title="Boolean">Boolean</span>, <a title="akka.dispatch.MailboxType" id="akka.actor.dungeon;Dispatch.init.mailboxType">mailboxType</a>: <a href="../../dispatch/Mailbox.scala.html#akka.dispatch;MailboxType" title="akka.dispatch.MailboxType">MailboxType</a><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <span class="comment">/*
     * Create the mailbox and enqueue the Create() message to ensure that
     * this is processed before anything else.
     */</span>
    <span class="keyword">val</span> <a title="akka.dispatch.Mailbox" id="akka.actor.dungeon;Dispatch.init.mbox">mbox</a> = <a href="../ActorCell.scala.html#akka.actor;ActorCell.dispatcher" title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</a>.<a href="../../dispatch/AbstractDispatcher.scala.html#akka.dispatch;MessageDispatcher.createMailbox" title="(actor: akka.actor.Cell, mailboxType: akka.dispatch.MailboxType)akka.dispatch.Mailbox">createMailbox</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a>, <a href="#akka.actor.dungeon;Dispatch.init.mailboxType" title="akka.dispatch.MailboxType">mailboxType</a><span class="delimiter">)</span>

    <span class="comment">/*
     * The mailboxType was calculated taking into account what the MailboxType
     * has promised to produce. If that was more than the default, then we need
     * to reverify here because the dispatcher may well have screwed it up.
     */</span>
    <span class="comment">// we need to delay the failure to the point of actor creation so we can handle</span>
    <span class="comment">// it properly in the normal way</span>
    <span class="keyword">val</span> <a title="Class[_ &lt;: akka.actor.Actor]" id="akka.actor.dungeon;Dispatch.init.actorClass">actorClass</a> = <a href="../ActorCell.scala.html#akka.actor;ActorCell.props" title="=&gt; akka.actor.Props">props</a>.<a href="../Props.scala.html#akka.actor;Props.actorClass" title="()Class[_ &lt;: akka.actor.Actor]">actorClass</a>
    <span class="keyword">val</span> <a title="akka.dispatch.sysmsg.Create" id="akka.actor.dungeon;Dispatch.init.createMessage">createMessage</a> = <a href="#akka.actor.dungeon;Dispatch.init.mailboxType" title="akka.dispatch.MailboxType">mailboxType</a> <span title="akka.dispatch.sysmsg.Create" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> _: <a href="../../dispatch/Mailbox.scala.html#akka.dispatch;ProducesMessageQueue" title="akka.dispatch.ProducesMessageQueue[_]">ProducesMessageQueue</a><span class="delimiter">[</span>_<span class="delimiter">]</span> <span class="keyword">if</span> <a href="../ActorCell.scala.html#akka.actor;ActorCell.system" title="=&gt; akka.actor.ActorSystemImpl">system</a>.<a href="../ActorSystem.scala.html#akka.actor;ActorSystemImpl.mailboxes" title="=&gt; akka.dispatch.Mailboxes">mailboxes</a>.<a href="../../dispatch/Mailboxes.scala.html#akka.dispatch;Mailboxes.hasRequiredType" title="(actorClass: Class[_ &lt;: akka.actor.Actor])Boolean">hasRequiredType</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.init.actorClass" title="Class[_ &lt;: akka.actor.Actor]">actorClass</a><span class="delimiter">)</span> ⇒
        <span class="keyword">val</span> <a title="Class[_]" id="akka.actor.dungeon;Dispatch.init.createMessage.req">req</a> = <a href="../ActorCell.scala.html#akka.actor;ActorCell.system" title="=&gt; akka.actor.ActorSystemImpl">system</a>.<a href="../ActorSystem.scala.html#akka.actor;ActorSystemImpl.mailboxes" title="=&gt; akka.dispatch.Mailboxes">mailboxes</a>.<a href="../../dispatch/Mailboxes.scala.html#akka.dispatch;Mailboxes.getRequiredType" title="(actorClass: Class[_ &lt;: akka.actor.Actor])Class[_]">getRequiredType</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.init.actorClass" title="Class[_ &lt;: akka.actor.Actor]">actorClass</a><span class="delimiter">)</span>
        <span title="akka.dispatch.sysmsg.Create" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.init.createMessage.req" title="Class[_]">req</a> <span title="(x$1: Any)Boolean">isInstance</span> <a href="#akka.actor.dungeon;Dispatch.init.mbox" title="akka.dispatch.Mailbox">mbox</a>.<a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox.messageQueue" title="=&gt; akka.dispatch.MessageQueue">messageQueue</a><span class="delimiter">)</span> <a href="../../dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Create" title="(failure: Option[akka.actor.ActorInitializationException])akka.dispatch.sysmsg.Create">Create</a><span class="delimiter">(</span><span title="None.type">None</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="String" id="akka.actor.dungeon;Dispatch.init.createMessage.gotType">gotType</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.init.mbox" title="akka.dispatch.Mailbox">mbox</a>.<a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox.messageQueue" title="=&gt; akka.dispatch.MessageQueue">messageQueue</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="String(&quot;null&quot;)" class="string">&quot;null&quot;</span> <span class="keyword">else</span> <a href="#akka.actor.dungeon;Dispatch.init.mbox" title="akka.dispatch.Mailbox">mbox</a>.<a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox.messageQueue" title="=&gt; akka.dispatch.MessageQueue">messageQueue</a>.<span title="()Class[_]">getClass</span>.<span title="()String">getName</span>
          <a href="../../dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Create" title="(failure: Option[akka.actor.ActorInitializationException])akka.dispatch.sysmsg.Create">Create</a><span class="delimiter">(</span><span title="(x: akka.actor.ActorInitializationException)Some[akka.actor.ActorInitializationException]">Some</span><span class="delimiter">(</span><a href="../Actor.scala.html#akka.actor.ActorInitializationException.apply(933b2725f8)" title="(actor: akka.actor.ActorRef, message: String, cause: Throwable)akka.actor.ActorInitializationException">ActorInitializationException</a><span class="delimiter">(</span><a href="../ActorCell.scala.html#akka.actor;ActorCell.self" title="=&gt; akka.actor.InternalActorRef">self</a>,
            <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Actor [&quot;)">Actor [$</span><a href="../ActorCell.scala.html#akka.actor;ActorCell.self" title="=&gt; akka.actor.InternalActorRef">self</a><span title="String(&quot;] requires mailbox type [&quot;)">] requires mailbox type [$</span><a href="#akka.actor.dungeon;Dispatch.init.createMessage.req" title="Class[_]">req</a><span title="String(&quot;] got [&quot;)">] got [$</span><a href="#akka.actor.dungeon;Dispatch.init.createMessage.gotType" title="String">gotType</a><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> _ ⇒ <a href="../../dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Create" title="(failure: Option[akka.actor.ActorInitializationException])akka.dispatch.sysmsg.Create">Create</a><span class="delimiter">(</span><span title="None.type">None</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="#akka.actor.dungeon;Dispatch.swapMailbox" title="(newMailbox: akka.dispatch.Mailbox)akka.dispatch.Mailbox">swapMailbox</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.init.mbox" title="akka.dispatch.Mailbox">mbox</a><span class="delimiter">)</span>
    <a href="#akka.actor.dungeon;Dispatch.mailbox" title="=&gt; akka.dispatch.Mailbox">mailbox</a>.<a href="../../dispatch/Mailbox.scala.html#akka.dispatch;Mailbox.setActor" title="(cell: akka.actor.ActorCell)Unit">setActor</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a><span class="delimiter">)</span>

    <span class="comment">// ➡➡➡ NEVER SEND THE SAME SYSTEM MESSAGE OBJECT TO TWO ACTORS ⬅⬅⬅</span>
    <a href="#akka.actor.dungeon;Dispatch.mailbox" title="=&gt; akka.dispatch.Mailbox">mailbox</a>.<a href="../../dispatch/Mailbox.scala.html#akka.dispatch;SystemMessageQueue.systemEnqueue" title="(receiver: akka.actor.ActorRef, message: akka.dispatch.sysmsg.SystemMessage)Unit">systemEnqueue</a><span class="delimiter">(</span><a href="../ActorCell.scala.html#akka.actor;ActorCell.self" title="=&gt; akka.actor.InternalActorRef">self</a>, <a href="#akka.actor.dungeon;Dispatch.init.createMessage" title="akka.dispatch.sysmsg.Create">createMessage</a><span class="delimiter">)</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.init.sendSupervise" title="Boolean">sendSupervise</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">// ➡➡➡ NEVER SEND THE SAME SYSTEM MESSAGE OBJECT TO TWO ACTORS ⬅⬅⬅</span>
      <a href="../ActorCell.scala.html#akka.actor;ActorCell.parent" title="=&gt; akka.actor.InternalActorRef">parent</a>.<a href="../ActorRef.scala.html#akka.actor;InternalActorRef.sendSystemMessage" title="(message: akka.dispatch.sysmsg.SystemMessage)Unit">sendSystemMessage</a><span class="delimiter">(</span>akka.dispatch.sysmsg.<a href="../../dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Supervise" title="(child: akka.actor.ActorRef, async: Boolean)akka.dispatch.sysmsg.Supervise">Supervise</a><span class="delimiter">(</span><a href="../ActorCell.scala.html#akka.actor;ActorCell.self" title="=&gt; akka.actor.InternalActorRef">self</a>, async = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#akka.actor.dungeon;Dispatch" title="Dispatch.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Start this cell, i.e. attach it to the dispatcher.
   */</span>
  <span class="keyword">def</span> <a title="()Dispatch.this.type" id="akka.actor.dungeon;Dispatch.start">start</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <span class="comment">// This call is expected to start off the actor by scheduling its mailbox.</span>
    <a href="../ActorCell.scala.html#akka.actor;ActorCell.dispatcher" title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</a>.<a href="../../dispatch/AbstractDispatcher.scala.html#akka.dispatch;MessageDispatcher.attach" title="(actor: akka.actor.ActorCell)Unit">attach</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a><span class="delimiter">)</span>
    <a href="#akka.actor.dungeon;Dispatch" title="Dispatch.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; util.control.Exception.Catcher[Unit]" id="akka.actor.dungeon;Dispatch.handleException">handleException</a>: <span title="util.control.Exception.Catcher[Unit]">Catcher</span><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Throwable,Unit] with Serializable" id="akka.actor.dungeon;Dispatch.handleException;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    <span class="keyword">case</span> <span title="InterruptedException">e</span>: <span title="InterruptedException">InterruptedException</span> ⇒
      <a href="../ActorCell.scala.html#akka.actor;ActorCell.system" title="=&gt; akka.actor.ActorSystemImpl">system</a>.<a href="../ActorSystem.scala.html#akka.actor;ActorSystemImpl.eventStream" title="=&gt; akka.event.EventStream">eventStream</a>.<a href="../../event/EventBus.scala.html#akka.event;SubchannelClassification.publish(de973626dc)" title="(event: Dispatch.this.system.eventStream.Event)Unit">publish</a><span class="delimiter">(</span><a href="../../event/Logging.scala.html#akka.event.Logging;Error" title="(cause: Throwable, logSource: String, logClass: Class[_], message: Any)akka.event.Logging.Error">Error</a><span class="delimiter">(</span><span title="InterruptedException">e</span>, <a href="../ActorCell.scala.html#akka.actor;ActorCell.self" title="=&gt; akka.actor.InternalActorRef">self</a>.<a href="../ActorRef.scala.html#akka.actor;ActorRef.path" title="=&gt; akka.actor.ActorPath">path</a>.<span title="()String">toString</span>, <a href="../ActorCell.scala.html#akka.actor;ActorCell.clazz" title="(o: AnyRef)Class[_]">clazz</a><span class="delimiter">(</span><a href="../ActorCell.scala.html#akka.actor;ActorCell.actor" title="=&gt; akka.actor.Actor">actor</a><span class="delimiter">)</span>, <span title="String(&quot;interrupted during message send&quot;)" class="string">&quot;interrupted during message send&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="Thread.type">Thread</span>.<span title="()Thread">currentThread</span>.<span title="()Unit">interrupt</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="#akka.actor.dungeon;Dispatch.handleException;$anonfun.applyOrElse.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><span title="Throwable">e</span><span class="delimiter">)</span> ⇒
      <a href="../ActorCell.scala.html#akka.actor;ActorCell.system" title="=&gt; akka.actor.ActorSystemImpl">system</a>.<a href="../ActorSystem.scala.html#akka.actor;ActorSystemImpl.eventStream" title="=&gt; akka.event.EventStream">eventStream</a>.<a href="../../event/EventBus.scala.html#akka.event;SubchannelClassification.publish(de973626dc)" title="(event: Dispatch.this.system.eventStream.Event)Unit">publish</a><span title="Boolean(true)" class="delimiter">(</span><a href="../../event/Logging.scala.html#akka.event.Logging;Error" title="(cause: Throwable, logSource: String, logClass: Class[_], message: Any)akka.event.Logging.Error">Error</a><span class="delimiter">(</span><span title="Throwable">e</span>, <a href="../ActorCell.scala.html#akka.actor;ActorCell.self" title="=&gt; akka.actor.InternalActorRef">self</a>.<a href="../ActorRef.scala.html#akka.actor;ActorRef.path" title="=&gt; akka.actor.ActorPath">path</a>.<span title="()String">toString</span>, <a href="../ActorCell.scala.html#akka.actor;ActorCell.clazz" title="(o: AnyRef)Class[_]">clazz</a><span class="delimiter">(</span><a href="../ActorCell.scala.html#akka.actor;ActorCell.actor" title="=&gt; akka.actor.Actor">actor</a><span class="delimiter">)</span>, <span title="String(&quot;swallowing exception during message send&quot;)" class="string">&quot;swallowing exception during message send&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">// ➡➡➡ NEVER SEND THE SAME SYSTEM MESSAGE OBJECT TO TWO ACTORS ⬅⬅⬅</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="()Unit" id="akka.actor.dungeon;Dispatch.suspend">suspend</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a title="Throwable" id="akka.actor.dungeon;Dispatch.suspend.x1" class="keyword">try</a> <a href="../ActorCell.scala.html#akka.actor;ActorCell.dispatcher" title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</a>.<a href="../../dispatch/AbstractDispatcher.scala.html#akka.dispatch;MessageDispatcher.systemDispatch" title="(receiver: akka.actor.ActorCell, invocation: akka.dispatch.sysmsg.SystemMessage)Unit">systemDispatch</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a>, <a href="../../dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Suspend" title="()akka.dispatch.sysmsg.Suspend">Suspend</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">catch</span> <a href="#akka.actor.dungeon;Dispatch.handleException" title="util.control.Exception.Catcher[Unit]" id="akka.actor.dungeon;Dispatch.suspend.catchExpr1">handleException</a>

  <span class="comment">// ➡➡➡ NEVER SEND THE SAME SYSTEM MESSAGE OBJECT TO TWO ACTORS ⬅⬅⬅</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(causedByFailure: Throwable)Unit" id="akka.actor.dungeon;Dispatch.resume">resume</a><span class="delimiter">(</span><a title="Throwable" id="akka.actor.dungeon;Dispatch.resume.causedByFailure">causedByFailure</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a title="Throwable" id="akka.actor.dungeon;Dispatch.resume.x2" class="keyword">try</a> <a href="../ActorCell.scala.html#akka.actor;ActorCell.dispatcher" title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</a>.<a href="../../dispatch/AbstractDispatcher.scala.html#akka.dispatch;MessageDispatcher.systemDispatch" title="(receiver: akka.actor.ActorCell, invocation: akka.dispatch.sysmsg.SystemMessage)Unit">systemDispatch</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a>, <a href="../../dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Resume" title="(causedByFailure: Throwable)akka.dispatch.sysmsg.Resume">Resume</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.resume.causedByFailure" title="Throwable">causedByFailure</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">catch</span> <a href="#akka.actor.dungeon;Dispatch.handleException" title="util.control.Exception.Catcher[Unit]" id="akka.actor.dungeon;Dispatch.resume.catchExpr2">handleException</a>

  <span class="comment">// ➡➡➡ NEVER SEND THE SAME SYSTEM MESSAGE OBJECT TO TWO ACTORS ⬅⬅⬅</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(cause: Throwable)Unit" id="akka.actor.dungeon;Dispatch.restart">restart</a><span class="delimiter">(</span><a title="Throwable" id="akka.actor.dungeon;Dispatch.restart.cause">cause</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a title="Throwable" id="akka.actor.dungeon;Dispatch.restart.x3" class="keyword">try</a> <a href="../ActorCell.scala.html#akka.actor;ActorCell.dispatcher" title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</a>.<a href="../../dispatch/AbstractDispatcher.scala.html#akka.dispatch;MessageDispatcher.systemDispatch" title="(receiver: akka.actor.ActorCell, invocation: akka.dispatch.sysmsg.SystemMessage)Unit">systemDispatch</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a>, <a href="../../dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Recreate" title="(cause: Throwable)akka.dispatch.sysmsg.Recreate">Recreate</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.restart.cause" title="Throwable">cause</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">catch</span> <a href="#akka.actor.dungeon;Dispatch.handleException" title="util.control.Exception.Catcher[Unit]" id="akka.actor.dungeon;Dispatch.restart.catchExpr3">handleException</a>

  <span class="comment">// ➡➡➡ NEVER SEND THE SAME SYSTEM MESSAGE OBJECT TO TWO ACTORS ⬅⬅⬅</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="()Unit" id="akka.actor.dungeon;Dispatch.stop">stop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a title="Throwable" id="akka.actor.dungeon;Dispatch.stop.x4" class="keyword">try</a> <a href="../ActorCell.scala.html#akka.actor;ActorCell.dispatcher" title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</a>.<a href="../../dispatch/AbstractDispatcher.scala.html#akka.dispatch;MessageDispatcher.systemDispatch" title="(receiver: akka.actor.ActorCell, invocation: akka.dispatch.sysmsg.SystemMessage)Unit">systemDispatch</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a>, <a href="../../dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;Terminate" title="()akka.dispatch.sysmsg.Terminate">Terminate</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">catch</span> <a href="#akka.actor.dungeon;Dispatch.handleException" title="util.control.Exception.Catcher[Unit]" id="akka.actor.dungeon;Dispatch.stop.catchExpr4">handleException</a>

  <span class="keyword">def</span> <a title="(msg: akka.dispatch.Envelope)Unit" id="akka.actor.dungeon;Dispatch.sendMessage">sendMessage</a><span class="delimiter">(</span><a title="akka.dispatch.Envelope" id="akka.actor.dungeon;Dispatch.sendMessage.msg">msg</a>: <a href="../../dispatch/AbstractDispatcher.scala.html#akka.dispatch;Envelope" title="akka.dispatch.Envelope">Envelope</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a title="Throwable" id="akka.actor.dungeon;Dispatch.sendMessage.x5" class="keyword">try</a> <span class="delimiter">{</span>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../ActorCell.scala.html#akka.actor;ActorCell.system" title="=&gt; akka.actor.ActorSystemImpl">system</a>.<a href="../ActorSystem.scala.html#akka.actor;ActorSystemImpl.settings" title="=&gt; akka.actor.ActorSystem.Settings">settings</a>.<a href="../ActorSystem.scala.html#akka.actor.ActorSystem;Settings.SerializeAllMessages" title="=&gt; Boolean">SerializeAllMessages</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="AnyRef" id="akka.actor.dungeon;Dispatch.sendMessage.unwrapped">unwrapped</a> = <span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.sendMessage.msg" title="akka.dispatch.Envelope">msg</a>.<a href="../../dispatch/AbstractDispatcher.scala.html#akka.dispatch;Envelope.message" title="=&gt; Any">message</a> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> DeadLetter<span class="delimiter">(</span><a title="Any" id="akka.actor.dungeon;Dispatch.sendMessage.unwrapped.wrapped">wrapped</a>, _, _<span class="delimiter">)</span> ⇒ <a href="#akka.actor.dungeon;Dispatch.sendMessage.unwrapped.wrapped" title="Any">wrapped</a>
          <span class="keyword">case</span> <a title="Any" id="akka.actor.dungeon;Dispatch.sendMessage.unwrapped.other">other</a>                     ⇒ <a href="#akka.actor.dungeon;Dispatch.sendMessage.unwrapped.other" title="Any">other</a>
        <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.actor.dungeon;Dispatch.sendMessage.unwrapped" title="AnyRef">unwrapped</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../Actor.scala.html#akka.actor;NoSerializationVerificationNeeded" title="akka.actor.NoSerializationVerificationNeeded">NoSerializationVerificationNeeded</a><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="akka.serialization.Serialization" id="akka.actor.dungeon;Dispatch.sendMessage.s">s</a> = <a href="../Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.serialization.Serialization">SerializationExtension</a><span class="delimiter">(</span><a href="../ActorCell.scala.html#akka.actor;ActorCell.system" title="=&gt; akka.actor.ActorSystemImpl">system</a><span class="delimiter">)</span>
          <a href="#akka.actor.dungeon;Dispatch.sendMessage.s" title="akka.serialization.Serialization">s</a>.<a href="../../serialization/Serialization.scala.html#akka.serialization;Serialization.deserialize(2392165273)" title="(bytes: Array[Byte], clazz: Class[?0])scala.util.Try[?0]">deserialize</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.sendMessage.s" title="akka.serialization.Serialization">s</a>.<a href="../../serialization/Serialization.scala.html#akka.serialization;Serialization.serialize" title="(o: AnyRef)scala.util.Try[Array[Byte]]">serialize</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch.sendMessage.unwrapped" title="AnyRef">unwrapped</a><span class="delimiter">)</span>.<span title="=&gt; Array[Byte]">get</span>, <a href="#akka.actor.dungeon;Dispatch.sendMessage.unwrapped" title="AnyRef">unwrapped</a>.<span title="()Class[_]">getClass</span><span class="delimiter">)</span>.<span title="=&gt; ?0">get</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <a href="../ActorCell.scala.html#akka.actor;ActorCell.dispatcher" title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</a>.<a href="../../dispatch/AbstractDispatcher.scala.html#akka.dispatch;MessageDispatcher.dispatch" title="(receiver: akka.actor.ActorCell, invocation: akka.dispatch.Envelope)Unit">dispatch</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a>, <a href="#akka.actor.dungeon;Dispatch.sendMessage.msg" title="akka.dispatch.Envelope">msg</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <a href="#akka.actor.dungeon;Dispatch.handleException" title="util.control.Exception.Catcher[Unit]" id="akka.actor.dungeon;Dispatch.sendMessage.catchExpr5">handleException</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(message: akka.dispatch.sysmsg.SystemMessage)Unit" id="akka.actor.dungeon;Dispatch.sendSystemMessage">sendSystemMessage</a><span class="delimiter">(</span><a title="akka.dispatch.sysmsg.SystemMessage" id="akka.actor.dungeon;Dispatch.sendSystemMessage.message">message</a>: <a href="../../dispatch/sysmsg/SystemMessage.scala.html#akka.dispatch.sysmsg;SystemMessage" title="akka.dispatch.sysmsg.SystemMessage">SystemMessage</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a title="Throwable" id="akka.actor.dungeon;Dispatch.sendSystemMessage.x6" class="keyword">try</a> <a href="../ActorCell.scala.html#akka.actor;ActorCell.dispatcher" title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</a>.<a href="../../dispatch/AbstractDispatcher.scala.html#akka.dispatch;MessageDispatcher.systemDispatch" title="(receiver: akka.actor.ActorCell, invocation: akka.dispatch.sysmsg.SystemMessage)Unit">systemDispatch</a><span class="delimiter">(</span><a href="#akka.actor.dungeon;Dispatch" title="akka.actor.ActorCell" class="keyword">this</a>, <a href="#akka.actor.dungeon;Dispatch.sendSystemMessage.message" title="akka.dispatch.sysmsg.SystemMessage">message</a><span class="delimiter">)</span> <span class="keyword">catch</span> <a href="#akka.actor.dungeon;Dispatch.handleException" title="util.control.Exception.Catcher[Unit]" id="akka.actor.dungeon;Dispatch.sendSystemMessage.catchExpr6">handleException</a>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>

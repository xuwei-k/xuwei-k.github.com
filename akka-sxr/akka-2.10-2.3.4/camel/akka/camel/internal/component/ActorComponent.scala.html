<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>camel/akka/camel/internal/component/ActorComponent.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>

<span class="keyword">package</span> akka.camel.internal.component

<span class="keyword">import</span> <span title="language.type">language</span>.postfixOps
<span class="keyword">import</span> java.util.<span class="delimiter">{</span> Map ⇒ JMap <span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.camel._
<span class="keyword">import</span> org.apache.camel.impl.<span class="delimiter">{</span> DefaultProducer, DefaultEndpoint, DefaultComponent <span class="delimiter">}</span>
<span class="keyword">import</span> akka.actor._
<span class="keyword">import</span> akka.pattern._
<span class="keyword">import</span> scala.beans.BeanProperty
<span class="keyword">import</span> scala.concurrent.duration._
<span class="keyword">import</span> scala.concurrent.<span class="delimiter">{</span> ExecutionContext, Future <span class="delimiter">}</span>
<span class="keyword">import</span> scala.util.control.NonFatal
<span class="keyword">import</span> java.util.concurrent.<span class="delimiter">{</span> TimeUnit, TimeoutException, CountDownLatch <span class="delimiter">}</span>
<span class="keyword">import</span> akka.util.Timeout
<span class="keyword">import</span> akka.camel.internal.CamelExchangeAdapter
<span class="keyword">import</span> akka.camel.<span class="delimiter">{</span> ActorNotRegisteredException, Camel, Ack, FailureResult, CamelMessage <span class="delimiter">}</span>
<span class="keyword">import</span> support.TypeConverterSupport
<span class="keyword">import</span> scala.util.<span class="delimiter">{</span> Failure, Success, Try <span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 * Creates Camel [[org.apache.camel.Endpoint]]s that send messages to [[akka.camel.Consumer]] actors through an [[akka.camel.internal.component.ActorProducer]].
 * The `ActorComponent` is a Camel [[org.apache.camel.Component]].
 *
 * Camel integrates with Akka through this component. The [[akka.camel.internal.DefaultCamel]] module adds the
 * `ActorComponent` to the [[org.apache.camel.CamelContext]] under the 'actor' component name.
 * Messages are sent to [[akka.camel.Consumer]] actors through a [[akka.camel.internal.component.ActorEndpoint]] that
 * this component provides.
 *
 *
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>camel<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class ActorComponent extends org.apache.camel.impl.DefaultComponent" id="akka.camel.internal.component;ActorComponent">ActorComponent</a><a href="#akka.camel.internal.component;ActorComponent" title="akka.camel.internal.component.ActorComponent" class="delimiter">(</a><a title="akka.camel.Camel" id="akka.camel.internal.component;ActorComponent.camel">camel</a>: <a href="../../Camel.scala.html#akka.camel;Camel" title="akka.camel.Camel">Camel</a>, <a title="akka.actor.ActorSystem" id="akka.camel.internal.component;ActorComponent.system">system</a>: <a href="../../../../../actor/akka/actor/ActorSystem.scala.html#akka.actor;ActorSystem" title="akka.actor.ActorSystem">ActorSystem</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="org.apache.camel.impl.DefaultComponent">DefaultComponent</span> <span class="delimiter">{</span>
  <span class="comment">/**
   * @see org.apache.camel.Component
   */</span>
  <span class="keyword">def</span> <a title="(uri: String, remaining: String, parameters: java.util.Map[String,Object])akka.camel.internal.component.ActorEndpoint" id="akka.camel.internal.component;ActorComponent.createEndpoint(b285a62f82)">createEndpoint</a><span class="delimiter">(</span><a title="String" id="akka.camel.internal.component;ActorComponent.createEndpoint(b285a62f82).uri">uri</a>: <span title="String">String</span>, <a title="String" id="akka.camel.internal.component;ActorComponent.createEndpoint(b285a62f82).remaining">remaining</a>: <span title="String">String</span>, <a title="java.util.Map[String,Object]" id="akka.camel.internal.component;ActorComponent.createEndpoint(b285a62f82).parameters">parameters</a>: <span title="java.util.Map[String,Object]">JMap</span><span class="delimiter">[</span>String, Object<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#akka.camel.internal.component;ActorEndpoint" title="akka.camel.internal.component.ActorEndpoint">ActorEndpoint</a> =
    <span title="akka.camel.internal.component.ActorEndpoint" class="keyword">new</span> <a href="#akka.camel.internal.component;ActorEndpoint" title="akka.camel.internal.component.ActorEndpoint">ActorEndpoint</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorComponent.createEndpoint(b285a62f82).uri" title="String">uri</a>, <a href="#akka.camel.internal.component;ActorComponent" title="akka.camel.internal.component.ActorComponent" class="keyword">this</a>, <a href="#akka.camel.internal.component.ActorEndpointPath.readResolve" title="akka.camel.internal.component.ActorEndpointPath.type">ActorEndpointPath</a>.<a href="#akka.camel.internal.component.ActorEndpointPath.fromCamelPath" title="(camelPath: String)akka.camel.internal.component.ActorEndpointPath">fromCamelPath</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorComponent.createEndpoint(b285a62f82).uri" title="String">uri</a><span class="delimiter">)</span>, <a href="#akka.camel.internal.component;ActorComponent.camel" title="akka.camel.Camel">camel</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 * Does what an endpoint does, creates consumers and producers for the component. The `ActorEndpoint` is a Camel [[org.apache.camel.Endpoint]] that is used to
 * receive messages from Camel. Sending messages from the `ActorComponent` is not supported, a [[akka.camel.Producer]] actor should be used instead.
 *
 * The `ActorEndpoint`s are created by the [[akka.camel.internal.component.ActorComponent]].
 *
 * Actors are referenced using actor endpoint URIs of the following format:
 * &lt;code&gt;[actorPath]?[options]%s&lt;/code&gt;,
 * where &lt;code&gt;[actorPath]&lt;/code&gt; refers to the actor path to the actor.
 *
 *
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>camel<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class ActorEndpoint extends org.apache.camel.impl.DefaultEndpoint with akka.camel.internal.component.ActorEndpointConfig" id="akka.camel.internal.component;ActorEndpoint">ActorEndpoint</a><a href="#akka.camel.internal.component;ActorEndpoint" title="akka.camel.internal.component.ActorEndpoint" class="delimiter">(</a><a title="String" id="akka.camel.internal.component;ActorEndpoint.uri">uri</a>: <span title="String">String</span>,
                                   <a title="akka.camel.internal.component.ActorComponent" id="akka.camel.internal.component;ActorEndpoint.comp">comp</a>: <a href="#akka.camel.internal.component;ActorComponent" title="akka.camel.internal.component.ActorComponent">ActorComponent</a>,
                                   <span class="keyword">val</span> <a title="akka.camel.internal.component.ActorEndpointPath" id="akka.camel.internal.component;ActorEndpoint.path">path</a>: <a href="#akka.camel.internal.component;ActorEndpointPath" title="akka.camel.internal.component.ActorEndpointPath">ActorEndpointPath</a>,
                                   <span class="keyword">val</span> <a title="akka.camel.Camel" id="akka.camel.internal.component;ActorEndpoint.camel">camel</a>: <a href="../../Camel.scala.html#akka.camel;Camel" title="akka.camel.Camel">Camel</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="org.apache.camel.impl.DefaultEndpoint">DefaultEndpoint</span><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorEndpoint.uri" title="String">uri</a>, <a href="#akka.camel.internal.component;ActorEndpoint.comp" title="akka.camel.internal.component.ActorComponent">comp</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#akka.camel.internal.component;ActorEndpointConfig" title="akka.camel.internal.component.ActorEndpointConfig">ActorEndpointConfig</a> <span class="delimiter">{</span>

  <span class="comment">/**
   * The ActorEndpoint only supports receiving messages from Camel.
   * The createProducer method (not to be confused with a producer actor) is used to send messages into the endpoint.
   * The ActorComponent is only there to send to actors registered through an actor endpoint URI.
   * You can use an actor as an endpoint to send to in a camel route (as in, a Camel Consumer Actor). so from(someuri) to (actoruri), but not 'the other way around'.
   * Supporting createConsumer would mean that messages are consumed from an Actor endpoint in a route, and an Actor is not necessarily a producer of messages.
   * [[akka.camel.Producer]] Actors can be used for sending messages to some other uri/ component type registered in Camel.
   * @throws UnsupportedOperationException this method is not supported
   */</span>
  <span class="keyword">def</span> <a title="(processor: org.apache.camel.Processor)org.apache.camel.Consumer" id="akka.camel.internal.component;ActorEndpoint.createConsumer">createConsumer</a><span class="delimiter">(</span><a title="org.apache.camel.Processor" id="akka.camel.internal.component;ActorEndpoint.createConsumer.processor">processor</a>: <span title="org.apache.camel.Processor">Processor</span><span class="delimiter">)</span>: org.apache.camel.<span title="org.apache.camel.Consumer">Consumer</span> =
    <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)UnsupportedOperationException" class="keyword">new</span> <span title="UnsupportedOperationException">UnsupportedOperationException</span><span class="delimiter">(</span><span title="String(&quot;actor consumer not supported yet&quot;)" class="string">&quot;actor consumer not supported yet&quot;</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Creates a new producer which is used send messages into the endpoint.
   *
   * @return a newly created producer
   */</span>
  <span class="keyword">def</span> <a title="()akka.camel.internal.component.ActorProducer" id="akka.camel.internal.component;ActorEndpoint.createProducer">createProducer</a>: <a href="#akka.camel.internal.component;ActorProducer" title="akka.camel.internal.component.ActorProducer">ActorProducer</a> = <span title="akka.camel.internal.component.ActorProducer" class="keyword">new</span> <a href="#akka.camel.internal.component;ActorProducer" title="akka.camel.internal.component.ActorProducer">ActorProducer</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorEndpoint" title="akka.camel.internal.component.ActorEndpoint" class="keyword">this</a>, <a href="#akka.camel.internal.component;ActorEndpoint.camel" title="=&gt; akka.camel.Camel">camel</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns true.
   */</span>
  <span class="keyword">def</span> <a title="()Boolean" id="akka.camel.internal.component;ActorEndpoint.isSingleton">isSingleton</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 * Configures the `ActorEndpoint`. This needs to be a `bean` for Camel purposes.
 *
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>camel<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait ActorEndpointConfig extends AnyRef" id="akka.camel.internal.component;ActorEndpointConfig">ActorEndpointConfig</a> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; akka.camel.internal.component.ActorEndpointPath" id="akka.camel.internal.component;ActorEndpointConfig.path">path</a>: <a href="#akka.camel.internal.component;ActorEndpointPath" title="akka.camel.internal.component.ActorEndpointPath">ActorEndpointPath</a>
  <span class="keyword">def</span> <a title="=&gt; akka.camel.Camel" id="akka.camel.internal.component;ActorEndpointConfig.camel">camel</a>: <a href="../../Camel.scala.html#akka.camel;Camel" title="akka.camel.Camel">Camel</a>

  @BeanProperty <span class="keyword">var</span> <a title="scala.concurrent.duration.FiniteDuration" id="akka.camel.internal.component;ActorEndpointConfig.getReplyTimeout">replyTimeout</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span> = <a href="#akka.camel.internal.component;ActorEndpointConfig.camel" title="=&gt; akka.camel.Camel">camel</a>.<a href="../../Camel.scala.html#akka.camel;Camel.settings" title="=&gt; akka.camel.CamelSettings">settings</a>.<a href="../../Camel.scala.html#akka.camel;CamelSettings.ReplyTimeout" title="=&gt; scala.concurrent.duration.FiniteDuration">ReplyTimeout</a>

  @BeanProperty <span class="keyword">var</span> <a title="Boolean" id="akka.camel.internal.component;ActorEndpointConfig.getAutoAck">autoAck</a>: <span title="Boolean">Boolean</span> = <a href="#akka.camel.internal.component;ActorEndpointConfig.camel" title="=&gt; akka.camel.Camel">camel</a>.<a href="../../Camel.scala.html#akka.camel;Camel.settings" title="=&gt; akka.camel.CamelSettings">settings</a>.<a href="../../Camel.scala.html#akka.camel;CamelSettings.AutoAck" title="=&gt; Boolean">AutoAck</a>
<span class="delimiter">}</span>

<span class="comment">/**
 * Sends the in-message of an exchange to an untyped actor, identified by an [[akka.camel.internal.component.ActorEndPoint]]
 *
 * @see akka.camel.component.ActorComponent
 * @see akka.camel.component.ActorEndpoint
 *
 *
 */</span>
<span title="AnyRef" class="keyword">private</span><span class="delimiter">[</span>camel<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class ActorProducer extends org.apache.camel.impl.DefaultProducer with org.apache.camel.AsyncProcessor" id="akka.camel.internal.component;ActorProducer">ActorProducer</a><a href="#akka.camel.internal.component;ActorProducer" title="akka.camel.internal.component.ActorProducer" class="delimiter">(</a><span class="keyword">val</span> <a title="akka.camel.internal.component.ActorEndpoint" id="akka.camel.internal.component;ActorProducer.endpoint">endpoint</a>: <a href="#akka.camel.internal.component;ActorEndpoint" title="akka.camel.internal.component.ActorEndpoint">ActorEndpoint</a>, <a title="akka.camel.Camel" id="akka.camel.internal.component;ActorProducer.camel">camel</a>: <a href="../../Camel.scala.html#akka.camel;Camel" title="akka.camel.Camel">Camel</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="org.apache.camel.impl.DefaultProducer">DefaultProducer</span><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.endpoint" title="akka.camel.internal.component.ActorEndpoint">endpoint</a><span class="delimiter">)</span> <span class="keyword">with</span> <span title="org.apache.camel.AsyncProcessor">AsyncProcessor</span> <span class="delimiter">{</span>
  <span class="comment">/**
   * Processes the exchange.
   * Calls the synchronous version of the method and waits for the result (blocking).
   * @param exchange the exchange to process
   */</span>
  <span class="keyword">def</span> <a title="(exchange: org.apache.camel.Exchange)Unit" id="akka.camel.internal.component;ActorProducer.process(e57538eb61)">process</a><span class="delimiter">(</span><a title="org.apache.camel.Exchange" id="akka.camel.internal.component;ActorProducer.process(e57538eb61).exchange">exchange</a>: <span title="org.apache.camel.Exchange">Exchange</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71)" title="(exchange: akka.camel.internal.CamelExchangeAdapter)Unit">processExchangeAdapter</a><span class="delimiter">(</span><span title="akka.camel.internal.CamelExchangeAdapter" class="keyword">new</span> <a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter" title="akka.camel.internal.CamelExchangeAdapter">CamelExchangeAdapter</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.process(e57538eb61).exchange" title="org.apache.camel.Exchange">exchange</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Processes the message exchange. the caller supports having the exchange asynchronously processed.
   * If there was a failure processing then the caused Exception would be set on the Exchange.
   *
   * @param exchange the message exchange
   * @param callback the AsyncCallback will be invoked when the processing of the exchange is completed.
   *        If the exchange is completed synchronously, then the callback is also invoked synchronously.
   *        The callback should therefore be careful of starting recursive loop.
   * @return (doneSync) true to continue execute synchronously, false to continue being executed asynchronously
   */</span>
  <span class="keyword">def</span> <a title="(exchange: org.apache.camel.Exchange, callback: org.apache.camel.AsyncCallback)Boolean" id="akka.camel.internal.component;ActorProducer.process(792b0a3fc1)">process</a><span class="delimiter">(</span><a title="org.apache.camel.Exchange" id="akka.camel.internal.component;ActorProducer.process(792b0a3fc1).exchange">exchange</a>: <span title="org.apache.camel.Exchange">Exchange</span>, <a title="org.apache.camel.AsyncCallback" id="akka.camel.internal.component;ActorProducer.process(792b0a3fc1).callback">callback</a>: <span title="org.apache.camel.AsyncCallback">AsyncCallback</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f)" title="(exchange: akka.camel.internal.CamelExchangeAdapter, callback: org.apache.camel.AsyncCallback)Boolean">processExchangeAdapter</a><span class="delimiter">(</span><span title="akka.camel.internal.CamelExchangeAdapter" class="keyword">new</span> <a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter" title="akka.camel.internal.CamelExchangeAdapter">CamelExchangeAdapter</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.process(792b0a3fc1).exchange" title="org.apache.camel.Exchange">exchange</a><span class="delimiter">)</span>, <a href="#akka.camel.internal.component;ActorProducer.process(792b0a3fc1).callback" title="org.apache.camel.AsyncCallback">callback</a><span class="delimiter">)</span>

  <span class="comment">/**
   * INTERNAL API
   * Processes the [[akka.camel.internal.CamelExchangeAdapter]]
   * @param exchange the [[akka.camel.internal.CamelExchangeAdapter]]
   */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>camel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(exchange: akka.camel.internal.CamelExchangeAdapter)Unit" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71)">processExchangeAdapter</a><span class="delimiter">(</span><a title="akka.camel.internal.CamelExchangeAdapter" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71).exchange">exchange</a>: <a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter" title="akka.camel.internal.CamelExchangeAdapter">CamelExchangeAdapter</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.util.concurrent.CountDownLatch" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71).isDone">isDone</a> = <span title="java.util.concurrent.CountDownLatch" class="keyword">new</span> <span title="java.util.concurrent.CountDownLatch">CountDownLatch</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f)" title="(exchange: akka.camel.internal.CamelExchangeAdapter, callback: org.apache.camel.AsyncCallback)Boolean">processExchangeAdapter</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>, <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71);$anon" title="org.apache.camel.AsyncCallback" class="keyword">new</a> <a title="anonymous class $anon extends Object with org.apache.camel.AsyncCallback" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71);$anon">AsyncCallback</a> <span class="delimiter">{</span> <span class="keyword">def</span> <a title="(doneSync: Boolean)Unit" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71);$anon.done">done</a><span class="delimiter">(</span><a title="Boolean" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71);$anon.done.doneSync">doneSync</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71).isDone" title="java.util.concurrent.CountDownLatch">isDone</a>.<span title="()Unit">countDown</span><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">}</span> <span class="delimiter">}</span><span class="delimiter">)</span>
    <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(36f9b2bb71).isDone" title="java.util.concurrent.CountDownLatch">isDone</a>.<span title="(x$1: Long, x$2: java.util.concurrent.TimeUnit)Boolean">await</span><span title="Unit" class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpointConfig.getReplyTimeout" title="=&gt; scala.concurrent.duration.FiniteDuration">replyTimeout</a>.<span title="=&gt; Long">length</span>, <a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpointConfig.getReplyTimeout" title="=&gt; scala.concurrent.duration.FiniteDuration">replyTimeout</a>.<span title="=&gt; scala.concurrent.duration.TimeUnit">unit</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * INTERNAL API
   * Processes the [[akka.camel.internal.CamelExchangeAdapter]].
   * This method is blocking when the exchange is inOnly. The method returns true if it executed synchronously/blocking.
   * @param exchange the [[akka.camel.internal.CamelExchangeAdapter]]
   * @param callback the callback
   * @return (doneSync) true to continue execute synchronously, false to continue being executed asynchronously
   */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>camel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(exchange: akka.camel.internal.CamelExchangeAdapter, callback: org.apache.camel.AsyncCallback)Boolean" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f)">processExchangeAdapter</a><span class="delimiter">(</span><a title="akka.camel.internal.CamelExchangeAdapter" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange">exchange</a>: <a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter" title="akka.camel.internal.CamelExchangeAdapter">CamelExchangeAdapter</a>, <a title="org.apache.camel.AsyncCallback" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).callback">callback</a>: <span title="org.apache.camel.AsyncCallback">AsyncCallback</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.isOutCapable" title="=&gt; Boolean">isOutCapable</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpointConfig.getAutoAck" title="=&gt; Boolean">autoAck</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.camel.internal.component;ActorProducer.fireAndForget" title="(message: akka.camel.CamelMessage, exchange: akka.camel.internal.CamelExchangeAdapter)Unit">fireAndForget</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.messageFor" title="(exchange: akka.camel.internal.CamelExchangeAdapter)akka.camel.CamelMessage">messageFor</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a><span class="delimiter">)</span>, <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a><span class="delimiter">)</span>
      <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).callback" title="org.apache.camel.AsyncCallback">callback</a>.<span title="(x$1: Boolean)Unit">done</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
      <span title="Boolean(true)" class="keyword">true</span> <span class="comment">// done sync</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="PartialFunction[scala.util.Try[Any],Unit]" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).action">action</a>: <span title="PartialFunction[scala.util.Try[Any],Unit]">PartialFunction</span><span class="delimiter">[</span>Try<span class="delimiter">[</span>Any<span class="delimiter">]</span>, Unit<span class="delimiter">]</span> =
        <span title="PartialFunction[scala.util.Try[Any],Unit]" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.isOutCapable" title="=&gt; Boolean">isOutCapable</a><span class="delimiter">)</span> <span title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[scala.util.Try[Any],Unit] with Serializable" class="delimiter">{</span>
          <span class="keyword">case</span> Success<span class="delimiter">(</span><span title="akka.camel.FailureResult">failure</span>: <a href="../../Producer.scala.html#akka.camel;FailureResult" title="akka.camel.FailureResult">FailureResult</a><span class="delimiter">)</span> ⇒ <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.setFailure" title="(msg: akka.camel.FailureResult)Unit">setFailure</a><span title="Boolean(true)" class="delimiter">(</span><span title="akka.camel.FailureResult">failure</span><span class="delimiter">)</span>
          <span class="keyword">case</span> Success<span class="delimiter">(</span><span title="Any">msg</span><span class="delimiter">)</span>                    ⇒ <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.setResponse" title="(msg: akka.camel.CamelMessage)Unit">setResponse</a><span title="Boolean(true)" class="delimiter">(</span><a href="../../CamelMessage.scala.html#akka.camel.CamelMessage" title="akka.camel.CamelMessage.type">CamelMessage</a>.<a href="../../CamelMessage.scala.html#akka.camel.CamelMessage.canonicalize" title="(msg: Any)akka.camel.CamelMessage">canonicalize</a><span class="delimiter">(</span><span title="Any">msg</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> Failure<span class="delimiter">(</span><span title="java.util.concurrent.TimeoutException">e</span>: <span title="java.util.concurrent.TimeoutException">TimeoutException</span><span class="delimiter">)</span>    ⇒ <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.setFailure" title="(msg: akka.camel.FailureResult)Unit">setFailure</a><span title="Boolean(true)" class="delimiter">(</span><a href="../../Producer.scala.html#akka.camel;FailureResult" title="(cause: Throwable, headers: Map[String,Any])akka.camel.FailureResult">FailureResult</a><span class="delimiter">(</span><span title="(x$1: String)java.util.concurrent.TimeoutException" class="keyword">new</span> <span title="java.util.concurrent.TimeoutException">TimeoutException</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Failed to get response from the actor [%s] within timeout [%s]. Check replyTimeout and blocking settings [%s]&quot;</span> <span title="(args: Any*)String">format</span> <span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpoint.path" title="=&gt; akka.camel.internal.component.ActorEndpointPath">path</a>, <a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpointConfig.getReplyTimeout" title="=&gt; scala.concurrent.duration.FiniteDuration">replyTimeout</a>, <a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> Failure<span class="delimiter">(</span><span title="Throwable">throwable</span><span class="delimiter">)</span>              ⇒ <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.setFailure" title="(msg: akka.camel.FailureResult)Unit">setFailure</a><span title="Boolean(true)" class="delimiter">(</span><a href="../../Producer.scala.html#akka.camel;FailureResult" title="(cause: Throwable, headers: Map[String,Any])akka.camel.FailureResult">FailureResult</a><span class="delimiter">(</span><span title="Throwable">throwable</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[scala.util.Try[Any],Unit] with Serializable" class="delimiter">{</span>
          <span class="keyword">case</span> Success<span class="delimiter">(</span><a href="../../CamelMessage.scala.html#akka.camel.Ack" title="akka.camel.Ack.type">Ack</a><span class="delimiter">)</span>                    ⇒ <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span> <span class="comment">/* no response message to set */</span>
          <span class="keyword">case</span> Success<span class="delimiter">(</span><span title="akka.camel.FailureResult">failure</span>: <a href="../../Producer.scala.html#akka.camel;FailureResult" title="akka.camel.FailureResult">FailureResult</a><span class="delimiter">)</span> ⇒ <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.setFailure" title="(msg: akka.camel.FailureResult)Unit">setFailure</a><span title="Boolean(true)" class="delimiter">(</span><span title="akka.camel.FailureResult">failure</span><span class="delimiter">)</span>
          <span class="keyword">case</span> Success<span class="delimiter">(</span><span title="Any">msg</span><span class="delimiter">)</span>                    ⇒ <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.setFailure" title="(msg: akka.camel.FailureResult)Unit">setFailure</a><span title="Boolean(true)" class="delimiter">(</span><a href="../../Producer.scala.html#akka.camel;FailureResult" title="(cause: Throwable, headers: Map[String,Any])akka.camel.FailureResult">FailureResult</a><span class="delimiter">(</span><span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Expected Ack or Failure message, but got: [%s] from actor [%s]&quot;</span> <span title="(args: Any*)String">format</span> <span class="delimiter">(</span><span title="Any">msg</span>, <a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpoint.path" title="=&gt; akka.camel.internal.component.ActorEndpointPath">path</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> Failure<span class="delimiter">(</span><span title="java.util.concurrent.TimeoutException">e</span>: <span title="java.util.concurrent.TimeoutException">TimeoutException</span><span class="delimiter">)</span>    ⇒ <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.setFailure" title="(msg: akka.camel.FailureResult)Unit">setFailure</a><span title="Boolean(true)" class="delimiter">(</span><a href="../../Producer.scala.html#akka.camel;FailureResult" title="(cause: Throwable, headers: Map[String,Any])akka.camel.FailureResult">FailureResult</a><span class="delimiter">(</span><span title="(x$1: String)java.util.concurrent.TimeoutException" class="keyword">new</span> <span title="java.util.concurrent.TimeoutException">TimeoutException</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Failed to get Ack or Failure response from the actor [%s] within timeout [%s]. Check replyTimeout and blocking settings [%s]&quot;</span> <span title="(args: Any*)String">format</span> <span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpoint.path" title="=&gt; akka.camel.internal.component.ActorEndpointPath">path</a>, <a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpointConfig.getReplyTimeout" title="=&gt; scala.concurrent.duration.FiniteDuration">replyTimeout</a>, <a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> Failure<span class="delimiter">(</span><span title="Throwable">throwable</span><span class="delimiter">)</span>              ⇒ <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.setFailure" title="(msg: akka.camel.FailureResult)Unit">setFailure</a><span title="Boolean(true)" class="delimiter">(</span><a href="../../Producer.scala.html#akka.camel;FailureResult" title="(cause: Throwable, headers: Map[String,Any])akka.camel.FailureResult">FailureResult</a><span class="delimiter">(</span><span title="Throwable">throwable</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

      <span class="comment">// FIXME #3074 how do we solve this with actorSelection?</span>
      <span class="keyword">val</span> <a title="scala.concurrent.Future[Any]" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).async">async</a> = <span class="keyword">try</span> <a href="#akka.camel.internal.component;ActorProducer.actorFor" title="(path: akka.camel.internal.component.ActorEndpointPath)akka.actor.ActorRef">actorFor</a><a href="../../../../../actor/akka/pattern/AskSupport.scala.html#akka.pattern;AskSupport.ask(13940b1e32)" title="implicit akka.pattern.AskSupport.ask : (actorRef: akka.actor.ActorRef)akka.pattern.AskableActorRef" class="delimiter">(</a><a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpoint.path" title="=&gt; akka.camel.internal.component.ActorEndpointPath">path</a><span class="delimiter">)</span>.<a href="../../../../../actor/akka/pattern/AskSupport.scala.html#akka.pattern;AskableActorRef.ask" title="(message: Any)(implicit timeout: akka.util.Timeout)scala.concurrent.Future[Any]">ask</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.messageFor" title="(exchange: akka.camel.internal.CamelExchangeAdapter)akka.camel.CamelMessage">messageFor</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="../../../../../actor/akka/util/Timeout.scala.html#akka.util;Timeout" title="(duration: scala.concurrent.duration.FiniteDuration)akka.util.Timeout">Timeout</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpointConfig.getReplyTimeout" title="=&gt; scala.concurrent.duration.FiniteDuration">replyTimeout</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">catch</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).async.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).async.e">e</a><span class="delimiter">)</span> ⇒ <span title="scala.concurrent.Future.type">Future</span>.<span title="(exception: Throwable)scala.concurrent.Future[Nothing]">failed</span><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).async.e" title="Throwable">e</a><span class="delimiter">)</span> <span class="delimiter">}</span>
      <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="scala.concurrent.ExecutionContextExecutor" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).ec">ec</a> = <a href="#akka.camel.internal.component;ActorProducer.camel" title="akka.camel.Camel">camel</a>.<a href="../../Camel.scala.html#akka.camel;Camel.system" title="=&gt; akka.actor.ActorSystem">system</a>.<a href="../../../../../actor/akka/actor/ActorSystem.scala.html#akka.actor;ActorSystem.dispatcher" title="=&gt; scala.concurrent.ExecutionContextExecutor">dispatcher</a> <span class="comment">// FIXME which ExecutionContext should be used here?</span>
      <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).async" title="scala.concurrent.Future[Any]">async</a>.<span title="(func: scala.util.Try[Any] =&gt; Unit)(implicit executor: scala.concurrent.ExecutionContext)Unit">onComplete</span><a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).ec" title="scala.concurrent.ExecutionContextExecutor" class="delimiter">(</a><a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).action" title="PartialFunction[scala.util.Try[Any],Unit]">action</a> <span title="(k: Unit =&gt; Unit)PartialFunction[scala.util.Try[Any],Unit]">andThen</span> <span class="delimiter">{</span> <a title="Unit" id="akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).$anonfun.x$1">_</a> ⇒ <a href="#akka.camel.internal.component;ActorProducer.processExchangeAdapter(aa32d0577f).callback" title="org.apache.camel.AsyncCallback">callback</a>.<span title="(x$1: Boolean)Unit">done</span><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <span class="delimiter">}</span><span class="delimiter">)</span>
      <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="comment">// FIXME #3074 how do we solve this with actorSelection?</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(message: akka.camel.CamelMessage, exchange: akka.camel.internal.CamelExchangeAdapter)Unit" id="akka.camel.internal.component;ActorProducer.fireAndForget">fireAndForget</a><span class="delimiter">(</span><a title="akka.camel.CamelMessage" id="akka.camel.internal.component;ActorProducer.fireAndForget.message">message</a>: <a href="../../CamelMessage.scala.html#akka.camel;CamelMessage" title="akka.camel.CamelMessage">CamelMessage</a>, <a title="akka.camel.internal.CamelExchangeAdapter" id="akka.camel.internal.component;ActorProducer.fireAndForget.exchange">exchange</a>: <a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter" title="akka.camel.internal.CamelExchangeAdapter">CamelExchangeAdapter</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <span class="keyword">try</span> <span class="delimiter">{</span> <a href="#akka.camel.internal.component;ActorProducer.actorFor" title="(path: akka.camel.internal.component.ActorEndpointPath)akka.actor.ActorRef">actorFor</a><a href="../../../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="akka.actor.ScalaActorRef" id="akka.camel.internal.component;ActorProducer.fireAndForget.qual$1" class="delimiter">(</a><a href="#akka.camel.internal.component;ActorProducer.endpoint" title="=&gt; akka.camel.internal.component.ActorEndpoint">endpoint</a>.<a href="#akka.camel.internal.component;ActorEndpoint.path" title="=&gt; akka.camel.internal.component.ActorEndpointPath">path</a><span class="delimiter">)</span> <a href="../../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!$default$2" title="akka.actor.ActorRef" id="akka.camel.internal.component;ActorProducer.fireAndForget.x$3">!</a> <a href="#akka.camel.internal.component;ActorProducer.fireAndForget.message" title="akka.camel.CamelMessage" id="akka.camel.internal.component;ActorProducer.fireAndForget.x$2">message</a> <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a href="#akka.camel.internal.component;ActorProducer.fireAndForget.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="akka.camel.internal.component;ActorProducer.fireAndForget.e">e</a><span class="delimiter">)</span> ⇒ <a href="#akka.camel.internal.component;ActorProducer.fireAndForget.exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.setFailure" title="(msg: akka.camel.FailureResult)Unit">setFailure</a><span class="delimiter">(</span><a href="../../Producer.scala.html#akka.camel.FailureResult.<init>$default$2" title="akka.camel.FailureResult" class="keyword">new</a> <a href="../../Producer.scala.html#akka.camel;FailureResult" title="akka.camel.FailureResult">FailureResult</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.fireAndForget.e" title="Throwable">e</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="(path: akka.camel.internal.component.ActorEndpointPath)akka.actor.ActorRef" id="akka.camel.internal.component;ActorProducer.actorFor">actorFor</a><span class="delimiter">(</span><a title="akka.camel.internal.component.ActorEndpointPath" id="akka.camel.internal.component;ActorProducer.actorFor.path">path</a>: <a href="#akka.camel.internal.component;ActorEndpointPath" title="akka.camel.internal.component.ActorEndpointPath">ActorEndpointPath</a><span class="delimiter">)</span>: <a href="../../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a> =
    <a href="#akka.camel.internal.component;ActorProducer.actorFor.path" title="akka.camel.internal.component.ActorEndpointPath">path</a>.<a href="#akka.camel.internal.component;ActorEndpointPath.findActorIn" title="(system: akka.actor.ActorSystem)Option[akka.actor.ActorRef]">findActorIn</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.camel" title="akka.camel.Camel">camel</a>.<a href="../../Camel.scala.html#akka.camel;Camel.system" title="=&gt; akka.actor.ActorSystem">system</a><span class="delimiter">)</span> <span title="(default: =&gt; akka.actor.ActorRef)akka.actor.ActorRef">getOrElse</span> <span class="delimiter">(</span><span title="Nothing" class="keyword">throw</span> <span title="akka.camel.ActorNotRegisteredException" class="keyword">new</span> <a href="../../ActorNotRegisteredException.scala.html#akka.camel;ActorNotRegisteredException" title="akka.camel.ActorNotRegisteredException">ActorNotRegisteredException</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorProducer.actorFor.path" title="akka.camel.internal.component.ActorEndpointPath">path</a>.<a href="#akka.camel.internal.component;ActorEndpointPath.actorPath" title="=&gt; String">actorPath</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="(exchange: akka.camel.internal.CamelExchangeAdapter)akka.camel.CamelMessage" id="akka.camel.internal.component;ActorProducer.messageFor">messageFor</a><span class="delimiter">(</span><a title="akka.camel.internal.CamelExchangeAdapter" id="akka.camel.internal.component;ActorProducer.messageFor.exchange">exchange</a>: <a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter" title="akka.camel.internal.CamelExchangeAdapter">CamelExchangeAdapter</a><span class="delimiter">)</span> =
    <a href="#akka.camel.internal.component;ActorProducer.messageFor.exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.toRequestMessage(47cd4003e5)" title="(headers: Map[String,Any])akka.camel.CamelMessage">toRequestMessage</a><span class="delimiter">(</span><span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><span class="delimiter">(</span><a href="../../CamelMessage.scala.html#akka.camel.CamelMessage" title="akka.camel.CamelMessage.type">CamelMessage</a>.<a href="../../CamelMessage.scala.html#akka.camel.CamelMessage.MessageExchangeId" title="(x: String)ArrowAssoc[String]">MessageExchangeId</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#akka.camel.internal.component;ActorProducer.messageFor.exchange" title="akka.camel.internal.CamelExchangeAdapter">exchange</a>.<a href="../CamelExchangeAdapter.scala.html#akka.camel.internal;CamelExchangeAdapter.getExchangeId" title="=&gt; String">getExchangeId</a><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 * Converts Strings to [[scala.concurrent.duration.Duration]]
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>camel<span class="delimiter">]</span> <span class="keyword">object</span> <a title="akka.camel.internal.component.DurationTypeConverter.type" id="akka.camel.internal.component.DurationTypeConverter">DurationTypeConverter</a> <a href="#akka.camel.internal.component.DurationTypeConverter" title="akka.camel.internal.component.DurationTypeConverter.type" class="keyword">extends</a> <span title="org.apache.camel.support.TypeConverterSupport">TypeConverterSupport</span> <span class="delimiter">{</span>

  @throws<span class="delimiter">(</span>classOf<span class="delimiter">[</span>TypeConversionException<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[T](valueType: Class[T], exchange: org.apache.camel.Exchange, value: AnyRef)T" id="akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8)">convertTo</a><span class="delimiter">[</span><a title="" id="akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8);T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Class[T]" id="akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).valueType">valueType</a>: <span title="Class[T]">Class</span><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="org.apache.camel.Exchange" id="akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).exchange">exchange</a>: <span title="org.apache.camel.Exchange">Exchange</span>, <a title="AnyRef" id="akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).value">value</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <a href="#akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8);T" title="T">T</a> = <a href="#akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).valueType" title="Class[T]">valueType</a>.<span title="(x$1: Any)T">cast</span><span class="delimiter">(</span><span class="keyword">try</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.concurrent.duration.Duration" id="akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).d">d</a> = <span title="(s: String)scala.concurrent.duration.Duration">Duration</span><span class="delimiter">(</span><a href="#akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).value" title="AnyRef">value</a>.<span title="()String">toString</span><span class="delimiter">)</span>
    <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).valueType" title="Class[T]">valueType</a>.<span title="(x$1: Any)Boolean">isInstance</span><span class="delimiter">(</span><a href="#akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).d" title="scala.concurrent.duration.Duration">d</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).d" title="scala.concurrent.duration.Duration">d</a> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
  <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).throwable">throwable</a><span class="delimiter">)</span> ⇒ <span title="Nothing" class="keyword">throw</span> <span title="org.apache.camel.TypeConversionException" class="keyword">new</span> <span title="org.apache.camel.TypeConversionException">TypeConversionException</span><span class="delimiter">(</span><a href="#akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).value" title="AnyRef">value</a>, <a href="#akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).valueType" title="Class[T]">valueType</a>, <a href="#akka.camel.internal.component.DurationTypeConverter.convertTo(a4de8d9ab8).throwable" title="Throwable">throwable</a><span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 * An endpoint to an [[akka.actor.ActorRef]]
 * @param actorPath the String representation of the path to the actor
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>camel<span class="delimiter">]</span> <span class="keyword">case class</span> <a title="class ActorEndpointPath extends AnyRef with Product with Serializable" id="akka.camel.internal.component;ActorEndpointPath">ActorEndpointPath</a> <a href="#akka.camel.internal.component;ActorEndpointPath" title="Product" class="keyword">private</a> <span class="delimiter">(</span><a title="String" id="akka.camel.internal.component;ActorEndpointPath.actorPath">actorPath</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#akka.camel.internal.component.ActorEndpointPath.readResolve" title="akka.camel.internal.component.ActorEndpointPath.type">ActorEndpointPath</a>._
  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorEndpointPath.actorPath" title="=&gt; String">actorPath</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorEndpointPath.actorPath" title="=&gt; String">actorPath</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorEndpointPath.actorPath" title="=&gt; String">actorPath</a>.<span title="(x$1: String)Boolean">startsWith</span><span class="delimiter">(</span><span title="String(&quot;akka://&quot;)" class="string">&quot;akka://&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(system: akka.actor.ActorSystem)Option[akka.actor.ActorRef]" id="akka.camel.internal.component;ActorEndpointPath.findActorIn">findActorIn</a><span class="delimiter">(</span><a title="akka.actor.ActorSystem" id="akka.camel.internal.component;ActorEndpointPath.findActorIn.system">system</a>: <a href="../../../../../actor/akka/actor/ActorSystem.scala.html#akka.actor;ActorSystem" title="akka.actor.ActorSystem">ActorSystem</a><span class="delimiter">)</span>: <span title="Option[akka.actor.ActorRef]">Option</span><span class="delimiter">[</span>ActorRef<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="comment">// FIXME #3074 how do we solve this with actorSelection?</span>
    <span class="keyword">val</span> <a title="akka.actor.ActorRef" id="akka.camel.internal.component;ActorEndpointPath.findActorIn.ref">ref</a> = <a href="#akka.camel.internal.component;ActorEndpointPath.findActorIn.system" title="akka.actor.ActorSystem">system</a>.<a href="../../../../../actor/akka/actor/ActorRefProvider.scala.html#akka.actor;ActorRefFactory.actorFor(922575794b)" title="(path: String)akka.actor.ActorRef">actorFor</a><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorEndpointPath.actorPath" title="=&gt; String">actorPath</a><span class="delimiter">)</span>
    <span title="Option[akka.actor.ActorRef]" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorEndpointPath.findActorIn.ref" title="akka.actor.ActorRef">ref</a>.<a href="../../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef.isTerminated" title="=&gt; Boolean">isTerminated</a><span class="delimiter">)</span> <span title="None.type">None</span> <span class="keyword">else</span> <span title="(x: akka.actor.ActorRef)Some[akka.actor.ActorRef]">Some</span><span class="delimiter">(</span><a href="#akka.camel.internal.component;ActorEndpointPath.findActorIn.ref" title="akka.actor.ActorRef">ref</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Converts ActorRefs and actorPaths to URI's that point to the actor through the Camel Actor Component.
 * Can also be used in the Java API as a helper for custom route builders. the Scala API has an implicit conversion in the camel package to
 * directly use `to(actorRef)`. In java you could use `to(CamelPath.toUri(actorRef)`.
 * The URI to the actor is exactly the same as the string representation of the ActorPath, except that it can also have optional URI parameters to configure the Consumer Actor.
 */</span>
<span class="keyword">object</span> <a title="akka.camel.internal.component.CamelPath.type" id="akka.camel.internal.component.CamelPath">CamelPath</a> <a href="#akka.camel.internal.component.CamelPath" title="akka.camel.internal.component.CamelPath.type" class="delimiter">{</a>
  <span class="comment">/**
   * Converts the actorRef to a Camel URI (string) which can be used in custom routes.
   * The created URI will have no parameters, it is purely the string representation of the actor's path.
   * @param actorRef the actorRef
   * @return the Camel URI to the actor.
   */</span>
  <span class="keyword">def</span> <a title="(actorRef: akka.actor.ActorRef)String" id="akka.camel.internal.component.CamelPath.toUri(c64de5e2a1)">toUri</a><span class="delimiter">(</span><a title="akka.actor.ActorRef" id="akka.camel.internal.component.CamelPath.toUri(c64de5e2a1).actorRef">actorRef</a>: <a href="../../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#akka.camel.internal.component.CamelPath.toUri(c64de5e2a1).actorRef" title="akka.actor.ActorRef">actorRef</a>.<a href="../../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef.path" title="=&gt; akka.actor.ActorPath">path</a>.<span title="()String">toString</span>

  <span class="comment">/**
   * Converts the actorRef to a Camel URI (string) which can be used in custom routes.
   * Use this version of toUri when you know that the actorRef points to a Consumer Actor and you would like to
   * set autoAck and replyTimeout parameters to non-default values.
   *
   * @param actorRef the actorRef
   * @param autoAck parameter for a Consumer Actor, see [[akka.camel.ConsumerConfig]]
   * @param replyTimeout parameter for a Consumer Actor, see [[akka.camel.ConsumerConfig]]
   * @return the Camel URI to the Consumer Actor, including the parameters for auto acknowledgement and replyTimeout.
   */</span>
  <span class="keyword">def</span> <a title="(actorRef: akka.actor.ActorRef, autoAck: Boolean, replyTimeout: scala.concurrent.duration.Duration)String" id="akka.camel.internal.component.CamelPath.toUri(d0f177a466)">toUri</a><span class="delimiter">(</span><a title="akka.actor.ActorRef" id="akka.camel.internal.component.CamelPath.toUri(d0f177a466).actorRef">actorRef</a>: <a href="../../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a>, <a title="Boolean" id="akka.camel.internal.component.CamelPath.toUri(d0f177a466).autoAck">autoAck</a>: <span title="Boolean">Boolean</span>, <a title="scala.concurrent.duration.Duration" id="akka.camel.internal.component.CamelPath.toUri(d0f177a466).replyTimeout">replyTimeout</a>: <span title="scala.concurrent.duration.Duration">Duration</span><span class="delimiter">)</span>: <span title="String">String</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s?autoAck=%s&amp;replyTimeout=%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#akka.camel.internal.component.CamelPath.toUri(d0f177a466).actorRef" title="akka.actor.ActorRef">actorRef</a>.<a href="../../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef.path" title="=&gt; akka.actor.ActorPath">path</a>.<span title="()String">toString</span>, <a href="#akka.camel.internal.component.CamelPath.toUri(d0f177a466).autoAck" title="Boolean">autoAck</a>, <a href="#akka.camel.internal.component.CamelPath.toUri(d0f177a466).replyTimeout" title="scala.concurrent.duration.Duration">replyTimeout</a>.<span title="()String">toString</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 * Companion of `ActorEndpointPath`
 */</span>
<span title="AnyRef" class="keyword">private</span><span class="delimiter">[</span>camel<span class="delimiter">]</span> <span class="keyword">case object</span> <a href="#akka.camel.internal.component.ActorEndpointPath.productElement.x$1" title="akka.camel.internal.component.ActorEndpointPath.type" id="akka.camel.internal.component.ActorEndpointPath.readResolve">ActorEndpointPath</a> <span title="Product" class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(actorRef: akka.actor.ActorRef)akka.camel.internal.component.ActorEndpointPath" id="akka.camel.internal.component.ActorEndpointPath.apply(7b8e7a1471)">apply</a><span class="delimiter">(</span><a title="akka.actor.ActorRef" id="akka.camel.internal.component.ActorEndpointPath.apply(7b8e7a1471).actorRef">actorRef</a>: <a href="../../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef" title="akka.actor.ActorRef">ActorRef</a><span class="delimiter">)</span>: <a href="#akka.camel.internal.component;ActorEndpointPath" title="akka.camel.internal.component.ActorEndpointPath">ActorEndpointPath</a> = <span title="akka.camel.internal.component.ActorEndpointPath" class="keyword">new</span> <a href="#akka.camel.internal.component;ActorEndpointPath" title="akka.camel.internal.component.ActorEndpointPath">ActorEndpointPath</a><span class="delimiter">(</span><a href="#akka.camel.internal.component.ActorEndpointPath.apply(7b8e7a1471).actorRef" title="akka.actor.ActorRef">actorRef</a>.<a href="../../../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ActorRef.path" title="=&gt; akka.actor.ActorPath">path</a>.<span title="()String">toString</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Creates an [[akka.camel.internal.component.ActorEndpointPath]] from the uri
   * Expects the uri in the akka [[akka.actor.ActorPath]] format, i.e 'akka://system/user/someactor'.
   * parameters can be optionally added to the actor path to indicate auto-acknowledgement and replyTimeout for a [[akka.camel.Consumer]] actor.
   */</span>
  <span class="keyword">def</span> <a title="(camelPath: String)akka.camel.internal.component.ActorEndpointPath" id="akka.camel.internal.component.ActorEndpointPath.fromCamelPath">fromCamelPath</a><span class="delimiter">(</span><a title="String" id="akka.camel.internal.component.ActorEndpointPath.fromCamelPath.camelPath">camelPath</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#akka.camel.internal.component;ActorEndpointPath" title="akka.camel.internal.component.ActorEndpointPath">ActorEndpointPath</a> = <a href="#akka.camel.internal.component.ActorEndpointPath.fromCamelPath.camelPath" title="String">camelPath</a> <span title="akka.camel.internal.component.ActorEndpointPath" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="String" id="akka.camel.internal.component.ActorEndpointPath.fromCamelPath.id">id</a> <span class="keyword">if</span> <a href="#akka.camel.internal.component.ActorEndpointPath.fromCamelPath.id" title="String">id</a> <span title="(x$1: String)Boolean">startsWith</span> <span title="String(&quot;akka://&quot;)" class="string">&quot;akka://&quot;</span> ⇒ <span title="akka.camel.internal.component.ActorEndpointPath" class="keyword">new</span> <a href="#akka.camel.internal.component;ActorEndpointPath" title="akka.camel.internal.component.ActorEndpointPath">ActorEndpointPath</a><span class="delimiter">(</span><a href="#akka.camel.internal.component.ActorEndpointPath.fromCamelPath.id" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">id</a>.<span title="(separator: Char)Array[String]">split</span><span title="(i: Int)String" class="delimiter">(</span><span title="Char('?')" class="char">'?'</span><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> _                             ⇒ <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Invalid path: [%s] - should be an actorPath starting with 'akka://', optionally followed by options&quot;</span> <span title="(args: Any*)String">format</span> <a href="#akka.camel.internal.component.ActorEndpointPath.fromCamelPath.camelPath" title="String">camelPath</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

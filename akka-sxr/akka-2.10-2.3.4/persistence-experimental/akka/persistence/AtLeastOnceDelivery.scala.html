<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>persistence-experimental/akka/persistence/AtLeastOnceDelivery.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> akka.persistence

<span class="keyword">import</span> scala.annotation.tailrec
<span class="keyword">import</span> scala.collection.breakOut
<span class="keyword">import</span> scala.collection.immutable
<span class="keyword">import</span> scala.concurrent.duration.FiniteDuration
<span class="keyword">import</span> akka.actor.Actor
<span class="keyword">import</span> akka.actor.ActorPath
<span class="keyword">import</span> akka.persistence.serialization.Message

<span class="keyword">object</span> <a title="akka.persistence.AtLeastOnceDelivery.type" id="akka.persistence.AtLeastOnceDelivery">AtLeastOnceDelivery</a> <a href="#akka.persistence.AtLeastOnceDelivery" title="akka.persistence.AtLeastOnceDelivery.type" class="delimiter">{</a>

  <span class="comment">/**
   * Snapshot of current `AtLeastOnceDelivery` state. Can be retrieved with
   * [[AtLeastOnceDelivery#getDeliverySnapshot]] and saved with [[PersistentActor#saveSnapshot]].
   * During recovery the snapshot received in [[SnapshotOffer]] should be set
   * with [[AtLeastOnceDelivery.setDeliverySnapshot]].
   */</span>
  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case class</span> <a title="class AtLeastOnceDeliverySnapshot extends AnyRef with akka.persistence.serialization.Message with Product with Serializable" id="akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot.readResolve">AtLeastOnceDeliverySnapshot</a><a href="#akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot.readResolve" title="Product" class="delimiter">(</a><a title="Long" id="akka.persistence.AtLeastOnceDelivery;AtLeastOnceDeliverySnapshot.currentDeliveryId">currentDeliveryId</a>: <span title="Long">Long</span>, <a title="scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]" id="akka.persistence.AtLeastOnceDelivery;AtLeastOnceDeliverySnapshot.unconfirmedDeliveries">unconfirmedDeliveries</a>: immutable.<span title="scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">Seq</span><span class="delimiter">[</span>UnconfirmedDelivery<span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="keyword">extends</span> <a href="serialization/MessageSerializer.scala.html#akka.persistence.serialization;Message" title="akka.persistence.serialization.Message">Message</a> <span class="delimiter">{</span>

    <span class="comment">/**
     * Java API
     */</span>
    <span class="keyword">def</span> <a title="=&gt; java.util.List[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]" id="akka.persistence.AtLeastOnceDelivery;AtLeastOnceDeliverySnapshot.getUnconfirmedDeliveries">getUnconfirmedDeliveries</a>: java.util.<span title="java.util.List[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">List</span><span class="delimiter">[</span>UnconfirmedDelivery<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">import</span> scala.collection.<span title="scala.collection.JavaConverters.type">JavaConverters</span>._
      <a href="#akka.persistence.AtLeastOnceDelivery;AtLeastOnceDeliverySnapshot.unconfirmedDeliveries" title="(b: Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery])scala.collection.convert.Decorators.AsJava[java.util.List[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]]">unconfirmedDeliveries</a>.<span title="=&gt; java.util.List[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">asJava</span>
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="comment">/**
   * @see [[AtLeastOnceDelivery#warnAfterNumberOfUnconfirmedAttempts]]
   */</span>
  @SerialVersionUID<span class="delimiter">(</span><span class="long">1L</span><span class="delimiter">)</span>
  <span class="keyword">case class</span> <a title="class UnconfirmedWarning extends AnyRef with Product with Serializable" id="akka.persistence.AtLeastOnceDelivery.UnconfirmedWarning.readResolve">UnconfirmedWarning</a><a href="#akka.persistence.AtLeastOnceDelivery.UnconfirmedWarning.readResolve" title="Product" class="delimiter">(</a><a title="scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]" id="akka.persistence.AtLeastOnceDelivery;UnconfirmedWarning.unconfirmedDeliveries">unconfirmedDeliveries</a>: immutable.<span title="scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">Seq</span><span class="delimiter">[</span>UnconfirmedDelivery<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="comment">/**
     * Java API
     */</span>
    <span class="keyword">def</span> <a title="=&gt; java.util.List[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]" id="akka.persistence.AtLeastOnceDelivery;UnconfirmedWarning.getUnconfirmedDeliveries">getUnconfirmedDeliveries</a>: java.util.<span title="java.util.List[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">List</span><span class="delimiter">[</span>UnconfirmedDelivery<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">import</span> scala.collection.<span title="scala.collection.JavaConverters.type">JavaConverters</span>._
      <a href="#akka.persistence.AtLeastOnceDelivery;UnconfirmedWarning.unconfirmedDeliveries" title="(b: Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery])scala.collection.convert.Decorators.AsJava[java.util.List[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]]">unconfirmedDeliveries</a>.<span title="=&gt; java.util.List[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">asJava</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Information about a message that has not been confirmed. Included in [[UnconfirmedWarning]]
   * and [[AtLeastOnceDeliverySnapshot]].
   */</span>
  <span class="keyword">case class</span> <a title="class UnconfirmedDelivery extends AnyRef with Product with Serializable" id="akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery.readResolve">UnconfirmedDelivery</a><a href="#akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery.readResolve" title="Product" class="delimiter">(</a><a title="Long" id="akka.persistence.AtLeastOnceDelivery;UnconfirmedDelivery.deliveryId">deliveryId</a>: <span title="Long">Long</span>, <a title="akka.actor.ActorPath" id="akka.persistence.AtLeastOnceDelivery;UnconfirmedDelivery.destination">destination</a>: <a href="../../../actor/akka/actor/ActorPath.scala.html#akka.actor;ActorPath" title="akka.actor.ActorPath">ActorPath</a>, <a title="Any" id="akka.persistence.AtLeastOnceDelivery;UnconfirmedDelivery.message">message</a>: <span title="Any">Any</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="comment">/**
     * Java API
     */</span>
    <span class="keyword">def</span> <a title="()AnyRef" id="akka.persistence.AtLeastOnceDelivery;UnconfirmedDelivery.getMessage">getMessage</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <a href="#akka.persistence.AtLeastOnceDelivery;UnconfirmedDelivery.message" title="=&gt; Any">message</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * @see [[AtLeastOnceDelivery#maxUnconfirmedMessages]]
   */</span>
  <span class="keyword">class</span> <a title="class MaxUnconfirmedMessagesExceededException extends RuntimeException" id="akka.persistence.AtLeastOnceDelivery;MaxUnconfirmedMessagesExceededException">MaxUnconfirmedMessagesExceededException</a><a href="#akka.persistence.AtLeastOnceDelivery;MaxUnconfirmedMessagesExceededException" title="akka.persistence.AtLeastOnceDelivery.MaxUnconfirmedMessagesExceededException" class="delimiter">(</a><a title="String" id="akka.persistence.AtLeastOnceDelivery;MaxUnconfirmedMessagesExceededException.message">message</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="RuntimeException">RuntimeException</span><span class="delimiter">(</span><a href="#akka.persistence.AtLeastOnceDelivery;MaxUnconfirmedMessagesExceededException.message" title="String">message</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">object</span> <a title="akka.persistence.AtLeastOnceDelivery.Internal.type" id="akka.persistence.AtLeastOnceDelivery.Internal">Internal</a> <a href="#akka.persistence.AtLeastOnceDelivery.Internal" title="akka.persistence.AtLeastOnceDelivery.Internal.type" class="delimiter">{</a>
    <span class="keyword">case class</span> <a title="class Delivery extends AnyRef with Product with Serializable" id="akka.persistence.AtLeastOnceDelivery.Internal.Delivery.readResolve">Delivery</a><a href="#akka.persistence.AtLeastOnceDelivery.Internal.Delivery.readResolve" title="Product" class="delimiter">(</a><a title="akka.actor.ActorPath" id="akka.persistence.AtLeastOnceDelivery.Internal;Delivery.destination">destination</a>: <a href="../../../actor/akka/actor/ActorPath.scala.html#akka.actor;ActorPath" title="akka.actor.ActorPath">ActorPath</a>, <a title="Any" id="akka.persistence.AtLeastOnceDelivery.Internal;Delivery.message">message</a>: <span title="Any">Any</span>, <a title="Long" id="akka.persistence.AtLeastOnceDelivery.Internal;Delivery.timestamp">timestamp</a>: <span title="Long">Long</span>, <a title="Int" id="akka.persistence.AtLeastOnceDelivery.Internal;Delivery.attempt">attempt</a>: <span title="Int">Int</span><span class="delimiter">)</span>
    <span class="keyword">case object</span> <a href="#akka.persistence.AtLeastOnceDelivery.Internal.RedeliveryTick.productElement.x$1" title="akka.persistence.AtLeastOnceDelivery.Internal.RedeliveryTick.type" id="akka.persistence.AtLeastOnceDelivery.Internal.RedeliveryTick.readResolve">RedeliveryTick</a>
  <a href="#akka.persistence.AtLeastOnceDelivery.Internal.RedeliveryTick.readResolve" title="akka.persistence.AtLeastOnceDelivery.Internal.RedeliveryTick.type" class="delimiter">}</a>

<span title="AnyRef" class="delimiter">}</span>

<span class="comment">/**
 * Mix-in this trait with your `PersistentActor` to send messages with at-least-once
 * delivery semantics to destinations. It takes care of re-sending messages when they
 * have not been confirmed within a configurable timeout. Use the [[#deliver]] method to
 * send a message to a destination. Call the [[#confirmDelivery]] method when the destination
 * has replied with a confirmation message.
 *
 * At-least-once delivery implies that original message send order is not always retained
 * and the destination may receive duplicate messages due to possible resends.
 *
 * The interval between redelivery attempts can be defined by [[#redeliverInterval]].
 * After a number of delivery attempts a [[AtLeastOnceDelivery.UnconfirmedWarning]] message
 * will be sent to `self`. The re-sending will still continue, but you can choose to call
 * [[#confirmDelivery]] to cancel the re-sending.
 *
 * The `AtLeastOnceDelivery` trait has a state consisting of unconfirmed messages and a
 * sequence number. It does not store this state itself. You must persist events corresponding
 * to the `deliver` and `confirmDelivery` invocations from your `PersistentActor` so that the
 * state can be restored by calling the same methods during the recovery phase of the
 * `PersistentActor`. Sometimes these events can be derived from other business level events,
 * and sometimes you must create separate events. During recovery calls to `deliver`
 * will not send out the message, but it will be sent later if no matching `confirmDelivery`
 * was performed.
 *
 * Support for snapshots is provided by [[#getDeliverySnapshot]] and [[#setDeliverySnapshot]].
 * The `AtLeastOnceDeliverySnapshot` contains the full delivery state, including unconfirmed messages.
 * If you need a custom snapshot for other parts of the actor state you must also include the
 * `AtLeastOnceDeliverySnapshot`. It is serialized using protobuf with the ordinary Akka
 * serialization mechanism. It is easiest to include the bytes of the `AtLeastOnceDeliverySnapshot`
 * as a blob in your custom snapshot.
 */</span>
<span title="AnyRef" class="keyword">trait</span> <a title="trait AtLeastOnceDelivery extends AnyRef with akka.persistence.Processor" id="akka.persistence;AtLeastOnceDelivery">AtLeastOnceDelivery</a> <span title="Unit" class="keyword">extends</span> <a href="Processor.scala.html#akka.persistence;Processor" title="akka.persistence.Processor">Processor</a> <span class="delimiter">{</span>
  <span class="comment">// FIXME The reason for extending Processor instead of PersistentActor is</span>
  <span class="comment">//       the class hierarchy for UntypedPersistentActorWithAtLeastOnceDelivery</span>
  <span class="keyword">import</span> <a href="#akka.persistence.AtLeastOnceDelivery" title="akka.persistence.AtLeastOnceDelivery.type">AtLeastOnceDelivery</a>._
  <span class="keyword">import</span> <a href="#akka.persistence.AtLeastOnceDelivery" title="akka.persistence.AtLeastOnceDelivery.type">AtLeastOnceDelivery</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal" title="akka.persistence.AtLeastOnceDelivery.Internal.type">Internal</a>._

  <span class="comment">/**
   * Interval between redelivery attempts.
   *
   * The default value can be configured with the
   * `akka.persistence.at-least-once-delivery.redeliver-interval`
   * configuration key. This method can be overridden by implementation classes to return
   * non-default values.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; scala.concurrent.duration.FiniteDuration" id="akka.persistence;AtLeastOnceDelivery.redeliverInterval">redeliverInterval</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span> = <a href="#akka.persistence;AtLeastOnceDelivery.defaultRedeliverInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">defaultRedeliverInterval</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.concurrent.duration.FiniteDuration" id="akka.persistence;AtLeastOnceDelivery.defaultRedeliverInterval">defaultRedeliverInterval</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span> =
    <a href="../../../actor/akka/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.persistence.Persistence">Persistence</a><span class="delimiter">(</span><a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a><span class="delimiter">)</span>.<a href="Persistence.scala.html#akka.persistence;Persistence.settings" title="=&gt; akka.persistence.PersistenceSettings">settings</a>.<a href="Persistence.scala.html#akka.persistence;PersistenceSettings.atLeastOnceDelivery" title="akka.persistence.PersistenceSettings#atLeastOnceDelivery.type">atLeastOnceDelivery</a>.<a href="Persistence.scala.html#akka.persistence;PersistenceSettings.atLeastOnceDelivery.redeliverInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">redeliverInterval</a>

  <span class="comment">/**
   * After this number of delivery attempts a [[AtLeastOnceDelivery.UnconfirmedWarning]] message
   * will be sent to `self`. The count is reset after a restart.
   *
   * The default value can be configured with the
   * `akka.persistence.at-least-once-delivery.warn-after-number-of-unconfirmed-attempts`
   * configuration key. This method can be overridden by implementation classes to return
   * non-default values.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="akka.persistence;AtLeastOnceDelivery.warnAfterNumberOfUnconfirmedAttempts">warnAfterNumberOfUnconfirmedAttempts</a>: <span title="Int">Int</span> = <a href="#akka.persistence;AtLeastOnceDelivery.defaultWarnAfterNumberOfUnconfirmedAttempts" title="=&gt; Int">defaultWarnAfterNumberOfUnconfirmedAttempts</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Int" id="akka.persistence;AtLeastOnceDelivery.defaultWarnAfterNumberOfUnconfirmedAttempts">defaultWarnAfterNumberOfUnconfirmedAttempts</a>: <span title="Int">Int</span> =
    <a href="../../../actor/akka/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.persistence.Persistence">Persistence</a><span class="delimiter">(</span><a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a><span class="delimiter">)</span>.<a href="Persistence.scala.html#akka.persistence;Persistence.settings" title="=&gt; akka.persistence.PersistenceSettings">settings</a>.<a href="Persistence.scala.html#akka.persistence;PersistenceSettings.atLeastOnceDelivery" title="akka.persistence.PersistenceSettings#atLeastOnceDelivery.type">atLeastOnceDelivery</a>.<a href="Persistence.scala.html#akka.persistence;PersistenceSettings.atLeastOnceDelivery.warnAfterNumberOfUnconfirmedAttempts" title="=&gt; Int">warnAfterNumberOfUnconfirmedAttempts</a>

  <span class="comment">/**
   * Maximum number of unconfirmed messages that this actor is allowed to hold in memory.
   * If this number is exceed [[#deliver]] will not accept more messages and it will throw
   * [[AtLeastOnceDelivery.MaxUnconfirmedMessagesExceededException]].
   *
   * The default value can be configured with the
   * `akka.persistence.at-least-once-delivery.max-unconfirmed-messages`
   * configuration key. This method can be overridden by implementation classes to return
   * non-default values.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="akka.persistence;AtLeastOnceDelivery.maxUnconfirmedMessages">maxUnconfirmedMessages</a>: <span title="Int">Int</span> = <a href="#akka.persistence;AtLeastOnceDelivery.defaultMaxUnconfirmedMessages" title="=&gt; Int">defaultMaxUnconfirmedMessages</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Int" id="akka.persistence;AtLeastOnceDelivery.defaultMaxUnconfirmedMessages">defaultMaxUnconfirmedMessages</a>: <span title="Int">Int</span> =
    <a href="../../../actor/akka/actor/Extension.scala.html#akka.actor;ExtensionId.apply" title="(system: akka.actor.ActorSystem)akka.persistence.Persistence">Persistence</a><span class="delimiter">(</span><a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a><span class="delimiter">)</span>.<a href="Persistence.scala.html#akka.persistence;Persistence.settings" title="=&gt; akka.persistence.PersistenceSettings">settings</a>.<a href="Persistence.scala.html#akka.persistence;PersistenceSettings.atLeastOnceDelivery" title="akka.persistence.PersistenceSettings#atLeastOnceDelivery.type">atLeastOnceDelivery</a>.<a href="Persistence.scala.html#akka.persistence;PersistenceSettings.atLeastOnceDelivery.maxUnconfirmedMessages" title="=&gt; Int">maxUnconfirmedMessages</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="akka.actor.Cancellable" id="akka.persistence;AtLeastOnceDelivery.redeliverTask">redeliverTask</a> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.dispatcher
    <span class="keyword">val</span> <a title="scala.concurrent.duration.FiniteDuration" id="akka.persistence;AtLeastOnceDelivery.redeliverTask.interval">interval</a> = <a href="#akka.persistence;AtLeastOnceDelivery.redeliverInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">redeliverInterval</a> <span title="(divisor: Long)scala.concurrent.duration.FiniteDuration">/</span> <span title="Long(2L)" class="int">2</span>
    <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.system" title="=&gt; akka.actor.ActorSystem">system</a>.<a href="../../../actor/akka/actor/ActorSystem.scala.html#akka.actor;ActorSystem.scheduler" title="=&gt; akka.actor.Scheduler">scheduler</a>.<a href="../../../actor/akka/actor/Scheduler.scala.html#akka.actor;Scheduler.schedule(abf8206fc2)" title="(initialDelay: scala.concurrent.duration.FiniteDuration, interval: scala.concurrent.duration.FiniteDuration, receiver: akka.actor.ActorRef, message: Any)(implicit executor: scala.concurrent.ExecutionContext, implicit sender: akka.actor.ActorRef)akka.actor.Cancellable">schedule</a><a href="../../../actor/akka/actor/ActorCell.scala.html#akka.actor;ActorContext.dispatcher" title="=&gt; scala.concurrent.ExecutionContextExecutor" class="delimiter">(</a><a href="#akka.persistence;AtLeastOnceDelivery.redeliverTask.interval" title="scala.concurrent.duration.FiniteDuration">interval</a>, <a href="#akka.persistence;AtLeastOnceDelivery.redeliverTask.interval" title="scala.concurrent.duration.FiniteDuration">interval</a>, <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.self" title="=&gt; akka.actor.ActorRef">self</a>, <a href="#akka.persistence.AtLeastOnceDelivery.Internal.RedeliveryTick.readResolve" title="akka.persistence.AtLeastOnceDelivery.Internal.RedeliveryTick.type">RedeliveryTick</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Long" id="akka.persistence;AtLeastOnceDelivery.deliverySequenceNr_=">deliverySequenceNr</a> = <span title="Long(0L)" class="long">0L</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]" id="akka.persistence;AtLeastOnceDelivery.unconfirmed_=">unconfirmed</a> = immutable.<span title="scala.collection.immutable.SortedMap.type">SortedMap</span>.<span title="[A, B](implicit ord: Ordering[A])scala.collection.immutable.SortedMap[A,B]">empty</span><span title="(implicit ord: Ordering[Long])scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]" class="delimiter">[</span><span title="Long">Long</span>, <a href="#akka.persistence.AtLeastOnceDelivery.Internal.Delivery.readResolve" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">Delivery</a><span class="delimiter">]</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Long" id="akka.persistence;AtLeastOnceDelivery.nextDeliverySequenceNr">nextDeliverySequenceNr</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Long">Long</span> = <span class="delimiter">{</span>
    <a href="#akka.persistence;AtLeastOnceDelivery.deliverySequenceNr_=" title="(x$1: Long)Unit">deliverySequenceNr</a> <span title="(x: Int)Long">+=</span> <span title="Int(1)" class="int">1</span>
    <a href="#akka.persistence;AtLeastOnceDelivery.deliverySequenceNr_=" title="=&gt; Long">deliverySequenceNr</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Scala API: Send the message created by the `deliveryIdToMessage` function to
   * the `destination` actor. It will retry sending the message until
   * the delivery is confirmed with [[#confirmDelivery]]. Correlation
   * between `deliver` and `confirmDelivery` is performed with the
   * `deliveryId` that is provided as parameter to the `deliveryIdToMessage`
   * function. The `deliveryId` is typically passed in the message to the
   * destination, which replies with a message containing the same `deliveryId`.
   *
   * The `deliveryId` is a strictly monotonically increasing sequence number without
   * gaps. The same sequence is used for all destinations of the actor, i.e. when sending
   * to multiple destinations the destinations will see gaps in the sequence if no
   * translation is performed.
   *
   * During recovery this method will not send out the message, but it will be sent
   * later if no matching `confirmDelivery` was performed.
   *
   * This method will throw [[AtLeastOnceDelivery.MaxUnconfirmedMessagesExceededException]]
   * if [[numberOfUnconfirmed]] is greater than or equal to [[#maxUnconfirmedMessages]].
   */</span>
  <span class="keyword">def</span> <a title="(destination: akka.actor.ActorPath, deliveryIdToMessage: Long =&gt; Any)Unit" id="akka.persistence;AtLeastOnceDelivery.deliver">deliver</a><span class="delimiter">(</span><a title="akka.actor.ActorPath" id="akka.persistence;AtLeastOnceDelivery.deliver.destination">destination</a>: <a href="../../../actor/akka/actor/ActorPath.scala.html#akka.actor;ActorPath" title="akka.actor.ActorPath">ActorPath</a>, <a title="Long =&gt; Any" id="akka.persistence;AtLeastOnceDelivery.deliver.deliveryIdToMessage">deliveryIdToMessage</a>: Long ⇒ Any<span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="=&gt; scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">unconfirmed</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;=</span> <a href="#akka.persistence;AtLeastOnceDelivery.maxUnconfirmedMessages" title="=&gt; Int">maxUnconfirmedMessages</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <span title="akka.persistence.AtLeastOnceDelivery.MaxUnconfirmedMessagesExceededException" class="keyword">new</span> <a href="#akka.persistence.AtLeastOnceDelivery;MaxUnconfirmedMessagesExceededException" title="akka.persistence.AtLeastOnceDelivery.MaxUnconfirmedMessagesExceededException">MaxUnconfirmedMessagesExceededException</a><span class="delimiter">(</span>
        <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Too many unconfirmed messages, maximum allowed is [&quot;)">Too many unconfirmed messages, maximum allowed is [$</span><a href="#akka.persistence;AtLeastOnceDelivery.maxUnconfirmedMessages" title="=&gt; Int">maxUnconfirmedMessages</a><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Long" id="akka.persistence;AtLeastOnceDelivery.deliver.deliveryId">deliveryId</a> = <a href="#akka.persistence;AtLeastOnceDelivery.nextDeliverySequenceNr" title="()Long">nextDeliverySequenceNr</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Long" id="akka.persistence;AtLeastOnceDelivery.deliver.now">now</a> = <span title="System.type">System</span>.<span title="()Long">nanoTime</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery" id="akka.persistence;AtLeastOnceDelivery.deliver.d">d</a> = <a href="#akka.persistence.AtLeastOnceDelivery.Internal.Delivery.readResolve" title="(destination: akka.actor.ActorPath, message: Any, timestamp: Long, attempt: Int)akka.persistence.AtLeastOnceDelivery.Internal.Delivery">Delivery</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.deliver.destination" title="akka.actor.ActorPath">destination</a>, <a href="#akka.persistence;AtLeastOnceDelivery.deliver.deliveryIdToMessage" title="(v1: Long)Any">deliveryIdToMessage</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.deliver.deliveryId" title="Long">deliveryId</a><span class="delimiter">)</span>, <a href="#akka.persistence;AtLeastOnceDelivery.deliver.now" title="Long">now</a>, attempt = <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="Processor.scala.html#akka.persistence;ProcessorImpl.recoveryRunning" title="=&gt; Boolean">recoveryRunning</a><span class="delimiter">)</span>
      <a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="(x$1: scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery])Unit">unconfirmed</a> = <a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="=&gt; scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">unconfirmed</a>.<span title="(key: Long, value: akka.persistence.AtLeastOnceDelivery.Internal.Delivery)scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">updated</span><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.deliver.deliveryId" title="Long">deliveryId</a>, <a href="#akka.persistence;AtLeastOnceDelivery.deliver.d" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">d</a><span class="delimiter">)</span>
    <span class="keyword">else</span>
      <a href="#akka.persistence;AtLeastOnceDelivery.send" title="(deliveryId: Long, d: akka.persistence.AtLeastOnceDelivery.Internal.Delivery, timestamp: Long)Unit">send</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.deliver.deliveryId" title="Long">deliveryId</a>, <a href="#akka.persistence;AtLeastOnceDelivery.deliver.d" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">d</a>, <a href="#akka.persistence;AtLeastOnceDelivery.deliver.now" title="Long">now</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Call this method when a message has been confirmed by the destination,
   * or to abort re-sending.
   * @see [[#deliver]]
   * @return `true` the first time the `deliveryId` is confirmed, i.e. `false` for duplicate confirm
   */</span>
  <span class="keyword">def</span> <a title="(deliveryId: Long)Boolean" id="akka.persistence;AtLeastOnceDelivery.confirmDelivery">confirmDelivery</a><span class="delimiter">(</span><a title="Long" id="akka.persistence;AtLeastOnceDelivery.confirmDelivery.deliveryId">deliveryId</a>: <span title="Long">Long</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="=&gt; scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">unconfirmed</a>.<span title="(key: Long)Boolean">contains</span><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.confirmDelivery.deliveryId" title="Long">deliveryId</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="(x$1: scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery])Unit">unconfirmed</a> <span title="(key: Long)scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">-=</span> <a href="#akka.persistence;AtLeastOnceDelivery.confirmDelivery.deliveryId" title="Long">deliveryId</a>
      <span title="Boolean(true)" class="keyword">true</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Number of messages that have not been confirmed yet.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="akka.persistence;AtLeastOnceDelivery.numberOfUnconfirmed">numberOfUnconfirmed</a>: <span title="Int">Int</span> = <a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="=&gt; scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">unconfirmed</a>.<span title="=&gt; Int">size</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="akka.persistence;AtLeastOnceDelivery.redeliverOverdue">redeliverOverdue</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Long" id="akka.persistence;AtLeastOnceDelivery.redeliverOverdue.now">now</a> = <span title="System.type">System</span>.<span title="()Long">nanoTime</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Long" id="akka.persistence;AtLeastOnceDelivery.redeliverOverdue.deadline">deadline</a> = <a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.now" title="Long">now</a> <span title="(x: Long)Long">-</span> <a href="#akka.persistence;AtLeastOnceDelivery.redeliverInterval" title="=&gt; scala.concurrent.duration.FiniteDuration">redeliverInterval</a>.<span title="=&gt; Long">toNanos</span>
    <span class="keyword">var</span> <a title="scala.collection.immutable.Vector[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]" id="akka.persistence;AtLeastOnceDelivery.redeliverOverdue.warnings">warnings</a> = <span title="=&gt; collection.immutable.Vector.type">Vector</span>.<span title="[A]=&gt; scala.collection.immutable.Vector[A]">empty</span><span title="scala.collection.immutable.Vector[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]" class="delimiter">[</span><a href="#akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery.readResolve" title="akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery">UnconfirmedDelivery</a><span class="delimiter">]</span>
    <a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="=&gt; scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">unconfirmed</a> <span title="(f: ((Long, akka.persistence.AtLeastOnceDelivery.Internal.Delivery)) =&gt; Unit)Unit">foreach</span> <a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.$anonfun.x0$1" title="Unit" class="delimiter">{</a>
      <span class="keyword">case</span> <span class="delimiter">(</span><a title="Long" id="akka.persistence;AtLeastOnceDelivery.redeliverOverdue.$anonfun.deliveryId">deliveryId</a>, <a title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery" id="akka.persistence;AtLeastOnceDelivery.redeliverOverdue.$anonfun.delivery">delivery</a><span class="delimiter">)</span> ⇒
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.$anonfun.delivery" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">delivery</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal;Delivery.timestamp" title="=&gt; Long">timestamp</a> <span title="(x: Long)Boolean">&lt;=</span> <a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.deadline" title="Long">deadline</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#akka.persistence;AtLeastOnceDelivery.send" title="(deliveryId: Long, d: akka.persistence.AtLeastOnceDelivery.Internal.Delivery, timestamp: Long)Unit">send</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.$anonfun.deliveryId" title="Long">deliveryId</a>, <a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.$anonfun.delivery" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">delivery</a>, <a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.now" title="Long">now</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.$anonfun.delivery" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">delivery</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal;Delivery.attempt" title="=&gt; Int">attempt</a> <span title="(x: Int)Boolean">==</span> <a href="#akka.persistence;AtLeastOnceDelivery.warnAfterNumberOfUnconfirmedAttempts" title="=&gt; Int">warnAfterNumberOfUnconfirmedAttempts</a><span class="delimiter">)</span>
            <a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.warnings" title="scala.collection.immutable.Vector[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">warnings</a> <span title="(elem: akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery],akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery,scala.collection.immutable.Vector[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]])scala.collection.immutable.Vector[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">:+=</span> <a href="#akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery.readResolve" title="(deliveryId: Long, destination: akka.actor.ActorPath, message: Any)akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery">UnconfirmedDelivery</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.$anonfun.deliveryId" title="Long">deliveryId</a>, <a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.$anonfun.delivery" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">delivery</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal;Delivery.destination" title="=&gt; akka.actor.ActorPath">destination</a>, <a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.$anonfun.delivery" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">delivery</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal;Delivery.message" title="=&gt; Any">message</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.warnings" title="scala.collection.immutable.Vector[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">warnings</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span>
      <a href="../../../actor/akka/actor/package.scala.html#akka.actor.package.actorRef2Scala" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">self</a> <a href="../../../actor/akka/actor/ActorRef.scala.html#akka.actor;ScalaActorRef.!" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.persistence.AtLeastOnceDelivery.UnconfirmedWarning.readResolve" title="(unconfirmedDeliveries: scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery])akka.persistence.AtLeastOnceDelivery.UnconfirmedWarning">UnconfirmedWarning</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue.warnings" title="scala.collection.immutable.Vector[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">warnings</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(deliveryId: Long, d: akka.persistence.AtLeastOnceDelivery.Internal.Delivery, timestamp: Long)Unit" id="akka.persistence;AtLeastOnceDelivery.send">send</a><span class="delimiter">(</span><a title="Long" id="akka.persistence;AtLeastOnceDelivery.send.deliveryId">deliveryId</a>: <span title="Long">Long</span>, <a title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery" id="akka.persistence;AtLeastOnceDelivery.send.d">d</a>: <a href="#akka.persistence.AtLeastOnceDelivery.Internal.Delivery.readResolve" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">Delivery</a>, <a title="Long" id="akka.persistence;AtLeastOnceDelivery.send.timestamp">timestamp</a>: <span title="Long">Long</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="../../../actor/akka/actor/Actor.scala.html#akka.actor;Actor.context" title="=&gt; akka.actor.ActorContext">context</a>.<a href="../../../actor/akka/actor/ActorRefProvider.scala.html#akka.actor;ActorRefFactory.actorSelection(e44b8bc960)" title="(path: akka.actor.ActorPath)akka.actor.ActorSelection">actorSelection</a><a href="../../../actor/akka/actor/ActorSelection.scala.html#akka.actor.ActorSelection.toScala" title="implicit akka.actor.ActorSelection.toScala : (sel: akka.actor.ActorSelection)akka.actor.ScalaActorSelection" class="delimiter">(</a><a href="#akka.persistence;AtLeastOnceDelivery.send.d" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">d</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal;Delivery.destination" title="=&gt; akka.actor.ActorPath">destination</a><span class="delimiter">)</span> <a href="../../../actor/akka/actor/ActorSelection.scala.html#akka.actor;ScalaActorSelection.!" title="(msg: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.persistence;AtLeastOnceDelivery.send.d" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">d</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal;Delivery.message" title="=&gt; Any">message</a>
    <a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="(x$1: scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery])Unit">unconfirmed</a> = <a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="=&gt; scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">unconfirmed</a>.<span title="(key: Long, value: akka.persistence.AtLeastOnceDelivery.Internal.Delivery)scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">updated</span><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.send.deliveryId" title="Long">deliveryId</a>, <a href="#akka.persistence;AtLeastOnceDelivery.send.d" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">d</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal;Delivery.destination" title="akka.actor.ActorPath" id="akka.persistence;AtLeastOnceDelivery.send.x$4">copy</a><span class="delimiter">(</span>timestamp = <a href="#akka.persistence;AtLeastOnceDelivery.send.timestamp" title="Long" id="akka.persistence;AtLeastOnceDelivery.send.x$1">timestamp</a>, attempt = <a href="#akka.persistence;AtLeastOnceDelivery.send.d" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">d</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal;Delivery.attempt" title="=&gt; Int">attempt</a> <a title="Int" id="akka.persistence;AtLeastOnceDelivery.send.x$2">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Full state of the `AtLeastOnceDelivery`. It can be saved with [[PersistentActor#saveSnapshot]].
   * During recovery the snapshot received in [[SnapshotOffer]] should be set
   * with [[#setDeliverySnapshot]].
   *
   * The `AtLeastOnceDeliverySnapshot` contains the full delivery state, including unconfirmed messages.
   * If you need a custom snapshot for other parts of the actor state you must also include the
   * `AtLeastOnceDeliverySnapshot`. It is serialized using protobuf with the ordinary Akka
   * serialization mechanism. It is easiest to include the bytes of the `AtLeastOnceDeliverySnapshot`
   * as a blob in your custom snapshot.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot" id="akka.persistence;AtLeastOnceDelivery.getDeliverySnapshot">getDeliverySnapshot</a>: <a href="#akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot.readResolve" title="akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot">AtLeastOnceDeliverySnapshot</a> =
    <a href="#akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot.readResolve" title="(currentDeliveryId: Long, unconfirmedDeliveries: scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery])akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot">AtLeastOnceDeliverySnapshot</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.deliverySequenceNr_=" title="=&gt; Long">deliverySequenceNr</a>,
      <a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="=&gt; scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">unconfirmed</a>.<span title="(f: ((Long, akka.persistence.AtLeastOnceDelivery.Internal.Delivery)) =&gt; akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery],akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery,scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]])scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">map</span> <a href="#akka.persistence;AtLeastOnceDelivery.getDeliverySnapshot.$anonfun.x0$2" title="akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery" class="delimiter">{</a> <span class="keyword">case</span> <span class="delimiter">(</span><a title="Long" id="akka.persistence;AtLeastOnceDelivery.getDeliverySnapshot.$anonfun.deliveryId">deliveryId</a>, <a title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery" id="akka.persistence;AtLeastOnceDelivery.getDeliverySnapshot.$anonfun.d">d</a><span class="delimiter">)</span> ⇒ <a href="#akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery.readResolve" title="(deliveryId: Long, destination: akka.actor.ActorPath, message: Any)akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery">UnconfirmedDelivery</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.getDeliverySnapshot.$anonfun.deliveryId" title="Long">deliveryId</a>, <a href="#akka.persistence;AtLeastOnceDelivery.getDeliverySnapshot.$anonfun.d" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">d</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal;Delivery.destination" title="=&gt; akka.actor.ActorPath">destination</a>, <a href="#akka.persistence;AtLeastOnceDelivery.getDeliverySnapshot.$anonfun.d" title="akka.persistence.AtLeastOnceDelivery.Internal.Delivery">d</a>.<a href="#akka.persistence.AtLeastOnceDelivery.Internal;Delivery.message" title="=&gt; Any">message</a><span class="delimiter">)</span> <span class="delimiter">}</span><span class="delimiter">(</span><span title="(implicit b: scala.collection.generic.CanBuildFrom[Nothing,akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery,scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]])scala.collection.generic.CanBuildFrom[scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery],akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery,scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]]">breakOut</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * If snapshot from [[#getDeliverySnapshot]] was saved it will be received during recovery
   * in a [[SnapshotOffer]] message and should be set with this method.
   */</span>
  <span class="keyword">def</span> <a title="(snapshot: akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot)Unit" id="akka.persistence;AtLeastOnceDelivery.setDeliverySnapshot">setDeliverySnapshot</a><span class="delimiter">(</span><a title="akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot" id="akka.persistence;AtLeastOnceDelivery.setDeliverySnapshot.snapshot">snapshot</a>: <a href="#akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot.readResolve" title="akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot">AtLeastOnceDeliverySnapshot</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.persistence;AtLeastOnceDelivery.deliverySequenceNr_=" title="(x$1: Long)Unit">deliverySequenceNr</a> = <a href="#akka.persistence;AtLeastOnceDelivery.setDeliverySnapshot.snapshot" title="akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot">snapshot</a>.<a href="#akka.persistence.AtLeastOnceDelivery;AtLeastOnceDeliverySnapshot.currentDeliveryId" title="=&gt; Long">currentDeliveryId</a>
    <span class="keyword">val</span> <a title="Long" id="akka.persistence;AtLeastOnceDelivery.setDeliverySnapshot.now">now</a> = <span title="System.type">System</span>.<span title="()Long">nanoTime</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.persistence;AtLeastOnceDelivery.unconfirmed_=" title="(x$1: scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery])Unit">unconfirmed</a> = <a href="#akka.persistence;AtLeastOnceDelivery.setDeliverySnapshot.snapshot" title="akka.persistence.AtLeastOnceDelivery.AtLeastOnceDeliverySnapshot">snapshot</a>.<a href="#akka.persistence.AtLeastOnceDelivery;AtLeastOnceDeliverySnapshot.unconfirmedDeliveries" title="=&gt; scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery]">unconfirmedDeliveries</a>.<span title="(f: akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery =&gt; (Long, akka.persistence.AtLeastOnceDelivery.Internal.Delivery))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery],(Long, akka.persistence.AtLeastOnceDelivery.Internal.Delivery),scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]])scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]">map</span><span class="delimiter">(</span><a title="akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery" id="akka.persistence;AtLeastOnceDelivery.setDeliverySnapshot.$anonfun.d">d</a> ⇒
      <a href="#akka.persistence;AtLeastOnceDelivery.setDeliverySnapshot.$anonfun.d" title="akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery">d</a>.<a href="#akka.persistence.AtLeastOnceDelivery;UnconfirmedDelivery.deliveryId" title="(x: Long)ArrowAssoc[Long]">deliveryId</a> <span title="(y: akka.persistence.AtLeastOnceDelivery.Internal.Delivery)(Long, akka.persistence.AtLeastOnceDelivery.Internal.Delivery)">-&gt;</span> <a href="#akka.persistence.AtLeastOnceDelivery.Internal.Delivery.readResolve" title="(destination: akka.actor.ActorPath, message: Any, timestamp: Long, attempt: Int)akka.persistence.AtLeastOnceDelivery.Internal.Delivery">Delivery</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.setDeliverySnapshot.$anonfun.d" title="akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery">d</a>.<a href="#akka.persistence.AtLeastOnceDelivery;UnconfirmedDelivery.destination" title="=&gt; akka.actor.ActorPath">destination</a>, <a href="#akka.persistence;AtLeastOnceDelivery.setDeliverySnapshot.$anonfun.d" title="akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery">d</a>.<a href="#akka.persistence.AtLeastOnceDelivery;UnconfirmedDelivery.message" title="=&gt; Any">message</a>, <a href="#akka.persistence;AtLeastOnceDelivery.setDeliverySnapshot.now" title="Long">now</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><span title="(implicit b: scala.collection.generic.CanBuildFrom[Nothing,(Long, akka.persistence.AtLeastOnceDelivery.Internal.Delivery),scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]])scala.collection.generic.CanBuildFrom[scala.collection.immutable.Seq[akka.persistence.AtLeastOnceDelivery.UnconfirmedDelivery],(Long, akka.persistence.AtLeastOnceDelivery.Internal.Delivery),scala.collection.immutable.SortedMap[Long,akka.persistence.AtLeastOnceDelivery.Internal.Delivery]]">breakOut</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * INTERNAL API
   */</span>
  <span class="keyword">override</span> <span class="keyword">protected</span><span class="delimiter">[</span>akka<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(reason: Throwable, message: Option[Any])Unit" id="akka.persistence;AtLeastOnceDelivery.aroundPreRestart">aroundPreRestart</a><span class="delimiter">(</span><a title="Throwable" id="akka.persistence;AtLeastOnceDelivery.aroundPreRestart.reason">reason</a>: <span title="Throwable">Throwable</span>, <a title="Option[Any]" id="akka.persistence;AtLeastOnceDelivery.aroundPreRestart.message">message</a>: <span title="Option[Any]">Option</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.persistence;AtLeastOnceDelivery.redeliverTask" title="=&gt; akka.actor.Cancellable">redeliverTask</a>.<a href="../../../actor/akka/actor/Scheduler.scala.html#akka.actor;Cancellable.cancel" title="()Boolean">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.persistence;AtLeastOnceDelivery" title="akka.persistence.AtLeastOnceDelivery" class="keyword">super</a>.<a href="Processor.scala.html#akka.persistence;ProcessorImpl.aroundPreRestart" title="(reason: Throwable, message: Option[Any])Unit">aroundPreRestart</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.aroundPreRestart.reason" title="Throwable">reason</a>, <a href="#akka.persistence;AtLeastOnceDelivery.aroundPreRestart.message" title="Option[Any]">message</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * INTERNAL API
   */</span>
  <span class="keyword">override</span> <span class="keyword">protected</span><span class="delimiter">[</span>akka<span class="delimiter">]</span> <span class="keyword">def</span> <a title="()Unit" id="akka.persistence;AtLeastOnceDelivery.aroundPostStop">aroundPostStop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.persistence;AtLeastOnceDelivery.redeliverTask" title="=&gt; akka.actor.Cancellable">redeliverTask</a>.<a href="../../../actor/akka/actor/Scheduler.scala.html#akka.actor;Cancellable.cancel" title="()Boolean">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.persistence;AtLeastOnceDelivery" title="akka.persistence.AtLeastOnceDelivery" class="keyword">super</a>.<a href="Processor.scala.html#akka.persistence;ProcessorImpl.aroundPostStop" title="()Unit">aroundPostStop</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * INTERNAL API
   */</span>
  <span class="keyword">override</span> <span class="keyword">protected</span><span class="delimiter">[</span>akka<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(receive: AtLeastOnceDelivery.this.Receive, message: Any)Unit" id="akka.persistence;AtLeastOnceDelivery.aroundReceive">aroundReceive</a><span class="delimiter">(</span><a title="AtLeastOnceDelivery.this.Receive" id="akka.persistence;AtLeastOnceDelivery.aroundReceive.receive">receive</a>: <span title="AtLeastOnceDelivery.this.Receive">Receive</span>, <a title="Any" id="akka.persistence;AtLeastOnceDelivery.aroundReceive.message">message</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a href="#akka.persistence;AtLeastOnceDelivery.aroundReceive.message" title="Any">message</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#akka.persistence.AtLeastOnceDelivery.Internal.RedeliveryTick.readResolve" title="akka.persistence.AtLeastOnceDelivery.Internal.RedeliveryTick.type">RedeliveryTick</a> ⇒ <a href="#akka.persistence;AtLeastOnceDelivery.redeliverOverdue" title="()Unit">redeliverOverdue</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">case</span> _              ⇒ <a href="#akka.persistence;AtLeastOnceDelivery" title="akka.persistence.AtLeastOnceDelivery" class="keyword">super</a>.<a href="Recovery.scala.html#akka.persistence;Recovery.aroundReceive" title="(receive: AtLeastOnceDelivery.this.Receive, message: Any)Unit">aroundReceive</a><span class="delimiter">(</span><a href="#akka.persistence;AtLeastOnceDelivery.aroundReceive.receive" title="AtLeastOnceDelivery.this.Receive">receive</a>, <a href="#akka.persistence;AtLeastOnceDelivery.aroundReceive.message" title="Any">message</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Java API: Use this class instead of `UntypedPersistentActor` to send messages
 * with at-least-once delivery semantics to destinations.
 * Full documentation in [[AtLeastOnceDelivery]].
 *
 * @see [[AtLeastOnceDelivery]]
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class UntypedPersistentActorWithAtLeastOnceDelivery extends akka.persistence.UntypedPersistentActor with akka.persistence.AtLeastOnceDelivery" id="akka.persistence;UntypedPersistentActorWithAtLeastOnceDelivery">UntypedPersistentActorWithAtLeastOnceDelivery</a> <a href="#akka.persistence;UntypedPersistentActorWithAtLeastOnceDelivery" title="akka.persistence.UntypedPersistentActorWithAtLeastOnceDelivery" class="keyword">extends</a> <a href="Eventsourced.scala.html#akka.persistence;UntypedPersistentActor" title="akka.persistence.UntypedPersistentActor">UntypedPersistentActor</a> <span class="keyword">with</span> <a href="#akka.persistence;AtLeastOnceDelivery" title="akka.persistence.AtLeastOnceDelivery">AtLeastOnceDelivery</a> <span class="delimiter">{</span>
  <span class="comment">/**
   * Java API: Send the message created by the `deliveryIdToMessage` function to
   * the `destination` actor. It will retry sending the message until
   * the delivery is confirmed with [[#confirmDelivery]]. Correlation
   * between `deliver` and `confirmDelivery` is performed with the
   * `deliveryId` that is provided as parameter to the `deliveryIdToMessage`
   * function. The `deliveryId` is typically passed in the message to the
   * destination, which replies with a message containing the same `deliveryId`.
   *
   * The `deliveryId` is a strictly monotonically increasing sequence number without
   * gaps. The same sequence is used for all destinations, i.e. when sending to
   * multiple destinations the destinations will see gaps in the sequence if no
   * translation is performed.
   *
   * During recovery this method will not send out the message, but it will be sent
   * later if no matching `confirmDelivery` was performed.
   *
   * This method will throw [[AtLeastOnceDelivery.MaxUnconfirmedMessagesExceededException]]
   * if [[numberOfUnconfirmed]] is greater than or equal to [[#maxUnconfirmedMessages]].
   */</span>
  <span class="keyword">def</span> <a title="(destination: akka.actor.ActorPath, deliveryIdToMessage: akka.japi.Function[Long,Object])Unit" id="akka.persistence;UntypedPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0)">deliver</a><span class="delimiter">(</span><a title="akka.actor.ActorPath" id="akka.persistence;UntypedPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).destination">destination</a>: <a href="../../../actor/akka/actor/ActorPath.scala.html#akka.actor;ActorPath" title="akka.actor.ActorPath">ActorPath</a>, <a title="akka.japi.Function[Long,Object]" id="akka.persistence;UntypedPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).deliveryIdToMessage">deliveryIdToMessage</a>: akka.japi.<a href="../../../actor/akka/japi/JavaAPI.scala.html#akka.japi;Function" title="akka.japi.Function[Long,Object]">Function</a><span class="delimiter">[</span>java.lang.Long, Object<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a href="#akka.persistence;UntypedPersistentActorWithAtLeastOnceDelivery" title="akka.persistence.UntypedPersistentActorWithAtLeastOnceDelivery" class="keyword">super</a>.<a href="#akka.persistence;AtLeastOnceDelivery.deliver" title="(destination: akka.actor.ActorPath, deliveryIdToMessage: Long =&gt; Any)Unit">deliver</a><span class="delimiter">(</span><a href="#akka.persistence;UntypedPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).destination" title="akka.actor.ActorPath">destination</a>, <a title="Long" id="akka.persistence;UntypedPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).$anonfun.id">id</a> ⇒ <a href="#akka.persistence;UntypedPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).deliveryIdToMessage" title="akka.japi.Function[Long,Object]">deliveryIdToMessage</a>.<a href="../../../actor/akka/japi/JavaAPI.scala.html#akka.japi;Function.apply" title="(param: Long)Object">apply</a><span class="delimiter">(</span><a href="#akka.persistence;UntypedPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).$anonfun.id" title="implicit scala.Predef.long2Long : (x: Long)Long">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Java API compatible with lambda expressions
 *
 * Use this class instead of `UntypedPersistentActor` to send messages
 * with at-least-once delivery semantics to destinations.
 * Full documentation in [[AtLeastOnceDelivery]].
 *
 * @see [[AtLeastOnceDelivery]]
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class AbstractPersistentActorWithAtLeastOnceDelivery extends akka.persistence.AbstractPersistentActor with akka.persistence.AtLeastOnceDelivery" id="akka.persistence;AbstractPersistentActorWithAtLeastOnceDelivery">AbstractPersistentActorWithAtLeastOnceDelivery</a> <a href="#akka.persistence;AbstractPersistentActorWithAtLeastOnceDelivery" title="akka.persistence.AbstractPersistentActorWithAtLeastOnceDelivery" class="keyword">extends</a> <a href="Eventsourced.scala.html#akka.persistence;AbstractPersistentActor" title="akka.persistence.AbstractPersistentActor">AbstractPersistentActor</a> <span class="keyword">with</span> <a href="#akka.persistence;AtLeastOnceDelivery" title="akka.persistence.AtLeastOnceDelivery">AtLeastOnceDelivery</a> <span class="delimiter">{</span>
  <span class="comment">/**
   * Java API: Send the message created by the `deliveryIdToMessage` function to
   * the `destination` actor. It will retry sending the message until
   * the delivery is confirmed with [[#confirmDelivery]]. Correlation
   * between `deliver` and `confirmDelivery` is performed with the
   * `deliveryId` that is provided as parameter to the `deliveryIdToMessage`
   * function. The `deliveryId` is typically passed in the message to the
   * destination, which replies with a message containing the same `deliveryId`.
   *
   * The `deliveryId` is a strictly monotonically increasing sequence number without
   * gaps. The same sequence is used for all destinations, i.e. when sending to
   * multiple destinations the destinations will see gaps in the sequence if no
   * translation is performed.
   *
   * During recovery this method will not send out the message, but it will be sent
   * later if no matching `confirmDelivery` was performed.
   *
   * This method will throw [[AtLeastOnceDelivery.MaxUnconfirmedMessagesExceededException]]
   * if [[numberOfUnconfirmed]] is greater than or equal to [[#maxUnconfirmedMessages]].
   */</span>
  <span class="keyword">def</span> <a title="(destination: akka.actor.ActorPath, deliveryIdToMessage: akka.japi.Function[Long,Object])Unit" id="akka.persistence;AbstractPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0)">deliver</a><span class="delimiter">(</span><a title="akka.actor.ActorPath" id="akka.persistence;AbstractPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).destination">destination</a>: <a href="../../../actor/akka/actor/ActorPath.scala.html#akka.actor;ActorPath" title="akka.actor.ActorPath">ActorPath</a>, <a title="akka.japi.Function[Long,Object]" id="akka.persistence;AbstractPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).deliveryIdToMessage">deliveryIdToMessage</a>: akka.japi.<a href="../../../actor/akka/japi/JavaAPI.scala.html#akka.japi;Function" title="akka.japi.Function[Long,Object]">Function</a><span class="delimiter">[</span>java.lang.Long, Object<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a href="#akka.persistence;AbstractPersistentActorWithAtLeastOnceDelivery" title="akka.persistence.AbstractPersistentActorWithAtLeastOnceDelivery" class="keyword">super</a>.<a href="#akka.persistence;AtLeastOnceDelivery.deliver" title="(destination: akka.actor.ActorPath, deliveryIdToMessage: Long =&gt; Any)Unit">deliver</a><span class="delimiter">(</span><a href="#akka.persistence;AbstractPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).destination" title="akka.actor.ActorPath">destination</a>, <a title="Long" id="akka.persistence;AbstractPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).$anonfun.id">id</a> ⇒ <a href="#akka.persistence;AbstractPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).deliveryIdToMessage" title="akka.japi.Function[Long,Object]">deliveryIdToMessage</a>.<a href="../../../actor/akka/japi/JavaAPI.scala.html#akka.japi;Function.apply" title="(param: Long)Object">apply</a><span class="delimiter">(</span><a href="#akka.persistence;AbstractPersistentActorWithAtLeastOnceDelivery.deliver(9b2ea794d0).$anonfun.id" title="implicit scala.Predef.long2Long : (x: Long)Long">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

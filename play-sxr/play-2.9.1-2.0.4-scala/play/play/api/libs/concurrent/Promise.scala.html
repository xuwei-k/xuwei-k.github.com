<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>play/play/api/libs/concurrent/Promise.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> play.api.libs.concurrent

<span class="keyword">import</span> play.core._
<span class="keyword">import</span> play.api._

<span class="keyword">import</span> akka.actor._
<span class="keyword">import</span> akka.actor.<span title="object akka.actor.Actor">Actor</span>._

<span class="keyword">import</span> java.util.concurrent.<span class="delimiter">{</span> TimeUnit <span class="delimiter">}</span>

<span class="keyword">import</span> scala.collection.mutable.Builder
<span class="keyword">import</span> scala.collection._
<span class="keyword">import</span> scala.collection.generic.CanBuildFrom

<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait PromiseValue[+A] extends java.lang.Object with ScalaObject" id="13524">PromiseValue</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="13769">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="77446">isDefined</a> = <a href="#13524" title="play.api.libs.concurrent.PromiseValue[A]" class="keyword">this</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a href="#174846" title="Boolean(false)">Waiting</a> =&gt; <span title="Boolean(false)" class="keyword">false</span>; <span class="keyword">case</span> <span title="Boolean(true)">_</span> =&gt; <span title="Boolean(true)" class="keyword">true</span> <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait NotWaiting[+A] extends java.lang.Object with play.api.libs.concurrent.PromiseValue[A] with ScalaObject" id="13545">NotWaiting</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="13770">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <a href="#13524" title="play.api.libs.concurrent.PromiseValue[A]">PromiseValue</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="comment">/**
   * Return the value or the promise, throw it if it held an exception
   */</span>
  <span class="keyword">def</span> <a title="=&gt; A" id="77448">get</a>: <a href="#13770" title="A">A</a> = <a href="#13545" title="play.api.libs.concurrent.NotWaiting[A]" class="keyword">this</a> <span title="A" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Nothing">Thrown</span><span class="delimiter">(</span><a title="Throwable" id="174771">e</a><span class="delimiter">)</span> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="#174771" title="Throwable">e</a>
    <span class="keyword">case</span> <span title="A">Redeemed</span><span class="delimiter">(</span><a title="A" id="174773">a</a><span class="delimiter">)</span> =&gt; <a href="#174773" title="A">a</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[B](onError: Throwable =&gt; B, onSuccess: A =&gt; B)B" id="77449">fold</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="77451">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Throwable =&gt; B" id="174774">onError</a>: Throwable =&gt; B, <a title="A =&gt; B" id="174775">onSuccess</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#77451" title="B">B</a> = <a href="#13545" title="play.api.libs.concurrent.NotWaiting[A]" class="keyword">this</a> <span title="B" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="B">Thrown</span><span class="delimiter">(</span><a title="Throwable" id="174779">e</a><span class="delimiter">)</span> =&gt; <a href="#174774" title="(v1: Throwable)B">onError</a><span class="delimiter">(</span><a href="#174779" title="Throwable">e</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="B">Redeemed</span><span class="delimiter">(</span><a title="A" id="174782">r</a><span class="delimiter">)</span> =&gt; <a href="#174775" title="(v1: A)B">onSuccess</a><span class="delimiter">(</span><a href="#174782" title="A">r</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class Thrown extends java.lang.Object with play.api.libs.concurrent.NotWaiting[Nothing] with ScalaObject with Product with Serializable" id="177401">Thrown</a><a href="#177401" title="ScalaObject" class="delimiter">(</a><a title="Throwable" id="174060">e</a>: scala.<span title="Throwable">Throwable</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#13545" title="play.api.libs.concurrent.NotWaiting[Nothing]">NotWaiting</a><span class="delimiter">[</span>Nothing<span class="delimiter">]</span>
case <span class="keyword">class</span> <a title="class Redeemed[+A] extends java.lang.Object with play.api.libs.concurrent.NotWaiting[A] with ScalaObject with Product with Serializable" id="177397">Redeemed</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="103015">A</a><span class="delimiter">]</span><a href="#177397" title="ScalaObject" class="delimiter">(</a><a title="A" id="174105">a</a>: <a href="#103015" title="A">A</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#13545" title="play.api.libs.concurrent.NotWaiting[A]">NotWaiting</a><span class="delimiter">[</span>A<span class="delimiter">]</span>
case <span class="keyword">object</span> <a href="#174841" title="object play.api.libs.concurrent.Waiting" id="174846">Waiting</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#13524" title="play.api.libs.concurrent.PromiseValue[Nothing]">PromiseValue</a><span class="delimiter">[</span>Nothing<span class="delimiter">]</span>

<span class="keyword">trait</span> <a title="trait Promise[+A] extends java.lang.Object with ScalaObject" id="13536">Promise</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="13772">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(k: A =&gt; Unit)Unit" id="75996">onRedeem</a><span class="delimiter">(</span><a title="A =&gt; Unit" id="174036">k</a>: A =&gt; Unit<span class="delimiter">)</span>: <span title="Unit">Unit</span>

  <span class="keyword">def</span> <a title="[AA &gt;: A](pf: PartialFunction[Throwable,AA])play.api.libs.concurrent.Promise[AA]" id="75997">recover</a> <span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="75999">AA</a> &gt;: A<span class="delimiter">]</span> <span class="delimiter">(</span><a title="PartialFunction[Throwable,AA]" id="174849">pf</a>: <span title="PartialFunction[Throwable,AA]">PartialFunction</span><span class="delimiter">[</span>Throwable, AA<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[AA]">Promise</a><span class="delimiter">[</span>AA<span class="delimiter">]</span> = <a href="#76003" title="(k: play.api.libs.concurrent.NotWaiting[A] =&gt; AA)play.api.libs.concurrent.Promise[AA]">extend1</a><a href="#174855" title="AA" class="delimiter">{</a>
    <span class="keyword">case</span> <span title="AA">Thrown</span><span class="delimiter">(</span><a title="Throwable" id="174856">e</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#174849" title="PartialFunction[Throwable,AA]">pf</a>.<span title="(x: Throwable)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#174856" title="Throwable">e</a><span class="delimiter">)</span> =&gt; <a href="#174849" title="(v1: Throwable)AA">pf</a><span class="delimiter">(</span><a href="#174856" title="Throwable">e</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Nothing">Thrown</span><span class="delimiter">(</span><a title="Throwable" id="174859">e</a><span class="delimiter">)</span> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="#174859" title="Throwable">e</a>
    <span class="keyword">case</span> <span title="A">Redeemed</span><span class="delimiter">(</span><a title="A" id="174861">a</a><span class="delimiter">)</span> =&gt; <a href="#174861" title="A">a</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[B](k: play.api.libs.concurrent.Promise[A] =&gt; B)play.api.libs.concurrent.Promise[B]" id="76000">extend</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="76002">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[A] =&gt; B" id="174076">k</a>: <span title="play.api.libs.concurrent.Promise[A] =&gt; B">Function1</span><span class="delimiter">[</span>Promise<span class="delimiter">[</span>A<span class="delimiter">]</span>, B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[B]">Promise</a><span class="delimiter">[</span>B<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="[B](k: play.api.libs.concurrent.NotWaiting[A] =&gt; B)play.api.libs.concurrent.Promise[B]" id="76003">extend1</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="76005">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="play.api.libs.concurrent.NotWaiting[A] =&gt; B" id="103003">k</a>: <span title="play.api.libs.concurrent.NotWaiting[A] =&gt; B">Function1</span><span class="delimiter">[</span>NotWaiting<span class="delimiter">[</span>A<span class="delimiter">]</span>, B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[B]">Promise</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <a href="#76000" title="[B](k: play.api.libs.concurrent.Promise[A] =&gt; B)play.api.libs.concurrent.Promise[B]">extend</a><span title="(k: play.api.libs.concurrent.Promise[A] =&gt; B)play.api.libs.concurrent.Promise[B]" class="delimiter">[</span><a href="#76005" title="B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[A]" id="174865">p</a> =&gt; <a href="#103003" title="(v1: play.api.libs.concurrent.NotWaiting[A])B">k</a><span class="delimiter">(</span><a href="#174865" title="play.api.libs.concurrent.Promise[A]">p</a>.<a href="#76006" title="=&gt; play.api.libs.concurrent.NotWaiting[A]">value</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; play.api.libs.concurrent.NotWaiting[A]" id="76006">value</a> = <a href="#76007" title="=&gt; play.api.libs.concurrent.NotWaiting[A]">await</a>

  <span class="keyword">def</span> <a title="=&gt; play.api.libs.concurrent.NotWaiting[A]" id="76007">await</a>: <a href="#13545" title="play.api.libs.concurrent.NotWaiting[A]">NotWaiting</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#76008" title="(timeout: Long, unit: java.util.concurrent.TimeUnit)play.api.libs.concurrent.NotWaiting[A]">await</a><span class="delimiter">(</span><span title="Long(5000L)" class="int">5000</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(timeout: Long, unit: java.util.concurrent.TimeUnit)play.api.libs.concurrent.NotWaiting[A]" id="76008">await</a><span class="delimiter">(</span><a title="Long" id="77452">timeout</a>: <span title="Long">Long</span>, <a title="java.util.concurrent.TimeUnit" id="77455">unit</a>: <span title="java.util.concurrent.TimeUnit">TimeUnit</span> = TimeUnit.<span title="java.util.concurrent.TimeUnit(value MILLISECONDS)">MILLISECONDS</span><span class="delimiter">)</span>: <a href="#13545" title="play.api.libs.concurrent.NotWaiting[A]">NotWaiting</a><span class="delimiter">[</span>A<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(p: A =&gt; Boolean)play.api.libs.concurrent.Promise[A]" id="76009">filter</a><span class="delimiter">(</span><a title="A =&gt; Boolean" id="174312">p</a>: A =&gt; Boolean<span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[A]">Promise</a><span class="delimiter">[</span>A<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="[B](f: A =&gt; B)play.api.libs.concurrent.Promise[B]" id="76010">map</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="76012">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; B" id="102960">f</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[B]">Promise</a><span class="delimiter">[</span>B<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="[B](f: A =&gt; play.api.libs.concurrent.Promise[B])play.api.libs.concurrent.Promise[B]" id="76013">flatMap</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="76015">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; play.api.libs.concurrent.Promise[B]" id="76022">f</a>: A =&gt; Promise<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[B]">Promise</a><span class="delimiter">[</span>B<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="[B](other: play.api.libs.concurrent.Promise[B])play.api.libs.concurrent.Promise[Either[A,B]]" id="76016">or</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="76018">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[B]" id="174871">other</a>: <a href="#13536" title="play.api.libs.concurrent.Promise[B]">Promise</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[Either[A,B]]">Promise</a><span class="delimiter">[</span>Either<span class="delimiter">[</span>A, B<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> scala.concurrent.stm._

    <span class="keyword">val</span> <a title="Promise extends play.api.libs.concurrent.Promise[Either[A,B]] with play.api.libs.concurrent.Redeemable[Either[A,B]]" id="174875">p</a> = <a href="#78506" title="[A]()play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]">Promise</a><span title="()play.api.libs.concurrent.Promise[Either[A,B]] with play.api.libs.concurrent.Redeemable[Either[A,B]]" class="delimiter">[</span><span title="Either[A,B]">Either</span><span class="delimiter">[</span>A, B<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.concurrent.stm.Ref[Boolean]" id="174876">ref</a> = <span title="(initialValue: Boolean)scala.concurrent.stm.Ref[Boolean]">Ref</span><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
    <a href="#13536" title="Promise.this.type" class="keyword">this</a>.<a href="#76003" title="(k: play.api.libs.concurrent.NotWaiting[A] =&gt; Unit)play.api.libs.concurrent.Promise[Unit]">extend1</a> <span class="delimiter">{</span> <a title="play.api.libs.concurrent.NotWaiting[A]" id="175475">v</a> =&gt;
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#174876" title="scala.concurrent.stm.Ref[Boolean]">ref</a>.<span title="()Boolean">single</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Boolean" id="175564">iRedeemed</a> = <a href="#174876" title="scala.concurrent.stm.Ref[Boolean]">ref</a>.<span title="=&gt; scala.concurrent.stm.Ref.View[Boolean]">single</span>.<span title="(f: Boolean =&gt; Boolean)Boolean">getAndTransform</span><span class="delimiter">(</span><a title="Boolean" id="175567">_</a> =&gt; <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span> <a href="#175564" title="Boolean">iRedeemed</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#175475" title="play.api.libs.concurrent.NotWaiting[A]">v</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="Unit">Redeemed</span><span class="delimiter">(</span><a title="A" id="175569">a</a><span class="delimiter">)</span> =&gt;
            <a href="#174875" title="Promise extends play.api.libs.concurrent.Promise[Either[A,B]] with play.api.libs.concurrent.Redeemable[Either[A,B]]">p</a>.<a href="#102929" title="(a: =&gt; Either[A,B])Unit">redeem</a><span class="delimiter">(</span><span title="(a: A)Left[A,Nothing]">Left</span><span class="delimiter">(</span><a href="#175569" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit">Thrown</span><span class="delimiter">(</span><a title="Throwable" id="175575">e</a><span class="delimiter">)</span> =&gt;
            <a href="#174875" title="Promise extends play.api.libs.concurrent.Promise[Either[A,B]] with play.api.libs.concurrent.Redeemable[Either[A,B]]">p</a>.<a href="#102930" title="(t: Throwable)Unit">throwing</a><span class="delimiter">(</span><a href="#175575" title="Throwable">e</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
                        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#174871" title="play.api.libs.concurrent.Promise[B]">other</a>.<a href="#76003" title="(k: play.api.libs.concurrent.NotWaiting[B] =&gt; Unit)play.api.libs.concurrent.Promise[Unit]">extend1</a> <span class="delimiter">{</span> <a title="play.api.libs.concurrent.NotWaiting[B]" id="175581">v</a> =&gt;
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#174876" title="scala.concurrent.stm.Ref[Boolean]">ref</a>.<span title="()Boolean">single</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Boolean" id="175582">iRedeemed</a> = <a href="#174876" title="scala.concurrent.stm.Ref[Boolean]">ref</a>.<span title="=&gt; scala.concurrent.stm.Ref.View[Boolean]">single</span>.<span title="(f: Boolean =&gt; Boolean)Boolean">getAndTransform</span><span class="delimiter">(</span><a title="Boolean" id="175584">_</a> =&gt; <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span> <a href="#175582" title="Boolean">iRedeemed</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#175581" title="play.api.libs.concurrent.NotWaiting[B]">v</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="Unit">Redeemed</span><span class="delimiter">(</span><a title="B" id="175586">a</a><span class="delimiter">)</span> =&gt;
            <a href="#174875" title="Promise extends play.api.libs.concurrent.Promise[Either[A,B]] with play.api.libs.concurrent.Redeemable[Either[A,B]]">p</a>.<a href="#102929" title="(a: =&gt; Either[A,B])Unit">redeem</a><span class="delimiter">(</span><span title="(b: B)Right[Nothing,B]">Right</span><span class="delimiter">(</span><a href="#175586" title="B">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit">Thrown</span><span class="delimiter">(</span><a title="Throwable" id="175591">e</a><span class="delimiter">)</span> =&gt;
            <a href="#174875" title="Promise extends play.api.libs.concurrent.Promise[Either[A,B]] with play.api.libs.concurrent.Redeemable[Either[A,B]]">p</a>.<a href="#102930" title="(t: Throwable)Unit">throwing</a><span class="delimiter">(</span><a href="#175591" title="Throwable">e</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
                        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#174875" title="Promise extends play.api.libs.concurrent.Promise[Either[A,B]] with play.api.libs.concurrent.Redeemable[Either[A,B]]">p</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[B](message: =&gt; B, duration: Long, unit: java.util.concurrent.TimeUnit)play.api.libs.concurrent.Promise[Either[A,B]]" id="76019">orTimeout</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="175599">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; B" id="175593">message</a>: =&gt; B, <a title="Long" id="175594">duration</a>: <span title="Long">Long</span>, <a title="java.util.concurrent.TimeUnit" id="175597">unit</a>: <span title="java.util.concurrent.TimeUnit">TimeUnit</span> = TimeUnit.<span title="java.util.concurrent.TimeUnit(value MILLISECONDS)">MILLISECONDS</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[Either[A,B]]">Promise</a><span class="delimiter">[</span>Either<span class="delimiter">[</span>A, B<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#76016" title="(other: play.api.libs.concurrent.Promise[B])play.api.libs.concurrent.Promise[Either[A,B]]">or</a><span class="delimiter">(</span><a href="#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="#78512" title="(message: =&gt; B, duration: Long, unit: java.util.concurrent.TimeUnit)play.api.libs.concurrent.Promise[B]">timeout</a><span class="delimiter">(</span><a href="#175593" title="=&gt; B">message</a>, <a href="#175594" title="Long">duration</a>, <a href="#175597" title="java.util.concurrent.TimeUnit">unit</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait Redeemable[-A] extends java.lang.Object" id="13680">Redeemable</a><span class="delimiter">[</span>-<a title="&gt;: Nothing &lt;: Any" id="13773">A</a><span class="delimiter">]</span> <span title="java.lang.Object" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(a: =&gt; A)Unit" id="102929">redeem</a><span class="delimiter">(</span><a title="=&gt; A" id="102950">a</a>: =&gt; A<span class="delimiter">)</span>: <span title="Unit">Unit</span>
  <span class="keyword">def</span> <a title="(t: Throwable)Unit" id="102930">throwing</a><span class="delimiter">(</span><a title="Throwable" id="174368">t</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class STMPromise[A] extends java.lang.Object with play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A] with ScalaObject" id="13641">STMPromise</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="13774">A</a><span class="delimiter">]</span> <a href="#13641" title="ScalaObject" class="keyword">extends</a> <a href="#13536" title="play.api.libs.concurrent.Promise[A]">Promise</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="keyword">with</span> <a href="#13680" title="play.api.libs.concurrent.Redeemable[A]">Redeemable</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> scala.concurrent.stm._

  <span class="keyword">val</span> <a title="scala.concurrent.stm.Ref[List[play.api.libs.concurrent.Promise[A] =&gt; Unit]]" id="175642">actions</a>: <span title="scala.concurrent.stm.Ref[List[play.api.libs.concurrent.Promise[A] =&gt; Unit]]">Ref</span><span class="delimiter">[</span>List<span class="delimiter">[</span>Promise<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Unit<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="(initialValue: List[play.api.libs.concurrent.Promise[A] =&gt; Unit])(implicit om: scala.reflect.OptManifest[List[play.api.libs.concurrent.Promise[A] =&gt; Unit]])scala.concurrent.stm.Ref[List[play.api.libs.concurrent.Promise[A] =&gt; Unit]]">Ref</span><span title="(clazz: java.lang.Class[_], arg1: scala.reflect.OptManifest[_], args: scala.reflect.OptManifest[_]*)scala.reflect.ClassManifest[List[play.api.libs.concurrent.Promise[A] =&gt; Unit]]" class="delimiter">(</span>List<span title="object Nil" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">var</span> <a title="scala.concurrent.stm.Ref[play.api.libs.concurrent.PromiseValue[A]]" id="175645">redeemed</a>: <span title="scala.concurrent.stm.Ref[play.api.libs.concurrent.PromiseValue[A]]">Ref</span><span class="delimiter">[</span>PromiseValue<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="(initialValue: play.api.libs.concurrent.PromiseValue[A])(implicit om: scala.reflect.OptManifest[play.api.libs.concurrent.PromiseValue[A]])scala.concurrent.stm.Ref[play.api.libs.concurrent.PromiseValue[A]]">Ref</span><span title="(clazz: java.lang.Class[_], arg1: scala.reflect.OptManifest[_], args: scala.reflect.OptManifest[_]*)scala.reflect.ClassManifest[play.api.libs.concurrent.PromiseValue[A]]" class="delimiter">(</span><a href="#174846" title="object play.api.libs.concurrent.Waiting">Waiting</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[B](k: play.api.libs.concurrent.Promise[A] =&gt; B)play.api.libs.concurrent.Promise[B]" id="175647">extend</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="175649">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[A] =&gt; B" id="175829">k</a>: <span title="play.api.libs.concurrent.Promise[A] =&gt; B">Function1</span><span class="delimiter">[</span>Promise<span class="delimiter">[</span>A<span class="delimiter">]</span>, B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[B]">Promise</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="play.api.libs.concurrent.STMPromise[B]" id="175835">result</a> = <span title="play.api.libs.concurrent.STMPromise[B]" class="keyword">new</span> <a href="#13641" title="play.api.libs.concurrent.STMPromise[B]">STMPromise</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#175655" title="(k: play.api.libs.concurrent.Promise[A] =&gt; Unit)Unit">addAction</a><span class="delimiter">{</span> <a title="play.api.libs.concurrent.Promise[A]" id="175839">p</a> =&gt;
      <span class="keyword">val</span> <a title="Either[Throwable,B]" id="175840">bOrExc</a> = scala.util.control.<span title="object scala.util.control.Exception">Exception</span>.<span title="[T]=&gt; util.control.Exception.Catch[T]">allCatch</span><span title="util.control.Exception.Catch[B]" class="delimiter">[</span><a href="#175649" title="B">B</a><span class="delimiter">]</span>.<span title="(body: =&gt; B)Either[Throwable,B]">either</span><span class="delimiter">(</span><a href="#175829" title="(v1: play.api.libs.concurrent.Promise[A])B">k</a><span class="delimiter">(</span><a href="#175839" title="play.api.libs.concurrent.Promise[A]">p</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#175840" title="Either[Throwable,B]">bOrExc</a>.<span title="(fa: Throwable =&gt; Unit, fb: B =&gt; Unit)Unit">fold</span><span class="delimiter">(</span> <a title="Throwable" id="175853">e</a> =&gt; <a href="#175835" title="play.api.libs.concurrent.STMPromise[B]">result</a>.<a href="#175661" title="(t: Throwable)Unit">throwing</a><span class="delimiter">(</span><a href="#175853" title="Throwable">e</a><span class="delimiter">)</span>, <a title="B" id="175857">b</a> =&gt; <a href="#175835" title="play.api.libs.concurrent.STMPromise[B]">result</a>.<a href="#175660" title="(body: =&gt; B)Unit">redeem</a><span class="delimiter">(</span><a href="#175857" title="B">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#175835" title="play.api.libs.concurrent.STMPromise[B]">result</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(p: A =&gt; Boolean)play.api.libs.concurrent.Promise[A]" id="175650">filter</a><span class="delimiter">(</span><a title="A =&gt; Boolean" id="175865">p</a>: A =&gt; Boolean<span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[A]">Promise</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="play.api.libs.concurrent.STMPromise[A]" id="175868">result</a> = <span title="play.api.libs.concurrent.STMPromise[A]" class="keyword">new</span> <a href="#13641" title="play.api.libs.concurrent.STMPromise[A]">STMPromise</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#175654" title="(k: A =&gt; Unit)Unit">onRedeem</a><span class="delimiter">(</span><a title="A" id="175873">a</a> =&gt; <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#175865" title="(v1: A)Boolean">p</a><span class="delimiter">(</span><a href="#175873" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#175868" title="play.api.libs.concurrent.STMPromise[A]">result</a>.<a href="#175660" title="(body: =&gt; A)Unit">redeem</a><span class="delimiter">(</span><a href="#175873" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#175868" title="play.api.libs.concurrent.STMPromise[A]">result</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[B](p: PartialFunction[A,B])play.api.libs.concurrent.STMPromise[B]" id="175651">collect</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="175653">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="PartialFunction[A,B]" id="175876">p</a>: <span title="PartialFunction[A,B]">PartialFunction</span><span class="delimiter">[</span>A, B<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="play.api.libs.concurrent.STMPromise[B]" id="175879">result</a> = <span title="play.api.libs.concurrent.STMPromise[B]" class="keyword">new</span> <a href="#13641" title="play.api.libs.concurrent.STMPromise[B]">STMPromise</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#175654" title="(k: A =&gt; Unit)Unit">onRedeem</a><span class="delimiter">(</span><a title="A" id="175881">a</a> =&gt; <a href="#175876" title="PartialFunction[A,B]">p</a>.<span title="(v1: A)Option[B]">lift</span><span class="delimiter">(</span><a href="#175881" title="A">a</a><span class="delimiter">)</span>.<span title="(f: B =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#175879" title="play.api.libs.concurrent.STMPromise[B]">result</a>.<a href="#175660" title="(body: =&gt; B)Unit">redeem</a><span class="delimiter">(</span><a href="#175887" title="B">_</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#175879" title="play.api.libs.concurrent.STMPromise[B]">result</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(k: A =&gt; Unit)Unit" id="175654">onRedeem</a><span class="delimiter">(</span><a title="A =&gt; Unit" id="175869">k</a>: A =&gt; Unit<span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#175655" title="(k: play.api.libs.concurrent.Promise[A] =&gt; Unit)Unit">addAction</a><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[A]" id="175893">p</a> =&gt; <a href="#175893" title="play.api.libs.concurrent.Promise[A]">p</a>.<a href="#76006" title="=&gt; play.api.libs.concurrent.NotWaiting[A]">value</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <span title="Unit">Redeemed</span><span class="delimiter">(</span><a title="A" id="175895">a</a><span class="delimiter">)</span> =&gt; <a href="#175869" title="(v1: A)Unit">k</a><span class="delimiter">(</span><a href="#175895" title="A">a</a><span class="delimiter">)</span>; <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(k: play.api.libs.concurrent.Promise[A] =&gt; Unit)Unit" id="175655">addAction</a><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[A] =&gt; Unit" id="175836">k</a>: Promise<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Unit<span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#175645" title="=&gt; scala.concurrent.stm.Ref[play.api.libs.concurrent.PromiseValue[A]]">redeemed</a>.<span title="()play.api.libs.concurrent.PromiseValue[A]">single</span><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="#77446" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#175657" title="(a: play.api.libs.concurrent.STMPromise[A], k: play.api.libs.concurrent.STMPromise[A] =&gt; Unit)Unit">invoke</a><span class="delimiter">(</span><a href="#13641" title="play.api.libs.concurrent.STMPromise[A]" class="keyword">this</a>, <a href="#175836" title="play.api.libs.concurrent.Promise[A] =&gt; Unit">k</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Boolean" id="175908">ok</a>: <span title="Boolean">Boolean</span> = <span title="(block: scala.concurrent.stm.InTxn =&gt; Boolean)(implicit mt: scala.concurrent.stm.MaybeTxn)Boolean">atomic</span> <span title="=&gt; scala.concurrent.stm.TxnUnknown.type" class="delimiter">{</span> <span class="keyword">implicit</span> <a title="scala.concurrent.stm.InTxn" id="175967">txn</a> =&gt;
        <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#175645" title="()(implicit txn: scala.concurrent.stm.InTxn)play.api.libs.concurrent.PromiseValue[A]">redeemed</a><a href="#175967" title="scala.concurrent.stm.InTxn" class="delimiter">(</a><span class="delimiter">)</span>.<a href="#77446" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#175642" title="(v: List[play.api.libs.concurrent.Promise[A] =&gt; Unit])(implicit txn: scala.concurrent.stm.InTxn)Unit">actions</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#175642" title="()(implicit txn: scala.concurrent.stm.InTxn)List[play.api.libs.concurrent.Promise[A] =&gt; Unit]">actions</a><a href="#175967" title="scala.concurrent.stm.InTxn" class="delimiter">(</a><span class="delimiter">)</span> <span title="(elem: play.api.libs.concurrent.Promise[A] =&gt; Unit)(implicit bf: scala.collection.generic.CanBuildFrom[List[play.api.libs.concurrent.Promise[A] =&gt; Unit],play.api.libs.concurrent.Promise[A] =&gt; Unit,List[play.api.libs.concurrent.Promise[A] =&gt; Unit]])List[play.api.libs.concurrent.Promise[A] =&gt; Unit]">:+</span> <a href="#175836" title="play.api.libs.concurrent.Promise[A] =&gt; Unit">k</a>; <span title="Boolean(true)" class="keyword">true</span> <span class="delimiter">}</span>
        <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#175908" title="Boolean">ok</a><span class="delimiter">)</span> <a href="#175657" title="(a: play.api.libs.concurrent.STMPromise[A], k: play.api.libs.concurrent.STMPromise[A] =&gt; Unit)Unit">invoke</a><span class="delimiter">(</span><a href="#13641" title="play.api.libs.concurrent.STMPromise[A]" class="keyword">this</a>, <a href="#175836" title="play.api.libs.concurrent.Promise[A] =&gt; Unit">k</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(timeout: Long, unit: java.util.concurrent.TimeUnit)play.api.libs.concurrent.NotWaiting[A]" id="175656">await</a><span class="delimiter">(</span><a title="Long" id="176031">timeout</a>: <span title="Long">Long</span>, <a title="java.util.concurrent.TimeUnit" id="176035">unit</a>: <span title="java.util.concurrent.TimeUnit">TimeUnit</span> = TimeUnit.<span title="java.util.concurrent.TimeUnit(value MILLISECONDS)">MILLISECONDS</span><span class="delimiter">)</span>: <a href="#13545" title="play.api.libs.concurrent.NotWaiting[A]">NotWaiting</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span title="(block: scala.concurrent.stm.InTxn =&gt; play.api.libs.concurrent.NotWaiting[A])(implicit mt: scala.concurrent.stm.MaybeTxn)play.api.libs.concurrent.NotWaiting[A]">atomic</span> <span title="=&gt; scala.concurrent.stm.TxnUnknown.type" class="delimiter">{</span> <span class="keyword">implicit</span> <a title="scala.concurrent.stm.InTxn" id="176039">txn</a> =&gt;
      <span title="play.api.libs.concurrent.NotWaiting[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#175645" title="()(implicit txn: scala.concurrent.stm.InTxn)play.api.libs.concurrent.PromiseValue[A]">redeemed</a><a href="#176039" title="scala.concurrent.stm.InTxn" class="delimiter">(</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#174846" title="object play.api.libs.concurrent.Waiting">Waiting</a><span class="delimiter">)</span> <a href="#175645" title="()(implicit txn: scala.concurrent.stm.InTxn)play.api.libs.concurrent.PromiseValue[A]">redeemed</a><a href="#176039" title="scala.concurrent.stm.InTxn" class="delimiter">(</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="play.api.libs.concurrent.NotWaiting[A]" class="delimiter">[</span><a href="#13545" title="play.api.libs.concurrent.NotWaiting[A]">NotWaiting</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="(timeout: Long, unit: scala.actors.threadpool.TimeUnit)(implicit txn: scala.concurrent.stm.InTxn)Unit">retryFor</span><a href="#176039" title="scala.concurrent.stm.InTxn" class="delimiter">(</a><a href="#176035" title="java.util.concurrent.TimeUnit">unit</a>.<span title="(x$1: Long)Long">toNanos</span><span class="delimiter">(</span><a href="#176031" title="Long">timeout</a><span class="delimiter">)</span>, scala.actors.threadpool.<span title="object scala.actors.threadpool.TimeUnit">TimeUnit</span>.<span title="scala.actors.threadpool.TimeUnit">NANOSECONDS</span><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.util.concurrent.TimeoutException" class="keyword">new</span> java.util.concurrent.<span title="java.util.concurrent.TimeoutException">TimeoutException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Promise timed out after &quot;)" class="string">&quot;Promise timed out after &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#176031" title="Long">timeout</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; : &quot;)" class="string">&quot; : &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#176035" title="java.util.concurrent.TimeUnit">unit</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](a: T, k: T =&gt; Unit)Unit" id="175657">invoke</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="175659">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="175898">a</a>: <a href="#175659" title="T">T</a>, <a title="T =&gt; Unit" id="175899">k</a>: T =&gt; Unit<span class="delimiter">)</span>: <span title="Unit">Unit</span> = akka.dispatch.<span title="(body: =&gt; Unit)(implicit executor: akka.dispatch.ExecutionContext)akka.dispatch.Future[Unit]">Future</span><span class="delimiter">{</span> <a href="#175899" title="(v1: T)Unit">k</a><span class="delimiter">(</span><a href="#175898" title="T">a</a><span class="delimiter">)</span> <span class="delimiter">}</span><span title="Unit" class="delimiter">(</span>play.core.<a href="../../../core/system/Invoker.scala.html#18273" title="object play.core.Invoker">Invoker</a>.<a href="../../../core/system/Invoker.scala.html#78813" title="=&gt; akka.dispatch.MessageDispatcher">promiseDispatcher</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(body: =&gt; A)Unit" id="175660">redeem</a><span class="delimiter">(</span><a title="=&gt; A" id="175858">body</a>: =&gt; A<span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Either[Throwable,A]" id="176796">result</a> = scala.util.control.<span title="object scala.util.control.Exception">Exception</span>.<span title="[T]=&gt; util.control.Exception.Catch[T]">allCatch</span><span title="util.control.Exception.Catch[A]" class="delimiter">[</span><a href="#13774" title="A">A</a><span class="delimiter">]</span>.<span title="(body: =&gt; A)Either[Throwable,A]">either</span><span class="delimiter">(</span><a href="#175858" title="=&gt; A">body</a><span class="delimiter">)</span>
    <span title="(block: scala.concurrent.stm.InTxn =&gt; Unit)(implicit mt: scala.concurrent.stm.MaybeTxn)Unit">atomic</span> <span title="=&gt; scala.concurrent.stm.TxnUnknown.type" class="delimiter">{</span> <span class="keyword">implicit</span> <a title="scala.concurrent.stm.InTxn" id="176805">txn</a> =&gt;
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#175645" title="()(implicit txn: scala.concurrent.stm.InTxn)play.api.libs.concurrent.PromiseValue[A]">redeemed</a><a href="#176805" title="scala.concurrent.stm.InTxn" class="delimiter">(</a><span class="delimiter">)</span>.<a href="#77446" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="java.lang.String(&quot;already redeemed&quot;)" class="string">&quot;already redeemed&quot;</span><span class="delimiter">)</span>
      <a href="#175645" title="(v: play.api.libs.concurrent.PromiseValue[A])(implicit txn: scala.concurrent.stm.InTxn)Unit">redeemed</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#176796" title="Either[Throwable,A]">result</a>.<span title="(fa: Throwable =&gt; Product with play.api.libs.concurrent.NotWaiting[A] with Serializable, fb: A =&gt; Product with play.api.libs.concurrent.NotWaiting[A] with Serializable)Product with play.api.libs.concurrent.NotWaiting[A] with Serializable">fold</span><span class="delimiter">(</span><a href="#177401" title="(e: Throwable)play.api.libs.concurrent.Thrown">Thrown</a><span class="delimiter">(</span><a href="#176814" title="Throwable">_</a><span class="delimiter">)</span>, <a href="#177397" title="(a: A)play.api.libs.concurrent.Redeemed[A]">Redeemed</a><span class="delimiter">(</span><a href="#176817" title="A">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#175642" title="=&gt; scala.concurrent.stm.Ref[List[play.api.libs.concurrent.Promise[A] =&gt; Unit]]">actions</a>.<span title="=&gt; scala.concurrent.stm.Ref.View[List[play.api.libs.concurrent.Promise[A] =&gt; Unit]]">single</span>.<span title="(v: List[play.api.libs.concurrent.Promise[A] =&gt; Unit])List[play.api.libs.concurrent.Promise[A] =&gt; Unit]">swap</span><span class="delimiter">(</span>List<span title="object Nil" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: play.api.libs.concurrent.Promise[A] =&gt; Unit =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#175657" title="(a: play.api.libs.concurrent.STMPromise[A], k: play.api.libs.concurrent.STMPromise[A] =&gt; Unit)Unit">invoke</a><span class="delimiter">(</span><a href="#13641" title="play.api.libs.concurrent.STMPromise[A]" class="keyword">this</a>, <a href="#176865" title="play.api.libs.concurrent.Promise[A] =&gt; Unit">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(t: Throwable)Unit" id="175661">throwing</a><span class="delimiter">(</span><a title="Throwable" id="175854">t</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span title="(block: scala.concurrent.stm.InTxn =&gt; Unit)(implicit mt: scala.concurrent.stm.MaybeTxn)Unit">atomic</span> <span title="=&gt; scala.concurrent.stm.TxnUnknown.type" class="delimiter">{</span> <span class="keyword">implicit</span> <a title="scala.concurrent.stm.InTxn" id="176875">txn</a> =&gt;
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#175645" title="()(implicit txn: scala.concurrent.stm.InTxn)play.api.libs.concurrent.PromiseValue[A]">redeemed</a><a href="#176875" title="scala.concurrent.stm.InTxn" class="delimiter">(</a><span class="delimiter">)</span>.<a href="#77446" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="java.lang.String(&quot;already redeemed&quot;)" class="string">&quot;already redeemed&quot;</span><span class="delimiter">)</span>
      <a href="#175645" title="(v: play.api.libs.concurrent.PromiseValue[A])(implicit txn: scala.concurrent.stm.InTxn)Unit">redeemed</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#177401" title="(e: Throwable)play.api.libs.concurrent.Thrown">Thrown</a><span class="delimiter">(</span><a href="#175854" title="Throwable">t</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#175642" title="=&gt; scala.concurrent.stm.Ref[List[play.api.libs.concurrent.Promise[A] =&gt; Unit]]">actions</a>.<span title="=&gt; scala.concurrent.stm.Ref.View[List[play.api.libs.concurrent.Promise[A] =&gt; Unit]]">single</span>.<span title="(v: List[play.api.libs.concurrent.Promise[A] =&gt; Unit])List[play.api.libs.concurrent.Promise[A] =&gt; Unit]">swap</span><span class="delimiter">(</span>List<span title="object Nil" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: play.api.libs.concurrent.Promise[A] =&gt; Unit =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#175657" title="(a: play.api.libs.concurrent.STMPromise[A], k: play.api.libs.concurrent.STMPromise[A] =&gt; Unit)Unit">invoke</a><span class="delimiter">(</span><a href="#13641" title="play.api.libs.concurrent.STMPromise[A]" class="keyword">this</a>, <a href="#176905" title="play.api.libs.concurrent.Promise[A] =&gt; Unit">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[B](f: A =&gt; B)play.api.libs.concurrent.Promise[B]" id="175662">map</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="175664">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; B" id="176912">f</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[B]">Promise</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="play.api.libs.concurrent.STMPromise[B]" id="176918">result</a> = <span title="play.api.libs.concurrent.STMPromise[B]" class="keyword">new</span> <a href="#13641" title="play.api.libs.concurrent.STMPromise[B]">STMPromise</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#13641" title="STMPromise.this.type" class="keyword">this</a>.<a href="#175655" title="(k: play.api.libs.concurrent.Promise[A] =&gt; Unit)Unit">addAction</a><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[A]" id="176920">p</a> =&gt; <a href="#176920" title="play.api.libs.concurrent.Promise[A]">p</a>.<a href="#76006" title="=&gt; play.api.libs.concurrent.NotWaiting[A]">value</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit">Redeemed</span><span class="delimiter">(</span><a title="A" id="176922">a</a><span class="delimiter">)</span> =&gt; <a href="#176918" title="play.api.libs.concurrent.STMPromise[B]">result</a>.<a href="#175660" title="(body: =&gt; B)Unit">redeem</a><span class="delimiter">(</span><a href="#176912" title="(v1: A)B">f</a><span class="delimiter">(</span><a href="#176922" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit">Thrown</span><span class="delimiter">(</span><a title="Throwable" id="176926">e</a><span class="delimiter">)</span> =&gt; <a href="#176918" title="play.api.libs.concurrent.STMPromise[B]">result</a>.<a href="#175660" title="(body: =&gt; B)Unit">redeem</a><span class="delimiter">(</span><span title="Nothing" class="keyword">throw</span> <a href="#176926" title="Throwable">e</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>
    <a href="#176918" title="play.api.libs.concurrent.STMPromise[B]">result</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[B](f: A =&gt; play.api.libs.concurrent.Promise[B])play.api.libs.concurrent.STMPromise[B]" id="175665">flatMap</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="175667">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; play.api.libs.concurrent.Promise[B]" id="176927">f</a>: A =&gt; Promise<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="play.api.libs.concurrent.STMPromise[B]" id="176936">result</a> = <span title="play.api.libs.concurrent.STMPromise[B]" class="keyword">new</span> <a href="#13641" title="play.api.libs.concurrent.STMPromise[B]">STMPromise</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#13641" title="STMPromise.this.type" class="keyword">this</a>.<a href="#175655" title="(k: play.api.libs.concurrent.Promise[A] =&gt; Unit)Unit">addAction</a><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[A]" id="176938">p</a> =&gt; <a href="#176938" title="play.api.libs.concurrent.Promise[A]">p</a>.<a href="#76006" title="=&gt; play.api.libs.concurrent.NotWaiting[A]">value</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit">Redeemed</span><span class="delimiter">(</span><a title="A" id="176940">a</a><span class="delimiter">)</span> =&gt;
       <span class="delimiter">(</span><span class="keyword">try</span><span class="delimiter">{</span> 
         <a href="#176927" title="(v1: A)play.api.libs.concurrent.Promise[B]">f</a><span class="delimiter">(</span><a href="#176940" title="A">a</a><span class="delimiter">)</span>
       <span class="delimiter">}</span> <span class="keyword">catch</span><span class="delimiter">{</span>
         <span class="keyword">case</span> <a title="play.api.libs.concurrent.Promise[B]" id="176942">e</a> =&gt;
           <a href="#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="#78503" title="[A](a: =&gt; A)play.api.libs.concurrent.Promise[A]">pure</a><span title="(a: =&gt; B)play.api.libs.concurrent.Promise[B]" class="delimiter">[</span><a href="#175667" title="B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><span title="Nothing" class="keyword">throw</span> <a href="#176942" title="java.lang.Throwable">e</a><span class="delimiter">)</span>
       <span class="delimiter">}</span><span class="delimiter">)</span>.<a href="#76000" title="(k: play.api.libs.concurrent.Promise[B] =&gt; Unit)play.api.libs.concurrent.Promise[Unit]">extend</a><span title="Unit" class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[B]" id="176948">ip</a> =&gt; <a href="#176948" title="play.api.libs.concurrent.Promise[B]">ip</a>.<a href="#76006" title="=&gt; play.api.libs.concurrent.NotWaiting[B]">value</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="Unit">Redeemed</span><span class="delimiter">(</span><a title="B" id="176950">a</a><span class="delimiter">)</span> =&gt; <a href="#176936" title="play.api.libs.concurrent.STMPromise[B]">result</a>.<a href="#175660" title="(body: =&gt; B)Unit">redeem</a><span class="delimiter">(</span><a href="#176950" title="B">a</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit">Thrown</span><span class="delimiter">(</span><a title="Throwable" id="176953">e</a><span class="delimiter">)</span> =&gt; <a href="#176936" title="play.api.libs.concurrent.STMPromise[B]">result</a>.<a href="#175660" title="(body: =&gt; B)Unit">redeem</a><span class="delimiter">(</span><span title="Nothing" class="keyword">throw</span> <a href="#176953" title="Throwable">e</a><span class="delimiter">)</span>

        <span class="delimiter">}</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit">Thrown</span><span class="delimiter">(</span><a title="Throwable" id="176955">e</a><span class="delimiter">)</span> =&gt; <a href="#176936" title="play.api.libs.concurrent.STMPromise[B]">result</a>.<a href="#175660" title="(body: =&gt; B)Unit">redeem</a><span class="delimiter">(</span><span title="Nothing" class="keyword">throw</span> <a href="#176955" title="Throwable">e</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>
    <a href="#176936" title="play.api.libs.concurrent.STMPromise[B]">result</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object play.api.libs.concurrent.PurePromise" id="13732">PurePromise</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[A](lazyA: =&gt; A)play.api.libs.concurrent.Promise[A]" id="176960">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="176962">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="176964">lazyA</a>: =&gt; A<span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[A]">Promise</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = 
    <span class="delimiter">(</span><a href="package.scala.html#21755" title="(future: akka.dispatch.Future[_17])play.api.libs.concurrent.AkkaFuture[_17]" class="keyword">try</a> <span class="delimiter">(</span>akka.dispatch.<span title="object akka.dispatch.Promise">Promise</span>.<span title="(result: A)(implicit executor: akka.dispatch.ExecutionContext)akka.dispatch.Promise[A]">successful</span><span class="delimiter">(</span><a href="#176964" title="=&gt; A">lazyA</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="#78501" title="=&gt; akka.actor.ActorSystem">system</a>.<span title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</span><span class="delimiter">)</span><span class="delimiter">)</span>
     <span class="keyword">catch</span><span class="delimiter">{</span> <span class="keyword">case</span> <a title="akka.dispatch.Promise[Nothing]" id="177007">e</a> =&gt; akka.dispatch.<span title="object akka.dispatch.Promise">Promise</span>.<span title="(exception: Throwable)(implicit executor: akka.dispatch.ExecutionContext)akka.dispatch.Promise[Nothing]">failed</span><span class="delimiter">(</span><a href="#177007" title="java.lang.Throwable">e</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="#78501" title="=&gt; akka.actor.ActorSystem">system</a>.<span title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</span><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">)</span>.<a href="Akka.scala.html#74706" title="=&gt; play.api.libs.concurrent.Promise[_17]">asPromise</a>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object play.api.libs.concurrent.Promise" id="13537">Promise</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="keyword">private</span><span class="delimiter">[</span>concurrent<span class="delimiter">]</span> <span class="keyword">def</span> <a title="[T](t: =&gt; T)play.api.libs.concurrent.Promise[T]" id="78498">invoke</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="78500">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; T" id="177189">t</a>: =&gt; T<span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[T]">Promise</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = akka.dispatch.<span title="(body: =&gt; T)(implicit executor: akka.dispatch.ExecutionContext)akka.dispatch.Future[T]">Future</span> <span class="delimiter">{</span> <a href="#177189" title="=&gt; T">t</a> <span class="delimiter">}</span><a href="package.scala.html#21755" title="(future: akka.dispatch.Future[T])play.api.libs.concurrent.AkkaFuture[T]" class="delimiter">(</a><a href="#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="#78501" title="=&gt; akka.actor.ActorSystem">system</a>.<span title="=&gt; akka.dispatch.MessageDispatcher">dispatcher</span><span class="delimiter">)</span>.<a href="Akka.scala.html#74706" title="=&gt; play.api.libs.concurrent.Promise[T]">asPromise</a>
  
  <span class="comment">/*private [concurrent] lazy val defaultTimeout = 
    Duration(system.settings.config.getMilliseconds(&quot;promise.akka.actor.typed.timeout&quot;), TimeUnit.MILLISECONDS).toMillis */</span>

  <span class="keyword">private</span> <span class="delimiter">[</span>concurrent<span class="delimiter">]</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="akka.actor.ActorSystem" id="78502">system</a> = <span title="(name: String)akka.actor.ActorSystem">ActorSystem</span><span class="delimiter">(</span><span title="java.lang.String(&quot;promise&quot;)" class="string">&quot;promise&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[A](a: =&gt; A)play.api.libs.concurrent.Promise[A]" id="78503">pure</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="78505">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="102952">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[A]">Promise</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#176960" title="(lazyA: =&gt; A)play.api.libs.concurrent.Promise[A]">PurePromise</a><span class="delimiter">(</span><a href="#102952" title="=&gt; A">a</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[A]()play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]" id="78506">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="78508">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#102925" title="Promise extends play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]">Promise</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="keyword">with</span> Redeemable<span class="delimiter">[</span>A<span class="delimiter">]</span> = <span title="play.api.libs.concurrent.STMPromise[A]" class="keyword">new</span> <a href="#13641" title="play.api.libs.concurrent.STMPromise[A]">STMPromise</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[A](message: A, duration: akka.util.Duration)play.api.libs.concurrent.Promise[A]" id="78509">timeout</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="78511">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="175621">message</a>: <a href="#78511" title="A">A</a>, <a title="akka.util.Duration" id="175622">duration</a>: akka.util.<span title="akka.util.Duration">Duration</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[A]">Promise</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#78512" title="(message: =&gt; A, duration: Long, unit: java.util.concurrent.TimeUnit)play.api.libs.concurrent.Promise[A]">timeout</a><span class="delimiter">(</span><a href="#175621" title="A">message</a>, <a href="#175622" title="akka.util.Duration">duration</a>.<span title="=&gt; Long">toMillis</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[A](message: =&gt; A, duration: Long, unit: java.util.concurrent.TimeUnit)play.api.libs.concurrent.Promise[A]" id="78512">timeout</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="175613">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="175607">message</a>: =&gt; A, <a title="Long" id="175608">duration</a>: <span title="Long">Long</span>, <a title="java.util.concurrent.TimeUnit" id="175611">unit</a>: <span title="java.util.concurrent.TimeUnit">TimeUnit</span> = TimeUnit.<span title="java.util.concurrent.TimeUnit(value MILLISECONDS)">MILLISECONDS</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[A]">Promise</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Promise extends play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]" id="177241">p</a> = <a href="#78506" title="[A]()play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]">Promise</a><span title="()play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]" class="delimiter">[</span><a href="#175613" title="A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    play.core.<a href="../../../core/system/Invoker.scala.html#18273" title="object play.core.Invoker">Invoker</a>.<a href="../../../core/system/Invoker.scala.html#78812" title="=&gt; akka.actor.ActorSystem">system</a>.<span title="=&gt; akka.actor.Scheduler">scheduler</span>.<span title="(delay: akka.util.Duration)(f: =&gt; Unit)akka.actor.Cancellable">scheduleOnce</span><span class="delimiter">(</span>akka.util.<span title="(length: Long, unit: java.util.concurrent.TimeUnit)akka.util.FiniteDuration">Duration</span><span class="delimiter">(</span><a href="#175608" title="Long">duration</a>, <a href="#175611" title="java.util.concurrent.TimeUnit">unit</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#177241" title="Promise extends play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]">p</a>.<a href="#102929" title="(a: =&gt; A)Unit">redeem</a><span class="delimiter">(</span><a href="#175607" title="=&gt; A">message</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#177241" title="Promise extends play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]">p</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[A](in: Option[play.api.libs.concurrent.Promise[A]])play.api.libs.concurrent.Promise[Option[A]]" id="78515">sequence</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="78517">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[play.api.libs.concurrent.Promise[A]]" id="177280">in</a>: <span title="Option[play.api.libs.concurrent.Promise[A]]">Option</span><span class="delimiter">[</span>Promise<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[Option[A]]">Promise</a><span class="delimiter">[</span>Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#177280" title="Option[play.api.libs.concurrent.Promise[A]]">in</a>.<span title="(f: play.api.libs.concurrent.Promise[A] =&gt; play.api.libs.concurrent.Promise[Some[A]])Option[play.api.libs.concurrent.Promise[Some[A]]]">map</span> <span class="delimiter">{</span> <a title="play.api.libs.concurrent.Promise[A]" id="177287">p</a> =&gt; <a href="#177287" title="play.api.libs.concurrent.Promise[A]">p</a>.<a href="#76010" title="(f: A =&gt; Some[A])play.api.libs.concurrent.Promise[Some[A]]">map</a><span class="delimiter">{</span> <a title="A" id="177292">v</a> =&gt; <span title="(x: A)Some[A]">Some</span><span class="delimiter">(</span><a href="#177292" title="A">v</a><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">}</span>.<span title="(default: =&gt; play.api.libs.concurrent.Promise[Option[A]])play.api.libs.concurrent.Promise[Option[A]]">getOrElse</span> <span class="delimiter">{</span> <a href="#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="#78503" title="(a: =&gt; None.type)play.api.libs.concurrent.Promise[None.type]">pure</a><span class="delimiter">(</span><span title="object None">None</span><span class="delimiter">)</span><span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="[B, M[_]](in: M[play.api.libs.concurrent.Promise[B]])(implicit toTraversableLike: M[play.api.libs.concurrent.Promise[B]] =&gt; scala.collection.TraversableLike[play.api.libs.concurrent.Promise[B],M[play.api.libs.concurrent.Promise[B]]], implicit cbf: scala.collection.generic.CanBuildFrom[M[play.api.libs.concurrent.Promise[B]],B,M[B]])play.api.libs.concurrent.Promise[M[B]]" id="78518">sequence</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="78521">B</a>, <a title="[_]&gt;: Nothing &lt;: Any" id="78522">M</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="177334">_</a><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a title="M[play.api.libs.concurrent.Promise[B]]" id="177331">in</a>: <a href="#78522" title="M[play.api.libs.concurrent.Promise[B]]">M</a><span class="delimiter">[</span>Promise<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="M[play.api.libs.concurrent.Promise[B]] =&gt; scala.collection.TraversableLike[play.api.libs.concurrent.Promise[B],M[play.api.libs.concurrent.Promise[B]]]" id="177332">toTraversableLike</a> : M<span class="delimiter">[</span>Promise<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span> =&gt; TraversableLike<span class="delimiter">[</span>Promise<span class="delimiter">[</span>B<span class="delimiter">]</span>, M<span class="delimiter">[</span>Promise<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>, <a title="scala.collection.generic.CanBuildFrom[M[play.api.libs.concurrent.Promise[B]],B,M[B]]" id="177333">cbf</a>: <span title="scala.collection.generic.CanBuildFrom[M[play.api.libs.concurrent.Promise[B]],B,M[B]]">CanBuildFrom</span><span class="delimiter">[</span>M<span class="delimiter">[</span>Promise<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span>, B, M<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#13536" title="play.api.libs.concurrent.Promise[M[B]]">Promise</a><span class="delimiter">[</span>M<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span> 
    <a href="#177332" title="(v1: M[play.api.libs.concurrent.Promise[B]])scala.collection.TraversableLike[play.api.libs.concurrent.Promise[B],M[play.api.libs.concurrent.Promise[B]]]">toTraversableLike</a><span class="delimiter">(</span><a href="#177331" title="M[play.api.libs.concurrent.Promise[B]]">in</a><span class="delimiter">)</span>.<span title="(z: play.api.libs.concurrent.Promise[scala.collection.mutable.Builder[B,M[B]]])(op: (play.api.libs.concurrent.Promise[scala.collection.mutable.Builder[B,M[B]]], play.api.libs.concurrent.Promise[B]) =&gt; play.api.libs.concurrent.Promise[scala.collection.mutable.Builder[B,M[B]]])play.api.libs.concurrent.Promise[scala.collection.mutable.Builder[B,M[B]]]">foldLeft</span><span class="delimiter">(</span><a href="#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="#78503" title="(a: =&gt; scala.collection.mutable.Builder[B,M[B]])play.api.libs.concurrent.Promise[scala.collection.mutable.Builder[B,M[B]]]">pure</a><span class="delimiter">(</span><a href="#177333" title="(from: M[play.api.libs.concurrent.Promise[B]])scala.collection.mutable.Builder[B,M[B]]">cbf</a><span class="delimiter">(</span><a href="#177331" title="M[play.api.libs.concurrent.Promise[B]]">in</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[scala.collection.mutable.Builder[B,M[B]]]" id="177364">fr</a>, fa : <a href="#13536" title="play.api.libs.concurrent.Promise[B]">Promise</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span class="keyword">for</span> <span class="delimiter">(</span><a title="scala.collection.mutable.Builder[B,M[B]]" id="177370">r</a> &lt;- <a href="#76013" title="(f: scala.collection.mutable.Builder[B,M[B]] =&gt; play.api.libs.concurrent.Promise[scala.collection.mutable.Builder[B,M[B]]])play.api.libs.concurrent.Promise[scala.collection.mutable.Builder[B,M[B]]]">fr</a>; <a title="B" id="177375">a</a> &lt;- <a href="#76010" title="(f: B =&gt; scala.collection.mutable.Builder[B,M[B]])play.api.libs.concurrent.Promise[scala.collection.mutable.Builder[B,M[B]]]">fa</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">(</span><a href="#177370" title="scala.collection.mutable.Builder[B,M[B]]">r</a> <span title="(elem: B)r.type">+=</span> <a href="#177375" title="B">a</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="#76010" title="(f: scala.collection.mutable.Builder[B,M[B]] =&gt; M[B])play.api.libs.concurrent.Promise[M[B]]">map</a><span class="delimiter">(</span><a href="#177389" title="scala.collection.mutable.Builder[B,M[B]]">_</a>.<span title="()M[B]">result</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>
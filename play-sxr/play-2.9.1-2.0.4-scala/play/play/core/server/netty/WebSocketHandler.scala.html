<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>play/play/core/server/netty/WebSocketHandler.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> play.core.server.netty

<span class="keyword">import</span> org.jboss.netty.buffer._
<span class="keyword">import</span> org.jboss.netty.channel._
<span class="keyword">import</span> org.jboss.netty.bootstrap._
<span class="keyword">import</span> org.jboss.netty.channel.<span title="object org.jboss.netty.channel.Channels">Channels</span>._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http._
<span class="keyword">import</span> org.jboss.netty.channel.socket.nio._
<span class="keyword">import</span> org.jboss.netty.handler.stream._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http.<span title="object org.jboss.netty.handler.codec.http.HttpHeaders">HttpHeaders</span>._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http.<span title="object org.jboss.netty.handler.codec.http.HttpHeaders">HttpHeaders</span>.<span title="object org.jboss.netty.handler.codec.http.HttpHeaders.Names">Names</span>._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http.<span title="object org.jboss.netty.handler.codec.http.HttpHeaders">HttpHeaders</span>.<span title="object org.jboss.netty.handler.codec.http.HttpHeaders.Values">Values</span>._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http.websocketx._
<span class="keyword">import</span> org.jboss.netty.channel.group._
<span class="keyword">import</span> java.util.concurrent._
<span class="keyword">import</span> play.core._
<span class="keyword">import</span> play.core.server.websocket.WebSocketHandshake
<span class="keyword">import</span> play.api._
<span class="keyword">import</span> play.api.mvc._
<span class="keyword">import</span> play.api.libs.iteratee._
<span class="keyword">import</span> play.api.libs.iteratee.<a href="../../../api/libs/iteratee/Iteratee.scala.html#14647" title="object play.api.libs.iteratee.Input">Input</a>._
<span class="keyword">import</span> play.api.libs.concurrent._
<span class="keyword">import</span> scala.collection.<span title="object scala.collection.JavaConverters">JavaConverters</span>._

<span class="keyword">private</span><span class="delimiter">[</span>server<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait WebSocketHandler extends java.lang.Object with ScalaObject" id="20854">WebSocketHandler</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[A](frameFormatter: play.api.mvc.WebSocket.FrameFormatter[A])(java.lang.Object with play.api.libs.iteratee.Enumerator[A]{val iterateeAgent: play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]; def frameReceived(ctx: org.jboss.netty.channel.ChannelHandlerContext,input: play.api.libs.iteratee.Input[A]): Unit}, org.jboss.netty.channel.SimpleChannelUpstreamHandler)" id="325776">newWebSocketInHandler</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="325778">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="play.api.mvc.WebSocket.FrameFormatter[A]" id="331356">frameFormatter</a>: play.api.mvc.WebSocket.<a href="../../../api/mvc/WebSocket.scala.html#242939" title="play.api.mvc.WebSocket.FrameFormatter[A]">FrameFormatter</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>

    <span class="keyword">val</span> <a title="play.core.server.websocket.FrameFormatter[A]" id="331359">nettyFrameFormatter</a> = <a href="#331356" title="play.api.mvc.WebSocket.FrameFormatter[A]">frameFormatter</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="play.core.server.websocket.FrameFormatter[A]" class="delimiter">[</span>play.core.server.websocket.<a href="../websocket/Frame.scala.html#21095" title="play.core.server.websocket.FrameFormatter[A]">FrameFormatter</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>

    <span class="keyword">val</span> <a title="enumerator extends java.lang.Object with play.api.libs.iteratee.Enumerator[A]" id="331360">enumerator</a> = <a href="#331361" title="java.lang.Object with play.api.libs.iteratee.Enumerator[A]{val iterateeAgent: play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]; def frameReceived(ctx: org.jboss.netty.channel.ChannelHandlerContext,input: play.api.libs.iteratee.Input[A]): Unit}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with play.api.libs.iteratee.Enumerator[A]" id="331361">Enumerator</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]" id="331363">iterateeAgent</a> = <a href="../../system/Invoker.scala.html#331374" title="[A](a: A)play.core.Agent.Operations[A]">Agent</a><span title="(a: Option[play.api.libs.iteratee.Iteratee[A,Any]])play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]" class="delimiter">[</span><span title="Option[play.api.libs.iteratee.Iteratee[A,Any]]">Option</span><span class="delimiter">[</span>Iteratee<span class="delimiter">[</span>A, Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span title="object None">None</span><span class="delimiter">)</span>
      <span class="keyword">private</span> <span class="keyword">val</span> <a title="$anon extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[A,Any]]" id="331365">promise</a>: <a href="#331412" title="$anon extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[A,Any]]">Promise</a><span class="delimiter">[</span>Iteratee<span class="delimiter">[</span>A, Any<span class="delimiter">]</span><span class="delimiter">]</span> <span class="keyword">with</span> Redeemable<span class="delimiter">[</span>Iteratee<span class="delimiter">[</span>A, Any<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="../../../api/libs/concurrent/Promise.scala.html#78506" title="[A]()play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]">Promise</a><span title="()play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[A,Any]]" class="delimiter">[</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#14613" title="play.api.libs.iteratee.Iteratee[A,Any]">Iteratee</a><span class="delimiter">[</span>A, Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="[R](i: play.api.libs.iteratee.Iteratee[A,R])play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,R]]" id="331367">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="331369">R</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="play.api.libs.iteratee.Iteratee[A,R]" id="331383">i</a>: <a href="../../../api/libs/iteratee/Iteratee.scala.html#14613" title="play.api.libs.iteratee.Iteratee[A,R]">Iteratee</a><span class="delimiter">[</span>A, R<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <a href="#331363" title="=&gt; play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]">iterateeAgent</a>.<a href="../../system/Invoker.scala.html#331397" title="(action: Option[play.api.libs.iteratee.Iteratee[A,Any]] =&gt; Option[play.api.libs.iteratee.Iteratee[A,Any]])Unit">send</a><span class="delimiter">(</span><a href="#331403" title="Option[play.api.libs.iteratee.Iteratee[A,Any]]">_</a>.<span title="(alternative: =&gt; Option[play.api.libs.iteratee.Iteratee[A,Any]])Option[play.api.libs.iteratee.Iteratee[A,Any]]">orElse</span><span class="delimiter">(</span><span title="(x: play.api.libs.iteratee.Iteratee[A,Any])Some[play.api.libs.iteratee.Iteratee[A,Any]]">Some</span><span class="delimiter">(</span><a href="#331383" title="play.api.libs.iteratee.Iteratee[A,R]">i</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="play.api.libs.iteratee.Iteratee[A,Any]" class="delimiter">[</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#14613" title="play.api.libs.iteratee.Iteratee[A,Any]">Iteratee</a><span class="delimiter">[</span>A, Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#331365" title="=&gt; play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[A,Any]]">promise</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,R]]" class="delimiter">[</span><a href="../../../api/libs/concurrent/Promise.scala.html#13536" title="play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,R]]">Promise</a><span class="delimiter">[</span>Iteratee<span class="delimiter">[</span>A, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, input: play.api.libs.iteratee.Input[A])Unit" id="331370">frameReceived</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="331415">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="play.api.libs.iteratee.Input[A]" id="331416">input</a>: <a href="../../../api/libs/iteratee/Iteratee.scala.html#14646" title="play.api.libs.iteratee.Input[A]">Input</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#331363" title="=&gt; play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]">iterateeAgent</a>.<a href="../../system/Invoker.scala.html#331397" title="(action: Option[play.api.libs.iteratee.Iteratee[A,Any]] =&gt; Option[play.api.libs.iteratee.Iteratee[A,Any]])Unit">send</a><span class="delimiter">(</span><a title="Option[play.api.libs.iteratee.Iteratee[A,Any]]" id="331423">iteratee</a> =&gt;
          <a href="#331423" title="Option[play.api.libs.iteratee.Iteratee[A,Any]]">iteratee</a>.<span title="(f: play.api.libs.iteratee.Iteratee[A,Any] =&gt; play.api.libs.iteratee.Iteratee[A,Any])Option[play.api.libs.iteratee.Iteratee[A,Any]]">map</span><span class="delimiter">(</span><a title="play.api.libs.iteratee.Iteratee[A,Any]" id="331428">it</a> =&gt; <a href="#331428" title="play.api.libs.iteratee.Iteratee[A,Any]">it</a>.<a href="../../../api/libs/iteratee/Iteratee.scala.html#74088" title="(done: (Any, play.api.libs.iteratee.Input[A]) =&gt; play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]], cont: play.api.libs.iteratee.Input[A] =&gt; play.api.libs.iteratee.Iteratee[A,Any] =&gt; play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]], error: (String, play.api.libs.iteratee.Input[A]) =&gt; play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]])play.api.libs.iteratee.Iteratee[A,Any]">flatFold</a><span class="delimiter">(</span>
            <span class="delimiter">(</span><a title="Any" id="331438">a</a>, <a title="play.api.libs.iteratee.Input[A]" id="331439">e</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span> sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Getting messages on a supposedly closed socket? frame: &quot;)" class="string">&quot;Getting messages on a supposedly closed socket? frame: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#331416" title="play.api.libs.iteratee.Input[A]">input</a><span class="delimiter">)</span> <span class="delimiter">}</span>,
            <a title="play.api.libs.iteratee.Input[A] =&gt; play.api.libs.iteratee.Iteratee[A,Any]" id="331441">k</a> =&gt; <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="play.api.libs.iteratee.Iteratee[A,Any]" id="331442">next</a> = <a href="#331441" title="(v1: play.api.libs.iteratee.Input[A])play.api.libs.iteratee.Iteratee[A,Any]">k</a><span class="delimiter">(</span><a href="#331416" title="play.api.libs.iteratee.Input[A]">input</a><span class="delimiter">)</span>
              <a href="#331442" title="play.api.libs.iteratee.Iteratee[A,Any]">next</a>.<a href="../../../api/libs/iteratee/Iteratee.scala.html#74077" title="(done: (Any, play.api.libs.iteratee.Input[A]) =&gt; play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]], cont: play.api.libs.iteratee.Input[A] =&gt; play.api.libs.iteratee.Iteratee[A,Any] =&gt; play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]], error: (String, play.api.libs.iteratee.Input[A]) =&gt; play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]])play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]]">fold</a><span class="delimiter">(</span>
                <span class="delimiter">(</span><a title="Any" id="331452">a</a>, <a title="play.api.libs.iteratee.Input[A]" id="331453">e</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
                  <a href="#331363" title="=&gt; play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]">iterateeAgent</a>.<a href="../../system/Invoker.scala.html#331398" title="()Unit">close</a><span class="delimiter">(</span><span class="delimiter">)</span>
                  <a href="#331415" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()org.jboss.netty.channel.ChannelFuture">disconnect</span><span class="delimiter">(</span><span class="delimiter">)</span>;
                  <a href="#331365" title="=&gt; play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[A,Any]]">promise</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#102929" title="(a: =&gt; play.api.libs.iteratee.Iteratee[A,Any])Unit">redeem</a><span class="delimiter">(</span><a href="#331442" title="play.api.libs.iteratee.Iteratee[A,Any]">next</a><span class="delimiter">)</span>;
                  <a href="../../../api/Logger.scala.html#81627" title="(name: String)play.api.Logger">Logger</a><span class="delimiter">(</span><span title="java.lang.String(&quot;play&quot;)" class="string">&quot;play&quot;</span><span class="delimiter">)</span>.<a href="../../../api/Logger.scala.html#81613" title="(message: =&gt; String)Unit">trace</a><span class="delimiter">(</span><span title="java.lang.String(&quot;cleaning for channel &quot;)" class="string">&quot;cleaning for channel &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#331415" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
                  <a href="../../../api/libs/concurrent/Promise.scala.html#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#78503" title="(a: =&gt; play.api.libs.iteratee.Iteratee[A,Any])play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]]">pure</a><span class="delimiter">(</span><a href="#331442" title="play.api.libs.iteratee.Iteratee[A,Any]">next</a><span class="delimiter">)</span>
                <span class="delimiter">}</span>,
                <a title="play.api.libs.iteratee.Input[A] =&gt; play.api.libs.iteratee.Iteratee[A,Any]" id="331474">_</a> =&gt; <a href="../../../api/libs/concurrent/Promise.scala.html#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#78503" title="(a: =&gt; play.api.libs.iteratee.Iteratee[A,Any])play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]]">pure</a><span class="delimiter">(</span><a href="#331442" title="play.api.libs.iteratee.Iteratee[A,Any]">next</a><span class="delimiter">)</span>,
                <span class="delimiter">(</span><a title="String" id="331479">msg</a>, <a title="play.api.libs.iteratee.Input[A]" id="331480">e</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span> <span class="comment">/* deal with error, maybe close the socket */</span> <a href="../../../api/libs/concurrent/Promise.scala.html#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#78503" title="(a: =&gt; play.api.libs.iteratee.Iteratee[A,Any])play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]]">pure</a><span class="delimiter">(</span><a href="#331442" title="play.api.libs.iteratee.Iteratee[A,Any]">next</a><span class="delimiter">)</span> <span class="delimiter">}</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>,
            <span class="delimiter">(</span><a title="String" id="331488">err</a>, <a title="play.api.libs.iteratee.Input[A]" id="331489">e</a><span class="delimiter">)</span> =&gt; <span class="comment">/* handle error, maybe close the socket */</span> <a href="../../../api/libs/concurrent/Promise.scala.html#13537" title="object play.api.libs.concurrent.Promise">Promise</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#78503" title="(a: =&gt; play.api.libs.iteratee.Iteratee[A,Any])play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[A,Any]]">pure</a><span class="delimiter">(</span><a href="#331428" title="play.api.libs.iteratee.Iteratee[A,Any]">it</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span title="(_1: java.lang.Object with play.api.libs.iteratee.Enumerator[A]{val iterateeAgent: play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]; def frameReceived(ctx: org.jboss.netty.channel.ChannelHandlerContext,input: play.api.libs.iteratee.Input[A]): Unit}, _2: org.jboss.netty.channel.SimpleChannelUpstreamHandler)(java.lang.Object with play.api.libs.iteratee.Enumerator[A]{val iterateeAgent: play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]; def frameReceived(ctx: org.jboss.netty.channel.ChannelHandlerContext,input: play.api.libs.iteratee.Input[A]): Unit}, org.jboss.netty.channel.SimpleChannelUpstreamHandler)" class="delimiter">(</span><a href="#331360" title="enumerator extends java.lang.Object with play.api.libs.iteratee.Enumerator[A]">enumerator</a>,
      <a href="#331529" title="org.jboss.netty.channel.SimpleChannelUpstreamHandler" class="keyword">new</a> <a title="anonymous class $anon extends org.jboss.netty.channel.SimpleChannelUpstreamHandler" id="331529">SimpleChannelUpstreamHandler</a> <span class="delimiter">{</span>

        <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.MessageEvent)Unit" id="331531">messageReceived</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="331534">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.MessageEvent" id="331535">e</a>: <span title="org.jboss.netty.channel.MessageEvent">MessageEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#331535" title="org.jboss.netty.channel.MessageEvent">e</a>.<span title="()java.lang.Object">getMessage</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Unit" id="331541">frame</a>: <span title="org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame">WebSocketFrame</span> <span class="keyword">if</span> <a href="#331359" title="play.core.server.websocket.FrameFormatter[A]">nettyFrameFormatter</a>.<a href="../websocket/Frame.scala.html#243054" title="=&gt; PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,A]">fromFrame</a>.<span title="(x: org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#331541" title="org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame">frame</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
              <a href="#331360" title="enumerator extends java.lang.Object with play.api.libs.iteratee.Enumerator[A]">enumerator</a>.<a href="#331522" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, input: play.api.libs.iteratee.Input[A])Unit">frameReceived</a><span class="delimiter">(</span><a href="#331534" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="../../../api/libs/iteratee/Iteratee.scala.html#74157" title="(e: A)play.api.libs.iteratee.Input.El[A]">El</a><span class="delimiter">(</span><a href="#331359" title="play.core.server.websocket.FrameFormatter[A]">nettyFrameFormatter</a>.<a href="../websocket/Frame.scala.html#243054" title="(v1: org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame)A">fromFrame</a><span class="delimiter">(</span><a href="#331541" title="org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame">frame</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <span class="keyword">case</span> <a title="Unit" id="331547">frame</a>: <span title="org.jboss.netty.handler.codec.http.websocketx.CloseWebSocketFrame">CloseWebSocketFrame</span> =&gt; <span class="delimiter">{</span> <a href="#331534" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()org.jboss.netty.channel.ChannelFuture">disconnect</span><span class="delimiter">(</span><span class="delimiter">)</span>; <a href="#331360" title="enumerator extends java.lang.Object with play.api.libs.iteratee.Enumerator[A]">enumerator</a>.<a href="#331522" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, input: play.api.libs.iteratee.Input[A])Unit">frameReceived</a><span class="delimiter">(</span><a href="#331534" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="../../../api/libs/iteratee/Iteratee.scala.html#66599" title="object play.api.libs.iteratee.Input.EOF">EOF</a><span class="delimiter">)</span> <span class="delimiter">}</span>
            <span class="keyword">case</span> <a title="Unit" id="331567">frame</a>: <span title="org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame">WebSocketFrame</span> =&gt; <span class="comment">//</span>
            <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <span class="comment">//</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.ExceptionEvent)Unit" id="331532">exceptionCaught</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="331536">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.ExceptionEvent" id="331537">e</a>: <span title="org.jboss.netty.channel.ExceptionEvent">ExceptionEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#331537" title="org.jboss.netty.channel.ExceptionEvent">e</a>.<span title="()java.lang.Throwable">getCause</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>;
          <a href="#331537" title="org.jboss.netty.channel.ExceptionEvent">e</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()org.jboss.netty.channel.ChannelFuture">close</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>;
        <span class="delimiter">}</span>

        <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.ChannelStateEvent)Unit" id="331533">channelDisconnected</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="331538">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.ChannelStateEvent" id="331539">e</a>: <span title="org.jboss.netty.channel.ChannelStateEvent">ChannelStateEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#331360" title="enumerator extends java.lang.Object with play.api.libs.iteratee.Enumerator[A]">enumerator</a>.<a href="#331522" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, input: play.api.libs.iteratee.Input[A])Unit">frameReceived</a><span class="delimiter">(</span><a href="#331538" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="../../../api/libs/iteratee/Iteratee.scala.html#66599" title="object play.api.libs.iteratee.Input.EOF">EOF</a><span class="delimiter">)</span>
          <a href="../../../api/Logger.scala.html#81627" title="(name: String)play.api.Logger">Logger</a><span class="delimiter">(</span><span title="java.lang.String(&quot;play&quot;)" class="string">&quot;play&quot;</span><span class="delimiter">)</span>.<a href="../../../api/Logger.scala.html#81613" title="(message: =&gt; String)Unit">trace</a><span class="delimiter">(</span><span title="java.lang.String(&quot;disconnected socket&quot;)" class="string">&quot;disconnected socket&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

      <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[A](ctx: org.jboss.netty.channel.ChannelHandlerContext, req: org.jboss.netty.handler.codec.http.HttpRequest, e: org.jboss.netty.channel.MessageEvent)(frameFormatter: play.api.mvc.WebSocket.FrameFormatter[A])play.api.libs.iteratee.Enumerator[A]" id="325779">websocketHandshake</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="325781">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="330998">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.handler.codec.http.HttpRequest" id="330999">req</a>: <span title="org.jboss.netty.handler.codec.http.HttpRequest">HttpRequest</span>, <a title="org.jboss.netty.channel.MessageEvent" id="331000">e</a>: <span title="org.jboss.netty.channel.MessageEvent">MessageEvent</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="play.api.mvc.WebSocket.FrameFormatter[A]" id="331001">frameFormatter</a>: play.api.mvc.WebSocket.<a href="../../../api/mvc/WebSocket.scala.html#242939" title="play.api.mvc.WebSocket.FrameFormatter[A]">FrameFormatter</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../api/libs/iteratee/Iteratee.scala.html#14352" title="play.api.libs.iteratee.Enumerator[A]">Enumerator</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>

    <a href="../websocket/WebSocketHandshake.scala.html#21132" title="object play.core.server.websocket.WebSocketHandshake">WebSocketHandshake</a>.<a href="../websocket/WebSocketHandshake.scala.html#331616" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, req: org.jboss.netty.handler.codec.http.HttpRequest)Unit">shake</a><span class="delimiter">(</span><a href="#330998" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="#330999" title="org.jboss.netty.handler.codec.http.HttpRequest">req</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a href="#331611" title="(java.lang.Object with play.api.libs.iteratee.Enumerator[A]{val iterateeAgent: play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]; def frameReceived(ctx: org.jboss.netty.channel.ChannelHandlerContext,input: play.api.libs.iteratee.Input[A]): Unit}, org.jboss.netty.channel.SimpleChannelUpstreamHandler)" class="delimiter">(</a><a href="#331610" title="enumerator extends java.lang.Object with play.api.libs.iteratee.Enumerator[A]" id="331611">enumerator</a>, <a href="#331610" title="newWebSocketInHandler extends org.jboss.netty.channel.SimpleChannelUpstreamHandler" id="331612">handler</a><span class="delimiter">)</span> = <a href="#325776" title="(frameFormatter: play.api.mvc.WebSocket.FrameFormatter[A])(java.lang.Object with play.api.libs.iteratee.Enumerator[A]{val iterateeAgent: play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]; def frameReceived(ctx: org.jboss.netty.channel.ChannelHandlerContext,input: play.api.libs.iteratee.Input[A]): Unit}, org.jboss.netty.channel.SimpleChannelUpstreamHandler)">newWebSocketInHandler</a><span title="(java.lang.Object with play.api.libs.iteratee.Enumerator[A]{val iterateeAgent: play.core.Agent.Operations[Option[play.api.libs.iteratee.Iteratee[A,Any]]]; def frameReceived(ctx: org.jboss.netty.channel.ChannelHandlerContext,input: play.api.libs.iteratee.Input[A]): Unit}, org.jboss.netty.channel.SimpleChannelUpstreamHandler) @unchecked" class="delimiter">(</span><a href="#331001" title="play.api.mvc.WebSocket.FrameFormatter[A]">frameFormatter</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="org.jboss.netty.channel.ChannelPipeline" id="331613">p</a>: <span title="org.jboss.netty.channel.ChannelPipeline">ChannelPipeline</span> = <a href="#330998" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()org.jboss.netty.channel.ChannelPipeline">getPipeline</span><span class="delimiter">(</span><span class="delimiter">)</span>;
    <a href="#331613" title="org.jboss.netty.channel.ChannelPipeline">p</a>.<span title="(x$1: java.lang.String, x$2: java.lang.String, x$3: org.jboss.netty.channel.ChannelHandler)org.jboss.netty.channel.ChannelHandler">replace</span><span class="delimiter">(</span><span title="java.lang.String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <span title="java.lang.String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <a href="#331612" title="newWebSocketInHandler extends org.jboss.netty.channel.SimpleChannelUpstreamHandler">handler</a><span class="delimiter">)</span>;
    <a href="#331611" title="enumerator extends java.lang.Object with play.api.libs.iteratee.Enumerator[A]">enumerator</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(req: org.jboss.netty.handler.codec.http.HttpRequest)java.lang.Object with play.core.server.WebSocketable" id="325782">websocketable</a><span class="delimiter">(</span><a title="org.jboss.netty.handler.codec.http.HttpRequest" id="329413">req</a>: <span title="org.jboss.netty.handler.codec.http.HttpRequest">HttpRequest</span><span class="delimiter">)</span> = <a href="#329416" title="java.lang.Object with play.core.server.WebSocketable" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with play.core.server.WebSocketable" id="329416">server</a>.<a href="../Server.scala.html#20479" title="play.core.server.WebSocketable">WebSocketable</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="329418">check</a> =
      HttpHeaders.Values.<span title="java.lang.String(&quot;WebSocket&quot;)">WEBSOCKET</span>.<span title="(x$1: java.lang.String)Boolean">equalsIgnoreCase</span><span class="delimiter">(</span><a href="#329413" title="org.jboss.netty.handler.codec.http.HttpRequest">req</a>.<span title="(x$1: java.lang.String)java.lang.String">getHeader</span><span class="delimiter">(</span>HttpHeaders.Names.<span title="java.lang.String(&quot;Upgrade&quot;)">UPGRADE</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(header: String)java.lang.String" id="329419">getHeader</a><span class="delimiter">(</span><a title="String" id="329423">header</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#329413" title="org.jboss.netty.handler.codec.http.HttpRequest">req</a>.<span title="(x$1: java.lang.String)java.lang.String">getHeader</span><span class="delimiter">(</span><a href="#329423" title="String">header</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>
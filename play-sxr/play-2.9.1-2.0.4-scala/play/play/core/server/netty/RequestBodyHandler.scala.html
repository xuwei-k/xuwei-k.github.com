<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>play/play/core/server/netty/RequestBodyHandler.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> play.core.server.netty

<span class="keyword">import</span> org.jboss.netty.buffer._
<span class="keyword">import</span> org.jboss.netty.channel._
<span class="keyword">import</span> org.jboss.netty.bootstrap._
<span class="keyword">import</span> org.jboss.netty.channel.<span title="object org.jboss.netty.channel.Channels">Channels</span>._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http._
<span class="keyword">import</span> org.jboss.netty.channel.socket.nio._
<span class="keyword">import</span> org.jboss.netty.handler.stream._

<span class="keyword">import</span> org.jboss.netty.channel.group._
<span class="keyword">import</span> java.util.concurrent._

<span class="keyword">import</span> play.core._
<span class="keyword">import</span> server.Server
<span class="keyword">import</span> play.api._
<span class="keyword">import</span> play.api.mvc._
<span class="keyword">import</span> play.api.libs.iteratee._
<span class="keyword">import</span> play.api.libs.iteratee.<a href="../../../api/libs/iteratee/Iteratee.scala.html#14647" title="object play.api.libs.iteratee.Input">Input</a>._
<span class="keyword">import</span> play.api.libs.concurrent._

<span class="keyword">import</span> scala.collection.<span title="object scala.collection.JavaConverters">JavaConverters</span>._

<span class="keyword">private</span><span class="delimiter">[</span>server<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait RequestBodyHandler extends java.lang.Object with ScalaObject" id="20641">RequestBodyHandler</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[R](firstIteratee: play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]], allChannels: org.jboss.netty.channel.group.DefaultChannelGroup, server: play.core.server.Server)(play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]], org.jboss.netty.channel.SimpleChannelUpstreamHandler)" id="325784">newRequestBodyHandler</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="325786">R</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" id="330739">firstIteratee</a>: <a href="../../../api/libs/concurrent/Promise.scala.html#13536" title="play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">Promise</a><span class="delimiter">[</span>Iteratee<span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Either<span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>, <a title="org.jboss.netty.channel.group.DefaultChannelGroup" id="330740">allChannels</a>: <span title="org.jboss.netty.channel.group.DefaultChannelGroup">DefaultChannelGroup</span>, <a title="play.core.server.Server" id="330741">server</a>: <a href="../Server.scala.html#20524" title="play.core.server.Server">Server</a><span class="delimiter">)</span>: <span title="(play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]], org.jboss.netty.channel.SimpleChannelUpstreamHandler)" class="delimiter">(</span>Promise<span class="delimiter">[</span>Iteratee<span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Either<span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>, SimpleChannelUpstreamHandler<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Boolean" id="331077">redeemed</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">var</span> <a title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" id="331078">p</a> = <a href="../../../api/libs/concurrent/Promise.scala.html#78506" title="[A]()play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]">Promise</a><span title="()play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" class="delimiter">[</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#14613" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">Iteratee</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Either<span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="331079">MAX_MESSAGE_WATERMARK</a> = <span title="Int(10)" class="int">10</span>
    <span class="keyword">val</span> <a title="Int" id="331080">MIN_MESSAGE_WATERMARK</a> = <span title="Int(10)" class="int">10</span>
    <span class="keyword">import</span> scala.concurrent.stm._
    <span class="keyword">val</span> <a title="scala.concurrent.stm.Ref[Int]" id="331082">counter</a> = <span title="(initialValue: Int)scala.concurrent.stm.Ref[Int]">Ref</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

    <span class="keyword">var</span> <a title="scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" id="331083">iteratee</a>: <span title="scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">Ref</span><span class="delimiter">[</span>Iteratee<span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Either<span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span> = <span title="(initialValue: play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])(implicit om: scala.reflect.OptManifest[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]])scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">Ref</span><span title="(clazz: java.lang.Class[_], arg1: scala.reflect.OptManifest[_], args: scala.reflect.OptManifest[_]*)scala.reflect.ClassManifest[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" class="delimiter">(</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#14614" title="object play.api.libs.iteratee.Iteratee">Iteratee</a>.<a href="../../../api/libs/iteratee/Iteratee.scala.html#74599" title="(i: play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]])play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">flatten</a><span class="delimiter">(</span><a href="#330739" title="play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">firstIteratee</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, chunk: play.api.libs.iteratee.Input[Array[Byte]])Unit" id="331084">pushChunk</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="331169">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="play.api.libs.iteratee.Input[Array[Byte]]" id="331170">chunk</a>: <a href="../../../api/libs/iteratee/Iteratee.scala.html#14646" title="play.api.libs.iteratee.Input[Array[Byte]]">Input</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#331082" title="scala.concurrent.stm.Ref[Int]">counter</a>.<span title="=&gt; scala.concurrent.stm.Ref.View[Int]">single</span>.<span title="(f: Int =&gt; Int)Int">transformAndGet</span> <span class="delimiter">{</span> <a href="#331173" title="Int">_</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span> <span class="delimiter">}</span> <span title="(x: Int)Boolean">&gt;</span> <a href="#331079" title="Int">MAX_MESSAGE_WATERMARK</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#331169" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()Boolean">isOpen</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#331169" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Boolean)org.jboss.netty.channel.ChannelFuture">setReadable</span><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#331077" title="Boolean">redeemed</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" id="331190">itPromise</a> = <a href="../../../api/libs/concurrent/Promise.scala.html#78506" title="[A]()play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]">Promise</a><span title="()play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" class="delimiter">[</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#14613" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">Iteratee</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Either<span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]" id="331191">current</a> = <a href="#331083" title="scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">iteratee</a>.<span title="=&gt; scala.concurrent.stm.Ref.View[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">single</span>.<span title="(v: play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">swap</span><span class="delimiter">(</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#14614" title="object play.api.libs.iteratee.Iteratee">Iteratee</a>.<a href="../../../api/libs/iteratee/Iteratee.scala.html#74599" title="(i: play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]])play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">flatten</a><span class="delimiter">(</span><a href="#331190" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">itPromise</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]" id="331192">next</a> = <a href="#331191" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">current</a>.<a href="../../../api/libs/iteratee/Iteratee.scala.html#74083" title="[B, C](done: (Either[play.api.mvc.Result,R], play.api.libs.iteratee.Input[Array[Byte]]) =&gt; play.api.libs.iteratee.Iteratee[B,C], cont: play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]] =&gt; play.api.libs.iteratee.Iteratee[B,C], error: (String, play.api.libs.iteratee.Input[Array[Byte]]) =&gt; play.api.libs.iteratee.Iteratee[B,C])play.api.libs.iteratee.Iteratee[B,C]">pureFlatFold</a><span title="(done: (Either[play.api.mvc.Result,R], play.api.libs.iteratee.Input[Array[Byte]]) =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]], cont: play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]], error: (String, play.api.libs.iteratee.Input[Array[Byte]]) =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]" class="delimiter">[</span><span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <span title="Either[play.api.mvc.Result,R]">Either</span><span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span>
          <span class="delimiter">(</span><a title="Either[play.api.mvc.Result,R]" id="331207">_</a>, <a title="play.api.libs.iteratee.Input[Array[Byte]]" id="331208">_</a><span class="delimiter">)</span> =&gt; <a href="#331191" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">current</a>,
          <a title="play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]" id="331210">k</a> =&gt; <a href="#331210" title="(v1: play.api.libs.iteratee.Input[Array[Byte]])play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">k</a><span class="delimiter">(</span><a href="#331170" title="play.api.libs.iteratee.Input[Array[Byte]]">chunk</a><span class="delimiter">)</span>,
          <span class="delimiter">(</span><a title="String" id="331213">e</a>, <a title="play.api.libs.iteratee.Input[Array[Byte]]" id="331214">_</a><span class="delimiter">)</span> =&gt; <a href="#331191" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">current</a><span class="delimiter">)</span>

        <a href="#331190" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">itPromise</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#102929" title="(a: =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])Unit">redeem</a><span class="delimiter">(</span><a href="#331192" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">next</a><span class="delimiter">)</span>

        <a href="#331192" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">next</a>.<a href="../../../api/libs/iteratee/Iteratee.scala.html#74080" title="(done: (Either[play.api.mvc.Result,R], play.api.libs.iteratee.Input[Array[Byte]]) =&gt; Any, cont: play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]] =&gt; Any, error: (String, play.api.libs.iteratee.Input[Array[Byte]]) =&gt; Any)play.api.libs.concurrent.Promise[Any]">pureFold</a><span title="Unit" class="delimiter">(</span>
          <span class="delimiter">(</span><a title="Either[play.api.mvc.Result,R]" id="331224">a</a>, <a title="play.api.libs.iteratee.Input[Array[Byte]]" id="331225">e</a><span class="delimiter">)</span> =&gt; <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#331077" title="Boolean">redeemed</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#331078" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">p</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#102929" title="(a: =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])Unit">redeem</a><span class="delimiter">(</span><a href="#331192" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">next</a><span class="delimiter">)</span>;
            <a href="#331083" title="scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">iteratee</a> = <span title="Null(null)" class="keyword">null</span>; <a href="#331078" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">p</a> = <span title="Null(null)" class="keyword">null</span>; <a href="#331077" title="Boolean">redeemed</a> = <span title="Boolean(true)" class="keyword">true</span>
            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#331169" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()Boolean">isOpen</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#331169" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Boolean)org.jboss.netty.channel.ChannelFuture">setReadable</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>,
          <a title="play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]" id="331236">k</a> =&gt;
            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#331082" title="scala.concurrent.stm.Ref[Int]">counter</a>.<span title="=&gt; scala.concurrent.stm.Ref.View[Int]">single</span>.<span title="(f: Int =&gt; Int)Int">transformAndGet</span> <span class="delimiter">{</span> <a href="#331238" title="Int">_</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span> <span class="delimiter">}</span> <span title="(x: Int)Boolean">&lt;=</span> <a href="#331080" title="Int">MIN_MESSAGE_WATERMARK</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#331169" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()Boolean">isOpen</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#331169" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Boolean)org.jboss.netty.channel.ChannelFuture">setReadable</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>,

          <span class="delimiter">(</span><a title="String" id="331256">msg</a>, <a title="play.api.libs.iteratee.Input[Array[Byte]]" id="331257">e</a><span class="delimiter">)</span> =&gt;
            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#331077" title="Boolean">redeemed</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#331078" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">p</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#102929" title="(a: =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])Unit">redeem</a><span class="delimiter">(</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#74229" title="(a: Left[play.api.mvc.Results.Status,Nothing], e: play.api.libs.iteratee.Input[Array[Byte]])play.api.libs.iteratee.Iteratee[Array[Byte],Left[play.api.mvc.Results.Status,Nothing]]">Done</a><span class="delimiter">(</span><span title="(a: play.api.mvc.Results.Status)Left[play.api.mvc.Results.Status,Nothing]">Left</span><span class="delimiter">(</span><a href="../../../api/mvc/Results.scala.html#16918" title="object play.api.mvc.Results">Results</a>.<a href="../../../api/mvc/Results.scala.html#66169" title="=&gt; play.api.mvc.Results.Status">InternalServerError</a><span class="delimiter">)</span>, <a href="#331257" title="play.api.libs.iteratee.Input[Array[Byte]]">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#331083" title="scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">iteratee</a> = <span title="Null(null)" class="keyword">null</span>; <a href="#331078" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">p</a> = <span title="Null(null)" class="keyword">null</span>; <a href="#331077" title="Boolean">redeemed</a> = <span title="Boolean(true)" class="keyword">true</span>
              <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#331169" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()Boolean">isOpen</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#331169" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Boolean)org.jboss.netty.channel.ChannelFuture">setReadable</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
            <span class="delimiter">}</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span title="(_1: play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]], _2: org.jboss.netty.channel.SimpleChannelUpstreamHandler)(play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]], org.jboss.netty.channel.SimpleChannelUpstreamHandler)" class="delimiter">(</span><a href="#331078" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">p</a>, <a href="#331283" title="org.jboss.netty.channel.SimpleChannelUpstreamHandler" class="keyword">new</a> <a title="anonymous class $anon extends org.jboss.netty.channel.SimpleChannelUpstreamHandler" id="331283">SimpleChannelUpstreamHandler</a> <span class="delimiter">{</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.MessageEvent)Unit" id="331287">messageReceived</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="331290">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.MessageEvent" id="331291">e</a>: <span title="org.jboss.netty.channel.MessageEvent">MessageEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#331291" title="org.jboss.netty.channel.MessageEvent">e</a>.<span title="()java.lang.Object">getMessage</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>

          <span class="keyword">case</span> <a title="Unit" id="331297">chunk</a>: <span title="org.jboss.netty.handler.codec.http.HttpChunk">HttpChunk</span> <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#331297" title="org.jboss.netty.handler.codec.http.HttpChunk">chunk</a>.<span title="()Boolean">isLast</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="org.jboss.netty.buffer.ChannelBuffer" id="331298">cBuffer</a> = <a href="#331297" title="org.jboss.netty.handler.codec.http.HttpChunk">chunk</a>.<span title="()org.jboss.netty.buffer.ChannelBuffer">getContent</span><span class="delimiter">(</span><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="Array[Byte]" id="331299">bytes</a> = <span title="Array[Byte]" class="keyword">new</span> <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><a href="#331298" title="org.jboss.netty.buffer.ChannelBuffer">cBuffer</a>.<span title="()Int">readableBytes</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#331298" title="org.jboss.netty.buffer.ChannelBuffer">cBuffer</a>.<span title="(x$1: Array[Byte])Unit">readBytes</span><span class="delimiter">(</span><a href="#331299" title="Array[Byte]">bytes</a><span class="delimiter">)</span>
            <a href="#331084" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, chunk: play.api.libs.iteratee.Input[Array[Byte]])Unit">pushChunk</a><span class="delimiter">(</span><a href="#331290" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="../../../api/libs/iteratee/Iteratee.scala.html#74157" title="(e: Array[Byte])play.api.libs.iteratee.Input.El[Array[Byte]]">El</a><span class="delimiter">(</span><a href="#331299" title="Array[Byte]">bytes</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <a title="Unit" id="331309">chunk</a>: <span title="org.jboss.netty.handler.codec.http.HttpChunk">HttpChunk</span> <span class="keyword">if</span> <a href="#331309" title="org.jboss.netty.handler.codec.http.HttpChunk">chunk</a>.<span title="()Boolean">isLast</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
            <a href="#331084" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, chunk: play.api.libs.iteratee.Input[Array[Byte]])Unit">pushChunk</a><span class="delimiter">(</span><a href="#331290" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="../../../api/libs/iteratee/Iteratee.scala.html#66599" title="object play.api.libs.iteratee.Input.EOF">EOF</a><span class="delimiter">)</span>
            <a href="#331290" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()org.jboss.netty.channel.ChannelPipeline">getPipeline</span>.<span title="(x$1: java.lang.String, x$2: java.lang.String, x$3: org.jboss.netty.channel.ChannelHandler)org.jboss.netty.channel.ChannelHandler">replace</span><span title="Unit" class="delimiter">(</span><span title="java.lang.String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <span title="java.lang.String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <span title="play.core.server.netty.PlayDefaultUpstreamHandler" class="keyword">new</span> <a href="PlayDefaultUpstreamHandler.scala.html#20992" title="play.core.server.netty.PlayDefaultUpstreamHandler">PlayDefaultUpstreamHandler</a><span class="delimiter">(</span><a href="#330741" title="play.core.server.Server">server</a>, <a href="#330740" title="org.jboss.netty.channel.group.DefaultChannelGroup">allChannels</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="keyword">case</span> <a title="Unit" id="331322">unexpected</a> =&gt; <a href="../../../api/Logger.scala.html#81627" title="(name: String)play.api.Logger">Logger</a><span class="delimiter">(</span><span title="java.lang.String(&quot;play&quot;)" class="string">&quot;play&quot;</span><span class="delimiter">)</span>.<a href="../../../api/Logger.scala.html#81621" title="(message: =&gt; String)Unit">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Oops, unexpected message received in NettyServer/ChunkHandler (please report this problem): &quot;)" class="string">&quot;Oops, unexpected message received in NettyServer/ChunkHandler (please report this problem): &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#331322" title="java.lang.Object">unexpected</a><span class="delimiter">)</span>

        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.ExceptionEvent)Unit" id="331288">exceptionCaught</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="331292">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.ExceptionEvent" id="331293">e</a>: <span title="org.jboss.netty.channel.ExceptionEvent">ExceptionEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#331293" title="org.jboss.netty.channel.ExceptionEvent">e</a>.<span title="()java.lang.Throwable">getCause</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>;
        <a href="#331293" title="org.jboss.netty.channel.ExceptionEvent">e</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()org.jboss.netty.channel.ChannelFuture">close</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>; <span class="comment">/*really? */</span>
      <span class="delimiter">}</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.ChannelStateEvent)Unit" id="331289">channelDisconnected</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="331294">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.ChannelStateEvent" id="331295">e</a>: <span title="org.jboss.netty.channel.ChannelStateEvent">ChannelStateEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#331084" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, chunk: play.api.libs.iteratee.Input[Array[Byte]])Unit">pushChunk</a><span class="delimiter">(</span><a href="#331294" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="../../../api/libs/iteratee/Iteratee.scala.html#66599" title="object play.api.libs.iteratee.Input.EOF">EOF</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>
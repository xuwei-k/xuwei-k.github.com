<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play-ws/play/api/libs/ws/ssl/CertificateGenerator.scala</title>
        <script type="text/javascript" src="../../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 *
 *  * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 *
 */</span>
<span class="keyword">package</span> play.api.libs.ws.ssl

<span class="keyword">import</span> sun.security.x509._
<span class="keyword">import</span> java.security.cert._
<span class="keyword">import</span> java.security._
<span class="keyword">import</span> java.math.BigInteger
<span class="keyword">import</span> java.util.Date
<span class="keyword">import</span> sun.security.util.ObjectIdentifier
<span class="keyword">import</span> org.joda.time.Instant
<span class="keyword">import</span> scala.util.<span title="scala.util.Properties.type">Properties</span>.isJavaAtLeast

<span class="comment">/**
 * Used for testing only.  This relies on internal sun.security packages, so cannot be used in OpenJDK.
 */</span>
<span class="keyword">object</span> <a title="play.api.libs.ws.ssl.CertificateGenerator.type" id="play.api.libs.ws.ssl.CertificateGenerator">CertificateGenerator</a> <a href="#play.api.libs.ws.ssl.CertificateGenerator" title="play.api.libs.ws.ssl.CertificateGenerator.type" class="delimiter">{</a>

  <span class="comment">// http://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html#KeyPairGenerator</span>
  <span class="comment">// http://www.keylength.com/en/4/</span>

  <span class="comment">/**
   * Generates a certificate using RSA (which is available in 1.6).
   */</span>
  <span class="keyword">def</span> <a title="(keySize: Int, from: org.joda.time.Instant, duration: Int)java.security.cert.X509Certificate" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256">generateRSAWithSHA256</a><span class="delimiter">(</span><a title="Int" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256$default$1">keySize</a>: <span title="Int">Int</span> = <span title="Int(2048)" class="int">2048</span>, <a title="org.joda.time.Instant" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256$default$2">from</a>: <span title="org.joda.time.Instant">Instant</span> = <span title="org.joda.time.Instant.type">Instant</span>.<span title="()org.joda.time.Instant">now</span>, <a title="Int" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256$default$3">duration</a>: <span title="Int">Int</span> = <span title="Int(5000000)" class="int">5000000</span><span class="delimiter">)</span>: <span title="java.security.cert.X509Certificate">X509Certificate</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256.dn">dn</a> = <span title="String(&quot;CN=localhost, OU=Unit Testing, O=Mavericks, L=Moon Base 1, ST=Cyberspace, C=CY&quot;)" class="string">&quot;CN=localhost, OU=Unit Testing, O=Mavericks, L=Moon Base 1, ST=Cyberspace, C=CY&quot;</span>
    <span class="keyword">val</span> <a title="org.joda.time.Instant" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256.to">to</a> = <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256$default$2" title="org.joda.time.Instant">from</a>.<span title="(x$1: Long)org.joda.time.Instant">plus</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256$default$3" title="=&gt; Long">duration</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="java.security.KeyPairGenerator" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256.keyGen">keyGen</a> = <span title="java.security.KeyPairGenerator.type">KeyPairGenerator</span>.<span title="(x$1: String)java.security.KeyPairGenerator">getInstance</span><span class="delimiter">(</span><span title="String(&quot;RSA&quot;)" class="string">&quot;RSA&quot;</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256.keyGen" title="java.security.KeyPairGenerator">keyGen</a>.<span title="(x$1: Int, x$2: java.security.SecureRandom)Unit">initialize</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256$default$1" title="Int">keySize</a>, <span title="java.security.SecureRandom" class="keyword">new</span> <span title="java.security.SecureRandom">SecureRandom</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.security.KeyPair" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256.pair">pair</a> = <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256.keyGen" title="java.security.KeyPairGenerator">keyGen</a>.<span title="()java.security.KeyPair">generateKeyPair</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate" title="(dn: String, pair: java.security.KeyPair, from: java.util.Date, to: java.util.Date, algorithm: String, oid: sun.security.util.ObjectIdentifier)java.security.cert.X509Certificate">generateCertificate</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256.dn" title="String">dn</a>, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256.pair" title="java.security.KeyPair">pair</a>, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256$default$2" title="org.joda.time.Instant">from</a>.<span title="()java.util.Date">toDate</span>, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithSHA256.to" title="org.joda.time.Instant">to</a>.<span title="()java.util.Date">toDate</span>, <span title="String(&quot;SHA256withRSA&quot;)" class="string">&quot;SHA256withRSA&quot;</span>, <span title="sun.security.x509.AlgorithmId.type">AlgorithmId</span>.<span title="sun.security.util.ObjectIdentifier">sha256WithRSAEncryption_oid</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(certificate: java.security.cert.X509Certificate)String" id="play.api.libs.ws.ssl.CertificateGenerator.toPEM">toPEM</a><span class="delimiter">(</span><a title="java.security.cert.X509Certificate" id="play.api.libs.ws.ssl.CertificateGenerator.toPEM.certificate">certificate</a>: <span title="java.security.cert.X509Certificate">X509Certificate</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> org.apache.commons.codec.binary.Base64
    <span class="keyword">val</span> <a title="org.apache.commons.codec.binary.Base64" id="play.api.libs.ws.ssl.CertificateGenerator.toPEM.encoder">encoder</a> = <span title="(x$1: Int)org.apache.commons.codec.binary.Base64" class="keyword">new</span> <span title="org.apache.commons.codec.binary.Base64">Base64</span><span class="delimiter">(</span><span title="Int(64)" class="int">64</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl.CertificateGenerator.toPEM.certBegin">certBegin</a> = <span title="String(&quot;-----BEGIN CERTIFICATE-----\n&quot;)" class="string">&quot;-----BEGIN CERTIFICATE-----\n&quot;</span>
    <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl.CertificateGenerator.toPEM.certEnd">certEnd</a> = <span title="String(&quot;-----END CERTIFICATE-----&quot;)" class="string">&quot;-----END CERTIFICATE-----&quot;</span>

    <span class="keyword">val</span> <a title="Array[Byte]" id="play.api.libs.ws.ssl.CertificateGenerator.toPEM.derCert">derCert</a> = <a href="#play.api.libs.ws.ssl.CertificateGenerator.toPEM.certificate" title="java.security.cert.X509Certificate">certificate</a>.<span title="()Array[Byte]">getEncoded</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl.CertificateGenerator.toPEM.pemCertPre">pemCertPre</a> = <span title="(x$1: Array[Byte], x$2: String)String" class="keyword">new</span> <span title="String">String</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.toPEM.encoder" title="org.apache.commons.codec.binary.Base64">encoder</a>.<span title="(x$1: Array[Byte])Array[Byte]">encode</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.toPEM.derCert" title="Array[Byte]">derCert</a><span class="delimiter">)</span>, <span title="String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl.CertificateGenerator.toPEM.pemCert">pemCert</a> = <a href="#play.api.libs.ws.ssl.CertificateGenerator.toPEM.certBegin" title="String">certBegin</a> <span title="(x$1: Any)String">+</span> <a href="#play.api.libs.ws.ssl.CertificateGenerator.toPEM.pemCertPre" title="String">pemCertPre</a> <span title="(x$1: Any)String">+</span> <a href="#play.api.libs.ws.ssl.CertificateGenerator.toPEM.certEnd" title="String">certEnd</a>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.toPEM.pemCert" title="String">pemCert</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(keySize: Int, from: org.joda.time.Instant, duration: Int)java.security.cert.X509Certificate" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5">generateRSAWithMD5</a><span class="delimiter">(</span><a title="Int" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5$default$1">keySize</a>: <span title="Int">Int</span> = <span title="Int(2048)" class="int">2048</span>, <a title="org.joda.time.Instant" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5$default$2">from</a>: <span title="org.joda.time.Instant">Instant</span> = <span title="org.joda.time.Instant.type">Instant</span>.<span title="()org.joda.time.Instant">now</span>, <a title="Int" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5$default$3">duration</a>: <span title="Int">Int</span> = <span title="Int(5000000)" class="int">5000000</span><span class="delimiter">)</span>: <span title="java.security.cert.X509Certificate">X509Certificate</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5.dn">dn</a> = <span title="String(&quot;CN=localhost, OU=Unit Testing, O=Mavericks, L=Moon Base 1, ST=Cyberspace, C=CY&quot;)" class="string">&quot;CN=localhost, OU=Unit Testing, O=Mavericks, L=Moon Base 1, ST=Cyberspace, C=CY&quot;</span>
    <span class="keyword">val</span> <a title="org.joda.time.Instant" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5.to">to</a> = <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5$default$2" title="org.joda.time.Instant">from</a>.<span title="(x$1: Long)org.joda.time.Instant">plus</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5$default$3" title="=&gt; Long">duration</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="java.security.KeyPairGenerator" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5.keyGen">keyGen</a> = <span title="java.security.KeyPairGenerator.type">KeyPairGenerator</span>.<span title="(x$1: String)java.security.KeyPairGenerator">getInstance</span><span class="delimiter">(</span><span title="String(&quot;RSA&quot;)" class="string">&quot;RSA&quot;</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5.keyGen" title="java.security.KeyPairGenerator">keyGen</a>.<span title="(x$1: Int, x$2: java.security.SecureRandom)Unit">initialize</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5$default$1" title="Int">keySize</a>, <span title="java.security.SecureRandom" class="keyword">new</span> <span title="java.security.SecureRandom">SecureRandom</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.security.KeyPair" id="play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5.pair">pair</a> = <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5.keyGen" title="java.security.KeyPairGenerator">keyGen</a>.<span title="()java.security.KeyPair">generateKeyPair</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate" title="(dn: String, pair: java.security.KeyPair, from: java.util.Date, to: java.util.Date, algorithm: String, oid: sun.security.util.ObjectIdentifier)java.security.cert.X509Certificate">generateCertificate</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5.dn" title="String">dn</a>, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5.pair" title="java.security.KeyPair">pair</a>, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5$default$2" title="org.joda.time.Instant">from</a>.<span title="()java.util.Date">toDate</span>, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateRSAWithMD5.to" title="org.joda.time.Instant">to</a>.<span title="()java.util.Date">toDate</span>, <span title="String(&quot;MD5WithRSA&quot;)" class="string">&quot;MD5WithRSA&quot;</span>, <span title="sun.security.x509.AlgorithmId.type">AlgorithmId</span>.<span title="sun.security.util.ObjectIdentifier">md5WithRSAEncryption_oid</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>play<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(dn: String, pair: java.security.KeyPair, from: java.util.Date, to: java.util.Date, algorithm: String, oid: sun.security.util.ObjectIdentifier)java.security.cert.X509Certificate" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate">generateCertificate</a><span class="delimiter">(</span><a title="String" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.dn">dn</a>: <span title="String">String</span>, <a title="java.security.KeyPair" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.pair">pair</a>: <span title="java.security.KeyPair">KeyPair</span>, <a title="java.util.Date" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.from">from</a>: <span title="java.util.Date">Date</span>, <a title="java.util.Date" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.to">to</a>: <span title="java.util.Date">Date</span>, <a title="String" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.algorithm">algorithm</a>: <span title="String">String</span>, <a title="sun.security.util.ObjectIdentifier" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.oid">oid</a>: <span title="sun.security.util.ObjectIdentifier">ObjectIdentifier</span><span class="delimiter">)</span>: <span title="java.security.cert.X509Certificate">X509Certificate</span> = <span class="delimiter">{</span>

    <span class="keyword">val</span> <a title="sun.security.x509.X509CertInfo" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info">info</a>: <span title="sun.security.x509.X509CertInfo">X509CertInfo</span> = <span title="sun.security.x509.X509CertInfo" class="keyword">new</span> <span title="sun.security.x509.X509CertInfo">X509CertInfo</span>
    <span class="keyword">val</span> <a title="sun.security.x509.CertificateValidity" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.interval">interval</a>: <span title="sun.security.x509.CertificateValidity">CertificateValidity</span> = <span title="(x$1: java.util.Date, x$2: java.util.Date)sun.security.x509.CertificateValidity" class="keyword">new</span> <span title="sun.security.x509.CertificateValidity">CertificateValidity</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.from" title="java.util.Date">from</a>, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.to" title="java.util.Date">to</a><span class="delimiter">)</span>
    <span class="comment">// I have no idea why 64 bits specifically are used for the certificate serial number.</span>
    <span class="keyword">val</span> <a title="java.math.BigInteger" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.sn">sn</a>: <span title="java.math.BigInteger">BigInteger</span> = <span title="(x$1: Int, x$2: java.util.Random)java.math.BigInteger" class="keyword">new</span> <span title="java.math.BigInteger">BigInteger</span><span class="delimiter">(</span><span title="Int(64)" class="int">64</span>, <span title="java.security.SecureRandom" class="keyword">new</span> <span title="java.security.SecureRandom">SecureRandom</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="sun.security.x509.X500Name" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.owner">owner</a>: <span title="sun.security.x509.X500Name">X500Name</span> = <span title="sun.security.x509.X500Name" class="keyword">new</span> <span title="sun.security.x509.X500Name">X500Name</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.dn" title="String">dn</a><span class="delimiter">)</span>

    <span class="comment">// Note: CertificateSubjectName and CertificateIssuerName are removed in Java 8</span>
    <span class="comment">// and when setting the subject or issuer just the X500Name should be used.</span>
    <span class="keyword">val</span> <a title="Boolean" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.justName">justName</a> = <span title="(version: String)Boolean">isJavaAtLeast</span><span class="delimiter">(</span><span title="String(&quot;1.8&quot;)" class="string">&quot;1.8&quot;</span><span class="delimiter">)</span>

    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info" title="sun.security.x509.X509CertInfo">info</a>.<span title="(x$1: String, x$2: Any)Unit">set</span><span class="delimiter">(</span>X509CertInfo.<span title="String(&quot;validity&quot;)">VALIDITY</span>, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.interval" title="sun.security.x509.CertificateValidity">interval</a><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info" title="sun.security.x509.X509CertInfo">info</a>.<span title="(x$1: String, x$2: Any)Unit">set</span><span class="delimiter">(</span>X509CertInfo.<span title="String(&quot;serialNumber&quot;)">SERIAL_NUMBER</span>, <span title="sun.security.x509.CertificateSerialNumber" class="keyword">new</span> <span title="sun.security.x509.CertificateSerialNumber">CertificateSerialNumber</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.sn" title="java.math.BigInteger">sn</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info" title="sun.security.x509.X509CertInfo">info</a>.<span title="(x$1: String, x$2: Any)Unit">set</span><span class="delimiter">(</span>X509CertInfo.<span title="String(&quot;subject&quot;)">SUBJECT</span>, <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.justName" title="Boolean">justName</a><span class="delimiter">)</span> <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.owner" title="sun.security.x509.X500Name">owner</a> <span class="keyword">else</span> <span title="sun.security.x509.CertificateSubjectName" class="keyword">new</span> <span title="sun.security.x509.CertificateSubjectName">CertificateSubjectName</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.owner" title="sun.security.x509.X500Name">owner</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info" title="sun.security.x509.X509CertInfo">info</a>.<span title="(x$1: String, x$2: Any)Unit">set</span><span class="delimiter">(</span>X509CertInfo.<span title="String(&quot;issuer&quot;)">ISSUER</span>, <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.justName" title="Boolean">justName</a><span class="delimiter">)</span> <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.owner" title="sun.security.x509.X500Name">owner</a> <span class="keyword">else</span> <span title="sun.security.x509.CertificateIssuerName" class="keyword">new</span> <span title="sun.security.x509.CertificateIssuerName">CertificateIssuerName</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.owner" title="sun.security.x509.X500Name">owner</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info" title="sun.security.x509.X509CertInfo">info</a>.<span title="(x$1: String, x$2: Any)Unit">set</span><span class="delimiter">(</span>X509CertInfo.<span title="String(&quot;key&quot;)">KEY</span>, <span title="sun.security.x509.CertificateX509Key" class="keyword">new</span> <span title="sun.security.x509.CertificateX509Key">CertificateX509Key</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.pair" title="java.security.KeyPair">pair</a>.<span title="()java.security.PublicKey">getPublic</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info" title="sun.security.x509.X509CertInfo">info</a>.<span title="(x$1: String, x$2: Any)Unit">set</span><span class="delimiter">(</span>X509CertInfo.<span title="String(&quot;version&quot;)">VERSION</span>, <span title="(x$1: Int)sun.security.x509.CertificateVersion" class="keyword">new</span> <span title="sun.security.x509.CertificateVersion">CertificateVersion</span><span class="delimiter">(</span>CertificateVersion.<span title="Int(2)">V3</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">var</span> <a title="sun.security.x509.AlgorithmId" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.algo">algo</a>: <span title="sun.security.x509.AlgorithmId">AlgorithmId</span> = <span title="(x$1: sun.security.util.ObjectIdentifier)sun.security.x509.AlgorithmId" class="keyword">new</span> <span title="sun.security.x509.AlgorithmId">AlgorithmId</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.oid" title="sun.security.util.ObjectIdentifier">oid</a><span class="delimiter">)</span>

    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info" title="sun.security.x509.X509CertInfo">info</a>.<span title="(x$1: String, x$2: Any)Unit">set</span><span class="delimiter">(</span>X509CertInfo.<span title="String(&quot;algorithmID&quot;)">ALGORITHM_ID</span>, <span title="sun.security.x509.CertificateAlgorithmId" class="keyword">new</span> <span title="sun.security.x509.CertificateAlgorithmId">CertificateAlgorithmId</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.algo" title="sun.security.x509.AlgorithmId">algo</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="sun.security.x509.X509CertImpl" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.cert">cert</a>: <span title="sun.security.x509.X509CertImpl">X509CertImpl</span> = <span title="(x$1: sun.security.x509.X509CertInfo)sun.security.x509.X509CertImpl" class="keyword">new</span> <span title="sun.security.x509.X509CertImpl">X509CertImpl</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info" title="sun.security.x509.X509CertInfo">info</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.security.PrivateKey" id="play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.privkey">privkey</a>: <span title="java.security.PrivateKey">PrivateKey</span> = <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.pair" title="java.security.KeyPair">pair</a>.<span title="()java.security.PrivateKey">getPrivate</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.cert" title="sun.security.x509.X509CertImpl">cert</a>.<span title="(x$1: java.security.PrivateKey, x$2: String)Unit">sign</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.privkey" title="java.security.PrivateKey">privkey</a>, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.algorithm" title="String">algorithm</a><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.algo" title="sun.security.x509.AlgorithmId">algo</a> = <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.cert" title="sun.security.x509.X509CertImpl">cert</a>.<span title="(x$1: String)Object">get</span><span class="delimiter">(</span>X509CertImpl.<span title="String(&quot;x509.algorithm&quot;)">SIG_ALG</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="sun.security.x509.AlgorithmId" class="delimiter">[</span><span title="sun.security.x509.AlgorithmId">AlgorithmId</span><span class="delimiter">]</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info" title="sun.security.x509.X509CertInfo">info</a>.<span title="(x$1: String, x$2: Any)Unit">set</span><span class="delimiter">(</span>CertificateAlgorithmId.NAME + <span class="string">&quot;.&quot;</span> <span title="String(&quot;algorithmID.algorithm&quot;)">+</span> CertificateAlgorithmId.ALGORITHM, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.algo" title="sun.security.x509.AlgorithmId">algo</a><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.cert" title="sun.security.x509.X509CertImpl">cert</a> = <span title="(x$1: sun.security.x509.X509CertInfo)sun.security.x509.X509CertImpl" class="keyword">new</span> <span title="sun.security.x509.X509CertImpl">X509CertImpl</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.info" title="sun.security.x509.X509CertInfo">info</a><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.cert" title="sun.security.x509.X509CertImpl">cert</a>.<span title="(x$1: java.security.PrivateKey, x$2: String)Unit">sign</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.privkey" title="java.security.PrivateKey">privkey</a>, <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.algorithm" title="String">algorithm</a><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.CertificateGenerator.generateCertificate.cert" title="sun.security.x509.X509CertImpl">cert</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

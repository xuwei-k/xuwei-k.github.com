<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play-jdbc/play/api/db/Databases.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.api.db

<span class="keyword">import</span> java.sql.<span class="delimiter">{</span> Connection, Driver, DriverManager <span class="delimiter">}</span>
<span class="keyword">import</span> javax.sql.DataSource

<span class="keyword">import</span> play.utils.<span class="delimiter">{</span> ProxyDriver, Reflect <span class="delimiter">}</span>

<span class="keyword">import</span> com.typesafe.config.Config
<span class="keyword">import</span> play.api.inject.<span class="delimiter">{</span> NewInstanceInjector, Injector <span class="delimiter">}</span>
<span class="keyword">import</span> scala.util.control.<span class="delimiter">{</span> NonFatal, ControlThrowable <span class="delimiter">}</span>
<span class="keyword">import</span> play.api.<span class="delimiter">{</span> Environment, Configuration, Logger, PlayConfig <span class="delimiter">}</span>

<span class="comment">/**
 * Creation helpers for manually instantiating databases.
 */</span>
<span class="keyword">object</span> <a title="play.api.db.Databases.type" id="play.api.db.Databases">Databases</a> <a href="#play.api.db.Databases" title="play.api.db.Databases.type" class="delimiter">{</a>

  <span class="comment">/**
   * Create a pooled database named &quot;default&quot; with the given driver and url.
   *
   * @param driver the database driver class
   * @param url the database url
   * @param name the database name
   * @param config a map of extra database configuration
   * @return a configured database
   */</span>
  <span class="keyword">def</span> <a title="(driver: String, url: String, name: String, config: Map[String, _])play.api.db.Database" id="play.api.db.Databases.apply">apply</a><span class="delimiter">(</span><a title="String" id="play.api.db.Databases.apply.driver">driver</a>: <span title="String">String</span>, <a title="String" id="play.api.db.Databases.apply.url">url</a>: <span title="String">String</span>, <a title="String" id="play.api.db.Databases.apply$default$3">name</a>: <span title="String">String</span> = <span title="String(&quot;default&quot;)" class="string">&quot;default&quot;</span>, <a title="Map[String, _]" id="play.api.db.Databases.apply$default$4">config</a>: <span title="Map[String, _]">Map</span><span class="delimiter">[</span>String, _ &lt;: Any<span class="delimiter">]</span> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="scala.collection.immutable.Map[String,Nothing]">empty</span><span class="delimiter">)</span>: <a href="../../../../play-jdbc-api/play/api/db/Database.scala.html#play.api.db;Database" title="play.api.db.Database">Database</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="play.api.Configuration" id="play.api.db.Databases.apply.dbConfig">dbConfig</a> = <a href="../../../../play/play/api/Configuration.scala.html#play.api.Configuration" title="play.api.Configuration.type">Configuration</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api.Configuration.reference" title="=&gt; play.api.Configuration">reference</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration.getConfig" title="(path: String)Option[play.api.Configuration]">getConfig</a><span class="delimiter">(</span><span title="String(&quot;play.db.prototype&quot;)" class="string">&quot;play.db.prototype&quot;</span><span class="delimiter">)</span>.<span title="=&gt; play.api.Configuration">get</span> <a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration.++" title="(other: play.api.Configuration)play.api.Configuration">++</a>
      <a href="../../../../play/play/api/Configuration.scala.html#play.api.Configuration" title="play.api.Configuration.type">Configuration</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api.Configuration.from" title="(data: Map[String,Any])play.api.Configuration">from</a><span class="delimiter">(</span><span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><span class="delimiter">(</span><span title="(x: String)ArrowAssoc[String]" class="string">&quot;driver&quot;</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#play.api.db.Databases.apply.driver" title="String">driver</a>, <span title="(x: String)ArrowAssoc[String]" class="string">&quot;url&quot;</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#play.api.db.Databases.apply.url" title="String">url</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, Any)])scala.collection.immutable.Map[String,Any]">++</span> <a href="#play.api.db.Databases.apply$default$4" title="Map[String, _]">config</a><span class="delimiter">)</span>
    <a href="#play.api.db;PooledDatabase.<init>(8cdbe74101)" title="(name: String, configuration: play.api.Configuration)play.api.db.PooledDatabase" class="keyword">new</a> <a href="#play.api.db;PooledDatabase" title="play.api.db.PooledDatabase">PooledDatabase</a><span class="delimiter">(</span><a href="#play.api.db.Databases.apply$default$3" title="String">name</a>, <a href="#play.api.db.Databases.apply.dbConfig" title="play.api.Configuration">dbConfig</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Create an in-memory H2 database.
   *
   * @param name the database name (defaults to &quot;default&quot;)
   * @param urlOptions a map of extra url options
   * @param config a map of extra database configuration
   * @return a configured in-memory h2 database
   */</span>
  <span class="keyword">def</span> <a title="(name: String, urlOptions: Map[String,String], config: Map[String, _])play.api.db.Database" id="play.api.db.Databases.inMemory">inMemory</a><span class="delimiter">(</span><a title="String" id="play.api.db.Databases.inMemory$default$1">name</a>: <span title="String">String</span> = <span title="String(&quot;default&quot;)" class="string">&quot;default&quot;</span>, <a title="Map[String,String]" id="play.api.db.Databases.inMemory$default$2">urlOptions</a>: <span title="Map[String,String]">Map</span><span class="delimiter">[</span>String, String<span class="delimiter">]</span> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="scala.collection.immutable.Map[String,Nothing]">empty</span>, <a title="Map[String, _]" id="play.api.db.Databases.inMemory$default$3">config</a>: <span title="Map[String, _]">Map</span><span class="delimiter">[</span>String, _ &lt;: Any<span class="delimiter">]</span> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="scala.collection.immutable.Map[String,Nothing]">empty</span><span class="delimiter">)</span>: <a href="../../../../play-jdbc-api/play/api/db/Database.scala.html#play.api.db;Database" title="play.api.db.Database">Database</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="play.api.db.Databases.inMemory.driver">driver</a> = <span title="String(&quot;org.h2.Driver&quot;)" class="string">&quot;org.h2.Driver&quot;</span>
    <span class="keyword">val</span> <a title="String" id="play.api.db.Databases.inMemory.urlExtra">urlExtra</a> = <a href="#play.api.db.Databases.inMemory$default$2" title="Map[String,String]">urlOptions</a>.<span title="(f: ((String, String)) =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map[String,String],String,scala.collection.immutable.Iterable[String]])scala.collection.immutable.Iterable[String]">map</span> <a href="#play.api.db.Databases.inMemory.urlExtra.$anonfun.x0$1" title="String" class="delimiter">{</a> <span class="keyword">case</span> <span class="delimiter">(</span><a title="String" id="play.api.db.Databases.inMemory.urlExtra.$anonfun.k">k</a>, <a title="String" id="play.api.db.Databases.inMemory.urlExtra.$anonfun.v">v</a><span class="delimiter">)</span> =&gt; <a href="#play.api.db.Databases.inMemory.urlExtra.$anonfun.k" title="String">k</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;=&quot;)" class="string">&quot;=&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.db.Databases.inMemory.urlExtra.$anonfun.v" title="String">v</a> <span class="delimiter">}</span>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;;&quot;)" class="string">&quot;;&quot;</span>, <span title="String(&quot;;&quot;)" class="string">&quot;;&quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="String" id="play.api.db.Databases.inMemory.url">url</a> = <span title="String(&quot;jdbc:h2:mem:&quot;)" class="string">&quot;jdbc:h2:mem:&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.db.Databases.inMemory$default$1" title="String">name</a> <span title="(x$1: Any)String">+</span> <a href="#play.api.db.Databases.inMemory.urlExtra" title="String">urlExtra</a>
    <a href="#play.api.db.Databases.apply" title="(driver: String, url: String, name: String, config: Map[String, _])play.api.db.Database">Databases</a><span class="delimiter">(</span><a href="#play.api.db.Databases.inMemory.driver" title="String">driver</a>, <a href="#play.api.db.Databases.inMemory.url" title="String">url</a>, <a href="#play.api.db.Databases.inMemory$default$1" title="String">name</a>, <a href="#play.api.db.Databases.inMemory$default$3" title="Map[String, _]">config</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Run the given block with a database, cleaning up afterwards.
   *
   * @param driver the database driver class
   * @param url the database url
   * @param name the database name
   * @param config a map of extra database configuration
   * @param block The block of code to run
   * @return The result of the block
   */</span>
  <span class="keyword">def</span> <a title="[T](driver: String, url: String, name: String, config: Map[String, _])(block: play.api.db.Database =&gt; T)T" id="play.api.db.Databases.withDatabase">withDatabase</a><span class="delimiter">[</span><a title="" id="play.api.db.Databases.withDatabase$default$4;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="play.api.db.Databases.withDatabase.driver">driver</a>: <span title="String">String</span>, <a title="String" id="play.api.db.Databases.withDatabase.url">url</a>: <span title="String">String</span>, <a title="String" id="play.api.db.Databases.withDatabase$default$3">name</a>: <span title="String">String</span> = <span title="String(&quot;default&quot;)" class="string">&quot;default&quot;</span>,
    <a title="Map[String, _]" id="play.api.db.Databases.withDatabase$default$4">config</a>: <span title="Map[String, _]">Map</span><span class="delimiter">[</span>String, _ &lt;: Any<span class="delimiter">]</span> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="scala.collection.immutable.Map[String,Nothing]">empty</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="play.api.db.Database =&gt; T" id="play.api.db.Databases.withDatabase.block">block</a>: Database =&gt; T<span class="delimiter">)</span>: <a href="#play.api.db.Databases.withDatabase$default$4;T" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="play.api.db.Database" id="play.api.db.Databases.withDatabase.database">database</a> = <a href="#play.api.db.Databases.apply" title="(driver: String, url: String, name: String, config: Map[String, _])play.api.db.Database">Databases</a><span class="delimiter">(</span><a href="#play.api.db.Databases.withDatabase.driver" title="String">driver</a>, <a href="#play.api.db.Databases.withDatabase.url" title="String">url</a>, <a href="#play.api.db.Databases.withDatabase$default$3" title="String">name</a>, <a href="#play.api.db.Databases.withDatabase$default$4" title="Map[String, _]">config</a><span class="delimiter">)</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#play.api.db.Databases.withDatabase.block" title="(v1: play.api.db.Database)T">block</a><span class="delimiter">(</span><a href="#play.api.db.Databases.withDatabase.database" title="play.api.db.Database">database</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="#play.api.db.Databases.withDatabase.database" title="play.api.db.Database">database</a>.<a href="../../../../play-jdbc-api/play/api/db/Database.scala.html#play.api.db;Database.shutdown" title="()Unit">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Run the given block with an in-memory h2 database, cleaning up afterwards.
   *
   * @param name the database name (defaults to &quot;default&quot;)
   * @param urlOptions a map of extra url options
   * @param config a map of extra database configuration
   * @param block The block of code to run
   * @return The result of the block
   */</span>
  <span class="keyword">def</span> <a title="[T](name: String, urlOptions: Map[String,String], config: Map[String, _])(block: play.api.db.Database =&gt; T)T" id="play.api.db.Databases.withInMemory">withInMemory</a><span class="delimiter">[</span><a title="" id="play.api.db.Databases.withInMemory$default$3;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="play.api.db.Databases.withInMemory$default$1">name</a>: <span title="String">String</span> = <span title="String(&quot;default&quot;)" class="string">&quot;default&quot;</span>, <a title="Map[String,String]" id="play.api.db.Databases.withInMemory$default$2">urlOptions</a>: <span title="Map[String,String]">Map</span><span class="delimiter">[</span>String, String<span class="delimiter">]</span> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="scala.collection.immutable.Map[String,Nothing]">empty</span>,
    <a title="Map[String, _]" id="play.api.db.Databases.withInMemory$default$3">config</a>: <span title="Map[String, _]">Map</span><span class="delimiter">[</span>String, _ &lt;: Any<span class="delimiter">]</span> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="scala.collection.immutable.Map[String,Nothing]">empty</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="play.api.db.Database =&gt; T" id="play.api.db.Databases.withInMemory.block">block</a>: Database =&gt; T<span class="delimiter">)</span>: <a href="#play.api.db.Databases.withInMemory$default$3;T" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="play.api.db.Database" id="play.api.db.Databases.withInMemory.database">database</a> = <a href="#play.api.db.Databases.inMemory" title="(name: String, urlOptions: Map[String,String], config: Map[String, _])play.api.db.Database">inMemory</a><span class="delimiter">(</span><a href="#play.api.db.Databases.withInMemory$default$1" title="String">name</a>, <a href="#play.api.db.Databases.withInMemory$default$2" title="Map[String,String]">urlOptions</a>, <a href="#play.api.db.Databases.withInMemory$default$3" title="Map[String, _]">config</a><span class="delimiter">)</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#play.api.db.Databases.withInMemory.block" title="(v1: play.api.db.Database)T">block</a><span class="delimiter">(</span><a href="#play.api.db.Databases.withInMemory.database" title="play.api.db.Database">database</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="#play.api.db.Databases.withInMemory.database" title="play.api.db.Database">database</a>.<a href="../../../../play-jdbc-api/play/api/db/Database.scala.html#play.api.db;Database.shutdown" title="()Unit">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Default implementation of the database API.
 * Provides driver registration and connection methods.
 */</span>
<span title="AnyRef" class="keyword">abstract</span> <span class="keyword">class</span> <a title="class DefaultDatabase extends AnyRef with play.api.db.Database" id="play.api.db;DefaultDatabase">DefaultDatabase</a><a href="#play.api.db;DefaultDatabase" title="play.api.db.DefaultDatabase" class="delimiter">(</a><span class="keyword">val</span> <a title="String" id="play.api.db;DefaultDatabase.name">name</a>: <span title="String">String</span>, <a title="com.typesafe.config.Config" id="play.api.db;DefaultDatabase.configuration">configuration</a>: <span title="com.typesafe.config.Config">Config</span>, <a title="play.api.Environment" id="play.api.db;DefaultDatabase.environment">environment</a>: <a href="../../../../play/play/api/Environment.scala.html#play.api;Environment" title="play.api.Environment">Environment</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../../play-jdbc-api/play/api/db/Database.scala.html#play.api.db;Database" title="play.api.db.Database">Database</a> <span class="delimiter">{</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="play.api.PlayConfig" id="play.api.db;DefaultDatabase.config">config</a> = <a href="../../../../play/play/api/Configuration.scala.html#play.api.PlayConfig.apply(ea963b663d)" title="(underlying: com.typesafe.config.Config)play.api.PlayConfig">PlayConfig</a><span class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.configuration" title="com.typesafe.config.Config">configuration</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="play.api.db.DatabaseConfig" id="play.api.db;DefaultDatabase.databaseConfig">databaseConfig</a> = <a href="DatabaseConfig.scala.html#play.api.db.DatabaseConfig" title="play.api.db.DatabaseConfig.type">DatabaseConfig</a>.<a href="DatabaseConfig.scala.html#play.api.db.DatabaseConfig.fromConfig" title="(config: play.api.PlayConfig, environment: play.api.Environment)play.api.db.DatabaseConfig">fromConfig</a><span class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.config" title="=&gt; play.api.PlayConfig">config</a>, <a href="#play.api.db;DefaultDatabase.environment" title="play.api.Environment">environment</a><span class="delimiter">)</span>

  <span class="comment">// abstract methods to be implemented</span>

  <span class="keyword">def</span> <a title="()javax.sql.DataSource" id="play.api.db;DefaultDatabase.createDataSource">createDataSource</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="javax.sql.DataSource">DataSource</span>

  <span class="keyword">def</span> <a title="(dataSource: javax.sql.DataSource)Unit" id="play.api.db;DefaultDatabase.closeDataSource">closeDataSource</a><span class="delimiter">(</span><a title="javax.sql.DataSource" id="play.api.db;DefaultDatabase.closeDataSource.dataSource">dataSource</a>: <span title="javax.sql.DataSource">DataSource</span><span class="delimiter">)</span>: <span title="Unit">Unit</span>

  <span class="comment">// driver registration</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Option[java.sql.Driver]" id="play.api.db;DefaultDatabase.driver">driver</a>: <span title="Option[java.sql.Driver]">Option</span><span class="delimiter">[</span>Driver<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#play.api.db;DefaultDatabase.databaseConfig" title="=&gt; play.api.db.DatabaseConfig">databaseConfig</a>.<a href="DatabaseConfig.scala.html#play.api.db;DatabaseConfig.driver" title="=&gt; Option[String]">driver</a>.<span title="(f: String =&gt; java.sql.Driver)Option[java.sql.Driver]">map</span> <span class="delimiter">{</span> <a title="String" id="play.api.db;DefaultDatabase.driver.$anonfun.driverClassName">driverClassName</a> =&gt;
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="play.utils.ProxyDriver" id="play.api.db;DefaultDatabase.driver.$anonfun.proxyDriver">proxyDriver</a> = <span title="play.utils.ProxyDriver" class="keyword">new</span> <a href="../../../../play/play/utils/ProxyDriver.scala.html#play.utils;ProxyDriver" title="play.utils.ProxyDriver">ProxyDriver</a><span class="delimiter">(</span><a href="../../../../play/play/utils/Reflect.scala.html#play.utils.Reflect" title="play.utils.Reflect.type">Reflect</a>.<a href="../../../../play/play/utils/Reflect.scala.html#play.utils.Reflect.createInstance(34ab46fb7d)" title="[T](fqcn: String, classLoader: ClassLoader)(implicit evidence$2: scala.reflect.ClassTag[T])T">createInstance</a><span title="(fqcn: String, classLoader: ClassLoader)(implicit evidence$2: scala.reflect.ClassTag[java.sql.Driver])java.sql.Driver" class="delimiter">[</span><span title="java.sql.Driver">Driver</span><span class="delimiter">]</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[java.sql.Driver]" class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.driver.$anonfun.driverClassName" title="String">driverClassName</a>, <a href="#play.api.db;DefaultDatabase.environment" title="play.api.Environment">environment</a>.<a href="../../../../play/play/api/Environment.scala.html#play.api;Environment.classLoader" title="=&gt; ClassLoader">classLoader</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="java.sql.DriverManager.type">DriverManager</span>.<span title="(x$1: java.sql.Driver)Unit">registerDriver</span><span class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.driver.$anonfun.proxyDriver" title="play.utils.ProxyDriver">proxyDriver</a><span class="delimiter">)</span>
        <a href="#play.api.db;DefaultDatabase.driver.$anonfun.proxyDriver" title="play.utils.ProxyDriver">proxyDriver</a>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#play.api.db;DefaultDatabase.driver.$anonfun.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="play.api.db;DefaultDatabase.driver.$anonfun.e">e</a><span class="delimiter">)</span> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="#play.api.db;DefaultDatabase.config" title="=&gt; play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.reportError" title="(path: String, message: String, e: Option[Throwable])play.api.PlayException">reportError</a><span class="delimiter">(</span><span title="String(&quot;driver&quot;)" class="string">&quot;driver&quot;</span>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Driver not found: [&quot;)">Driver not found: [$</span><a href="#play.api.db;DefaultDatabase.driver.$anonfun.driverClassName" title="String">driverClassName</a><span title="String(&quot;}]&quot;)" class="string">}]&quot;</span>, <span title="(x: Throwable)Some[Throwable]">Some</span><span class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.driver.$anonfun.e" title="Throwable">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">// lazy data source creation</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="javax.sql.DataSource" id="play.api.db;DefaultDatabase.dataSource">dataSource</a>: <span title="javax.sql.DataSource">DataSource</span> = <span class="delimiter">{</span>
    <a href="#play.api.db;DefaultDatabase.driver" title="=&gt; Option[java.sql.Driver]">driver</a> <span class="comment">// trigger driver registration</span>
    <a href="#play.api.db;DefaultDatabase.createDataSource" title="()javax.sql.DataSource">createDataSource</a>
  <span class="delimiter">}</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="String" id="play.api.db;DefaultDatabase.url">url</a>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.sql.Connection" id="play.api.db;DefaultDatabase.url.connection">connection</a> = <a href="#play.api.db;DefaultDatabase.dataSource" title="=&gt; javax.sql.DataSource">dataSource</a>.<span title="()java.sql.Connection">getConnection</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#play.api.db;DefaultDatabase.url.connection" title="java.sql.Connection">connection</a>.<span title="()java.sql.DatabaseMetaData">getMetaData</span>.<span title="()String">getURL</span>
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="#play.api.db;DefaultDatabase.url.connection" title="java.sql.Connection">connection</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">// connection methods</span>

  <span class="keyword">def</span> <a title="()java.sql.Connection" id="play.api.db;DefaultDatabase.getConnection(00842c645a)">getConnection</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="java.sql.Connection">Connection</span> = <span class="delimiter">{</span>
    <a href="#play.api.db;DefaultDatabase.getConnection(e18b5a337c)" title="(autocommit: Boolean)java.sql.Connection">getConnection</a><span class="delimiter">(</span>autocommit = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(autocommit: Boolean)java.sql.Connection" id="play.api.db;DefaultDatabase.getConnection(e18b5a337c)">getConnection</a><span class="delimiter">(</span><a title="Boolean" id="play.api.db;DefaultDatabase.getConnection(e18b5a337c).autocommit">autocommit</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>: <span title="java.sql.Connection">Connection</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.sql.Connection" id="play.api.db;DefaultDatabase.getConnection(e18b5a337c).connection">connection</a> = <a href="#play.api.db;DefaultDatabase.dataSource" title="=&gt; javax.sql.DataSource">dataSource</a>.<span title="()java.sql.Connection">getConnection</span>
    <a href="#play.api.db;DefaultDatabase.getConnection(e18b5a337c).connection" title="java.sql.Connection">connection</a>.<span title="(x$1: Boolean)Unit">setAutoCommit</span><span class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.getConnection(e18b5a337c).autocommit" title="Boolean">autocommit</a><span class="delimiter">)</span>
    <a href="#play.api.db;DefaultDatabase.getConnection(e18b5a337c).connection" title="java.sql.Connection">connection</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[A](block: java.sql.Connection =&gt; A)A" id="play.api.db;DefaultDatabase.withConnection(dd77d57fca)">withConnection</a><span class="delimiter">[</span><a title="" id="play.api.db;DefaultDatabase.withConnection(dd77d57fca);A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="java.sql.Connection =&gt; A" id="play.api.db;DefaultDatabase.withConnection(dd77d57fca).block">block</a>: Connection =&gt; A<span class="delimiter">)</span>: <a href="#play.api.db;DefaultDatabase.withConnection(dd77d57fca);A" title="A">A</a> = <span class="delimiter">{</span>
    <a href="#play.api.db;DefaultDatabase.withConnection(a80597f033)" title="(autocommit: Boolean)(block: java.sql.Connection =&gt; A)A">withConnection</a><span class="delimiter">(</span>autocommit = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.withConnection(dd77d57fca).block" title="java.sql.Connection =&gt; A">block</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[A](autocommit: Boolean)(block: java.sql.Connection =&gt; A)A" id="play.api.db;DefaultDatabase.withConnection(a80597f033)">withConnection</a><span class="delimiter">[</span><a title="" id="play.api.db;DefaultDatabase.withConnection(a80597f033);A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Boolean" id="play.api.db;DefaultDatabase.withConnection(a80597f033).autocommit">autocommit</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.sql.Connection =&gt; A" id="play.api.db;DefaultDatabase.withConnection(a80597f033).block">block</a>: Connection =&gt; A<span class="delimiter">)</span>: <a href="#play.api.db;DefaultDatabase.withConnection(a80597f033);A" title="A">A</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.sql.Connection" id="play.api.db;DefaultDatabase.withConnection(a80597f033).connection">connection</a> = <a href="#play.api.db;DefaultDatabase.getConnection(e18b5a337c)" title="(autocommit: Boolean)java.sql.Connection">getConnection</a><span class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.withConnection(a80597f033).autocommit" title="Boolean">autocommit</a><span class="delimiter">)</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#play.api.db;DefaultDatabase.withConnection(a80597f033).block" title="(v1: java.sql.Connection)A">block</a><span class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.withConnection(a80597f033).connection" title="java.sql.Connection">connection</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="#play.api.db;DefaultDatabase.withConnection(a80597f033).connection" title="java.sql.Connection">connection</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[A](block: java.sql.Connection =&gt; A)A" id="play.api.db;DefaultDatabase.withTransaction">withTransaction</a><span class="delimiter">[</span><a title="" id="play.api.db;DefaultDatabase.withTransaction;A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="java.sql.Connection =&gt; A" id="play.api.db;DefaultDatabase.withTransaction.block">block</a>: Connection =&gt; A<span class="delimiter">)</span>: <a href="#play.api.db;DefaultDatabase.withTransaction;A" title="A">A</a> = <span class="delimiter">{</span>
    <a href="#play.api.db;DefaultDatabase.withConnection(a80597f033)" title="(autocommit: Boolean)(block: java.sql.Connection =&gt; A)A">withConnection</a><span class="delimiter">(</span>autocommit = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="java.sql.Connection" id="play.api.db;DefaultDatabase.withTransaction.$anonfun.connection">connection</a> =&gt;
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="A" id="play.api.db;DefaultDatabase.withTransaction.$anonfun.r">r</a> = <a href="#play.api.db;DefaultDatabase.withTransaction.block" title="(v1: java.sql.Connection)A">block</a><span class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.withTransaction.$anonfun.connection" title="java.sql.Connection">connection</a><span class="delimiter">)</span>
        <a href="#play.api.db;DefaultDatabase.withTransaction.$anonfun.connection" title="java.sql.Connection">connection</a>.<span title="()Unit">commit</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#play.api.db;DefaultDatabase.withTransaction.$anonfun.r" title="A">r</a>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="scala.util.control.ControlThrowable">e</span>: <span title="scala.util.control.ControlThrowable">ControlThrowable</span> =&gt;
          <a href="#play.api.db;DefaultDatabase.withTransaction.$anonfun.connection" title="java.sql.Connection">connection</a>.<span title="()Unit">commit</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="Nothing" class="keyword">throw</span> <span title="scala.util.control.ControlThrowable">e</span>
        <span class="keyword">case</span> <span title="Throwable">e</span>: <span title="Throwable">Throwable</span> =&gt;
          <a href="#play.api.db;DefaultDatabase.withTransaction.$anonfun.connection" title="java.sql.Connection">connection</a>.<span title="()Unit">rollback</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="Nothing" class="keyword">throw</span> <span title="Throwable">e</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">// shutdown</span>

  <span class="keyword">def</span> <a title="()Unit" id="play.api.db;DefaultDatabase.shutdown">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#play.api.db;DefaultDatabase.closeDataSource" title="(dataSource: javax.sql.DataSource)Unit">closeDataSource</a><span class="delimiter">(</span><a href="#play.api.db;DefaultDatabase.dataSource" title="=&gt; javax.sql.DataSource">dataSource</a><span class="delimiter">)</span>
    <a href="#play.api.db;DefaultDatabase.deregisterDriver" title="()Unit">deregisterDriver</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="play.api.db;DefaultDatabase.deregisterDriver">deregisterDriver</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#play.api.db;DefaultDatabase.driver" title="=&gt; Option[java.sql.Driver]">driver</a>.<span title="(f: java.sql.Driver =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><span title="java.sql.DriverManager.type">DriverManager</span>.<a href="#play.api.db;DefaultDatabase.deregisterDriver.$anonfun.x$1" title="(x$1: java.sql.Driver)Unit">deregisterDriver</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * Default implementation of the database API using a connection pool.
 */</span>
<span class="keyword">class</span> <a title="class PooledDatabase extends play.api.db.DefaultDatabase" id="play.api.db;PooledDatabase">PooledDatabase</a><a href="#play.api.db;PooledDatabase" title="play.api.db.PooledDatabase" class="delimiter">(</a><a title="String" id="play.api.db;PooledDatabase.name">name</a>: <span title="String">String</span>, <a title="com.typesafe.config.Config" id="play.api.db;PooledDatabase.configuration">configuration</a>: <span title="com.typesafe.config.Config">Config</span>, <a title="play.api.Environment" id="play.api.db;PooledDatabase.environment">environment</a>: <a href="../../../../play/play/api/Environment.scala.html#play.api;Environment" title="play.api.Environment">Environment</a>, <a title="play.api.db.ConnectionPool" id="play.api.db;PooledDatabase.pool">pool</a>: <a href="ConnectionPool.scala.html#play.api.db;ConnectionPool" title="play.api.db.ConnectionPool">ConnectionPool</a><span class="delimiter">)</span>
    <span class="keyword">extends</span> <a href="#play.api.db;DefaultDatabase" title="play.api.db.DefaultDatabase">DefaultDatabase</a><span class="delimiter">(</span><a href="#play.api.db;PooledDatabase.name" title="String">name</a>, <a href="#play.api.db;PooledDatabase.configuration" title="com.typesafe.config.Config">configuration</a>, <a href="#play.api.db;PooledDatabase.environment" title="play.api.Environment">environment</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(name: String, configuration: play.api.Configuration)play.api.db.PooledDatabase" id="play.api.db;PooledDatabase.<init>(8cdbe74101)" class="keyword">this</a><span class="delimiter">(</span><a title="String" id="play.api.db;PooledDatabase.<init>(8cdbe74101).name">name</a>: <span title="String">String</span>, <a title="play.api.Configuration" id="play.api.db;PooledDatabase.<init>(8cdbe74101).configuration">configuration</a>: <a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration" title="play.api.Configuration">Configuration</a><span class="delimiter">)</span> = <a href="#play.api.db;PooledDatabase" title="PooledDatabase.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#play.api.db;PooledDatabase.<init>(8cdbe74101).name" title="String">name</a>, <a href="#play.api.db;PooledDatabase.<init>(8cdbe74101).configuration" title="play.api.Configuration">configuration</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration.underlying" title="=&gt; com.typesafe.config.Config">underlying</a>, <a href="../../../../play/play/api/Environment.scala.html#play.api.Environment" title="play.api.Environment.type">Environment</a>.<a href="../../../../play/play/api/Environment.scala.html#play.api.Environment.simple" title="(path: java.io.File, mode: play.api.Mode.Mode)play.api.Environment">simple</a><span class="delimiter">(</span><span class="delimiter">)</span>, <span title="play.api.db.HikariCPConnectionPool" class="keyword">new</span> <a href="HikariCPModule.scala.html#play.api.db;HikariCPConnectionPool" title="play.api.db.HikariCPConnectionPool">HikariCPConnectionPool</a><span class="delimiter">(</span><a href="../../../../play/play/api/Environment.scala.html#play.api.Environment" title="play.api.Environment.type">Environment</a>.<a href="../../../../play/play/api/Environment.scala.html#play.api.Environment.simple" title="(path: java.io.File, mode: play.api.Mode.Mode)play.api.Environment">simple</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="()javax.sql.DataSource" id="play.api.db;PooledDatabase.createDataSource">createDataSource</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="javax.sql.DataSource">DataSource</span> = <a href="#play.api.db;PooledDatabase.pool" title="play.api.db.ConnectionPool">pool</a>.<a href="ConnectionPool.scala.html#play.api.db;ConnectionPool.create" title="(name: String, dbConfig: play.api.db.DatabaseConfig, configuration: com.typesafe.config.Config)javax.sql.DataSource">create</a><span class="delimiter">(</span><a href="#play.api.db;PooledDatabase.name" title="String">name</a>, <a href="#play.api.db;DefaultDatabase.databaseConfig" title="=&gt; play.api.db.DatabaseConfig">databaseConfig</a>, <a href="#play.api.db;PooledDatabase.configuration" title="com.typesafe.config.Config">configuration</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(dataSource: javax.sql.DataSource)Unit" id="play.api.db;PooledDatabase.closeDataSource">closeDataSource</a><span class="delimiter">(</span><a title="javax.sql.DataSource" id="play.api.db;PooledDatabase.closeDataSource.dataSource">dataSource</a>: <span title="javax.sql.DataSource">DataSource</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#play.api.db;PooledDatabase.pool" title="play.api.db.ConnectionPool">pool</a>.<a href="ConnectionPool.scala.html#play.api.db;ConnectionPool.close" title="(dataSource: javax.sql.DataSource)Unit">close</a><span class="delimiter">(</span><a href="#play.api.db;PooledDatabase.closeDataSource.dataSource" title="javax.sql.DataSource">dataSource</a><span class="delimiter">)</span>

<span class="delimiter">}</span>
        </pre>
    </body>
</html>

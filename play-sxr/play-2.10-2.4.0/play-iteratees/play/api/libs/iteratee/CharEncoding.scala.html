<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play-iteratees/play/api/libs/iteratee/CharEncoding.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> play.api.libs.iteratee

<span class="keyword">import</span> java.io.<span class="delimiter">{</span> ByteArrayOutputStream, StringWriter <span class="delimiter">}</span>
<span class="keyword">import</span> java.nio.<span class="delimiter">{</span> ByteBuffer, CharBuffer <span class="delimiter">}</span>
<span class="keyword">import</span> java.nio.charset._
<span class="keyword">import</span> play.api.libs.iteratee.<a href="Execution.scala.html#play.api.libs.iteratee.Execution" title="play.api.libs.iteratee.Execution.type">Execution</a>.defaultExecutionContext
<span class="keyword">import</span> scala.annotation.tailrec

<span class="comment">/**
 * [[Enumeratee]]s for converting chunks of bytes to chunks of chars, and vice-versa.
 *
 * These methods can handle cases where characters straddle a chunk boundary, and redistribute the data.
 * An erroneous encoding or an incompatible decoding causes a [[Step.Error]].
 */</span>
<span class="keyword">object</span> <a title="play.api.libs.iteratee.CharEncoding.type" id="play.api.libs.iteratee.CharEncoding">CharEncoding</a> <a href="#play.api.libs.iteratee.CharEncoding" title="play.api.libs.iteratee.CharEncoding.type" class="delimiter">{</a>

  <span class="keyword">private</span> <span class="keyword">trait</span> <a title="trait Coder[From, To] extends AnyRef with play.api.libs.iteratee.Enumeratee[From,To]" id="play.api.libs.iteratee.CharEncoding;Coder">Coder</a><span class="delimiter">[</span><a title="" id="play.api.libs.iteratee.CharEncoding;Coder;From">From</a>, <a title="" id="play.api.libs.iteratee.CharEncoding;Coder;To">To</a><span class="delimiter">]</span> <span title="Unit" class="keyword">extends</span> <a href="Enumeratee.scala.html#play.api.libs.iteratee;Enumeratee" title="play.api.libs.iteratee.Enumeratee[From,To]">Enumeratee</a><span class="delimiter">[</span>From, To<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">private</span> <span class="keyword">type</span> <a title="[A]play.api.libs.iteratee.Iteratee[To,A]" id="play.api.libs.iteratee.CharEncoding;Coder;Inner">Inner</a><span class="delimiter">[</span><a title="" id="play.api.libs.iteratee.CharEncoding;Coder;Inner;A">A</a><span class="delimiter">]</span> = <a href="Iteratee.scala.html#play.api.libs.iteratee;Iteratee" title="play.api.libs.iteratee.Iteratee[To,A]">Iteratee</a><span class="delimiter">[</span>To, A<span class="delimiter">]</span>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; From" id="play.api.libs.iteratee.CharEncoding;Coder.empty">empty</a>: <a href="#play.api.libs.iteratee.CharEncoding;Coder;From" title="From">From</a>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(data: From, last: Boolean)Either[java.nio.charset.CoderResult,(To, From)]" id="play.api.libs.iteratee.CharEncoding;Coder.code">code</a><span class="delimiter">(</span><a title="From" id="play.api.libs.iteratee.CharEncoding;Coder.code.data">data</a>: <a href="#play.api.libs.iteratee.CharEncoding;Coder;From" title="From">From</a>, <a title="Boolean" id="play.api.libs.iteratee.CharEncoding;Coder.code.last">last</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>: <span title="Either[java.nio.charset.CoderResult,(To, From)]">Either</span><span class="delimiter">[</span>CoderResult, <span class="delimiter">(</span>To, From<span class="delimiter">)</span><span class="delimiter">]</span>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(a: From, b: From)From" id="play.api.libs.iteratee.CharEncoding;Coder.concat">concat</a><span class="delimiter">(</span><a title="From" id="play.api.libs.iteratee.CharEncoding;Coder.concat.a">a</a>: <a href="#play.api.libs.iteratee.CharEncoding;Coder;From" title="From">From</a>, <a title="From" id="play.api.libs.iteratee.CharEncoding;Coder.concat.b">b</a>: <a href="#play.api.libs.iteratee.CharEncoding;Coder;From" title="From">From</a><span class="delimiter">)</span>: <a href="#play.api.libs.iteratee.CharEncoding;Coder;From" title="From">From</a>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="[A](initial: From)(it: Coder.this.Inner[A])play.api.libs.iteratee.Input[From] =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]" id="play.api.libs.iteratee.CharEncoding;Coder.step">step</a><span class="delimiter">[</span><a title="" id="play.api.libs.iteratee.CharEncoding;Coder.step$default$1;A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="From" id="play.api.libs.iteratee.CharEncoding;Coder.step$default$1">initial</a>: <a href="#play.api.libs.iteratee.CharEncoding;Coder;From" title="From">From</a> = <a href="#play.api.libs.iteratee.CharEncoding;Coder.empty" title="=&gt; From">empty</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="Coder.this.Inner[A]" id="play.api.libs.iteratee.CharEncoding;Coder.step.it">it</a>: <a href="Iteratee.scala.html#play.api.libs.iteratee;Iteratee" title="Coder.this.Inner[A]">Inner</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="play.api.libs.iteratee.Input[From] =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]">K</span><span class="delimiter">[</span>From, Inner<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.x0$1" title="play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="play.api.libs.iteratee.Input.El[From]">in</span> @ Input.El<span class="delimiter">(</span><a title="From" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.chars">chars</a><span class="delimiter">)</span> =&gt;
        <a href="#play.api.libs.iteratee.CharEncoding;Coder.step.it" title="Coder.this.Inner[A]">it</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee;Iteratee.pureFlatFold" title="[B, C](folder: play.api.libs.iteratee.Step[To,A] =&gt; play.api.libs.iteratee.Iteratee[B,C])(implicit ec: scala.concurrent.ExecutionContext)play.api.libs.iteratee.Iteratee[B,C]">pureFlatFold</a><span title="(folder: play.api.libs.iteratee.Step[To,A] =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]])(implicit ec: scala.concurrent.ExecutionContext)play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]" class="delimiter">[</span><a href="#play.api.libs.iteratee.CharEncoding;Coder;From" title="From">From</a>, <a href="Iteratee.scala.html#play.api.libs.iteratee;Iteratee" title="Coder.this.Inner[A]">Inner</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> <a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.x0$2" title="play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]" class="delimiter">{</a>
          <span class="keyword">case</span> Step.Cont<span class="delimiter">(</span><a title="play.api.libs.iteratee.Input[To] =&gt; play.api.libs.iteratee.Iteratee[To,A]" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.k">k</a><span class="delimiter">)</span> =&gt;
            <a href="#play.api.libs.iteratee.CharEncoding;Coder.code" title="(data: From, last: Boolean)Either[java.nio.charset.CoderResult,(To, From)]">code</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.concat" title="(a: From, b: From)From">concat</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step$default$1" title="From">initial</a>, <a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.chars" title="From">chars</a><span class="delimiter">)</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>.<span title="(fa: java.nio.charset.CoderResult =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]], fb: ((To, From)) =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]])play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]">fold</span><span class="delimiter">(</span><span class="delimiter">{</span> <a title="java.nio.charset.CoderResult" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.$anonfun.result">result</a> =&gt;
              <a href="Iteratee.scala.html#play.api.libs.iteratee.Error.apply" title="(msg: String, e: play.api.libs.iteratee.Input[From])play.api.libs.iteratee.Iteratee[From,Nothing]">Error</a><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;coding error: &quot;)">coding error: $</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.$anonfun.result" title="java.nio.charset.CoderResult">result</a><span title="String(&quot;&quot;)" class="string">&quot;</span>, <span title="play.api.libs.iteratee.Input.El[From]">in</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>, <a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.$anonfun.x0$3" title="play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]" class="delimiter">{</a>
              <span class="keyword">case</span> <span class="delimiter">(</span><a title="To" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.$anonfun.bytes">bytes</a>, <a title="From" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.$anonfun.remaining">remaining</a><span class="delimiter">)</span> =&gt;
                <span class="keyword">val</span> <a title="play.api.libs.iteratee.Iteratee[To,A]" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.$anonfun.newIt">newIt</a> = <a href="Iteratee.scala.html#play.api.libs.iteratee.Iteratee" title="play.api.libs.iteratee.Iteratee.type">Iteratee</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee.Iteratee.flatten" title="(i: scala.concurrent.Future[play.api.libs.iteratee.Iteratee[To,A]])play.api.libs.iteratee.Iteratee[To,A]">flatten</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.it" title="Coder.this.Inner[A]">it</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee;Iteratee.feed" title="(in: play.api.libs.iteratee.Input[To])scala.concurrent.Future[play.api.libs.iteratee.Iteratee[To,A]]">feed</a><span class="delimiter">(</span><a href="Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee.Input;El" title="(e: To)play.api.libs.iteratee.Input.El[To]">El</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.$anonfun.bytes" title="To">bytes</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="Iteratee.scala.html#play.api.libs.iteratee.Cont.apply" title="(k: play.api.libs.iteratee.Input[From] =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]])play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]">Cont</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step" title="(initial: From)(it: Coder.this.Inner[A])play.api.libs.iteratee.Input[From] =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]">step</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.$anonfun.remaining" title="From">remaining</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.$anonfun.newIt" title="play.api.libs.iteratee.Iteratee[To,A]">newIt</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span><span class="delimiter">)</span>
          <span class="keyword">case</span> _ =&gt; <a href="Iteratee.scala.html#play.api.libs.iteratee.Done.apply" title="(a: Coder.this.Inner[A], e: play.api.libs.iteratee.Input[From])play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]">Done</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.it" title="Coder.this.Inner[A]">it</a><span class="delimiter">)</span>
        <span class="delimiter">}</span><span class="delimiter">(</span><a href="Execution.scala.html#play.api.libs.iteratee.Execution.defaultExecutionContext" title="=&gt; scala.concurrent.ExecutionContext">defaultExecutionContext</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="play.api.libs.iteratee.Input.Empty.type">in</span> @ <a href="Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee.Input.Empty" title="play.api.libs.iteratee.Input.Empty.type">Empty</a> =&gt;
        <span class="keyword">val</span> <a title="play.api.libs.iteratee.Iteratee[To,A]" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.newIt">newIt</a> = <a href="Iteratee.scala.html#play.api.libs.iteratee.Iteratee" title="play.api.libs.iteratee.Iteratee.type">Iteratee</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee.Iteratee.flatten" title="(i: scala.concurrent.Future[play.api.libs.iteratee.Iteratee[To,A]])play.api.libs.iteratee.Iteratee[To,A]">flatten</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.it" title="Coder.this.Inner[A]">it</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee;Iteratee.feed" title="(in: play.api.libs.iteratee.Input[To])scala.concurrent.Future[play.api.libs.iteratee.Iteratee[To,A]]">feed</a><span class="delimiter">(</span><span title="play.api.libs.iteratee.Input.Empty.type">in</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="Iteratee.scala.html#play.api.libs.iteratee.Cont.apply" title="(k: play.api.libs.iteratee.Input[From] =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]])play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]">Cont</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step" title="(initial: From)(it: Coder.this.Inner[A])play.api.libs.iteratee.Input[From] =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]">step</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step$default$1" title="From">initial</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.newIt" title="play.api.libs.iteratee.Iteratee[To,A]">newIt</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="play.api.libs.iteratee.Input.EOF.type">in</span> @ <a href="Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee.Input.EOF" title="play.api.libs.iteratee.Input.EOF.type">EOF</a> =&gt;
        <a href="#play.api.libs.iteratee.CharEncoding;Coder.code" title="(data: From, last: Boolean)Either[java.nio.charset.CoderResult,(To, From)]">code</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step$default$1" title="From">initial</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>.<span title="(fa: java.nio.charset.CoderResult =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]], fb: ((To, From)) =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]])play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]">fold</span><span class="delimiter">(</span><span class="delimiter">{</span> <a title="java.nio.charset.CoderResult" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.result">result</a> =&gt;
          <a href="Iteratee.scala.html#play.api.libs.iteratee.Error.apply" title="(msg: String, e: play.api.libs.iteratee.Input[From])play.api.libs.iteratee.Iteratee[From,Nothing]">Error</a><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;coding error: &quot;)">coding error: $</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.result" title="java.nio.charset.CoderResult">result</a><span title="String(&quot;&quot;)" class="string">&quot;</span>, <span title="play.api.libs.iteratee.Input.EOF.type">in</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>, <a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.x0$4" title="play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]" class="delimiter">{</a>
          <span class="keyword">case</span> <span class="delimiter">(</span><a title="To" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.string">string</a>, <a title="From" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.remaining">remaining</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="play.api.libs.iteratee.Iteratee[To,A]" id="play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.newIt">newIt</a> = <a href="Iteratee.scala.html#play.api.libs.iteratee.Iteratee" title="play.api.libs.iteratee.Iteratee.type">Iteratee</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee.Iteratee.flatten" title="(i: scala.concurrent.Future[play.api.libs.iteratee.Iteratee[To,A]])play.api.libs.iteratee.Iteratee[To,A]">flatten</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.it" title="Coder.this.Inner[A]">it</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee;Iteratee.feed" title="(in: play.api.libs.iteratee.Input[To])scala.concurrent.Future[play.api.libs.iteratee.Iteratee[To,A]]">feed</a><span class="delimiter">(</span><a href="Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee.Input;El" title="(e: To)play.api.libs.iteratee.Input.El[To]">El</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.string" title="To">string</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: play.api.libs.iteratee.Iteratee[To,A] =&gt; scala.concurrent.Future[play.api.libs.iteratee.Iteratee[To,A]])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[play.api.libs.iteratee.Iteratee[To,A]]">flatMap</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.newIt.$anonfun.x$1" title="play.api.libs.iteratee.Iteratee[To,A]">_</a>.<a href="Iteratee.scala.html#play.api.libs.iteratee;Iteratee.feed" title="(in: play.api.libs.iteratee.Input[To])scala.concurrent.Future[play.api.libs.iteratee.Iteratee[To,A]]">feed</a><span class="delimiter">(</span><span title="play.api.libs.iteratee.Input.EOF.type">in</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="Execution.scala.html#play.api.libs.iteratee.Execution.defaultExecutionContext" title="=&gt; scala.concurrent.ExecutionContext">defaultExecutionContext</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="Iteratee.scala.html#play.api.libs.iteratee.Done.apply" title="(a: play.api.libs.iteratee.Iteratee[To,A], e: play.api.libs.iteratee.Input[From])play.api.libs.iteratee.Iteratee[From,play.api.libs.iteratee.Iteratee[To,A]]">Done</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step.$anonfun.$anonfun.newIt" title="play.api.libs.iteratee.Iteratee[To,A]">newIt</a><span class="delimiter">)</span>
        <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="[A](inner: Coder.this.Inner[A])play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]" id="play.api.libs.iteratee.CharEncoding;Coder.applyOn">applyOn</a><span class="delimiter">[</span><a title="" id="play.api.libs.iteratee.CharEncoding;Coder.applyOn;A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Coder.this.Inner[A]" id="play.api.libs.iteratee.CharEncoding;Coder.applyOn.inner">inner</a>: <a href="Iteratee.scala.html#play.api.libs.iteratee;Iteratee" title="Coder.this.Inner[A]">Inner</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="Iteratee.scala.html#play.api.libs.iteratee.Cont.apply" title="(k: play.api.libs.iteratee.Input[From] =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]])play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]">Cont</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.step" title="(initial: From)(it: Coder.this.Inner[A])play.api.libs.iteratee.Input[From] =&gt; play.api.libs.iteratee.Iteratee[From,Coder.this.Inner[A]]">step</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding;Coder.applyOn.inner" title="Coder.this.Inner[A]">inner</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(charset: java.nio.charset.Charset)play.api.libs.iteratee.Enumeratee[Array[Byte],String]" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0)">decode</a><span class="delimiter">(</span><a title="java.nio.charset.Charset" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0).charset">charset</a>: <span title="java.nio.charset.Charset">Charset</span><span class="delimiter">)</span>: <a href="Enumeratee.scala.html#play.api.libs.iteratee;Enumeratee" title="play.api.libs.iteratee.Enumeratee[Array[Byte],String]">Enumeratee</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, String<span class="delimiter">]</span> = <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon" title="play.api.libs.iteratee.CharEncoding.Coder[Array[Byte],String]{}" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.api.libs.iteratee.CharEncoding.Coder[Array[Byte],String]" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon">Coder</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, String<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Array[Byte]" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.empty">empty</a> = <span title="[T](xs: T*)(implicit evidence$2: scala.reflect.ClassTag[T])Array[T]">Array</span><span title="(xs: Byte*)(implicit evidence$2: scala.reflect.ClassTag[Byte])Array[Byte]" class="delimiter">[</span><span title="Byte">Byte</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.ClassTag[Byte]" class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(a: Array[Byte], b: Array[Byte])Array[Byte]" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.concat">concat</a><span class="delimiter">(</span><a title="Array[Byte]" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.concat.a">a</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Array[Byte]" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.concat.b">b</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.concat.a" title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">a</a> <span title="(that: scala.collection.GenTraversableOnce[Byte])(implicit bf: scala.collection.generic.CanBuildFrom[Array[Byte],Byte,Array[Byte]])Array[Byte]">++</span> <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.concat.b" title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">b</a>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(bytes: Array[Byte], last: Boolean)Either[java.nio.charset.CoderResult,(String, Array[Byte])]" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code">code</a><span class="delimiter">(</span><a title="Array[Byte]" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.bytes">bytes</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Boolean" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.last">last</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.nio.charset.CharsetDecoder" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.decoder">decoder</a> = <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0).charset" title="java.nio.charset.Charset">charset</a>.<span title="()java.nio.charset.CharsetDecoder">newDecoder</span>

      <span class="keyword">val</span> <a title="java.nio.ByteBuffer" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.byteBuffer">byteBuffer</a> = <span title="java.nio.ByteBuffer.type">ByteBuffer</span>.<span title="(x$1: Array[Byte])java.nio.ByteBuffer">wrap</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.bytes" title="Array[Byte]">bytes</a><span class="delimiter">)</span>
      <span class="comment">// at least 2, for UTF-32</span>
      <span class="keyword">val</span> <a title="java.nio.CharBuffer" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.charBuffer">charBuffer</a> = <span title="java.nio.CharBuffer.type">CharBuffer</span>.<span title="(x$1: Int)java.nio.CharBuffer">allocate</span><span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">2</span> <span title="(that: Int)Int">max</span> math.<span title="(x: Double)Double">ceil</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.bytes" title="Array[Byte]">bytes</a>.<span title="=&gt; Int">length</span> <span title="=&gt; Double">*</span> <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.decoder" title="java.nio.charset.CharsetDecoder">decoder</a>.<span title="()Float">averageCharsPerByte</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="java.io.StringWriter" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.out">out</a> = <span title="java.io.StringWriter" class="keyword">new</span> <span title="java.io.StringWriter">StringWriter</span>

      @tailrec
      <span class="keyword">def</span> <a title="(charBuffer: java.nio.CharBuffer)java.nio.charset.CoderResult" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process">process</a><span class="delimiter">(</span><a title="java.nio.CharBuffer" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.charBuffer">charBuffer</a>: <span title="java.nio.CharBuffer">CharBuffer</span><span class="delimiter">)</span>: <span title="java.nio.charset.CoderResult">CoderResult</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="java.nio.charset.CoderResult" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.result">result</a> = <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.decoder" title="java.nio.charset.CharsetDecoder">decoder</a>.<span title="(x$1: java.nio.ByteBuffer, x$2: java.nio.CharBuffer, x$3: Boolean)java.nio.charset.CoderResult">decode</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.byteBuffer" title="java.nio.ByteBuffer">byteBuffer</a>, <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.charBuffer" title="java.nio.CharBuffer">charBuffer</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
        <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.out" title="java.io.StringWriter">out</a>.<span title="(x$1: Array[Char], x$2: Int, x$3: Int)Unit">write</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.charBuffer" title="java.nio.CharBuffer">charBuffer</a>.<span title="()Array[Char]">array</span>, <span title="Int(0)" class="int">0</span>, <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.charBuffer" title="java.nio.CharBuffer">charBuffer</a>.<span title="()Int">position</span><span class="delimiter">)</span>
        <span title="java.nio.charset.CoderResult" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.result" title="java.nio.charset.CoderResult">result</a>.<span title="()Boolean">isOverflow</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="java.nio.charset.CoderResult" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.charBuffer" title="java.nio.CharBuffer">charBuffer</a>.<span title="()Int">position</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="comment">// shouldn't happen for most encodings</span>
            <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process" title="(charBuffer: java.nio.CharBuffer)java.nio.charset.CoderResult">process</a><span class="delimiter">(</span><span title="java.nio.CharBuffer.type">CharBuffer</span>.<span title="(x$1: Int)java.nio.CharBuffer">allocate</span><span class="delimiter">(</span><span title="Int(2)" class="int">2</span> <span title="(x: Int)Int">*</span> <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.charBuffer" title="java.nio.CharBuffer">charBuffer</a>.<span title="()Int">capacity</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.charBuffer" title="java.nio.CharBuffer">charBuffer</a>.<span title="()java.nio.Buffer">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
            <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process" title="(charBuffer: java.nio.CharBuffer)java.nio.charset.CoderResult">process</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.charBuffer" title="java.nio.CharBuffer">charBuffer</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process.result" title="java.nio.charset.CoderResult">result</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="java.nio.charset.CoderResult" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.result">result</a> = <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.process" title="(charBuffer: java.nio.CharBuffer)java.nio.charset.CoderResult">process</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.charBuffer" title="java.nio.CharBuffer">charBuffer</a><span class="delimiter">)</span>

      <span title="Either[java.nio.charset.CoderResult,(String, Array[Byte])]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.result" title="java.nio.charset.CoderResult">result</a>.<span title="()Boolean">isUnmappable</span> <span title="(x: Boolean)Boolean">||</span> <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.last" title="Boolean">last</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.result" title="java.nio.charset.CoderResult">result</a>.<span title="()Boolean">isMalformed</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="(a: java.nio.charset.CoderResult)scala.util.Left[java.nio.charset.CoderResult,Nothing]">Left</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.result" title="java.nio.charset.CoderResult">result</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Array[Byte]" id="play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.remaining">remaining</a> = <span title="Array[Byte]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.result" title="java.nio.charset.CoderResult">result</a>.<span title="()Boolean">isError</span><span class="delimiter">)</span> <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.bytes" title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">bytes</a>.<span title="(n: Int)Array[Byte]">drop</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.byteBuffer" title="java.nio.ByteBuffer">byteBuffer</a>.<span title="()Int">position</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.empty" title="=&gt; Array[Byte]">empty</a>
        <span title="(b: (String, Array[Byte]))scala.util.Right[Nothing,(String, Array[Byte])]">Right</span><span class="delimiter">(</span><span title="(_1: String, _2: Array[Byte])(String, Array[Byte])" class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.out" title="java.io.StringWriter">out</a>.<span title="()String">toString</span>, <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0);$anon.code.remaining" title="Array[Byte]">remaining</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * @throws UnsupportedCharsetException
   */</span>
  <span class="keyword">def</span> <a title="(charset: String)play.api.libs.iteratee.Enumeratee[Array[Byte],String]" id="play.api.libs.iteratee.CharEncoding.decode(7d652f2871)">decode</a><span class="delimiter">(</span><a title="String" id="play.api.libs.iteratee.CharEncoding.decode(7d652f2871).charset">charset</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="Enumeratee.scala.html#play.api.libs.iteratee;Enumeratee" title="play.api.libs.iteratee.Enumeratee[Array[Byte],String]">Enumeratee</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, String<span class="delimiter">]</span> = <a href="#play.api.libs.iteratee.CharEncoding.decode(6a69415fe0)" title="(charset: java.nio.charset.Charset)play.api.libs.iteratee.Enumeratee[Array[Byte],String]">decode</a><span class="delimiter">(</span><span title="java.nio.charset.Charset.type">Charset</span>.<span title="(x$1: String)java.nio.charset.Charset">forName</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.decode(7d652f2871).charset" title="String">charset</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(charset: java.nio.charset.Charset)play.api.libs.iteratee.Enumeratee[String,Array[Byte]]" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e)">encode</a><span class="delimiter">(</span><a title="java.nio.charset.Charset" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e).charset">charset</a>: <span title="java.nio.charset.Charset">Charset</span><span class="delimiter">)</span>: <a href="Enumeratee.scala.html#play.api.libs.iteratee;Enumeratee" title="play.api.libs.iteratee.Enumeratee[String,Array[Byte]]">Enumeratee</a><span class="delimiter">[</span>String, Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon" title="play.api.libs.iteratee.CharEncoding.Coder[String,Array[Byte]]" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.api.libs.iteratee.CharEncoding.Coder[String,Array[Byte]]" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon">Coder</a><span class="delimiter">[</span>String, Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; String" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.empty">empty</a> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(a: String, b: String)String" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.concat">concat</a><span class="delimiter">(</span><a title="String" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.concat.a">a</a>: <span title="String">String</span>, <a title="String" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.concat.b">b</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.concat.a" title="String">a</a> <span title="(x$1: Any)String">+</span> <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.concat.b" title="String">b</a>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(chars: String, last: Boolean)Either[java.nio.charset.CoderResult,(Array[Byte], String)]" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code">code</a><span class="delimiter">(</span><a title="String" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.chars">chars</a>: <span title="String">String</span>, <a title="Boolean" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.last">last</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.nio.charset.CharsetEncoder" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.encoder">encoder</a> = <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e).charset" title="java.nio.charset.Charset">charset</a>.<span title="()java.nio.charset.CharsetEncoder">newEncoder</span>

      <span class="keyword">val</span> <a title="java.nio.CharBuffer" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.charBuffer">charBuffer</a> = <span title="java.nio.CharBuffer.type">CharBuffer</span>.<span title="(x$1: CharSequence)java.nio.CharBuffer">wrap</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.chars" title="String">chars</a><span class="delimiter">)</span>
      <span class="comment">// at least 6, for UTF-8</span>
      <span class="keyword">val</span> <a title="java.nio.ByteBuffer" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.byteBuffer">byteBuffer</a> = <span title="java.nio.ByteBuffer.type">ByteBuffer</span>.<span title="(x$1: Int)java.nio.ByteBuffer">allocate</span><span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">6</span> <span title="(that: Int)Int">max</span> math.<span title="(x: Double)Double">ceil</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.chars" title="String">chars</a>.<span title="()Int">length</span> <span title="=&gt; Double">*</span> <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.encoder" title="java.nio.charset.CharsetEncoder">encoder</a>.<span title="()Float">averageBytesPerChar</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="java.io.ByteArrayOutputStream" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.out">out</a> = <span title="java.io.ByteArrayOutputStream" class="keyword">new</span> <span title="java.io.ByteArrayOutputStream">ByteArrayOutputStream</span>
      @tailrec
      <span class="keyword">def</span> <a title="(byteBuffer: java.nio.ByteBuffer)java.nio.charset.CoderResult" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process">process</a><span class="delimiter">(</span><a title="java.nio.ByteBuffer" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.byteBuffer">byteBuffer</a>: <span title="java.nio.ByteBuffer">ByteBuffer</span><span class="delimiter">)</span>: <span title="java.nio.charset.CoderResult">CoderResult</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="java.nio.charset.CoderResult" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.result">result</a> = <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.encoder" title="java.nio.charset.CharsetEncoder">encoder</a>.<span title="(x$1: java.nio.CharBuffer, x$2: java.nio.ByteBuffer, x$3: Boolean)java.nio.charset.CoderResult">encode</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.charBuffer" title="java.nio.CharBuffer">charBuffer</a>, <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.byteBuffer" title="java.nio.ByteBuffer">byteBuffer</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
        <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.out" title="java.io.ByteArrayOutputStream">out</a>.<span title="(x$1: Array[Byte], x$2: Int, x$3: Int)Unit">write</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.byteBuffer" title="java.nio.ByteBuffer">byteBuffer</a>.<span title="()Array[Byte]">array</span>, <span title="Int(0)" class="int">0</span>, <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.byteBuffer" title="java.nio.ByteBuffer">byteBuffer</a>.<span title="()Int">position</span><span class="delimiter">)</span>
        <span title="java.nio.charset.CoderResult" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.result" title="java.nio.charset.CoderResult">result</a>.<span title="()Boolean">isOverflow</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="java.nio.charset.CoderResult" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.byteBuffer" title="java.nio.ByteBuffer">byteBuffer</a>.<span title="()Int">position</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="comment">// shouldn't happen for most encodings</span>
            <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process" title="(byteBuffer: java.nio.ByteBuffer)java.nio.charset.CoderResult">process</a><span class="delimiter">(</span><span title="java.nio.ByteBuffer.type">ByteBuffer</span>.<span title="(x$1: Int)java.nio.ByteBuffer">allocate</span><span class="delimiter">(</span><span title="Int(2)" class="int">2</span> <span title="(x: Int)Int">*</span> <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.byteBuffer" title="java.nio.ByteBuffer">byteBuffer</a>.<span title="()Int">capacity</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.byteBuffer" title="java.nio.ByteBuffer">byteBuffer</a>.<span title="()java.nio.Buffer">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
            <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process" title="(byteBuffer: java.nio.ByteBuffer)java.nio.charset.CoderResult">process</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.byteBuffer" title="java.nio.ByteBuffer">byteBuffer</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process.result" title="java.nio.charset.CoderResult">result</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="java.nio.charset.CoderResult" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.result">result</a> = <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.process" title="(byteBuffer: java.nio.ByteBuffer)java.nio.charset.CoderResult">process</a><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.byteBuffer" title="java.nio.ByteBuffer">byteBuffer</a><span class="delimiter">)</span>
      <span title="Either[java.nio.charset.CoderResult,(Array[Byte], String)]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.result" title="java.nio.charset.CoderResult">result</a>.<span title="()Boolean">isUnmappable</span> <span title="(x: Boolean)Boolean">||</span> <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.last" title="Boolean">last</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.result" title="java.nio.charset.CoderResult">result</a>.<span title="()Boolean">isMalformed</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="(a: java.nio.charset.CoderResult)scala.util.Left[java.nio.charset.CoderResult,Nothing]">Left</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.result" title="java.nio.charset.CoderResult">result</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="String" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.remaining">remaining</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.result" title="java.nio.charset.CoderResult">result</a>.<span title="()Boolean">isError</span><span class="delimiter">)</span> <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.chars" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">chars</a>.<span title="(n: Int)String">drop</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.charBuffer" title="java.nio.CharBuffer">charBuffer</a>.<span title="()Int">position</span><span class="delimiter">)</span> <span class="keyword">else</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
        <span class="keyword">val</span> <a title="Array[Byte]" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.bytes">bytes</a> = <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.out" title="java.io.ByteArrayOutputStream">out</a>.<span title="()Array[Byte]">toByteArray</span>
        <span class="keyword">val</span> <a title="Array[Byte]" id="play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.bytesWithoutBom">bytesWithoutBom</a> = <span title="Array[Byte]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e).charset" title="java.nio.charset.Charset">charset</a>.<span title="()String">name</span>.<span title="(x$1: String)Boolean">startsWith</span><span class="delimiter">(</span><span title="String(&quot;UTF-&quot;)" class="string">&quot;UTF-&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.bytes" title="Array[Byte]">bytes</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(2)" class="int">2</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.bytes" title="(i: Int)Byte">bytes</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="(x: Byte)Boolean">==</span> <span title="Int(254)" class="int">0xfe</span>.<span title="=&gt; Byte">toByte</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.bytes" title="(i: Int)Byte">bytes</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: Byte)Boolean">==</span> <span title="Int(255)" class="int">0xff</span>.<span title="=&gt; Byte">toByte</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.bytes" title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">bytes</a>.<span title="(n: Int)Array[Byte]">drop</span><span class="delimiter">(</span><span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.bytes" title="Array[Byte]">bytes</a>
        <span class="delimiter">}</span>
        <span title="(b: (Array[Byte], String))scala.util.Right[Nothing,(Array[Byte], String)]">Right</span><span class="delimiter">(</span><span title="(_1: Array[Byte], _2: String)(Array[Byte], String)" class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.bytesWithoutBom" title="Array[Byte]">bytesWithoutBom</a>, <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e);$anon.code.remaining" title="String">remaining</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="comment">/**
   * @throws UnsupportedCharsetException
   */</span>
  <span class="keyword">def</span> <a title="(charset: String)play.api.libs.iteratee.Enumeratee[String,Array[Byte]]" id="play.api.libs.iteratee.CharEncoding.encode(83d179651a)">encode</a><span class="delimiter">(</span><a title="String" id="play.api.libs.iteratee.CharEncoding.encode(83d179651a).charset">charset</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="Enumeratee.scala.html#play.api.libs.iteratee;Enumeratee" title="play.api.libs.iteratee.Enumeratee[String,Array[Byte]]">Enumeratee</a><span class="delimiter">[</span>String, Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#play.api.libs.iteratee.CharEncoding.encode(f3edad6d3e)" title="(charset: java.nio.charset.Charset)play.api.libs.iteratee.Enumeratee[String,Array[Byte]]">encode</a><span class="delimiter">(</span><span title="java.nio.charset.Charset.type">Charset</span>.<span title="(x$1: String)java.nio.charset.Charset">forName</span><span class="delimiter">(</span><a href="#play.api.libs.iteratee.CharEncoding.encode(83d179651a).charset" title="String">charset</a><span class="delimiter">)</span><span class="delimiter">)</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>

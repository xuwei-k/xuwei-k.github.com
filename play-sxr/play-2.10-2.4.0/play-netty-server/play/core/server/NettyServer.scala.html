<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play-netty-server/play/core/server/NettyServer.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.core.server

<span class="keyword">import</span> com.typesafe.config.ConfigFactory
<span class="keyword">import</span> com.typesafe.netty.http.pipelining.HttpPipeliningHandler
<span class="keyword">import</span> java.net.InetSocketAddress
<span class="keyword">import</span> java.util.concurrent.Executors
<span class="keyword">import</span> org.jboss.netty.bootstrap._
<span class="keyword">import</span> org.jboss.netty.channel._
<span class="keyword">import</span> org.jboss.netty.channel.<span title="org.jboss.netty.channel.Channels.type">Channels</span>._
<span class="keyword">import</span> org.jboss.netty.channel.group._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http._
<span class="keyword">import</span> org.jboss.netty.handler.logging.LoggingHandler
<span class="keyword">import</span> org.jboss.netty.handler.ssl._
<span class="keyword">import</span> org.jboss.netty.logging.InternalLogLevel
<span class="keyword">import</span> play.api._
<span class="keyword">import</span> play.api.mvc.<span class="delimiter">{</span> RequestHeader, Handler <span class="delimiter">}</span>
<span class="keyword">import</span> play.api.routing.Router
<span class="keyword">import</span> play.core._
<span class="keyword">import</span> play.core.server.netty._
<span class="keyword">import</span> play.core.server.ssl.ServerSSLEngine
<span class="keyword">import</span> play.server.SSLEngineProvider
<span class="keyword">import</span> scala.concurrent.<span class="delimiter">{</span> Await, Future <span class="delimiter">}</span>
<span class="keyword">import</span> scala.concurrent.duration.Duration
<span class="keyword">import</span> scala.util.Success
<span class="keyword">import</span> scala.util.control.NonFatal

<span class="comment">/**
 * creates a Server implementation based Netty
 */</span>
<span class="keyword">class</span> <a title="class NettyServer extends Object with play.core.server.Server" id="play.core.server;NettyServer">NettyServer</a><a href="#play.core.server;NettyServer" title="play.core.server.NettyServer" class="delimiter">(</a>
    <a title="play.core.server.ServerConfig" id="play.core.server;NettyServer.config">config</a>: <a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig" title="play.core.server.ServerConfig">ServerConfig</a>,
    <span class="keyword">val</span> <a title="play.core.ApplicationProvider" id="play.core.server;NettyServer.applicationProvider">applicationProvider</a>: <a href="../../../../play/play/core/ApplicationProvider.scala.html#play.core;ApplicationProvider" title="play.core.ApplicationProvider">ApplicationProvider</a>,
    <a title="() =&gt; scala.concurrent.Future[Unit]" id="play.core.server;NettyServer.stopHook">stopHook</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Future<span class="delimiter">[</span>Unit<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../../play-server/play/core/server/Server.scala.html#play.core.server;Server" title="play.core.server.Server">Server</a> <span class="delimiter">{</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="com.typesafe.config.Config" id="play.core.server;NettyServer.nettyConfig">nettyConfig</a> = <a href="#play.core.server;NettyServer.config" title="play.core.server.ServerConfig">config</a>.<a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig.configuration" title="=&gt; play.api.Configuration">configuration</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration.underlying" title="=&gt; com.typesafe.config.Config">underlying</a>.<span title="(x$1: String)com.typesafe.config.Config">getConfig</span><span class="delimiter">(</span><span title="String(&quot;play.server.netty&quot;)" class="string">&quot;play.server.netty&quot;</span><span class="delimiter">)</span>

  <span class="keyword">import</span> <a href="#play.core.server.NettyServer" title="play.core.server.NettyServer.type">NettyServer</a>._

  <span class="keyword">def</span> <a title="=&gt; play.api.Mode.Mode" id="play.core.server;NettyServer.mode">mode</a> = <a href="#play.core.server;NettyServer.config" title="play.core.server.ServerConfig">config</a>.<a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig.mode" title="=&gt; play.api.Mode.Mode">mode</a>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; org.jboss.netty.bootstrap.ServerBootstrap" id="play.core.server;NettyServer.newBootstrap">newBootstrap</a>: <span title="org.jboss.netty.bootstrap.ServerBootstrap">ServerBootstrap</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.jboss.netty.bootstrap.ServerBootstrap" id="play.core.server;NettyServer.newBootstrap.serverBootstrap">serverBootstrap</a> = <span title="(x$1: org.jboss.netty.channel.ChannelFactory)org.jboss.netty.bootstrap.ServerBootstrap" class="keyword">new</span> <span title="org.jboss.netty.bootstrap.ServerBootstrap">ServerBootstrap</span><span class="delimiter">(</span>
      <span title="(x$1: java.util.concurrent.Executor, x$2: java.util.concurrent.Executor)org.jboss.netty.channel.socket.nio.NioServerSocketChannelFactory" class="keyword">new</span> org.jboss.netty.channel.socket.nio.<span title="org.jboss.netty.channel.socket.nio.NioServerSocketChannelFactory">NioServerSocketChannelFactory</span><span class="delimiter">(</span>
        <span title="java.util.concurrent.Executors.type">Executors</span>.<span title="(x$1: java.util.concurrent.ThreadFactory)java.util.concurrent.ExecutorService">newCachedThreadPool</span><span class="delimiter">(</span><a href="../../../../play/play/core/system/NamedThreadFactory.scala.html#play.core;NamedThreadFactory" title="(name: String)play.core.NamedThreadFactory">NamedThreadFactory</a><span class="delimiter">(</span><span title="String(&quot;netty-boss&quot;)" class="string">&quot;netty-boss&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>,
        <span title="java.util.concurrent.Executors.type">Executors</span>.<span title="(x$1: java.util.concurrent.ThreadFactory)java.util.concurrent.ExecutorService">newCachedThreadPool</span><span class="delimiter">(</span><a href="../../../../play/play/core/system/NamedThreadFactory.scala.html#play.core;NamedThreadFactory" title="(name: String)play.core.NamedThreadFactory">NamedThreadFactory</a><span class="delimiter">(</span><span title="String(&quot;netty-worker&quot;)" class="string">&quot;netty-worker&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">import</span> scala.collection.<span title="scala.collection.JavaConversions.type">JavaConversions</span>._
    <span class="comment">// Find all properties that start with http.netty.option</span>

    <span class="keyword">val</span> <a title="com.typesafe.config.Config" id="play.core.server;NettyServer.newBootstrap.options">options</a> = <a href="#play.core.server;NettyServer.nettyConfig" title="=&gt; com.typesafe.config.Config">nettyConfig</a>.<span title="(x$1: String)com.typesafe.config.Config">getConfig</span><span class="delimiter">(</span><span title="String(&quot;option&quot;)" class="string">&quot;option&quot;</span><span class="delimiter">)</span>

    <span class="keyword">object</span> <a title="ExtractInt.type" id="play.core.server;NettyServer.newBootstrap.ExtractInt">ExtractInt</a> <a href="#play.core.server;NettyServer.newBootstrap;ExtractInt" title="ExtractInt.type" class="delimiter">{</a>
      <span class="keyword">def</span> <a title="(s: String)Option[Int]" id="play.core.server;NettyServer.newBootstrap;ExtractInt.unapply">unapply</a><span class="delimiter">(</span><a title="String" id="play.core.server;NettyServer.newBootstrap;ExtractInt.unapply.s">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="keyword">try</span> <span class="delimiter">{</span>
        <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.newBootstrap;ExtractInt.unapply.s" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="NumberFormatException" id="play.core.server;NettyServer.newBootstrap;ExtractInt.unapply.e">e</a>: <span title="NumberFormatException">NumberFormatException</span> =&gt; <span title="None.type">None</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <a href="#play.core.server;NettyServer.newBootstrap.options" title="com.typesafe.config.Config">options</a>.<span title="()java.util.Set[java.util.Map.Entry[String,com.typesafe.config.ConfigValue]]">entrySet</span><span title="(s: java.util.Set[java.util.Map.Entry[String,com.typesafe.config.ConfigValue]])scala.collection.mutable.Set[java.util.Map.Entry[String,com.typesafe.config.ConfigValue]]" class="delimiter">(</span><span class="delimiter">)</span>.<span title="(f: java.util.Map.Entry[String,com.typesafe.config.ConfigValue] =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="java.util.Map.Entry[String,com.typesafe.config.ConfigValue]" id="play.core.server;NettyServer.newBootstrap.$anonfun.entry">entry</a> =&gt;
      <span class="keyword">val</span> <a title="Any" id="play.core.server;NettyServer.newBootstrap.$anonfun.value">value</a> = <a href="#play.core.server;NettyServer.newBootstrap.$anonfun.entry" title="java.util.Map.Entry[String,com.typesafe.config.ConfigValue]">entry</a>.<span title="()com.typesafe.config.ConfigValue">getValue</span>.<span title="()Object">unwrapped</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Boolean" id="play.core.server;NettyServer.newBootstrap.$anonfun.value.bool">bool</a>: java.lang.<span title="Boolean">Boolean</span> =&gt; <a href="#play.core.server;NettyServer.newBootstrap.$anonfun.value.bool" title="Boolean">bool</a>
        <span class="keyword">case</span> <span title="Number">number</span>: <span title="Number">Number</span> =&gt; <span title="Number">number</span>
        <span class="keyword">case</span> <span title="Null(null)" class="keyword">null</span> =&gt; <span title="Null(null)" class="keyword">null</span>
        <span class="keyword">case</span> <span title="String(&quot;true&quot;)" class="string">&quot;true&quot;</span> | <span title="String(&quot;yes&quot;)" class="string">&quot;yes&quot;</span> =&gt; <span title="Boolean(true)" class="keyword">true</span>
        <span class="keyword">case</span> <span title="String(&quot;false&quot;)" class="string">&quot;false&quot;</span> | <span title="String(&quot;no&quot;)" class="string">&quot;no&quot;</span> =&gt; <span title="Boolean(false)" class="keyword">false</span>
        <span class="keyword">case</span> <a href="#play.core.server;NettyServer.newBootstrap;ExtractInt.unapply" title="(s: String)Option[Int]">ExtractInt</a><span class="delimiter">(</span><span title="Int">number</span><span class="delimiter">)</span> =&gt; <span title="Int">number</span>
        <span class="keyword">case</span> <a title="String" id="play.core.server;NettyServer.newBootstrap.$anonfun.value.string">string</a>: <span title="String">String</span> =&gt; <a href="#play.core.server;NettyServer.newBootstrap.$anonfun.value.string" title="String">string</a>
        <span class="keyword">case</span> <a title="Object" id="play.core.server;NettyServer.newBootstrap.$anonfun.value.other">other</a> =&gt; <a href="#play.core.server;NettyServer.newBootstrap.$anonfun.value.other" title="Object">other</a>.<span title="()String">toString</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="String" id="play.core.server;NettyServer.newBootstrap.$anonfun.name">name</a> = <a href="#play.core.server;NettyServer.newBootstrap.$anonfun.entry" title="java.util.Map.Entry[String,com.typesafe.config.ConfigValue]">entry</a>.<span title="()String">getKey</span>

      <a href="#play.core.server;NettyServer.newBootstrap.serverBootstrap" title="org.jboss.netty.bootstrap.ServerBootstrap">serverBootstrap</a>.<span title="(x$1: String, x$2: Any)Unit">setOption</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.newBootstrap.$anonfun.name" title="String">name</a>, <a href="#play.core.server;NettyServer.newBootstrap.$anonfun.value" title="Any">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="#play.core.server;NettyServer.newBootstrap.serverBootstrap" title="org.jboss.netty.bootstrap.ServerBootstrap">serverBootstrap</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class PlayPipelineFactory extends Object with org.jboss.netty.channel.ChannelPipelineFactory" id="play.core.server;NettyServer.PlayPipelineFactory">PlayPipelineFactory</a><a href="#play.core.server;NettyServer.PlayPipelineFactory" title="NettyServer.this.PlayPipelineFactory" class="delimiter">(</a><a title="Boolean" id="play.core.server;NettyServer.PlayPipelineFactory.<init>$default$1">secure</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="org.jboss.netty.channel.ChannelPipelineFactory">ChannelPipelineFactory</span> <span class="delimiter">{</span>

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="play.api.Logger" id="play.core.server;NettyServer;PlayPipelineFactory.logger">logger</a> = <a href="../../../../play/play/api/Logger.scala.html#play.api.Logger.apply(1f619881c1)" title="(clazz: Class[NettyServer.this.PlayPipelineFactory])play.api.Logger">Logger</a><span class="delimiter">(</span>classOf<span title="Class[NettyServer.this.PlayPipelineFactory](classOf[play.core.server.NettyServer$PlayPipelineFactory])" class="delimiter">[</span>PlayPipelineFactory<span class="delimiter">]</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="()org.jboss.netty.channel.ChannelPipeline" id="play.core.server;NettyServer;PlayPipelineFactory.getPipeline">getPipeline</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="org.jboss.netty.channel.ChannelPipeline" id="play.core.server;NettyServer;PlayPipelineFactory.getPipeline.newPipeline">newPipeline</a> = <span title="()org.jboss.netty.channel.ChannelPipeline">pipeline</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.core.server;NettyServer.PlayPipelineFactory.<init>$default$1" title="Boolean">secure</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#play.core.server;NettyServer;PlayPipelineFactory.sslEngineProvider" title="=&gt; Option[play.server.SSLEngineProvider]">sslEngineProvider</a>.<span title="(f: play.server.SSLEngineProvider =&gt; Unit)Option[Unit]">map</span> <span class="delimiter">{</span> <a title="play.server.SSLEngineProvider" id="play.core.server;NettyServer;PlayPipelineFactory.getPipeline.$anonfun.sslEngineProvider">sslEngineProvider</a> =&gt;
          <span class="keyword">val</span> <a title="javax.net.ssl.SSLEngine" id="play.core.server;NettyServer;PlayPipelineFactory.getPipeline.$anonfun.sslEngine">sslEngine</a> = <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.$anonfun.sslEngineProvider" title="play.server.SSLEngineProvider">sslEngineProvider</a>.<a href="../../../../play/play/server/SSLEngineProvider.java.html#play.server;SSLEngineProvider.createSSLEngine" title="()javax.net.ssl.SSLEngine">createSSLEngine</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.$anonfun.sslEngine" title="javax.net.ssl.SSLEngine">sslEngine</a>.<span title="(x$1: Boolean)Unit">setUseClientMode</span><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
          <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.newPipeline" title="org.jboss.netty.channel.ChannelPipeline">newPipeline</a>.<span title="(x$1: String, x$2: org.jboss.netty.channel.ChannelHandler)Unit">addLast</span><span class="delimiter">(</span><span title="String(&quot;ssl&quot;)" class="string">&quot;ssl&quot;</span>, <span title="org.jboss.netty.handler.ssl.SslHandler" class="keyword">new</span> <span title="org.jboss.netty.handler.ssl.SslHandler">SslHandler</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.$anonfun.sslEngine" title="javax.net.ssl.SSLEngine">sslEngine</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="Int" id="play.core.server;NettyServer;PlayPipelineFactory.getPipeline.maxInitialLineLength">maxInitialLineLength</a> = <a href="#play.core.server;NettyServer.nettyConfig" title="=&gt; com.typesafe.config.Config">nettyConfig</a>.<span title="(x$1: String)Int">getInt</span><span class="delimiter">(</span><span title="String(&quot;maxInitialLineLength&quot;)" class="string">&quot;maxInitialLineLength&quot;</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Int" id="play.core.server;NettyServer;PlayPipelineFactory.getPipeline.maxHeaderSize">maxHeaderSize</a> = <a href="#play.core.server;NettyServer.nettyConfig" title="=&gt; com.typesafe.config.Config">nettyConfig</a>.<span title="(x$1: String)Int">getInt</span><span class="delimiter">(</span><span title="String(&quot;maxHeaderSize&quot;)" class="string">&quot;maxHeaderSize&quot;</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Int" id="play.core.server;NettyServer;PlayPipelineFactory.getPipeline.maxChunkSize">maxChunkSize</a> = <a href="#play.core.server;NettyServer.nettyConfig" title="=&gt; com.typesafe.config.Config">nettyConfig</a>.<span title="(x$1: String)Int">getInt</span><span class="delimiter">(</span><span title="String(&quot;maxChunkSize&quot;)" class="string">&quot;maxChunkSize&quot;</span><span class="delimiter">)</span>
      <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.newPipeline" title="org.jboss.netty.channel.ChannelPipeline">newPipeline</a>.<span title="(x$1: String, x$2: org.jboss.netty.channel.ChannelHandler)Unit">addLast</span><span class="delimiter">(</span><span title="String(&quot;decoder&quot;)" class="string">&quot;decoder&quot;</span>, <span title="(x$1: Int, x$2: Int, x$3: Int)org.jboss.netty.handler.codec.http.HttpRequestDecoder" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.HttpRequestDecoder">HttpRequestDecoder</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.maxInitialLineLength" title="Int">maxInitialLineLength</a>, <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.maxHeaderSize" title="Int">maxHeaderSize</a>, <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.maxChunkSize" title="Int">maxChunkSize</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.newPipeline" title="org.jboss.netty.channel.ChannelPipeline">newPipeline</a>.<span title="(x$1: String, x$2: org.jboss.netty.channel.ChannelHandler)Unit">addLast</span><span class="delimiter">(</span><span title="String(&quot;encoder&quot;)" class="string">&quot;encoder&quot;</span>, <span title="org.jboss.netty.handler.codec.http.HttpResponseEncoder" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.HttpResponseEncoder">HttpResponseEncoder</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.newPipeline" title="org.jboss.netty.channel.ChannelPipeline">newPipeline</a>.<span title="(x$1: String, x$2: org.jboss.netty.channel.ChannelHandler)Unit">addLast</span><span class="delimiter">(</span><span title="String(&quot;decompressor&quot;)" class="string">&quot;decompressor&quot;</span>, <span title="org.jboss.netty.handler.codec.http.HttpContentDecompressor" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.HttpContentDecompressor">HttpContentDecompressor</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Boolean" id="play.core.server;NettyServer;PlayPipelineFactory.getPipeline.logWire">logWire</a> = <a href="#play.core.server;NettyServer.nettyConfig" title="=&gt; com.typesafe.config.Config">nettyConfig</a>.<span title="(x$1: String)Boolean">getBoolean</span><span class="delimiter">(</span><span title="String(&quot;log.wire&quot;)" class="string">&quot;log.wire&quot;</span><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.logWire" title="Boolean">logWire</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.newPipeline" title="org.jboss.netty.channel.ChannelPipeline">newPipeline</a>.<span title="(x$1: String, x$2: org.jboss.netty.channel.ChannelHandler)Unit">addLast</span><span class="delimiter">(</span><span title="String(&quot;logging&quot;)" class="string">&quot;logging&quot;</span>, <span title="(x$1: org.jboss.netty.logging.InternalLogLevel)org.jboss.netty.handler.logging.LoggingHandler" class="keyword">new</span> <span title="org.jboss.netty.handler.logging.LoggingHandler">LoggingHandler</span><span class="delimiter">(</span>InternalLogLevel.<span title="org.jboss.netty.logging.InternalLogLevel(DEBUG)">DEBUG</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.newPipeline" title="org.jboss.netty.channel.ChannelPipeline">newPipeline</a>.<span title="(x$1: String, x$2: org.jboss.netty.channel.ChannelHandler)Unit">addLast</span><span class="delimiter">(</span><span title="String(&quot;http-pipelining&quot;)" class="string">&quot;http-pipelining&quot;</span>, <span title="com.typesafe.netty.http.pipelining.HttpPipeliningHandler" class="keyword">new</span> <span title="com.typesafe.netty.http.pipelining.HttpPipeliningHandler">HttpPipeliningHandler</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.newPipeline" title="org.jboss.netty.channel.ChannelPipeline">newPipeline</a>.<span title="(x$1: String, x$2: org.jboss.netty.channel.ChannelHandler)Unit">addLast</span><span class="delimiter">(</span><span title="String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <a href="#play.core.server;NettyServer.defaultUpStreamHandler" title="=&gt; play.core.server.netty.PlayDefaultUpstreamHandler">defaultUpStreamHandler</a><span class="delimiter">)</span>
      <a href="#play.core.server;NettyServer;PlayPipelineFactory.getPipeline.newPipeline" title="org.jboss.netty.channel.ChannelPipeline">newPipeline</a>
    <span class="delimiter">}</span>

    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Option[play.server.SSLEngineProvider]" id="play.core.server;NettyServer;PlayPipelineFactory.sslEngineProvider">sslEngineProvider</a>: <span title="Option[play.server.SSLEngineProvider]">Option</span><span class="delimiter">[</span>SSLEngineProvider<span class="delimiter">]</span> = <span class="comment">//the sslContext should be reused on each connection</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span title="(x: play.server.SSLEngineProvider)Some[play.server.SSLEngineProvider]">Some</span><span class="delimiter">(</span><a href="../../../../play-server/play/core/server/ssl/ServerSSLEngine.scala.html#play.core.server.ssl.ServerSSLEngine" title="play.core.server.ssl.ServerSSLEngine.type">ServerSSLEngine</a>.<a href="../../../../play-server/play/core/server/ssl/ServerSSLEngine.scala.html#play.core.server.ssl.ServerSSLEngine.createSSLEngineProvider" title="(serverConfig: play.core.server.ServerConfig, applicationProvider: play.core.ApplicationProvider)play.server.SSLEngineProvider">createSSLEngineProvider</a><span class="delimiter">(</span><a href="#play.core.server;NettyServer.config" title="play.core.server.ServerConfig">config</a>, <a href="#play.core.server;NettyServer.applicationProvider" title="=&gt; play.core.ApplicationProvider">applicationProvider</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#play.core.server;NettyServer;PlayPipelineFactory.sslEngineProvider.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="play.core.server;NettyServer;PlayPipelineFactory.sslEngineProvider.e">e</a><span class="delimiter">)</span> =&gt;
          <a href="#play.core.server;NettyServer;PlayPipelineFactory.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.error(804ef4765b)" title="(message: =&gt; String, error: =&gt; Throwable)Unit">error</a><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;cannot load SSL context&quot;)" class="string">cannot load SSL context&quot;</span>, <a href="#play.core.server;NettyServer;PlayPipelineFactory.sslEngineProvider.e" title="Throwable">e</a><span class="delimiter">)</span>
          <span title="None.type">None</span>
      <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="comment">// Keep a reference on all opened channels (useful to close everything properly, especially in DEV mode)</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="org.jboss.netty.channel.group.DefaultChannelGroup" id="play.core.server;NettyServer.allChannels">allChannels</a> = <span title="org.jboss.netty.channel.group.DefaultChannelGroup" class="keyword">new</span> <span title="org.jboss.netty.channel.group.DefaultChannelGroup">DefaultChannelGroup</span>

  <span class="comment">// Our upStream handler is stateless. Let's use this instance for every new connection</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="play.core.server.netty.PlayDefaultUpstreamHandler" id="play.core.server;NettyServer.defaultUpStreamHandler">defaultUpStreamHandler</a> = <span title="play.core.server.netty.PlayDefaultUpstreamHandler" class="keyword">new</span> <a href="netty/PlayDefaultUpstreamHandler.scala.html#play.core.server.netty;PlayDefaultUpstreamHandler" title="play.core.server.netty.PlayDefaultUpstreamHandler">PlayDefaultUpstreamHandler</a><span class="delimiter">(</span><a href="#play.core.server;NettyServer" title="play.core.server.NettyServer" class="keyword">this</a>, <a href="#play.core.server;NettyServer.allChannels" title="=&gt; org.jboss.netty.channel.group.DefaultChannelGroup">allChannels</a><span class="delimiter">)</span>

  <span class="comment">// The HTTP server channel</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]" id="play.core.server;NettyServer.httpChannel">httpChannel</a> = <a href="#play.core.server;NettyServer.config" title="play.core.server.ServerConfig">config</a>.<a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig.port" title="=&gt; Option[Int]">port</a>.<span title="(f: Int =&gt; (org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel))Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">map</span> <span class="delimiter">{</span> <a title="Int" id="play.core.server;NettyServer.httpChannel.$anonfun.port">port</a> =&gt;
    <span class="keyword">val</span> <a title="org.jboss.netty.bootstrap.ServerBootstrap" id="play.core.server;NettyServer.httpChannel.$anonfun.bootstrap">bootstrap</a> = <a href="#play.core.server;NettyServer.newBootstrap" title="=&gt; org.jboss.netty.bootstrap.ServerBootstrap">newBootstrap</a>
    <a href="#play.core.server;NettyServer.httpChannel.$anonfun.bootstrap" title="org.jboss.netty.bootstrap.ServerBootstrap">bootstrap</a>.<span title="(x$1: org.jboss.netty.channel.ChannelPipelineFactory)Unit">setPipelineFactory</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.PlayPipelineFactory.<init>$default$1" title="NettyServer.this.PlayPipelineFactory" class="keyword">new</a> <a href="#play.core.server;NettyServer.PlayPipelineFactory" title="NettyServer.this.PlayPipelineFactory">PlayPipelineFactory</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="org.jboss.netty.channel.Channel" id="play.core.server;NettyServer.httpChannel.$anonfun.channel">channel</a> = <a href="#play.core.server;NettyServer.httpChannel.$anonfun.bootstrap" title="org.jboss.netty.bootstrap.ServerBootstrap">bootstrap</a>.<span title="(x$1: java.net.SocketAddress)org.jboss.netty.channel.Channel">bind</span><span class="delimiter">(</span><span title="(x$1: String, x$2: Int)java.net.InetSocketAddress" class="keyword">new</span> <span title="java.net.InetSocketAddress">InetSocketAddress</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.config" title="play.core.server.ServerConfig">config</a>.<a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig.address" title="=&gt; String">address</a>, <a href="#play.core.server;NettyServer.httpChannel.$anonfun.port" title="Int">port</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#play.core.server;NettyServer.allChannels" title="=&gt; org.jboss.netty.channel.group.DefaultChannelGroup">allChannels</a>.<span title="(x$1: org.jboss.netty.channel.Channel)Boolean">add</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.httpChannel.$anonfun.channel" title="org.jboss.netty.channel.Channel">channel</a><span class="delimiter">)</span>
    <span title="(_1: org.jboss.netty.bootstrap.ServerBootstrap, _2: org.jboss.netty.channel.Channel)(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)" class="delimiter">(</span><a href="#play.core.server;NettyServer.httpChannel.$anonfun.bootstrap" title="org.jboss.netty.bootstrap.ServerBootstrap">bootstrap</a>, <a href="#play.core.server;NettyServer.httpChannel.$anonfun.channel" title="org.jboss.netty.channel.Channel">channel</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">// Maybe the HTTPS server channel</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]" id="play.core.server;NettyServer.httpsChannel">httpsChannel</a> = <a href="#play.core.server;NettyServer.config" title="play.core.server.ServerConfig">config</a>.<a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig.sslPort" title="=&gt; Option[Int]">sslPort</a>.<span title="(f: Int =&gt; (org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel))Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">map</span> <span class="delimiter">{</span> <a title="Int" id="play.core.server;NettyServer.httpsChannel.$anonfun.port">port</a> =&gt;
    <span class="keyword">val</span> <a title="org.jboss.netty.bootstrap.ServerBootstrap" id="play.core.server;NettyServer.httpsChannel.$anonfun.bootstrap">bootstrap</a> = <a href="#play.core.server;NettyServer.newBootstrap" title="=&gt; org.jboss.netty.bootstrap.ServerBootstrap">newBootstrap</a>
    <a href="#play.core.server;NettyServer.httpsChannel.$anonfun.bootstrap" title="org.jboss.netty.bootstrap.ServerBootstrap">bootstrap</a>.<span title="(x$1: org.jboss.netty.channel.ChannelPipelineFactory)Unit">setPipelineFactory</span><span class="delimiter">(</span><span title="NettyServer.this.PlayPipelineFactory" class="keyword">new</span> <a href="#play.core.server;NettyServer.PlayPipelineFactory" title="NettyServer.this.PlayPipelineFactory">PlayPipelineFactory</a><span class="delimiter">(</span>secure = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="org.jboss.netty.channel.Channel" id="play.core.server;NettyServer.httpsChannel.$anonfun.channel">channel</a> = <a href="#play.core.server;NettyServer.httpsChannel.$anonfun.bootstrap" title="org.jboss.netty.bootstrap.ServerBootstrap">bootstrap</a>.<span title="(x$1: java.net.SocketAddress)org.jboss.netty.channel.Channel">bind</span><span class="delimiter">(</span><span title="(x$1: String, x$2: Int)java.net.InetSocketAddress" class="keyword">new</span> <span title="java.net.InetSocketAddress">InetSocketAddress</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.config" title="play.core.server.ServerConfig">config</a>.<a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig.address" title="=&gt; String">address</a>, <a href="#play.core.server;NettyServer.httpsChannel.$anonfun.port" title="Int">port</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#play.core.server;NettyServer.allChannels" title="=&gt; org.jboss.netty.channel.group.DefaultChannelGroup">allChannels</a>.<span title="(x$1: org.jboss.netty.channel.Channel)Boolean">add</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.httpsChannel.$anonfun.channel" title="org.jboss.netty.channel.Channel">channel</a><span class="delimiter">)</span>
    <span title="(_1: org.jboss.netty.bootstrap.ServerBootstrap, _2: org.jboss.netty.channel.Channel)(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)" class="delimiter">(</span><a href="#play.core.server;NettyServer.httpsChannel.$anonfun.bootstrap" title="org.jboss.netty.bootstrap.ServerBootstrap">bootstrap</a>, <a href="#play.core.server;NettyServer.httpsChannel.$anonfun.channel" title="org.jboss.netty.channel.Channel">channel</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <a href="#play.core.server;NettyServer.mode" title="=&gt; play.api.Mode.Mode">mode</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="../../../../play/play/api/Play.scala.html#play.api.Mode" title="play.api.Mode.type">Mode</a>.<a href="../../../../play/play/api/Play.scala.html#play.api.Mode.Test" title="=&gt; play.api.Mode.Value">Test</a> =&gt;
    <span class="keyword">case</span> _ =&gt;
      <a href="#play.core.server;NettyServer.httpChannel" title="=&gt; Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">httpChannel</a>.<span title="(f: ((org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)) =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)" id="play.core.server;NettyServer.<local NettyServer>.$anonfun.http">http</a> =&gt;
        <a href="#play.core.server.NettyServer.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.info(83d3728a3c)" title="(message: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Listening for HTTP on %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.<local NettyServer>.$anonfun.http" title="(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)">http</a>.<span title="=&gt; org.jboss.netty.channel.Channel">_2</span>.<span title="()java.net.SocketAddress">getLocalAddress</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#play.core.server;NettyServer.httpsChannel" title="=&gt; Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">httpsChannel</a>.<span title="(f: ((org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)) =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)" id="play.core.server;NettyServer.<local NettyServer>.$anonfun.https">https</a> =&gt;
        <a href="#play.core.server.NettyServer.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.info(83d3728a3c)" title="(message: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Listening for HTTPS on port %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.<local NettyServer>.$anonfun.https" title="(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)">https</a>.<span title="=&gt; org.jboss.netty.channel.Channel">_2</span>.<span title="()java.net.SocketAddress">getLocalAddress</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="play.core.server;NettyServer.stop">stop</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>

    <a href="#play.core.server;NettyServer.applicationProvider" title="=&gt; play.core.ApplicationProvider">applicationProvider</a>.<a href="../../../../play/play/core/ApplicationProvider.scala.html#play.core;ApplicationProvider.current" title="=&gt; Option[play.api.Application]">current</a>.<span title="(f: play.api.Application =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="../../../../play/play/api/Play.scala.html#play.api.Play" title="play.api.Play.type">Play</a>.<a href="../../../../play/play/api/Play.scala.html#play.api.Play.stop" title="(app: play.api.Application)Unit">stop</a><span class="delimiter">)</span>

    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#play.core.server;NettyServer" title="play.core.server.NettyServer" class="keyword">super</a>.<a href="../../../../play-server/play/core/server/Server.scala.html#play.core.server;Server.stop" title="()Unit">stop</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#play.core.server;NettyServer.stop.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="play.core.server;NettyServer.stop.e">e</a><span class="delimiter">)</span> =&gt; <a href="#play.core.server.NettyServer.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.error(804ef4765b)" title="(message: =&gt; String, error: =&gt; Throwable)Unit">error</a><span class="delimiter">(</span><span title="String(&quot;Error while stopping logger&quot;)" class="string">&quot;Error while stopping logger&quot;</span>, <a href="#play.core.server;NettyServer.stop.e" title="Throwable">e</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="#play.core.server;NettyServer.mode" title="=&gt; play.api.Mode.Mode">mode</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="../../../../play/play/api/Play.scala.html#play.api.Mode" title="play.api.Mode.type">Mode</a>.<a href="../../../../play/play/api/Play.scala.html#play.api.Mode.Test" title="=&gt; play.api.Mode.Value">Test</a> =&gt;
      <span class="keyword">case</span> _ =&gt; <a href="#play.core.server.NettyServer.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.info(83d3728a3c)" title="(message: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="String(&quot;Stopping server...&quot;)" class="string">&quot;Stopping server...&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">// First, close all opened sockets</span>
    <a href="#play.core.server;NettyServer.allChannels" title="=&gt; org.jboss.netty.channel.group.DefaultChannelGroup">allChannels</a>.<span title="()org.jboss.netty.channel.group.ChannelGroupFuture">close</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()org.jboss.netty.channel.group.ChannelGroupFuture">awaitUninterruptibly</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">// Release the HTTP server</span>
    <a href="#play.core.server;NettyServer.httpChannel" title="=&gt; Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">httpChannel</a>.<span title="(f: ((org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)) =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.stop.$anonfun.x$1" title="(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)">_</a>.<span title="=&gt; org.jboss.netty.bootstrap.ServerBootstrap">_1</span>.<span title="()Unit">releaseExternalResources</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="comment">// Release the HTTPS server if needed</span>
    <a href="#play.core.server;NettyServer.httpsChannel" title="=&gt; Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">httpsChannel</a>.<span title="(f: ((org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)) =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.stop.$anonfun.x$2" title="(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)">_</a>.<span title="=&gt; org.jboss.netty.bootstrap.ServerBootstrap">_1</span>.<span title="()Unit">releaseExternalResources</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="comment">// Call provided hook</span>
    <span class="comment">// Do this last because the hooks were created before the server,</span>
    <span class="comment">// so the server might need them to run until the last moment.</span>
    <span title="scala.concurrent.Await.type">Await</span>.<span title="(awaitable: scala.concurrent.Awaitable[Unit], atMost: scala.concurrent.duration.Duration)Unit">result</span><span class="delimiter">(</span><a href="#play.core.server;NettyServer.stopHook" title="()scala.concurrent.Future[Unit]">stopHook</a><span class="delimiter">(</span><span class="delimiter">)</span>, <span title="scala.concurrent.duration.Duration.type">Duration</span>.<span title="=&gt; scala.concurrent.duration.Duration.Infinite">Inf</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.net.InetSocketAddress" id="play.core.server;NettyServer.mainAddress">mainAddress</a> = <span class="delimiter">{</span>
    <span class="delimiter">(</span><a href="#play.core.server;NettyServer.httpChannel" title="=&gt; Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">httpChannel</a> <span title="(alternative: =&gt; Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)])Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">orElse</span> <a href="#play.core.server;NettyServer.httpsChannel" title="=&gt; Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">httpsChannel</a><span class="delimiter">)</span>.<span title="=&gt; (org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)">get</span>.<span title="=&gt; org.jboss.netty.channel.Channel">_2</span>.<span title="()java.net.SocketAddress">getLocalAddress</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.net.InetSocketAddress" class="delimiter">[</span><span title="java.net.InetSocketAddress">InetSocketAddress</span><span class="delimiter">]</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Option[Int]" id="play.core.server;NettyServer.httpPort">httpPort</a> = <a href="#play.core.server;NettyServer.httpChannel" title="=&gt; Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">httpChannel</a> <span title="(f: ((org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)) =&gt; Int)Option[Int]">map</span> <span class="delimiter">(</span><a href="#play.core.server;NettyServer.httpPort.$anonfun.x$3" title="(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)">_</a>.<span title="=&gt; org.jboss.netty.channel.Channel">_2</span>.<span title="()java.net.SocketAddress">getLocalAddress</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.net.InetSocketAddress" class="delimiter">[</span><span title="java.net.InetSocketAddress">InetSocketAddress</span><span class="delimiter">]</span>.<span title="()Int">getPort</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; Option[Int]" id="play.core.server;NettyServer.httpsPort">httpsPort</a> = <a href="#play.core.server;NettyServer.httpsChannel" title="=&gt; Option[(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)]">httpsChannel</a> <span title="(f: ((org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)) =&gt; Int)Option[Int]">map</span> <span class="delimiter">(</span><a href="#play.core.server;NettyServer.httpsPort.$anonfun.x$4" title="(org.jboss.netty.bootstrap.ServerBootstrap, org.jboss.netty.channel.Channel)">_</a>.<span title="=&gt; org.jboss.netty.channel.Channel">_2</span>.<span title="()java.net.SocketAddress">getLocalAddress</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.net.InetSocketAddress" class="delimiter">[</span><span title="java.net.InetSocketAddress">InetSocketAddress</span><span class="delimiter">]</span>.<span title="()Int">getPort</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * The Netty server provider
 */</span>
<span class="keyword">class</span> <a title="class NettyServerProvider extends AnyRef with play.core.server.ServerProvider" id="play.core.server;NettyServerProvider">NettyServerProvider</a> <a href="#play.core.server;NettyServerProvider" title="play.core.server.NettyServerProvider" class="keyword">extends</a> <a href="../../../../play-server/play/core/server/ServerProvider.scala.html#play.core.server;ServerProvider" title="play.core.server.ServerProvider">ServerProvider</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(context: play.core.server.ServerProvider.Context)play.core.server.NettyServer" id="play.core.server;NettyServerProvider.createServer(ab76451d84)">createServer</a><span class="delimiter">(</span><a title="play.core.server.ServerProvider.Context" id="play.core.server;NettyServerProvider.createServer(ab76451d84).context">context</a>: ServerProvider.<a href="../../../../play-server/play/core/server/ServerProvider.scala.html#play.core.server.ServerProvider;Context" title="play.core.server.ServerProvider.Context">Context</a><span class="delimiter">)</span> = <span title="play.core.server.NettyServer" class="keyword">new</span> <a href="#play.core.server;NettyServer" title="play.core.server.NettyServer">NettyServer</a><span class="delimiter">(</span>
    <a href="#play.core.server;NettyServerProvider.createServer(ab76451d84).context" title="play.core.server.ServerProvider.Context">context</a>.<a href="../../../../play-server/play/core/server/ServerProvider.scala.html#play.core.server.ServerProvider;Context.config" title="=&gt; play.core.server.ServerConfig">config</a>,
    <a href="#play.core.server;NettyServerProvider.createServer(ab76451d84).context" title="play.core.server.ServerProvider.Context">context</a>.<a href="../../../../play-server/play/core/server/ServerProvider.scala.html#play.core.server.ServerProvider;Context.appProvider" title="=&gt; play.core.ApplicationProvider">appProvider</a>,
    <a href="#play.core.server;NettyServerProvider.createServer(ab76451d84).context" title="play.core.server.ServerProvider.Context">context</a>.<a href="../../../../play-server/play/core/server/ServerProvider.scala.html#play.core.server.ServerProvider;Context.stopHook" title="=&gt; () =&gt; scala.concurrent.Future[Unit]">stopHook</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Bootstraps Play application with a NettyServer backend.
 */</span>
<span class="keyword">object</span> <a title="play.core.server.NettyServer.type" id="play.core.server.NettyServer">NettyServer</a> <a href="#play.core.server.NettyServer" title="play.core.server.NettyServer.type" class="delimiter">{</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="play.api.Logger" id="play.core.server.NettyServer.logger">logger</a> = <a href="../../../../play/play/api/Logger.scala.html#play.api.Logger.apply(1f619881c1)" title="(clazz: Class[?0])play.api.Logger">Logger</a><span class="delimiter">(</span><span class="keyword">this</span>.<span title="()Class[_]">getClass</span><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="play.core.server.NettyServerProvider" id="play.core.server.NettyServer.provider">provider</a> = <span title="play.core.server.NettyServerProvider" class="keyword">new</span> <a href="#play.core.server;NettyServerProvider" title="play.core.server.NettyServerProvider">NettyServerProvider</a>

  <span class="keyword">def</span> <a title="(args: Array[String])Unit" id="play.core.server.NettyServer.main">main</a><span class="delimiter">(</span><a title="Array[String]" id="play.core.server.NettyServer.main.args">args</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;NettyServer.main is deprecated. Please start your Play server with the ${ProdServerStart.getClass.getName}.main.&quot;)" class="string">&quot;NettyServer.main is deprecated. Please start your Play server with the ${ProdServerStart.getClass.getName}.main.&quot;</span><span class="delimiter">)</span>
    <a href="../../../../play-server/play/core/server/ProdServerStart.scala.html#play.core.server.ProdServerStart" title="play.core.server.ProdServerStart.type">ProdServerStart</a>.<a href="../../../../play-server/play/core/server/ProdServerStart.scala.html#play.core.server.ProdServerStart.main" title="(args: Array[String])Unit">main</a><span class="delimiter">(</span><a href="#play.core.server.NettyServer.main.args" title="Array[String]">args</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Create a Netty server from the given application and server configuration.
   *
   * @param application The application.
   * @param config The server configuration.
   * @return A started Netty server, serving the application.
   */</span>
  <span class="keyword">def</span> <a title="(application: play.api.Application, config: play.core.server.ServerConfig)play.core.server.NettyServer" id="play.core.server.NettyServer.fromApplication">fromApplication</a><span class="delimiter">(</span><a title="play.api.Application" id="play.core.server.NettyServer.fromApplication.application">application</a>: <a href="../../../../play/play/api/Application.scala.html#play.api;Application" title="play.api.Application">Application</a>, <a title="play.core.server.ServerConfig" id="play.core.server.NettyServer.fromApplication$default$2">config</a>: <a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig" title="play.core.server.ServerConfig">ServerConfig</a> = <a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server.ServerConfig.apply(00112beda6)" title="(classLoader: ClassLoader, rootDir: java.io.File, port: Option[Int], sslPort: Option[Int], address: String, mode: play.api.Mode.Mode, properties: java.util.Properties)play.core.server.ServerConfig">ServerConfig</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>: <a href="#play.core.server;NettyServer" title="play.core.server.NettyServer">NettyServer</a> = <span class="delimiter">{</span>
    <span title="play.core.server.NettyServer" class="keyword">new</span> <a href="#play.core.server;NettyServer" title="play.core.server.NettyServer">NettyServer</a><span class="delimiter">(</span><a href="#play.core.server.NettyServer.fromApplication$default$2" title="play.core.server.ServerConfig">config</a>, <a href="../../../../play/play/core/ApplicationProvider.scala.html#play.core.ApplicationProvider.apply" title="(application: play.api.Application)play.core.ApplicationProvider{val get: scala.util.Try[play.api.Application]}">ApplicationProvider</a><span class="delimiter">(</span><a href="#play.core.server.NettyServer.fromApplication.application" title="play.api.Application">application</a><span class="delimiter">)</span>, <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: Unit)scala.concurrent.Future[Unit]">successful</span><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Create a Netty server from the given router and server config.
   */</span>
  <span class="keyword">def</span> <a title="(config: play.core.server.ServerConfig)(routes: PartialFunction[play.api.mvc.RequestHeader,play.api.mvc.Handler])play.core.server.NettyServer" id="play.core.server.NettyServer.fromRouter">fromRouter</a><span class="delimiter">(</span><a title="play.core.server.ServerConfig" id="play.core.server.NettyServer.fromRouter$default$1">config</a>: <a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig" title="play.core.server.ServerConfig">ServerConfig</a> = <a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server.ServerConfig.apply(00112beda6)" title="(classLoader: ClassLoader, rootDir: java.io.File, port: Option[Int], sslPort: Option[Int], address: String, mode: play.api.Mode.Mode, properties: java.util.Properties)play.core.server.ServerConfig">ServerConfig</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="PartialFunction[play.api.mvc.RequestHeader,play.api.mvc.Handler]" id="play.core.server.NettyServer.fromRouter.routes">routes</a>: <span title="PartialFunction[play.api.mvc.RequestHeader,play.api.mvc.Handler]">PartialFunction</span><span class="delimiter">[</span>RequestHeader, Handler<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#play.core.server;NettyServer" title="play.core.server.NettyServer">NettyServer</a> = <span class="delimiter">{</span>
    <a href="#play.core.server.NettyServer.fromRouter;$anon" title="play.core.server.NettyServerComponents with play.api.BuiltInComponents{}" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.core.server.NettyServerComponents with play.api.BuiltInComponents" id="play.core.server.NettyServer.fromRouter;$anon">NettyServerComponents</a> <span class="keyword">with</span> <a href="../../../../play/play/api/Application.scala.html#play.api;BuiltInComponents" title="play.api.BuiltInComponents">BuiltInComponents</a> <span class="delimiter">{</span>
      <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.core.server.ServerConfig" id="play.core.server.NettyServer.fromRouter;$anon.serverConfig">serverConfig</a> = <a href="#play.core.server.NettyServer.fromRouter$default$1" title="play.core.server.ServerConfig">config</a>
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.api.routing.Router" id="play.core.server.NettyServer.fromRouter;$anon.router">router</a> = <a href="../../../../play/play/api/routing/Router.scala.html#play.api.routing.Router" title="play.api.routing.Router.type">Router</a>.<a href="../../../../play/play/api/routing/Router.scala.html#play.api.routing.Router.from" title="(routes: play.api.routing.Router.Routes)play.api.routing.Router">from</a><span class="delimiter">(</span><a href="#play.core.server.NettyServer.fromRouter.routes" title="PartialFunction[play.api.mvc.RequestHeader,play.api.mvc.Handler]">routes</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>.<a href="#play.core.server;NettyServerComponents.server" title="=&gt; play.core.server.NettyServer">server</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Cake for building a simple Netty server.
 */</span>
<span title="AnyRef" class="keyword">trait</span> <a title="trait NettyServerComponents extends AnyRef" id="play.core.server;NettyServerComponents">NettyServerComponents</a> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.core.server.ServerConfig" id="play.core.server;NettyServerComponents.serverConfig">serverConfig</a>: <a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig" title="play.core.server.ServerConfig">ServerConfig</a> = <a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server.ServerConfig.apply(00112beda6)" title="(classLoader: ClassLoader, rootDir: java.io.File, port: Option[Int], sslPort: Option[Int], address: String, mode: play.api.Mode.Mode, properties: java.util.Properties)play.core.server.ServerConfig">ServerConfig</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.core.server.NettyServer" id="play.core.server;NettyServerComponents.server">server</a>: <a href="#play.core.server;NettyServer" title="play.core.server.NettyServer">NettyServer</a> = <span class="delimiter">{</span>
    <span class="comment">// Start the application first</span>
    <a href="../../../../play/play/api/Play.scala.html#play.api.Play" title="play.api.Play.type">Play</a>.<a href="../../../../play/play/api/Play.scala.html#play.api.Play.start" title="(app: play.api.Application)Unit">start</a><span class="delimiter">(</span><a href="#play.core.server;NettyServerComponents.application" title="=&gt; play.api.Application">application</a><span class="delimiter">)</span>
    <span title="play.core.server.NettyServer" class="keyword">new</span> <a href="#play.core.server;NettyServer" title="play.core.server.NettyServer">NettyServer</a><span class="delimiter">(</span><a href="#play.core.server;NettyServerComponents.serverConfig" title="=&gt; play.core.server.ServerConfig">serverConfig</a>, <a href="../../../../play/play/core/ApplicationProvider.scala.html#play.core.ApplicationProvider.apply" title="(application: play.api.Application)play.core.ApplicationProvider{val get: scala.util.Try[play.api.Application]}">ApplicationProvider</a><span class="delimiter">(</span><a href="#play.core.server;NettyServerComponents.application" title="=&gt; play.api.Application">application</a><span class="delimiter">)</span>, <a href="#play.core.server;NettyServerComponents.serverStopHook" title="=&gt; () =&gt; scala.concurrent.Future[Unit]">serverStopHook</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.api.Environment" id="play.core.server;NettyServerComponents.environment">environment</a>: <a href="../../../../play/play/api/Environment.scala.html#play.api;Environment" title="play.api.Environment">Environment</a> = <a href="../../../../play/play/api/Environment.scala.html#play.api.Environment" title="play.api.Environment.type">Environment</a>.<a href="../../../../play/play/api/Environment.scala.html#play.api.Environment.simple$default$1" title="java.io.File" id="play.core.server;NettyServerComponents.environment.x$6">simple</a><span class="delimiter">(</span>mode = <a href="#play.core.server;NettyServerComponents.serverConfig" title="=&gt; play.core.server.ServerConfig">serverConfig</a>.<a href="../../../../play-server/play/core/server/ServerConfig.scala.html#play.core.server;ServerConfig.mode" title="play.api.Mode.Mode" id="play.core.server;NettyServerComponents.environment.x$5">mode</a><span class="delimiter">)</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Option[play.core.SourceMapper]" id="play.core.server;NettyServerComponents.sourceMapper">sourceMapper</a>: <span title="Option[play.core.SourceMapper]">Option</span><span class="delimiter">[</span>SourceMapper<span class="delimiter">]</span> = <span title="None.type">None</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.core.WebCommands" id="play.core.server;NettyServerComponents.webCommands">webCommands</a>: <a href="../../../../play/play/core/system/WebCommands.scala.html#play.core;WebCommands" title="play.core.WebCommands">WebCommands</a> = <span title="play.core.DefaultWebCommands" class="keyword">new</span> <a href="../../../../play/play/core/system/WebCommands.scala.html#play.core;DefaultWebCommands" title="play.core.DefaultWebCommands">DefaultWebCommands</a>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.api.Configuration" id="play.core.server;NettyServerComponents.configuration">configuration</a>: <a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration" title="play.api.Configuration">Configuration</a> = <a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration" title="(underlying: com.typesafe.config.Config)play.api.Configuration">Configuration</a><span class="delimiter">(</span><span title="com.typesafe.config.ConfigFactory.type">ConfigFactory</span>.<span title="()com.typesafe.config.Config">load</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; play.api.Application" id="play.core.server;NettyServerComponents.application">application</a>: <a href="../../../../play/play/api/Application.scala.html#play.api;Application" title="play.api.Application">Application</a>

  <span class="comment">/**
   * Called when Server.stop is called.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; () =&gt; scala.concurrent.Future[Unit]" id="play.core.server;NettyServerComponents.serverStopHook">serverStopHook</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Future<span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: Unit)scala.concurrent.Future[Unit]">successful</span><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>

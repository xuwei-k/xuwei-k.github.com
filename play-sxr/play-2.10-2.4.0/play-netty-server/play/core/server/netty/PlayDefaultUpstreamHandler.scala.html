<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play-netty-server/play/core/server/netty/PlayDefaultUpstreamHandler.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.core.server.netty

<span class="keyword">import</span> org.jboss.netty.buffer.ChannelBuffers
<span class="keyword">import</span> org.jboss.netty.channel._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http.<span title="org.jboss.netty.handler.codec.http.HttpHeaders.type">HttpHeaders</span>._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http.websocketx.<span class="delimiter">{</span> WebSocketFrame, TextWebSocketFrame, BinaryWebSocketFrame <span class="delimiter">}</span>
<span class="keyword">import</span> org.jboss.netty.handler.codec.frame.TooLongFrameException
<span class="keyword">import</span> org.jboss.netty.handler.ssl._

<span class="keyword">import</span> org.jboss.netty.channel.group._
<span class="keyword">import</span> play.api._
<span class="keyword">import</span> play.api.http.<span class="delimiter">{</span> HttpErrorHandler, DefaultHttpErrorHandler <span class="delimiter">}</span>
<span class="keyword">import</span> play.api.mvc._
<span class="keyword">import</span> play.api.libs.iteratee._
<span class="keyword">import</span> play.api.libs.iteratee.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>._
<span class="keyword">import</span> play.core.server.Server
<span class="keyword">import</span> play.core.server.common.<span class="delimiter">{</span> ForwardedHeaderHandler, ServerRequestUtils, ServerResultUtils <span class="delimiter">}</span>
<span class="keyword">import</span> play.core.system.RequestIdProvider
<span class="keyword">import</span> play.core.websocket._
<span class="keyword">import</span> scala.collection.<span title="scala.collection.JavaConverters.type">JavaConverters</span>._
<span class="keyword">import</span> scala.util.control.Exception
<span class="keyword">import</span> com.typesafe.netty.http.pipelining.<span class="delimiter">{</span> OrderedDownstreamChannelEvent, OrderedUpstreamMessageEvent <span class="delimiter">}</span>
<span class="keyword">import</span> scala.concurrent.Future
<span class="keyword">import</span> java.net.<span class="delimiter">{</span> InetSocketAddress, URI <span class="delimiter">}</span>
<span class="keyword">import</span> java.io.IOException
<span class="keyword">import</span> org.jboss.netty.handler.codec.http.websocketx.CloseWebSocketFrame

<span class="keyword">private</span><span class="delimiter">[</span>play<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class PlayDefaultUpstreamHandler extends org.jboss.netty.channel.SimpleChannelUpstreamHandler with play.core.server.netty.WebSocketHandler with play.core.server.netty.RequestBodyHandler" id="play.core.server.netty;PlayDefaultUpstreamHandler">PlayDefaultUpstreamHandler</a><a href="#play.core.server.netty;PlayDefaultUpstreamHandler" title="play.core.server.netty.PlayDefaultUpstreamHandler" class="delimiter">(</a><a title="play.core.server.Server" id="play.core.server.netty;PlayDefaultUpstreamHandler.server">server</a>: <a href="../../../../../play-server/play/core/server/Server.scala.html#play.core.server;Server" title="play.core.server.Server">Server</a>, <a title="org.jboss.netty.channel.group.DefaultChannelGroup" id="play.core.server.netty;PlayDefaultUpstreamHandler.allChannels">allChannels</a>: <span title="org.jboss.netty.channel.group.DefaultChannelGroup">DefaultChannelGroup</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="org.jboss.netty.channel.SimpleChannelUpstreamHandler">SimpleChannelUpstreamHandler</span> <span class="keyword">with</span> <a href="WebSocketHandler.scala.html#play.core.server.netty;WebSocketHandler" title="play.core.server.netty.WebSocketHandler">WebSocketHandler</a> <span class="keyword">with</span> <a href="RequestBodyHandler.scala.html#play.core.server.netty;RequestBodyHandler" title="play.core.server.netty.RequestBodyHandler">RequestBodyHandler</a> <span class="delimiter">{</span>

  <span class="keyword">import</span> <a href="#play.core.server.netty.PlayDefaultUpstreamHandler" title="play.core.server.netty.PlayDefaultUpstreamHandler.type">PlayDefaultUpstreamHandler</a>._

  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.core.server.common.ForwardedHeaderHandler" id="play.core.server.netty;PlayDefaultUpstreamHandler.forwardedHeaderHandler">forwardedHeaderHandler</a> = <span title="play.core.server.common.ForwardedHeaderHandler" class="keyword">new</span> <a href="../../../../../play-server/play/core/server/common/ForwardedHeaderHandler.scala.html#play.core.server.common;ForwardedHeaderHandler" title="play.core.server.common.ForwardedHeaderHandler">ForwardedHeaderHandler</a><span class="delimiter">(</span>
    <a href="../../../../../play-server/play/core/server/common/ForwardedHeaderHandler.scala.html#play.core.server.common.ForwardedHeaderHandler" title="play.core.server.common.ForwardedHeaderHandler.type">ForwardedHeaderHandler</a>.<a href="../../../../../play-server/play/core/server/common/ForwardedHeaderHandler.scala.html#play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.apply(a70b960f0f)" title="(configuration: Option[play.api.Configuration])play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig">ForwardedHeaderHandlerConfig</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.server" title="play.core.server.Server">server</a>.<a href="../../../../../play-server/play/core/server/Server.scala.html#play.core.server;Server.applicationProvider" title="=&gt; play.core.ApplicationProvider">applicationProvider</a>.<a href="../../../../../play/play/core/ApplicationProvider.scala.html#play.core;ApplicationProvider.get" title="=&gt; scala.util.Try[play.api.Application]">get</a>.<span title="=&gt; Option[play.api.Application]">toOption</span>.<span title="(f: play.api.Application =&gt; play.api.Configuration)Option[play.api.Configuration]">map</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.forwardedHeaderHandler.$anonfun.x$1" title="play.api.Application">_</a>.<a href="../../../../../play/play/api/Application.scala.html#play.api;Application.configuration" title="=&gt; play.api.Configuration">configuration</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Sends a simple response with no body, then closes the connection.
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, status: org.jboss.netty.handler.codec.http.HttpResponseStatus)Unit" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse">sendSimpleErrorResponse</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse.ctx">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.handler.codec.http.HttpResponseStatus" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse.status">status</a>: <span title="org.jboss.netty.handler.codec.http.HttpResponseStatus">HttpResponseStatus</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.jboss.netty.handler.codec.http.DefaultHttpResponse" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse.response">response</a> = <span title="org.jboss.netty.handler.codec.http.DefaultHttpResponse" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.DefaultHttpResponse">DefaultHttpResponse</span><span class="delimiter">(</span><span title="org.jboss.netty.handler.codec.http.HttpVersion.type">HttpVersion</span>.<span title="org.jboss.netty.handler.codec.http.HttpVersion">HTTP_1_1</span>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse.status" title="org.jboss.netty.handler.codec.http.HttpResponseStatus">status</a><span class="delimiter">)</span>
    <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse.response" title="org.jboss.netty.handler.codec.http.DefaultHttpResponse">response</a>.<span title="()org.jboss.netty.handler.codec.http.HttpHeaders">headers</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: String, x$2: Any)org.jboss.netty.handler.codec.http.HttpHeaders">set</span><span class="delimiter">(</span>Names.<span title="String(&quot;Connection&quot;)">CONNECTION</span>, <span title="String(&quot;close&quot;)" class="string">&quot;close&quot;</span><span class="delimiter">)</span>
    <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse.response" title="org.jboss.netty.handler.codec.http.DefaultHttpResponse">response</a>.<span title="()org.jboss.netty.handler.codec.http.HttpHeaders">headers</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: String, x$2: Any)org.jboss.netty.handler.codec.http.HttpHeaders">set</span><span class="delimiter">(</span>Names.<span title="String(&quot;Content-Length&quot;)">CONTENT_LENGTH</span>, <span title="String(&quot;0&quot;)" class="string">&quot;0&quot;</span><span class="delimiter">)</span>
    <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Any)org.jboss.netty.channel.ChannelFuture">write</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse.response" title="org.jboss.netty.handler.codec.http.DefaultHttpResponse">response</a><span class="delimiter">)</span>.<span title="(x$1: org.jboss.netty.channel.ChannelFutureListener)Unit">addListener</span><span class="delimiter">(</span><span title="org.jboss.netty.channel.ChannelFutureListener.type">ChannelFutureListener</span>.<span title="org.jboss.netty.channel.ChannelFutureListener">CLOSE</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, event: org.jboss.netty.channel.ExceptionEvent)Unit" id="play.core.server.netty;PlayDefaultUpstreamHandler.exceptionCaught">exceptionCaught</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="play.core.server.netty;PlayDefaultUpstreamHandler.exceptionCaught.ctx">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.ExceptionEvent" id="play.core.server.netty;PlayDefaultUpstreamHandler.exceptionCaught.event">event</a>: <span title="org.jboss.netty.channel.ExceptionEvent">ExceptionEvent</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>

    <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.exceptionCaught.event" title="org.jboss.netty.channel.ExceptionEvent">event</a>.<span title="()Throwable">getCause</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="comment">// IO exceptions happen all the time, it usually just means that the client has closed the connection before fully</span>
      <span class="comment">// sending/receiving the response.</span>
      <span class="keyword">case</span> <span title="java.io.IOException">e</span>: <span title="java.io.IOException">IOException</span> =&gt;
        <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.trace(804ef4765b)" title="(message: =&gt; String, error: =&gt; Throwable)Unit">trace</a><span class="delimiter">(</span><span title="String(&quot;Benign IO exception caught in Netty&quot;)" class="string">&quot;Benign IO exception caught in Netty&quot;</span>, <span title="java.io.IOException">e</span><span class="delimiter">)</span>
        <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.exceptionCaught.event" title="org.jboss.netty.channel.ExceptionEvent">event</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()org.jboss.netty.channel.ChannelFuture">close</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.jboss.netty.handler.codec.frame.TooLongFrameException">e</span>: <span title="org.jboss.netty.handler.codec.frame.TooLongFrameException">TooLongFrameException</span> =&gt;
        <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.warn(804ef4765b)" title="(message: =&gt; String, error: =&gt; Throwable)Unit">warn</a><span class="delimiter">(</span><span title="String(&quot;Handling TooLongFrameException&quot;)" class="string">&quot;Handling TooLongFrameException&quot;</span>, <span title="org.jboss.netty.handler.codec.frame.TooLongFrameException">e</span><span class="delimiter">)</span>
        <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, status: org.jboss.netty.handler.codec.http.HttpResponseStatus)Unit">sendSimpleErrorResponse</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.exceptionCaught.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <span title="org.jboss.netty.handler.codec.http.HttpResponseStatus.type">HttpResponseStatus</span>.<span title="org.jboss.netty.handler.codec.http.HttpResponseStatus">REQUEST_URI_TOO_LONG</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="IllegalArgumentException">e</span>: <span title="IllegalArgumentException">IllegalArgumentException</span> <span class="keyword">if</span> <span title="(x: String)Option[String]">Option</span><span class="delimiter">(</span><span title="IllegalArgumentException">e</span>.<span title="()String">getMessage</span><span class="delimiter">)</span>.<span title="(p: String =&gt; Boolean)Boolean">exists</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.exceptionCaught.$anonfun.x$2" title="String">_</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;Header value contains a prohibited character&quot;)" class="string">&quot;Header value contains a prohibited character&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <span class="comment">// https://github.com/netty/netty/blob/netty-3.9.3.Final/src/main/java/org/jboss/netty/handler/codec/http/HttpHeaders.java#L1075-L1080</span>
        <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.debug(804ef4765b)" title="(message: =&gt; String, error: =&gt; Throwable)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Handling Header value error&quot;)" class="string">&quot;Handling Header value error&quot;</span>, <span title="IllegalArgumentException">e</span><span class="delimiter">)</span>
        <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendSimpleErrorResponse" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, status: org.jboss.netty.handler.codec.http.HttpResponseStatus)Unit">sendSimpleErrorResponse</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.exceptionCaught.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <span title="org.jboss.netty.handler.codec.http.HttpResponseStatus.type">HttpResponseStatus</span>.<span title="org.jboss.netty.handler.codec.http.HttpResponseStatus">BAD_REQUEST</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Throwable">e</span> =&gt;
        <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.error(804ef4765b)" title="(message: =&gt; String, error: =&gt; Throwable)Unit">error</a><span class="delimiter">(</span><span title="String(&quot;Exception caught in Netty&quot;)" class="string">&quot;Exception caught in Netty&quot;</span>, <span title="Throwable">e</span><span class="delimiter">)</span>
        <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.exceptionCaught.event" title="org.jboss.netty.channel.ExceptionEvent">event</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()org.jboss.netty.channel.ChannelFuture">close</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.ChannelStateEvent)Unit" id="play.core.server.netty;PlayDefaultUpstreamHandler.channelConnected">channelConnected</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="play.core.server.netty;PlayDefaultUpstreamHandler.channelConnected.ctx">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.ChannelStateEvent" id="play.core.server.netty;PlayDefaultUpstreamHandler.channelConnected.e">e</a>: <span title="org.jboss.netty.channel.ChannelStateEvent">ChannelStateEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="(x: org.jboss.netty.handler.ssl.SslHandler)Option[org.jboss.netty.handler.ssl.SslHandler]">Option</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.channelConnected.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.ChannelPipeline">getPipeline</span>.<span title="(x$1: Class[org.jboss.netty.handler.ssl.SslHandler])org.jboss.netty.handler.ssl.SslHandler">get</span><span class="delimiter">(</span>classOf<span title="Class[org.jboss.netty.handler.ssl.SslHandler](classOf[org.jboss.netty.handler.ssl.SslHandler])" class="delimiter">[</span>SslHandler<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: org.jboss.netty.handler.ssl.SslHandler =&gt; org.jboss.netty.channel.ChannelFuture)Option[org.jboss.netty.channel.ChannelFuture]">map</span> <span title="Unit" class="delimiter">{</span> <a title="org.jboss.netty.handler.ssl.SslHandler" id="play.core.server.netty;PlayDefaultUpstreamHandler.channelConnected.$anonfun.sslHandler">sslHandler</a> =&gt;
      <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.channelConnected.$anonfun.sslHandler" title="org.jboss.netty.handler.ssl.SslHandler">sslHandler</a>.<span title="()org.jboss.netty.channel.ChannelFuture">handshake</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.ChannelStateEvent)Unit" id="play.core.server.netty;PlayDefaultUpstreamHandler.channelOpen">channelOpen</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="play.core.server.netty;PlayDefaultUpstreamHandler.channelOpen.ctx">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.ChannelStateEvent" id="play.core.server.netty;PlayDefaultUpstreamHandler.channelOpen.e">e</a>: <span title="org.jboss.netty.channel.ChannelStateEvent">ChannelStateEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.allChannels" title="org.jboss.netty.channel.group.DefaultChannelGroup">allChannels</a>.<span title="(x$1: org.jboss.netty.channel.Channel)Boolean">add</span><span title="Unit" class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.channelOpen.e" title="org.jboss.netty.channel.ChannelStateEvent">e</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.MessageEvent)Unit" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived">messageReceived</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.ctx">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <span title="org.jboss.netty.channel.MessageEvent">e</span>: <span title="org.jboss.netty.channel.MessageEvent">MessageEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="org.jboss.netty.channel.MessageEvent">e</span>.<span title="()Object">getMessage</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>

      <span class="keyword">case</span> <a title="org.jboss.netty.handler.codec.http.HttpRequest" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest">nettyHttpRequest</a>: <span title="org.jboss.netty.handler.codec.http.HttpRequest">HttpRequest</span> =&gt;

        <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.trace(83d3728a3c)" title="(message: =&gt; String)Unit">trace</a><span class="delimiter">(</span><span title="String(&quot;Http request received by netty: &quot;)" class="string">&quot;Http request received by netty: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyHttpRequest</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="websocketable extends AnyRef with play.core.server.WebSocketable" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.websocketableRequest">websocketableRequest</a> = <a href="WebSocketHandler.scala.html#play.core.server.netty;WebSocketHandler.websocketable" title="(req: org.jboss.netty.handler.codec.http.HttpRequest)play.core.server.WebSocketable">websocketable</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyHttpRequest</a><span class="delimiter">)</span>
        <span class="keyword">var</span> <a title="org.jboss.netty.handler.codec.http.HttpVersion" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyVersion">nettyVersion</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyHttpRequest</a>.<span title="()org.jboss.netty.handler.codec.http.HttpVersion">getProtocolVersion</span>
        <span class="keyword">val</span> <a title="org.jboss.netty.handler.codec.http.QueryStringDecoder" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyUri">nettyUri</a> = <span title="org.jboss.netty.handler.codec.http.QueryStringDecoder" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.QueryStringDecoder">QueryStringDecoder</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyHttpRequest</a>.<span title="()String">getUri</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="play.api.mvc.Headers" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.rHeaders">rHeaders</a>: <a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers" title="play.api.mvc.Headers">Headers</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.getHeaders" title="(nettyRequest: org.jboss.netty.handler.codec.http.HttpRequest)play.api.mvc.Headers">getHeaders</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyHttpRequest</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="=&gt; String" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.rRemoteAddress">rRemoteAddress</a> = <a href="../../../../../play-server/play/core/server/common/ServerRequestUtils.scala.html#play.core.server.common.ServerRequestUtils" title="play.core.server.common.ServerRequestUtils.type">ServerRequestUtils</a>.<a href="../../../../../play-server/play/core/server/common/ServerRequestUtils.scala.html#play.core.server.common.ServerRequestUtils.findRemoteAddress" title="(forwardedHeaderHandler: play.core.server.common.ForwardedHeaderHandler, headers: play.api.mvc.Headers, connectionRemoteAddress: java.net.InetSocketAddress)String">findRemoteAddress</a><span class="delimiter">(</span>
          <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.forwardedHeaderHandler" title="=&gt; play.core.server.common.ForwardedHeaderHandler">forwardedHeaderHandler</a>,
          <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.rHeaders" title="play.api.mvc.Headers">rHeaders</a>,
          connectionRemoteAddress = <span title="org.jboss.netty.channel.MessageEvent">e</span>.<span title="()java.net.SocketAddress">getRemoteAddress</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.net.InetSocketAddress" class="delimiter">[</span><span title="java.net.InetSocketAddress">InetSocketAddress</span><span class="delimiter">]</span><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="=&gt; Boolean" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.rSecure">rSecure</a> = <a href="../../../../../play-server/play/core/server/common/ServerRequestUtils.scala.html#play.core.server.common.ServerRequestUtils" title="play.core.server.common.ServerRequestUtils.type">ServerRequestUtils</a>.<a href="../../../../../play-server/play/core/server/common/ServerRequestUtils.scala.html#play.core.server.common.ServerRequestUtils.findSecureProtocol" title="(forwardedHeaderHandler: play.core.server.common.ForwardedHeaderHandler, headers: play.api.mvc.Headers, connectionSecureProtocol: Boolean)Boolean">findSecureProtocol</a><span class="delimiter">(</span>
          <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.forwardedHeaderHandler" title="=&gt; play.core.server.common.ForwardedHeaderHandler">forwardedHeaderHandler</a>,
          <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.rHeaders" title="play.api.mvc.Headers">rHeaders</a>,
          connectionSecureProtocol = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.ChannelPipeline">getPipeline</span>.<span title="(x$1: Class[org.jboss.netty.handler.ssl.SslHandler])org.jboss.netty.handler.ssl.SslHandler">get</span><span class="delimiter">(</span>classOf<span title="Class[org.jboss.netty.handler.ssl.SslHandler](classOf[org.jboss.netty.handler.ssl.SslHandler])" class="delimiter">[</span>SslHandler<span class="delimiter">]</span><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>
        <span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="=&gt; play.api.mvc.RequestHeader{val id: Long; val tags: scala.collection.immutable.Map[String,String]; lazy val remoteAddress: String; lazy val secure: Boolean}" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.tryToCreateRequest">tryToCreateRequest</a> = <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,Seq[String]]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.tryToCreateRequest.parameters">parameters</a> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">[</span><span title="String">String</span>, <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyUri" title="org.jboss.netty.handler.codec.http.QueryStringDecoder">nettyUri</a>.<span title="(m: java.util.Map[String,java.util.List[String]])scala.collection.convert.Decorators.AsScala[scala.collection.mutable.Map[String,java.util.List[String]]]">getParameters</span>.<span title="=&gt; scala.collection.mutable.Map[String,java.util.List[String]]">asScala</span>.<span title="(f: java.util.List[String] =&gt; scala.collection.mutable.Buffer[String])scala.collection.Map[String,scala.collection.mutable.Buffer[String]]">mapValues</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.tryToCreateRequest.parameters.$anonfun.x$3" title="(l: java.util.List[String])scala.collection.convert.Decorators.AsScala[scala.collection.mutable.Buffer[String]]">_</a>.<span title="=&gt; scala.collection.mutable.Buffer[String]">asScala</span><span class="delimiter">)</span>
          <span class="comment">// wrapping into URI to handle absoluteURI</span>
          <span class="keyword">val</span> <a title="String" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.tryToCreateRequest.path">path</a> = <span title="java.net.URI" class="keyword">new</span> <span title="java.net.URI">URI</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyUri" title="org.jboss.netty.handler.codec.http.QueryStringDecoder">nettyUri</a>.<span title="()String">getPath</span><span class="delimiter">)</span>.<span title="()String">getRawPath</span>
          <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader" title="(parsedPath: String, parameters: Map[String,Seq[String]])play.api.mvc.RequestHeader{val id: Long; val tags: scala.collection.immutable.Map[String,String]; lazy val remoteAddress: String; lazy val secure: Boolean}">createRequestHeader</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.tryToCreateRequest.path" title="String">path</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.tryToCreateRequest.parameters" title="scala.collection.immutable.Map[String,Seq[String]]">parameters</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="(parsedPath: String, parameters: Map[String,Seq[String]])play.api.mvc.RequestHeader{val id: Long; val tags: scala.collection.immutable.Map[String,String]; lazy val remoteAddress: String; lazy val secure: Boolean}" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader">createRequestHeader</a><span class="delimiter">(</span><a title="String" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.parsedPath">parsedPath</a>: <span title="String">String</span>, <a title="Map[String,Seq[String]]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader$default$2">parameters</a>: <span title="Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">[</span><span title="String">String</span>, <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
          <span class="comment">//mapping netty request to Play's</span>
          <span class="keyword">val</span> <a title="untaggedRequestHeader extends AnyRef with play.api.mvc.RequestHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader">untaggedRequestHeader</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon" title="play.api.mvc.RequestHeader{}" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.api.mvc.RequestHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon">RequestHeader</a> <span class="delimiter">{</span>
            <span class="keyword">override</span> <span class="keyword">val</span> <a title="Long" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon.id">id</a> = <a href="../../../../../play/play/core/system/RequestIdProvider.scala.html#play.core.system.RequestIdProvider" title="play.core.system.RequestIdProvider.type">RequestIdProvider</a>.<a href="../../../../../play/play/core/system/RequestIdProvider.scala.html#play.core.system.RequestIdProvider.requestIDs" title="=&gt; java.util.concurrent.atomic.AtomicLong">requestIDs</a>.<span title="()Long">incrementAndGet</span>
            <span class="keyword">override</span> <span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,String]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon.tags">tags</a> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,String]" class="delimiter">[</span><span title="String">String</span>, <span title="String">String</span><span class="delimiter">]</span>
            <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon.uri">uri</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyHttpRequest</a>.<span title="()String">getUri</span>
            <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon.path">path</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.parsedPath" title="String">parsedPath</a>
            <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon.method">method</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyHttpRequest</a>.<span title="()org.jboss.netty.handler.codec.http.HttpMethod">getMethod</span>.<span title="()String">getName</span>
            <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon.version">version</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyVersion" title="org.jboss.netty.handler.codec.http.HttpVersion">nettyVersion</a>.<span title="()String">getText</span>
            <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Map[String,Seq[String]]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon.queryString">queryString</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader$default$2" title="Map[String,Seq[String]]">parameters</a>
            <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; play.api.mvc.Headers" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon.headers">headers</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.rHeaders" title="play.api.mvc.Headers">rHeaders</a>
            <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="String" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon.remoteAddress">remoteAddress</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.rRemoteAddress" title="=&gt; String">rRemoteAddress</a>
            <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Boolean" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader;$anon.secure">secure</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.rSecure" title="=&gt; Boolean">rSecure</a>
          <span class="delimiter">}</span>
          <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader.untaggedRequestHeader" title="untaggedRequestHeader extends AnyRef with play.api.mvc.RequestHeader">untaggedRequestHeader</a>
        <span class="delimiter">}</span>

        <span class="keyword">val</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader" title="(play.api.mvc.RequestHeader, Product with Serializable with scala.util.Either[scala.concurrent.Future[play.api.mvc.Result],Product with Serializable] with Either[scala.concurrent.Future[play.api.mvc.Result],(play.api.mvc.Handler, play.api.Application)])" class="delimiter">(</a><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5" title="play.api.mvc.RequestHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader">requestHeader</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5" title="&lt;root&gt; extends Product with Serializable with scala.util.Either[scala.concurrent.Future[play.api.mvc.Result],Product with Serializable] with Either[scala.concurrent.Future[play.api.mvc.Result],(play.api.mvc.Handler, play.api.Application)] @unchecked" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handler">handler</a>: Either<span class="delimiter">[</span>Future<span class="delimiter">[</span>Result<span class="delimiter">]</span>, <span class="delimiter">(</span>Handler, Application<span class="delimiter">)</span><span class="delimiter">]</span> @<span title="Either[scala.concurrent.Future[play.api.mvc.Result],(play.api.mvc.Handler, play.api.Application)] @unchecked">unchecked</span><span class="delimiter">)</span> = <span title="scala.util.control.Exception.type">Exception</span>
          .<span title="[T]=&gt; scala.util.control.Exception.Catch[T]">allCatch</span><span title="scala.util.control.Exception.Catch[play.api.mvc.RequestHeader]" class="delimiter">[</span><a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader" title="play.api.mvc.RequestHeader">RequestHeader</a><span class="delimiter">]</span>.<span title="(body: =&gt; play.api.mvc.RequestHeader)scala.util.Either[Throwable,play.api.mvc.RequestHeader]">either</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.tryToCreateRequest" title="=&gt; play.api.mvc.RequestHeader{val id: Long; val tags: scala.collection.immutable.Map[String,String]; lazy val remoteAddress: String; lazy val secure: Boolean}">tryToCreateRequest</a><span class="delimiter">)</span>.<span title="(fa: Throwable =&gt; (play.api.mvc.RequestHeader, Product with Serializable with scala.util.Either[scala.concurrent.Future[play.api.mvc.Result],Product with Serializable]), fb: play.api.mvc.RequestHeader =&gt; (play.api.mvc.RequestHeader, Product with Serializable with scala.util.Either[scala.concurrent.Future[play.api.mvc.Result],Product with Serializable]))(play.api.mvc.RequestHeader, Product with Serializable with scala.util.Either[scala.concurrent.Future[play.api.mvc.Result],Product with Serializable])">fold</span><span title="(play.api.mvc.RequestHeader, Product with Serializable with scala.util.Either[scala.concurrent.Future[play.api.mvc.Result],Product with Serializable]) @unchecked" class="delimiter">(</span>
            <a title="Throwable" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.e">e</a> =&gt; <span class="delimiter">{</span>
              <span class="comment">// use unparsed path</span>
              <span class="keyword">val</span> <span title="untaggedRequestHeader extends AnyRef with play.api.mvc.RequestHeader">rh</span> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.createRequestHeader" title="(parsedPath: String, parameters: Map[String,Seq[String]])play.api.mvc.RequestHeader{val id: Long; val tags: scala.collection.immutable.Map[String,String]; lazy val remoteAddress: String; lazy val secure: Boolean}">createRequestHeader</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyUri" title="org.jboss.netty.handler.codec.http.QueryStringDecoder">nettyUri</a>.<span title="()String">getPath</span><span class="delimiter">)</span>
              <span class="keyword">val</span> <a title="scala.concurrent.Future[play.api.mvc.Result]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.result">result</a> = <span title="scala.concurrent.Future.type">Future</span>
                .<span title="(result: Unit)scala.concurrent.Future[Unit]">successful</span><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="comment">// Create a dummy future</span>
                .<span title="(f: Unit =&gt; scala.concurrent.Future[play.api.mvc.Result])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[play.api.mvc.Result]">flatMap</span> <span class="delimiter">{</span> <a title="Unit" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.result.$anonfun.x$4">_</a> =&gt;
                  <span class="comment">// Call errorHandler in another context, don't block here</span>
                  <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.errorHandler" title="(app: Option[play.api.Application])play.api.http.HttpErrorHandler">errorHandler</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.server" title="play.core.server.Server">server</a>.<a href="../../../../../play-server/play/core/server/Server.scala.html#play.core.server;Server.applicationProvider" title="=&gt; play.core.ApplicationProvider">applicationProvider</a>.<a href="../../../../../play/play/core/ApplicationProvider.scala.html#play.core;ApplicationProvider.get" title="=&gt; scala.util.Try[play.api.Application]">get</a>.<span title="=&gt; Option[play.api.Application]">toOption</span><span class="delimiter">)</span>.<a href="../../../../../play/play/api/http/HttpErrorHandler.scala.html#play.api.http;HttpErrorHandler.onClientError" title="(request: play.api.mvc.RequestHeader, statusCode: Int, message: String)scala.concurrent.Future[play.api.mvc.Result]">onClientError</a><span class="delimiter">(</span><span title="untaggedRequestHeader extends AnyRef with play.api.mvc.RequestHeader">rh</span>, <span title="Int(400)" class="int">400</span>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.e" title="Throwable">e</a>.<span title="()String">getMessage</span><span class="delimiter">)</span>
                <span class="delimiter">}</span><span class="delimiter">(</span>play.api.libs.iteratee.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution" title="play.api.libs.iteratee.Execution.type">Execution</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.trampoline" title="play.api.libs.iteratee.Execution.trampoline.type">trampoline</a><span class="delimiter">)</span>
              <span title="(_1: play.api.mvc.RequestHeader{val id: Long; val tags: scala.collection.immutable.Map[String,String]; lazy val remoteAddress: String; lazy val secure: Boolean}, _2: scala.util.Left[scala.concurrent.Future[play.api.mvc.Result],Nothing])(play.api.mvc.RequestHeader{val id: Long; val tags: scala.collection.immutable.Map[String,String]; lazy val remoteAddress: String; lazy val secure: Boolean}, scala.util.Left[scala.concurrent.Future[play.api.mvc.Result],Nothing])" class="delimiter">(</span><span title="untaggedRequestHeader extends AnyRef with play.api.mvc.RequestHeader">rh</span>, <span title="(a: scala.concurrent.Future[play.api.mvc.Result])scala.util.Left[scala.concurrent.Future[play.api.mvc.Result],Nothing]">Left</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.result" title="scala.concurrent.Future[play.api.mvc.Result]">result</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>,
            <span title="play.api.mvc.RequestHeader">rh</span> =&gt; <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.server" title="play.core.server.Server">server</a>.<a href="../../../../../play-server/play/core/server/Server.scala.html#play.core.server;Server.getHandlerFor" title="(request: play.api.mvc.RequestHeader)Either[scala.concurrent.Future[play.api.mvc.Result],(play.api.mvc.RequestHeader, play.api.mvc.Handler, play.api.Application)]">getHandlerFor</a><span class="delimiter">(</span><span title="play.api.mvc.RequestHeader">rh</span><span class="delimiter">)</span> <span title="(play.api.mvc.RequestHeader, Product with Serializable with scala.util.Either[scala.concurrent.Future[play.api.mvc.Result],Product with Serializable])" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a title="scala.util.Left[scala.concurrent.Future[play.api.mvc.Result],(play.api.mvc.RequestHeader, play.api.mvc.Handler, play.api.Application)]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.directResult">directResult</a> @ Left<span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt; <span title="(_1: play.api.mvc.RequestHeader, _2: scala.util.Left[scala.concurrent.Future[play.api.mvc.Result],(play.api.mvc.RequestHeader, play.api.mvc.Handler, play.api.Application)])(play.api.mvc.RequestHeader, scala.util.Left[scala.concurrent.Future[play.api.mvc.Result],(play.api.mvc.RequestHeader, play.api.mvc.Handler, play.api.Application)])" class="delimiter">(</span><span title="play.api.mvc.RequestHeader">rh</span>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.directResult" title="scala.util.Left[scala.concurrent.Future[play.api.mvc.Result],(play.api.mvc.RequestHeader, play.api.mvc.Handler, play.api.Application)]">directResult</a><span class="delimiter">)</span>
              <span class="keyword">case</span> Right<span class="delimiter">(</span><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.taggedRequestHeader">taggedRequestHeader</a>, <a title="play.api.mvc.Handler" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.handler">handler</a>, <a title="play.api.Application" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.application">application</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <span title="(_1: play.api.mvc.RequestHeader, _2: scala.util.Right[Nothing,(play.api.mvc.Handler, play.api.Application)])(play.api.mvc.RequestHeader, scala.util.Right[Nothing,(play.api.mvc.Handler, play.api.Application)])" class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.taggedRequestHeader" title="play.api.mvc.RequestHeader">taggedRequestHeader</a>, <span title="(b: (play.api.mvc.Handler, play.api.Application))scala.util.Right[Nothing,(play.api.mvc.Handler, play.api.Application)]">Right</span><span class="delimiter">(</span><span title="(_1: play.api.mvc.Handler, _2: play.api.Application)(play.api.mvc.Handler, play.api.Application)" class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.handler" title="play.api.mvc.Handler">handler</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.x$5.$anonfun.application" title="play.api.Application">application</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">)</span>

        <span class="comment">// It is a pre-requesite that we're using the http pipelining capabilities provided and that we have a</span>
        <span class="comment">// handler downstream from this one that produces these events.</span>
        <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="org.jboss.netty.channel.ChannelHandlerContext" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.msgCtx">msgCtx</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>
        <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="com.typesafe.netty.http.pipelining.OrderedUpstreamMessageEvent" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.oue">oue</a> = <span title="org.jboss.netty.channel.MessageEvent">e</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="com.typesafe.netty.http.pipelining.OrderedUpstreamMessageEvent" class="delimiter">[</span><span title="com.typesafe.netty.http.pipelining.OrderedUpstreamMessageEvent">OrderedUpstreamMessageEvent</span><span class="delimiter">]</span>

        <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handler" title="Either[scala.concurrent.Future[play.api.mvc.Result],(play.api.mvc.Handler, play.api.Application)] @unchecked">handler</a> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="comment">//execute normal action</span>
          <span class="keyword">case</span> Right<span class="delimiter">(</span><span class="delimiter">(</span><a title="play.api.mvc.EssentialAction" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.action">action</a>: <a href="../../../../../play/play/api/mvc/Action.scala.html#play.api.mvc;EssentialAction" title="play.api.mvc.EssentialAction">EssentialAction</a>, <span title="play.api.Application">app</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <span title="play.api.mvc.EssentialAction">a</span> = <a href="../../../../../play/play/api/mvc/Action.scala.html#play.api.mvc.EssentialAction.apply" title="(f: play.api.mvc.RequestHeader =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result])play.api.mvc.EssentialAction">EssentialAction</a> <span class="delimiter">{</span> <a title="play.api.mvc.RequestHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun.rh">rh</a> =&gt;
              <span class="keyword">import</span> play.api.libs.iteratee.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution" title="play.api.libs.iteratee.Execution.type">Execution</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits" title="play.api.libs.iteratee.Execution.Implicits.type">Implicits</a>.trampoline
              <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee" title="play.api.libs.iteratee.Iteratee.type">Iteratee</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee.flatten" title="(i: scala.concurrent.Future[play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]])play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">flatten</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.action" title="(v1: play.api.mvc.RequestHeader)play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">action</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun.rh" title="play.api.mvc.RequestHeader">rh</a><span class="delimiter">)</span>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee;Iteratee.unflatten" title="=&gt; scala.concurrent.Future[play.api.libs.iteratee.Step[Array[Byte],play.api.mvc.Result]]">unflatten</a>.<span title="(f: play.api.libs.iteratee.Step[Array[Byte],play.api.mvc.Result] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]]">map</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">(</a><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun.$anonfun.x$6" title="play.api.libs.iteratee.Step[Array[Byte],play.api.mvc.Result]">_</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee;Step.it" title="=&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">it</a><span class="delimiter">)</span>.<span title="(pf: PartialFunction[Throwable,play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]]">recover</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Throwable,play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]] with Serializable" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
                <span class="keyword">case</span> <a title="Throwable" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun;$anonfun.isDefinedAt.error">error</a> =&gt;
                  <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee" title="play.api.libs.iteratee.Iteratee.type">Iteratee</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee.flatten" title="(i: scala.concurrent.Future[play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]])play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">flatten</a><span class="delimiter">(</span>
                    <span title="play.api.Application">app</span>.<a href="../../../../../play/play/api/Application.scala.html#play.api;Application.errorHandler" title="=&gt; play.api.http.HttpErrorHandler">errorHandler</a>.<a href="../../../../../play/play/api/http/HttpErrorHandler.scala.html#play.api.http;HttpErrorHandler.onServerError" title="(request: play.api.mvc.RequestHeader, exception: Throwable)scala.concurrent.Future[play.api.mvc.Result]">onServerError</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader" title="play.api.mvc.RequestHeader">requestHeader</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun;$anonfun.isDefinedAt.error" title="Throwable">error</a><span class="delimiter">)</span>.<span title="(f: play.api.mvc.Result =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]]">map</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">(</a><a title="play.api.mvc.Result" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun;$anonfun.applyOrElse.$anonfun.result">result</a> =&gt; <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Done.apply" title="(a: play.api.mvc.Result, e: play.api.libs.iteratee.Input[Array[Byte]])play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">Done</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun;$anonfun.applyOrElse.$anonfun.result" title="play.api.mvc.Result">result</a>, <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input.Empty" title="play.api.libs.iteratee.Input.Empty.type">Empty</a><span class="delimiter">)</span><span class="delimiter">)</span>
                  <span class="delimiter">)</span>: <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee;Iteratee" title="play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">Iteratee</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Result<span class="delimiter">]</span>
              <span class="delimiter">}</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction" title="(action: play.api.mvc.EssentialAction, app: Option[play.api.Application])Unit">handleAction</a><span class="delimiter">(</span><span title="play.api.mvc.EssentialAction">a</span>, <span title="(x: play.api.Application)Some[play.api.Application]">Some</span><span class="delimiter">(</span><span title="play.api.Application">app</span><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> Right<span class="delimiter">(</span><span class="delimiter">(</span><a title="play.api.mvc.WebSocket[Any,Any]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.ws">ws</a> @ WebSocket<span class="delimiter">(</span><a title="play.api.mvc.RequestHeader =&gt; scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.f">f</a><span class="delimiter">)</span>, <span title="play.api.Application">app</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.websocketableRequest" title="websocketable extends AnyRef with play.core.server.WebSocketable">websocketableRequest</a>.<a href="../../../../../play-server/play/core/server/Server.scala.html#play.core.server;WebSocketable.check" title="=&gt; Boolean">check</a> =&gt;
            <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.trace(83d3728a3c)" title="(message: =&gt; String)Unit">trace</a><span class="delimiter">(</span><span title="String(&quot;Serving this request with: &quot;)" class="string">&quot;Serving this request with: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.ws" title="play.api.mvc.WebSocket[Any,Any]">ws</a><span class="delimiter">)</span>

            <span class="keyword">val</span> <a title="scala.concurrent.Future[scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]]]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.executed">executed</a> = <span title="(body: =&gt; scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]])(implicit execctx: scala.concurrent.ExecutionContext)scala.concurrent.Future[scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]]]">Future</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.f" title="(v1: play.api.mvc.RequestHeader)scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]]">f</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader" title="play.api.mvc.RequestHeader">requestHeader</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span>play.api.libs.concurrent.<a href="../../../../../play/play/api/libs/concurrent/Execution.scala.html#play.api.libs.concurrent.Execution" title="play.api.libs.concurrent.Execution.type">Execution</a>.<a href="../../../../../play/play/api/libs/concurrent/Execution.scala.html#play.api.libs.concurrent.Execution.defaultContext" title="=&gt; scala.concurrent.ExecutionContext">defaultContext</a><span class="delimiter">)</span>

            <span class="keyword">import</span> play.api.libs.iteratee.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution" title="play.api.libs.iteratee.Execution.type">Execution</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits" title="play.api.libs.iteratee.Execution.Implicits.type">Implicits</a>.trampoline
            <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.executed" title="scala.concurrent.Future[scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]]]">executed</a>.<span title="(f: scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]] =&gt; scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]]">flatMap</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">(</a><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.x" title="(x: scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]])scala.concurrent.Future[Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit]]">identity</a><span class="delimiter">)</span>.<span title="(f: Either[play.api.mvc.Result,(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit] =&gt; Unit)(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[Unit]">map</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.x0$1" title="Unit" class="delimiter">{</a>
              <span class="keyword">case</span> Left<span class="delimiter">(</span><a title="play.api.mvc.Result" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.result">result</a><span class="delimiter">)</span> =&gt;
                <span class="comment">// WebSocket was rejected, send result</span>
                <span class="keyword">val</span> <a title="play.api.mvc.EssentialAction" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.a">a</a> = <a href="../../../../../play/play/api/mvc/Action.scala.html#play.api.mvc.EssentialAction.apply" title="(f: play.api.mvc.RequestHeader =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result])play.api.mvc.EssentialAction">EssentialAction</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.a.$anonfun.x$7">_</a> =&gt; <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Done.apply" title="(a: play.api.mvc.Result, e: play.api.libs.iteratee.Input[Array[Byte]])play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">Done</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.result" title="play.api.mvc.Result">result</a>, <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input.Empty" title="play.api.libs.iteratee.Input.Empty.type">Empty</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction" title="(action: play.api.mvc.EssentialAction, app: Option[play.api.Application])Unit">handleAction</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.a" title="play.api.mvc.EssentialAction">a</a>, <span title="(x: play.api.Application)Some[play.api.Application]">Some</span><span class="delimiter">(</span><span title="play.api.Application">app</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> Right<span class="delimiter">(</span><a title="(play.api.libs.iteratee.Enumerator[Any], play.api.libs.iteratee.Iteratee[Any,Unit]) =&gt; Unit" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.socket">socket</a><span class="delimiter">)</span> =&gt;
                <span class="keyword">val</span> <a title="Long" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.bufferLimit">bufferLimit</a> = <span title="play.api.Application">app</span>.<a href="../../../../../play/play/api/Application.scala.html#play.api;Application.configuration" title="=&gt; play.api.Configuration">configuration</a>.<a href="../../../../../play/play/api/Configuration.scala.html#play.api;Configuration.getBytes" title="(path: String)Option[Long]">getBytes</a><span class="delimiter">(</span><span title="String(&quot;play.websocket.buffer.limit&quot;)" class="string">&quot;play.websocket.buffer.limit&quot;</span><span class="delimiter">)</span>.<span title="(default: =&gt; Long)Long">getOrElse</span><span class="delimiter">(</span><span title="Long(65536L)" class="long">65536L</span><span class="delimiter">)</span>

                <span class="keyword">val</span> <a title="play.api.libs.iteratee.Enumerator[Any]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.enumerator">enumerator</a> = <a href="WebSocketHandler.scala.html#play.core.server.netty;WebSocketHandler.websocketHandshake" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, req: org.jboss.netty.handler.codec.http.HttpRequest, e: org.jboss.netty.channel.MessageEvent, bufferLimit: Long)(frameFormatter: play.api.mvc.WebSocket.FrameFormatter[Any])play.api.libs.iteratee.Enumerator[Any]">websocketHandshake</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyHttpRequest</a>, <span title="org.jboss.netty.channel.MessageEvent">e</span>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.bufferLimit" title="Long">bufferLimit</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.ws" title="play.api.mvc.WebSocket[Any,Any]">ws</a>.<a href="../../../../../play/play/api/mvc/WebSocket.scala.html#play.api.mvc;WebSocket.inFormatter" title="=&gt; play.api.mvc.WebSocket.FrameFormatter[Any]">inFormatter</a><span class="delimiter">)</span>
                <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.socket" title="(v1: play.api.libs.iteratee.Enumerator[Any], v2: play.api.libs.iteratee.Iteratee[Any,Unit])Unit">socket</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.$anonfun.enumerator" title="play.api.libs.iteratee.Enumerator[Any]">enumerator</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext)(frameFormatter: play.api.mvc.WebSocket.FrameFormatter[Any])play.api.libs.iteratee.Iteratee[Any,Unit]">socketOut</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.ws" title="play.api.mvc.WebSocket[Any,Any]">ws</a>.<a href="../../../../../play/play/api/mvc/WebSocket.scala.html#play.api.mvc;WebSocket.outFormatter" title="=&gt; play.api.mvc.WebSocket.FrameFormatter[Any]">outFormatter</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>.<span title="(pf: PartialFunction[Throwable,Any])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[Any]">recover</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Throwable,scala.concurrent.Future[Unit]] with Serializable" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
              <span class="keyword">case</span> <a title="Throwable" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived;$anonfun.isDefinedAt.error">error</a> =&gt;
                <span title="play.api.Application">app</span>.<a href="../../../../../play/play/api/Application.scala.html#play.api;Application.errorHandler" title="=&gt; play.api.http.HttpErrorHandler">errorHandler</a>.<a href="../../../../../play/play/api/http/HttpErrorHandler.scala.html#play.api.http;HttpErrorHandler.onServerError" title="(request: play.api.mvc.RequestHeader, exception: Throwable)scala.concurrent.Future[play.api.mvc.Result]">onServerError</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader" title="play.api.mvc.RequestHeader">requestHeader</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived;$anonfun.isDefinedAt.error" title="Throwable">error</a><span class="delimiter">)</span>.<span title="(f: play.api.mvc.Result =&gt; Unit)(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[Unit]">map</span> <a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">{</a> <a title="play.api.mvc.Result" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived;$anonfun.applyOrElse.$anonfun.result">result</a> =&gt;
                  <span class="keyword">val</span> <a title="play.api.mvc.EssentialAction" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived;$anonfun.applyOrElse.$anonfun.a">a</a> = <a href="../../../../../play/play/api/mvc/Action.scala.html#play.api.mvc.EssentialAction.apply" title="(f: play.api.mvc.RequestHeader =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result])play.api.mvc.EssentialAction">EssentialAction</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived;$anonfun.applyOrElse.$anonfun.a.$anonfun.x$8">_</a> =&gt; <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Done.apply" title="(a: play.api.mvc.Result, e: play.api.libs.iteratee.Input[Array[Byte]])play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">Done</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived;$anonfun.applyOrElse.$anonfun.result" title="play.api.mvc.Result">result</a>, <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input.Empty" title="play.api.libs.iteratee.Input.Empty.type">Empty</a><span class="delimiter">)</span><span class="delimiter">)</span>
                  <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction" title="(action: play.api.mvc.EssentialAction, app: Option[play.api.Application])Unit">handleAction</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived;$anonfun.applyOrElse.$anonfun.a" title="play.api.mvc.EssentialAction">a</a>, <span title="(x: play.api.Application)Some[play.api.Application]">Some</span><span class="delimiter">(</span><span title="play.api.Application">app</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
            <span class="delimiter">}</span>

          <span class="comment">//handle bad websocket request</span>
          <span class="keyword">case</span> Right<span class="delimiter">(</span><span class="delimiter">(</span>WebSocket<span class="delimiter">(</span>_<span class="delimiter">)</span>, <span title="play.api.Application">app</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.trace(83d3728a3c)" title="(message: =&gt; String)Unit">trace</a><span class="delimiter">(</span><span title="String(&quot;Bad websocket request&quot;)" class="string">&quot;Bad websocket request&quot;</span><span class="delimiter">)</span>
            <span class="keyword">val</span> <span title="play.api.mvc.EssentialAction">a</span> = <a href="../../../../../play/play/api/mvc/Action.scala.html#play.api.mvc.EssentialAction.apply" title="(f: play.api.mvc.RequestHeader =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result])play.api.mvc.EssentialAction">EssentialAction</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun.x$9">_</a> =&gt; <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Done.apply" title="(a: play.api.mvc.Results.Status, e: play.api.libs.iteratee.Input[Array[Byte]])play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Results.Status]">Done</a><span class="delimiter">(</span><a href="../../../../../play/play/api/mvc/Results.scala.html#play.api.mvc.Results" title="play.api.mvc.Results.type">Results</a>.<a href="../../../../../play/play/api/mvc/Results.scala.html#play.api.mvc;Results.BadRequest" title="=&gt; play.api.mvc.Results.Status">BadRequest</a>, <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input.Empty" title="play.api.libs.iteratee.Input.Empty.type">Empty</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction" title="(action: play.api.mvc.EssentialAction, app: Option[play.api.Application])Unit">handleAction</a><span class="delimiter">(</span><span title="play.api.mvc.EssentialAction">a</span>, <span title="(x: play.api.Application)Some[play.api.Application]">Some</span><span class="delimiter">(</span><span title="play.api.Application">app</span><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> Left<span class="delimiter">(</span><span title="scala.concurrent.Future[play.api.mvc.Result]">e</span><span class="delimiter">)</span> =&gt;
            <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.trace(83d3728a3c)" title="(message: =&gt; String)Unit">trace</a><span class="delimiter">(</span><span title="String(&quot;No handler, got direct result: &quot;)" class="string">&quot;No handler, got direct result: &quot;</span> <span title="(x$1: Any)String">+</span> <span title="scala.concurrent.Future[play.api.mvc.Result]">e</span><span class="delimiter">)</span>
            <span class="keyword">import</span> play.api.libs.iteratee.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution" title="play.api.libs.iteratee.Execution.type">Execution</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits" title="play.api.libs.iteratee.Execution.Implicits.type">Implicits</a>.trampoline
            <span class="keyword">val</span> <span title="play.api.mvc.EssentialAction">a</span> = <a href="../../../../../play/play/api/mvc/Action.scala.html#play.api.mvc.EssentialAction.apply" title="(f: play.api.mvc.RequestHeader =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result])play.api.mvc.EssentialAction">EssentialAction</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun.x$10">_</a> =&gt; <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee" title="play.api.libs.iteratee.Iteratee.type">Iteratee</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee.flatten" title="(i: scala.concurrent.Future[play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]])play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">flatten</a><span class="delimiter">(</span><span title="scala.concurrent.Future[play.api.mvc.Result]">e</span>.<span title="(f: play.api.mvc.Result =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]]">map</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">(</a><a title="play.api.mvc.Result" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun.$anonfun.result">result</a> =&gt; <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Done.apply" title="(a: play.api.mvc.Result, e: play.api.libs.iteratee.Input[Array[Byte]])play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">Done</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.a.$anonfun.$anonfun.result" title="play.api.mvc.Result">result</a>, <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input.Empty" title="play.api.libs.iteratee.Input.Empty.type">Empty</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction" title="(action: play.api.mvc.EssentialAction, app: Option[play.api.Application])Unit">handleAction</a><span class="delimiter">(</span><span title="play.api.mvc.EssentialAction">a</span>, <span title="None.type">None</span><span class="delimiter">)</span>

        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="(action: play.api.mvc.EssentialAction, app: Option[play.api.Application])Unit" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction">handleAction</a><span class="delimiter">(</span><a title="play.api.mvc.EssentialAction" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.action">action</a>: <a href="../../../../../play/play/api/mvc/Action.scala.html#play.api.mvc;EssentialAction" title="play.api.mvc.EssentialAction">EssentialAction</a>, <a title="Option[play.api.Application]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.app">app</a>: <span title="Option[play.api.Application]">Option</span><span class="delimiter">[</span>Application<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.trace(83d3728a3c)" title="(message: =&gt; String)Unit">trace</a><span class="delimiter">(</span><span title="String(&quot;Serving this request with: &quot;)" class="string">&quot;Serving this request with: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.action" title="play.api.mvc.EssentialAction">action</a><span class="delimiter">)</span>

          <span class="keyword">val</span> <a title="play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.bodyParser">bodyParser</a> = <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee" title="play.api.libs.iteratee.Iteratee.type">Iteratee</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee.flatten" title="(i: scala.concurrent.Future[play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]])play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">flatten</a><span class="delimiter">(</span>
            scala.concurrent.<span title="(body: =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result])(implicit execctx: scala.concurrent.ExecutionContext)scala.concurrent.Future[play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]]">Future</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.action" title="(v1: play.api.mvc.RequestHeader)play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">action</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader" title="play.api.mvc.RequestHeader">requestHeader</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span>play.api.libs.concurrent.<a href="../../../../../play/play/api/libs/concurrent/Execution.scala.html#play.api.libs.concurrent.Execution" title="play.api.libs.concurrent.Execution.type">Execution</a>.<a href="../../../../../play/play/api/libs/concurrent/Execution.scala.html#play.api.libs.concurrent.Execution.defaultContext" title="=&gt; scala.concurrent.ExecutionContext">defaultContext</a><span class="delimiter">)</span>
          <span class="delimiter">)</span>

          <span class="keyword">import</span> play.api.libs.iteratee.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution" title="play.api.libs.iteratee.Execution.type">Execution</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits" title="play.api.libs.iteratee.Execution.Implicits.type">Implicits</a>.trampoline

          <span class="keyword">val</span> <a title="Option[_]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.expectContinue">expectContinue</a>: <span title="Option[_]">Option</span><span class="delimiter">[</span>_<span class="delimiter">]</span> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader" title="play.api.mvc.RequestHeader">requestHeader</a>.<a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader.headers" title="=&gt; play.api.mvc.Headers">headers</a>.<a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers.get" title="(key: String)Option[String]">get</a><span class="delimiter">(</span><span title="String(&quot;Expect&quot;)" class="string">&quot;Expect&quot;</span><span class="delimiter">)</span>.<span title="(p: String =&gt; Boolean)Option[String]">filter</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.expectContinue.$anonfun.x$11" title="String">_</a>.<span title="(x$1: String)Boolean">equalsIgnoreCase</span><span class="delimiter">(</span><span title="String(&quot;100-continue&quot;)" class="string">&quot;100-continue&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="comment">// Regardless of whether the client is expecting 100 continue or not, we need to feed the body here in the</span>
          <span class="comment">// Netty thread, so that the handler is replaced in this thread, so that if the client does start sending</span>
          <span class="comment">// body chunks (which it might according to the HTTP spec if we're slow to respond), we can handle them.</span>

          <span class="keyword">val</span> <a title="scala.concurrent.Future[play.api.mvc.Result]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult">eventuallyResult</a>: <span title="scala.concurrent.Future[play.api.mvc.Result]">Future</span><span class="delimiter">[</span>Result<span class="delimiter">]</span> = <span title="scala.concurrent.Future[play.api.mvc.Result]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyHttpRequest</a>.<span title="()Boolean">isChunked</span><span class="delimiter">)</span> <span class="delimiter">{</span>

            <span class="keyword">val</span> <a title="org.jboss.netty.channel.ChannelPipeline" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.pipeline">pipeline</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()org.jboss.netty.channel.ChannelPipeline">getPipeline</span>
            <span class="keyword">val</span> <a title="scala.concurrent.Future[play.api.mvc.Result]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.result">result</a> = <a href="RequestBodyHandler.scala.html#play.core.server.netty;RequestBodyHandler.newRequestBodyUpstreamHandler" title="(bodyHandler: play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result], replaceHandler: org.jboss.netty.channel.ChannelUpstreamHandler =&gt; Unit, handlerFinished: =&gt; Unit)scala.concurrent.Future[play.api.mvc.Result]">newRequestBodyUpstreamHandler</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.bodyParser" title="play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">bodyParser</a>, <span class="delimiter">{</span> <a title="org.jboss.netty.channel.ChannelUpstreamHandler" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.result.$anonfun.handler">handler</a> =&gt;
              <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.pipeline" title="org.jboss.netty.channel.ChannelPipeline">pipeline</a>.<span title="(x$1: String, x$2: String, x$3: org.jboss.netty.channel.ChannelHandler)org.jboss.netty.channel.ChannelHandler">replace</span><span title="Unit" class="delimiter">(</span><span title="String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <span title="String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.result.$anonfun.handler" title="org.jboss.netty.channel.ChannelUpstreamHandler">handler</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>, <span class="delimiter">{</span>
              <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.pipeline" title="org.jboss.netty.channel.ChannelPipeline">pipeline</a>.<span title="(x$1: String, x$2: String, x$3: org.jboss.netty.channel.ChannelHandler)org.jboss.netty.channel.ChannelHandler">replace</span><span title="Unit" class="delimiter">(</span><span title="String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <span title="String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler" title="play.core.server.netty.PlayDefaultUpstreamHandler" class="keyword">this</a><span class="delimiter">)</span>
            <span class="delimiter">}</span><span class="delimiter">)</span>

            <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.result" title="scala.concurrent.Future[play.api.mvc.Result]">result</a>

          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

            <span class="keyword">val</span> <a title="play.api.libs.iteratee.Enumerator[Array[Byte]]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.bodyEnumerator">bodyEnumerator</a> = <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="Array[Byte]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.bodyEnumerator.body">body</a> = <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="org.jboss.netty.buffer.ChannelBuffer" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.bodyEnumerator.body.cBuffer">cBuffer</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyHttpRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyHttpRequest</a>.<span title="()org.jboss.netty.buffer.ChannelBuffer">getContent</span>
                <span class="keyword">val</span> <a title="Array[Byte]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.bodyEnumerator.body.bytes">bytes</a> = <span title="Array[Byte]" class="keyword">new</span> <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.bodyEnumerator.body.cBuffer" title="org.jboss.netty.buffer.ChannelBuffer">cBuffer</a>.<span title="()Int">readableBytes</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.bodyEnumerator.body.cBuffer" title="org.jboss.netty.buffer.ChannelBuffer">cBuffer</a>.<span title="(x$1: Array[Byte])Unit">readBytes</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.bodyEnumerator.body.bytes" title="Array[Byte]">bytes</a><span class="delimiter">)</span>
                <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.bodyEnumerator.body.bytes" title="Array[Byte]">bytes</a>
              <span class="delimiter">}</span>
              <a href="../../../../../play-iteratees/play/api/libs/iteratee/Enumerator.scala.html#play.api.libs.iteratee.Enumerator.apply" title="(in: Array[Byte]*)play.api.libs.iteratee.Enumerator[Array[Byte]]">Enumerator</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.bodyEnumerator.body" title="Array[Byte]">body</a><span class="delimiter">)</span>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Enumerator.scala.html#play.api.libs.iteratee;Enumerator.andThen" title="(e: play.api.libs.iteratee.Enumerator[Array[Byte]])play.api.libs.iteratee.Enumerator[Array[Byte]]">andThen</a><span class="delimiter">(</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Enumerator.scala.html#play.api.libs.iteratee.Enumerator" title="play.api.libs.iteratee.Enumerator.type">Enumerator</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Enumerator.scala.html#play.api.libs.iteratee.Enumerator.enumInput" title="(e: play.api.libs.iteratee.Input[Array[Byte]])play.api.libs.iteratee.Enumerator[Array[Byte]]">enumInput</a><span class="delimiter">(</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input.EOF" title="play.api.libs.iteratee.Input.EOF.type">EOF</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>

            <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult.bodyEnumerator" title="play.api.libs.iteratee.Enumerator[Array[Byte]]">bodyEnumerator</a> <a href="../../../../../play-iteratees/play/api/libs/iteratee/Enumerator.scala.html#play.api.libs.iteratee;Enumerator.|>>>" title="(i: play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result])scala.concurrent.Future[play.api.mvc.Result]">|&gt;&gt;&gt;</a> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.bodyParser" title="play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">bodyParser</a>
          <span class="delimiter">}</span>

          <span class="comment">// An iteratee containing the result and the sequence number.</span>
          <span class="comment">// Sequence number will be 1 if a 100 continue response has been sent, otherwise 0.</span>
          <span class="keyword">val</span> <a title="scala.concurrent.Future[(play.api.mvc.Result, Int)]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence">eventuallyResultWithSequence</a>: <span title="scala.concurrent.Future[(play.api.mvc.Result, Int)]">Future</span><span class="delimiter">[</span><span class="delimiter">(</span>Result, Int<span class="delimiter">)</span><span class="delimiter">]</span> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.expectContinue" title="Option[_]">expectContinue</a> <span title="scala.concurrent.Future[(play.api.mvc.Result, Int)]" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> Some<span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
              <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.bodyParser" title="play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]">bodyParser</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee;Iteratee.unflatten" title="=&gt; scala.concurrent.Future[play.api.libs.iteratee.Step[Array[Byte],play.api.mvc.Result]]">unflatten</a>.<span title="(f: play.api.libs.iteratee.Step[Array[Byte],play.api.mvc.Result] =&gt; scala.concurrent.Future[(play.api.mvc.Result, Int)])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[(play.api.mvc.Result, Int)]">flatMap</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.x0$2" title="scala.concurrent.Future[(play.api.mvc.Result, Int)]" class="delimiter">{</a>
                <span class="keyword">case</span> Step.Cont<span class="delimiter">(</span><a title="play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],play.api.mvc.Result]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.k">k</a><span class="delimiter">)</span> =&gt;
                  <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream" title="(subSequence: Int, last: Boolean, message: Object)(implicit ctx: org.jboss.netty.channel.ChannelHandlerContext, implicit oue: com.typesafe.netty.http.pipelining.OrderedUpstreamMessageEvent)org.jboss.netty.channel.ChannelFuture">sendDownstream</a><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.msgCtx" title="org.jboss.netty.channel.ChannelHandlerContext" class="delimiter">(</a><span title="Int(0)" class="int">0</span>, <span title="Boolean(false)" class="keyword">false</span>, <span title="org.jboss.netty.handler.codec.http.DefaultHttpResponse" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.DefaultHttpResponse">DefaultHttpResponse</span><span class="delimiter">(</span><span title="org.jboss.netty.handler.codec.http.HttpVersion.type">HttpVersion</span>.<span title="org.jboss.netty.handler.codec.http.HttpVersion">HTTP_1_1</span>, <span title="org.jboss.netty.handler.codec.http.HttpResponseStatus.type">HttpResponseStatus</span>.<span title="org.jboss.netty.handler.codec.http.HttpResponseStatus">CONTINUE</span><span class="delimiter">)</span><span class="delimiter">)</span>
                  <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult" title="scala.concurrent.Future[play.api.mvc.Result]">eventuallyResult</a>.<span title="(f: play.api.mvc.Result =&gt; (play.api.mvc.Result, Int))(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[(play.api.mvc.Result, Int)]">map</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">(</a><span title="(_1: play.api.mvc.Result, _2: Int)(play.api.mvc.Result, Int)" class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.$anonfun.x$12" title="play.api.mvc.Result">_</a>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="keyword">case</span> Step.Done<span class="delimiter">(</span><span title="play.api.mvc.Result">result</span>, _<span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
                  <span class="comment">// Return the result immediately, and ensure that the connection is set to close</span>
                  <span class="comment">// Connection must be set to close because whatever comes next in the stream is either the request</span>
                  <span class="comment">// body, because the client waited too long for our response, or the next request, and there's no way</span>
                  <span class="comment">// for us to know which.  See RFC2616 Section 8.2.3.</span>
                  <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: (play.api.mvc.Result, Int))scala.concurrent.Future[(play.api.mvc.Result, Int)]">successful</span><span class="delimiter">(</span><span title="(_1: play.api.mvc.Result, _2: Int)(play.api.mvc.Result, Int)" class="delimiter">(</span><span title="play.api.mvc.Result">result</span>.<a href="../../../../../play/play/api/mvc/Results.scala.html#play.api.mvc;Result.copy$default$1" title="play.api.mvc.ResponseHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.x$20">copy</a><span class="delimiter">(</span>connection = <a href="../../../../../play/play/api/mvc/Results.scala.html#play.api.mvc.HttpConnection" title="play.api.mvc.HttpConnection.type">HttpConnection</a>.<a href="../../../../../play/play/api/mvc/Results.scala.html#play.api.mvc.HttpConnection.Close" title="play.api.mvc.HttpConnection.Value" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.x$18">Close</a><span class="delimiter">)</span>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
                <span class="keyword">case</span> Step.Error<span class="delimiter">(</span><a title="String" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.msg">msg</a>, _<span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
                  <span title="org.jboss.netty.channel.MessageEvent">e</span>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Boolean)org.jboss.netty.channel.ChannelFuture">setReadable</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
                  <span class="keyword">val</span> <a title="RuntimeException" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.error">error</a> = <span title="(x$1: String)RuntimeException" class="keyword">new</span> <span title="RuntimeException">RuntimeException</span><span class="delimiter">(</span><span title="String(&quot;Body parser iteratee in error: &quot;)" class="string">&quot;Body parser iteratee in error: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.msg" title="String">msg</a><span class="delimiter">)</span>
                  <span class="keyword">val</span> <span title="scala.concurrent.Future[play.api.mvc.Result]">result</span> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.errorHandler" title="(app: Option[play.api.Application])play.api.http.HttpErrorHandler">errorHandler</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.app" title="Option[play.api.Application]">app</a><span class="delimiter">)</span>.<a href="../../../../../play/play/api/http/HttpErrorHandler.scala.html#play.api.http;HttpErrorHandler.onServerError" title="(request: play.api.mvc.RequestHeader, exception: Throwable)scala.concurrent.Future[play.api.mvc.Result]">onServerError</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader" title="play.api.mvc.RequestHeader">requestHeader</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.error" title="RuntimeException">error</a><span class="delimiter">)</span>
                  <span title="scala.concurrent.Future[play.api.mvc.Result]">result</span>.<span title="(f: play.api.mvc.Result =&gt; (play.api.mvc.Result, Int))(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[(play.api.mvc.Result, Int)]">map</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">(</a><a title="play.api.mvc.Result" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.$anonfun.r">r</a> =&gt; <span title="(_1: play.api.mvc.Result, _2: Int)(play.api.mvc.Result, Int)" class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.$anonfun.r" title="play.api.mvc.Result">r</a>.<a href="../../../../../play/play/api/mvc/Results.scala.html#play.api.mvc;Result.copy$default$1" title="play.api.mvc.ResponseHeader" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.$anonfun.x$23">copy</a><span class="delimiter">(</span>connection = <a href="../../../../../play/play/api/mvc/Results.scala.html#play.api.mvc.HttpConnection" title="play.api.mvc.HttpConnection.type">HttpConnection</a>.<a href="../../../../../play/play/api/mvc/Results.scala.html#play.api.mvc.HttpConnection.Close" title="play.api.mvc.HttpConnection.Value" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.$anonfun.x$21">Close</a><span class="delimiter">)</span>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
            <span class="keyword">case</span> <span title="None.type">None</span> =&gt; <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResult" title="scala.concurrent.Future[play.api.mvc.Result]">eventuallyResult</a>.<span title="(f: play.api.mvc.Result =&gt; (play.api.mvc.Result, Int))(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[(play.api.mvc.Result, Int)]">map</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">(</a><span title="(_1: play.api.mvc.Result, _2: Int)(play.api.mvc.Result, Int)" class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence.$anonfun.x$13" title="play.api.mvc.Result">_</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="scala.concurrent.Future[Any]" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent">sent</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.eventuallyResultWithSequence" title="scala.concurrent.Future[(play.api.mvc.Result, Int)]">eventuallyResultWithSequence</a>.<span title="(pf: PartialFunction[Throwable,scala.concurrent.Future[(play.api.mvc.Result, Int)]])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[(play.api.mvc.Result, Int)]">recoverWith</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Throwable,scala.concurrent.Future[(play.api.mvc.Result, Int)]] with Serializable" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
            <span class="keyword">case</span> <a title="Throwable" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent;$anonfun.isDefinedAt.error">error</a> =&gt;
              <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.error(804ef4765b)" title="(message: =&gt; String, error: =&gt; Throwable)Unit">error</a><span class="delimiter">(</span><span title="String(&quot;Cannot invoke the action&quot;)" class="string">&quot;Cannot invoke the action&quot;</span>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent;$anonfun.isDefinedAt.error" title="Throwable">error</a><span class="delimiter">)</span>
              <span title="org.jboss.netty.channel.MessageEvent">e</span>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Boolean)org.jboss.netty.channel.ChannelFuture">setReadable</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
              <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.errorHandler" title="(app: Option[play.api.Application])play.api.http.HttpErrorHandler">errorHandler</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.app" title="Option[play.api.Application]">app</a><span class="delimiter">)</span>.<a href="../../../../../play/play/api/http/HttpErrorHandler.scala.html#play.api.http;HttpErrorHandler.onServerError" title="(request: play.api.mvc.RequestHeader, exception: Throwable)scala.concurrent.Future[play.api.mvc.Result]">onServerError</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader" title="play.api.mvc.RequestHeader">requestHeader</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent;$anonfun.isDefinedAt.error" title="Throwable">error</a><span class="delimiter">)</span>
                .<span title="(f: play.api.mvc.Result =&gt; (play.api.mvc.Result, Int))(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[(play.api.mvc.Result, Int)]">map</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">(</a><span title="(_1: play.api.mvc.Result, _2: Int)(play.api.mvc.Result, Int)" class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent;$anonfun.applyOrElse.$anonfun.x$14" title="play.api.mvc.Result">_</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>.<span title="(f: ((play.api.mvc.Result, Int)) =&gt; scala.concurrent.Future[Any])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[Any]">flatMap</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent.$anonfun.x0$3" title="scala.concurrent.Future[Any]" class="delimiter">{</a>
            <span class="keyword">case</span> <span class="delimiter">(</span><a title="play.api.mvc.Result" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent.$anonfun.result">result</a>, <a title="Int" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent.$anonfun.sequence">sequence</a><span class="delimiter">)</span> =&gt;
              <span class="keyword">val</span> <a title="play.api.mvc.Result" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent.$anonfun.cleanedResult">cleanedResult</a> = <a href="../../../../../play-server/play/core/server/common/ServerResultUtils.scala.html#play.core.server.common.ServerResultUtils" title="play.core.server.common.ServerResultUtils.type">ServerResultUtils</a>.<a href="../../../../../play-server/play/core/server/common/ServerResultUtils.scala.html#play.core.server.common.ServerResultUtils.cleanFlashCookie" title="(requestHeader: play.api.mvc.RequestHeader, result: play.api.mvc.Result)play.api.mvc.Result">cleanFlashCookie</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader" title="play.api.mvc.RequestHeader">requestHeader</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent.$anonfun.result" title="play.api.mvc.Result">result</a><span class="delimiter">)</span>
              <a href="NettyResultStreamer.scala.html#play.core.server.netty.NettyResultStreamer" title="play.core.server.netty.NettyResultStreamer.type">NettyResultStreamer</a>.<a href="NettyResultStreamer.scala.html#play.core.server.netty.NettyResultStreamer.sendResult" title="(requestHeader: play.api.mvc.RequestHeader, result: play.api.mvc.Result, httpVersion: org.jboss.netty.handler.codec.http.HttpVersion, startSequence: Int)(implicit ctx: org.jboss.netty.channel.ChannelHandlerContext, implicit oue: com.typesafe.netty.http.pipelining.OrderedUpstreamMessageEvent)scala.concurrent.Future[_]">sendResult</a><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.msgCtx" title="org.jboss.netty.channel.ChannelHandlerContext" class="delimiter">(</a><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.requestHeader" title="play.api.mvc.RequestHeader">requestHeader</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent.$anonfun.cleanedResult" title="play.api.mvc.Result">cleanedResult</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.nettyVersion" title="org.jboss.netty.handler.codec.http.HttpVersion">nettyVersion</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.handleAction.sent.$anonfun.sequence" title="Int">sequence</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span title="Unit" class="delimiter">}</span>

      <span class="keyword">case</span> <a title="Object" id="play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.unexpected">unexpected</a> =&gt; <a href="#play.core.server.netty.PlayDefaultUpstreamHandler.logger" title="=&gt; play.api.Logger">logger</a>.<a href="../../../../../play/play/api/Logger.scala.html#play.api;LoggerLike.error(83d3728a3c)" title="(message: =&gt; String)Unit">error</a><span class="delimiter">(</span><span title="String(&quot;Oops, unexpected message received in NettyServer (please report this problem): &quot;)" class="string">&quot;Oops, unexpected message received in NettyServer (please report this problem): &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.messageReceived.unexpected" title="Object">unexpected</a><span class="delimiter">)</span>

    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(app: Option[play.api.Application])play.api.http.HttpErrorHandler" id="play.core.server.netty;PlayDefaultUpstreamHandler.errorHandler">errorHandler</a><span class="delimiter">(</span><a title="Option[play.api.Application]" id="play.core.server.netty;PlayDefaultUpstreamHandler.errorHandler.app">app</a>: <span title="Option[play.api.Application]">Option</span><span class="delimiter">[</span>Application<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.errorHandler.app" title="Option[play.api.Application]">app</a>.<span title="[B](ifEmpty: =&gt; B)(f: play.api.Application =&gt; B)B">fold</span><span title="(ifEmpty: =&gt; play.api.http.HttpErrorHandler)(f: play.api.Application =&gt; play.api.http.HttpErrorHandler)play.api.http.HttpErrorHandler" class="delimiter">[</span><a href="../../../../../play/play/api/http/HttpErrorHandler.scala.html#play.api.http;HttpErrorHandler" title="play.api.http.HttpErrorHandler">HttpErrorHandler</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="../../../../../play/play/api/http/HttpErrorHandler.scala.html#play.api.http.DefaultHttpErrorHandler" title="play.api.http.DefaultHttpErrorHandler.type">DefaultHttpErrorHandler</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.errorHandler.$anonfun.x$15" title="play.api.Application">_</a>.<a href="../../../../../play/play/api/Application.scala.html#play.api;Application.errorHandler" title="=&gt; play.api.http.HttpErrorHandler">errorHandler</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[A](ctx: org.jboss.netty.channel.ChannelHandlerContext)(frameFormatter: play.api.mvc.WebSocket.FrameFormatter[A])play.api.libs.iteratee.Iteratee[A,Unit]" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut">socketOut</a><span class="delimiter">[</span><a title="" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut;A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.ctx">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="play.api.mvc.WebSocket.FrameFormatter[A]" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.frameFormatter">frameFormatter</a>: play.api.mvc.WebSocket.<a href="../../../../../play/play/api/mvc/WebSocket.scala.html#play.api.mvc.WebSocket;FrameFormatter" title="play.api.mvc.WebSocket.FrameFormatter[A]">FrameFormatter</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee;Iteratee" title="play.api.libs.iteratee.Iteratee[A,Unit]">Iteratee</a><span class="delimiter">[</span>A, Unit<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> play.api.libs.iteratee.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution" title="play.api.libs.iteratee.Execution.type">Execution</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits" title="play.api.libs.iteratee.Execution.Implicits.type">Implicits</a>.trampoline

    <span class="keyword">val</span> <a title="org.jboss.netty.channel.Channel" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.channel">channel</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>
    <span class="keyword">val</span> <a title="play.core.websocket.BasicFrameFormatter[A]" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.basicFrameFormatter">basicFrameFormatter</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.frameFormatter" title="play.api.mvc.WebSocket.FrameFormatter[A]">frameFormatter</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="play.core.websocket.BasicFrameFormatter[A]" class="delimiter">[</span><a href="../../../../../play/play/core/websocket/BasicFrameFormatter.scala.html#play.core.websocket;BasicFrameFormatter" title="play.core.websocket.BasicFrameFormatter[A]">BasicFrameFormatter</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>

    <span class="keyword">import</span> <a href="NettyFuture.scala.html#play.core.server.netty.NettyFuture" title="play.core.server.netty.NettyFuture.type">NettyFuture</a>._

    <span class="keyword">def</span> <a title="=&gt; play.api.libs.iteratee.Iteratee[A, _]" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee">iteratee</a>: <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee;Iteratee" title="play.api.libs.iteratee.Iteratee[A, _]">Iteratee</a><span class="delimiter">[</span>A, _<span class="delimiter">]</span> = <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Cont.apply" title="(k: play.api.libs.iteratee.Input[A] =&gt; play.api.libs.iteratee.Iteratee[A,Any])play.api.libs.iteratee.Iteratee[A,Any]">Cont</a> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.x0$4" title="play.api.libs.iteratee.Iteratee[A,Any]" class="delimiter">{</a>
      <span class="keyword">case</span> El<span class="delimiter">(</span><span title="A">e</span><span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="play.core.websocket.BasicFrame" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.basicFrame">basicFrame</a>: <a href="../../../../../play/play/core/websocket/BasicFrame.scala.html#play.core.websocket;BasicFrame" title="play.core.websocket.BasicFrame">BasicFrame</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.basicFrameFormatter" title="play.core.websocket.BasicFrameFormatter[A]">basicFrameFormatter</a>.<a href="../../../../../play/play/core/websocket/BasicFrameFormatter.scala.html#play.core.websocket;BasicFrameFormatter.toFrame" title="(value: A)play.core.websocket.BasicFrame">toFrame</a><span class="delimiter">(</span><span title="A">e</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.nettyFrame">nettyFrame</a>: <span title="org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame">WebSocketFrame</span> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.basicFrame" title="play.core.websocket.BasicFrame">basicFrame</a> <span title="org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> TextFrame<span class="delimiter">(</span><a title="String" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.nettyFrame.text">text</a><span class="delimiter">)</span> =&gt; <span title="(x$1: Boolean, x$2: Int, x$3: String)org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame">TextWebSocketFrame</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="Int(0)" class="int">0</span>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.nettyFrame.text" title="String">text</a><span class="delimiter">)</span>
          <span class="keyword">case</span> BinaryFrame<span class="delimiter">(</span><a title="Array[Byte]" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.nettyFrame.bytes">bytes</a><span class="delimiter">)</span> =&gt; <span title="(x$1: Boolean, x$2: Int, x$3: org.jboss.netty.buffer.ChannelBuffer)org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame">BinaryWebSocketFrame</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="Int(0)" class="int">0</span>, <span title="org.jboss.netty.buffer.ChannelBuffers.type">ChannelBuffers</span>.<span title="(x$1: Array[Byte])org.jboss.netty.buffer.ChannelBuffer">wrappedBuffer</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.nettyFrame.bytes" title="Array[Byte]">bytes</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee" title="play.api.libs.iteratee.Iteratee.type">Iteratee</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee.flatten" title="(i: scala.concurrent.Future[play.api.libs.iteratee.Iteratee[A,Any]])play.api.libs.iteratee.Iteratee[A,Any]">flatten</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.channel" title="org.jboss.netty.channel.Channel">channel</a>.<span title="(x$1: Any)org.jboss.netty.channel.ChannelFuture">write</span><a href="NettyFuture.scala.html#play.core.server.netty.NettyFuture.ToScala" title="implicit play.core.server.netty.NettyFuture.ToScala : (channelFuture: org.jboss.netty.channel.ChannelFuture)play.core.server.netty.NettyFuture.ToScala" class="delimiter">(</a><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.nettyFrame" title="org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame">nettyFrame</a><span class="delimiter">)</span>.<a href="NettyFuture.scala.html#play.core.server.netty.NettyFuture;ToScala.toScala" title="=&gt; scala.concurrent.Future[org.jboss.netty.channel.Channel]">toScala</a>.<span title="(f: org.jboss.netty.channel.Channel =&gt; play.api.libs.iteratee.Iteratee[A,Any])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[play.api.libs.iteratee.Iteratee[A,Any]]">map</span><a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">(</a><a title="org.jboss.netty.channel.Channel" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.$anonfun.x$16">_</a> =&gt; <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee" title="=&gt; play.api.libs.iteratee.Iteratee[A, _]">iteratee</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="play.api.libs.iteratee.Input.EOF.type">e</span> @ <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input.EOF" title="play.api.libs.iteratee.Input.EOF.type">EOF</a> =&gt;
        <span title="play.api.libs.iteratee.Iteratee[A,Unit]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.channel" title="org.jboss.netty.channel.Channel">channel</a>.<span title="()Boolean">isOpen</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee" title="play.api.libs.iteratee.Iteratee.type">Iteratee</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee.flatten" title="(i: scala.concurrent.Future[play.api.libs.iteratee.Iteratee[A,Unit]])play.api.libs.iteratee.Iteratee[A,Unit]">flatten</a><span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">{</span>
            <a title="org.jboss.netty.channel.Channel" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.$anonfun._">_</a> &lt;- <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.channel" title="org.jboss.netty.channel.Channel">channel</a>.<span title="(x$1: Any)org.jboss.netty.channel.ChannelFuture">write</span><a href="NettyFuture.scala.html#play.core.server.netty.NettyFuture.ToScala" title="implicit play.core.server.netty.NettyFuture.ToScala : (channelFuture: org.jboss.netty.channel.ChannelFuture)play.core.server.netty.NettyFuture.ToScala" class="delimiter">(</a><span title="(x$1: Int, x$2: String)org.jboss.netty.handler.codec.http.websocketx.CloseWebSocketFrame" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.websocketx.CloseWebSocketFrame">CloseWebSocketFrame</span><span class="delimiter">(</span><a href="WebSocketHandler.scala.html#play.core.server.netty;WebSocketHandler.WebSocketNormalClose" title="=&gt; Int">WebSocketNormalClose</a>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="NettyFuture.scala.html#play.core.server.netty.NettyFuture;ToScala.toScala" title="(f: org.jboss.netty.channel.Channel =&gt; scala.concurrent.Future[play.api.libs.iteratee.Iteratee[A,Unit]])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[play.api.libs.iteratee.Iteratee[A,Unit]]">toScala</a>
            <a title="org.jboss.netty.channel.Channel" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee.$anonfun.$anonfun.$anonfun._">_</a> &lt;- <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.channel" title="org.jboss.netty.channel.Channel">channel</a>.<span title="()org.jboss.netty.channel.ChannelFuture">close</span><a href="NettyFuture.scala.html#play.core.server.netty.NettyFuture.ToScala" title="implicit play.core.server.netty.NettyFuture.ToScala : (channelFuture: org.jboss.netty.channel.ChannelFuture)play.core.server.netty.NettyFuture.ToScala" class="delimiter">(</a><span class="delimiter">)</span>.<a href="NettyFuture.scala.html#play.core.server.netty.NettyFuture;ToScala.toScala" title="(f: org.jboss.netty.channel.Channel =&gt; play.api.libs.iteratee.Iteratee[A,Unit])(implicit executor: scala.concurrent.ExecutionContext)scala.concurrent.Future[play.api.libs.iteratee.Iteratee[A,Unit]]">toScala</a>
          <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Done.apply" title="(a: Unit, e: play.api.libs.iteratee.Input[A])play.api.libs.iteratee.Iteratee[A,Unit]">Done</a><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>, <span title="play.api.libs.iteratee.Input.EOF.type">e</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Done.apply" title="(a: Unit, e: play.api.libs.iteratee.Input[A])play.api.libs.iteratee.Iteratee[A,Unit]">Done</a><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>, <span title="play.api.libs.iteratee.Input.EOF.type">e</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input.Empty" title="play.api.libs.iteratee.Input.Empty.type">Empty</a> =&gt; <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee" title="=&gt; play.api.libs.iteratee.Iteratee[A, _]">iteratee</a>
    <span class="delimiter">}</span>

    <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.iteratee" title="=&gt; play.api.libs.iteratee.Iteratee[A, _]">iteratee</a>.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee;Iteratee.map" title="(f: _$2 =&gt; Unit)(implicit ec: scala.concurrent.ExecutionContext)play.api.libs.iteratee.Iteratee[A,Unit]">map</a><a href="../../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.Implicits.trampoline" title="=&gt; scala.concurrent.ExecutionContext" class="delimiter">(</a><a title="_$2" id="play.core.server.netty;PlayDefaultUpstreamHandler.socketOut.$anonfun.x$17">_</a> =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(nettyRequest: org.jboss.netty.handler.codec.http.HttpRequest)play.api.mvc.Headers" id="play.core.server.netty;PlayDefaultUpstreamHandler.getHeaders">getHeaders</a><span class="delimiter">(</span><a title="org.jboss.netty.handler.codec.http.HttpRequest" id="play.core.server.netty;PlayDefaultUpstreamHandler.getHeaders.nettyRequest">nettyRequest</a>: <span title="org.jboss.netty.handler.codec.http.HttpRequest">HttpRequest</span><span class="delimiter">)</span>: <a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers" title="play.api.mvc.Headers">Headers</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.Buffer[(String, String)]" id="play.core.server.netty;PlayDefaultUpstreamHandler.getHeaders.pairs">pairs</a> = <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.getHeaders.nettyRequest" title="org.jboss.netty.handler.codec.http.HttpRequest">nettyRequest</a>.<span title="()org.jboss.netty.handler.codec.http.HttpHeaders">headers</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()java.util.List[java.util.Map.Entry[String,String]]">entries</span><span title="(l: java.util.List[java.util.Map.Entry[String,String]])scala.collection.convert.Decorators.AsScala[scala.collection.mutable.Buffer[java.util.Map.Entry[String,String]]]" class="delimiter">(</span><span class="delimiter">)</span>.<span title="=&gt; scala.collection.mutable.Buffer[java.util.Map.Entry[String,String]]">asScala</span>.<span title="(f: java.util.Map.Entry[String,String] =&gt; (String, String))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.mutable.Buffer[java.util.Map.Entry[String,String]],(String, String),scala.collection.mutable.Buffer[(String, String)]])scala.collection.mutable.Buffer[(String, String)]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.mutable.Buffer.Coll,(String, String),scala.collection.mutable.Buffer[(String, String)]]" class="delimiter">(</span><a title="java.util.Map.Entry[String,String]" id="play.core.server.netty;PlayDefaultUpstreamHandler.getHeaders.pairs.$anonfun.h">h</a> =&gt; <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.getHeaders.pairs.$anonfun.h" title="java.util.Map.Entry[String,String]">h</a>.<span title="(x: String)ArrowAssoc[String]">getKey</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.getHeaders.pairs.$anonfun.h" title="java.util.Map.Entry[String,String]">h</a>.<span title="()String">getValue</span><span class="delimiter">)</span>
    <span title="play.api.mvc.Headers" class="keyword">new</span> <a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers" title="play.api.mvc.Headers">Headers</a><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.getHeaders.pairs" title="scala.collection.mutable.Buffer[(String, String)]">pairs</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(subSequence: Int, last: Boolean, message: Object)(implicit ctx: org.jboss.netty.channel.ChannelHandlerContext, implicit oue: com.typesafe.netty.http.pipelining.OrderedUpstreamMessageEvent)org.jboss.netty.channel.ChannelFuture" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream">sendDownstream</a><span class="delimiter">(</span><a title="Int" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.subSequence">subSequence</a>: <span title="Int">Int</span>, <a title="Boolean" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.last">last</a>: <span title="Boolean">Boolean</span>, <a title="Object" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.message">message</a>: <span title="Object">Object</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="org.jboss.netty.channel.ChannelHandlerContext" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.ctx">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="com.typesafe.netty.http.pipelining.OrderedUpstreamMessageEvent" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.oue">oue</a>: <span title="com.typesafe.netty.http.pipelining.OrderedUpstreamMessageEvent">OrderedUpstreamMessageEvent</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="com.typesafe.netty.http.pipelining.OrderedDownstreamChannelEvent" id="play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.ode">ode</a> = <span title="(x$1: com.typesafe.netty.http.pipelining.OrderedUpstreamMessageEvent, x$2: Int, x$3: Boolean, x$4: Any)com.typesafe.netty.http.pipelining.OrderedDownstreamChannelEvent" class="keyword">new</span> <span title="com.typesafe.netty.http.pipelining.OrderedDownstreamChannelEvent">OrderedDownstreamChannelEvent</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.oue" title="com.typesafe.netty.http.pipelining.OrderedUpstreamMessageEvent">oue</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.subSequence" title="Int">subSequence</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.last" title="Boolean">last</a>, <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.message" title="Object">message</a><span class="delimiter">)</span>
    <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.ctx" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="(x$1: org.jboss.netty.channel.ChannelEvent)Unit">sendDownstream</span><span class="delimiter">(</span><a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.ode" title="com.typesafe.netty.http.pipelining.OrderedDownstreamChannelEvent">ode</a><span class="delimiter">)</span>
    <a href="#play.core.server.netty;PlayDefaultUpstreamHandler.sendDownstream.ode" title="com.typesafe.netty.http.pipelining.OrderedDownstreamChannelEvent">ode</a>.<span title="()org.jboss.netty.channel.ChannelFuture">getFuture</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="play.core.server.netty.PlayDefaultUpstreamHandler.type" id="play.core.server.netty.PlayDefaultUpstreamHandler">PlayDefaultUpstreamHandler</a> <a href="#play.core.server.netty.PlayDefaultUpstreamHandler" title="play.core.server.netty.PlayDefaultUpstreamHandler.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="play.api.Logger" id="play.core.server.netty.PlayDefaultUpstreamHandler.logger">logger</a> = <a href="../../../../../play/play/api/Logger.scala.html#play.api.Logger.apply(1f619881c1)" title="(clazz: Class[play.core.server.netty.PlayDefaultUpstreamHandler])play.api.Logger">Logger</a><span class="delimiter">(</span>classOf<span title="Class[play.core.server.netty.PlayDefaultUpstreamHandler](classOf[play.core.server.netty.PlayDefaultUpstreamHandler])" class="delimiter">[</span>PlayDefaultUpstreamHandler<span class="delimiter">]</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

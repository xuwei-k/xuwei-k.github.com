<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>run-support/play/runsupport/FileWatchService.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.runsupport

<span class="keyword">import</span> java.net.URLClassLoader
<span class="keyword">import</span> java.util.List
<span class="keyword">import</span> java.util.Locale

<span class="keyword">import</span> sbt._
<span class="keyword">import</span> sbt.<span title="sbt.Path.type">Path</span>._

<span class="keyword">import</span> scala.collection.JavaConversions
<span class="keyword">import</span> scala.reflect.ClassTag
<span class="keyword">import</span> scala.util.<span class="delimiter">{</span> Properties, Try <span class="delimiter">}</span>
<span class="keyword">import</span> scala.util.control.NonFatal
<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> java.util.concurrent.Callable

<span class="comment">/**
 * A service that can watch files
 */</span>
<span class="keyword">trait</span> <a title="trait FileWatchService extends AnyRef" id="play.runsupport;FileWatchService">FileWatchService</a> <span title="Unit" class="delimiter">{</span>
  <span class="comment">/**
   * Watch the given sequence of files or directories.
   *
   * @param filesToWatch The files to watch.
   * @param onChange A callback that is executed whenever something changes.
   * @return A watcher
   */</span>
  <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.FileWatcher" id="play.runsupport;FileWatchService.watch(0950aeb3fd)">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;FileWatchService.watch(0950aeb3fd).filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport;FileWatchService.watch(0950aeb3fd).onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span>: <a href="#play.runsupport;FileWatcher" title="play.runsupport.FileWatcher">FileWatcher</a>

  <span class="comment">/**
   * Watch the given sequence of files or directories.
   *
   * @param filesToWatch The files to watch.
   * @param onChange A callback that is executed whenever something changes.
   * @return A watcher
   */</span>
  <span class="keyword">def</span> <a title="(filesToWatch: java.util.List[java.io.File], onChange: java.util.concurrent.Callable[Void])play.runsupport.FileWatcher" id="play.runsupport;FileWatchService.watch(1c335a5bdb)">watch</a><span class="delimiter">(</span><a title="java.util.List[java.io.File]" id="play.runsupport;FileWatchService.watch(1c335a5bdb).filesToWatch">filesToWatch</a>: <span title="java.util.List[java.io.File]">List</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="java.util.concurrent.Callable[Void]" id="play.runsupport;FileWatchService.watch(1c335a5bdb).onChange">onChange</a>: <span title="java.util.concurrent.Callable[Void]">Callable</span><span class="delimiter">[</span>Void<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#play.runsupport;FileWatcher" title="play.runsupport.FileWatcher">FileWatcher</a> = <span class="delimiter">{</span>
    <a href="#play.runsupport;FileWatchService.watch(0950aeb3fd)" title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.FileWatcher">watch</a><span class="delimiter">(</span><span title="scala.collection.JavaConversions.type">JavaConversions</span>.<span title="(l: java.util.List[java.io.File])scala.collection.mutable.Buffer[java.io.File]">asScalaBuffer</span><span class="delimiter">(</span><a href="#play.runsupport;FileWatchService.watch(1c335a5bdb).filesToWatch" title="java.util.List[java.io.File]">filesToWatch</a><span class="delimiter">)</span>, <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span> <a href="#play.runsupport;FileWatchService.watch(1c335a5bdb).onChange" title="java.util.concurrent.Callable[Void]">onChange</a>.<span title="()Void">call</span> <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * A watcher, that watches files.
 */</span>
<span title="AnyRef" class="keyword">trait</span> <a title="trait FileWatcher extends AnyRef" id="play.runsupport;FileWatcher">FileWatcher</a> <span class="delimiter">{</span>

  <span class="comment">/**
   * Stop watching the files.
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;FileWatcher.stop">stop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">object</span> <a title="play.runsupport.FileWatchService.type" id="play.runsupport.FileWatchService">FileWatchService</a> <a href="#play.runsupport.FileWatchService" title="play.runsupport.FileWatchService.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait OS extends AnyRef" id="play.runsupport.FileWatchService;OS">OS</a>
  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#play.runsupport.FileWatchService.Windows.productElement.x$1" title="play.runsupport.FileWatchService.Windows.type" id="play.runsupport.FileWatchService.Windows.readResolve">Windows</a> <span title="Product" class="keyword">extends</span> <a href="#play.runsupport.FileWatchService;OS" title="play.runsupport.FileWatchService.OS">OS</a>
  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#play.runsupport.FileWatchService.Linux.productElement.x$1" title="play.runsupport.FileWatchService.Linux.type" id="play.runsupport.FileWatchService.Linux.readResolve">Linux</a> <span title="Product" class="keyword">extends</span> <a href="#play.runsupport.FileWatchService;OS" title="play.runsupport.FileWatchService.OS">OS</a>
  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#play.runsupport.FileWatchService.OSX.productElement.x$1" title="play.runsupport.FileWatchService.OSX.type" id="play.runsupport.FileWatchService.OSX.readResolve">OSX</a> <span title="Product" class="keyword">extends</span> <a href="#play.runsupport.FileWatchService;OS" title="play.runsupport.FileWatchService.OS">OS</a>
  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#play.runsupport.FileWatchService.Other.productElement.x$1" title="play.runsupport.FileWatchService.Other.type" id="play.runsupport.FileWatchService.Other.readResolve">Other</a> <span title="Product" class="keyword">extends</span> <a href="#play.runsupport.FileWatchService;OS" title="play.runsupport.FileWatchService.OS">OS</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="play.runsupport.FileWatchService.OS" id="play.runsupport.FileWatchService.os">os</a>: <a href="#play.runsupport.FileWatchService;OS" title="play.runsupport.FileWatchService.OS">OS</a> = <span class="delimiter">{</span>
    sys.<span title="=&gt; scala.sys.SystemProperties">props</span>.<span title="(key: String)Option[String]">get</span><span class="delimiter">(</span><span title="String(&quot;os.name&quot;)" class="string">&quot;os.name&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Product with Serializable with play.runsupport.FileWatchService.OS)Option[Product with Serializable with play.runsupport.FileWatchService.OS]">map</span> <span class="delimiter">{</span> <a title="String" id="play.runsupport.FileWatchService.os.$anonfun.name">name</a> =&gt;
      <a href="#play.runsupport.FileWatchService.os.$anonfun.name" title="String">name</a>.<span title="(x$1: java.util.Locale)String">toLowerCase</span><span class="delimiter">(</span><span title="java.util.Locale.type">Locale</span>.<span title="java.util.Locale">ENGLISH</span><span class="delimiter">)</span> <span title="FileWatchService extends Product with Serializable with play.runsupport.FileWatchService.OS" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="String" id="play.runsupport.FileWatchService.os.$anonfun.osx">osx</a> <span class="keyword">if</span> <a href="#play.runsupport.FileWatchService.os.$anonfun.osx" title="String">osx</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;darwin&quot;)" class="string">&quot;darwin&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#play.runsupport.FileWatchService.os.$anonfun.osx" title="String">osx</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;mac&quot;)" class="string">&quot;mac&quot;</span><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.FileWatchService.OSX.readResolve" title="play.runsupport.FileWatchService.OSX.type">OSX</a>
        <span class="keyword">case</span> <a title="String" id="play.runsupport.FileWatchService.os.$anonfun.windows">windows</a> <span class="keyword">if</span> <a href="#play.runsupport.FileWatchService.os.$anonfun.windows" title="String">windows</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;windows&quot;)" class="string">&quot;windows&quot;</span><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.FileWatchService.Windows.readResolve" title="play.runsupport.FileWatchService.Windows.type">Windows</a>
        <span class="keyword">case</span> <a title="String" id="play.runsupport.FileWatchService.os.$anonfun.linux">linux</a> <span class="keyword">if</span> <a href="#play.runsupport.FileWatchService.os.$anonfun.linux" title="String">linux</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;linux&quot;)" class="string">&quot;linux&quot;</span><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.FileWatchService.Linux.readResolve" title="play.runsupport.FileWatchService.Linux.type">Linux</a>
        <span class="keyword">case</span> _ =&gt; <a href="#play.runsupport.FileWatchService.Other.readResolve" title="play.runsupport.FileWatchService.Other.type">Other</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>.<span title="(default: =&gt; Product with Serializable with play.runsupport.FileWatchService.OS)Product with Serializable with play.runsupport.FileWatchService.OS">getOrElse</span><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.Other.readResolve" title="play.runsupport.FileWatchService.Other.type">Other</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(targetDirectory: java.io.File, pollDelayMillis: Int, logger: play.runsupport.LoggerProxy)play.runsupport.FileWatchService" id="play.runsupport.FileWatchService.defaultWatchService">defaultWatchService</a><span class="delimiter">(</span><a title="java.io.File" id="play.runsupport.FileWatchService.defaultWatchService.targetDirectory">targetDirectory</a>: <span title="java.io.File">File</span>, <a title="Int" id="play.runsupport.FileWatchService.defaultWatchService.pollDelayMillis">pollDelayMillis</a>: <span title="Int">Int</span>, <a title="play.runsupport.LoggerProxy" id="play.runsupport.FileWatchService.defaultWatchService.logger">logger</a>: <a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy" title="play.runsupport.LoggerProxy">LoggerProxy</a><span class="delimiter">)</span>: <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a> = <a href="#play.runsupport.FileWatchService.defaultWatchService;$anon" title="play.runsupport.FileWatchService{}" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.runsupport.FileWatchService" id="play.runsupport.FileWatchService.defaultWatchService;$anon">FileWatchService</a> <span class="delimiter">{</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.runsupport.FileWatchService" id="play.runsupport.FileWatchService.defaultWatchService;$anon.delegate">delegate</a> = <a href="#play.runsupport.FileWatchService.os" title="=&gt; play.runsupport.FileWatchService.OS">os</a> <span title="play.runsupport.FileWatchService" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="comment">// If Windows or Linux and JDK7, use JDK7 watch service</span>
      <span class="keyword">case</span> <span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.Windows.readResolve" title="play.runsupport.FileWatchService.Windows.type">Windows</a> | <a href="#play.runsupport.FileWatchService.Linux.readResolve" title="play.runsupport.FileWatchService.Linux.type">Linux</a><span class="delimiter">)</span> <span class="keyword">if</span> <span title="scala.util.Properties.type">Properties</span>.<span title="(version: String)Boolean">isJavaAtLeast</span><span class="delimiter">(</span><span title="String(&quot;1.7&quot;)" class="string">&quot;1.7&quot;</span><span class="delimiter">)</span> =&gt; <span title="play.runsupport.JDK7FileWatchService" class="keyword">new</span> <a href="#play.runsupport;JDK7FileWatchService" title="play.runsupport.JDK7FileWatchService">JDK7FileWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.defaultWatchService.logger" title="play.runsupport.LoggerProxy">logger</a><span class="delimiter">)</span>
      <span class="comment">// If Windows, Linux or OSX, use JNotify but fall back to SBT</span>
      <span class="keyword">case</span> <span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.Windows.readResolve" title="play.runsupport.FileWatchService.Windows.type">Windows</a> | <a href="#play.runsupport.FileWatchService.Linux.readResolve" title="play.runsupport.FileWatchService.Linux.type">Linux</a> | <a href="#play.runsupport.FileWatchService.OSX.readResolve" title="play.runsupport.FileWatchService.OSX.type">OSX</a><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.JNotifyFileWatchService.apply" title="(targetDirectory: java.io.File)scala.util.Try[play.runsupport.FileWatchService]">JNotifyFileWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.defaultWatchService.targetDirectory" title="java.io.File">targetDirectory</a><span class="delimiter">)</span>.<span title="(f: PartialFunction[Throwable,play.runsupport.FileWatchService])scala.util.Try[play.runsupport.FileWatchService]">recover</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Throwable,play.runsupport.PollingFileWatchService] with Serializable" id="play.runsupport.FileWatchService.defaultWatchService;$anon.delegate;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
        <span class="keyword">case</span> <a title="Throwable" id="play.runsupport.FileWatchService.defaultWatchService;$anon.delegate;$anonfun.isDefinedAt.e">e</a> =&gt;
          <a href="#play.runsupport.FileWatchService.defaultWatchService.logger" title="play.runsupport.LoggerProxy">logger</a>.<a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy.warn" title="(message: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="String(&quot;Error loading JNotify watch service: &quot;)" class="string">&quot;Error loading JNotify watch service: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.runsupport.FileWatchService.defaultWatchService;$anon.delegate;$anonfun.isDefinedAt.e" title="Throwable">e</a>.<span title="()String">getMessage</span><span class="delimiter">)</span>
          <a href="#play.runsupport.FileWatchService.defaultWatchService.logger" title="play.runsupport.LoggerProxy">logger</a>.<a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy.trace" title="(t: =&gt; Throwable)Unit">trace</a><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.defaultWatchService;$anon.delegate;$anonfun.isDefinedAt.e" title="Throwable">e</a><span class="delimiter">)</span>
          <span title="play.runsupport.PollingFileWatchService" class="keyword">new</span> <a href="#play.runsupport;PollingFileWatchService" title="play.runsupport.PollingFileWatchService">PollingFileWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.defaultWatchService.pollDelayMillis" title="Int">pollDelayMillis</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>.<span title="=&gt; play.runsupport.FileWatchService">get</span>
      <span class="keyword">case</span> _ =&gt; <span title="play.runsupport.PollingFileWatchService" class="keyword">new</span> <a href="#play.runsupport;PollingFileWatchService" title="play.runsupport.PollingFileWatchService">PollingFileWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.defaultWatchService.pollDelayMillis" title="Int">pollDelayMillis</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.FileWatcher" id="play.runsupport.FileWatchService.defaultWatchService;$anon.watch(0950aeb3fd)">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport.FileWatchService.defaultWatchService;$anon.watch(0950aeb3fd).filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport.FileWatchService.defaultWatchService;$anon.watch(0950aeb3fd).onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <a href="#play.runsupport.FileWatchService.defaultWatchService;$anon.delegate" title="=&gt; play.runsupport.FileWatchService">delegate</a>.<a href="#play.runsupport;FileWatchService.watch(0950aeb3fd)" title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.FileWatcher">watch</a><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.defaultWatchService;$anon.watch(0950aeb3fd).filesToWatch" title="Seq[java.io.File]">filesToWatch</a>, <a href="#play.runsupport.FileWatchService.defaultWatchService;$anon.watch(0950aeb3fd).onChange" title="() =&gt; Unit">onChange</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(targetDirectory: java.io.File)play.runsupport.FileWatchService" id="play.runsupport.FileWatchService.jnotify">jnotify</a><span class="delimiter">(</span><a title="java.io.File" id="play.runsupport.FileWatchService.jnotify.targetDirectory">targetDirectory</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a> = <a href="#play.runsupport.FileWatchService.optional" title="(watchService: scala.util.Try[play.runsupport.FileWatchService])play.runsupport.FileWatchService">optional</a><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply" title="(targetDirectory: java.io.File)scala.util.Try[play.runsupport.FileWatchService]">JNotifyFileWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.jnotify.targetDirectory" title="java.io.File">targetDirectory</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(logger: play.runsupport.LoggerProxy)play.runsupport.FileWatchService" id="play.runsupport.FileWatchService.jdk7">jdk7</a><span class="delimiter">(</span><a title="play.runsupport.LoggerProxy" id="play.runsupport.FileWatchService.jdk7.logger">logger</a>: <a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy" title="play.runsupport.LoggerProxy">LoggerProxy</a><span class="delimiter">)</span>: <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a> = <span title="play.runsupport.JDK7FileWatchService" class="keyword">new</span> <a href="#play.runsupport;JDK7FileWatchService" title="play.runsupport.JDK7FileWatchService">JDK7FileWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.jdk7.logger" title="play.runsupport.LoggerProxy">logger</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(pollDelayMillis: Int)play.runsupport.FileWatchService" id="play.runsupport.FileWatchService.sbt">sbt</a><span class="delimiter">(</span><a title="Int" id="play.runsupport.FileWatchService.sbt.pollDelayMillis">pollDelayMillis</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a> = <span title="play.runsupport.PollingFileWatchService" class="keyword">new</span> <a href="#play.runsupport;PollingFileWatchService" title="play.runsupport.PollingFileWatchService">PollingFileWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.sbt.pollDelayMillis" title="Int">pollDelayMillis</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(watchService: scala.util.Try[play.runsupport.FileWatchService])play.runsupport.FileWatchService" id="play.runsupport.FileWatchService.optional">optional</a><span class="delimiter">(</span><a title="scala.util.Try[play.runsupport.FileWatchService]" id="play.runsupport.FileWatchService.optional.watchService">watchService</a>: <span title="scala.util.Try[play.runsupport.FileWatchService]">Try</span><span class="delimiter">[</span>FileWatchService<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a> = <span title="play.runsupport.OptionalFileWatchServiceDelegate" class="keyword">new</span> <a href="#play.runsupport;OptionalFileWatchServiceDelegate" title="play.runsupport.OptionalFileWatchServiceDelegate">OptionalFileWatchServiceDelegate</a><span class="delimiter">(</span><a href="#play.runsupport.FileWatchService.optional.watchService" title="scala.util.Try[play.runsupport.FileWatchService]">watchService</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">private</span><span class="delimiter">[</span>play<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait DefaultFileWatchService extends AnyRef with play.runsupport.FileWatchService" id="play.runsupport;DefaultFileWatchService">DefaultFileWatchService</a> <span class="keyword">extends</span> <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; play.runsupport.FileWatchService" id="play.runsupport;DefaultFileWatchService.delegate">delegate</a>: <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a>
<span class="delimiter">}</span>

<span class="comment">/**
 * A polling Play watch service.  Polls in the background.
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>play<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class PollingFileWatchService extends AnyRef with play.runsupport.FileWatchService" id="play.runsupport;PollingFileWatchService">PollingFileWatchService</a><a href="#play.runsupport;PollingFileWatchService" title="play.runsupport.PollingFileWatchService" class="delimiter">(</a><span class="keyword">val</span> <a title="Int" id="play.runsupport;PollingFileWatchService.pollDelayMillis">pollDelayMillis</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a> <span class="delimiter">{</span>

  <span class="comment">// Work around for https://github.com/sbt/sbt/issues/1973</span>
  <span class="keyword">def</span> <a title="(pathFinder: sbt.PathFinder)sbt.PathFinder" id="play.runsupport;PollingFileWatchService.distinctPathFinder">distinctPathFinder</a><span class="delimiter">(</span><a title="sbt.PathFinder" id="play.runsupport;PollingFileWatchService.distinctPathFinder.pathFinder">pathFinder</a>: <span title="sbt.PathFinder">PathFinder</span><span class="delimiter">)</span> = <span title="(files: =&gt; Traversable[java.io.File])sbt.PathFinder">PathFinder</span> <span class="delimiter">{</span>
    <a href="#play.runsupport;PollingFileWatchService.distinctPathFinder.pathFinder" title="sbt.PathFinder">pathFinder</a>.<span title="=&gt; Seq[java.io.File]">get</span>.<span title="(f: java.io.File =&gt; (String, java.io.File))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[java.io.File],(String, java.io.File),Seq[(String, java.io.File)]])Seq[(String, java.io.File)]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(String, java.io.File),Seq[(String, java.io.File)]]" class="delimiter">(</span><a title="java.io.File" id="play.runsupport;PollingFileWatchService.distinctPathFinder.$anonfun.p">p</a> =&gt; <span title="(_1: String, _2: java.io.File)(String, java.io.File)" class="delimiter">(</span><a href="#play.runsupport;PollingFileWatchService.distinctPathFinder.$anonfun.p" title="implicit sbt.PathExtra.richFile : (file: java.io.File)sbt.RichFile">p</a>.<span title="=&gt; java.io.File">asFile</span>.<span title="()String">getAbsolutePath</span>, <a href="#play.runsupport;PollingFileWatchService.distinctPathFinder.$anonfun.p" title="java.io.File">p</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ev: &lt;:&lt;[(String, java.io.File),(String, java.io.File)])scala.collection.immutable.Map[String,java.io.File]">toMap</span>.<span title="=&gt; Iterable[java.io.File]">values</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.FileWatcher" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd)">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd).filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd).onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <span class="delimiter">{</span>

    @volatile <span class="keyword">var</span> <a title="Boolean" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd).stopped">stopped</a> = <span title="Boolean(false)" class="keyword">false</span>

    <span class="keyword">val</span> <a title="Thread" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread">thread</a> = <span title="(x$1: Runnable, x$2: String)Thread" class="keyword">new</span> <span title="Thread">Thread</span><span class="delimiter">(</span><a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon" title="Runnable" class="keyword">new</a> <a title="anonymous class $anon extends Object with Runnable" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon">Runnable</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run">run</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">var</span> <a title="sbt.WatchState" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.state">state</a> = <span title="sbt.WatchState.type">WatchState</span>.<span title="=&gt; sbt.WatchState">empty</span>
        <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).stopped" title="Boolean">stopped</a><span class="delimiter">)</span> <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.while$1" title="()Unit" class="delimiter">{</a>
          <span class="keyword">val</span> <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.triggered" title="(Boolean, sbt.WatchState)" class="delimiter">(</a><a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.x$1" title="Boolean" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.triggered">triggered</a>, <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.x$1" title="sbt.WatchState" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.newState">newState</a><span class="delimiter">)</span> = <span title="sbt.SourceModificationWatch.type">SourceModificationWatch</span>.<span title="(sourcesFinder: sbt.PathFinder, pollDelayMillis: Int, state: sbt.WatchState)(terminationCondition: =&gt; Boolean)(Boolean, sbt.WatchState)">watch</span><span class="delimiter">(</span><a href="#play.runsupport;PollingFileWatchService.distinctPathFinder" title="(pathFinder: sbt.PathFinder)sbt.PathFinder">distinctPathFinder</a><span class="delimiter">(</span><a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).filesToWatch" title="implicit sbt.PathExtra.filesToFinder : (cc: Traversable[java.io.File])sbt.PathFinder">filesToWatch</a>.<span title="=&gt; sbt.PathFinder">***</span><span class="delimiter">)</span>, <a href="#play.runsupport;PollingFileWatchService.pollDelayMillis" title="=&gt; Int">pollDelayMillis</a>,
            <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.state" title="sbt.WatchState">state</a><span class="delimiter">)</span><span title="(Boolean, sbt.WatchState) @unchecked" class="delimiter">(</span><a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).stopped" title="Boolean">stopped</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.triggered" title="Boolean">triggered</a><span class="delimiter">)</span> <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).onChange" title="()Unit">onChange</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.state" title="sbt.WatchState">state</a> = <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread;$anon.run.newState" title="sbt.WatchState">newState</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>, <span title="String(&quot;sbt-play-watch-service&quot;)" class="string">&quot;sbt-play-watch-service&quot;</span><span class="delimiter">)</span>
    <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread" title="Thread">thread</a>.<span title="(x$1: Boolean)Unit">setDaemon</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
    <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).thread" title="Thread">thread</a>.<span title="()Unit">start</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd);$anon" title="play.runsupport.FileWatcher" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.runsupport.FileWatcher" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd);$anon">FileWatcher</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;PollingFileWatchService.watch(0950aeb3fd);$anon.stop">stop</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#play.runsupport;PollingFileWatchService.watch(0950aeb3fd).stopped" title="Boolean">stopped</a> = <span title="Boolean(true)" class="keyword">true</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">private</span><span class="delimiter">[</span>play<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class JNotifyFileWatchService extends AnyRef with play.runsupport.FileWatchService" id="play.runsupport;JNotifyFileWatchService">JNotifyFileWatchService</a><a href="#play.runsupport;JNotifyFileWatchService" title="play.runsupport.JNotifyFileWatchService" class="delimiter">(</a><a title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate" id="play.runsupport;JNotifyFileWatchService.delegate">delegate</a>: JNotifyFileWatchService.<a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate" title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate">JNotifyDelegate</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.FileWatcher" id="play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd)">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd).filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd).onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="AnyRef" id="play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd).listener">listener</a> = <a href="#play.runsupport;JNotifyFileWatchService.delegate" title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate">delegate</a>.<a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.newListener" title="(onChange: () =&gt; Unit)AnyRef">newListener</a><span class="delimiter">(</span><a href="#play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd).onChange" title="() =&gt; Unit">onChange</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Seq[Int]" id="play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd).registeredIds">registeredIds</a> = <a href="#play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd).filesToWatch" title="Seq[java.io.File]">filesToWatch</a>.<span title="(f: java.io.File =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[java.io.File],Int,Seq[Int]])Seq[Int]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Int,Seq[Int]]" class="delimiter">{</span> <a title="java.io.File" id="play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd).registeredIds.$anonfun.file">file</a> =&gt;
      <a href="#play.runsupport;JNotifyFileWatchService.delegate" title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate">delegate</a>.<a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.addWatch" title="(fileOrDirectory: String, listener: AnyRef)Int">addWatch</a><span class="delimiter">(</span><a href="#play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd).registeredIds.$anonfun.file" title="java.io.File">file</a>.<span title="()String">getAbsolutePath</span>, <a href="#play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd).listener" title="AnyRef">listener</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd);$anon" title="play.runsupport.FileWatcher" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.runsupport.FileWatcher" id="play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd);$anon">FileWatcher</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd);$anon.stop">stop</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#play.runsupport;JNotifyFileWatchService.watch(0950aeb3fd).registeredIds" title="Seq[Int]">registeredIds</a>.<span title="(f: Int =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#play.runsupport;JNotifyFileWatchService.delegate" title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate">delegate</a>.<a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.removeWatch" title="(id: Int)Unit">removeWatch</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">private</span> <span class="keyword">object</span> <a title="play.runsupport.JNotifyFileWatchService.type" id="play.runsupport.JNotifyFileWatchService">JNotifyFileWatchService</a> <a href="#play.runsupport.JNotifyFileWatchService" title="play.runsupport.JNotifyFileWatchService.type" class="delimiter">{</a>

  <span class="keyword">import</span> java.lang.reflect.<span class="delimiter">{</span> Method, InvocationHandler, Proxy <span class="delimiter">}</span>

  <span class="comment">/**
   * Captures all the reflection invocations in one place.
   */</span>
  <span class="keyword">class</span> <a title="class JNotifyDelegate extends AnyRef" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate">JNotifyDelegate</a><a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate" title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate" class="delimiter">(</a><a title="ClassLoader" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.classLoader">classLoader</a>: <span title="ClassLoader">ClassLoader</span>, <a title="Class[_]" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.listenerClass">listenerClass</a>: <span title="Class[_]">Class</span><span class="delimiter">[</span>_<span class="delimiter">]</span>, <a title="java.lang.reflect.Method" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.addWatchMethod">addWatchMethod</a>: <span title="java.lang.reflect.Method">Method</span>, <a title="java.lang.reflect.Method" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.removeWatchMethod">removeWatchMethod</a>: <span title="java.lang.reflect.Method">Method</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(fileOrDirectory: String, listener: AnyRef)Int" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.addWatch">addWatch</a><span class="delimiter">(</span><a title="String" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.addWatch.fileOrDirectory">fileOrDirectory</a>: <span title="String">String</span>, <a title="AnyRef" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.addWatch.listener">listener</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.addWatchMethod" title="java.lang.reflect.Method">addWatchMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>,
        <a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.addWatch.fileOrDirectory" title="String">fileOrDirectory</a>, <span class="comment">// The file or directory to watch</span>
        <span title="implicit scala.Predef.int2Integer : (x: Int)Integer" class="int">15</span>: java.lang.<span title="Integer">Integer</span>, <span class="comment">// flags to say watch for all events</span>
        <span title="implicit scala.Predef.boolean2Boolean : (x: Boolean)Boolean" class="keyword">true</span>: java.lang.<span title="Boolean">Boolean</span>, <span class="comment">// Watch subtree</span>
        <a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.addWatch.listener" title="AnyRef">listener</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(id: Int)Unit" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.removeWatch">removeWatch</a><span class="delimiter">(</span><a title="Int" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.removeWatch.id">id</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.removeWatchMethod" title="java.lang.reflect.Method">removeWatchMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span title="Unit" class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.removeWatch.id" title="Int">id</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> _: <span title="Throwable">Throwable</span> =&gt;
        <span class="comment">// Ignore, if we fail to remove a watch it's not the end of the world.</span>
        <span class="comment">// http://sourceforge.net/p/jnotify/bugs/12/</span>
        <span class="comment">// We match on Throwable because matching on an IOException didn't work.</span>
        <span class="comment">// http://sourceforge.net/p/jnotify/bugs/5/</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(onChange: () =&gt; Unit)AnyRef" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.newListener">newListener</a><span class="delimiter">(</span><a title="() =&gt; Unit" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.newListener.onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <span class="delimiter">{</span>
      <span title="java.lang.reflect.Proxy.type">Proxy</span>.<span title="(x$1: ClassLoader, x$2: Array[Class[_]], x$3: java.lang.reflect.InvocationHandler)Object">newProxyInstance</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.classLoader" title="ClassLoader">classLoader</a>, <span title="(elems: Class[_$1]*)Seq[Class[_$1]]">Seq</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.listenerClass" title="Class[_]">listenerClass</a><span class="delimiter">)</span>.<span title="(implicit evidence$1: scala.reflect.ClassTag[Class[_]])Array[Class[_]]">toArray</span>, <a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.newListener;$anon" title="java.lang.reflect.InvocationHandler" class="keyword">new</a> <a title="anonymous class $anon extends Object with java.lang.reflect.InvocationHandler" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.newListener;$anon">InvocationHandler</a> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="(proxy: AnyRef, m: java.lang.reflect.Method, args: Array[AnyRef])AnyRef" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.newListener;$anon.invoke">invoke</a><span class="delimiter">(</span><a title="AnyRef" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.newListener;$anon.invoke.proxy">proxy</a>: <span title="AnyRef">AnyRef</span>, <a title="java.lang.reflect.Method" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.newListener;$anon.invoke.m">m</a>: <span title="java.lang.reflect.Method">Method</span>, <a title="Array[AnyRef]" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.newListener;$anon.invoke.args">args</a>: <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <span class="delimiter">{</span>
          <a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.newListener.onChange" title="()Unit">onChange</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="Null(null)" class="keyword">null</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    @throws<span class="delimiter">[</span>Throwable<span class="delimiter">]</span><span class="delimiter">(</span><span class="string">&quot;If we were not able to successfully load JNotify&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="()Unit" id="play.runsupport.JNotifyFileWatchService;JNotifyDelegate.ensureLoaded">ensureLoaded</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.removeWatchMethod" title="java.lang.reflect.Method">removeWatchMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span title="Unit" class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <span title="Int(0)" class="int">0</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Integer" class="delimiter">[</span>java.lang.<span title="Integer">Integer</span><span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">// Tri state - null means no attempt to load yet, None means failed load, Some means successful load</span>
  @volatile <span class="keyword">var</span> <a title="Option[scala.util.Try[play.runsupport.JNotifyFileWatchService]]" id="play.runsupport.JNotifyFileWatchService.watchService_=">watchService</a>: <span title="Option[scala.util.Try[play.runsupport.JNotifyFileWatchService]]">Option</span><span class="delimiter">[</span>Try<span class="delimiter">[</span>JNotifyFileWatchService<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="None.type">None</span>

  <span class="keyword">def</span> <a title="(targetDirectory: java.io.File)scala.util.Try[play.runsupport.FileWatchService]" id="play.runsupport.JNotifyFileWatchService.apply">apply</a><span class="delimiter">(</span><a title="java.io.File" id="play.runsupport.JNotifyFileWatchService.apply.targetDirectory">targetDirectory</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <span title="scala.util.Try[play.runsupport.FileWatchService]">Try</span><span class="delimiter">[</span>FileWatchService<span class="delimiter">]</span> = <span class="delimiter">{</span>

    <a href="#play.runsupport.JNotifyFileWatchService.watchService_=" title="=&gt; Option[scala.util.Try[play.runsupport.JNotifyFileWatchService]]">watchService</a> <span title="scala.util.Try[play.runsupport.FileWatchService]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="None.type">None</span> =&gt;
        <span class="keyword">val</span> <span title="scala.util.Try[play.runsupport.JNotifyFileWatchService]">ws</span> = scala.util.control.<span title="scala.util.control.Exception.type">Exception</span>.<span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; play.runsupport.JNotifyFileWatchService)scala.util.Try[play.runsupport.JNotifyFileWatchService]">withTry</span> <span class="delimiter">{</span>

          <span class="keyword">val</span> <a title="ClassLoader" id="play.runsupport.JNotifyFileWatchService.apply.ws.classloader">classloader</a> = <a href="#play.runsupport.GlobalStaticVar" title="play.runsupport.GlobalStaticVar.type">GlobalStaticVar</a>.<a href="#play.runsupport.GlobalStaticVar.get" title="[T](name: String)(implicit ct: scala.reflect.ClassTag[T])Option[T]">get</a><span title="(name: String)(implicit ct: scala.reflect.ClassTag[ClassLoader])Option[ClassLoader]" class="delimiter">[</span><span title="ClassLoader">ClassLoader</span><span class="delimiter">]</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[ClassLoader]" class="delimiter">(</span><span title="String(&quot;FileWatchServiceJNotifyHack&quot;)" class="string">&quot;FileWatchServiceJNotifyHack&quot;</span><span class="delimiter">)</span>.<span title="(default: =&gt; ClassLoader)ClassLoader">getOrElse</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="java.io.File" id="play.runsupport.JNotifyFileWatchService.apply.ws.classloader.jnotifyJarFile">jnotifyJarFile</a> = <span class="keyword">this</span>.<span title="()Class[_]">getClass</span>.<span title="()ClassLoader">getClassLoader</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.net.URLClassLoader" class="delimiter">[</span>java.net.<span title="java.net.URLClassLoader">URLClassLoader</span><span class="delimiter">]</span>.<span title="(xs: Array[java.net.URL])scala.collection.mutable.ArrayOps[java.net.URL]">getURLs</span>
              .<span title="(f: java.net.URL =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Array[java.net.URL],String,Array[String]])Array[String]">map</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.jnotifyJarFile.$anonfun.x$2" title="java.net.URL">_</a>.<span title="()String">getFile</span><span class="delimiter">)</span>
              .<span title="(p: String =&gt; Boolean)Option[String]">find</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.jnotifyJarFile.$anonfun.x$3" title="String">_</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;/jnotify&quot;)" class="string">&quot;/jnotify&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
              .<span title="(f: String =&gt; java.io.File)Option[java.io.File]">map</span><span class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.jnotifyJarFile.$anonfun.x$4" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
              .<span title="(default: =&gt; java.io.File)java.io.File">getOrElse</span><span class="delimiter">(</span>sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;Missing JNotify?&quot;)" class="string">&quot;Missing JNotify?&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

            <span class="keyword">val</span> <a title="java.io.File" id="play.runsupport.JNotifyFileWatchService.apply.ws.classloader.nativeLibrariesDirectory">nativeLibrariesDirectory</a> = <span title="(x$1: java.io.File, x$2: String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply.targetDirectory" title="java.io.File">targetDirectory</a>, <span title="String(&quot;native_libraries&quot;)" class="string">&quot;native_libraries&quot;</span><span class="delimiter">)</span>

            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.nativeLibrariesDirectory" title="java.io.File">nativeLibrariesDirectory</a>.<span title="()Boolean">exists</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="comment">// Unzip native libraries from the jnotify jar to target/native_libraries</span>
              <span title="sbt.IO.type">IO</span>.<span title="(from: java.io.File, toDirectory: java.io.File, filter: sbt.NameFilter, preserveLastModified: Boolean)Set[java.io.File]">unzip</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.jnotifyJarFile" title="java.io.File">jnotifyJarFile</a>, <a href="#play.runsupport.JNotifyFileWatchService.apply.targetDirectory" title="java.io.File">targetDirectory</a>, <span class="delimiter">(</span>name: <span title="String">String</span><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.$anonfun.name" title="String">name</a>.<span title="(x$1: String)Boolean">startsWith</span><span class="delimiter">(</span><span title="String(&quot;native_libraries&quot;)" class="string">&quot;native_libraries&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>

            <span class="keyword">val</span> <a title="String" id="play.runsupport.JNotifyFileWatchService.apply.ws.classloader.libs">libs</a> = <span title="(x$1: java.io.File, x$2: String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.nativeLibrariesDirectory" title="java.io.File">nativeLibrariesDirectory</a>, <span title="System.type">System</span>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;sun.arch.data.model&quot;)" class="string">&quot;sun.arch.data.model&quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;bits&quot;)" class="string">&quot;bits&quot;</span><span class="delimiter">)</span>.<span title="()String">getAbsolutePath</span>

            <span class="comment">// Hack to set java.library.path</span>
            <span title="System.type">System</span>.<span title="(x$1: String, x$2: String)String">setProperty</span><span class="delimiter">(</span><span title="String(&quot;java.library.path&quot;)" class="string">&quot;java.library.path&quot;</span>, <span class="delimiter">{</span>
              <span title="(x: String)Option[String]">Option</span><span class="delimiter">(</span><span title="System.type">System</span>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;java.library.path&quot;)" class="string">&quot;java.library.path&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: String =&gt; String)Option[String]">map</span> <span class="delimiter">{</span> <a title="String" id="play.runsupport.JNotifyFileWatchService.apply.ws.classloader.$anonfun.existing">existing</a> =&gt;
                <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.$anonfun.existing" title="String">existing</a> <span title="(x$1: Any)String">+</span> java.io.<span title="java.io.File.type">File</span>.<span title="String">pathSeparator</span> <span title="(x$1: Any)String">+</span> <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.libs" title="String">libs</a>
              <span class="delimiter">}</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.libs" title="String">libs</a><span class="delimiter">)</span>
            <span class="delimiter">}</span><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="java.lang.reflect.Field" id="play.runsupport.JNotifyFileWatchService.apply.ws.classloader.fieldSysPath">fieldSysPath</a> = classOf<span title="Class[ClassLoader](classOf[java.lang.ClassLoader])" class="delimiter">[</span>ClassLoader<span class="delimiter">]</span>.<span title="(x$1: String)java.lang.reflect.Field">getDeclaredField</span><span class="delimiter">(</span><span title="String(&quot;sys_paths&quot;)" class="string">&quot;sys_paths&quot;</span><span class="delimiter">)</span>
            <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.fieldSysPath" title="java.lang.reflect.Field">fieldSysPath</a>.<span title="(x$1: Boolean)Unit">setAccessible</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
            <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.fieldSysPath" title="java.lang.reflect.Field">fieldSysPath</a>.<span title="(x$1: Any, x$2: Any)Unit">set</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>

            <span class="comment">// Create classloader just for jnotify</span>
            <span class="keyword">val</span> <a title="java.net.URLClassLoader" id="play.runsupport.JNotifyFileWatchService.apply.ws.classloader.loader">loader</a> = <span title="java.net.URLClassLoader" class="keyword">new</span> <span title="java.net.URLClassLoader">URLClassLoader</span><span class="delimiter">(</span><span title="(xs: java.net.URL*)(implicit evidence$2: scala.reflect.ClassTag[java.net.URL])Array[java.net.URL]">Array</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[java.net.URL]" class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.jnotifyJarFile" title="java.io.File">jnotifyJarFile</a>.<span title="()java.net.URI">toURI</span>.<span title="()java.net.URL">toURL</span><span class="delimiter">)</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>

            <a href="#play.runsupport.GlobalStaticVar" title="play.runsupport.GlobalStaticVar.type">GlobalStaticVar</a>.<a href="#play.runsupport.GlobalStaticVar.set" title="(name: String, value: AnyRef)Unit">set</a><span class="delimiter">(</span><span title="String(&quot;FileWatchServiceJNotifyHack&quot;)" class="string">&quot;FileWatchServiceJNotifyHack&quot;</span>, <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.loader" title="java.net.URLClassLoader">loader</a><span class="delimiter">)</span>

            <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader.loader" title="java.net.URLClassLoader">loader</a>
          <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JNotifyFileWatchService.apply.ws.jnotifyClass">jnotifyClass</a> = <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader" title="ClassLoader">classloader</a>.<span title="(x$1: String)Class[_]">loadClass</span><span class="delimiter">(</span><span title="String(&quot;net.contentobjects.jnotify.JNotify&quot;)" class="string">&quot;net.contentobjects.jnotify.JNotify&quot;</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JNotifyFileWatchService.apply.ws.jnotifyListenerClass">jnotifyListenerClass</a> = <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader" title="ClassLoader">classloader</a>.<span title="(x$1: String)Class[_]">loadClass</span><span class="delimiter">(</span><span title="String(&quot;net.contentobjects.jnotify.JNotifyListener&quot;)" class="string">&quot;net.contentobjects.jnotify.JNotifyListener&quot;</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JNotifyFileWatchService.apply.ws.addWatchMethod">addWatchMethod</a> = <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.jnotifyClass" title="Class[_]">jnotifyClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;addWatch&quot;)" class="string">&quot;addWatch&quot;</span>, classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span>, classOf<span title="Class[Int](classOf[scala.Int])" class="delimiter">[</span>Int<span class="delimiter">]</span>, classOf<span title="Class[Boolean](classOf[scala.Boolean])" class="delimiter">[</span>Boolean<span class="delimiter">]</span>, <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.jnotifyListenerClass" title="Class[_]">jnotifyListenerClass</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JNotifyFileWatchService.apply.ws.removeWatchMethod">removeWatchMethod</a> = <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.jnotifyClass" title="Class[_]">jnotifyClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;removeWatch&quot;)" class="string">&quot;removeWatch&quot;</span>, classOf<span title="Class[Int](classOf[scala.Int])" class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span>

          <span class="keyword">val</span> <a title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate" id="play.runsupport.JNotifyFileWatchService.apply.ws.d">d</a> = <span title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate" class="keyword">new</span> <a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate" title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate">JNotifyDelegate</a><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply.ws.classloader" title="ClassLoader">classloader</a>, <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.jnotifyListenerClass" title="Class[_]">jnotifyListenerClass</a>, <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.addWatchMethod" title="java.lang.reflect.Method">addWatchMethod</a>, <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.removeWatchMethod" title="java.lang.reflect.Method">removeWatchMethod</a><span class="delimiter">)</span>

          <span class="comment">// Try it</span>
          <a href="#play.runsupport.JNotifyFileWatchService.apply.ws.d" title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate">d</a>.<a href="#play.runsupport.JNotifyFileWatchService;JNotifyDelegate.ensureLoaded" title="()Unit">ensureLoaded</a><span class="delimiter">(</span><span class="delimiter">)</span>

          <span title="play.runsupport.JNotifyFileWatchService" class="keyword">new</span> <a href="#play.runsupport;JNotifyFileWatchService" title="play.runsupport.JNotifyFileWatchService">JNotifyFileWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.JNotifyFileWatchService.apply.ws.d" title="play.runsupport.JNotifyFileWatchService.JNotifyDelegate">d</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#play.runsupport.JNotifyFileWatchService.watchService_=" title="(x$1: Option[scala.util.Try[play.runsupport.JNotifyFileWatchService]])Unit">watchService</a> = <span title="(x: scala.util.Try[play.runsupport.JNotifyFileWatchService])Some[scala.util.Try[play.runsupport.JNotifyFileWatchService]]">Some</span><span class="delimiter">(</span><span title="scala.util.Try[play.runsupport.JNotifyFileWatchService]">ws</span><span class="delimiter">)</span>
        <span title="scala.util.Try[play.runsupport.JNotifyFileWatchService]">ws</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><span title="scala.util.Try[play.runsupport.JNotifyFileWatchService]">ws</span><span class="delimiter">)</span> =&gt; <span title="scala.util.Try[play.runsupport.JNotifyFileWatchService]">ws</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">private</span><span class="delimiter">[</span>play<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class JDK7FileWatchService extends AnyRef with play.runsupport.FileWatchService" id="play.runsupport;JDK7FileWatchService">JDK7FileWatchService</a><a href="#play.runsupport;JDK7FileWatchService" title="play.runsupport.JDK7FileWatchService" class="delimiter">(</a><a title="play.runsupport.LoggerProxy" id="play.runsupport;JDK7FileWatchService.logger">logger</a>: <a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy" title="play.runsupport.LoggerProxy">LoggerProxy</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a> <span class="delimiter">{</span>

  <span class="keyword">import</span> java.nio.file._
  <span class="keyword">import</span> <span title="java.nio.file.StandardWatchEventKinds.type">StandardWatchEventKinds</span>._

  <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.FileWatcher" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd)">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Seq[java.io.File]" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).dirsToWatch">dirsToWatch</a> = <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).filesToWatch" title="Seq[java.io.File]">filesToWatch</a>.<span title="(p: java.io.File =&gt; Boolean)Seq[java.io.File]">filter</span> <span class="delimiter">{</span> <a title="java.io.File" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).dirsToWatch.$anonfun.file">file</a> =&gt;
      <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).dirsToWatch.$anonfun.file" title="java.io.File">file</a>.<span title="()Boolean">isDirectory</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Boolean(true)" class="keyword">true</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).dirsToWatch.$anonfun.file" title="java.io.File">file</a>.<span title="()Boolean">isFile</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// JDK7 WatchService can't watch files</span>
        <a href="#play.runsupport;JDK7FileWatchService.logger" title="play.runsupport.LoggerProxy">logger</a>.<a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy.warn" title="(message: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="String(&quot;JDK7 WatchService only supports watching directories, but an attempt has been made to watch the file: &quot;)" class="string">&quot;JDK7 WatchService only supports watching directories, but an attempt has been made to watch the file: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).dirsToWatch.$anonfun.file" title="java.io.File">file</a>.<span title="()String">getCanonicalPath</span><span class="delimiter">)</span>
        <a href="#play.runsupport;JDK7FileWatchService.logger" title="play.runsupport.LoggerProxy">logger</a>.<a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy.warn" title="(message: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="String(&quot;This file will not be watched. Either remove the file from playMonitoredFiles, or configure a different WatchService, eg:&quot;)" class="string">&quot;This file will not be watched. Either remove the file from playMonitoredFiles, or configure a different WatchService, eg:&quot;</span><span class="delimiter">)</span>
        <a href="#play.runsupport;JDK7FileWatchService.logger" title="play.runsupport.LoggerProxy">logger</a>.<a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy.warn" title="(message: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="String(&quot;PlayKeys.fileWatchService := play.runsupport.FileWatchService.jnotify(target.value)&quot;)" class="string">&quot;PlayKeys.fileWatchService := play.runsupport.FileWatchService.jnotify(target.value)&quot;</span><span class="delimiter">)</span>
        <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="java.nio.file.WatchService" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).watcher">watcher</a> = <span title="java.nio.file.FileSystems.type">FileSystems</span>.<span title="()java.nio.file.FileSystem">getDefault</span>.<span title="()java.nio.file.WatchService">newWatchService</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(dir: java.io.File)java.nio.file.WatchKey" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).watchDir">watchDir</a><span class="delimiter">(</span><a title="java.io.File" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).watchDir.dir">dir</a>: <span title="java.io.File">File</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).watchDir.dir" title="java.io.File">dir</a>.<span title="()java.nio.file.Path">toPath</span>.<span title="(x$1: java.nio.file.WatchService, x$2: Array[java.nio.file.WatchEvent.Kind[_]], x$3: &lt;repeated...&gt;[java.nio.file.WatchEvent.Modifier])java.nio.file.WatchKey">register</span><span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).watcher" title="java.nio.file.WatchService">watcher</a>, <span title="[T](xs: T*)(implicit evidence$2: scala.reflect.ClassTag[T])Array[T]">Array</span><span title="(xs: java.nio.file.WatchEvent.Kind[_]*)(implicit evidence$2: scala.reflect.ClassTag[java.nio.file.WatchEvent.Kind[_]])Array[java.nio.file.WatchEvent.Kind[_]]" class="delimiter">[</span>WatchEvent.<span title="java.nio.file.WatchEvent.Kind[_]">Kind</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[java.nio.file.WatchEvent.Kind[_]]" class="delimiter">(</span><span title="java.nio.file.WatchEvent.Kind[java.nio.file.Path]">ENTRY_CREATE</span>, <span title="java.nio.file.WatchEvent.Kind[java.nio.file.Path]">ENTRY_DELETE</span>, <span title="java.nio.file.WatchEvent.Kind[java.nio.file.Path]">ENTRY_MODIFY</span><span class="delimiter">)</span>,
        <span class="comment">// This custom modifier exists just for polling implementations of the watch service, and means poll every 2 seconds.</span>
        <span class="comment">// For non polling event based watchers, it has no effect.</span>
        com.sun.nio.file.SensitivityWatchEventModifier.<span title="com.sun.nio.file.SensitivityWatchEventModifier(HIGH)">HIGH</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">// Get all sub directories</span>
    <span class="keyword">val</span> <a title="Seq[java.io.File]" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).allDirsToWatch">allDirsToWatch</a> = <a href="#play.runsupport;JDK7FileWatchService.allSubDirectories" title="(dirs: Seq[java.io.File])Seq[java.io.File]">allSubDirectories</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).dirsToWatch" title="Seq[java.io.File]">dirsToWatch</a><span class="delimiter">)</span>
    <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).allDirsToWatch" title="Seq[java.io.File]">allDirsToWatch</a>.<span title="(f: java.io.File =&gt; java.nio.file.WatchKey)Unit">foreach</span><span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).watchDir" title="(dir: java.io.File)java.nio.file.WatchKey">watchDir</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Thread" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread">thread</a> = <span title="(x$1: Runnable, x$2: String)Thread" class="keyword">new</span> <span title="Thread">Thread</span><span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon" title="Runnable" class="keyword">new</a> <a title="anonymous class $anon extends Object with Runnable" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon">Runnable</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run">run</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.while$2" title="()Unit" class="delimiter">{</a>
            <span class="keyword">val</span> <a title="java.nio.file.WatchKey" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.watchKey">watchKey</a> = <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).watcher" title="java.nio.file.WatchService">watcher</a>.<span title="()java.nio.file.WatchKey">take</span><span class="delimiter">(</span><span class="delimiter">)</span>

            <span class="keyword">val</span> <a title="java.util.List[java.nio.file.WatchEvent[_]]" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.events">events</a> = <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.watchKey" title="java.nio.file.WatchKey">watchKey</a>.<span title="()java.util.List[java.nio.file.WatchEvent[_]]">pollEvents</span><span class="delimiter">(</span><span class="delimiter">)</span>

            <span class="keyword">import</span> scala.collection.<span title="scala.collection.JavaConversions.type">JavaConversions</span>._
            <span class="comment">// If a directory has been created, we must watch it and its sub directories</span>
            <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.events" title="(l: java.util.List[java.nio.file.WatchEvent[_]])scala.collection.mutable.Buffer[java.nio.file.WatchEvent[_]]">events</a>.<span title="(f: java.nio.file.WatchEvent[_] =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="java.nio.file.WatchEvent[_]" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.$anonfun.event">event</a> =&gt;

              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.$anonfun.event" title="java.nio.file.WatchEvent[_]">event</a>.<span title="()java.nio.file.WatchEvent.Kind[?0]">kind</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.nio.file.WatchEvent.Kind[java.nio.file.Path]">ENTRY_CREATE</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="java.io.File" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.$anonfun.file">file</a> = <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.watchKey" title="java.nio.file.WatchKey">watchKey</a>.<span title="()java.nio.file.Watchable">watchable</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.nio.file.Path" class="delimiter">[</span><span title="java.nio.file.Path">Path</span><span class="delimiter">]</span>.<span title="(x$1: java.nio.file.Path)java.nio.file.Path">resolve</span><span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.$anonfun.event" title="java.nio.file.WatchEvent[_]">event</a>.<span title="()?0">context</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.nio.file.Path" class="delimiter">[</span><span title="java.nio.file.Path">Path</span><span class="delimiter">]</span><span class="delimiter">)</span>.<span title="()java.io.File">toFile</span>

                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.$anonfun.file" title="java.io.File">file</a>.<span title="()Boolean">isDirectory</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <a href="#play.runsupport;JDK7FileWatchService.allSubDirectories" title="(dirs: Seq[java.io.File])Seq[java.io.File]">allSubDirectories</a><span class="delimiter">(</span><span title="(elems: java.io.File*)Seq[java.io.File]">Seq</span><span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.$anonfun.file" title="java.io.File">file</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: java.io.File =&gt; java.nio.file.WatchKey)Unit">foreach</span><span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).watchDir" title="(dir: java.io.File)java.nio.file.WatchKey">watchDir</a><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>

            <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).onChange" title="()Unit">onChange</a><span class="delimiter">(</span><span class="delimiter">)</span>

            <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.watchKey" title="java.nio.file.WatchKey">watchKey</a>.<span title="()Boolean">reset</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread;$anon.run.e">e</a><span class="delimiter">)</span> =&gt; <span class="comment">// Do nothing, this means the watch service has been closed, or we've been interrupted.</span>
        <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
          <span class="comment">// Just in case it wasn't closed.</span>
          <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).watcher" title="java.nio.file.WatchService">watcher</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>, <span title="String(&quot;sbt-play-watch-service&quot;)" class="string">&quot;sbt-play-watch-service&quot;</span><span class="delimiter">)</span>
    <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread" title="Thread">thread</a>.<span title="(x$1: Boolean)Unit">setDaemon</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
    <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).thread" title="Thread">thread</a>.<span title="()Unit">start</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd);$anon" title="play.runsupport.FileWatcher" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.runsupport.FileWatcher" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd);$anon">FileWatcher</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;JDK7FileWatchService.watch(0950aeb3fd);$anon.stop">stop</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <a href="#play.runsupport;JDK7FileWatchService.watch(0950aeb3fd).watcher" title="java.nio.file.WatchService">watcher</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(dirs: Seq[java.io.File])Seq[java.io.File]" id="play.runsupport;JDK7FileWatchService.allSubDirectories">allSubDirectories</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;JDK7FileWatchService.allSubDirectories.dirs">dirs</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="delimiter">(</span><a href="#play.runsupport;JDK7FileWatchService.allSubDirectories.dirs" title="implicit sbt.PathExtra.filesToFinder : (cc: Traversable[java.io.File])sbt.PathFinder">dirs</a> <span title="(filter: sbt.FileFilter)sbt.PathFinder">**</span> <span class="delimiter">(</span><span title="sbt.DirectoryFilter.type">DirectoryFilter</span> <span title="(filter: sbt.FileFilter)sbt.FileFilter">--</span> <span title="sbt.HiddenFileFilter.type">HiddenFileFilter</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Seq[java.io.File]">get</span>.<span title="=&gt; Seq[java.io.File]">distinct</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Watch service that delegates to a try. This allows it to exist without reporting an exception unless it's used.
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>play<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class OptionalFileWatchServiceDelegate extends AnyRef with play.runsupport.FileWatchService" id="play.runsupport;OptionalFileWatchServiceDelegate">OptionalFileWatchServiceDelegate</a><a href="#play.runsupport;OptionalFileWatchServiceDelegate" title="play.runsupport.OptionalFileWatchServiceDelegate" class="delimiter">(</a><span class="keyword">val</span> <a title="scala.util.Try[play.runsupport.FileWatchService]" id="play.runsupport;OptionalFileWatchServiceDelegate.watchService">watchService</a>: <span title="scala.util.Try[play.runsupport.FileWatchService]">Try</span><span class="delimiter">[</span>FileWatchService<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.runsupport;FileWatchService" title="play.runsupport.FileWatchService">FileWatchService</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.FileWatcher" id="play.runsupport;OptionalFileWatchServiceDelegate.watch(0950aeb3fd)">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;OptionalFileWatchServiceDelegate.watch(0950aeb3fd).filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport;OptionalFileWatchServiceDelegate.watch(0950aeb3fd).onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#play.runsupport;OptionalFileWatchServiceDelegate.watchService" title="=&gt; scala.util.Try[play.runsupport.FileWatchService]">watchService</a>.<span title="(f: play.runsupport.FileWatchService =&gt; play.runsupport.FileWatcher)scala.util.Try[play.runsupport.FileWatcher]">map</span><span class="delimiter">(</span><a title="play.runsupport.FileWatchService" id="play.runsupport;OptionalFileWatchServiceDelegate.watch(0950aeb3fd).$anonfun.ws">ws</a> =&gt; <a href="#play.runsupport;OptionalFileWatchServiceDelegate.watch(0950aeb3fd).$anonfun.ws" title="play.runsupport.FileWatchService">ws</a>.<a href="#play.runsupport;FileWatchService.watch(0950aeb3fd)" title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.FileWatcher">watch</a><span class="delimiter">(</span><a href="#play.runsupport;OptionalFileWatchServiceDelegate.watch(0950aeb3fd).filesToWatch" title="Seq[java.io.File]">filesToWatch</a>, <a href="#play.runsupport;OptionalFileWatchServiceDelegate.watch(0950aeb3fd).onChange" title="() =&gt; Unit">onChange</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; play.runsupport.FileWatcher">get</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Provides a global (cross classloader) static var.
 *
 * This does not leak classloaders (unless the value passed to it references a classloader that shouldn't be leaked).
 * It uses an MBeanServer to store an AtomicReference as an mbean, exposing the get method of the AtomicReference as an
 * mbean operation, so that the value can be retrieved.
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>runsupport<span class="delimiter">]</span> <span class="keyword">object</span> <a title="play.runsupport.GlobalStaticVar.type" id="play.runsupport.GlobalStaticVar">GlobalStaticVar</a> <a href="#play.runsupport.GlobalStaticVar" title="play.runsupport.GlobalStaticVar.type" class="delimiter">{</a>
  <span class="keyword">import</span> javax.management._
  <span class="keyword">import</span> javax.management.modelmbean._
  <span class="keyword">import</span> java.lang.management._
  <span class="keyword">import</span> java.util.concurrent.atomic.AtomicReference

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: String)javax.management.ObjectName" id="play.runsupport.GlobalStaticVar.objectName">objectName</a><span class="delimiter">(</span><a title="String" id="play.runsupport.GlobalStaticVar.objectName.name">name</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="javax.management.ObjectName" class="keyword">new</span> <span title="javax.management.ObjectName">ObjectName</span><span class="delimiter">(</span><span title="String(&quot;:type=GlobalStaticVar,name=&quot;)" class="string">&quot;:type=GlobalStaticVar,name=&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.runsupport.GlobalStaticVar.objectName.name" title="String">name</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Set a global static variable with the given name.
   */</span>
  <span class="keyword">def</span> <a title="(name: String, value: AnyRef)Unit" id="play.runsupport.GlobalStaticVar.set">set</a><span class="delimiter">(</span><a title="String" id="play.runsupport.GlobalStaticVar.set.name">name</a>: <span title="String">String</span>, <a title="AnyRef" id="play.runsupport.GlobalStaticVar.set.value">value</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>

    <span class="keyword">val</span> <a title="java.util.concurrent.atomic.AtomicReference[AnyRef]" id="play.runsupport.GlobalStaticVar.set.reference">reference</a> = <span title="java.util.concurrent.atomic.AtomicReference[AnyRef]" class="keyword">new</span> <span title="java.util.concurrent.atomic.AtomicReference[AnyRef]">AtomicReference</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.value" title="AnyRef">value</a><span class="delimiter">)</span>

    <span class="comment">// Now we construct a MBean that exposes the AtomicReference.get method</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.GlobalStaticVar.set.getMethod">getMethod</a> = classOf<span title="Class[java.util.concurrent.atomic.AtomicReference[_]](classOf[java.util.concurrent.atomic.AtomicReference])" class="delimiter">[</span>AtomicReference<span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;get&quot;)" class="string">&quot;get&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="javax.management.modelmbean.ModelMBeanOperationInfo" id="play.runsupport.GlobalStaticVar.set.getInfo">getInfo</a> = <span title="javax.management.modelmbean.ModelMBeanOperationInfo" class="keyword">new</span> <span title="javax.management.modelmbean.ModelMBeanOperationInfo">ModelMBeanOperationInfo</span><span class="delimiter">(</span><span title="String(&quot;The value&quot;)" class="string">&quot;The value&quot;</span>, <a href="#play.runsupport.GlobalStaticVar.set.getMethod" title="java.lang.reflect.Method">getMethod</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="javax.management.modelmbean.ModelMBeanInfoSupport" id="play.runsupport.GlobalStaticVar.set.mmbi">mmbi</a> = <span title="(x$1: String, x$2: String, x$3: Array[javax.management.modelmbean.ModelMBeanAttributeInfo], x$4: Array[javax.management.modelmbean.ModelMBeanConstructorInfo], x$5: Array[javax.management.modelmbean.ModelMBeanOperationInfo], x$6: Array[javax.management.modelmbean.ModelMBeanNotificationInfo])javax.management.modelmbean.ModelMBeanInfoSupport" class="keyword">new</span> <span title="javax.management.modelmbean.ModelMBeanInfoSupport">ModelMBeanInfoSupport</span><span class="delimiter">(</span><span title="String(&quot;GlobalStaticVar&quot;)" class="string">&quot;GlobalStaticVar&quot;</span>,
      <span title="String(&quot;A global static variable&quot;)" class="string">&quot;A global static variable&quot;</span>,
      <span title="Null(null)" class="keyword">null</span>, <span class="comment">// no attributes</span>
      <span title="Null(null)" class="keyword">null</span>, <span class="comment">// no constructors</span>
      <span title="(xs: javax.management.modelmbean.ModelMBeanOperationInfo*)(implicit evidence$2: scala.reflect.ClassTag[javax.management.modelmbean.ModelMBeanOperationInfo])Array[javax.management.modelmbean.ModelMBeanOperationInfo]">Array</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[javax.management.modelmbean.ModelMBeanOperationInfo]" class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.getInfo" title="javax.management.modelmbean.ModelMBeanOperationInfo">getInfo</a><span class="delimiter">)</span>, <span class="comment">// the operation</span>
      <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>; <span class="comment">// no notifications</span>

    <span class="keyword">val</span> <a title="javax.management.modelmbean.RequiredModelMBean" id="play.runsupport.GlobalStaticVar.set.mmb">mmb</a> = <span title="(x$1: javax.management.modelmbean.ModelMBeanInfo)javax.management.modelmbean.RequiredModelMBean" class="keyword">new</span> <span title="javax.management.modelmbean.RequiredModelMBean">RequiredModelMBean</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.mmbi" title="javax.management.modelmbean.ModelMBeanInfoSupport">mmbi</a><span class="delimiter">)</span>
    <a href="#play.runsupport.GlobalStaticVar.set.mmb" title="javax.management.modelmbean.RequiredModelMBean">mmb</a>.<span title="(x$1: Any, x$2: String)Unit">setManagedResource</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.reference" title="java.util.concurrent.atomic.AtomicReference[AnyRef]">reference</a>, <span title="String(&quot;ObjectReference&quot;)" class="string">&quot;ObjectReference&quot;</span><span class="delimiter">)</span>

    <span class="comment">// Register the Model MBean in the MBean Server</span>
    <span title="java.lang.management.ManagementFactory.type">ManagementFactory</span>.<span title="()javax.management.MBeanServer">getPlatformMBeanServer</span>.<span title="(x$1: Any, x$2: javax.management.ObjectName)javax.management.ObjectInstance">registerMBean</span><span title="Unit" class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.mmb" title="javax.management.modelmbean.RequiredModelMBean">mmb</a>, <a href="#play.runsupport.GlobalStaticVar.objectName" title="(name: String)javax.management.ObjectName">objectName</a><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.name" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Get a global static variable by the given name.
   */</span>
  <span class="keyword">def</span> <a title="[T](name: String)(implicit ct: scala.reflect.ClassTag[T])Option[T]" id="play.runsupport.GlobalStaticVar.get">get</a><span class="delimiter">[</span><a title="" id="play.runsupport.GlobalStaticVar.get;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="play.runsupport.GlobalStaticVar.get.name">name</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.ClassTag[T]" id="play.runsupport.GlobalStaticVar.get.ct">ct</a>: <span title="scala.reflect.ClassTag[T]">ClassTag</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Object" id="play.runsupport.GlobalStaticVar.get.value">value</a> = <span title="java.lang.management.ManagementFactory.type">ManagementFactory</span>.<span title="()javax.management.MBeanServer">getPlatformMBeanServer</span>.<span title="(x$1: javax.management.ObjectName, x$2: String, x$3: Array[Object], x$4: Array[String])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.objectName" title="(name: String)javax.management.ObjectName">objectName</a><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.name" title="String">name</a><span class="delimiter">)</span>, <span title="String(&quot;get&quot;)" class="string">&quot;get&quot;</span>, <span title="Array.type">Array</span>.<span title="(implicit evidence$1: scala.reflect.ClassTag[Object])Array[Object]">empty</span>, <span title="Array.type">Array</span>.<span title="(implicit evidence$1: scala.reflect.ClassTag[String])Array[String]">empty</span><span class="delimiter">)</span>
      <span title="Option[T]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.ct" title="scala.reflect.ClassTag[T]">ct</a>.<span title="=&gt; Class[_]">runtimeClass</span>.<span title="(x$1: Any)Boolean">isInstance</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.value" title="Object">value</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="(x: T)Some[T]">Some</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.value" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="T" class="delimiter">[</span><a href="#play.runsupport.GlobalStaticVar.get;T" title="T">T</a><span class="delimiter">]</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)ClassCastException" class="keyword">new</span> <span title="ClassCastException">ClassCastException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Global static var &quot;)">Global static var $</span><a href="#play.runsupport.GlobalStaticVar.get.name" title="String">name</a><span title="String(&quot; is not an instance of &quot;)"> is not an instance of $</span><span class="delimiter">{</span><a href="#play.runsupport.GlobalStaticVar.get.ct" title="scala.reflect.ClassTag[T]">ct</a>.<span title="=&gt; Class[_]">runtimeClass</span><span class="delimiter">}</span><span title="String(&quot;, but is actually a &quot;)">, but is actually a $</span><span class="delimiter">{</span><span title="(x: Object)Option[Object]">Option</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.value" title="Object">value</a><span class="delimiter">)</span>.<span title="(ifEmpty: =&gt; String)(f: Object =&gt; String)String">fold</span><span class="delimiter">(</span><span title="String(&quot;null&quot;)" class="string">&quot;null&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.$anonfun.x$5" title="Object">_</a>.<span title="()Class[_]">getClass</span>.<span title="()String">getName</span><span class="delimiter">)</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="javax.management.InstanceNotFoundException" id="play.runsupport.GlobalStaticVar.get.e">e</a>: <span title="javax.management.InstanceNotFoundException">InstanceNotFoundException</span> =&gt;
        <span title="None.type">None</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Clear a global static variable with the given name.
   */</span>
  <span class="keyword">def</span> <a title="(name: String)Unit" id="play.runsupport.GlobalStaticVar.remove">remove</a><span class="delimiter">(</span><a title="String" id="play.runsupport.GlobalStaticVar.remove.name">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <span title="java.lang.management.ManagementFactory.type">ManagementFactory</span>.<span title="()javax.management.MBeanServer">getPlatformMBeanServer</span>.<span title="(x$1: javax.management.ObjectName)Unit">unregisterMBean</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.objectName" title="(name: String)javax.management.ObjectName">objectName</a><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.remove.name" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="javax.management.InstanceNotFoundException" id="play.runsupport.GlobalStaticVar.remove.e">e</a>: <span title="javax.management.InstanceNotFoundException">InstanceNotFoundException</span> =&gt;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

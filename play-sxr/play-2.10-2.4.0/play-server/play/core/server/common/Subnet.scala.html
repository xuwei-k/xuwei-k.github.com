<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play-server/play/core/server/common/Subnet.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.core.server.common

<span class="keyword">import</span> java.net.InetAddress

<span class="keyword">private</span><span class="delimiter">[</span>common<span class="delimiter">]</span> <span class="keyword">case class</span> <a title="class Subnet extends AnyRef with Product with Serializable" id="play.core.server.common;Subnet">Subnet</a><a href="#play.core.server.common;Subnet" title="Product" class="delimiter">(</a><a title="java.net.InetAddress" id="play.core.server.common;Subnet.ip">ip</a>: <span title="java.net.InetAddress">InetAddress</span>, <a title="Option[Int]" id="play.core.server.common.Subnet.<init>$default$2">cidr</a>: <span title="Option[Int]">Option</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span title="None.type">None</span><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Option[Int]" id="play.core.server.common;Subnet.remainderOfMask">remainderOfMask</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
    <a title="Int" id="play.core.server.common;Subnet.remainderOfMask.$anonfun.m">m</a> &lt;- <a href="#play.core.server.common.Subnet.<init>$default$2" title="(f: Int =&gt; Option[Int])Option[Int]">cidr</a>
    <a title="Int" id="play.core.server.common;Subnet.remainderOfMask.$anonfun.$anonfun.result">result</a> &lt;- <a href="#play.core.server.common;Subnet.maskBits" title="(leadingBits: Int)Option[Int]">maskBits</a><span title="(f: Int =&gt; Int)Option[Int]" class="delimiter">(</span><a href="#play.core.server.common;Subnet.remainderOfMask.$anonfun.m" title="Int">m</a> <span title="(x: Int)Int">%</span> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#play.core.server.common;Subnet.remainderOfMask.$anonfun.$anonfun.result" title="Int">result</a>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(leadingBits: Int)Option[Int]" id="play.core.server.common;Subnet.maskBits">maskBits</a><span class="delimiter">(</span><a title="Int" id="play.core.server.common;Subnet.maskBits.leadingBits">leadingBits</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#play.core.server.common;Subnet.maskBits.leadingBits" title="Int">leadingBits</a> <span title="Option[Int]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Int">i</span> <span class="keyword">if</span> <span title="Int">i</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(1)" class="int">1</span> <span title="(x: Boolean)Boolean">||</span> <span title="Int">i</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(7)" class="int">7</span> =&gt; <span title="None.type">None</span>
    <span class="keyword">case</span> <span title="Int">i</span> =&gt; <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><span title="=&gt; Int">~</span><span class="delimiter">(</span><span title="Int(255)" class="int">0xff</span> <span title="(x: Int)Int">&gt;&gt;&gt;</span> <a href="#play.core.server.common;Subnet.maskBits.leadingBits" title="Int">leadingBits</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(otherIp: java.net.InetAddress)Boolean" id="play.core.server.common;Subnet.isInRange">isInRange</a><span class="delimiter">(</span><a title="java.net.InetAddress" id="play.core.server.common;Subnet.isInRange.otherIp">otherIp</a>: <span title="java.net.InetAddress">InetAddress</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="play.core.server.common;Subnet.isInRange.mask">mask</a> = <a href="#play.core.server.common.Subnet.<init>$default$2" title="=&gt; Option[Int]">cidr</a>.<span title="(default: =&gt; Int)Int">getOrElse</span><span class="delimiter">(</span><a href="#play.core.server.common;Subnet.ip" title="=&gt; java.net.InetAddress">ip</a>.<span title="()Array[Byte]">getAddress</span>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">*</span> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>
    <a href="#play.core.server.common;Subnet.ip" title="=&gt; java.net.InetAddress">ip</a>.<span title="()Class[_]">getClass</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#play.core.server.common;Subnet.isInRange.otherIp" title="java.net.InetAddress">otherIp</a>.<span title="()Class[_]">getClass</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span>
      <a href="#play.core.server.common;Subnet.ip" title="=&gt; java.net.InetAddress">ip</a>.<span title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">getAddress</span>.<span title="(n: Int)Array[Byte]">take</span><span title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]" class="delimiter">(</span><a href="#play.core.server.common;Subnet.isInRange.mask" title="Int">mask</a> <span title="(x: Int)Int">/</span> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>.<span title="=&gt; List[Byte]">toList</span>.<span title="(that: Any)Boolean">equals</span><span class="delimiter">(</span><a href="#play.core.server.common;Subnet.isInRange.otherIp" title="java.net.InetAddress">otherIp</a>.<span title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">getAddress</span>.<span title="(n: Int)Array[Byte]">take</span><span title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]" class="delimiter">(</span><a href="#play.core.server.common;Subnet.isInRange.mask" title="Int">mask</a> <span title="(x: Int)Int">/</span> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>.<span title="=&gt; List[Byte]">toList</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span>
      <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Byte" id="play.core.server.common;Subnet.isInRange.$anonfun.a">a</a> &lt;- <a href="#play.core.server.common;Subnet.ip" title="=&gt; java.net.InetAddress">ip</a>.<span title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">getAddress</span>.<span title="(n: Int)Array[Byte]">drop</span><span title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]" class="delimiter">(</span><a href="#play.core.server.common;Subnet.isInRange.mask" title="Int">mask</a> <span title="(x: Int)Int">/</span> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>.<span title="(f: Byte =&gt; Option[Boolean])Option[Boolean]">headOption</span>
        <a title="Byte" id="play.core.server.common;Subnet.isInRange.$anonfun.$anonfun.b">b</a> &lt;- <a href="#play.core.server.common;Subnet.isInRange.otherIp" title="java.net.InetAddress">otherIp</a>.<span title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">getAddress</span>.<span title="(n: Int)Array[Byte]">drop</span><span title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]" class="delimiter">(</span><a href="#play.core.server.common;Subnet.isInRange.mask" title="Int">mask</a> <span title="(x: Int)Int">/</span> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>.<span title="(f: Byte =&gt; Option[Boolean])Option[Boolean]">headOption</span>
        <a title="Int" id="play.core.server.common;Subnet.isInRange.$anonfun.$anonfun.$anonfun.c">c</a> &lt;- <a href="#play.core.server.common;Subnet.remainderOfMask" title="(f: Int =&gt; Boolean)Option[Boolean]">remainderOfMask</a>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">(</span><a href="#play.core.server.common;Subnet.isInRange.$anonfun.a" title="Byte">a</a> <span title="(x: Int)Int">&amp;</span> <a href="#play.core.server.common;Subnet.isInRange.$anonfun.$anonfun.$anonfun.c" title="Int">c</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">==</span> <span class="delimiter">(</span><a href="#play.core.server.common;Subnet.isInRange.$anonfun.$anonfun.b" title="Byte">b</a> <span title="(x: Int)Int">&amp;</span> <a href="#play.core.server.common;Subnet.isInRange.$anonfun.$anonfun.$anonfun.c" title="Int">c</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; Boolean)Boolean">getOrElse</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">private</span><span class="delimiter">[</span>common<span class="delimiter">]</span> <span class="keyword">object</span> <a title="play.core.server.common.Subnet.type" id="play.core.server.common.Subnet.readResolve">Subnet</a> <a href="#play.core.server.common.Subnet.readResolve" title="play.core.server.common.Subnet.type" class="delimiter">{</a>
  <span class="keyword">def</span> <a title="(s: String)play.core.server.common.Subnet" id="play.core.server.common.Subnet.apply(603590655c)">apply</a><span class="delimiter">(</span><a title="String" id="play.core.server.common.Subnet.apply(603590655c).s">s</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#play.core.server.common;Subnet" title="play.core.server.common.Subnet">Subnet</a> = <a href="#play.core.server.common.Subnet.apply(603590655c).s" title="String">s</a>.<span title="(x$1: String)Array[String]">split</span><span class="delimiter">(</span><span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span class="delimiter">)</span> <span title="play.core.server.common.Subnet" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#play.core.server.common.Subnet.apply(603590655c).<unapply-selector>" title="(x: Array[String])Option[IndexedSeq[String]]">Array</a><span class="delimiter">(</span><span title="String">ip</span>, <a title="String" id="play.core.server.common.Subnet.apply(603590655c).subnet">subnet</a><span class="delimiter">)</span> =&gt; <a href="#play.core.server.common;Subnet" title="(ip: java.net.InetAddress, cidr: Option[Int])play.core.server.common.Subnet">Subnet</a><span class="delimiter">(</span><span title="java.net.InetAddress.type">InetAddress</span>.<span title="(x$1: String)java.net.InetAddress">getByName</span><span class="delimiter">(</span><span title="String">ip</span><span class="delimiter">)</span>, <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#play.core.server.common.Subnet.apply(603590655c).subnet" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">subnet</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a href="#play.core.server.common.Subnet.apply(603590655c).<unapply-selector>" title="(x: Array[String])Option[IndexedSeq[String]]">Array</a><span class="delimiter">(</span><span title="String">ip</span><span class="delimiter">)</span> =&gt; <a href="#play.core.server.common;Subnet" title="(ip: java.net.InetAddress, cidr: Option[Int])play.core.server.common.Subnet">Subnet</a><span class="delimiter">(</span><span title="java.net.InetAddress.type">InetAddress</span>.<span title="(x$1: String)java.net.InetAddress">getByName</span><span class="delimiter">(</span><span title="String">ip</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> _ =&gt; <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;&quot;)">$</span><a href="#play.core.server.common.Subnet.apply(603590655c).s" title="String">s</a><span title="String(&quot; contains more than one \'/\'.&quot;)" class="string"> contains more than one '/'.&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(b: Int)String" id="play.core.server.common.Subnet.toString(b4573d4e19)">toString</a><span class="delimiter">(</span><a title="Int" id="play.core.server.common.Subnet.toString(b4573d4e19).b">b</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span title="Integer.type">Integer</span>.<span title="(x$1: Int)String">toBinaryString</span><span class="delimiter">(</span><a href="#play.core.server.common.Subnet.toString(b4573d4e19).b" title="Int">b</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

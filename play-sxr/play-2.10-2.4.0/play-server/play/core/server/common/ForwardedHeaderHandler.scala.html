<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play-server/play/core/server/common/ForwardedHeaderHandler.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.core.server.common

<span class="keyword">import</span> play.api.Configuration
<span class="keyword">import</span> play.api.mvc.Headers
<span class="keyword">import</span> play.core.server.common.<a href="NodeIdentifierParser.scala.html#play.core.server.common.NodeIdentifierParser" title="play.core.server.common.NodeIdentifierParser.type">NodeIdentifierParser</a>.Ip

<span class="keyword">import</span> <a href="#play.core.server.common.ForwardedHeaderHandler" title="play.core.server.common.ForwardedHeaderHandler.type">ForwardedHeaderHandler</a>._

<span class="comment">/**
 * The ForwardedHeaderHandler class retrieves the last untrusted proxy
 * from the Forwarded-Headers or the X-Forwarded-*-Headers.
 *
 * To find the last untrusted proxy it removes all trusted proxy ip addresses
 * from the end of the forwarded headers. The last header that is present
 * is the last untrusted proxy.
 *
 * It is configured by two configuration options:
 * &lt;dl&gt;
 *   &lt;dt&gt;play.http.forwarded.version&lt;/dt&gt;
 *   &lt;dd&gt;
 *     The version of the forwarded headers ist uses to parse the headers. It can be
 *     &lt;code&gt;x-forwarded&lt;/code&gt; for legacy headers or
 *     &lt;code&gt;rfc7239&lt;/code&gt; for the definition from the RFC 7239 &lt;br&gt;
 *     Default is x-forwarded.
 *   &lt;/dd&gt;
 *   &lt;dt&gt;play.http.forwarded.trustedProxies&lt;/dt&gt;
 *   &lt;dd&gt;
 *     A list of proxies that are ignored when getting the remote address or the remote port.
 *     It can have optionally an address block size. When the address block size is set,
 *     all IP-addresses in the range of the subnet will be treated as trusted.
 *   &lt;/dd&gt;
 * &lt;/dl&gt;
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>server<span class="delimiter">]</span> <span class="keyword">class</span> <a title="class ForwardedHeaderHandler extends AnyRef" id="play.core.server.common;ForwardedHeaderHandler">ForwardedHeaderHandler</a><a href="#play.core.server.common;ForwardedHeaderHandler" title="play.core.server.common.ForwardedHeaderHandler" class="delimiter">(</a><a title="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig" id="play.core.server.common;ForwardedHeaderHandler.configuration">configuration</a>: <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig" title="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig">ForwardedHeaderHandlerConfig</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(headers: play.api.mvc.Headers)Option[String]" id="play.core.server.common;ForwardedHeaderHandler.remoteProtocol">remoteProtocol</a><span class="delimiter">(</span><a title="play.api.mvc.Headers" id="play.core.server.common;ForwardedHeaderHandler.remoteProtocol.headers">headers</a>: <a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers" title="play.api.mvc.Headers">Headers</a><span class="delimiter">)</span>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#play.core.server.common;ForwardedHeaderHandler.firstUntrustedForwarded" title="(forwardedHeaders: Seq[Map[String,String]], trustedProxies: Seq[play.core.server.common.Subnet])Map[String,String]">firstUntrustedForwarded</a><span class="delimiter">(</span><a href="#play.core.server.common;ForwardedHeaderHandler.configuration" title="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig">configuration</a>.<a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.forwardedHeaders" title="(v1: play.api.mvc.Headers)Seq[Map[String,String]]">forwardedHeaders</a><span class="delimiter">(</span><a href="#play.core.server.common;ForwardedHeaderHandler.remoteProtocol.headers" title="play.api.mvc.Headers">headers</a><span class="delimiter">)</span>, <a href="#play.core.server.common;ForwardedHeaderHandler.configuration" title="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig">configuration</a>.<a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.trustedProxies" title="=&gt; List[play.core.server.common.Subnet]">trustedProxies</a><span class="delimiter">)</span>.<span title="(key: String)Option[String]">get</span><span class="delimiter">(</span><span title="String(&quot;proto&quot;)" class="string">&quot;proto&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(headers: play.api.mvc.Headers)Option[String]" id="play.core.server.common;ForwardedHeaderHandler.remoteAddress">remoteAddress</a><span class="delimiter">(</span><a title="play.api.mvc.Headers" id="play.core.server.common;ForwardedHeaderHandler.remoteAddress.headers">headers</a>: <a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers" title="play.api.mvc.Headers">Headers</a><span class="delimiter">)</span>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#play.core.server.common;ForwardedHeaderHandler.firstUntrustedForwarded" title="(forwardedHeaders: Seq[Map[String,String]], trustedProxies: Seq[play.core.server.common.Subnet])Map[String,String]">firstUntrustedForwarded</a><span class="delimiter">(</span><a href="#play.core.server.common;ForwardedHeaderHandler.configuration" title="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig">configuration</a>.<a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.forwardedHeaders" title="(v1: play.api.mvc.Headers)Seq[Map[String,String]]">forwardedHeaders</a><span class="delimiter">(</span><a href="#play.core.server.common;ForwardedHeaderHandler.remoteAddress.headers" title="play.api.mvc.Headers">headers</a><span class="delimiter">)</span>, <a href="#play.core.server.common;ForwardedHeaderHandler.configuration" title="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig">configuration</a>.<a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.trustedProxies" title="=&gt; List[play.core.server.common.Subnet]">trustedProxies</a><span class="delimiter">)</span>.<span title="(key: String)Option[String]">get</span><span class="delimiter">(</span><span title="String(&quot;for&quot;)" class="string">&quot;for&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(forwardedHeaders: Seq[Map[String,String]], trustedProxies: Seq[play.core.server.common.Subnet])Map[String,String]" id="play.core.server.common;ForwardedHeaderHandler.firstUntrustedForwarded">firstUntrustedForwarded</a><span class="delimiter">(</span>
    <a title="Seq[Map[String,String]]" id="play.core.server.common;ForwardedHeaderHandler.firstUntrustedForwarded.forwardedHeaders">forwardedHeaders</a>: <span title="Seq[Map[String,String]]">Seq</span><span class="delimiter">[</span>Map<span class="delimiter">[</span>String, String<span class="delimiter">]</span><span class="delimiter">]</span>,
    <a title="Seq[play.core.server.common.Subnet]" id="play.core.server.common;ForwardedHeaderHandler.firstUntrustedForwarded.trustedProxies">trustedProxies</a>: <span title="Seq[play.core.server.common.Subnet]">Seq</span><span class="delimiter">[</span>Subnet<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Map[String,String]">Map</span><span class="delimiter">[</span>String, String<span class="delimiter">]</span> = <a href="#play.core.server.common;ForwardedHeaderHandler.firstUntrustedForwarded.forwardedHeaders" title="Seq[Map[String,String]]">forwardedHeaders</a>
    .<span title="=&gt; Seq[Map[String,String]]">reverse</span>
    .<span title="(p: Map[String,String] =&gt; Boolean)Seq[Map[String,String]]">dropWhile</span><span class="delimiter">(</span><a title="Map[String,String]" id="play.core.server.common;ForwardedHeaderHandler.firstUntrustedForwarded.$anonfun.m">m</a> =&gt; <span class="delimiter">{</span>
      <a href="#play.core.server.common;ForwardedHeaderHandler.isTrusted" title="(s: String, trustedProxies: Seq[play.core.server.common.Subnet])Boolean">isTrusted</a><span class="delimiter">(</span><a href="#play.core.server.common;ForwardedHeaderHandler.firstUntrustedForwarded.$anonfun.m" title="Map[String,String]">m</a>.<span title="(key: String, default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><span title="String(&quot;for&quot;)" class="string">&quot;for&quot;</span>, <span title="String(&quot;unknown&quot;)" class="string">&quot;unknown&quot;</span><span class="delimiter">)</span>, <a href="#play.core.server.common;ForwardedHeaderHandler.firstUntrustedForwarded.trustedProxies" title="Seq[play.core.server.common.Subnet]">trustedProxies</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>
    .<span title="=&gt; Option[Map[String,String]]">headOption</span>
    .<span title="(default: =&gt; Map[String,String])Map[String,String]">getOrElse</span><span class="delimiter">(</span><span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="scala.collection.immutable.Map[String,Nothing]">empty</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String, trustedProxies: Seq[play.core.server.common.Subnet])Boolean" id="play.core.server.common;ForwardedHeaderHandler.isTrusted">isTrusted</a><span class="delimiter">(</span><a title="String" id="play.core.server.common;ForwardedHeaderHandler.isTrusted.s">s</a>: <span title="String">String</span>, <a title="Seq[play.core.server.common.Subnet]" id="play.core.server.common;ForwardedHeaderHandler.isTrusted.trustedProxies">trustedProxies</a>: <span title="Seq[play.core.server.common.Subnet]">Seq</span><span class="delimiter">[</span>Subnet<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
    <a href="NodeIdentifierParser.scala.html#play.core.server.common.NodeIdentifierParser" title="play.core.server.common.NodeIdentifierParser.type">NodeIdentifierParser</a>.<a href="NodeIdentifierParser.scala.html#play.core.server.common.NodeIdentifierParser.parseNode" title="(s: String)Either[String,(play.core.server.common.NodeIdentifierParser.IpAddress, Option[play.core.server.common.NodeIdentifierParser.Port])]">parseNode</a><span class="delimiter">(</span><a href="#play.core.server.common;ForwardedHeaderHandler.isTrusted.s" title="String">s</a><span class="delimiter">)</span>.<span title="(fa: String =&gt; Boolean, fb: ((play.core.server.common.NodeIdentifierParser.IpAddress, Option[play.core.server.common.NodeIdentifierParser.Port])) =&gt; Boolean)Boolean">fold</span><span class="delimiter">(</span><a title="String" id="play.core.server.common;ForwardedHeaderHandler.isTrusted.$anonfun.x$1">_</a> =&gt; <span title="Boolean(false)" class="keyword">false</span>, <a href="#play.core.server.common;ForwardedHeaderHandler.isTrusted.$anonfun.x$2" title="(play.core.server.common.NodeIdentifierParser.IpAddress, Option[play.core.server.common.NodeIdentifierParser.Port])">_</a>.<span title="=&gt; play.core.server.common.NodeIdentifierParser.IpAddress">_1</span> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Ip<span class="delimiter">(</span><a title="java.net.InetAddress" id="play.core.server.common;ForwardedHeaderHandler.isTrusted.$anonfun.inet">inet</a><span class="delimiter">)</span> =&gt; <a href="#play.core.server.common;ForwardedHeaderHandler.isTrusted.trustedProxies" title="Seq[play.core.server.common.Subnet]">trustedProxies</a>.<span title="(p: play.core.server.common.Subnet =&gt; Boolean)Boolean">exists</span><span class="delimiter">(</span><a href="#play.core.server.common;ForwardedHeaderHandler.isTrusted.$anonfun.$anonfun.x$3" title="play.core.server.common.Subnet">_</a>.<a href="Subnet.scala.html#play.core.server.common;Subnet.isInRange" title="(otherIp: java.net.InetAddress)Boolean">isInRange</a><span class="delimiter">(</span><a href="#play.core.server.common;ForwardedHeaderHandler.isTrusted.$anonfun.inet" title="java.net.InetAddress">inet</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> _ =&gt; <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">private</span><span class="delimiter">[</span>server<span class="delimiter">]</span> <span class="keyword">object</span> <a title="play.core.server.common.ForwardedHeaderHandler.type" id="play.core.server.common.ForwardedHeaderHandler">ForwardedHeaderHandler</a> <a href="#play.core.server.common.ForwardedHeaderHandler" title="play.core.server.common.ForwardedHeaderHandler.type" class="delimiter">{</a>

  <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Version extends AnyRef" id="play.core.server.common.ForwardedHeaderHandler;Version">Version</a>
  <span class="keyword">case object</span> <a href="#play.core.server.common.ForwardedHeaderHandler.Rfc7239.productElement.x$1" title="play.core.server.common.ForwardedHeaderHandler.Rfc7239.type" id="play.core.server.common.ForwardedHeaderHandler.Rfc7239.readResolve">Rfc7239</a> <span title="Product" class="keyword">extends</span> <a href="#play.core.server.common.ForwardedHeaderHandler;Version" title="play.core.server.common.ForwardedHeaderHandler.Version">Version</a>
  <span class="keyword">case object</span> <a href="#play.core.server.common.ForwardedHeaderHandler.Xforwarded.productElement.x$1" title="play.core.server.common.ForwardedHeaderHandler.Xforwarded.type" id="play.core.server.common.ForwardedHeaderHandler.Xforwarded.readResolve">Xforwarded</a> <span title="Product" class="keyword">extends</span> <a href="#play.core.server.common.ForwardedHeaderHandler;Version" title="play.core.server.common.ForwardedHeaderHandler.Version">Version</a>

  <span class="keyword">case class</span> <a title="class ForwardedHeaderHandlerConfig extends AnyRef with Product with Serializable" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig">ForwardedHeaderHandlerConfig</a><a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig" title="Product" class="delimiter">(</a><a title="play.core.server.common.ForwardedHeaderHandler.Version" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.version">version</a>: <a href="#play.core.server.common.ForwardedHeaderHandler;Version" title="play.core.server.common.ForwardedHeaderHandler.Version">Version</a>, <a title="List[play.core.server.common.Subnet]" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.trustedProxies">trustedProxies</a>: <span title="List[play.core.server.common.Subnet]">List</span><span class="delimiter">[</span>Subnet<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; play.api.mvc.Headers =&gt; Seq[Map[String,String]]" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.forwardedHeaders">forwardedHeaders</a>: <span class="delimiter">(</span>Headers<span class="delimiter">)</span> =&gt; Seq<span class="delimiter">[</span>Map<span class="delimiter">[</span>String, String<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.version" title="=&gt; play.core.server.common.ForwardedHeaderHandler.Version">version</a> <span title="play.api.mvc.Headers =&gt; Seq[Map[String,String]]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#play.core.server.common.ForwardedHeaderHandler.Rfc7239.readResolve" title="play.core.server.common.ForwardedHeaderHandler.Rfc7239.type">Rfc7239</a> =&gt; <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers" title="=&gt; play.api.mvc.Headers =&gt; Seq[Map[String,String]]">rfc7239Headers</a>
      <span class="keyword">case</span> <a href="#play.core.server.common.ForwardedHeaderHandler.Xforwarded.readResolve" title="play.core.server.common.ForwardedHeaderHandler.Xforwarded.type">Xforwarded</a> =&gt; <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders" title="=&gt; play.api.mvc.Headers =&gt; Seq[Map[String,String]]">xforwardedHeaders</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="play.api.mvc.Headers =&gt; Seq[Map[String,String]]" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers">rfc7239Headers</a>: <span class="delimiter">(</span>Headers<span class="delimiter">)</span> =&gt; Seq<span class="delimiter">[</span>Map<span class="delimiter">[</span>String, String<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span> <span class="delimiter">(</span>headers: <a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers" title="play.api.mvc.Headers">Headers</a><span class="delimiter">)</span> =&gt;
      <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="String" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.$anonfun.fhs">fhs</a> &lt;- <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.headers" title="play.api.mvc.Headers">headers</a>.<a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers.getAll" title="(key: String)Seq[String]">getAll</a><span title="(f: String =&gt; scala.collection.GenTraversableOnce[String])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],String,Seq[String]])Seq[String]" class="delimiter">(</span><span title="String(&quot;Forwarded&quot;)" class="string">&quot;Forwarded&quot;</span><span class="delimiter">)</span>
        <a title="String" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.$anonfun.$anonfun.fh">fh</a> &lt;- <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.$anonfun.fhs" title="String">fhs</a>.<span title="(x$1: String)Array[String]">split</span><span title="(f: String =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],String,Array[String]])Array[String]" class="delimiter">(</span><span title="String(&quot;,\\s*&quot;)" class="string">&quot;,\\s*&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.$anonfun.$anonfun.fh" title="String">fh</a><span class="delimiter">)</span>.<span title="(f: String =&gt; scala.collection.immutable.Map[String,String])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],scala.collection.immutable.Map[String,String],Seq[Map[String,String]]])Seq[Map[String,String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,scala.collection.immutable.Map[String,String],Seq[scala.collection.immutable.Map[String,String]]]" class="delimiter">(</span><a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.$anonfun.x$4" title="String">_</a>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="String(&quot;;&quot;)" class="string">&quot;;&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; (String, String))(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],(String, String),Array[(String, String)]])Array[(String, String)]">map</span><span title="(xs: Array[(String, String)])scala.collection.mutable.ArrayOps[(String, String)]" class="delimiter">(</span><a title="String" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.$anonfun.$anonfun.s">s</a> =&gt; <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Array[String]" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.$anonfun.$anonfun.splitted">splitted</a> = <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.$anonfun.$anonfun.s" title="String">s</a>.<span title="(x$1: String, x$2: Int)Array[String]">split</span><span class="delimiter">(</span><span title="String(&quot;=&quot;)" class="string">&quot;=&quot;</span>, <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
        <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.$anonfun.$anonfun.splitted" title="(i: Int)String">splitted</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="(x: String)ArrowAssoc[String]">toLowerCase</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.rfc7239Headers.$anonfun.$anonfun.$anonfun.splitted" title="(i: Int)String">splitted</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="(implicit ev: &lt;:&lt;[(String, String),(String, String)])scala.collection.immutable.Map[String,String]">toMap</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="play.api.mvc.Headers =&gt; Seq[Map[String,String]]" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders">xforwardedHeaders</a>: <span class="delimiter">(</span>Headers<span class="delimiter">)</span> =&gt; Seq<span class="delimiter">[</span>Map<span class="delimiter">[</span>String, String<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span> <span class="delimiter">(</span>headers: <a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers" title="play.api.mvc.Headers">Headers</a><span class="delimiter">)</span> =&gt;
      <span class="keyword">def</span> <a title="(h: play.api.mvc.Headers, key: String)Seq[String]" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.h">h</a><span class="delimiter">(</span><a title="play.api.mvc.Headers" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.h.h">h</a>: <a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers" title="play.api.mvc.Headers">Headers</a>, <a title="String" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.h.key">key</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.h.h" title="play.api.mvc.Headers">h</a>.<a href="../../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Headers.getAll" title="(key: String)Seq[String]">getAll</a><span class="delimiter">(</span><a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.h.key" title="String">key</a><span class="delimiter">)</span>.<span title="(f: String =&gt; scala.collection.GenTraversableOnce[String])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],String,Seq[String]])Seq[String]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,String,Seq[String]]" class="delimiter">(</span><a title="String" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.h.$anonfun.s">s</a> =&gt; <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.h.$anonfun.s" title="String">s</a>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="String(&quot;,\\s*&quot;)" class="string">&quot;,\\s*&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.h" title="(h: play.api.mvc.Headers, key: String)Seq[String]">h</a><span class="delimiter">(</span><a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.headers" title="play.api.mvc.Headers">headers</a>, <span title="String(&quot;X-Forwarded-For&quot;)" class="string">&quot;X-Forwarded-For&quot;</span><span class="delimiter">)</span>.<span title="(that: scala.collection.GenIterable[String], thisElem: String, thatElem: String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],(String, String),Seq[(String, String)]])Seq[(String, String)]">zipAll</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(String, String),Seq[(String, String)]]" class="delimiter">(</span><a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.h" title="(h: play.api.mvc.Headers, key: String)Seq[String]">h</a><span class="delimiter">(</span><a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.headers" title="play.api.mvc.Headers">headers</a>, <span title="String(&quot;X-Forwarded-Proto&quot;)" class="string">&quot;X-Forwarded-Proto&quot;</span><span class="delimiter">)</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        .<span title="(f: ((String, String)) =&gt; scala.collection.immutable.Map[String,String])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, String)],scala.collection.immutable.Map[String,String],Seq[Map[String,String]]])Seq[Map[String,String]]">map</span> <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.$anonfun.x0$1" title="scala.collection.immutable.Map[String,String]" class="delimiter">{</a> <span class="keyword">case</span> <span class="delimiter">(</span><a title="String" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.$anonfun.f">f</a>, <a title="String" id="play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.$anonfun.p">p</a><span class="delimiter">)</span> =&gt; <span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><span class="delimiter">(</span><span title="(x: String)ArrowAssoc[String]" class="string">&quot;for&quot;</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.$anonfun.f" title="String">f</a>, <span title="(x: String)ArrowAssoc[String]" class="string">&quot;proto&quot;</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig.xforwardedHeaders.$anonfun.$anonfun.p" title="String">p</a><span class="delimiter">)</span> <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.type" id="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.readResolve">ForwardedHeaderHandlerConfig</a> <a href="#play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.readResolve" title="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.type" class="delimiter">{</a>
    <span class="keyword">def</span> <a title="(configuration: Option[play.api.Configuration])play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig" id="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.apply(a70b960f0f)">apply</a><span class="delimiter">(</span><a title="Option[play.api.Configuration]" id="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.apply(a70b960f0f).configuration">configuration</a>: <span title="Option[play.api.Configuration]">Option</span><span class="delimiter">[</span>Configuration<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig" title="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig">ForwardedHeaderHandlerConfig</a> = <a href="#play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.apply(a70b960f0f).configuration" title="Option[play.api.Configuration]">configuration</a>.<span title="(f: play.api.Configuration =&gt; play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig)Option[play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig]">map</span> <span class="delimiter">{</span> <a title="play.api.Configuration" id="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.apply(a70b960f0f).$anonfun.c">c</a> =&gt;
      <a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig" title="(version: play.core.server.common.ForwardedHeaderHandler.Version, trustedProxies: List[play.core.server.common.Subnet])play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig">ForwardedHeaderHandlerConfig</a><span class="delimiter">(</span>
        <a href="#play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.apply(a70b960f0f).$anonfun.c" title="play.api.Configuration">c</a>.<a href="../../../../../play/play/api/Configuration.scala.html#play.api;Configuration.getString" title="(path: String, validValues: Option[Set[String]])Option[String]">getString</a><span class="delimiter">(</span><span title="String(&quot;play.http.forwarded.version&quot;)" class="string">&quot;play.http.forwarded.version&quot;</span>, <span title="(x: scala.collection.immutable.Set[String])Some[scala.collection.immutable.Set[String]]">Some</span><span class="delimiter">(</span><span title="(elems: String*)scala.collection.immutable.Set[String]">Set</span><span class="delimiter">(</span><span title="String(&quot;x-forwarded&quot;)" class="string">&quot;x-forwarded&quot;</span>, <span title="String(&quot;rfc7239&quot;)" class="string">&quot;rfc7239&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          .<span title="(ifEmpty: =&gt; play.core.server.common.ForwardedHeaderHandler.Version)(f: String =&gt; play.core.server.common.ForwardedHeaderHandler.Version)play.core.server.common.ForwardedHeaderHandler.Version">fold</span><span class="delimiter">(</span><a href="#play.core.server.common.ForwardedHeaderHandler.Xforwarded.readResolve" title="play.core.server.common.ForwardedHeaderHandler.Xforwarded.type">Xforwarded</a>: <a href="#play.core.server.common.ForwardedHeaderHandler;Version" title="play.core.server.common.ForwardedHeaderHandler.Version">Version</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="String" id="play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.apply(a70b960f0f).$anonfun.$anonfun.version">version</a> =&gt; <span title="play.core.server.common.ForwardedHeaderHandler.Version" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.apply(a70b960f0f).$anonfun.$anonfun.version" title="String">version</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;rfc7239&quot;)" class="string">&quot;rfc7239&quot;</span><span class="delimiter">)</span> <a href="#play.core.server.common.ForwardedHeaderHandler.Rfc7239.readResolve" title="play.core.server.common.ForwardedHeaderHandler.Rfc7239.type">Rfc7239</a> <span class="keyword">else</span> <a href="#play.core.server.common.ForwardedHeaderHandler.Xforwarded.readResolve" title="play.core.server.common.ForwardedHeaderHandler.Xforwarded.type">Xforwarded</a><span class="delimiter">)</span>,
        <a href="#play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig.apply(a70b960f0f).$anonfun.c" title="play.api.Configuration">c</a>.<a href="../../../../../play/play/api/Configuration.scala.html#play.api;Configuration.getStringSeq" title="(path: String)Option[Seq[String]]">getStringSeq</a><span class="delimiter">(</span><span title="String(&quot;play.http.forwarded.trustedProxies&quot;)" class="string">&quot;play.http.forwarded.trustedProxies&quot;</span><span class="delimiter">)</span>
          .<span title="(default: =&gt; Seq[String])Seq[String]">getOrElse</span><span class="delimiter">(</span><span title="(xs: String*)List[String]">List</span><span class="delimiter">(</span><span title="String(&quot;::1&quot;)" class="string">&quot;::1&quot;</span>, <span title="String(&quot;127.0.0.1&quot;)" class="string">&quot;127.0.0.1&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          .<span title="(f: String =&gt; play.core.server.common.Subnet)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],play.core.server.common.Subnet,Seq[play.core.server.common.Subnet]])Seq[play.core.server.common.Subnet]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,play.core.server.common.Subnet,Seq[play.core.server.common.Subnet]]" class="delimiter">(</span><a href="Subnet.scala.html#play.core.server.common.Subnet" title="play.core.server.common.Subnet.type">Subnet</a>.<a href="Subnet.scala.html#play.core.server.common.Subnet.apply(603590655c)" title="(s: String)play.core.server.common.Subnet">apply</a><span class="delimiter">)</span>.<span title="=&gt; List[play.core.server.common.Subnet]">toList</span>
      <span class="delimiter">)</span>
    <span class="delimiter">}</span>.<span title="(default: =&gt; play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig)play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig">getOrElse</span><span class="delimiter">(</span><a href="#play.core.server.common.ForwardedHeaderHandler;ForwardedHeaderHandlerConfig" title="(version: play.core.server.common.ForwardedHeaderHandler.Version, trustedProxies: List[play.core.server.common.Subnet])play.core.server.common.ForwardedHeaderHandler.ForwardedHeaderHandlerConfig">ForwardedHeaderHandlerConfig</a><span class="delimiter">(</span><a href="#play.core.server.common.ForwardedHeaderHandler.Xforwarded.readResolve" title="play.core.server.common.ForwardedHeaderHandler.Xforwarded.type">Xforwarded</a>, <span title="(xs: play.core.server.common.Subnet*)List[play.core.server.common.Subnet]">List</span><span class="delimiter">(</span><a href="Subnet.scala.html#play.core.server.common.Subnet.apply(603590655c)" title="(s: String)play.core.server.common.Subnet">Subnet</a><span class="delimiter">(</span><span title="String(&quot;::1&quot;)" class="string">&quot;::1&quot;</span><span class="delimiter">)</span>, <a href="Subnet.scala.html#play.core.server.common.Subnet.apply(603590655c)" title="(s: String)play.core.server.common.Subnet">Subnet</a><span class="delimiter">(</span><span title="String(&quot;172.0.0.1&quot;)" class="string">&quot;172.0.0.1&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span title="AnyRef" class="delimiter">}</span>

        </pre>
    </body>
</html>

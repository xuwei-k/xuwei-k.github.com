<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>filters-helpers/play/filters/csrf/csrf.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.filters.csrf

<span class="keyword">import</span> java.util.Optional

<span class="keyword">import</span> com.typesafe.config.ConfigMemorySize
<span class="keyword">import</span> play.filters.csrf.<a href="#play.filters.csrf.CSRF" title="play.filters.csrf.CSRF.type">CSRF</a>.<span class="delimiter">{</span> CSRFHttpErrorHandler, ErrorHandler <span class="delimiter">}</span>
<span class="keyword">import</span> play.mvc.Http
<span class="keyword">import</span> play.utils.Reflect

<span class="keyword">import</span> scala.concurrent.Future

<span class="keyword">import</span> play.api._
<span class="keyword">import</span> play.api.inject.<span class="delimiter">{</span> Binding, Module <span class="delimiter">}</span>
<span class="keyword">import</span> play.api.http.HttpErrorHandler
<span class="keyword">import</span> play.api.libs.Crypto
<span class="keyword">import</span> play.api.mvc.<a href="../../../../play/play/api/mvc/Results.scala.html#play.api.mvc.Results" title="play.api.mvc.Results.type">Results</a>._
<span class="keyword">import</span> play.api.mvc._
<span class="keyword">import</span> play.core.j.JavaHelpers
<span class="keyword">import</span> javax.inject.<span class="delimiter">{</span> Singleton, Provider, Inject <span class="delimiter">}</span>

<span class="comment">/**
 * CSRF configuration.
 *
 * @param tokenName The name of the token.
 * @param cookieName If defined, the name of the cookie to read the token from/write the token to.
 * @param secureCookie If using a cookie, whether it should be secure.
 * @param httpOnlyCookie If using a cookie, whether it should have the HTTP only flag.
 * @param postBodyBuffer How much of the POST body should be buffered if checking the body for a token.
 * @param signTokens Whether tokens should be signed.
 * @param checkMethod Returns true if a request for that method should be checked.
 * @param checkContentType Returns true if a request for that content type should be checked.
 * @param headerName The name of the HTTP header to check for tokens from.
 * @param headerBypass Whether CSRF check can be bypassed by the presence of certain headers, such as X-Requested-By.
 */</span>
<span class="keyword">case class</span> <a title="class CSRFConfig extends AnyRef with Product with Serializable" id="play.filters.csrf;CSRFConfig">CSRFConfig</a><a href="#play.filters.csrf;CSRFConfig" title="Product" class="delimiter">(</a><a title="String" id="play.filters.csrf.CSRFConfig.<init>$default$1">tokenName</a>: <span title="String">String</span> = <span title="String(&quot;csrfToken&quot;)" class="string">&quot;csrfToken&quot;</span>,
  <a title="Option[String]" id="play.filters.csrf.CSRFConfig.<init>$default$2">cookieName</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="None.type">None</span>,
  <a title="Boolean" id="play.filters.csrf.CSRFConfig.<init>$default$3">secureCookie</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(false)" class="keyword">false</span>,
  <a title="Boolean" id="play.filters.csrf.CSRFConfig.<init>$default$4">httpOnlyCookie</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(false)" class="keyword">false</span>,
  <a title="play.api.mvc.RequestHeader =&gt; Boolean" id="play.filters.csrf.CSRFConfig.<init>$default$5">createIfNotFound</a>: <span class="delimiter">(</span>RequestHeader<span class="delimiter">)</span> =&gt; Boolean = <a href="#play.filters.csrf.CSRFConfig.readResolve" title="play.filters.csrf.CSRFConfig.type">CSRFConfig</a>.<a href="#play.filters.csrf.CSRFConfig.defaultCreateIfNotFound" title="(request: play.api.mvc.RequestHeader)Boolean">defaultCreateIfNotFound</a>,
  <a title="Long" id="play.filters.csrf.CSRFConfig.<init>$default$6">postBodyBuffer</a>: <span title="Long">Long</span> = <span title="Long(102400L)" class="int">102400</span>,
  <a title="Boolean" id="play.filters.csrf.CSRFConfig.<init>$default$7">signTokens</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>,
  <a title="String =&gt; Boolean" id="play.filters.csrf.CSRFConfig.<init>$default$8">checkMethod</a>: String =&gt; Boolean = <a href="#play.filters.csrf.CSRFConfig.readResolve" title="play.filters.csrf.CSRFConfig.type">CSRFConfig</a>.<a href="#play.filters.csrf.CSRFConfig.UnsafeMethods" title="=&gt; scala.collection.immutable.Set[String]">UnsafeMethods</a>,
  <a title="Option[String] =&gt; Boolean" id="play.filters.csrf.CSRFConfig.<init>$default$9">checkContentType</a>: Option<span class="delimiter">[</span>String<span class="delimiter">]</span> =&gt; Boolean = <a href="#play.filters.csrf;CSRFConfig.checkContentType.$anonfun.x$1" title="Option[String]">_</a>.<span title="(p: String =&gt; Boolean)Boolean">exists</span><span class="delimiter">(</span><a href="#play.filters.csrf.CSRFConfig.readResolve" title="play.filters.csrf.CSRFConfig.type">CSRFConfig</a>.<a href="#play.filters.csrf.CSRFConfig.UnsafeContentTypes" title="=&gt; scala.collection.immutable.Set[String]">UnsafeContentTypes</a><span class="delimiter">)</span>,
  <a title="String" id="play.filters.csrf.CSRFConfig.<init>$default$10">headerName</a>: <span title="String">String</span> = <span title="String(&quot;Csrf-Token&quot;)" class="string">&quot;Csrf-Token&quot;</span>,
  <a title="Boolean" id="play.filters.csrf.CSRFConfig.<init>$default$11">headerBypass</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

<span class="keyword">object</span> <a title="play.filters.csrf.CSRFConfig.type" id="play.filters.csrf.CSRFConfig.readResolve">CSRFConfig</a> <a href="#play.filters.csrf.CSRFConfig.readResolve" title="play.filters.csrf.CSRFConfig.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.immutable.Set[String]" id="play.filters.csrf.CSRFConfig.UnsafeContentTypes">UnsafeContentTypes</a> = <span title="(elems: String*)scala.collection.immutable.Set[String]">Set</span><span class="delimiter">(</span><span title="String(&quot;application/x-www-form-urlencoded&quot;)" class="string">&quot;application/x-www-form-urlencoded&quot;</span>, <span title="String(&quot;text/plain&quot;)" class="string">&quot;text/plain&quot;</span>, <span title="String(&quot;multipart/form-data&quot;)" class="string">&quot;multipart/form-data&quot;</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.immutable.Set[String]" id="play.filters.csrf.CSRFConfig.UnsafeMethods">UnsafeMethods</a> = <span title="(elems: String*)scala.collection.immutable.Set[String]">Set</span><span class="delimiter">(</span><span title="String(&quot;POST&quot;)" class="string">&quot;POST&quot;</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(request: play.api.mvc.RequestHeader)Boolean" id="play.filters.csrf.CSRFConfig.defaultCreateIfNotFound">defaultCreateIfNotFound</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.filters.csrf.CSRFConfig.defaultCreateIfNotFound.request">request</a>: <a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader" title="play.api.mvc.RequestHeader">RequestHeader</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="comment">// If the request isn't accepting HTML, then it won't be rendering a form, so there's no point in generating a</span>
    <span class="comment">// CSRF token for it.</span>
    <span class="delimiter">(</span><a href="#play.filters.csrf.CSRFConfig.defaultCreateIfNotFound.request" title="play.api.mvc.RequestHeader">request</a>.<a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader.method" title="=&gt; String">method</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;GET&quot;)" class="string">&quot;GET&quot;</span> <span title="(x: Boolean)Boolean">||</span> <a href="#play.filters.csrf.CSRFConfig.defaultCreateIfNotFound.request" title="play.api.mvc.RequestHeader">request</a>.<a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader.method" title="=&gt; String">method</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;HEAD&quot;)" class="string">&quot;HEAD&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="#play.filters.csrf.CSRFConfig.defaultCreateIfNotFound.request" title="play.api.mvc.RequestHeader">request</a>.<a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader.accepts" title="(mimeType: String)Boolean">accepts</a><span class="delimiter">(</span><span title="String(&quot;text/html&quot;)" class="string">&quot;text/html&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#play.filters.csrf.CSRFConfig.defaultCreateIfNotFound.request" title="play.api.mvc.RequestHeader">request</a>.<a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader.accepts" title="(mimeType: String)Boolean">accepts</a><span class="delimiter">(</span><span title="String(&quot;application/xml+xhtml&quot;)" class="string">&quot;application/xml+xhtml&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>play<span class="delimiter">]</span> <span class="keyword">val</span> <a title="String" id="play.filters.csrf.CSRFConfig.HeaderNoCheck">HeaderNoCheck</a> = <span title="String(&quot;nocheck&quot;)" class="string">&quot;nocheck&quot;</span>

  <span class="keyword">def</span> <a title="=&gt; play.filters.csrf.CSRFConfig" id="play.filters.csrf.CSRFConfig.global">global</a> = <a href="../../../../play/play/api/Play.scala.html#play.api.Play" title="play.api.Play.type">Play</a>.<a href="../../../../play/play/api/Play.scala.html#play.api.Play.maybeApplication" title="=&gt; Option[play.api.Application]">maybeApplication</a>.<span title="(f: play.api.Application =&gt; play.filters.csrf.CSRFConfig)Option[play.filters.csrf.CSRFConfig]">map</span><span class="delimiter">(</span><a href="#play.filters.csrf.CSRFConfig.global.$anonfun.x$2" title="play.api.Application">_</a>.<a href="../../../../play/play/api/Application.scala.html#play.api;Application.injector" title="=&gt; play.api.inject.Injector">injector</a>.<a href="../../../../play/play/api/inject/Injector.scala.html#play.api.inject;Injector.instanceOf(ffe51818f2)" title="[T](implicit evidence$1: scala.reflect.ClassTag[T])T">instanceOf</a><span title="(implicit evidence$1: scala.reflect.ClassTag[play.filters.csrf.CSRFConfig])play.filters.csrf.CSRFConfig" class="delimiter">[</span><a href="#play.filters.csrf;CSRFConfig" title="play.filters.csrf.CSRFConfig">CSRFConfig</a><span class="delimiter">]</span><span class="delimiter">)</span>.<span title="(default: =&gt; play.filters.csrf.CSRFConfig)play.filters.csrf.CSRFConfig">getOrElse</span><span class="delimiter">(</span><a href="#play.filters.csrf;CSRFConfig" title="(tokenName: String, cookieName: Option[String], secureCookie: Boolean, httpOnlyCookie: Boolean, createIfNotFound: play.api.mvc.RequestHeader =&gt; Boolean, postBodyBuffer: Long, signTokens: Boolean, checkMethod: String =&gt; Boolean, checkContentType: Option[String] =&gt; Boolean, headerName: String, headerBypass: Boolean)play.filters.csrf.CSRFConfig">CSRFConfig</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(conf: play.api.Configuration)play.filters.csrf.CSRFConfig" id="play.filters.csrf.CSRFConfig.fromConfiguration">fromConfiguration</a><span class="delimiter">(</span><a title="play.api.Configuration" id="play.filters.csrf.CSRFConfig.fromConfiguration.conf">conf</a>: <a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration" title="play.api.Configuration">Configuration</a><span class="delimiter">)</span>: <a href="#play.filters.csrf;CSRFConfig" title="play.filters.csrf.CSRFConfig">CSRFConfig</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="play.api.PlayConfig" id="play.filters.csrf.CSRFConfig.fromConfiguration.config">config</a> = <a href="../../../../play/play/api/Configuration.scala.html#play.api.PlayConfig.apply(a5709ffad5)" title="(configuration: play.api.Configuration)play.api.PlayConfig">PlayConfig</a><a title="play.api.PlayConfig" id="play.filters.csrf.CSRFConfig.fromConfiguration.config.qual$1" class="delimiter">(</a><a href="#play.filters.csrf.CSRFConfig.fromConfiguration.conf" title="play.api.Configuration">conf</a><span class="delimiter">)</span>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.getDeprecatedWithFallback$default$3" title="String" id="play.filters.csrf.CSRFConfig.fromConfiguration.config.x$9">getDeprecatedWithFallback</a><span class="delimiter">(</span><a title="String" id="play.filters.csrf.CSRFConfig.fromConfiguration.config.x$7" class="string">&quot;play.filters.csrf&quot;</a>, <a title="String" id="play.filters.csrf.CSRFConfig.fromConfiguration.config.x$8" class="string">&quot;csrf&quot;</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scala.collection.immutable.Set[String]" id="play.filters.csrf.CSRFConfig.fromConfiguration.methodWhiteList">methodWhiteList</a> = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[Seq[String]])Seq[String]" class="delimiter">[</span><span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.seqStringLoader" title="=&gt; play.api.ConfigLoader[Seq[String]]" class="delimiter">(</a><span title="String(&quot;method.whiteList&quot;)" class="string">&quot;method.whiteList&quot;</span><span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[String]">toSet</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Set[String]" id="play.filters.csrf.CSRFConfig.fromConfiguration.methodBlackList">methodBlackList</a> = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[Seq[String]])Seq[String]" class="delimiter">[</span><span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.seqStringLoader" title="=&gt; play.api.ConfigLoader[Seq[String]]" class="delimiter">(</a><span title="String(&quot;method.blackList&quot;)" class="string">&quot;method.blackList&quot;</span><span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[String]">toSet</span>

    <span class="keyword">val</span> <a title="String =&gt; Boolean" id="play.filters.csrf.CSRFConfig.fromConfiguration.checkMethod">checkMethod</a>: String =&gt; Boolean = <span title="String =&gt; Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.filters.csrf.CSRFConfig.fromConfiguration.methodWhiteList" title="scala.collection.immutable.Set[String]">methodWhiteList</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="=&gt; Boolean">!</span><a href="#play.filters.csrf.CSRFConfig.fromConfiguration.methodWhiteList" title="scala.collection.immutable.Set[String]">methodWhiteList</a>.<span title="(elem: String)Boolean">contains</span><span class="delimiter">(</span><a href="#play.filters.csrf.CSRFConfig.fromConfiguration.checkMethod.$anonfun.x$3" title="String">_</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.methodBlackList" title="scala.collection.immutable.Set[String]">methodBlackList</a>.<a href="#play.filters.csrf.CSRFConfig.fromConfiguration.checkMethod.$anonfun.elem" title="(elem: String)Boolean">contains</a>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="scala.collection.immutable.Set[String]" id="play.filters.csrf.CSRFConfig.fromConfiguration.contentTypeWhiteList">contentTypeWhiteList</a> = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[Seq[String]])Seq[String]" class="delimiter">[</span><span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.seqStringLoader" title="=&gt; play.api.ConfigLoader[Seq[String]]" class="delimiter">(</a><span title="String(&quot;contentType.whiteList&quot;)" class="string">&quot;contentType.whiteList&quot;</span><span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[String]">toSet</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Set[String]" id="play.filters.csrf.CSRFConfig.fromConfiguration.contentTypeBlackList">contentTypeBlackList</a> = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[Seq[String]])Seq[String]" class="delimiter">[</span><span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.seqStringLoader" title="=&gt; play.api.ConfigLoader[Seq[String]]" class="delimiter">(</a><span title="String(&quot;contentType.blackList&quot;)" class="string">&quot;contentType.blackList&quot;</span><span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[String]">toSet</span>

    <span class="keyword">val</span> <a title="String =&gt; Boolean" id="play.filters.csrf.CSRFConfig.fromConfiguration.checkContentType">checkContentType</a>: String =&gt; Boolean = <span title="String =&gt; Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.filters.csrf.CSRFConfig.fromConfiguration.contentTypeWhiteList" title="scala.collection.immutable.Set[String]">contentTypeWhiteList</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="=&gt; Boolean">!</span><a href="#play.filters.csrf.CSRFConfig.fromConfiguration.contentTypeWhiteList" title="scala.collection.immutable.Set[String]">contentTypeWhiteList</a>.<span title="(elem: String)Boolean">contains</span><span class="delimiter">(</span><a href="#play.filters.csrf.CSRFConfig.fromConfiguration.checkContentType.$anonfun.x$4" title="String">_</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.contentTypeBlackList" title="scala.collection.immutable.Set[String]">contentTypeBlackList</a>.<a href="#play.filters.csrf.CSRFConfig.fromConfiguration.checkContentType.$anonfun.elem" title="(elem: String)Boolean">contains</a>
    <span class="delimiter">}</span>

    <a href="#play.filters.csrf.CSRFConfig.<init>$default$5" title="play.api.mvc.RequestHeader =&gt; Boolean @scala.reflect.internal.annotations.uncheckedBounds" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$20">CSRFConfig</a><span class="delimiter">(</span>
      tokenName = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[String])String" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.stringLoader" title="String" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$10" class="delimiter">(</a><span title="String(&quot;token.name&quot;)" class="string">&quot;token.name&quot;</span><span class="delimiter">)</span>,
      cookieName = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.getOptional" title="[A](path: String)(implicit evidence$1: play.api.ConfigLoader[A])Option[A]">getOptional</a><span title="(path: String)(implicit evidence$1: play.api.ConfigLoader[String])Option[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.stringLoader" title="Option[String] @scala.reflect.internal.annotations.uncheckedBounds" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$11" class="delimiter">(</a><span title="String(&quot;cookie.name&quot;)" class="string">&quot;cookie.name&quot;</span><span class="delimiter">)</span>,
      secureCookie = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[Boolean])Boolean" class="delimiter">[</span><span title="Boolean">Boolean</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.booleanLoader" title="Boolean" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$12" class="delimiter">(</a><span title="String(&quot;cookie.secure&quot;)" class="string">&quot;cookie.secure&quot;</span><span class="delimiter">)</span>,
      httpOnlyCookie = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[Boolean])Boolean" class="delimiter">[</span><span title="Boolean">Boolean</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.booleanLoader" title="Boolean" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$13" class="delimiter">(</a><span title="String(&quot;cookie.httpOnly&quot;)" class="string">&quot;cookie.httpOnly&quot;</span><span class="delimiter">)</span>,
      postBodyBuffer = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[com.typesafe.config.ConfigMemorySize])com.typesafe.config.ConfigMemorySize" class="delimiter">[</span><span title="com.typesafe.config.ConfigMemorySize">ConfigMemorySize</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.bytesLoader" title="=&gt; play.api.ConfigLoader[com.typesafe.config.ConfigMemorySize]" class="delimiter">(</a><span title="String(&quot;body.bufferSize&quot;)" class="string">&quot;body.bufferSize&quot;</span><span class="delimiter">)</span>.<a title="Long" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$14">toBytes</a>,
      signTokens = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[Boolean])Boolean" class="delimiter">[</span><span title="Boolean">Boolean</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.booleanLoader" title="Boolean" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$15" class="delimiter">(</a><span title="String(&quot;token.sign&quot;)" class="string">&quot;token.sign&quot;</span><span class="delimiter">)</span>,
      checkMethod = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.checkMethod" title="String =&gt; Boolean @scala.reflect.internal.annotations.uncheckedBounds" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$16">checkMethod</a>,
      checkContentType = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.x$17.$anonfun.x$5" title="Option[String]">_</a>.<span title="(p: String =&gt; Boolean)Boolean">exists</span><a title="Option[String] =&gt; Boolean @scala.reflect.internal.annotations.uncheckedBounds" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$17" class="delimiter">(</a><a href="#play.filters.csrf.CSRFConfig.fromConfiguration.checkContentType" title="String =&gt; Boolean">checkContentType</a><span class="delimiter">)</span>,
      headerName = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[String])String" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.stringLoader" title="String" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$18" class="delimiter">(</a><span title="String(&quot;header.name&quot;)" class="string">&quot;header.name&quot;</span><span class="delimiter">)</span>,
      headerBypass = <a href="#play.filters.csrf.CSRFConfig.fromConfiguration.config" title="play.api.PlayConfig">config</a>.<a href="../../../../play/play/api/Configuration.scala.html#play.api;PlayConfig.get" title="[A](path: String)(implicit loader: play.api.ConfigLoader[A])A">get</a><span title="(path: String)(implicit loader: play.api.ConfigLoader[Boolean])Boolean" class="delimiter">[</span><span title="Boolean">Boolean</span><span class="delimiter">]</span><a href="../../../../play/play/api/Configuration.scala.html#play.api.ConfigLoader.booleanLoader" title="Boolean" id="play.filters.csrf.CSRFConfig.fromConfiguration.x$19" class="delimiter">(</a><span title="String(&quot;header.bypass&quot;)" class="string">&quot;header.bypass&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

@Singleton
<span class="keyword">class</span> <a title="class CSRFConfigProvider extends Object with javax.inject.Provider[play.filters.csrf.CSRFConfig]" id="play.filters.csrf;CSRFConfigProvider">CSRFConfigProvider</a> @Inject<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">(</span><a title="play.api.Configuration" id="play.filters.csrf;CSRFConfigProvider.config">config</a>: <a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration" title="play.api.Configuration">Configuration</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="javax.inject.Provider[play.filters.csrf.CSRFConfig]">Provider</span><span class="delimiter">[</span>CSRFConfig<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.filters.csrf.CSRFConfig" id="play.filters.csrf;CSRFConfigProvider.get">get</a> = <a href="#play.filters.csrf.CSRFConfig.readResolve" title="play.filters.csrf.CSRFConfig.type">CSRFConfig</a>.<a href="#play.filters.csrf.CSRFConfig.fromConfiguration" title="(conf: play.api.Configuration)play.filters.csrf.CSRFConfig">fromConfiguration</a><span class="delimiter">(</span><a href="#play.filters.csrf;CSRFConfigProvider.config" title="play.api.Configuration">config</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="play.filters.csrf.CSRF.type" id="play.filters.csrf.CSRF">CSRF</a> <a href="#play.filters.csrf.CSRF" title="play.filters.csrf.CSRF.type" class="delimiter">{</a>

  <span class="keyword">private</span><span class="delimiter">[</span>csrf<span class="delimiter">]</span> <span class="keyword">val</span> <a title="play.api.Logger" id="play.filters.csrf.CSRF.filterLogger">filterLogger</a> = play.api.<a href="../../../../play/play/api/Logger.scala.html#play.api.Logger.apply(c877c33b49)" title="(name: String)play.api.Logger">Logger</a><span class="delimiter">(</span><span title="String(&quot;play.filters&quot;)" class="string">&quot;play.filters&quot;</span><span class="delimiter">)</span>

  <span class="comment">/**
   * A CSRF token
   */</span>
  <span class="keyword">case class</span> <a title="class Token extends AnyRef with Product with Serializable" id="play.filters.csrf.CSRF;Token">Token</a><a href="#play.filters.csrf.CSRF;Token" title="Product" class="delimiter">(</a><a title="String" id="play.filters.csrf.CSRF;Token.value">value</a>: <span title="String">String</span><span class="delimiter">)</span>

  <span class="keyword">object</span> <a title="play.filters.csrf.CSRF.Token.type" id="play.filters.csrf.CSRF.Token.readResolve">Token</a> <a href="#play.filters.csrf.CSRF.Token.readResolve" title="play.filters.csrf.CSRF.Token.type" class="delimiter">{</a>
    <span class="keyword">val</span> <a title="String" id="play.filters.csrf.CSRF.Token.RequestTag">RequestTag</a> = <span title="String(&quot;CSRF_TOKEN&quot;)" class="string">&quot;CSRF_TOKEN&quot;</span>

    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit play.filters.csrf.CSRF.Token.getToken : (implicit request: play.api.mvc.RequestHeader)play.filters.csrf.CSRF.Token" id="play.filters.csrf.CSRF.Token.getToken">getToken</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="play.api.mvc.RequestHeader" id="play.filters.csrf.CSRF.Token.getToken.request">request</a>: <a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader" title="play.api.mvc.RequestHeader">RequestHeader</a><span class="delimiter">)</span>: <a href="#play.filters.csrf.CSRF;Token" title="play.filters.csrf.CSRF.Token">Token</a> = <span class="delimiter">{</span>
      <a href="#play.filters.csrf.CSRF" title="play.filters.csrf.CSRF.type">CSRF</a>.<a href="#play.filters.csrf.CSRF.getToken(497fa74e91)" title="(request: play.api.mvc.RequestHeader)Option[play.filters.csrf.CSRF.Token]">getToken</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.Token.getToken.request" title="play.api.mvc.RequestHeader">request</a><span class="delimiter">)</span>.<span title="(default: =&gt; play.filters.csrf.CSRF.Token)play.filters.csrf.CSRF.Token">getOrElse</span><span class="delimiter">(</span>sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;Missing CSRF Token&quot;)" class="string">&quot;Missing CSRF Token&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Extract token from current request
   */</span>
  <span class="keyword">def</span> <a title="(request: play.api.mvc.RequestHeader)Option[play.filters.csrf.CSRF.Token]" id="play.filters.csrf.CSRF.getToken(497fa74e91)">getToken</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.filters.csrf.CSRF.getToken(497fa74e91).request">request</a>: <a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader" title="play.api.mvc.RequestHeader">RequestHeader</a><span class="delimiter">)</span>: <span title="Option[play.filters.csrf.CSRF.Token]">Option</span><span class="delimiter">[</span>Token<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="play.filters.csrf.CSRFConfig" id="play.filters.csrf.CSRF.getToken(497fa74e91).global">global</a> = <a href="#play.filters.csrf.CSRFConfig.readResolve" title="play.filters.csrf.CSRFConfig.type">CSRFConfig</a>.<a href="#play.filters.csrf.CSRFConfig.global" title="=&gt; play.filters.csrf.CSRFConfig">global</a>
    <span class="comment">// First check the tags, this is where tokens are added if it's added to the current request</span>
    <span class="keyword">val</span> <a title="Option[String]" id="play.filters.csrf.CSRF.getToken(497fa74e91).token">token</a> = <a href="#play.filters.csrf.CSRF.getToken(497fa74e91).request" title="play.api.mvc.RequestHeader">request</a>.<a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader.tags" title="=&gt; Map[String,String]">tags</a>.<span title="(key: String)Option[String]">get</span><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.Token.readResolve" title="play.filters.csrf.CSRF.Token.type">Token</a>.<a href="#play.filters.csrf.CSRF.Token.RequestTag" title="=&gt; String">RequestTag</a><span class="delimiter">)</span>
      <span class="comment">// Check cookie if cookie name is defined</span>
      .<span title="(alternative: =&gt; Option[String])Option[String]">orElse</span><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.getToken(497fa74e91).global" title="play.filters.csrf.CSRFConfig">global</a>.<a href="#play.filters.csrf.CSRFConfig.<init>$default$2" title="=&gt; Option[String]">cookieName</a>.<span title="(f: String =&gt; Option[String])Option[String]">flatMap</span><span class="delimiter">(</span><a title="String" id="play.filters.csrf.CSRF.getToken(497fa74e91).token.$anonfun.n">n</a> =&gt; <a href="#play.filters.csrf.CSRF.getToken(497fa74e91).request" title="play.api.mvc.RequestHeader">request</a>.<a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader.cookies" title="=&gt; play.api.mvc.Cookies">cookies</a>.<a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Cookies.get" title="(name: String)Option[play.api.mvc.Cookie]">get</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.getToken(497fa74e91).token.$anonfun.n" title="String">n</a><span class="delimiter">)</span>.<span title="(f: play.api.mvc.Cookie =&gt; String)Option[String]">map</span><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.getToken(497fa74e91).token.$anonfun.$anonfun.x$6" title="play.api.mvc.Cookie">_</a>.<a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Cookie.value" title="=&gt; String">value</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="comment">// Check session</span>
      .<span title="(alternative: =&gt; Option[String])Option[String]">orElse</span><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.getToken(497fa74e91).request" title="play.api.mvc.RequestHeader">request</a>.<a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader.session" title="=&gt; play.api.mvc.Session">session</a>.<a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;Session.get" title="(key: String)Option[String]">get</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.getToken(497fa74e91).global" title="play.filters.csrf.CSRFConfig">global</a>.<a href="#play.filters.csrf.CSRFConfig.<init>$default$1" title="=&gt; String">tokenName</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="Option[play.filters.csrf.CSRF.Token]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.getToken(497fa74e91).global" title="play.filters.csrf.CSRFConfig">global</a>.<a href="#play.filters.csrf.CSRFConfig.<init>$default$7" title="=&gt; Boolean">signTokens</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">// Extract the signed token, and then resign it. This makes the token random per request, preventing the BREACH</span>
      <span class="comment">// vulnerability</span>
      <a href="#play.filters.csrf.CSRF.getToken(497fa74e91).token" title="Option[String]">token</a>.<span title="(f: String =&gt; Option[String])Option[String]">flatMap</span><span class="delimiter">(</span><a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto" title="play.api.libs.Crypto.type">Crypto</a>.<a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto.extractSignedToken" title="(token: String)Option[String]">extractSignedToken</a><span class="delimiter">)</span>
        .<span title="(f: String =&gt; play.filters.csrf.CSRF.Token)Option[play.filters.csrf.CSRF.Token]">map</span><span class="delimiter">(</span><a title="String" id="play.filters.csrf.CSRF.getToken(497fa74e91).$anonfun.token">token</a> =&gt; <a href="#play.filters.csrf.CSRF;Token" title="(value: String)play.filters.csrf.CSRF.Token">Token</a><span class="delimiter">(</span><a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto" title="play.api.libs.Crypto.type">Crypto</a>.<a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto.signToken" title="(token: String)String">signToken</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.getToken(497fa74e91).$anonfun.token" title="String">token</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#play.filters.csrf.CSRF.getToken(497fa74e91).token" title="Option[String]">token</a>.<span title="(f: String =&gt; play.filters.csrf.CSRF.Token)Option[play.filters.csrf.CSRF.Token]">map</span><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.Token.readResolve" title="play.filters.csrf.CSRF.Token.type">Token</a>.<a href="#play.filters.csrf.CSRF;Token" title="(value: String)play.filters.csrf.CSRF.Token">apply</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Extract token from current Java request
   *
   * @param request The request to extract the token from
   * @return The token, if found.
   */</span>
  <span class="keyword">def</span> <a title="(request: play.mvc.Http.Request)java.util.Optional[play.filters.csrf.CSRF.Token]" id="play.filters.csrf.CSRF.getToken(6036fbb709)">getToken</a><span class="delimiter">(</span><a title="play.mvc.Http.Request" id="play.filters.csrf.CSRF.getToken(6036fbb709).request">request</a>: play.mvc.Http.<a href="../../../../play/play/mvc/Http.java.html#play.mvc.Http;Request" title="play.mvc.Http.Request">Request</a><span class="delimiter">)</span>: <span title="java.util.Optional[play.filters.csrf.CSRF.Token]">Optional</span><span class="delimiter">[</span>Token<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span title="java.util.Optional.type">Optional</span>.<span title="(x$1: play.filters.csrf.CSRF.Token)java.util.Optional[play.filters.csrf.CSRF.Token]">ofNullable</span><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.getToken(497fa74e91)" title="(request: play.api.mvc.RequestHeader)Option[play.filters.csrf.CSRF.Token]">getToken</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.getToken(6036fbb709).request" title="play.mvc.Http.Request">request</a>.<a href="../../../../play/play/mvc/Http.java.html#play.mvc.Http;RequestHeader._underlyingHeader" title="()play.api.mvc.RequestHeader">_underlyingHeader</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ev: &lt;:&lt;[Null,play.filters.csrf.CSRF.Token])play.filters.csrf.CSRF.Token">orNull</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * A token provider, for generating and comparing tokens.
   *
   * This abstraction allows the use of randomised tokens.
   */</span>
  <span class="keyword">trait</span> <a title="trait TokenProvider extends AnyRef" id="play.filters.csrf.CSRF;TokenProvider">TokenProvider</a> <span class="delimiter">{</span>
    <span class="comment">/** Generate a token */</span>
    <span class="keyword">def</span> <a title="=&gt; String" id="play.filters.csrf.CSRF;TokenProvider.generateToken">generateToken</a>: <span title="String">String</span>
    <span class="comment">/** Compare two tokens */</span>
    <span class="keyword">def</span> <a title="(tokenA: String, tokenB: String)Boolean" id="play.filters.csrf.CSRF;TokenProvider.compareTokens">compareTokens</a><span class="delimiter">(</span><a title="String" id="play.filters.csrf.CSRF;TokenProvider.compareTokens.tokenA">tokenA</a>: <span title="String">String</span>, <a title="String" id="play.filters.csrf.CSRF;TokenProvider.compareTokens.tokenB">tokenB</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class TokenProviderProvider extends Object with javax.inject.Provider[play.filters.csrf.CSRF.TokenProvider]" id="play.filters.csrf.CSRF;TokenProviderProvider">TokenProviderProvider</a> @Inject<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">(</span><a title="play.filters.csrf.CSRFConfig" id="play.filters.csrf.CSRF;TokenProviderProvider.config">config</a>: <a href="#play.filters.csrf;CSRFConfig" title="play.filters.csrf.CSRFConfig">CSRFConfig</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="javax.inject.Provider[play.filters.csrf.CSRF.TokenProvider]">Provider</span><span class="delimiter">[</span>TokenProvider<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">val</span> <a title="play.filters.csrf.CSRF.TokenProvider" id="play.filters.csrf.CSRF;TokenProviderProvider.get">get</a> = <a href="#play.filters.csrf.CSRF;TokenProviderProvider.config" title="play.filters.csrf.CSRFConfig">config</a>.<a href="#play.filters.csrf.CSRFConfig.<init>$default$7" title="=&gt; Boolean">signTokens</a> <span title="play.filters.csrf.CSRF.TokenProvider" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Boolean(true)" class="keyword">true</span> =&gt; <a href="#play.filters.csrf.CSRF.SignedTokenProvider" title="play.filters.csrf.CSRF.SignedTokenProvider.type">SignedTokenProvider</a>
      <span class="keyword">case</span> <span title="Boolean(false)" class="keyword">false</span> =&gt; <a href="#play.filters.csrf.CSRF.UnsignedTokenProvider" title="play.filters.csrf.CSRF.UnsignedTokenProvider.type">UnsignedTokenProvider</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class ConfigTokenProvider extends AnyRef with play.filters.csrf.CSRF.TokenProvider" id="play.filters.csrf.CSRF;ConfigTokenProvider">ConfigTokenProvider</a><a href="#play.filters.csrf.CSRF;ConfigTokenProvider" title="play.filters.csrf.CSRF.ConfigTokenProvider" class="delimiter">(</a><a title="=&gt; play.filters.csrf.CSRFConfig" id="play.filters.csrf.CSRF;ConfigTokenProvider.config">config</a>: =&gt; CSRFConfig<span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.filters.csrf.CSRF;TokenProvider" title="play.filters.csrf.CSRF.TokenProvider">TokenProvider</a> <span class="delimiter">{</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.filters.csrf.CSRF.TokenProvider" id="play.filters.csrf.CSRF;ConfigTokenProvider.underlying">underlying</a> = <span title="play.filters.csrf.CSRF.TokenProviderProvider" class="keyword">new</span> <a href="#play.filters.csrf.CSRF;TokenProviderProvider" title="play.filters.csrf.CSRF.TokenProviderProvider">TokenProviderProvider</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF;ConfigTokenProvider.config" title="=&gt; play.filters.csrf.CSRFConfig">config</a><span class="delimiter">)</span>.<a href="#play.filters.csrf.CSRF;TokenProviderProvider.get" title="=&gt; play.filters.csrf.CSRF.TokenProvider">get</a>
    <span class="keyword">def</span> <a title="=&gt; String" id="play.filters.csrf.CSRF;ConfigTokenProvider.generateToken">generateToken</a> = <a href="#play.filters.csrf.CSRF;ConfigTokenProvider.underlying" title="=&gt; play.filters.csrf.CSRF.TokenProvider">underlying</a>.<a href="#play.filters.csrf.CSRF;TokenProvider.generateToken" title="=&gt; String">generateToken</a>
    <span class="keyword">def</span> <a title="(tokenA: String, tokenB: String)Boolean" id="play.filters.csrf.CSRF;ConfigTokenProvider.compareTokens">compareTokens</a><span class="delimiter">(</span><a title="String" id="play.filters.csrf.CSRF;ConfigTokenProvider.compareTokens.tokenA">tokenA</a>: <span title="String">String</span>, <a title="String" id="play.filters.csrf.CSRF;ConfigTokenProvider.compareTokens.tokenB">tokenB</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#play.filters.csrf.CSRF;ConfigTokenProvider.underlying" title="=&gt; play.filters.csrf.CSRF.TokenProvider">underlying</a>.<a href="#play.filters.csrf.CSRF;TokenProvider.compareTokens" title="(tokenA: String, tokenB: String)Boolean">compareTokens</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF;ConfigTokenProvider.compareTokens.tokenA" title="String">tokenA</a>, <a href="#play.filters.csrf.CSRF;ConfigTokenProvider.compareTokens.tokenB" title="String">tokenB</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="play.filters.csrf.CSRF.SignedTokenProvider.type" id="play.filters.csrf.CSRF.SignedTokenProvider">SignedTokenProvider</a> <a href="#play.filters.csrf.CSRF.SignedTokenProvider" title="play.filters.csrf.CSRF.SignedTokenProvider.type" class="keyword">extends</a> <a href="#play.filters.csrf.CSRF;TokenProvider" title="play.filters.csrf.CSRF.TokenProvider">TokenProvider</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; String" id="play.filters.csrf.CSRF.SignedTokenProvider.generateToken">generateToken</a> = <a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto" title="play.api.libs.Crypto.type">Crypto</a>.<a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto.generateSignedToken" title="=&gt; String">generateSignedToken</a>
    <span class="keyword">def</span> <a title="(tokenA: String, tokenB: String)Boolean" id="play.filters.csrf.CSRF.SignedTokenProvider.compareTokens">compareTokens</a><span class="delimiter">(</span><a title="String" id="play.filters.csrf.CSRF.SignedTokenProvider.compareTokens.tokenA">tokenA</a>: <span title="String">String</span>, <a title="String" id="play.filters.csrf.CSRF.SignedTokenProvider.compareTokens.tokenB">tokenB</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto" title="play.api.libs.Crypto.type">Crypto</a>.<a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto.compareSignedTokens" title="(tokenA: String, tokenB: String)Boolean">compareSignedTokens</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.SignedTokenProvider.compareTokens.tokenA" title="String">tokenA</a>, <a href="#play.filters.csrf.CSRF.SignedTokenProvider.compareTokens.tokenB" title="String">tokenB</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="play.filters.csrf.CSRF.UnsignedTokenProvider.type" id="play.filters.csrf.CSRF.UnsignedTokenProvider">UnsignedTokenProvider</a> <a href="#play.filters.csrf.CSRF.UnsignedTokenProvider" title="play.filters.csrf.CSRF.UnsignedTokenProvider.type" class="keyword">extends</a> <a href="#play.filters.csrf.CSRF;TokenProvider" title="play.filters.csrf.CSRF.TokenProvider">TokenProvider</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; String" id="play.filters.csrf.CSRF.UnsignedTokenProvider.generateToken">generateToken</a> = <a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto" title="play.api.libs.Crypto.type">Crypto</a>.<a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto.generateToken" title="=&gt; String">generateToken</a>
    <span class="keyword">def</span> <a title="(tokenA: String, tokenB: String)Boolean" id="play.filters.csrf.CSRF.UnsignedTokenProvider.compareTokens">compareTokens</a><span class="delimiter">(</span><a title="String" id="play.filters.csrf.CSRF.UnsignedTokenProvider.compareTokens.tokenA">tokenA</a>: <span title="String">String</span>, <a title="String" id="play.filters.csrf.CSRF.UnsignedTokenProvider.compareTokens.tokenB">tokenB</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto" title="play.api.libs.Crypto.type">Crypto</a>.<a href="../../../../play/play/api/libs/Crypto.scala.html#play.api.libs.Crypto.constantTimeEquals" title="(a: String, b: String)Boolean">constantTimeEquals</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.UnsignedTokenProvider.compareTokens.tokenA" title="String">tokenA</a>, <a href="#play.filters.csrf.CSRF.UnsignedTokenProvider.compareTokens.tokenB" title="String">tokenB</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * This trait handles the CSRF error.
   */</span>
  <span class="keyword">trait</span> <a title="trait ErrorHandler extends AnyRef" id="play.filters.csrf.CSRF;ErrorHandler">ErrorHandler</a> <span class="delimiter">{</span>
    <span class="comment">/** Handle a result */</span>
    <span class="keyword">def</span> <a title="(req: play.api.mvc.RequestHeader, msg: String)scala.concurrent.Future[play.api.mvc.Result]" id="play.filters.csrf.CSRF;ErrorHandler.handle">handle</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.filters.csrf.CSRF;ErrorHandler.handle.req">req</a>: <a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader" title="play.api.mvc.RequestHeader">RequestHeader</a>, <a title="String" id="play.filters.csrf.CSRF;ErrorHandler.handle.msg">msg</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="scala.concurrent.Future[play.api.mvc.Result]">Future</span><span class="delimiter">[</span>Result<span class="delimiter">]</span>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class CSRFHttpErrorHandler extends AnyRef with play.filters.csrf.CSRF.ErrorHandler" id="play.filters.csrf.CSRF;CSRFHttpErrorHandler">CSRFHttpErrorHandler</a> @Inject<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">(</span><a title="play.api.http.HttpErrorHandler" id="play.filters.csrf.CSRF;CSRFHttpErrorHandler.httpErrorHandler">httpErrorHandler</a>: <a href="../../../../play/play/api/http/HttpErrorHandler.scala.html#play.api.http;HttpErrorHandler" title="play.api.http.HttpErrorHandler">HttpErrorHandler</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.filters.csrf.CSRF;ErrorHandler" title="play.filters.csrf.CSRF.ErrorHandler">ErrorHandler</a> <span class="delimiter">{</span>
    <span class="keyword">import</span> play.api.http.<a href="../../../../play/play/api/http/StandardValues.scala.html#play.api.http.Status" title="play.api.http.Status.type">Status</a>.FORBIDDEN
    <span class="keyword">def</span> <a title="(req: play.api.mvc.RequestHeader, msg: String)scala.concurrent.Future[play.api.mvc.Result]" id="play.filters.csrf.CSRF;CSRFHttpErrorHandler.handle">handle</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.filters.csrf.CSRF;CSRFHttpErrorHandler.handle.req">req</a>: <a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader" title="play.api.mvc.RequestHeader">RequestHeader</a>, <a title="String" id="play.filters.csrf.CSRF;CSRFHttpErrorHandler.handle.msg">msg</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#play.filters.csrf.CSRF;CSRFHttpErrorHandler.httpErrorHandler" title="play.api.http.HttpErrorHandler">httpErrorHandler</a>.<a href="../../../../play/play/api/http/HttpErrorHandler.scala.html#play.api.http;HttpErrorHandler.onClientError" title="(request: play.api.mvc.RequestHeader, statusCode: Int, message: String)scala.concurrent.Future[play.api.mvc.Result]">onClientError</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF;CSRFHttpErrorHandler.handle.req" title="play.api.mvc.RequestHeader">req</a>, <a href="../../../../play/play/api/http/StandardValues.scala.html#play.api.http;Status.FORBIDDEN" title="=&gt; Int">FORBIDDEN</a>, <a href="#play.filters.csrf.CSRF;CSRFHttpErrorHandler.handle.msg" title="String">msg</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="play.filters.csrf.CSRF.DefaultErrorHandler.type" id="play.filters.csrf.CSRF.DefaultErrorHandler">DefaultErrorHandler</a> <a href="#play.filters.csrf.CSRF.DefaultErrorHandler" title="play.filters.csrf.CSRF.DefaultErrorHandler.type" class="keyword">extends</a> <a href="#play.filters.csrf.CSRF;ErrorHandler" title="play.filters.csrf.CSRF.ErrorHandler">ErrorHandler</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(req: play.api.mvc.RequestHeader, msg: String)scala.concurrent.Future[play.api.mvc.Result]" id="play.filters.csrf.CSRF.DefaultErrorHandler.handle">handle</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.filters.csrf.CSRF.DefaultErrorHandler.handle.req">req</a>: <a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader" title="play.api.mvc.RequestHeader">RequestHeader</a>, <a title="String" id="play.filters.csrf.CSRF.DefaultErrorHandler.handle.msg">msg</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="scala.concurrent.Future.type">Future</span>.<span title="(result: play.api.mvc.Result)scala.concurrent.Future[play.api.mvc.Result]">successful</span><span class="delimiter">(</span><a href="../../../../play/play/api/mvc/Results.scala.html#play.api.mvc;Results;Status.apply" title="(content: String)(implicit writeable: play.api.http.Writeable[String])play.api.mvc.Result">Forbidden</a><a href="../../../../play/play/api/http/Writeable.scala.html#play.api.http;DefaultWriteables.wString" title="implicit play.api.http.DefaultWriteables.wString : (implicit codec: play.api.mvc.Codec)play.api.http.Writeable[String]" class="delimiter">(</a><a href="#play.filters.csrf.CSRF.DefaultErrorHandler.handle.msg" title="String">msg</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class JavaCSRFErrorHandlerAdapter extends AnyRef with play.filters.csrf.CSRF.ErrorHandler" id="play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter">JavaCSRFErrorHandlerAdapter</a> @Inject<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">(</span><a title="play.filters.csrf.CSRFErrorHandler" id="play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter.underlying">underlying</a>: <a href="CSRFErrorHandler.java.html#play.filters.csrf;CSRFErrorHandler" title="play.filters.csrf.CSRFErrorHandler">CSRFErrorHandler</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.filters.csrf.CSRF;ErrorHandler" title="play.filters.csrf.CSRF.ErrorHandler">ErrorHandler</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(request: play.api.mvc.RequestHeader, msg: String)scala.concurrent.Future[play.api.mvc.Result]" id="play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter.handle">handle</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter.handle.request">request</a>: <a href="../../../../play/play/api/mvc/Http.scala.html#play.api.mvc;RequestHeader" title="play.api.mvc.RequestHeader">RequestHeader</a>, <a title="String" id="play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter.handle.msg">msg</a>: <span title="String">String</span><span class="delimiter">)</span> =
      <a href="../../../../play/play/core/j/JavaHelpers.scala.html#play.core.j.JavaHelpers" title="play.core.j.JavaHelpers.type">JavaHelpers</a>.<a href="../../../../play/play/core/j/JavaHelpers.scala.html#play.core.j;JavaHelpers.invokeWithContext" title="(request: play.api.mvc.RequestHeader, f: play.mvc.Http.Request =&gt; play.libs.F.Promise[play.mvc.Result])scala.concurrent.Future[play.api.mvc.Result]">invokeWithContext</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter.handle.request" title="play.api.mvc.RequestHeader">request</a>, <a title="play.mvc.Http.Request" id="play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter.handle.$anonfun.req">req</a> =&gt; <a href="#play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter.underlying" title="play.filters.csrf.CSRFErrorHandler">underlying</a>.<a href="CSRFErrorHandler.java.html#play.filters.csrf;CSRFErrorHandler.handle" title="(req: play.mvc.Http.RequestHeader, msg: String)play.libs.F.Promise[play.mvc.Result]">handle</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter.handle.$anonfun.req" title="play.mvc.Http.Request">req</a>, <a href="#play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter.handle.msg" title="String">msg</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="play.filters.csrf.CSRF.ErrorHandler.type" id="play.filters.csrf.CSRF.ErrorHandler">ErrorHandler</a> <a href="#play.filters.csrf.CSRF.ErrorHandler" title="play.filters.csrf.CSRF.ErrorHandler.type" class="delimiter">{</a>
    <span class="keyword">def</span> <a title="(environment: play.api.Environment, configuration: play.api.Configuration)Seq[play.api.inject.Binding[_]]" id="play.filters.csrf.CSRF.ErrorHandler.bindingsFromConfiguration">bindingsFromConfiguration</a><span class="delimiter">(</span><a title="play.api.Environment" id="play.filters.csrf.CSRF.ErrorHandler.bindingsFromConfiguration.environment">environment</a>: <a href="../../../../play/play/api/Environment.scala.html#play.api;Environment" title="play.api.Environment">Environment</a>, <a title="play.api.Configuration" id="play.filters.csrf.CSRF.ErrorHandler.bindingsFromConfiguration.configuration">configuration</a>: <a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration" title="play.api.Configuration">Configuration</a><span class="delimiter">)</span>: <span title="Seq[play.api.inject.Binding[_]]">Seq</span><span class="delimiter">[</span>Binding<span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="../../../../play/play/utils/Reflect.scala.html#play.utils.Reflect" title="play.utils.Reflect.type">Reflect</a>.<a href="../../../../play/play/utils/Reflect.scala.html#play.utils.Reflect.bindingsFromConfiguration" title="[ScalaTrait, JavaInterface, JavaAdapter &lt;: ScalaTrait, Default &lt;: ScalaTrait](environment: play.api.Environment, config: play.api.PlayConfig, key: String, defaultClassName: String)(implicit scalaTrait: play.utils.Reflect.SubClassOf[ScalaTrait], implicit javaInterface: play.utils.Reflect.SubClassOf[JavaInterface], implicit javaAdapter: scala.reflect.ClassTag[JavaAdapter], implicit default: scala.reflect.ClassTag[Default])Seq[play.api.inject.Binding[_]]">bindingsFromConfiguration</a><span title="(environment: play.api.Environment, config: play.api.PlayConfig, key: String, defaultClassName: String)(implicit scalaTrait: play.utils.Reflect.SubClassOf[play.filters.csrf.CSRF.ErrorHandler], implicit javaInterface: play.utils.Reflect.SubClassOf[play.filters.csrf.CSRFErrorHandler], implicit javaAdapter: scala.reflect.ClassTag[play.filters.csrf.CSRF.JavaCSRFErrorHandlerAdapter], implicit default: scala.reflect.ClassTag[play.filters.csrf.CSRF.CSRFHttpErrorHandler])Seq[play.api.inject.Binding[_]]" class="delimiter">[</span><a href="#play.filters.csrf.CSRF;ErrorHandler" title="play.filters.csrf.CSRF.ErrorHandler">ErrorHandler</a>, <a href="CSRFErrorHandler.java.html#play.filters.csrf;CSRFErrorHandler" title="play.filters.csrf.CSRFErrorHandler">CSRFErrorHandler</a>, <a href="#play.filters.csrf.CSRF;JavaCSRFErrorHandlerAdapter" title="play.filters.csrf.CSRF.JavaCSRFErrorHandlerAdapter">JavaCSRFErrorHandlerAdapter</a>, <a href="#play.filters.csrf.CSRF;CSRFHttpErrorHandler" title="play.filters.csrf.CSRF.CSRFHttpErrorHandler">CSRFHttpErrorHandler</a><span class="delimiter">]</span><a href="../../../../play/play/utils/Reflect.scala.html#play.utils.Reflect.SubClassOf.provide" title="(implicit evidence$5: scala.reflect.ClassTag[play.filters.csrf.CSRF.ErrorHandler])play.utils.Reflect.SubClassOf[play.filters.csrf.CSRF.ErrorHandler]" class="delimiter">(</a><a href="#play.filters.csrf.CSRF.ErrorHandler.bindingsFromConfiguration.environment" title="play.api.Environment">environment</a>, <a href="../../../../play/play/api/Configuration.scala.html#play.api.PlayConfig.apply(a5709ffad5)" title="(configuration: play.api.Configuration)play.api.PlayConfig">PlayConfig</a><span class="delimiter">(</span><a href="#play.filters.csrf.CSRF.ErrorHandler.bindingsFromConfiguration.configuration" title="play.api.Configuration">configuration</a><span class="delimiter">)</span>, <span title="String(&quot;play.filters.csrf.errorHandler&quot;)" class="string">&quot;play.filters.csrf.errorHandler&quot;</span>, <span title="String(&quot;CSRFErrorHandler&quot;)" class="string">&quot;CSRFErrorHandler&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span title="AnyRef" class="delimiter">}</span>

<span class="comment">/**
 * The CSRF module.
 */</span>
<span title="AnyRef" class="keyword">class</span> <a title="class CSRFModule extends play.api.inject.Module" id="play.filters.csrf;CSRFModule">CSRFModule</a> <a href="#play.filters.csrf;CSRFModule" title="play.filters.csrf.CSRFModule" class="keyword">extends</a> <a href="../../../../play/play/api/inject/Module.scala.html#play.api.inject;Module" title="play.api.inject.Module">Module</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(environment: play.api.Environment, configuration: play.api.Configuration)Seq[play.api.inject.Binding[_]]" id="play.filters.csrf;CSRFModule.bindings">bindings</a><span class="delimiter">(</span><a title="play.api.Environment" id="play.filters.csrf;CSRFModule.bindings.environment">environment</a>: <a href="../../../../play/play/api/Environment.scala.html#play.api;Environment" title="play.api.Environment">Environment</a>, <a title="play.api.Configuration" id="play.filters.csrf;CSRFModule.bindings.configuration">configuration</a>: <a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration" title="play.api.Configuration">Configuration</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="(elems: play.api.inject.Binding[_ &gt;: play.filters.csrf.CSRFFilter with play.filters.csrf.CSRF.TokenProvider with play.filters.csrf.CSRFConfig &lt;: Object]*)Seq[play.api.inject.Binding[_ &gt;: play.filters.csrf.CSRFFilter with play.filters.csrf.CSRF.TokenProvider with play.filters.csrf.CSRFConfig &lt;: Object]]">Seq</span><span class="delimiter">(</span>
      <a href="../../../../play/play/api/inject/Module.scala.html#play.api.inject;Module.bind(0f4f2e3300)" title="[T](implicit evidence$1: scala.reflect.ClassTag[T])play.api.inject.BindingKey[T]">bind</a><span title="(implicit evidence$1: scala.reflect.ClassTag[play.filters.csrf.CSRFConfig])play.api.inject.BindingKey[play.filters.csrf.CSRFConfig]" class="delimiter">[</span><a href="#play.filters.csrf;CSRFConfig" title="play.filters.csrf.CSRFConfig">CSRFConfig</a><span class="delimiter">]</span>.<a href="../../../../play/play/api/inject/Binding.scala.html#play.api.inject;BindingKey.toProvider(c51c22a89b)" title="[P &lt;: javax.inject.Provider[play.filters.csrf.CSRFConfig]](implicit evidence$4: scala.reflect.ClassTag[P])play.api.inject.Binding[play.filters.csrf.CSRFConfig]">toProvider</a><span title="(implicit evidence$4: scala.reflect.ClassTag[play.filters.csrf.CSRFConfigProvider])play.api.inject.Binding[play.filters.csrf.CSRFConfig]" class="delimiter">[</span><a href="#play.filters.csrf;CSRFConfigProvider" title="play.filters.csrf.CSRFConfigProvider">CSRFConfigProvider</a><span class="delimiter">]</span>,
      <a href="../../../../play/play/api/inject/Module.scala.html#play.api.inject;Module.bind(0f4f2e3300)" title="[T](implicit evidence$1: scala.reflect.ClassTag[T])play.api.inject.BindingKey[T]">bind</a><span title="(implicit evidence$1: scala.reflect.ClassTag[play.filters.csrf.CSRF.TokenProvider])play.api.inject.BindingKey[play.filters.csrf.CSRF.TokenProvider]" class="delimiter">[</span>CSRF.<a href="#play.filters.csrf.CSRF;TokenProvider" title="play.filters.csrf.CSRF.TokenProvider">TokenProvider</a><span class="delimiter">]</span>.<a href="../../../../play/play/api/inject/Binding.scala.html#play.api.inject;BindingKey.toProvider(c51c22a89b)" title="[P &lt;: javax.inject.Provider[play.filters.csrf.CSRF.TokenProvider]](implicit evidence$4: scala.reflect.ClassTag[P])play.api.inject.Binding[play.filters.csrf.CSRF.TokenProvider]">toProvider</a><span title="(implicit evidence$4: scala.reflect.ClassTag[play.filters.csrf.CSRF.TokenProviderProvider])play.api.inject.Binding[play.filters.csrf.CSRF.TokenProvider]" class="delimiter">[</span>CSRF.<a href="#play.filters.csrf.CSRF;TokenProviderProvider" title="play.filters.csrf.CSRF.TokenProviderProvider">TokenProviderProvider</a><span class="delimiter">]</span>,
      <a href="../../../../play/play/api/inject/Module.scala.html#play.api.inject;Module.bind(0f4f2e3300)" title="[T](implicit evidence$1: scala.reflect.ClassTag[T])play.api.inject.BindingKey[T]">bind</a><span title="(implicit evidence$1: scala.reflect.ClassTag[play.filters.csrf.CSRFFilter])play.api.inject.BindingKey[play.filters.csrf.CSRFFilter]" class="delimiter">[</span><a href="CSRFFilter.scala.html#play.filters.csrf;CSRFFilter" title="play.filters.csrf.CSRFFilter">CSRFFilter</a><span class="delimiter">]</span>.<a href="../../../../play/play/api/inject/Binding.scala.html#play.api.inject;BindingKey.toSelf" title="=&gt; play.api.inject.Binding[play.filters.csrf.CSRFFilter]">toSelf</a>
    <span class="delimiter">)</span> <span title="(that: scala.collection.GenTraversableOnce[play.api.inject.Binding[_]])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[play.api.inject.Binding[_ &gt;: play.filters.csrf.CSRFFilter with play.filters.csrf.CSRF.TokenProvider with play.filters.csrf.CSRFConfig &lt;: Object]],play.api.inject.Binding[_],Seq[play.api.inject.Binding[_]]])Seq[play.api.inject.Binding[_]]">++</span> <a href="#play.filters.csrf.CSRF.ErrorHandler" title="play.filters.csrf.CSRF.ErrorHandler.type">ErrorHandler</a>.<a href="#play.filters.csrf.CSRF.ErrorHandler.bindingsFromConfiguration" title="(environment: play.api.Environment, configuration: play.api.Configuration)Seq[play.api.inject.Binding[_]]">bindingsFromConfiguration</a><span class="delimiter">(</span><a href="#play.filters.csrf;CSRFModule.bindings.environment" title="play.api.Environment">environment</a>, <a href="#play.filters.csrf;CSRFModule.bindings.configuration" title="play.api.Configuration">configuration</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * The CSRF components.
 */</span>
<span class="keyword">trait</span> <a title="trait CSRFComponents extends AnyRef" id="play.filters.csrf;CSRFComponents">CSRFComponents</a> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; play.api.Configuration" id="play.filters.csrf;CSRFComponents.configuration">configuration</a>: <a href="../../../../play/play/api/Configuration.scala.html#play.api;Configuration" title="play.api.Configuration">Configuration</a>
  <span class="keyword">def</span> <a title="=&gt; play.api.http.HttpErrorHandler" id="play.filters.csrf;CSRFComponents.httpErrorHandler">httpErrorHandler</a>: <a href="../../../../play/play/api/http/HttpErrorHandler.scala.html#play.api.http;HttpErrorHandler" title="play.api.http.HttpErrorHandler">HttpErrorHandler</a>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.filters.csrf.CSRFConfig" id="play.filters.csrf;CSRFComponents.csrfConfig">csrfConfig</a>: <a href="#play.filters.csrf;CSRFConfig" title="play.filters.csrf.CSRFConfig">CSRFConfig</a> = <a href="#play.filters.csrf.CSRFConfig.readResolve" title="play.filters.csrf.CSRFConfig.type">CSRFConfig</a>.<a href="#play.filters.csrf.CSRFConfig.fromConfiguration" title="(conf: play.api.Configuration)play.filters.csrf.CSRFConfig">fromConfiguration</a><span class="delimiter">(</span><a href="#play.filters.csrf;CSRFComponents.configuration" title="=&gt; play.api.Configuration">configuration</a><span class="delimiter">)</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.filters.csrf.CSRF.TokenProvider" id="play.filters.csrf;CSRFComponents.csrfTokenProvider">csrfTokenProvider</a>: CSRF.<a href="#play.filters.csrf.CSRF;TokenProvider" title="play.filters.csrf.CSRF.TokenProvider">TokenProvider</a> = <span title="play.filters.csrf.CSRF.TokenProviderProvider" class="keyword">new</span> <a href="#play.filters.csrf.CSRF" title="play.filters.csrf.CSRF.type">CSRF</a>.<a href="#play.filters.csrf.CSRF;TokenProviderProvider" title="play.filters.csrf.CSRF.TokenProviderProvider">TokenProviderProvider</a><span class="delimiter">(</span><a href="#play.filters.csrf;CSRFComponents.csrfConfig" title="=&gt; play.filters.csrf.CSRFConfig">csrfConfig</a><span class="delimiter">)</span>.<a href="#play.filters.csrf.CSRF;TokenProviderProvider.get" title="=&gt; play.filters.csrf.CSRF.TokenProvider">get</a>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.filters.csrf.CSRF.ErrorHandler" id="play.filters.csrf;CSRFComponents.csrfErrorHandler">csrfErrorHandler</a>: CSRF.<a href="#play.filters.csrf.CSRF;ErrorHandler" title="play.filters.csrf.CSRF.ErrorHandler">ErrorHandler</a> = <span title="play.filters.csrf.CSRF.CSRFHttpErrorHandler" class="keyword">new</span> <a href="#play.filters.csrf.CSRF;CSRFHttpErrorHandler" title="play.filters.csrf.CSRF.CSRFHttpErrorHandler">CSRFHttpErrorHandler</a><span class="delimiter">(</span><a href="#play.filters.csrf;CSRFComponents.httpErrorHandler" title="=&gt; play.api.http.HttpErrorHandler">httpErrorHandler</a><span class="delimiter">)</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.filters.csrf.CSRFFilter" id="play.filters.csrf;CSRFComponents.csrfFilter">csrfFilter</a>: <a href="CSRFFilter.scala.html#play.filters.csrf;CSRFFilter" title="play.filters.csrf.CSRFFilter">CSRFFilter</a> = <span title="play.filters.csrf.CSRFFilter" class="keyword">new</span> <a href="CSRFFilter.scala.html#play.filters.csrf;CSRFFilter" title="play.filters.csrf.CSRFFilter">CSRFFilter</a><span class="delimiter">(</span><a href="#play.filters.csrf;CSRFComponents.csrfConfig" title="=&gt; play.filters.csrf.CSRFConfig">csrfConfig</a>, <a href="#play.filters.csrf;CSRFComponents.csrfTokenProvider" title="=&gt; play.filters.csrf.CSRF.TokenProvider">csrfTokenProvider</a>, <a href="#play.filters.csrf;CSRFComponents.csrfErrorHandler" title="=&gt; play.filters.csrf.CSRF.ErrorHandler">csrfErrorHandler</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

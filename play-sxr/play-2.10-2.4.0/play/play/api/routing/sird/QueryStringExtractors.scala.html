<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play/play/api/routing/sird/QueryStringExtractors.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.api.routing.sird

<span class="keyword">import</span> java.net.<span class="delimiter">{</span> URI, URL <span class="delimiter">}</span>

<span class="keyword">import</span> play.api.mvc.RequestHeader

<span class="keyword">import</span> scala.reflect.macros.Context

<span class="keyword">class</span> <a title="class RequiredQueryStringParameter extends AnyRef with play.api.routing.sird.QueryStringParameterExtractor[String]" id="play.api.routing.sird;RequiredQueryStringParameter">RequiredQueryStringParameter</a><a href="#play.api.routing.sird;RequiredQueryStringParameter" title="play.api.routing.sird.RequiredQueryStringParameter" class="delimiter">(</a><a title="String" id="play.api.routing.sird;RequiredQueryStringParameter.paramName">paramName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.api.routing.sird;QueryStringParameterExtractor" title="play.api.routing.sird.QueryStringParameterExtractor[String]">QueryStringParameterExtractor</a><span class="delimiter">[</span>String<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(qs: play.api.routing.sird.QueryString)Option[String]" id="play.api.routing.sird;RequiredQueryStringParameter.unapply(f1016bea31)">unapply</a><span class="delimiter">(</span><a title="play.api.routing.sird.QueryString" id="play.api.routing.sird;RequiredQueryStringParameter.unapply(f1016bea31).qs">qs</a>: <span title="play.api.routing.sird.QueryString">QueryString</span><span class="delimiter">)</span>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="#play.api.routing.sird;RequiredQueryStringParameter.unapply(f1016bea31).qs" title="play.api.routing.sird.QueryString">qs</a>.<span title="(key: String)Option[Seq[String]]">get</span><span class="delimiter">(</span><a href="#play.api.routing.sird;RequiredQueryStringParameter.paramName" title="String">paramName</a><span class="delimiter">)</span>.<span title="(f: Seq[String] =&gt; Option[String])Option[String]">flatMap</span><span class="delimiter">(</span><a href="#play.api.routing.sird;RequiredQueryStringParameter.unapply(f1016bea31).$anonfun.x$1" title="Seq[String]">_</a>.<span title="=&gt; Option[String]">headOption</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class OptionalQueryStringParameter extends AnyRef with play.api.routing.sird.QueryStringParameterExtractor[Option[String]]" id="play.api.routing.sird;OptionalQueryStringParameter">OptionalQueryStringParameter</a><a href="#play.api.routing.sird;OptionalQueryStringParameter" title="play.api.routing.sird.OptionalQueryStringParameter" class="delimiter">(</a><a title="String" id="play.api.routing.sird;OptionalQueryStringParameter.paramName">paramName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.api.routing.sird;QueryStringParameterExtractor" title="play.api.routing.sird.QueryStringParameterExtractor[Option[String]]">QueryStringParameterExtractor</a><span class="delimiter">[</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(qs: play.api.routing.sird.QueryString)Option[Option[String]]" id="play.api.routing.sird;OptionalQueryStringParameter.unapply(6fb43029cc)">unapply</a><span class="delimiter">(</span><a title="play.api.routing.sird.QueryString" id="play.api.routing.sird;OptionalQueryStringParameter.unapply(6fb43029cc).qs">qs</a>: <span title="play.api.routing.sird.QueryString">QueryString</span><span class="delimiter">)</span>: <span title="Option[Option[String]]">Option</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="(x: Option[String])Some[Option[String]]">Some</span><span class="delimiter">(</span><a href="#play.api.routing.sird;OptionalQueryStringParameter.unapply(6fb43029cc).qs" title="play.api.routing.sird.QueryString">qs</a>.<span title="(key: String)Option[Seq[String]]">get</span><span class="delimiter">(</span><a href="#play.api.routing.sird;OptionalQueryStringParameter.paramName" title="String">paramName</a><span class="delimiter">)</span>.<span title="(f: Seq[String] =&gt; Option[String])Option[String]">flatMap</span><span class="delimiter">(</span><a href="#play.api.routing.sird;OptionalQueryStringParameter.unapply(6fb43029cc).$anonfun.x$2" title="Seq[String]">_</a>.<span title="=&gt; Option[String]">headOption</span><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SeqQueryStringParameter extends AnyRef with play.api.routing.sird.QueryStringParameterExtractor[Seq[String]]" id="play.api.routing.sird;SeqQueryStringParameter">SeqQueryStringParameter</a><a href="#play.api.routing.sird;SeqQueryStringParameter" title="play.api.routing.sird.SeqQueryStringParameter" class="delimiter">(</a><a title="String" id="play.api.routing.sird;SeqQueryStringParameter.paramName">paramName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.api.routing.sird;QueryStringParameterExtractor" title="play.api.routing.sird.QueryStringParameterExtractor[Seq[String]]">QueryStringParameterExtractor</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(qs: play.api.routing.sird.QueryString)Option[Seq[String]]" id="play.api.routing.sird;SeqQueryStringParameter.unapply(748238b05d)">unapply</a><span class="delimiter">(</span><a title="play.api.routing.sird.QueryString" id="play.api.routing.sird;SeqQueryStringParameter.unapply(748238b05d).qs">qs</a>: <span title="play.api.routing.sird.QueryString">QueryString</span><span class="delimiter">)</span>: <span title="Option[Seq[String]]">Option</span><span class="delimiter">[</span>Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="(x: Seq[String])Some[Seq[String]]">Some</span><span class="delimiter">(</span><a href="#play.api.routing.sird;SeqQueryStringParameter.unapply(748238b05d).qs" title="play.api.routing.sird.QueryString">qs</a>.<span title="(key: String)Option[Seq[String]]">get</span><span class="delimiter">(</span><a href="#play.api.routing.sird;SeqQueryStringParameter.paramName" title="String">paramName</a><span class="delimiter">)</span>.<span title="(default: =&gt; Seq[String])Seq[String]">getOrElse</span><span class="delimiter">(</span><span title="scala.collection.immutable.Nil.type">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait QueryStringParameterExtractor[T] extends AnyRef" id="play.api.routing.sird;QueryStringParameterExtractor">QueryStringParameterExtractor</a><span class="delimiter">[</span><a title="" id="play.api.routing.sird;QueryStringParameterExtractor;T">T</a><span class="delimiter">]</span> <span title="Unit" class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#play.api.routing.sird.QueryStringParameterExtractor" title="play.api.routing.sird.QueryStringParameterExtractor.type">QueryStringParameterExtractor</a>._
  <span class="keyword">def</span> <a title="(qs: play.api.routing.sird.QueryString)Option[T]" id="play.api.routing.sird;QueryStringParameterExtractor.unapply(dc2e572cbf)">unapply</a><span class="delimiter">(</span><a title="play.api.routing.sird.QueryString" id="play.api.routing.sird;QueryStringParameterExtractor.unapply(dc2e572cbf).qs">qs</a>: <span title="play.api.routing.sird.QueryString">QueryString</span><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="(req: play.api.mvc.RequestHeader)Option[T]" id="play.api.routing.sird;QueryStringParameterExtractor.unapply(c90411fd57)">unapply</a><span class="delimiter">(</span><a title="play.api.mvc.RequestHeader" id="play.api.routing.sird;QueryStringParameterExtractor.unapply(c90411fd57).req">req</a>: <a href="../../mvc/Http.scala.html#play.api.mvc;RequestHeader" title="play.api.mvc.RequestHeader">RequestHeader</a><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <a href="#play.api.routing.sird;QueryStringParameterExtractor.unapply(dc2e572cbf)" title="(qs: play.api.routing.sird.QueryString)Option[T]">unapply</a><span class="delimiter">(</span><a href="#play.api.routing.sird;QueryStringParameterExtractor.unapply(c90411fd57).req" title="play.api.mvc.RequestHeader">req</a>.<a href="../../mvc/Http.scala.html#play.api.mvc;RequestHeader.queryString" title="=&gt; Map[String,Seq[String]]">queryString</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(uri: java.net.URI)Option[T]" id="play.api.routing.sird;QueryStringParameterExtractor.unapply(af5b01c08b)">unapply</a><span class="delimiter">(</span><a title="java.net.URI" id="play.api.routing.sird;QueryStringParameterExtractor.unapply(af5b01c08b).uri">uri</a>: <span title="java.net.URI">URI</span><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <a href="#play.api.routing.sird;QueryStringParameterExtractor.unapply(dc2e572cbf)" title="(qs: play.api.routing.sird.QueryString)Option[T]">unapply</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterExtractor.parse" title="(query: String)play.api.routing.sird.QueryString">parse</a><span class="delimiter">(</span><a href="#play.api.routing.sird;QueryStringParameterExtractor.unapply(af5b01c08b).uri" title="java.net.URI">uri</a>.<span title="()String">getRawQuery</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(uri: java.net.URL)Option[T]" id="play.api.routing.sird;QueryStringParameterExtractor.unapply(c1a5144019)">unapply</a><span class="delimiter">(</span><a title="java.net.URL" id="play.api.routing.sird;QueryStringParameterExtractor.unapply(c1a5144019).uri">uri</a>: <span title="java.net.URL">URL</span><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <a href="#play.api.routing.sird;QueryStringParameterExtractor.unapply(dc2e572cbf)" title="(qs: play.api.routing.sird.QueryString)Option[T]">unapply</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterExtractor.parse" title="(query: String)play.api.routing.sird.QueryString">parse</a><span class="delimiter">(</span><a href="#play.api.routing.sird;QueryStringParameterExtractor.unapply(c1a5144019).uri" title="java.net.URL">uri</a>.<span title="()String">getQuery</span><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">object</span> <a title="play.api.routing.sird.QueryStringParameterExtractor.type" id="play.api.routing.sird.QueryStringParameterExtractor">QueryStringParameterExtractor</a> <a href="#play.api.routing.sird.QueryStringParameterExtractor" title="play.api.routing.sird.QueryStringParameterExtractor.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(query: String)play.api.routing.sird.QueryString" id="play.api.routing.sird.QueryStringParameterExtractor.parse">parse</a><span class="delimiter">(</span><a title="String" id="play.api.routing.sird.QueryStringParameterExtractor.parse.query">query</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="play.api.routing.sird.QueryString">QueryString</span> = <span class="delimiter">{</span>
    <span title="(x: String)Option[String]">Option</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterExtractor.parse.query" title="String">query</a><span class="delimiter">)</span>.<span title="(f: String =&gt; scala.collection.immutable.Map[String,Seq[String]])Option[scala.collection.immutable.Map[String,Seq[String]]]">map</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterExtractor.parse.$anonfun.x$3" title="String">_</a>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="String(&quot;&amp;&quot;)" class="string">&quot;&amp;&quot;</span><span class="delimiter">)</span>.<span title="=&gt; Seq[String]">toSeq</span>.<span title="(f: String =&gt; (String, String))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],(String, String),Seq[(String, String)]])Seq[(String, String)]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(String, String),Seq[(String, String)]]" class="delimiter">{</span> <a title="String" id="play.api.routing.sird.QueryStringParameterExtractor.parse.$anonfun.$anonfun.keyValue">keyValue</a> =&gt;
      <a href="#play.api.routing.sird.QueryStringParameterExtractor.parse.$anonfun.$anonfun.keyValue" title="String">keyValue</a>.<span title="(x$1: String, x$2: Int)Array[String]">split</span><span class="delimiter">(</span><span title="String(&quot;=&quot;)" class="string">&quot;=&quot;</span>, <span title="Int(2)" class="int">2</span><span class="delimiter">)</span> <span title="(String, String)" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#play.api.routing.sird.QueryStringParameterExtractor.parse.$anonfun.$anonfun.<unapply-selector>" title="(x: Array[String])Option[IndexedSeq[String]]">Array</a><span class="delimiter">(</span><span title="String">key</span>, <a title="String" id="play.api.routing.sird.QueryStringParameterExtractor.parse.$anonfun.$anonfun.value">value</a><span class="delimiter">)</span> =&gt; <span title="(x: String)ArrowAssoc[String]">key</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#play.api.routing.sird.QueryStringParameterExtractor.parse.$anonfun.$anonfun.value" title="String">value</a>
        <span class="keyword">case</span> <a href="#play.api.routing.sird.QueryStringParameterExtractor.parse.$anonfun.$anonfun.<unapply-selector>" title="(x: Array[String])Option[IndexedSeq[String]]">Array</a><span class="delimiter">(</span><span title="String">key</span><span class="delimiter">)</span> =&gt; <span title="(x: String)ArrowAssoc[String]">key</span> <span title="(y: String)(String, String)">-&gt;</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>.<span title="(f: ((String, String)) =&gt; String)scala.collection.immutable.Map[String,Seq[(String, String)]]">groupBy</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterExtractor.parse.$anonfun.$anonfun.x$4" title="(String, String)">_</a>.<span title="=&gt; String">_1</span><span class="delimiter">)</span>.<span title="(f: Seq[(String, String)] =&gt; Seq[String])scala.collection.immutable.Map[String,Seq[String]]">mapValues</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterExtractor.parse.$anonfun.$anonfun.x$5" title="Seq[(String, String)]">_</a>.<span title="(f: ((String, String)) =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, String)],String,Seq[String]])Seq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,String,Seq[String]]" class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterExtractor.parse.$anonfun.$anonfun.$anonfun.x$6" title="(String, String)">_</a>.<span title="=&gt; String">_2</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ev: &lt;:&lt;[(String, Seq[String]),(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">toMap</span><span class="delimiter">)</span>
      .<span title="(default: =&gt; scala.collection.immutable.Map[String,Seq[String]])scala.collection.immutable.Map[String,Seq[String]]">getOrElse</span><span class="delimiter">(</span><span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="scala.collection.immutable.Map[String,Nothing]">empty</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(name: String)play.api.routing.sird.RequiredQueryStringParameter" id="play.api.routing.sird.QueryStringParameterExtractor.required">required</a><span class="delimiter">(</span><a title="String" id="play.api.routing.sird.QueryStringParameterExtractor.required.name">name</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="play.api.routing.sird.RequiredQueryStringParameter" class="keyword">new</span> <a href="#play.api.routing.sird;RequiredQueryStringParameter" title="play.api.routing.sird.RequiredQueryStringParameter">RequiredQueryStringParameter</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterExtractor.required.name" title="String">name</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(name: String)play.api.routing.sird.OptionalQueryStringParameter" id="play.api.routing.sird.QueryStringParameterExtractor.optional">optional</a><span class="delimiter">(</span><a title="String" id="play.api.routing.sird.QueryStringParameterExtractor.optional.name">name</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="play.api.routing.sird.OptionalQueryStringParameter" class="keyword">new</span> <a href="#play.api.routing.sird;OptionalQueryStringParameter" title="play.api.routing.sird.OptionalQueryStringParameter">OptionalQueryStringParameter</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterExtractor.optional.name" title="String">name</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(name: String)play.api.routing.sird.SeqQueryStringParameter" id="play.api.routing.sird.QueryStringParameterExtractor.seq">seq</a><span class="delimiter">(</span><a title="String" id="play.api.routing.sird.QueryStringParameterExtractor.seq.name">name</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="play.api.routing.sird.SeqQueryStringParameter" class="keyword">new</span> <a href="#play.api.routing.sird;SeqQueryStringParameter" title="play.api.routing.sird.SeqQueryStringParameter">SeqQueryStringParameter</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterExtractor.seq.name" title="String">name</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * The macros are used to parse and validate the query string parameters at compile time.
 *
 * They generate AST that constructs the extractors directly with the parsed parameter name, instead of having to parse
 * the string context parameters at runtime.
 */</span>
<span title="AnyRef" class="keyword">private</span><span class="delimiter">[</span>sird<span class="delimiter">]</span> <span class="keyword">object</span> <a title="play.api.routing.sird.QueryStringParameterMacros.type" id="play.api.routing.sird.QueryStringParameterMacros">QueryStringParameterMacros</a> <a href="#play.api.routing.sird.QueryStringParameterMacros" title="play.api.routing.sird.QueryStringParameterMacros.type" class="delimiter">{</a>
  <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="play.api.routing.sird.QueryStringParameterMacros.paramEquals">paramEquals</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;([^&amp;=]+)=&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>

  <span class="keyword">def</span> <a title="(c: scala.reflect.macros.Context)c.Expr[Nothing]" id="play.api.routing.sird.QueryStringParameterMacros.required">required</a><span class="delimiter">(</span><a title="scala.reflect.macros.Context" id="play.api.routing.sird.QueryStringParameterMacros.required.c">c</a>: <span title="scala.reflect.macros.Context">Context</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl" title="(c: scala.reflect.macros.Context, name: String, extractorName: String)c.Expr[Nothing]">macroImpl</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.required.c" title="scala.reflect.macros.Context">c</a>, <span title="String(&quot;q&quot;)" class="string">&quot;q&quot;</span>, <span title="String(&quot;required&quot;)" class="string">&quot;required&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(c: scala.reflect.macros.Context)c.Expr[Nothing]" id="play.api.routing.sird.QueryStringParameterMacros.optional">optional</a><span class="delimiter">(</span><a title="scala.reflect.macros.Context" id="play.api.routing.sird.QueryStringParameterMacros.optional.c">c</a>: <span title="scala.reflect.macros.Context">Context</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl" title="(c: scala.reflect.macros.Context, name: String, extractorName: String)c.Expr[Nothing]">macroImpl</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.optional.c" title="scala.reflect.macros.Context">c</a>, <span title="String(&quot;q_?&quot;)" class="string">&quot;q_?&quot;</span>, <span title="String(&quot;optional&quot;)" class="string">&quot;optional&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(c: scala.reflect.macros.Context)c.Expr[Nothing]" id="play.api.routing.sird.QueryStringParameterMacros.seq">seq</a><span class="delimiter">(</span><a title="scala.reflect.macros.Context" id="play.api.routing.sird.QueryStringParameterMacros.seq.c">c</a>: <span title="scala.reflect.macros.Context">Context</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl" title="(c: scala.reflect.macros.Context, name: String, extractorName: String)c.Expr[Nothing]">macroImpl</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.seq.c" title="scala.reflect.macros.Context">c</a>, <span title="String(&quot;q_*&quot;)" class="string">&quot;q_*&quot;</span>, <span title="String(&quot;seq&quot;)" class="string">&quot;seq&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(c: scala.reflect.macros.Context, name: String, extractorName: String)c.Expr[Nothing]" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl">macroImpl</a><span class="delimiter">(</span><a title="scala.reflect.macros.Context" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.c">c</a>: <span title="scala.reflect.macros.Context">Context</span>, <a title="String" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.name">name</a>: <span title="String">String</span>, <a title="String" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.extractorName">extractorName</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="=&gt; scala.reflect.macros.Universe">universe</span>._

    <span class="comment">// Inspect the prefix, this is call that constructs the StringContext, containing the StringContext parts</span>
    <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="=&gt; c.Expr[c.PrefixType]">prefix</span>.<span title="=&gt; c.universe.Tree">tree</span> <span title="c.Expr[Nothing]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(apply: c.universe.Apply)Option[(c.universe.Tree, List[c.universe.Tree])]">Apply</a><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(x: Any)Option[c.universe.Apply]" class="delimiter">(</a>_, <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.<unapply-selector>" title="(x: List[c.universe.Tree])Some[List[c.universe.Tree]]">List</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(apply: c.universe.Apply)Option[(c.universe.Tree, List[c.universe.Tree])]">Apply</a><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(x: Any)Option[c.universe.Apply]" class="delimiter">(</a>_, <a title="List[c.universe.Tree]" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.rawParts">rawParts</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <span class="comment">// extract the part literals</span>
        <span class="keyword">val</span> <a title="List[String]" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.parts">parts</a> = <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.rawParts" title="List[c.universe.Tree]">rawParts</a> <span title="(f: c.universe.Tree =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[c.universe.Tree],String,List[String]])List[String]">map</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.parts.$anonfun.x0$1" title="String" class="delimiter">{</a> <span class="keyword">case</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(literal: c.universe.Literal)Option[c.universe.Constant]">Literal</a><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(x: Any)Option[c.universe.Literal]" class="delimiter">(</a><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(arg: c.universe.Constant)Option[Any]">Constant</a><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(x: Any)Option[c.universe.Constant]" class="delimiter">(</a><a title="String" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.parts.$anonfun.const">const</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.parts.$anonfun.const" title="String">const</a> <span class="delimiter">}</span>

        <span class="comment">// Extract paramName, and validate</span>
        <span class="keyword">val</span> <a title="Int" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.startOfString">startOfString</a> = <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="=&gt; c.Position">enclosingPosition</span>.<span title="=&gt; Int">point</span> <span title="(x: Int)Int">+</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.name" title="String">name</a>.<span title="()Int">length</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
        <span class="keyword">val</span> <a title="String" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.paramName">paramName</a> = <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.parts" title="List[String]">parts</a>.<span title="=&gt; String">head</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.paramEquals" title="(target: Any)Option[List[String]]">paramEquals</a><span class="delimiter">(</span><a title="String" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.paramName.param">param</a><span class="delimiter">)</span> =&gt; <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.paramName.param" title="String">param</a>
          <span class="keyword">case</span> _ =&gt; <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="(pos: c.Position, msg: String)Nothing">abort</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="=&gt; c.Position">enclosingPosition</span>.<span title="(off: Int)c.enclosingPosition.Pos">withPoint</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.startOfString" title="Int">startOfString</a><span class="delimiter">)</span>, <span title="String(&quot;Invalid start of string for query string extractor \'&quot;)" class="string">&quot;Invalid start of string for query string extractor '&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.parts" title="List[String]">parts</a>.<span title="=&gt; String">head</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\', extractor string must have format &quot;)" class="string">&quot;', extractor string must have format &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.name" title="String">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\&quot;param=$extracted\&quot;&quot;)" class="string">&quot;\&quot;param=$extracted\&quot;&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.parts" title="List[String]">parts</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="(pos: c.Position, msg: String)Nothing">abort</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="=&gt; c.Position">enclosingPosition</span>.<span title="(off: Int)c.enclosingPosition.Pos">withPoint</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.startOfString" title="Int">startOfString</a> <span title="(x: Int)Int">+</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.paramName" title="String">paramName</a>.<span title="()Int">length</span><span class="delimiter">)</span>, <span title="String(&quot;Unexpected end of String, expected parameter extractor, eg $extracted&quot;)" class="string">&quot;Unexpected end of String, expected parameter extractor, eg $extracted&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.parts" title="List[String]">parts</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="(pos: c.Position, msg: String)Nothing">abort</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="=&gt; c.Position">enclosingPosition</span>, <span title="String(&quot;Query string extractor can only extract one parameter, extract multiple parameters using the &amp; extractor, eg: &quot;)" class="string">&quot;Query string extractor can only extract one parameter, extract multiple parameters using the &amp; extractor, eg: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.name" title="String">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\&quot;param1=$param1\&quot; &amp; &quot;)" class="string">&quot;\&quot;param1=$param1\&quot; &amp; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.name" title="String">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\&quot;param2=$param2\&quot;&quot;)" class="string">&quot;\&quot;param2=$param2\&quot;&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.parts" title="(n: Int)String">parts</a><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="(pos: c.Position, msg: String)Nothing">abort</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="=&gt; c.Position">enclosingPosition</span>, <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Unexpected text at end of query string extractor: \'&quot;)">Unexpected text at end of query string extractor: '$</span><span class="delimiter">{</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.parts" title="(n: Int)String">parts</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">}</span><span title="String(&quot;\'&quot;)" class="string">'&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="comment">// the QueryStringParameterExtractor object</span>
        <span class="keyword">val</span> <a title="c.universe.Select" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.sirdPackage">sirdPackage</a> = <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(qualifier: c.universe.Tree, name: c.universe.Name)c.universe.Select">Select</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(qualifier: c.universe.Tree, name: c.universe.Name)c.universe.Select">Select</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(qualifier: c.universe.Tree, name: c.universe.Name)c.universe.Select">Select</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(name: c.universe.Name)c.universe.Ident">Ident</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(s: String)c.universe.TermName">newTermName</a><span class="delimiter">(</span><span title="String(&quot;play&quot;)" class="string">&quot;play&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(s: String)c.universe.TermName">newTermName</a><span class="delimiter">(</span><span title="String(&quot;api&quot;)" class="string">&quot;api&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>,
          <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(s: String)c.universe.TermName">newTermName</a><span class="delimiter">(</span><span title="String(&quot;routing&quot;)" class="string">&quot;routing&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(s: String)c.universe.TermName">newTermName</a><span class="delimiter">(</span><span title="String(&quot;sird&quot;)" class="string">&quot;sird&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="c.universe.Select" id="play.api.routing.sird.QueryStringParameterMacros.macroImpl.extractor">extractor</a> = <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(qualifier: c.universe.Tree, name: c.universe.Name)c.universe.Select">Select</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.sirdPackage" title="c.universe.Select">sirdPackage</a>, <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(s: String)c.universe.TermName">newTermName</a><span class="delimiter">(</span><span title="String(&quot;QueryStringParameterExtractor&quot;)" class="string">&quot;QueryStringParameterExtractor&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="comment">// Return AST that invokes the desired method to create the extractor on QueryStringParameterExtractor, passing</span>
        <span class="comment">// the parameter name to it</span>
        <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="(tree: c.Tree)(implicit evidence$1: c.WeakTypeTag[Nothing])c.Expr[Nothing]">Expr</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="=&gt; c.universe.WeakTypeTag[Nothing]" class="delimiter">(</a><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(fun: c.universe.Tree, args: List[c.universe.Tree])c.universe.Apply">Apply</a><span class="delimiter">(</span>
          <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(qualifier: c.universe.Tree, name: c.universe.Name)c.universe.Select">Select</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.extractor" title="c.universe.Select">extractor</a>, <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(s: String)c.universe.TermName">newTermName</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.extractorName" title="String">extractorName</a><span class="delimiter">)</span><span class="delimiter">)</span>,
          <span title="(xs: c.universe.Literal*)List[c.universe.Literal]">List</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(value: c.universe.Constant)c.universe.Literal">Literal</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="(value: Any)c.universe.Constant">Constant</a><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.paramName" title="String">paramName</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">)</span><span class="delimiter">)</span>

      <span class="keyword">case</span> _ =&gt;
        <a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="(pos: c.Position, msg: String)Nothing">abort</span><span class="delimiter">(</span><a href="#play.api.routing.sird.QueryStringParameterMacros.macroImpl.c" title="scala.reflect.macros.Context">c</a>.<span title="=&gt; c.Position">enclosingPosition</span>, <span title="String(&quot;Invalid use of query string extractor&quot;)" class="string">&quot;Invalid use of query string extractor&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>
        </pre>
    </body>
</html>

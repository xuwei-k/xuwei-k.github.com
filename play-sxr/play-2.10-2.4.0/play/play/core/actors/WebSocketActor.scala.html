<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play/play/core/actors/WebSocketActor.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2015 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.core.actors

<span class="keyword">import</span> akka.actor._
<span class="keyword">import</span> play.api.libs.iteratee._
<span class="keyword">import</span> akka.actor.Terminated
<span class="keyword">import</span> scala.reflect.ClassTag

<span class="comment">/**
 * Integration between Play WebSockets and actors
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>play<span class="delimiter">]</span> <span class="keyword">object</span> <a title="play.core.actors.WebSocketActor.type" id="play.core.actors.WebSocketActor">WebSocketActor</a> <a href="#play.core.actors.WebSocketActor" title="play.core.actors.WebSocketActor.type" class="delimiter">{</a>

  <span class="keyword">object</span> <a title="play.core.actors.WebSocketActor.WebSocketActorSupervisor.type" id="play.core.actors.WebSocketActor.WebSocketActorSupervisor">WebSocketActorSupervisor</a> <a href="#play.core.actors.WebSocketActor.WebSocketActorSupervisor" title="play.core.actors.WebSocketActor.WebSocketActorSupervisor.type" class="delimiter">{</a>
    <span class="keyword">def</span> <a title="[In, Out](enumerator: play.api.libs.iteratee.Enumerator[In], iteratee: play.api.libs.iteratee.Iteratee[Out,Unit], createHandler: akka.actor.ActorRef =&gt; akka.actor.Props)(implicit evidence$1: scala.reflect.ClassTag[Out])akka.actor.Props" id="play.core.actors.WebSocketActor.WebSocketActorSupervisor.props">props</a><span class="delimiter">[</span><a title="" id="play.core.actors.WebSocketActor.WebSocketActorSupervisor.props;In">In</a>, <a title="" id="play.core.actors.WebSocketActor.WebSocketActorSupervisor.props;Out">Out</a>: ClassTag<span class="delimiter">]</span><span class="delimiter">(</span><a title="play.api.libs.iteratee.Enumerator[In]" id="play.core.actors.WebSocketActor.WebSocketActorSupervisor.props.enumerator">enumerator</a>: <a href="../../../../play-iteratees/play/api/libs/iteratee/Enumerator.scala.html#play.api.libs.iteratee;Enumerator" title="play.api.libs.iteratee.Enumerator[In]">Enumerator</a><span class="delimiter">[</span>In<span class="delimiter">]</span>, <a title="play.api.libs.iteratee.Iteratee[Out,Unit]" id="play.core.actors.WebSocketActor.WebSocketActorSupervisor.props.iteratee">iteratee</a>: <a href="../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee;Iteratee" title="play.api.libs.iteratee.Iteratee[Out,Unit]">Iteratee</a><span class="delimiter">[</span>Out, Unit<span class="delimiter">]</span>,
      <a title="akka.actor.ActorRef =&gt; akka.actor.Props" id="play.core.actors.WebSocketActor.WebSocketActorSupervisor.props.createHandler">createHandler</a>: ActorRef =&gt; Props<span class="delimiter">)</span> =
      <span title="(creator: =&gt; play.core.actors.WebSocketActor.WebSocketActorSupervisor[In,Out])(implicit evidence$2: scala.reflect.ClassTag[play.core.actors.WebSocketActor.WebSocketActorSupervisor[In,Out]])akka.actor.Props">Props</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[play.core.actors.WebSocketActor.WebSocketActorSupervisor[In,Out]]" class="delimiter">(</span><a href="#play.core.actors.WebSocketActor.WebSocketActorSupervisor.props.evidence$1" title="play.core.actors.WebSocketActor.WebSocketActorSupervisor[In,Out]" class="keyword">new</a> <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="play.core.actors.WebSocketActor.WebSocketActorSupervisor[In,Out]">WebSocketActorSupervisor</a><span class="delimiter">[</span>In, Out<span class="delimiter">]</span><span class="delimiter">(</span><a href="#play.core.actors.WebSocketActor.WebSocketActorSupervisor.props.enumerator" title="play.api.libs.iteratee.Enumerator[In]">enumerator</a>, <a href="#play.core.actors.WebSocketActor.WebSocketActorSupervisor.props.iteratee" title="play.api.libs.iteratee.Iteratee[Out,Unit]">iteratee</a>, <a href="#play.core.actors.WebSocketActor.WebSocketActorSupervisor.props.createHandler" title="akka.actor.ActorRef =&gt; akka.actor.Props">createHandler</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The actor that supervises and handles all messages to/from the WebSocket actor.
   */</span>
  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class WebSocketActorSupervisor[In, Out] extends AnyRef with akka.actor.Actor" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor">WebSocketActorSupervisor</a><span class="delimiter">[</span><a title="" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor;In">In</a>, <a title="" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor;Out">Out</a><span class="delimiter">]</span><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="play.core.actors.WebSocketActor.WebSocketActorSupervisor[In,Out]" class="delimiter">(</a><a title="play.api.libs.iteratee.Enumerator[In]" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.enumerator">enumerator</a>: <a href="../../../../play-iteratees/play/api/libs/iteratee/Enumerator.scala.html#play.api.libs.iteratee;Enumerator" title="play.api.libs.iteratee.Enumerator[In]">Enumerator</a><span class="delimiter">[</span>In<span class="delimiter">]</span>, <a title="play.api.libs.iteratee.Iteratee[Out,Unit]" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.iteratee">iteratee</a>: <a href="../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee;Iteratee" title="play.api.libs.iteratee.Iteratee[Out,Unit]">Iteratee</a><span class="delimiter">[</span>Out, Unit<span class="delimiter">]</span>,
      <a title="akka.actor.ActorRef =&gt; akka.actor.Props" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.createHandler">createHandler</a>: ActorRef =&gt; Props<span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.ClassTag[Out]" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.messageType">messageType</a>: <span title="scala.reflect.ClassTag[Out]">ClassTag</span><span class="delimiter">[</span>Out<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="akka.actor.Actor">Actor</span> <span class="delimiter">{</span>

    <span class="keyword">import</span> <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="=&gt; akka.actor.ActorContext">context</a>.dispatcher

    <span class="comment">/*
     * There are two ways that this actor might shutdown.  One is that the child might send a poison pill.  The other
     * is that the WebSocket might close, which will send a PoisonPill.  The problem is, if the child sends a poison
     * pill, then the WebSocket will close as a result, but there's no way to cancel the callback being invoked when
     * the WebSocket closes.  So that callback will send a PoisonPill, but that PoisonPill will end up in the dead
     * letter queue because the actor will already be stopped.  So, to prevent that second PoisonPill from being sent,
     * we use this flag.
     *
     * There still is of course a race condition - the client might close the WebSocket at the same time as the child
     * actor decides to close, and then two PoisonPills might still be sent - we can't avoid that.  But this just
     * prevents the double PoisonPill from being a normal thing that happens every time a child initiates shutdown.
     */</span>
    @volatile <span class="keyword">var</span> <a title="Boolean" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.shutdown_=">shutdown</a> = <span title="Boolean(false)" class="keyword">false</span>

    <span class="comment">// The actor to handle the WebSocket</span>
    <span class="keyword">val</span> <a title="akka.actor.ActorRef" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.webSocketActor">webSocketActor</a> = <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(subject: akka.actor.ActorRef)akka.actor.ActorRef">watch</span><span class="delimiter">(</span><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(props: akka.actor.Props, name: String)akka.actor.ActorRef">actorOf</span><span class="delimiter">(</span><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.createHandler" title="(v1: akka.actor.ActorRef)akka.actor.Props">createHandler</a><span class="delimiter">(</span><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>, <span title="String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="comment">// Use a broadcast enumerator to imperatively push messages into the WebSocket</span>
    <span class="keyword">val</span> <a title="play.api.libs.iteratee.Concurrent.Channel[Out]" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel">channel</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel.enum" title="(play.api.libs.iteratee.Enumerator[Out], play.api.libs.iteratee.Concurrent.Channel[Out])" class="delimiter">(</a><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel.x$1" title="play.api.libs.iteratee.Enumerator[Out]" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel.enum">enum</a>, <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel.x$1" title="play.api.libs.iteratee.Concurrent.Channel[Out]" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel.chan">chan</a><span class="delimiter">)</span> = <a href="../../../../play-iteratees/play/api/libs/iteratee/Concurrent.scala.html#play.api.libs.iteratee.Concurrent" title="play.api.libs.iteratee.Concurrent.type">Concurrent</a>.<a href="../../../../play-iteratees/play/api/libs/iteratee/Concurrent.scala.html#play.api.libs.iteratee.Concurrent.broadcast(db265a0fc4)" title="[E]=&gt; (play.api.libs.iteratee.Enumerator[E], play.api.libs.iteratee.Concurrent.Channel[E])">broadcast</a><span title="(play.api.libs.iteratee.Enumerator[Out], play.api.libs.iteratee.Concurrent.Channel[Out])" class="delimiter">[</span><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor;Out" title="Out">Out</a><span class="delimiter">]</span>
      <span class="comment">// Ensure we feed EOF into the iteratee when done, to ensure that the WebSocket gets closed</span>
      <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel.enum" title="play.api.libs.iteratee.Enumerator[Out]">enum</a> <a href="../../../../play-iteratees/play/api/libs/iteratee/Enumerator.scala.html#play.api.libs.iteratee;Enumerator.|>>>" title="(i: play.api.libs.iteratee.Iteratee[Out,Unit])scala.concurrent.Future[Unit]">|&gt;&gt;&gt;</a> <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.iteratee" title="play.api.libs.iteratee.Iteratee[Out,Unit]">iteratee</a>
      <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel.chan" title="play.api.libs.iteratee.Concurrent.Channel[Out]">chan</a>
    <span class="delimiter">}</span>

    <span class="comment">// Use a foreach iteratee to consume the WebSocket and feed it into the Actor</span>
    <span class="comment">// It's very important that we use the trampoline execution context here, otherwise it's possible that</span>
    <span class="keyword">val</span> <a title="play.api.libs.iteratee.Iteratee[In,Unit]" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.consumer">consumer</a> = <a href="../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee" title="play.api.libs.iteratee.Iteratee.type">Iteratee</a>.<a href="../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Iteratee.foreach" title="[E](f: E =&gt; Unit)(implicit ec: scala.concurrent.ExecutionContext)play.api.libs.iteratee.Iteratee[E,Unit]">foreach</a><span title="(f: In =&gt; Unit)(implicit ec: scala.concurrent.ExecutionContext)play.api.libs.iteratee.Iteratee[In,Unit]" class="delimiter">[</span><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor;In" title="In">In</a><span class="delimiter">]</span> <span class="delimiter">{</span> <a title="In" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.consumer.$anonfun.msg">msg</a> =&gt;
      <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.webSocketActor" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">webSocketActor</a> <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.consumer.$anonfun.msg" title="In">msg</a>
    <span class="delimiter">}</span><span class="delimiter">(</span>play.api.libs.iteratee.<a href="../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution" title="play.api.libs.iteratee.Execution.type">Execution</a>.<a href="../../../../play-iteratees/play/api/libs/iteratee/Execution.scala.html#play.api.libs.iteratee.Execution.trampoline" title="play.api.libs.iteratee.Execution.trampoline.type">trampoline</a><span class="delimiter">)</span>

    <span class="delimiter">(</span><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.enumerator" title="play.api.libs.iteratee.Enumerator[In]">enumerator</a> <a href="../../../../play-iteratees/play/api/libs/iteratee/Enumerator.scala.html#play.api.libs.iteratee;Enumerator.|>>" title="(i: play.api.libs.iteratee.Iteratee[In,Unit])scala.concurrent.Future[play.api.libs.iteratee.Iteratee[In,Unit]]">|&gt;&gt;</a> <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.consumer" title="=&gt; play.api.libs.iteratee.Iteratee[In,Unit]">consumer</a><span class="delimiter">)</span>.<span title="(func: scala.util.Try[play.api.libs.iteratee.Iteratee[In,Unit]] =&gt; Unit)(implicit executor: scala.concurrent.ExecutionContext)Unit">onComplete</span> <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="=&gt; scala.concurrent.ExecutionContextExecutor" class="delimiter">{</a> <a title="scala.util.Try[play.api.libs.iteratee.Iteratee[In,Unit]]" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.<local WebSocketActorSupervisor>.$anonfun.x$2">_</a> =&gt;
      <span class="comment">// When the WebSocket is complete, either due to an error or not, shutdown</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.shutdown_=" title="=&gt; Boolean">shutdown</a><span class="delimiter">)</span>
        <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.webSocketActor" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">webSocketActor</a> <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <span title="akka.actor.PoisonPill.type">PoisonPill</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="=&gt; PartialFunction[Any,Unit]" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.receive">receive</a> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
      <span class="keyword">case</span> _: <span title="akka.actor.Terminated">Terminated</span> =&gt;
        <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.shutdown_=" title="(x$1: Boolean)Unit">shutdown</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span class="comment">// Child has terminated, close the WebSocket.</span>
        <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel" title="=&gt; play.api.libs.iteratee.Concurrent.Channel[Out]">channel</a>.<a href="../../../../play-iteratees/play/api/libs/iteratee/Concurrent.scala.html#play.api.libs.iteratee.Concurrent;Channel.end(aa97cb1b3d)" title="()Unit">end</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(actor: akka.actor.ActorRef)Unit">stop</span><span class="delimiter">(</span><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
      <span class="comment">// A message of the type that we're handling has been received</span>
      <span class="keyword">case</span> <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.messageType" title="(x: Any)Option[Out]">messageType</a><span class="delimiter">(</span><a title="Out" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.receive;$anonfun.isDefinedAt.a">a</a><span class="delimiter">)</span> =&gt; <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel" title="=&gt; play.api.libs.iteratee.Concurrent.Channel[Out]">channel</a>.<a href="../../../../play-iteratees/play/api/libs/iteratee/Concurrent.scala.html#play.api.libs.iteratee.Concurrent;Channel.push(edc6f720b4)" title="(item: Out)Unit">push</a><span title="Boolean(true)" class="delimiter">(</span><a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.receive;$anonfun.isDefinedAt.a" title="Out">a</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.postStop">postStop</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.shutdown_=" title="(x$1: Boolean)Unit">shutdown</a> = <span title="Boolean(true)" class="keyword">true</span>
      <span class="comment">// In the normal shutdown case, this will already have been called, that's ok, channel.end() is a no-op in that</span>
      <span class="comment">// case.  This does however handle the case where this supervisor crashes, or when it's stopped externally.</span>
      <a href="#play.core.actors.WebSocketActor;WebSocketActorSupervisor.channel" title="=&gt; play.api.libs.iteratee.Concurrent.Channel[Out]">channel</a>.<a href="../../../../play-iteratees/play/api/libs/iteratee/Concurrent.scala.html#play.api.libs.iteratee.Concurrent;Channel.end(aa97cb1b3d)" title="()Unit">end</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; akka.actor.OneForOneStrategy" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.supervisorStrategy">supervisorStrategy</a> = <span title="(maxNrOfRetries: Int, withinTimeRange: scala.concurrent.duration.Duration, loggingEnabled: Boolean)(decider: akka.actor.SupervisorStrategy.Decider)akka.actor.OneForOneStrategy">OneForOneStrategy</span><span class="delimiter">(</span><span class="delimiter">)</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Throwable,akka.actor.SupervisorStrategy.Directive] with Serializable" id="play.core.actors.WebSocketActor;WebSocketActorSupervisor.supervisorStrategy;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
      <span class="keyword">case</span> _ =&gt; <span title="akka.actor.SupervisorStrategy.type">SupervisorStrategy</span>.<span title="akka.actor.SupervisorStrategy.Stop.type">Stop</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="play.core.actors.WebSocketActor.WebSocketsActor.type" id="play.core.actors.WebSocketActor.WebSocketsActor">WebSocketsActor</a> <a href="#play.core.actors.WebSocketActor.WebSocketsActor" title="play.core.actors.WebSocketActor.WebSocketsActor.type" class="delimiter">{</a>

    <span class="keyword">val</span> <a title="akka.actor.Props" id="play.core.actors.WebSocketActor.WebSocketsActor.props">props</a> = <span title="(creator: =&gt; play.core.actors.WebSocketActor.WebSocketsActor)(implicit evidence$2: scala.reflect.ClassTag[play.core.actors.WebSocketActor.WebSocketsActor])akka.actor.Props">Props</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[play.core.actors.WebSocketActor.WebSocketsActor]" class="delimiter">(</span><span title="play.core.actors.WebSocketActor.WebSocketsActor" class="keyword">new</span> <a href="#play.core.actors.WebSocketActor;WebSocketsActor" title="play.core.actors.WebSocketActor.WebSocketsActor">WebSocketsActor</a><span class="delimiter">)</span>

    <span class="comment">/**
     * Connect an actor to the WebSocket on the end of the given enumerator/iteratee.
     *
     * @param requestId The requestId. Used to name the actor.
     * @param enumerator The enumerator to send messages to.
     * @param iteratee The iteratee to consume messages from.
     * @param createHandler A function that creates a handler to handle the WebSocket, given an actor to send messages
     *                      to.
     * @param messageType The type of message this WebSocket deals with.
     */</span>
    <span class="keyword">case class</span> <a href="#play.core.actors.WebSocketActor.WebSocketsActor;Connect.productElement.x$1" title="class Connect[In, Out] extends AnyRef with Product with Serializable" id="play.core.actors.WebSocketActor.WebSocketsActor.Connect.readResolve">Connect</a><span class="delimiter">[</span><a title="" id="play.core.actors.WebSocketActor.WebSocketsActor;Connect;In">In</a>, <a title="" id="play.core.actors.WebSocketActor.WebSocketsActor;Connect;Out">Out</a><span class="delimiter">]</span><a href="#play.core.actors.WebSocketActor.WebSocketsActor.Connect.readResolve" title="Product" class="delimiter">(</a><a title="Long" id="play.core.actors.WebSocketActor.WebSocketsActor;Connect.requestId">requestId</a>: <span title="Long">Long</span>, <a title="play.api.libs.iteratee.Enumerator[In]" id="play.core.actors.WebSocketActor.WebSocketsActor;Connect.enumerator">enumerator</a>: <a href="../../../../play-iteratees/play/api/libs/iteratee/Enumerator.scala.html#play.api.libs.iteratee;Enumerator" title="play.api.libs.iteratee.Enumerator[In]">Enumerator</a><span class="delimiter">[</span>In<span class="delimiter">]</span>, <a title="play.api.libs.iteratee.Iteratee[Out,Unit]" id="play.core.actors.WebSocketActor.WebSocketsActor;Connect.iteratee">iteratee</a>: <a href="../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee;Iteratee" title="play.api.libs.iteratee.Iteratee[Out,Unit]">Iteratee</a><span class="delimiter">[</span>Out, Unit<span class="delimiter">]</span>,
      <a title="akka.actor.ActorRef =&gt; akka.actor.Props" id="play.core.actors.WebSocketActor.WebSocketsActor;Connect.createHandler">createHandler</a>: ActorRef =&gt; Props<span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <span class="keyword">val</span> <a title="scala.reflect.ClassTag[Out]" id="play.core.actors.WebSocketActor.WebSocketsActor;Connect.messageType">messageType</a>: <span title="scala.reflect.ClassTag[Out]">ClassTag</span><span class="delimiter">[</span>Out<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The actor responsible for creating all web sockets
   */</span>
  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class WebSocketsActor extends AnyRef with akka.actor.Actor" id="play.core.actors.WebSocketActor;WebSocketsActor">WebSocketsActor</a> <a href="#play.core.actors.WebSocketActor;WebSocketsActor" title="play.core.actors.WebSocketActor.WebSocketsActor" class="keyword">extends</a> <span title="akka.actor.Actor">Actor</span> <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#play.core.actors.WebSocketActor.WebSocketsActor" title="play.core.actors.WebSocketActor.WebSocketsActor.type">WebSocketsActor</a>._

    <span class="keyword">def</span> <a title="=&gt; PartialFunction[Any,Unit]" id="play.core.actors.WebSocketActor;WebSocketsActor.receive">receive</a> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
      <span class="keyword">case</span> <a title="play.core.actors.WebSocketActor.WebSocketsActor.Connect[Any,Any]" id="play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.c">c</a> @ Connect<span class="delimiter">(</span><a title="Long" id="play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.requestId">requestId</a>, <a title="play.api.libs.iteratee.Enumerator[Any]" id="play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.enumerator">enumerator</a>, <a title="play.api.libs.iteratee.Iteratee[Any,Unit]" id="play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.iteratee">iteratee</a>, <a title="akka.actor.ActorRef =&gt; akka.actor.Props" id="play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.createHandler">createHandler</a><span class="delimiter">)</span> =&gt;
        <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="scala.reflect.ClassTag[Any]" id="play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.applyOrElse.mt">mt</a> = <a href="#play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.c" title="play.core.actors.WebSocketActor.WebSocketsActor.Connect[Any,Any]">c</a>.<a href="#play.core.actors.WebSocketActor.WebSocketsActor;Connect.messageType" title="=&gt; scala.reflect.ClassTag[Any]">messageType</a>
        <a href="#play.core.actors.WebSocketActor;WebSocketsActor" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(props: akka.actor.Props, name: String)akka.actor.ActorRef">actorOf</span><span title="Unit" class="delimiter">(</span><a href="#play.core.actors.WebSocketActor.WebSocketActorSupervisor" title="play.core.actors.WebSocketActor.WebSocketActorSupervisor.type">WebSocketActorSupervisor</a>.<a href="#play.core.actors.WebSocketActor.WebSocketActorSupervisor.props" title="(enumerator: play.api.libs.iteratee.Enumerator[Any], iteratee: play.api.libs.iteratee.Iteratee[Any,Unit], createHandler: akka.actor.ActorRef =&gt; akka.actor.Props)(implicit evidence$1: scala.reflect.ClassTag[Any])akka.actor.Props">props</a><a href="#play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.applyOrElse.mt" title="scala.reflect.ClassTag[Any]" class="delimiter">(</a><a href="#play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.enumerator" title="play.api.libs.iteratee.Enumerator[Any]">enumerator</a>, <a href="#play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.iteratee" title="play.api.libs.iteratee.Iteratee[Any,Unit]">iteratee</a>, <a href="#play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.createHandler" title="akka.actor.ActorRef =&gt; akka.actor.Props">createHandler</a><span class="delimiter">)</span>,
          <a href="#play.core.actors.WebSocketActor;WebSocketsActor.receive;$anonfun.isDefinedAt.requestId" title="Long">requestId</a>.<span title="()String">toString</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The extension for managing WebSockets
   */</span>
  <span class="keyword">object</span> <a title="play.core.actors.WebSocketActor.WebSocketsExtension.type" id="play.core.actors.WebSocketActor.WebSocketsExtension">WebSocketsExtension</a> <a href="#play.core.actors.WebSocketActor.WebSocketsExtension" title="play.core.actors.WebSocketActor.WebSocketsExtension.type" class="keyword">extends</a> <span title="akka.actor.ExtensionId[play.core.actors.WebSocketActor.WebSocketsExtension]">ExtensionId</span><span class="delimiter">[</span>WebSocketsExtension<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(system: akka.actor.ExtendedActorSystem)play.core.actors.WebSocketActor.WebSocketsExtension" id="play.core.actors.WebSocketActor.WebSocketsExtension.createExtension">createExtension</a><span class="delimiter">(</span><a title="akka.actor.ExtendedActorSystem" id="play.core.actors.WebSocketActor.WebSocketsExtension.createExtension.system">system</a>: <span title="akka.actor.ExtendedActorSystem">ExtendedActorSystem</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="play.core.actors.WebSocketActor.WebSocketsExtension" class="keyword">new</span> <a href="#play.core.actors.WebSocketActor;WebSocketsExtension" title="play.core.actors.WebSocketActor.WebSocketsExtension">WebSocketsExtension</a><span class="delimiter">(</span><a href="#play.core.actors.WebSocketActor.WebSocketsExtension.createExtension.system" title="akka.actor.ExtendedActorSystem">system</a>.<span title="(props: akka.actor.Props, name: String)akka.actor.ActorRef">systemActorOf</span><span class="delimiter">(</span><a href="#play.core.actors.WebSocketActor.WebSocketsActor" title="play.core.actors.WebSocketActor.WebSocketsActor.type">WebSocketsActor</a>.<a href="#play.core.actors.WebSocketActor.WebSocketsActor.props" title="=&gt; akka.actor.Props">props</a>, <span title="String(&quot;websockets&quot;)" class="string">&quot;websockets&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class WebSocketsExtension extends AnyRef with akka.actor.Extension" id="play.core.actors.WebSocketActor;WebSocketsExtension">WebSocketsExtension</a><a href="#play.core.actors.WebSocketActor;WebSocketsExtension" title="play.core.actors.WebSocketActor.WebSocketsExtension" class="delimiter">(</a><span class="keyword">val</span> <a title="akka.actor.ActorRef" id="play.core.actors.WebSocketActor;WebSocketsExtension.actor">actor</a>: <span title="akka.actor.ActorRef">ActorRef</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="akka.actor.Extension">Extension</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

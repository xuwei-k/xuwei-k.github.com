<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play/play/core/server/websocket/Frame.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2013 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.core.server.websocket

<span class="keyword">import</span> org.jboss.netty.handler.codec.http.websocketx.<span class="delimiter">{</span> WebSocketFrame, TextWebSocketFrame, BinaryWebSocketFrame <span class="delimiter">}</span>
<span class="keyword">import</span> play.api.libs.iteratee.<a href="../../../../../play-iteratees/play/api/libs/iteratee/Iteratee.scala.html#play.api.libs.iteratee.Input" title="play.api.libs.iteratee.Input.type">Input</a>.El
<span class="keyword">import</span> org.jboss.netty.buffer.ChannelBuffer

<span class="keyword">case class</span> <a href="#play.core.server.websocket;FrameFormatter.productElement.x$1" title="class FrameFormatter[A] extends AnyRef with play.api.mvc.WebSocket.FrameFormatter[A] with Product with Serializable" id="play.core.server.websocket.FrameFormatter.readResolve">FrameFormatter</a><span class="delimiter">[</span><a title="" id="play.core.server.websocket;FrameFormatter;A">A</a><span class="delimiter">]</span><a href="#play.core.server.websocket.FrameFormatter.readResolve" title="Product" class="delimiter">(</a><a title="A =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame" id="play.core.server.websocket;FrameFormatter.toFrame">toFrame</a>: A =&gt; WebSocketFrame, <a title="PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,A]" id="play.core.server.websocket;FrameFormatter.fromFrame">fromFrame</a>: <span title="PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,A]">PartialFunction</span><span class="delimiter">[</span>WebSocketFrame, A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> play.api.mvc.WebSocket.<a href="../../../api/mvc/WebSocket.scala.html#play.api.mvc.WebSocket;FrameFormatter" title="play.api.mvc.WebSocket.FrameFormatter[A]">FrameFormatter</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[B](fba: B =&gt; A, fab: A =&gt; B)play.core.server.websocket.FrameFormatter[B]" id="play.core.server.websocket;FrameFormatter.transform">transform</a><span class="delimiter">[</span><a title="" id="play.core.server.websocket;FrameFormatter.transform;B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B =&gt; A" id="play.core.server.websocket;FrameFormatter.transform.fba">fba</a>: B =&gt; A, <a title="A =&gt; B" id="play.core.server.websocket;FrameFormatter.transform.fab">fab</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#play.core.server.websocket.FrameFormatter.readResolve" title="play.core.server.websocket.FrameFormatter[B]">FrameFormatter</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#play.core.server.websocket.FrameFormatter.readResolve" title="[A](toFrame: A =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame, fromFrame: PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,A])play.core.server.websocket.FrameFormatter[A]">FrameFormatter</a><span title="(toFrame: B =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame, fromFrame: PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,B])play.core.server.websocket.FrameFormatter[B]" class="delimiter">[</span><a href="#play.core.server.websocket;FrameFormatter.transform;B" title="B">B</a><span class="delimiter">]</span><span class="delimiter">(</span>
      <a href="#play.core.server.websocket;FrameFormatter.toFrame" title="=&gt; A =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame">toFrame</a>.<span title="(g: B =&gt; A)B =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame">compose</span><span class="delimiter">(</span><a href="#play.core.server.websocket;FrameFormatter.transform.fba" title="B =&gt; A">fba</a><span class="delimiter">)</span>,
      <a href="#play.core.server.websocket;FrameFormatter.fromFrame" title="=&gt; PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,A]">fromFrame</a>.<span title="(k: A =&gt; B)PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,B]">andThen</span><span class="delimiter">(</span><a href="#play.core.server.websocket;FrameFormatter.transform.fab" title="A =&gt; B">fab</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="play.core.server.websocket.Frames.type" id="play.core.server.websocket.Frames">Frames</a> <a href="#play.core.server.websocket.Frames" title="play.core.server.websocket.Frames.type" class="delimiter">{</a>

  <span class="keyword">val</span> <a title="play.core.server.websocket.FrameFormatter[String]" id="play.core.server.websocket.Frames.textFrame">textFrame</a> = <a href="#play.core.server.websocket.FrameFormatter.readResolve" title="[A](toFrame: A =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame, fromFrame: PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,A])play.core.server.websocket.FrameFormatter[A]">FrameFormatter</a><span title="(toFrame: String =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame, fromFrame: PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,String])play.core.server.websocket.FrameFormatter[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><span class="delimiter">(</span>
    <a title="String" id="play.core.server.websocket.Frames.textFrame.$anonfun.str">str</a> =&gt; <span title="(x$1: Boolean, x$2: Int, x$3: String)org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame">TextWebSocketFrame</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="Int(0)" class="int">0</span>, <a href="#play.core.server.websocket.Frames.textFrame.$anonfun.str" title="String">str</a><span class="delimiter">)</span>,
    <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,String] with Serializable" id="play.core.server.websocket.Frames.textFrame;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
      <span class="keyword">case</span> <a title="org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame" id="play.core.server.websocket.Frames.textFrame;$anonfun.isDefinedAt.frame">frame</a>: <span title="org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame">TextWebSocketFrame</span> =&gt; <a href="#play.core.server.websocket.Frames.textFrame;$anonfun.isDefinedAt.frame" title="org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame">frame</a>.<span title="()String">getText</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="play.core.server.websocket.FrameFormatter[Array[Byte]]" id="play.core.server.websocket.Frames.binaryFrame">binaryFrame</a> = <a href="#play.core.server.websocket.FrameFormatter.readResolve" title="[A](toFrame: A =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame, fromFrame: PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,A])play.core.server.websocket.FrameFormatter[A]">FrameFormatter</a><span title="(toFrame: Array[Byte] =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame, fromFrame: PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,Array[Byte]])play.core.server.websocket.FrameFormatter[Array[Byte]]" class="delimiter">[</span><span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span>
    <a title="Array[Byte]" id="play.core.server.websocket.Frames.binaryFrame.$anonfun.bytes">bytes</a> =&gt; <span title="(x$1: Boolean, x$2: Int, x$3: org.jboss.netty.buffer.ChannelBuffer)org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame">BinaryWebSocketFrame</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="Int(0)" class="int">0</span>, org.jboss.netty.buffer.<span title="org.jboss.netty.buffer.ChannelBuffers.type">ChannelBuffers</span>.<span title="(x$1: Array[Byte])org.jboss.netty.buffer.ChannelBuffer">wrappedBuffer</span><span class="delimiter">(</span><a href="#play.core.server.websocket.Frames.binaryFrame.$anonfun.bytes" title="Array[Byte]">bytes</a><span class="delimiter">)</span><span class="delimiter">)</span>,
    <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,Array[Byte]] with Serializable" id="play.core.server.websocket.Frames.binaryFrame;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
      <span class="keyword">case</span> <a title="org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame" id="play.core.server.websocket.Frames.binaryFrame;$anonfun.isDefinedAt.frame">frame</a>: <span title="org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame">BinaryWebSocketFrame</span> =&gt; <a href="#play.core.server.websocket.Frames.channelBufferToArray" title="(buffer: org.jboss.netty.buffer.ChannelBuffer)Array[Byte]">channelBufferToArray</a><span title="Boolean(true)" class="delimiter">(</span><a href="#play.core.server.websocket.Frames.binaryFrame;$anonfun.isDefinedAt.frame" title="org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame">frame</a>.<span title="()org.jboss.netty.buffer.ChannelBuffer">getBinaryData</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="play.core.server.websocket.FrameFormatter[Either[String,Array[Byte]]]" id="play.core.server.websocket.Frames.mixedFrame">mixedFrame</a> = <a href="#play.core.server.websocket.FrameFormatter.readResolve" title="[A](toFrame: A =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame, fromFrame: PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,A])play.core.server.websocket.FrameFormatter[A]">FrameFormatter</a><span title="(toFrame: Either[String,Array[Byte]] =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame, fromFrame: PartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,Either[String,Array[Byte]]])play.core.server.websocket.FrameFormatter[Either[String,Array[Byte]]]" class="delimiter">[</span><span title="Either[String,Array[Byte]]">Either</span><span class="delimiter">[</span>String, Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span>
    <a title="Either[String,Array[Byte]]" id="play.core.server.websocket.Frames.mixedFrame.$anonfun.stringOrBytes">stringOrBytes</a> =&gt; <span class="delimiter">{</span>
      <a href="#play.core.server.websocket.Frames.mixedFrame.$anonfun.stringOrBytes" title="Either[String,Array[Byte]]">stringOrBytes</a>.<span title="(fa: String =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame, fb: Array[Byte] =&gt; org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame)org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame">fold</span><span class="delimiter">(</span>
        <a title="String" id="play.core.server.websocket.Frames.mixedFrame.$anonfun.$anonfun.str">str</a> =&gt; <span title="(x$1: Boolean, x$2: Int, x$3: String)org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame">TextWebSocketFrame</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="Int(0)" class="int">0</span>, <a href="#play.core.server.websocket.Frames.mixedFrame.$anonfun.$anonfun.str" title="String">str</a><span class="delimiter">)</span>,
        <a title="Array[Byte]" id="play.core.server.websocket.Frames.mixedFrame.$anonfun.$anonfun.bytes">bytes</a> =&gt; <span title="(x$1: Boolean, x$2: Int, x$3: org.jboss.netty.buffer.ChannelBuffer)org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame" class="keyword">new</span> <span title="org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame">BinaryWebSocketFrame</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="Int(0)" class="int">0</span>, org.jboss.netty.buffer.<span title="org.jboss.netty.buffer.ChannelBuffers.type">ChannelBuffers</span>.<span title="(x$1: Array[Byte])org.jboss.netty.buffer.ChannelBuffer">wrappedBuffer</span><span class="delimiter">(</span><a href="#play.core.server.websocket.Frames.mixedFrame.$anonfun.$anonfun.bytes" title="Array[Byte]">bytes</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">)</span>
    <span class="delimiter">}</span>,
    <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[org.jboss.netty.handler.codec.http.websocketx.WebSocketFrame,Either[String,Array[Byte]]] with Serializable" id="play.core.server.websocket.Frames.mixedFrame;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame">frame</span>: <span title="org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame">TextWebSocketFrame</span> =&gt; <span title="(a: String)scala.util.Left[String,Nothing]">Left</span><span title="Boolean(true)" class="delimiter">(</span><span title="org.jboss.netty.handler.codec.http.websocketx.TextWebSocketFrame">frame</span>.<span title="()String">getText</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame">frame</span>: <span title="org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame">BinaryWebSocketFrame</span> =&gt; <span title="(b: Array[Byte])scala.util.Right[Nothing,Array[Byte]]">Right</span><span title="Boolean(true)" class="delimiter">(</span><a href="#play.core.server.websocket.Frames.channelBufferToArray" title="(buffer: org.jboss.netty.buffer.ChannelBuffer)Array[Byte]">channelBufferToArray</a><span class="delimiter">(</span><span title="org.jboss.netty.handler.codec.http.websocketx.BinaryWebSocketFrame">frame</span>.<span title="()org.jboss.netty.buffer.ChannelBuffer">getBinaryData</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(buffer: org.jboss.netty.buffer.ChannelBuffer)Array[Byte]" id="play.core.server.websocket.Frames.channelBufferToArray">channelBufferToArray</a><span class="delimiter">(</span><a title="org.jboss.netty.buffer.ChannelBuffer" id="play.core.server.websocket.Frames.channelBufferToArray.buffer">buffer</a>: <span title="org.jboss.netty.buffer.ChannelBuffer">ChannelBuffer</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="Array[Byte]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.core.server.websocket.Frames.channelBufferToArray.buffer" title="org.jboss.netty.buffer.ChannelBuffer">buffer</a>.<span title="()Int">readableBytes</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">==</span> <a href="#play.core.server.websocket.Frames.channelBufferToArray.buffer" title="org.jboss.netty.buffer.ChannelBuffer">buffer</a>.<span title="()Int">capacity</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">// Use entire backing array</span>
      <a href="#play.core.server.websocket.Frames.channelBufferToArray.buffer" title="org.jboss.netty.buffer.ChannelBuffer">buffer</a>.<span title="()Array[Byte]">array</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="comment">// Copy relevant bytes only</span>
      <span class="keyword">val</span> <a title="Array[Byte]" id="play.core.server.websocket.Frames.channelBufferToArray.bytes">bytes</a> = <span title="Array[Byte]" class="keyword">new</span> <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><a href="#play.core.server.websocket.Frames.channelBufferToArray.buffer" title="org.jboss.netty.buffer.ChannelBuffer">buffer</a>.<span title="()Int">readableBytes</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#play.core.server.websocket.Frames.channelBufferToArray.buffer" title="org.jboss.netty.buffer.ChannelBuffer">buffer</a>.<span title="(x$1: Array[Byte])Unit">readBytes</span><span class="delimiter">(</span><a href="#play.core.server.websocket.Frames.channelBufferToArray.bytes" title="Array[Byte]">bytes</a><span class="delimiter">)</span>
      <a href="#play.core.server.websocket.Frames.channelBufferToArray.bytes" title="Array[Byte]">bytes</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>


        </pre>
    </body>
</html>

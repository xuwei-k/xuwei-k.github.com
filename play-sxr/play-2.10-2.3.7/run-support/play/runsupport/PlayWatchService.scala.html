<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>run-support/play/runsupport/PlayWatchService.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
<span class="keyword">package</span> play.runsupport

<span class="keyword">import</span> java.net.URLClassLoader
<span class="keyword">import</span> java.util.Locale

<span class="keyword">import</span> sbt._

<span class="keyword">import</span> scala.reflect.ClassTag
<span class="keyword">import</span> scala.util.<span class="delimiter">{</span> Properties, Try <span class="delimiter">}</span>
<span class="keyword">import</span> scala.util.control.NonFatal
<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> <span title="sbt.Path.type">Path</span>._

<span class="comment">/**
 * A service that can watch files
 */</span>
<span class="keyword">trait</span> <a title="trait PlayWatchService extends AnyRef" id="play.runsupport;PlayWatchService">PlayWatchService</a> <span class="delimiter">{</span>
  <span class="comment">/**
   * Watch the given sequence of files or directories.
   *
   * @param filesToWatch The files to watch.
   * @param onChange A callback that is executed whenever something changes.
   * @return A watcher
   */</span>
  <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.PlayWatcher" id="play.runsupport;PlayWatchService.watch">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;PlayWatchService.watch.filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport;PlayWatchService.watch.onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span>: <a href="#play.runsupport;PlayWatcher" title="play.runsupport.PlayWatcher">PlayWatcher</a>
<span class="delimiter">}</span>

<span class="comment">/**
 * A watcher, that watches files.
 */</span>
<span title="AnyRef" class="keyword">trait</span> <a title="trait PlayWatcher extends AnyRef" id="play.runsupport;PlayWatcher">PlayWatcher</a> <span class="delimiter">{</span>

  <span class="comment">/**
   * Stop watching the files.
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;PlayWatcher.stop">stop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">object</span> <a title="play.runsupport.PlayWatchService.type" id="play.runsupport.PlayWatchService">PlayWatchService</a> <a href="#play.runsupport.PlayWatchService" title="play.runsupport.PlayWatchService.type" class="delimiter">{</a>
  <span class="keyword">private</span> <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait OS extends AnyRef" id="play.runsupport.PlayWatchService;OS">OS</a>
  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#play.runsupport.PlayWatchService.Windows.productElement.x$1" title="play.runsupport.PlayWatchService.Windows.type" id="play.runsupport.PlayWatchService.Windows.readResolve">Windows</a> <span title="Product" class="keyword">extends</span> <a href="#play.runsupport.PlayWatchService;OS" title="play.runsupport.PlayWatchService.OS">OS</a>
  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#play.runsupport.PlayWatchService.Linux.productElement.x$1" title="play.runsupport.PlayWatchService.Linux.type" id="play.runsupport.PlayWatchService.Linux.readResolve">Linux</a> <span title="Product" class="keyword">extends</span> <a href="#play.runsupport.PlayWatchService;OS" title="play.runsupport.PlayWatchService.OS">OS</a>
  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#play.runsupport.PlayWatchService.OSX.productElement.x$1" title="play.runsupport.PlayWatchService.OSX.type" id="play.runsupport.PlayWatchService.OSX.readResolve">OSX</a> <span title="Product" class="keyword">extends</span> <a href="#play.runsupport.PlayWatchService;OS" title="play.runsupport.PlayWatchService.OS">OS</a>
  <span class="keyword">private</span> <span class="keyword">case object</span> <a href="#play.runsupport.PlayWatchService.Other.productElement.x$1" title="play.runsupport.PlayWatchService.Other.type" id="play.runsupport.PlayWatchService.Other.readResolve">Other</a> <span title="Product" class="keyword">extends</span> <a href="#play.runsupport.PlayWatchService;OS" title="play.runsupport.PlayWatchService.OS">OS</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="play.runsupport.PlayWatchService.OS" id="play.runsupport.PlayWatchService.os">os</a>: <a href="#play.runsupport.PlayWatchService;OS" title="play.runsupport.PlayWatchService.OS">OS</a> = <span class="delimiter">{</span>
    sys.<span title="=&gt; scala.sys.SystemProperties">props</span>.<span title="(key: String)Option[String]">get</span><span class="delimiter">(</span><span title="String(&quot;os.name&quot;)" class="string">&quot;os.name&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Product with Serializable with play.runsupport.PlayWatchService.OS)Option[Product with Serializable with play.runsupport.PlayWatchService.OS]">map</span> <span class="delimiter">{</span> <a title="String" id="play.runsupport.PlayWatchService.os.$anonfun.name">name</a> =&gt;
      <a href="#play.runsupport.PlayWatchService.os.$anonfun.name" title="String">name</a>.<span title="(x$1: java.util.Locale)String">toLowerCase</span><span class="delimiter">(</span><span title="java.util.Locale.type">Locale</span>.<span title="java.util.Locale">ENGLISH</span><span class="delimiter">)</span> <span title="PlayWatchService extends Product with Serializable with play.runsupport.PlayWatchService.OS" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="String" id="play.runsupport.PlayWatchService.os.$anonfun.osx">osx</a> <span class="keyword">if</span> <a href="#play.runsupport.PlayWatchService.os.$anonfun.osx" title="String">osx</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;darwin&quot;)" class="string">&quot;darwin&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#play.runsupport.PlayWatchService.os.$anonfun.osx" title="String">osx</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;mac&quot;)" class="string">&quot;mac&quot;</span><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.PlayWatchService.OSX.readResolve" title="play.runsupport.PlayWatchService.OSX.type">OSX</a>
        <span class="keyword">case</span> <a title="String" id="play.runsupport.PlayWatchService.os.$anonfun.windows">windows</a> <span class="keyword">if</span> <a href="#play.runsupport.PlayWatchService.os.$anonfun.windows" title="String">windows</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;windows&quot;)" class="string">&quot;windows&quot;</span><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.PlayWatchService.Windows.readResolve" title="play.runsupport.PlayWatchService.Windows.type">Windows</a>
        <span class="keyword">case</span> <a title="String" id="play.runsupport.PlayWatchService.os.$anonfun.linux">linux</a> <span class="keyword">if</span> <a href="#play.runsupport.PlayWatchService.os.$anonfun.linux" title="String">linux</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;linux&quot;)" class="string">&quot;linux&quot;</span><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.PlayWatchService.Linux.readResolve" title="play.runsupport.PlayWatchService.Linux.type">Linux</a>
        <span class="keyword">case</span> _ =&gt; <a href="#play.runsupport.PlayWatchService.Other.readResolve" title="play.runsupport.PlayWatchService.Other.type">Other</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>.<span title="(default: =&gt; Product with Serializable with play.runsupport.PlayWatchService.OS)Product with Serializable with play.runsupport.PlayWatchService.OS">getOrElse</span><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.Other.readResolve" title="play.runsupport.PlayWatchService.Other.type">Other</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(targetDirectory: java.io.File, pollDelayMillis: Int, logger: play.runsupport.LoggerProxy)play.runsupport.PlayWatchService" id="play.runsupport.PlayWatchService.default">default</a><span class="delimiter">(</span><a title="java.io.File" id="play.runsupport.PlayWatchService.default.targetDirectory">targetDirectory</a>: <span title="java.io.File">File</span>, <a title="Int" id="play.runsupport.PlayWatchService.default.pollDelayMillis">pollDelayMillis</a>: <span title="Int">Int</span>, <a title="play.runsupport.LoggerProxy" id="play.runsupport.PlayWatchService.default.logger">logger</a>: <a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy" title="play.runsupport.LoggerProxy">LoggerProxy</a><span class="delimiter">)</span>: <a href="#play.runsupport;PlayWatchService" title="play.runsupport.PlayWatchService">PlayWatchService</a> = <a href="#play.runsupport.PlayWatchService.default;$anon" title="play.runsupport.PlayWatchService{}" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.runsupport.PlayWatchService" id="play.runsupport.PlayWatchService.default;$anon">PlayWatchService</a> <span class="delimiter">{</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.runsupport.PlayWatchService" id="play.runsupport.PlayWatchService.default;$anon.delegate">delegate</a> = <a href="#play.runsupport.PlayWatchService.os" title="=&gt; play.runsupport.PlayWatchService.OS">os</a> <span title="play.runsupport.PlayWatchService" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="comment">// If Windows or Linux and JDK7, use JDK7 watch service</span>
      <span class="keyword">case</span> <span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.Windows.readResolve" title="play.runsupport.PlayWatchService.Windows.type">Windows</a> | <a href="#play.runsupport.PlayWatchService.Linux.readResolve" title="play.runsupport.PlayWatchService.Linux.type">Linux</a><span class="delimiter">)</span> <span class="keyword">if</span> <span title="scala.util.Properties.type">Properties</span>.<span title="(version: String)Boolean">isJavaAtLeast</span><span class="delimiter">(</span><span title="String(&quot;1.7&quot;)" class="string">&quot;1.7&quot;</span><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.JDK7PlayWatchService.apply" title="(logger: play.runsupport.LoggerProxy)scala.util.Try[play.runsupport.PlayWatchService]">JDK7PlayWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.default.logger" title="play.runsupport.LoggerProxy">logger</a><span class="delimiter">)</span>.<span title="=&gt; play.runsupport.PlayWatchService">get</span>
      <span class="comment">// If Windows, Linux or OSX, use JNotify but fall back to SBT</span>
      <span class="keyword">case</span> <span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.Windows.readResolve" title="play.runsupport.PlayWatchService.Windows.type">Windows</a> | <a href="#play.runsupport.PlayWatchService.Linux.readResolve" title="play.runsupport.PlayWatchService.Linux.type">Linux</a> | <a href="#play.runsupport.PlayWatchService.OSX.readResolve" title="play.runsupport.PlayWatchService.OSX.type">OSX</a><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.JNotifyPlayWatchService.apply" title="(targetDirectory: java.io.File)scala.util.Try[play.runsupport.PlayWatchService]">JNotifyPlayWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.default.targetDirectory" title="java.io.File">targetDirectory</a><span class="delimiter">)</span>.<span title="(f: PartialFunction[Throwable,play.runsupport.PlayWatchService])scala.util.Try[play.runsupport.PlayWatchService]">recover</span> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Throwable,play.runsupport.SbtPlayWatchService] with Serializable" id="play.runsupport.PlayWatchService.default;$anon.delegate;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
        <span class="keyword">case</span> <a title="Throwable" id="play.runsupport.PlayWatchService.default;$anon.delegate;$anonfun.isDefinedAt.e">e</a> =&gt;
          <a href="#play.runsupport.PlayWatchService.default.logger" title="play.runsupport.LoggerProxy">logger</a>.<a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy.warn" title="(message: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="String(&quot;Error loading JNotify watch service: &quot;)" class="string">&quot;Error loading JNotify watch service: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.runsupport.PlayWatchService.default;$anon.delegate;$anonfun.isDefinedAt.e" title="Throwable">e</a>.<span title="()String">getMessage</span><span class="delimiter">)</span>
          <a href="#play.runsupport.PlayWatchService.default.logger" title="play.runsupport.LoggerProxy">logger</a>.<a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy.trace" title="(t: =&gt; Throwable)Unit">trace</a><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.default;$anon.delegate;$anonfun.isDefinedAt.e" title="Throwable">e</a><span class="delimiter">)</span>
          <span title="play.runsupport.SbtPlayWatchService" class="keyword">new</span> <a href="#play.runsupport;SbtPlayWatchService" title="play.runsupport.SbtPlayWatchService">SbtPlayWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.default.pollDelayMillis" title="Int">pollDelayMillis</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>.<span title="=&gt; play.runsupport.PlayWatchService">get</span>
      <span class="keyword">case</span> _ =&gt; <span title="play.runsupport.SbtPlayWatchService" class="keyword">new</span> <a href="#play.runsupport;SbtPlayWatchService" title="play.runsupport.SbtPlayWatchService">SbtPlayWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.default.pollDelayMillis" title="Int">pollDelayMillis</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.PlayWatcher" id="play.runsupport.PlayWatchService.default;$anon.watch">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport.PlayWatchService.default;$anon.watch.filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport.PlayWatchService.default;$anon.watch.onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <a href="#play.runsupport.PlayWatchService.default;$anon.delegate" title="=&gt; play.runsupport.PlayWatchService">delegate</a>.<a href="#play.runsupport;PlayWatchService.watch" title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.PlayWatcher">watch</a><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.default;$anon.watch.filesToWatch" title="Seq[java.io.File]">filesToWatch</a>, <a href="#play.runsupport.PlayWatchService.default;$anon.watch.onChange" title="() =&gt; Unit">onChange</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(targetDirectory: java.io.File)play.runsupport.PlayWatchService" id="play.runsupport.PlayWatchService.jnotify">jnotify</a><span class="delimiter">(</span><a title="java.io.File" id="play.runsupport.PlayWatchService.jnotify.targetDirectory">targetDirectory</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <a href="#play.runsupport;PlayWatchService" title="play.runsupport.PlayWatchService">PlayWatchService</a> = <a href="#play.runsupport.PlayWatchService.optional" title="(watchService: scala.util.Try[play.runsupport.PlayWatchService])play.runsupport.PlayWatchService">optional</a><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply" title="(targetDirectory: java.io.File)scala.util.Try[play.runsupport.PlayWatchService]">JNotifyPlayWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.jnotify.targetDirectory" title="java.io.File">targetDirectory</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(logger: play.runsupport.LoggerProxy)play.runsupport.PlayWatchService" id="play.runsupport.PlayWatchService.jdk7">jdk7</a><span class="delimiter">(</span><a title="play.runsupport.LoggerProxy" id="play.runsupport.PlayWatchService.jdk7.logger">logger</a>: <a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy" title="play.runsupport.LoggerProxy">LoggerProxy</a><span class="delimiter">)</span>: <a href="#play.runsupport;PlayWatchService" title="play.runsupport.PlayWatchService">PlayWatchService</a> = <a href="#play.runsupport.PlayWatchService.optional" title="(watchService: scala.util.Try[play.runsupport.PlayWatchService])play.runsupport.PlayWatchService">optional</a><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService.apply" title="(logger: play.runsupport.LoggerProxy)scala.util.Try[play.runsupport.PlayWatchService]">JDK7PlayWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.jdk7.logger" title="play.runsupport.LoggerProxy">logger</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(pollDelayMillis: Int)play.runsupport.PlayWatchService" id="play.runsupport.PlayWatchService.sbt">sbt</a><span class="delimiter">(</span><a title="Int" id="play.runsupport.PlayWatchService.sbt.pollDelayMillis">pollDelayMillis</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#play.runsupport;PlayWatchService" title="play.runsupport.PlayWatchService">PlayWatchService</a> = <span title="play.runsupport.SbtPlayWatchService" class="keyword">new</span> <a href="#play.runsupport;SbtPlayWatchService" title="play.runsupport.SbtPlayWatchService">SbtPlayWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.sbt.pollDelayMillis" title="Int">pollDelayMillis</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(watchService: scala.util.Try[play.runsupport.PlayWatchService])play.runsupport.PlayWatchService" id="play.runsupport.PlayWatchService.optional">optional</a><span class="delimiter">(</span><a title="scala.util.Try[play.runsupport.PlayWatchService]" id="play.runsupport.PlayWatchService.optional.watchService">watchService</a>: <span title="scala.util.Try[play.runsupport.PlayWatchService]">Try</span><span class="delimiter">[</span>PlayWatchService<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#play.runsupport;PlayWatchService" title="play.runsupport.PlayWatchService">PlayWatchService</a> = <span title="play.runsupport.OptionalPlayWatchServiceDelegate" class="keyword">new</span> <a href="#play.runsupport;OptionalPlayWatchServiceDelegate" title="play.runsupport.OptionalPlayWatchServiceDelegate">OptionalPlayWatchServiceDelegate</a><span class="delimiter">(</span><a href="#play.runsupport.PlayWatchService.optional.watchService" title="scala.util.Try[play.runsupport.PlayWatchService]">watchService</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * A polling Play watch service.  Polls in the background.
 */</span>
<span title="AnyRef" class="keyword">private</span> <span class="keyword">class</span> <a title="class SbtPlayWatchService extends AnyRef with play.runsupport.PlayWatchService" id="play.runsupport;SbtPlayWatchService">SbtPlayWatchService</a><a href="#play.runsupport;SbtPlayWatchService" title="play.runsupport.SbtPlayWatchService" class="delimiter">(</a><a title="Int" id="play.runsupport;SbtPlayWatchService.pollDelayMillis">pollDelayMillis</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.runsupport;PlayWatchService" title="play.runsupport.PlayWatchService">PlayWatchService</a> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.PlayWatcher" id="play.runsupport;SbtPlayWatchService.watch">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;SbtPlayWatchService.watch.filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport;SbtPlayWatchService.watch.onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <span class="delimiter">{</span>

    @volatile <span class="keyword">var</span> <a title="Boolean" id="play.runsupport;SbtPlayWatchService.watch.stopped">stopped</a> = <span title="Boolean(false)" class="keyword">false</span>

    <span class="keyword">val</span> <a title="Thread" id="play.runsupport;SbtPlayWatchService.watch.thread">thread</a> = <span title="(x$1: Runnable, x$2: String)Thread" class="keyword">new</span> <span title="Thread">Thread</span><span class="delimiter">(</span><a href="#play.runsupport;SbtPlayWatchService.watch.thread;$anon" title="Runnable" class="keyword">new</a> <a title="anonymous class $anon extends Object with Runnable" id="play.runsupport;SbtPlayWatchService.watch.thread;$anon">Runnable</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;SbtPlayWatchService.watch.thread;$anon.run">run</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">var</span> <a title="sbt.WatchState" id="play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.state">state</a> = <span title="sbt.WatchState.type">WatchState</span>.<span title="=&gt; sbt.WatchState">empty</span>
        <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#play.runsupport;SbtPlayWatchService.watch.stopped" title="Boolean">stopped</a><span class="delimiter">)</span> <a href="#play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.while$1" title="()Unit" class="delimiter">{</a>
          <span class="keyword">val</span> <a href="#play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.triggered" title="(Boolean, sbt.WatchState)" class="delimiter">(</a><a href="#play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.x$1" title="Boolean" id="play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.triggered">triggered</a>, <a href="#play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.x$1" title="sbt.WatchState" id="play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.newState">newState</a><span class="delimiter">)</span> = <span title="sbt.SourceModificationWatch.type">SourceModificationWatch</span>.<span title="(sourcesFinder: sbt.PathFinder, pollDelayMillis: Int, state: sbt.WatchState)(terminationCondition: =&gt; Boolean)(Boolean, sbt.WatchState)">watch</span><span class="delimiter">(</span><a href="#play.runsupport;SbtPlayWatchService.watch.filesToWatch" title="implicit sbt.PathExtra.filesToFinder : (cc: Traversable[java.io.File])sbt.PathFinder">filesToWatch</a>.<span title="=&gt; sbt.PathFinder">***</span>.<span title="=&gt; sbt.PathFinder">distinct</span>, <a href="#play.runsupport;SbtPlayWatchService.pollDelayMillis" title="Int">pollDelayMillis</a>,
            <a href="#play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.state" title="sbt.WatchState">state</a><span class="delimiter">)</span><span title="(Boolean, sbt.WatchState) @unchecked" class="delimiter">(</span><a href="#play.runsupport;SbtPlayWatchService.watch.stopped" title="Boolean">stopped</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.triggered" title="Boolean">triggered</a><span class="delimiter">)</span> <a href="#play.runsupport;SbtPlayWatchService.watch.onChange" title="()Unit">onChange</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.state" title="sbt.WatchState">state</a> = <a href="#play.runsupport;SbtPlayWatchService.watch.thread;$anon.run.newState" title="sbt.WatchState">newState</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>, <span title="String(&quot;sbt-play-watch-service&quot;)" class="string">&quot;sbt-play-watch-service&quot;</span><span class="delimiter">)</span>
    <a href="#play.runsupport;SbtPlayWatchService.watch.thread" title="Thread">thread</a>.<span title="(x$1: Boolean)Unit">setDaemon</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
    <a href="#play.runsupport;SbtPlayWatchService.watch.thread" title="Thread">thread</a>.<span title="()Unit">start</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <a href="#play.runsupport;SbtPlayWatchService.watch;$anon" title="play.runsupport.PlayWatcher" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.runsupport.PlayWatcher" id="play.runsupport;SbtPlayWatchService.watch;$anon">PlayWatcher</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;SbtPlayWatchService.watch;$anon.stop">stop</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#play.runsupport;SbtPlayWatchService.watch.stopped" title="Boolean">stopped</a> = <span title="Boolean(true)" class="keyword">true</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">private</span> <span class="keyword">class</span> <a title="class JNotifyPlayWatchService extends AnyRef with play.runsupport.PlayWatchService" id="play.runsupport;JNotifyPlayWatchService">JNotifyPlayWatchService</a><a href="#play.runsupport;JNotifyPlayWatchService" title="play.runsupport.JNotifyPlayWatchService" class="delimiter">(</a><a title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate" id="play.runsupport;JNotifyPlayWatchService.delegate">delegate</a>: JNotifyPlayWatchService.<a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate" title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate">JNotifyDelegate</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.runsupport;PlayWatchService" title="play.runsupport.PlayWatchService">PlayWatchService</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.PlayWatcher" id="play.runsupport;JNotifyPlayWatchService.watch">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;JNotifyPlayWatchService.watch.filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport;JNotifyPlayWatchService.watch.onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="AnyRef" id="play.runsupport;JNotifyPlayWatchService.watch.listener">listener</a> = <a href="#play.runsupport;JNotifyPlayWatchService.delegate" title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate">delegate</a>.<a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.newListener" title="(onChange: () =&gt; Unit)AnyRef">newListener</a><span class="delimiter">(</span><a href="#play.runsupport;JNotifyPlayWatchService.watch.onChange" title="() =&gt; Unit">onChange</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Seq[Int]" id="play.runsupport;JNotifyPlayWatchService.watch.registeredIds">registeredIds</a> = <a href="#play.runsupport;JNotifyPlayWatchService.watch.filesToWatch" title="Seq[java.io.File]">filesToWatch</a>.<span title="(f: java.io.File =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[java.io.File],Int,Seq[Int]])Seq[Int]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Int,Seq[Int]]" class="delimiter">{</span> <a title="java.io.File" id="play.runsupport;JNotifyPlayWatchService.watch.registeredIds.$anonfun.file">file</a> =&gt;
      <a href="#play.runsupport;JNotifyPlayWatchService.delegate" title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate">delegate</a>.<a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.addWatch" title="(fileOrDirectory: String, listener: AnyRef)Int">addWatch</a><span class="delimiter">(</span><a href="#play.runsupport;JNotifyPlayWatchService.watch.registeredIds.$anonfun.file" title="java.io.File">file</a>.<span title="()String">getAbsolutePath</span>, <a href="#play.runsupport;JNotifyPlayWatchService.watch.listener" title="AnyRef">listener</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#play.runsupport;JNotifyPlayWatchService.watch;$anon" title="play.runsupport.PlayWatcher" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.runsupport.PlayWatcher" id="play.runsupport;JNotifyPlayWatchService.watch;$anon">PlayWatcher</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;JNotifyPlayWatchService.watch;$anon.stop">stop</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#play.runsupport;JNotifyPlayWatchService.watch.registeredIds" title="Seq[Int]">registeredIds</a>.<span title="(f: Int =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#play.runsupport;JNotifyPlayWatchService.delegate" title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate">delegate</a>.<a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.removeWatch" title="(id: Int)Unit">removeWatch</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">private</span> <span class="keyword">object</span> <a title="play.runsupport.JNotifyPlayWatchService.type" id="play.runsupport.JNotifyPlayWatchService">JNotifyPlayWatchService</a> <a href="#play.runsupport.JNotifyPlayWatchService" title="play.runsupport.JNotifyPlayWatchService.type" class="delimiter">{</a>

  <span class="keyword">import</span> java.lang.reflect.<span class="delimiter">{</span> Method, InvocationHandler, Proxy <span class="delimiter">}</span>

  <span class="comment">/**
   * Captures all the reflection invocations in one place.
   */</span>
  <span class="keyword">class</span> <a title="class JNotifyDelegate extends AnyRef" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate">JNotifyDelegate</a><a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate" title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate" class="delimiter">(</a><a title="ClassLoader" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.classLoader">classLoader</a>: <span title="ClassLoader">ClassLoader</span>, <a title="Class[_]" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.listenerClass">listenerClass</a>: <span title="Class[_]">Class</span><span class="delimiter">[</span>_<span class="delimiter">]</span>, <a title="java.lang.reflect.Method" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.addWatchMethod">addWatchMethod</a>: <span title="java.lang.reflect.Method">Method</span>, <a title="java.lang.reflect.Method" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.removeWatchMethod">removeWatchMethod</a>: <span title="java.lang.reflect.Method">Method</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(fileOrDirectory: String, listener: AnyRef)Int" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.addWatch">addWatch</a><span class="delimiter">(</span><a title="String" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.addWatch.fileOrDirectory">fileOrDirectory</a>: <span title="String">String</span>, <a title="AnyRef" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.addWatch.listener">listener</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.addWatchMethod" title="java.lang.reflect.Method">addWatchMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>,
        <a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.addWatch.fileOrDirectory" title="String">fileOrDirectory</a>, <span class="comment">// The file or directory to watch</span>
        <span title="implicit scala.Predef.int2Integer : (x: Int)Integer" class="int">15</span>: java.lang.<span title="Integer">Integer</span>, <span class="comment">// flags to say watch for all events</span>
        <span title="implicit scala.Predef.boolean2Boolean : (x: Boolean)Boolean" class="keyword">true</span>: java.lang.<span title="Boolean">Boolean</span>, <span class="comment">// Watch subtree</span>
        <a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.addWatch.listener" title="AnyRef">listener</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(id: Int)Unit" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.removeWatch">removeWatch</a><span class="delimiter">(</span><a title="Int" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.removeWatch.id">id</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.removeWatchMethod" title="java.lang.reflect.Method">removeWatchMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span title="Unit" class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.removeWatch.id" title="Int">id</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> _: <span title="Throwable">Throwable</span> =&gt;
        <span class="comment">// Ignore, if we fail to remove a watch it's not the end of the world.</span>
        <span class="comment">// http://sourceforge.net/p/jnotify/bugs/12/</span>
        <span class="comment">// We match on Throwable because matching on an IOException didn't work.</span>
        <span class="comment">// http://sourceforge.net/p/jnotify/bugs/5/</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(onChange: () =&gt; Unit)AnyRef" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.newListener">newListener</a><span class="delimiter">(</span><a title="() =&gt; Unit" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.newListener.onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <span class="delimiter">{</span>
      <span title="java.lang.reflect.Proxy.type">Proxy</span>.<span title="(x$1: ClassLoader, x$2: Array[Class[_]], x$3: java.lang.reflect.InvocationHandler)Object">newProxyInstance</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.classLoader" title="ClassLoader">classLoader</a>, <span title="(elems: Class[_$1]*)Seq[Class[_$1]]">Seq</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.listenerClass" title="Class[_]">listenerClass</a><span class="delimiter">)</span>.<span title="(implicit evidence$1: scala.reflect.ClassTag[Class[_]])Array[Class[_]]">toArray</span>, <a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.newListener;$anon" title="java.lang.reflect.InvocationHandler" class="keyword">new</a> <a title="anonymous class $anon extends Object with java.lang.reflect.InvocationHandler" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.newListener;$anon">InvocationHandler</a> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="(proxy: AnyRef, m: java.lang.reflect.Method, args: Array[AnyRef])AnyRef" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.newListener;$anon.invoke">invoke</a><span class="delimiter">(</span><a title="AnyRef" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.newListener;$anon.invoke.proxy">proxy</a>: <span title="AnyRef">AnyRef</span>, <a title="java.lang.reflect.Method" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.newListener;$anon.invoke.m">m</a>: <span title="java.lang.reflect.Method">Method</span>, <a title="Array[AnyRef]" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.newListener;$anon.invoke.args">args</a>: <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <span class="delimiter">{</span>
          <a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.newListener.onChange" title="()Unit">onChange</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="Null(null)" class="keyword">null</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    @throws<span class="delimiter">[</span>Throwable<span class="delimiter">]</span><span class="delimiter">(</span><span class="string">&quot;If we were not able to successfully load JNotify&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="()Unit" id="play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.ensureLoaded">ensureLoaded</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.removeWatchMethod" title="java.lang.reflect.Method">removeWatchMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span title="Unit" class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <span title="Int(0)" class="int">0</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Integer" class="delimiter">[</span>java.lang.<span title="Integer">Integer</span><span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">// Tri state - null means no attempt to load yet, None means failed load, Some means successful load</span>
  @volatile <span class="keyword">var</span> <a title="Option[scala.util.Try[play.runsupport.JNotifyPlayWatchService]]" id="play.runsupport.JNotifyPlayWatchService.watchService_=">watchService</a>: <span title="Option[scala.util.Try[play.runsupport.JNotifyPlayWatchService]]">Option</span><span class="delimiter">[</span>Try<span class="delimiter">[</span>JNotifyPlayWatchService<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="None.type">None</span>

  <span class="keyword">def</span> <a title="(targetDirectory: java.io.File)scala.util.Try[play.runsupport.PlayWatchService]" id="play.runsupport.JNotifyPlayWatchService.apply">apply</a><span class="delimiter">(</span><a title="java.io.File" id="play.runsupport.JNotifyPlayWatchService.apply.targetDirectory">targetDirectory</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <span title="scala.util.Try[play.runsupport.PlayWatchService]">Try</span><span class="delimiter">[</span>PlayWatchService<span class="delimiter">]</span> = <span class="delimiter">{</span>

    <a href="#play.runsupport.JNotifyPlayWatchService.watchService_=" title="=&gt; Option[scala.util.Try[play.runsupport.JNotifyPlayWatchService]]">watchService</a> <span title="scala.util.Try[play.runsupport.PlayWatchService]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="None.type">None</span> =&gt;
        <span class="keyword">val</span> <span title="scala.util.Try[play.runsupport.JNotifyPlayWatchService]">ws</span> = scala.util.control.<span title="scala.util.control.Exception.type">Exception</span>.<span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; play.runsupport.JNotifyPlayWatchService)scala.util.Try[play.runsupport.JNotifyPlayWatchService]">withTry</span> <span class="delimiter">{</span>

          <span class="keyword">val</span> <a title="ClassLoader" id="play.runsupport.JNotifyPlayWatchService.apply.ws.classloader">classloader</a> = <a href="#play.runsupport.GlobalStaticVar" title="play.runsupport.GlobalStaticVar.type">GlobalStaticVar</a>.<a href="#play.runsupport.GlobalStaticVar.get" title="[T](name: String)(implicit ct: scala.reflect.ClassTag[T])Option[T]">get</a><span title="(name: String)(implicit ct: scala.reflect.ClassTag[ClassLoader])Option[ClassLoader]" class="delimiter">[</span><span title="ClassLoader">ClassLoader</span><span class="delimiter">]</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[ClassLoader]" class="delimiter">(</span><span title="String(&quot;playWatchServiceJNotifyHack&quot;)" class="string">&quot;playWatchServiceJNotifyHack&quot;</span><span class="delimiter">)</span>.<span title="(default: =&gt; ClassLoader)ClassLoader">getOrElse</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="java.io.File" id="play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.jnotifyJarFile">jnotifyJarFile</a> = <span class="keyword">this</span>.<span title="()Class[_]">getClass</span>.<span title="()ClassLoader">getClassLoader</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.net.URLClassLoader" class="delimiter">[</span>java.net.<span title="java.net.URLClassLoader">URLClassLoader</span><span class="delimiter">]</span>.<span title="(xs: Array[java.net.URL])scala.collection.mutable.ArrayOps[java.net.URL]">getURLs</span>
              .<span title="(f: java.net.URL =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Array[java.net.URL],String,Array[String]])Array[String]">map</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.jnotifyJarFile.$anonfun.x$2" title="java.net.URL">_</a>.<span title="()String">getFile</span><span class="delimiter">)</span>
              .<span title="(p: String =&gt; Boolean)Option[String]">find</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.jnotifyJarFile.$anonfun.x$3" title="String">_</a>.<span title="(x$1: CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;/jnotify&quot;)" class="string">&quot;/jnotify&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
              .<span title="(f: String =&gt; java.io.File)Option[java.io.File]">map</span><span class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.jnotifyJarFile.$anonfun.x$4" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
              .<span title="(default: =&gt; java.io.File)java.io.File">getOrElse</span><span class="delimiter">(</span>sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;Missing JNotify?&quot;)" class="string">&quot;Missing JNotify?&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

            <span class="keyword">val</span> <a title="java.io.File" id="play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.nativeLibrariesDirectory">nativeLibrariesDirectory</a> = <span title="(x$1: java.io.File, x$2: String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.targetDirectory" title="java.io.File">targetDirectory</a>, <span title="String(&quot;native_libraries&quot;)" class="string">&quot;native_libraries&quot;</span><span class="delimiter">)</span>

            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.nativeLibrariesDirectory" title="java.io.File">nativeLibrariesDirectory</a>.<span title="()Boolean">exists</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="comment">// Unzip native libraries from the jnotify jar to target/native_libraries</span>
              <span title="sbt.IO.type">IO</span>.<span title="(from: java.io.File, toDirectory: java.io.File, filter: sbt.NameFilter, preserveLastModified: Boolean)Set[java.io.File]">unzip</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.jnotifyJarFile" title="java.io.File">jnotifyJarFile</a>, <a href="#play.runsupport.JNotifyPlayWatchService.apply.targetDirectory" title="java.io.File">targetDirectory</a>, <span class="delimiter">(</span>name: <span title="String">String</span><span class="delimiter">)</span> =&gt; <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.$anonfun.name" title="String">name</a>.<span title="(x$1: String)Boolean">startsWith</span><span class="delimiter">(</span><span title="String(&quot;native_libraries&quot;)" class="string">&quot;native_libraries&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>

            <span class="keyword">val</span> <a title="String" id="play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.libs">libs</a> = <span title="(x$1: java.io.File, x$2: String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.nativeLibrariesDirectory" title="java.io.File">nativeLibrariesDirectory</a>, <span title="System.type">System</span>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;sun.arch.data.model&quot;)" class="string">&quot;sun.arch.data.model&quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;bits&quot;)" class="string">&quot;bits&quot;</span><span class="delimiter">)</span>.<span title="()String">getAbsolutePath</span>

            <span class="comment">// Hack to set java.library.path</span>
            <span title="System.type">System</span>.<span title="(x$1: String, x$2: String)String">setProperty</span><span class="delimiter">(</span><span title="String(&quot;java.library.path&quot;)" class="string">&quot;java.library.path&quot;</span>, <span class="delimiter">{</span>
              <span title="(x: String)Option[String]">Option</span><span class="delimiter">(</span><span title="System.type">System</span>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;java.library.path&quot;)" class="string">&quot;java.library.path&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: String =&gt; String)Option[String]">map</span> <span class="delimiter">{</span> <a title="String" id="play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.$anonfun.existing">existing</a> =&gt;
                <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.$anonfun.existing" title="String">existing</a> <span title="(x$1: Any)String">+</span> java.io.<span title="java.io.File.type">File</span>.<span title="String">pathSeparator</span> <span title="(x$1: Any)String">+</span> <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.libs" title="String">libs</a>
              <span class="delimiter">}</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.libs" title="String">libs</a><span class="delimiter">)</span>
            <span class="delimiter">}</span><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="java.lang.reflect.Field" id="play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.fieldSysPath">fieldSysPath</a> = classOf<span title="Class[ClassLoader](classOf[java.lang.ClassLoader])" class="delimiter">[</span>ClassLoader<span class="delimiter">]</span>.<span title="(x$1: String)java.lang.reflect.Field">getDeclaredField</span><span class="delimiter">(</span><span title="String(&quot;sys_paths&quot;)" class="string">&quot;sys_paths&quot;</span><span class="delimiter">)</span>
            <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.fieldSysPath" title="java.lang.reflect.Field">fieldSysPath</a>.<span title="(x$1: Boolean)Unit">setAccessible</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
            <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.fieldSysPath" title="java.lang.reflect.Field">fieldSysPath</a>.<span title="(x$1: Any, x$2: Any)Unit">set</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>

            <span class="comment">// Create classloader just for jnotify</span>
            <span class="keyword">val</span> <a title="java.net.URLClassLoader" id="play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.loader">loader</a> = <span title="java.net.URLClassLoader" class="keyword">new</span> <span title="java.net.URLClassLoader">URLClassLoader</span><span class="delimiter">(</span><span title="(xs: java.net.URL*)(implicit evidence$2: scala.reflect.ClassTag[java.net.URL])Array[java.net.URL]">Array</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[java.net.URL]" class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.jnotifyJarFile" title="java.io.File">jnotifyJarFile</a>.<span title="()java.net.URI">toURI</span>.<span title="()java.net.URL">toURL</span><span class="delimiter">)</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>

            <a href="#play.runsupport.GlobalStaticVar" title="play.runsupport.GlobalStaticVar.type">GlobalStaticVar</a>.<a href="#play.runsupport.GlobalStaticVar.set" title="(name: String, value: AnyRef)Unit">set</a><span class="delimiter">(</span><span title="String(&quot;playWatchServiceJNotifyHack&quot;)" class="string">&quot;playWatchServiceJNotifyHack&quot;</span>, <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.loader" title="java.net.URLClassLoader">loader</a><span class="delimiter">)</span>

            <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader.loader" title="java.net.URLClassLoader">loader</a>
          <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JNotifyPlayWatchService.apply.ws.jnotifyClass">jnotifyClass</a> = <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader" title="ClassLoader">classloader</a>.<span title="(x$1: String)Class[_]">loadClass</span><span class="delimiter">(</span><span title="String(&quot;net.contentobjects.jnotify.JNotify&quot;)" class="string">&quot;net.contentobjects.jnotify.JNotify&quot;</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JNotifyPlayWatchService.apply.ws.jnotifyListenerClass">jnotifyListenerClass</a> = <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader" title="ClassLoader">classloader</a>.<span title="(x$1: String)Class[_]">loadClass</span><span class="delimiter">(</span><span title="String(&quot;net.contentobjects.jnotify.JNotifyListener&quot;)" class="string">&quot;net.contentobjects.jnotify.JNotifyListener&quot;</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JNotifyPlayWatchService.apply.ws.addWatchMethod">addWatchMethod</a> = <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.jnotifyClass" title="Class[_]">jnotifyClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;addWatch&quot;)" class="string">&quot;addWatch&quot;</span>, classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span>, classOf<span title="Class[Int](classOf[scala.Int])" class="delimiter">[</span>Int<span class="delimiter">]</span>, classOf<span title="Class[Boolean](classOf[scala.Boolean])" class="delimiter">[</span>Boolean<span class="delimiter">]</span>, <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.jnotifyListenerClass" title="Class[_]">jnotifyListenerClass</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JNotifyPlayWatchService.apply.ws.removeWatchMethod">removeWatchMethod</a> = <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.jnotifyClass" title="Class[_]">jnotifyClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;removeWatch&quot;)" class="string">&quot;removeWatch&quot;</span>, classOf<span title="Class[Int](classOf[scala.Int])" class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span>

          <span class="keyword">val</span> <a title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate" id="play.runsupport.JNotifyPlayWatchService.apply.ws.d">d</a> = <span title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate" class="keyword">new</span> <a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate" title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate">JNotifyDelegate</a><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.classloader" title="ClassLoader">classloader</a>, <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.jnotifyListenerClass" title="Class[_]">jnotifyListenerClass</a>, <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.addWatchMethod" title="java.lang.reflect.Method">addWatchMethod</a>, <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.removeWatchMethod" title="java.lang.reflect.Method">removeWatchMethod</a><span class="delimiter">)</span>

          <span class="comment">// Try it</span>
          <a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.d" title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate">d</a>.<a href="#play.runsupport.JNotifyPlayWatchService;JNotifyDelegate.ensureLoaded" title="()Unit">ensureLoaded</a><span class="delimiter">(</span><span class="delimiter">)</span>

          <span title="play.runsupport.JNotifyPlayWatchService" class="keyword">new</span> <a href="#play.runsupport;JNotifyPlayWatchService" title="play.runsupport.JNotifyPlayWatchService">JNotifyPlayWatchService</a><span class="delimiter">(</span><a href="#play.runsupport.JNotifyPlayWatchService.apply.ws.d" title="play.runsupport.JNotifyPlayWatchService.JNotifyDelegate">d</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#play.runsupport.JNotifyPlayWatchService.watchService_=" title="(x$1: Option[scala.util.Try[play.runsupport.JNotifyPlayWatchService]])Unit">watchService</a> = <span title="(x: scala.util.Try[play.runsupport.JNotifyPlayWatchService])Some[scala.util.Try[play.runsupport.JNotifyPlayWatchService]]">Some</span><span class="delimiter">(</span><span title="scala.util.Try[play.runsupport.JNotifyPlayWatchService]">ws</span><span class="delimiter">)</span>
        <span title="scala.util.Try[play.runsupport.JNotifyPlayWatchService]">ws</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><span title="scala.util.Try[play.runsupport.JNotifyPlayWatchService]">ws</span><span class="delimiter">)</span> =&gt; <span title="scala.util.Try[play.runsupport.JNotifyPlayWatchService]">ws</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">private</span> <span class="keyword">class</span> <a title="class JDK7PlayWatchService extends AnyRef with play.runsupport.PlayWatchService" id="play.runsupport;JDK7PlayWatchService">JDK7PlayWatchService</a><a href="#play.runsupport;JDK7PlayWatchService" title="play.runsupport.JDK7PlayWatchService" class="delimiter">(</a><a title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate" id="play.runsupport;JDK7PlayWatchService.delegate">delegate</a>: JDK7PlayWatchService.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">JDK7WatchServiceDelegate</a>, <a title="play.runsupport.LoggerProxy" id="play.runsupport;JDK7PlayWatchService.logger">logger</a>: <a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy" title="play.runsupport.LoggerProxy">LoggerProxy</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.runsupport;PlayWatchService" title="play.runsupport.PlayWatchService">PlayWatchService</a> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.PlayWatcher" id="play.runsupport;JDK7PlayWatchService.watch">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;JDK7PlayWatchService.watch.filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport;JDK7PlayWatchService.watch.onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Seq[java.io.File]" id="play.runsupport;JDK7PlayWatchService.watch.dirsToWatch">dirsToWatch</a> = <a href="#play.runsupport;JDK7PlayWatchService.watch.filesToWatch" title="Seq[java.io.File]">filesToWatch</a>.<span title="(p: java.io.File =&gt; Boolean)Seq[java.io.File]">filter</span> <span class="delimiter">{</span> <a title="java.io.File" id="play.runsupport;JDK7PlayWatchService.watch.dirsToWatch.$anonfun.file">file</a> =&gt;
      <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.dirsToWatch.$anonfun.file" title="java.io.File">file</a>.<span title="()Boolean">isDirectory</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Boolean(true)" class="keyword">true</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.dirsToWatch.$anonfun.file" title="java.io.File">file</a>.<span title="()Boolean">isFile</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// JDK7 WatchService can't watch files</span>
        <a href="#play.runsupport;JDK7PlayWatchService.logger" title="play.runsupport.LoggerProxy">logger</a>.<a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy.warn" title="(message: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="String(&quot;JDK7 WatchService only supports watching directories, but an attempt has been made to watch the file: &quot;)" class="string">&quot;JDK7 WatchService only supports watching directories, but an attempt has been made to watch the file: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.runsupport;JDK7PlayWatchService.watch.dirsToWatch.$anonfun.file" title="java.io.File">file</a>.<span title="()String">getCanonicalPath</span><span class="delimiter">)</span>
        <a href="#play.runsupport;JDK7PlayWatchService.logger" title="play.runsupport.LoggerProxy">logger</a>.<a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy.warn" title="(message: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="String(&quot;This file will not be watched. Either remove the file from playMonitoredFiles, or configure a different WatchService, eg:&quot;)" class="string">&quot;This file will not be watched. Either remove the file from playMonitoredFiles, or configure a different WatchService, eg:&quot;</span><span class="delimiter">)</span>
        <a href="#play.runsupport;JDK7PlayWatchService.logger" title="play.runsupport.LoggerProxy">logger</a>.<a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy.warn" title="(message: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="String(&quot;PlayKeys.playWatchService := play.sbtplugin.run.PlayWatchService.jnotify(target.value)&quot;)" class="string">&quot;PlayKeys.playWatchService := play.sbtplugin.run.PlayWatchService.jnotify(target.value)&quot;</span><span class="delimiter">)</span>
        <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span>

    <span class="comment">// val watcher = FileSystems.getDefault.newWatchService()</span>
    <span class="keyword">val</span> <a title="AnyRef" id="play.runsupport;JDK7PlayWatchService.watch.watcher">watcher</a> = <a href="#play.runsupport;JDK7PlayWatchService.delegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">delegate</a>.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.newWatchService" title="()AnyRef">newWatchService</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">// Get all sub directories</span>
    <span class="keyword">val</span> <a title="Seq[java.io.File]" id="play.runsupport;JDK7PlayWatchService.watch.allDirsToWatch">allDirsToWatch</a> = <a href="#play.runsupport;JDK7PlayWatchService.allSubDirectories" title="(dirs: Seq[java.io.File])Seq[java.io.File]">allSubDirectories</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.dirsToWatch" title="Seq[java.io.File]">dirsToWatch</a><span class="delimiter">)</span>
    <a href="#play.runsupport;JDK7PlayWatchService.watch.allDirsToWatch" title="Seq[java.io.File]">allDirsToWatch</a>.<span title="(f: java.io.File =&gt; AnyRef)Unit">foreach</span> <span class="delimiter">{</span> <a title="java.io.File" id="play.runsupport;JDK7PlayWatchService.watch.$anonfun.dir">dir</a> =&gt;
      <span class="comment">// file.toPath.register(watcher, Array(ENTRY_CREATE, ENTRY_DELETE, ENTRY_MODIFY),</span>
      <span class="comment">//     com.sun.nio.file.SensitivityWatchEventModifier.HIGH)</span>
      <a href="#play.runsupport;JDK7PlayWatchService.delegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">delegate</a>.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerFileWithWatcher" title="(file: java.io.File, watcher: AnyRef)AnyRef">registerFileWithWatcher</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.$anonfun.dir" title="java.io.File">dir</a>, <a href="#play.runsupport;JDK7PlayWatchService.watch.watcher" title="AnyRef">watcher</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Thread" id="play.runsupport;JDK7PlayWatchService.watch.thread">thread</a> = <span title="(x$1: Runnable, x$2: String)Thread" class="keyword">new</span> <span title="Thread">Thread</span><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon" title="Runnable" class="keyword">new</a> <a title="anonymous class $anon extends Object with Runnable" id="play.runsupport;JDK7PlayWatchService.watch.thread;$anon">Runnable</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run">run</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.while$2" title="()Unit" class="delimiter">{</a>
            <span class="comment">// val watchKey = watcher.take()</span>
            <span class="keyword">val</span> <a title="AnyRef" id="play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.watchKey">watchKey</a> = <a href="#play.runsupport;JDK7PlayWatchService.delegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">delegate</a>.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.takeFromWatcher" title="(watcher: AnyRef)AnyRef">takeFromWatcher</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.watcher" title="AnyRef">watcher</a><span class="delimiter">)</span>

            <span class="keyword">val</span> <a title="java.util.List[AnyRef]" id="play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.events">events</a> = <a href="#play.runsupport;JDK7PlayWatchService.delegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">delegate</a>.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pollEvents" title="(watchKey: AnyRef)java.util.List[AnyRef]">pollEvents</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.watchKey" title="AnyRef">watchKey</a><span class="delimiter">)</span>

            <span class="keyword">import</span> scala.collection.<span title="scala.collection.JavaConversions.type">JavaConversions</span>._
            <span class="comment">// If a directory has been created, we must watch it and its sub directories</span>
            <a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.events" title="(l: java.util.List[AnyRef])scala.collection.mutable.Buffer[AnyRef]">events</a>.<span title="(f: AnyRef =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="AnyRef" id="play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.$anonfun.event">event</a> =&gt;

              <span class="comment">// if (event.kind == ENTRY_CREATE) {</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.delegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">delegate</a>.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.isEventKindEntryCreate" title="(watchEvent: AnyRef)Boolean">isEventKindEntryCreate</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.$anonfun.event" title="AnyRef">event</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="comment">// val file = watchKey.watchable.asInstanceOf[Path].resolve(event.context.asInstanceOf[Path]).toFile</span>
                <span class="keyword">val</span> <a title="java.io.File" id="play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.$anonfun.file">file</a> = <a href="#play.runsupport;JDK7PlayWatchService.delegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">delegate</a>.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile" title="(watchKey: AnyRef, watchEvent: AnyRef)java.io.File">getEventFile</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.watchKey" title="AnyRef">watchKey</a>, <a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.$anonfun.event" title="AnyRef">event</a><span class="delimiter">)</span>

                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.$anonfun.file" title="java.io.File">file</a>.<span title="()Boolean">isDirectory</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <a href="#play.runsupport;JDK7PlayWatchService.allSubDirectories" title="(dirs: Seq[java.io.File])Seq[java.io.File]">allSubDirectories</a><span class="delimiter">(</span><span title="(elems: java.io.File*)Seq[java.io.File]">Seq</span><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.$anonfun.file" title="java.io.File">file</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: java.io.File =&gt; AnyRef)Unit">foreach</span> <span class="delimiter">{</span> <a title="java.io.File" id="play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.$anonfun.$anonfun.dir">dir</a> =&gt;
                    <a href="#play.runsupport;JDK7PlayWatchService.delegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">delegate</a>.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerFileWithWatcher" title="(file: java.io.File, watcher: AnyRef)AnyRef">registerFileWithWatcher</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.$anonfun.$anonfun.dir" title="java.io.File">dir</a>, <a href="#play.runsupport;JDK7PlayWatchService.watch.watcher" title="AnyRef">watcher</a><span class="delimiter">)</span>
                  <span class="delimiter">}</span>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>

            <a href="#play.runsupport;JDK7PlayWatchService.watch.onChange" title="()Unit">onChange</a><span class="delimiter">(</span><span class="delimiter">)</span>

            <span class="comment">// watchKey.reset()</span>
            <a href="#play.runsupport;JDK7PlayWatchService.delegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">delegate</a>.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.resetKey" title="(watchKey: AnyRef)Boolean">resetKey</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.watchKey" title="AnyRef">watchKey</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="play.runsupport;JDK7PlayWatchService.watch.thread;$anon.run.e">e</a><span class="delimiter">)</span> =&gt; <span class="comment">// Do nothing, this means the watch service has been closed, or we've been interrupted.</span>
        <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
          <span class="comment">// Just in case it wasn't closed.</span>
          <span class="comment">// watcher.close()</span>
          <a href="#play.runsupport;JDK7PlayWatchService.delegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">delegate</a>.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.closeWatcher" title="(watcher: AnyRef)Unit">closeWatcher</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.watcher" title="AnyRef">watcher</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>, <span title="String(&quot;sbt-play-watch-service&quot;)" class="string">&quot;sbt-play-watch-service&quot;</span><span class="delimiter">)</span>
    <a href="#play.runsupport;JDK7PlayWatchService.watch.thread" title="Thread">thread</a>.<span title="(x$1: Boolean)Unit">setDaemon</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
    <a href="#play.runsupport;JDK7PlayWatchService.watch.thread" title="Thread">thread</a>.<span title="()Unit">start</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <a href="#play.runsupport;JDK7PlayWatchService.watch;$anon" title="play.runsupport.PlayWatcher" class="keyword">new</a> <a title="anonymous class $anon extends AnyRef with play.runsupport.PlayWatcher" id="play.runsupport;JDK7PlayWatchService.watch;$anon">PlayWatcher</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="play.runsupport;JDK7PlayWatchService.watch;$anon.stop">stop</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="comment">// watcher.close()</span>
        <a href="#play.runsupport;JDK7PlayWatchService.delegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">delegate</a>.<a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.closeWatcher" title="(watcher: AnyRef)Unit">closeWatcher</a><span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.watch.watcher" title="AnyRef">watcher</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(dirs: Seq[java.io.File])Seq[java.io.File]" id="play.runsupport;JDK7PlayWatchService.allSubDirectories">allSubDirectories</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;JDK7PlayWatchService.allSubDirectories.dirs">dirs</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="delimiter">(</span><a href="#play.runsupport;JDK7PlayWatchService.allSubDirectories.dirs" title="implicit sbt.PathExtra.filesToFinder : (cc: Traversable[java.io.File])sbt.PathFinder">dirs</a> <span title="(filter: sbt.FileFilter)sbt.PathFinder">**</span> <span class="delimiter">(</span><span title="sbt.DirectoryFilter.type">DirectoryFilter</span> <span title="(filter: sbt.FileFilter)sbt.FileFilter">--</span> <span title="sbt.HiddenFileFilter.type">HiddenFileFilter</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Seq[java.io.File]">get</span>.<span title="=&gt; Seq[java.io.File]">distinct</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">private</span> <span class="keyword">object</span> <a title="play.runsupport.JDK7PlayWatchService.type" id="play.runsupport.JDK7PlayWatchService">JDK7PlayWatchService</a> <a href="#play.runsupport.JDK7PlayWatchService" title="play.runsupport.JDK7PlayWatchService.type" class="delimiter">{</a>

  <span class="keyword">import</span> java.lang.reflect.Array

  @volatile <span class="keyword">var</span> <a title="Option[scala.util.Try[play.runsupport.PlayWatchService]]" id="play.runsupport.JDK7PlayWatchService.watchService_=">watchService</a>: <span title="Option[scala.util.Try[play.runsupport.PlayWatchService]]">Option</span><span class="delimiter">[</span>Try<span class="delimiter">[</span>PlayWatchService<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="None.type">None</span>

  <span class="keyword">def</span> <a title="(logger: play.runsupport.LoggerProxy)scala.util.Try[play.runsupport.PlayWatchService]" id="play.runsupport.JDK7PlayWatchService.apply">apply</a><span class="delimiter">(</span><a title="play.runsupport.LoggerProxy" id="play.runsupport.JDK7PlayWatchService.apply.logger">logger</a>: <a href="LoggerProxy.scala.html#play.runsupport;LoggerProxy" title="play.runsupport.LoggerProxy">LoggerProxy</a><span class="delimiter">)</span>: <span title="scala.util.Try[play.runsupport.PlayWatchService]">Try</span><span class="delimiter">[</span>PlayWatchService<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#play.runsupport.JDK7PlayWatchService.watchService_=" title="=&gt; Option[scala.util.Try[play.runsupport.PlayWatchService]]">watchService</a> <span title="scala.util.Try[play.runsupport.PlayWatchService]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="None.type">None</span> =&gt;
        <span class="keyword">val</span> <span title="scala.util.Try[play.runsupport.JDK7PlayWatchService]">ws</span> = <span title="(r: =&gt; play.runsupport.JDK7PlayWatchService)scala.util.Try[play.runsupport.JDK7PlayWatchService]">Try</span><span class="delimiter">(</span><span title="play.runsupport.JDK7PlayWatchService" class="keyword">new</span> <a href="#play.runsupport;JDK7PlayWatchService" title="play.runsupport.JDK7PlayWatchService">JDK7PlayWatchService</a><span class="delimiter">(</span><span title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate" class="keyword">new</span> <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate">JDK7WatchServiceDelegate</a>, <a href="#play.runsupport.JDK7PlayWatchService.apply.logger" title="play.runsupport.LoggerProxy">logger</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#play.runsupport.JDK7PlayWatchService.watchService_=" title="(x$1: Option[scala.util.Try[play.runsupport.PlayWatchService]])Unit">watchService</a> = <span title="(x: scala.util.Try[play.runsupport.JDK7PlayWatchService])Some[scala.util.Try[play.runsupport.JDK7PlayWatchService]]">Some</span><span class="delimiter">(</span><span title="scala.util.Try[play.runsupport.JDK7PlayWatchService]">ws</span><span class="delimiter">)</span>
        <span title="scala.util.Try[play.runsupport.JDK7PlayWatchService]">ws</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><span title="scala.util.Try[play.runsupport.PlayWatchService]">ws</span><span class="delimiter">)</span> =&gt; <span title="scala.util.Try[play.runsupport.PlayWatchService]">ws</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Captures all the reflection for invoking the JDK7 watch service in one place
   */</span>
  <span class="keyword">class</span> <a title="class JDK7WatchServiceDelegate extends AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate">JDK7WatchServiceDelegate</a><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate" title="play.runsupport.JDK7PlayWatchService.JDK7WatchServiceDelegate" class="delimiter">(</a><span class="delimiter">)</span> <span class="delimiter">{</span>

    <span class="keyword">def</span> <a title="(clazz: String)Class[_]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass">loadClass</a><span class="delimiter">(</span><a title="String" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass.clazz">clazz</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Class[_]">Class</span><span class="delimiter">[</span>_<span class="delimiter">]</span> = <span title="ClassLoader.type">ClassLoader</span>.<span title="()ClassLoader">getSystemClassLoader</span>.<span title="(x$1: String)Class[_]">loadClass</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass.clazz" title="String">clazz</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.fileSystem">fileSystem</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass" title="(clazz: String)Class[_]">loadClass</a><span class="delimiter">(</span><span title="String(&quot;java.nio.file.FileSystems&quot;)" class="string">&quot;java.nio.file.FileSystems&quot;</span><span class="delimiter">)</span>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;getDefault&quot;)" class="string">&quot;getDefault&quot;</span><span class="delimiter">)</span>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.newWatchServiceMethod">newWatchServiceMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass" title="(clazz: String)Class[_]">loadClass</a><span class="delimiter">(</span><span title="String(&quot;java.nio.file.FileSystem&quot;)" class="string">&quot;java.nio.file.FileSystem&quot;</span><span class="delimiter">)</span>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;newWatchService&quot;)" class="string">&quot;newWatchService&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.toPathMethod">toPathMethod</a> = classOf<span title="Class[java.io.File](classOf[java.io.File])" class="delimiter">[</span>File<span class="delimiter">]</span>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;toPath&quot;)" class="string">&quot;toPath&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchServiceClass">watchServiceClass</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass" title="(clazz: String)Class[_]">loadClass</a><span class="delimiter">(</span><span title="String(&quot;java.nio.file.WatchService&quot;)" class="string">&quot;java.nio.file.WatchService&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.takeMethod">takeMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchServiceClass" title="=&gt; Class[_]">watchServiceClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;take&quot;)" class="string">&quot;take&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.closeMethod">closeMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchServiceClass" title="=&gt; Class[_]">watchServiceClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;close&quot;)" class="string">&quot;close&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.kindClass">kindClass</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass" title="(clazz: String)Class[_]">loadClass</a><span class="delimiter">(</span><span title="String(&quot;java.nio.file.WatchEvent$Kind&quot;)" class="string">&quot;java.nio.file.WatchEvent$Kind&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Class[_ &lt;: Object]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.kindArrayClass">kindArrayClass</a> = <span title="java.lang.reflect.Array.type">Array</span>.<span title="(x$1: Class[_], x$2: Int)Object">newInstance</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.kindClass" title="=&gt; Class[_]">kindClass</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="()Class[_]">getClass</span>
    <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.standardWatchEventKindsClass">standardWatchEventKindsClass</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass" title="(clazz: String)Class[_]">loadClass</a><span class="delimiter">(</span><span title="String(&quot;java.nio.file.StandardWatchEventKinds&quot;)" class="string">&quot;java.nio.file.StandardWatchEventKinds&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.entryCreate">entryCreate</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.standardWatchEventKindsClass" title="=&gt; Class[_]">standardWatchEventKindsClass</a>.<span title="(x$1: String)java.lang.reflect.Field">getField</span><span class="delimiter">(</span><span title="String(&quot;ENTRY_CREATE&quot;)" class="string">&quot;ENTRY_CREATE&quot;</span><span class="delimiter">)</span>.<span title="(x$1: Any)Object">get</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.entryDelete">entryDelete</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.standardWatchEventKindsClass" title="=&gt; Class[_]">standardWatchEventKindsClass</a>.<span title="(x$1: String)java.lang.reflect.Field">getField</span><span class="delimiter">(</span><span title="String(&quot;ENTRY_DELETE&quot;)" class="string">&quot;ENTRY_DELETE&quot;</span><span class="delimiter">)</span>.<span title="(x$1: Any)Object">get</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.entryModify">entryModify</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.standardWatchEventKindsClass" title="=&gt; Class[_]">standardWatchEventKindsClass</a>.<span title="(x$1: String)java.lang.reflect.Field">getField</span><span class="delimiter">(</span><span title="String(&quot;ENTRY_MODIFY&quot;)" class="string">&quot;ENTRY_MODIFY&quot;</span><span class="delimiter">)</span>.<span title="(x$1: Any)Object">get</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.dirKinds">dirKinds</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.dirKinds.array">array</a> = <span title="java.lang.reflect.Array.type">Array</span>.<span title="(x$1: Class[_], x$2: Int)Object">newInstance</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.kindClass" title="=&gt; Class[_]">kindClass</a>, <span title="Int(3)" class="int">3</span><span class="delimiter">)</span>
      <span title="java.lang.reflect.Array.type">Array</span>.<span title="(x$1: Any, x$2: Int, x$3: Any)Unit">set</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.dirKinds.array" title="Object">array</a>, <span title="Int(0)" class="int">0</span>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.entryCreate" title="=&gt; Object">entryCreate</a><span class="delimiter">)</span>
      <span title="java.lang.reflect.Array.type">Array</span>.<span title="(x$1: Any, x$2: Int, x$3: Any)Unit">set</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.dirKinds.array" title="Object">array</a>, <span title="Int(1)" class="int">1</span>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.entryDelete" title="=&gt; Object">entryDelete</a><span class="delimiter">)</span>
      <span title="java.lang.reflect.Array.type">Array</span>.<span title="(x$1: Any, x$2: Int, x$3: Any)Unit">set</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.dirKinds.array" title="Object">array</a>, <span title="Int(2)" class="int">2</span>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.entryModify" title="=&gt; Object">entryModify</a><span class="delimiter">)</span>
      <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.dirKinds.array" title="Object">array</a>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifierClass">modifierClass</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass" title="(clazz: String)Class[_]">loadClass</a><span class="delimiter">(</span><span title="String(&quot;java.nio.file.WatchEvent$Modifier&quot;)" class="string">&quot;java.nio.file.WatchEvent$Modifier&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Class[_ &lt;: Object]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifierArrayClass">modifierArrayClass</a> = <span title="java.lang.reflect.Array.type">Array</span>.<span title="(x$1: Class[_], x$2: Int)Object">newInstance</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifierClass" title="=&gt; Class[_]">modifierClass</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="()Class[_]">getClass</span>
    <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifiers">modifiers</a> = <span class="delimiter">{</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span class="comment">// OpenJDK specific.</span>
        <span class="comment">// The default polling interval (sensitivity) for implementations that poll (OSX) is 10 seconds (MEDIUM).</span>
        <span class="comment">// This is controlled by the SensitivityWatchEventModifier modifier.  HIGH is the shortest, at 2 seconds.</span>
        <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifiers.sensitivityClass">sensitivityClass</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass" title="(clazz: String)Class[_]">loadClass</a><span class="delimiter">(</span><span title="String(&quot;com.sun.nio.file.SensitivityWatchEventModifier&quot;)" class="string">&quot;com.sun.nio.file.SensitivityWatchEventModifier&quot;</span><span class="delimiter">)</span>
        <span class="comment">// There are two ways to cast to a recursive type. One way is forSome. The other is a custom asInstanceOf</span>
        <span class="comment">// method that defines the recursive type.</span>
        <span class="keyword">import</span> scala.<span title="language.type">language</span>.existentials
        <span class="keyword">val</span> <a title="T forSome { type T &lt;: Enum[T] }" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifiers.sensitivity">sensitivity</a> = <span title="Enum.type">Enum</span>.<span title="(x$1: Class[T], x$2: String)T">valueOf</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifiers.sensitivityClass" title="Class[_]">sensitivityClass</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[T]" class="delimiter">[</span>Class<span class="delimiter">[</span>T<span class="delimiter">]</span> <span title="Class[T] forSome { type T &lt;: Enum[T] }" class="keyword">forSome</span> <span class="delimiter">{</span> <span class="keyword">type</span> T &lt;: Enum<span class="delimiter">[</span>T<span class="delimiter">]</span> <span class="delimiter">}</span><span class="delimiter">]</span>, <span title="String(&quot;HIGH&quot;)" class="string">&quot;HIGH&quot;</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifiers.array">array</a> = <span title="java.lang.reflect.Array.type">Array</span>.<span title="(x$1: Class[_], x$2: Int)Object">newInstance</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifierClass" title="=&gt; Class[_]">modifierClass</a>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <span title="java.lang.reflect.Array.type">Array</span>.<span title="(x$1: Any, x$2: Int, x$3: Any)Unit">set</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifiers.array" title="Object">array</a>, <span title="Int(0)" class="int">0</span>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifiers.sensitivity" title="T forSome { type T &lt;: Enum[T] }">sensitivity</a><span class="delimiter">)</span>
        <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifiers.array" title="Object">array</a>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="ClassNotFoundException" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifiers.e">e</a>: <span title="ClassNotFoundException">ClassNotFoundException</span> =&gt; <span title="java.lang.reflect.Array.type">Array</span>.<span title="(x$1: Class[_], x$2: Int)Object">newInstance</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifierClass" title="=&gt; Class[_]">modifierClass</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pathClass">pathClass</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass" title="(clazz: String)Class[_]">loadClass</a><span class="delimiter">(</span><span title="String(&quot;java.nio.file.Path&quot;)" class="string">&quot;java.nio.file.Path&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerMethod">registerMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pathClass" title="=&gt; Class[_]">pathClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;register&quot;)" class="string">&quot;register&quot;</span>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchServiceClass" title="=&gt; Class[_]">watchServiceClass</a>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.kindArrayClass" title="=&gt; Class[_ &lt;: Object]">kindArrayClass</a>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifierArrayClass" title="=&gt; Class[_ &lt;: Object]">modifierArrayClass</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.toFileMethod">toFileMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pathClass" title="=&gt; Class[_]">pathClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;toFile&quot;)" class="string">&quot;toFile&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.resolveMethod">resolveMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pathClass" title="=&gt; Class[_]">pathClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;resolve&quot;)" class="string">&quot;resolve&quot;</span>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pathClass" title="=&gt; Class[_]">pathClass</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchKeyClass">watchKeyClass</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass" title="(clazz: String)Class[_]">loadClass</a><span class="delimiter">(</span><span title="String(&quot;java.nio.file.WatchKey&quot;)" class="string">&quot;java.nio.file.WatchKey&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pollEventsMethod">pollEventsMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchKeyClass" title="=&gt; Class[_]">watchKeyClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;pollEvents&quot;)" class="string">&quot;pollEvents&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.resetMethod">resetMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchKeyClass" title="=&gt; Class[_]">watchKeyClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;reset&quot;)" class="string">&quot;reset&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchableMethod">watchableMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchKeyClass" title="=&gt; Class[_]">watchKeyClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;watchable&quot;)" class="string">&quot;watchable&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Class[_]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchEventClass">watchEventClass</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.loadClass" title="(clazz: String)Class[_]">loadClass</a><span class="delimiter">(</span><span title="String(&quot;java.nio.file.WatchEvent&quot;)" class="string">&quot;java.nio.file.WatchEvent&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.kindMethod">kindMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchEventClass" title="=&gt; Class[_]">watchEventClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;kind&quot;)" class="string">&quot;kind&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.contextMethod">contextMethod</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchEventClass" title="=&gt; Class[_]">watchEventClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;context&quot;)" class="string">&quot;context&quot;</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="()AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.newWatchService">newWatchService</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.newWatchServiceMethod" title="=&gt; java.lang.reflect.Method">newWatchServiceMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.fileSystem" title="=&gt; Object">fileSystem</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(file: java.io.File, watcher: AnyRef)AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerFileWithWatcher">registerFileWithWatcher</a><span class="delimiter">(</span><a title="java.io.File" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerFileWithWatcher.file">file</a>: <span title="java.io.File">File</span>, <a title="AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerFileWithWatcher.watcher">watcher</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerFileWithWatcher.path">path</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.toPathMethod" title="=&gt; java.lang.reflect.Method">toPathMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerFileWithWatcher.file" title="java.io.File">file</a><span class="delimiter">)</span>
      <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerMethod" title="=&gt; java.lang.reflect.Method">registerMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerFileWithWatcher.path" title="Object">path</a>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.registerFileWithWatcher.watcher" title="AnyRef">watcher</a>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.dirKinds" title="=&gt; Object">dirKinds</a>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.modifiers" title="=&gt; Object">modifiers</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(watcher: AnyRef)AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.takeFromWatcher">takeFromWatcher</a><span class="delimiter">(</span><a title="AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.takeFromWatcher.watcher">watcher</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.takeMethod" title="=&gt; java.lang.reflect.Method">takeMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.takeFromWatcher.watcher" title="AnyRef">watcher</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(watchKey: AnyRef)java.util.List[AnyRef]" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pollEvents">pollEvents</a><span class="delimiter">(</span><a title="AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pollEvents.watchKey">watchKey</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: java.util.<span title="java.util.List[AnyRef]">List</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pollEventsMethod" title="=&gt; java.lang.reflect.Method">pollEventsMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.pollEvents.watchKey" title="AnyRef">watchKey</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.util.List[AnyRef]" class="delimiter">[</span>java.util.<span title="java.util.List[AnyRef]">List</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">]</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(watchEvent: AnyRef)AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventKind">getEventKind</a><span class="delimiter">(</span><a title="AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventKind.watchEvent">watchEvent</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="AnyRef">AnyRef</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.kindMethod" title="=&gt; java.lang.reflect.Method">kindMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventKind.watchEvent" title="AnyRef">watchEvent</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(watchEvent: AnyRef)Boolean" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.isEventKindEntryCreate">isEventKindEntryCreate</a><span class="delimiter">(</span><a title="AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.isEventKindEntryCreate.watchEvent">watchEvent</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.kindMethod" title="=&gt; java.lang.reflect.Method">kindMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.isEventKindEntryCreate.watchEvent" title="AnyRef">watchEvent</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.entryCreate" title="=&gt; Object">entryCreate</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(watchKey: AnyRef, watchEvent: AnyRef)java.io.File" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile">getEventFile</a><span class="delimiter">(</span><a title="AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile.watchKey">watchKey</a>: <span title="AnyRef">AnyRef</span>, <a title="AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile.watchEvent">watchEvent</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="java.io.File">File</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile.childPath">childPath</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.contextMethod" title="=&gt; java.lang.reflect.Method">contextMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile.watchEvent" title="AnyRef">watchEvent</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile.parentPath">parentPath</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.watchableMethod" title="=&gt; java.lang.reflect.Method">watchableMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile.watchKey" title="AnyRef">watchKey</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Object" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile.path">path</a> = <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.resolveMethod" title="=&gt; java.lang.reflect.Method">resolveMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile.parentPath" title="Object">parentPath</a>, <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile.childPath" title="Object">childPath</a><span class="delimiter">)</span>
      <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.toFileMethod" title="=&gt; java.lang.reflect.Method">toFileMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.getEventFile.path" title="Object">path</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.io.File" class="delimiter">[</span><span title="java.io.File">File</span><span class="delimiter">]</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(watchKey: AnyRef)Boolean" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.resetKey">resetKey</a><span class="delimiter">(</span><a title="AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.resetKey.watchKey">watchKey</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.resetMethod" title="=&gt; java.lang.reflect.Method">resetMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.resetKey.watchKey" title="AnyRef">watchKey</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="Boolean">Boolean</span><span class="delimiter">]</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(watcher: AnyRef)Unit" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.closeWatcher">closeWatcher</a><span class="delimiter">(</span><a title="AnyRef" id="play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.closeWatcher.watcher">watcher</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      <a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.closeMethod" title="=&gt; java.lang.reflect.Method">closeMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span title="Unit" class="delimiter">(</span><a href="#play.runsupport.JDK7PlayWatchService;JDK7WatchServiceDelegate.closeWatcher.watcher" title="AnyRef">watcher</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span title="AnyRef" class="delimiter">}</span>

<span class="comment">/**
 * Watch service that delegates to a try. This allows it to exist without reporting an exception unless it's used.
 */</span>
<span title="AnyRef" class="keyword">private</span> <span class="keyword">class</span> <a title="class OptionalPlayWatchServiceDelegate extends AnyRef with play.runsupport.PlayWatchService" id="play.runsupport;OptionalPlayWatchServiceDelegate">OptionalPlayWatchServiceDelegate</a><a href="#play.runsupport;OptionalPlayWatchServiceDelegate" title="play.runsupport.OptionalPlayWatchServiceDelegate" class="delimiter">(</a><a title="scala.util.Try[play.runsupport.PlayWatchService]" id="play.runsupport;OptionalPlayWatchServiceDelegate.watchService">watchService</a>: <span title="scala.util.Try[play.runsupport.PlayWatchService]">Try</span><span class="delimiter">[</span>PlayWatchService<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.runsupport;PlayWatchService" title="play.runsupport.PlayWatchService">PlayWatchService</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.PlayWatcher" id="play.runsupport;OptionalPlayWatchServiceDelegate.watch">watch</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="play.runsupport;OptionalPlayWatchServiceDelegate.watch.filesToWatch">filesToWatch</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="() =&gt; Unit" id="play.runsupport;OptionalPlayWatchServiceDelegate.watch.onChange">onChange</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#play.runsupport;OptionalPlayWatchServiceDelegate.watchService" title="scala.util.Try[play.runsupport.PlayWatchService]">watchService</a>.<span title="(f: play.runsupport.PlayWatchService =&gt; play.runsupport.PlayWatcher)scala.util.Try[play.runsupport.PlayWatcher]">map</span><span class="delimiter">(</span><a title="play.runsupport.PlayWatchService" id="play.runsupport;OptionalPlayWatchServiceDelegate.watch.$anonfun.ws">ws</a> =&gt; <a href="#play.runsupport;OptionalPlayWatchServiceDelegate.watch.$anonfun.ws" title="play.runsupport.PlayWatchService">ws</a>.<a href="#play.runsupport;PlayWatchService.watch" title="(filesToWatch: Seq[java.io.File], onChange: () =&gt; Unit)play.runsupport.PlayWatcher">watch</a><span class="delimiter">(</span><a href="#play.runsupport;OptionalPlayWatchServiceDelegate.watch.filesToWatch" title="Seq[java.io.File]">filesToWatch</a>, <a href="#play.runsupport;OptionalPlayWatchServiceDelegate.watch.onChange" title="() =&gt; Unit">onChange</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; play.runsupport.PlayWatcher">get</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Provides a global (cross classloader) static var.
 *
 * This does not leak classloaders (unless the value passed to it references a classloader that shouldn't be leaked).
 * It uses an MBeanServer to store an AtomicReference as an mbean, exposing the get method of the AtomicReference as an
 * mbean operation, so that the value can be retrieved.
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>runsupport<span class="delimiter">]</span> <span class="keyword">object</span> <a title="play.runsupport.GlobalStaticVar.type" id="play.runsupport.GlobalStaticVar">GlobalStaticVar</a> <a href="#play.runsupport.GlobalStaticVar" title="play.runsupport.GlobalStaticVar.type" class="delimiter">{</a>
  <span class="keyword">import</span> javax.management._
  <span class="keyword">import</span> javax.management.modelmbean._
  <span class="keyword">import</span> java.lang.management._
  <span class="keyword">import</span> java.util.concurrent.atomic.AtomicReference

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: String)javax.management.ObjectName" id="play.runsupport.GlobalStaticVar.objectName">objectName</a><span class="delimiter">(</span><a title="String" id="play.runsupport.GlobalStaticVar.objectName.name">name</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="javax.management.ObjectName" class="keyword">new</span> <span title="javax.management.ObjectName">ObjectName</span><span class="delimiter">(</span><span title="String(&quot;:type=GlobalStaticVar,name=&quot;)" class="string">&quot;:type=GlobalStaticVar,name=&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.runsupport.GlobalStaticVar.objectName.name" title="String">name</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Set a global static variable with the given name.
   */</span>
  <span class="keyword">def</span> <a title="(name: String, value: AnyRef)Unit" id="play.runsupport.GlobalStaticVar.set">set</a><span class="delimiter">(</span><a title="String" id="play.runsupport.GlobalStaticVar.set.name">name</a>: <span title="String">String</span>, <a title="AnyRef" id="play.runsupport.GlobalStaticVar.set.value">value</a>: <span title="AnyRef">AnyRef</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>

    <span class="keyword">val</span> <a title="java.util.concurrent.atomic.AtomicReference[AnyRef]" id="play.runsupport.GlobalStaticVar.set.reference">reference</a> = <span title="java.util.concurrent.atomic.AtomicReference[AnyRef]" class="keyword">new</span> <span title="java.util.concurrent.atomic.AtomicReference[AnyRef]">AtomicReference</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.value" title="AnyRef">value</a><span class="delimiter">)</span>

    <span class="comment">// Now we construct a MBean that exposes the AtomicReference.get method</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.runsupport.GlobalStaticVar.set.getMethod">getMethod</a> = classOf<span title="Class[java.util.concurrent.atomic.AtomicReference[_]](classOf[java.util.concurrent.atomic.AtomicReference])" class="delimiter">[</span>AtomicReference<span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;get&quot;)" class="string">&quot;get&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="javax.management.modelmbean.ModelMBeanOperationInfo" id="play.runsupport.GlobalStaticVar.set.getInfo">getInfo</a> = <span title="javax.management.modelmbean.ModelMBeanOperationInfo" class="keyword">new</span> <span title="javax.management.modelmbean.ModelMBeanOperationInfo">ModelMBeanOperationInfo</span><span class="delimiter">(</span><span title="String(&quot;The value&quot;)" class="string">&quot;The value&quot;</span>, <a href="#play.runsupport.GlobalStaticVar.set.getMethod" title="java.lang.reflect.Method">getMethod</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="javax.management.modelmbean.ModelMBeanInfoSupport" id="play.runsupport.GlobalStaticVar.set.mmbi">mmbi</a> = <span title="(x$1: String, x$2: String, x$3: Array[javax.management.modelmbean.ModelMBeanAttributeInfo], x$4: Array[javax.management.modelmbean.ModelMBeanConstructorInfo], x$5: Array[javax.management.modelmbean.ModelMBeanOperationInfo], x$6: Array[javax.management.modelmbean.ModelMBeanNotificationInfo])javax.management.modelmbean.ModelMBeanInfoSupport" class="keyword">new</span> <span title="javax.management.modelmbean.ModelMBeanInfoSupport">ModelMBeanInfoSupport</span><span class="delimiter">(</span><span title="String(&quot;GlobalStaticVar&quot;)" class="string">&quot;GlobalStaticVar&quot;</span>,
      <span title="String(&quot;A global static variable&quot;)" class="string">&quot;A global static variable&quot;</span>,
      <span title="Null(null)" class="keyword">null</span>, <span class="comment">// no attributes</span>
      <span title="Null(null)" class="keyword">null</span>, <span class="comment">// no constructors</span>
      <span title="(xs: javax.management.modelmbean.ModelMBeanOperationInfo*)(implicit evidence$2: scala.reflect.ClassTag[javax.management.modelmbean.ModelMBeanOperationInfo])Array[javax.management.modelmbean.ModelMBeanOperationInfo]">Array</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[javax.management.modelmbean.ModelMBeanOperationInfo]" class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.getInfo" title="javax.management.modelmbean.ModelMBeanOperationInfo">getInfo</a><span class="delimiter">)</span>, <span class="comment">// the operation</span>
      <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>; <span class="comment">// no notifications</span>

    <span class="keyword">val</span> <a title="javax.management.modelmbean.RequiredModelMBean" id="play.runsupport.GlobalStaticVar.set.mmb">mmb</a> = <span title="(x$1: javax.management.modelmbean.ModelMBeanInfo)javax.management.modelmbean.RequiredModelMBean" class="keyword">new</span> <span title="javax.management.modelmbean.RequiredModelMBean">RequiredModelMBean</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.mmbi" title="javax.management.modelmbean.ModelMBeanInfoSupport">mmbi</a><span class="delimiter">)</span>
    <a href="#play.runsupport.GlobalStaticVar.set.mmb" title="javax.management.modelmbean.RequiredModelMBean">mmb</a>.<span title="(x$1: Any, x$2: String)Unit">setManagedResource</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.reference" title="java.util.concurrent.atomic.AtomicReference[AnyRef]">reference</a>, <span title="String(&quot;ObjectReference&quot;)" class="string">&quot;ObjectReference&quot;</span><span class="delimiter">)</span>

    <span class="comment">// Register the Model MBean in the MBean Server</span>
    <span title="java.lang.management.ManagementFactory.type">ManagementFactory</span>.<span title="()javax.management.MBeanServer">getPlatformMBeanServer</span>.<span title="(x$1: Any, x$2: javax.management.ObjectName)javax.management.ObjectInstance">registerMBean</span><span title="Unit" class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.mmb" title="javax.management.modelmbean.RequiredModelMBean">mmb</a>, <a href="#play.runsupport.GlobalStaticVar.objectName" title="(name: String)javax.management.ObjectName">objectName</a><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.set.name" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Get a global static variable by the given name.
   */</span>
  <span class="keyword">def</span> <a title="[T](name: String)(implicit ct: scala.reflect.ClassTag[T])Option[T]" id="play.runsupport.GlobalStaticVar.get">get</a><span class="delimiter">[</span><a title="" id="play.runsupport.GlobalStaticVar.get;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="play.runsupport.GlobalStaticVar.get.name">name</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.ClassTag[T]" id="play.runsupport.GlobalStaticVar.get.ct">ct</a>: <span title="scala.reflect.ClassTag[T]">ClassTag</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Object" id="play.runsupport.GlobalStaticVar.get.value">value</a> = <span title="java.lang.management.ManagementFactory.type">ManagementFactory</span>.<span title="()javax.management.MBeanServer">getPlatformMBeanServer</span>.<span title="(x$1: javax.management.ObjectName, x$2: String, x$3: Array[Object], x$4: Array[String])Object">invoke</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.objectName" title="(name: String)javax.management.ObjectName">objectName</a><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.name" title="String">name</a><span class="delimiter">)</span>, <span title="String(&quot;get&quot;)" class="string">&quot;get&quot;</span>, <span title="Array.type">Array</span>.<span title="(implicit evidence$1: scala.reflect.ClassTag[Object])Array[Object]">empty</span>, <span title="Array.type">Array</span>.<span title="(implicit evidence$1: scala.reflect.ClassTag[String])Array[String]">empty</span><span class="delimiter">)</span>
      <span title="Option[T]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.ct" title="scala.reflect.ClassTag[T]">ct</a>.<span title="=&gt; Class[_]">runtimeClass</span>.<span title="(x$1: Any)Boolean">isInstance</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.value" title="Object">value</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="(x: T)Some[T]">Some</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.value" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="T" class="delimiter">[</span><a href="#play.runsupport.GlobalStaticVar.get;T" title="T">T</a><span class="delimiter">]</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)ClassCastException" class="keyword">new</span> <span title="ClassCastException">ClassCastException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Global static var &quot;)">Global static var $</span><a href="#play.runsupport.GlobalStaticVar.get.name" title="String">name</a><span title="String(&quot; is not an instance of &quot;)"> is not an instance of $</span><span class="delimiter">{</span><a href="#play.runsupport.GlobalStaticVar.get.ct" title="scala.reflect.ClassTag[T]">ct</a>.<span title="=&gt; Class[_]">runtimeClass</span><span class="delimiter">}</span><span title="String(&quot;, but is actually a &quot;)">, but is actually a $</span><span class="delimiter">{</span><span title="(x: Object)Option[Object]">Option</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.value" title="Object">value</a><span class="delimiter">)</span>.<span title="(ifEmpty: =&gt; String)(f: Object =&gt; String)String">fold</span><span class="delimiter">(</span><span title="String(&quot;null&quot;)" class="string">&quot;null&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.get.$anonfun.x$5" title="Object">_</a>.<span title="()Class[_]">getClass</span>.<span title="()String">getName</span><span class="delimiter">)</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="javax.management.InstanceNotFoundException" id="play.runsupport.GlobalStaticVar.get.e">e</a>: <span title="javax.management.InstanceNotFoundException">InstanceNotFoundException</span> =&gt;
        <span title="None.type">None</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Clear a global static variable with the given name.
   */</span>
  <span class="keyword">def</span> <a title="(name: String)Unit" id="play.runsupport.GlobalStaticVar.remove">remove</a><span class="delimiter">(</span><a title="String" id="play.runsupport.GlobalStaticVar.remove.name">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <span title="java.lang.management.ManagementFactory.type">ManagementFactory</span>.<span title="()javax.management.MBeanServer">getPlatformMBeanServer</span>.<span title="(x$1: javax.management.ObjectName)Unit">unregisterMBean</span><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.objectName" title="(name: String)javax.management.ObjectName">objectName</a><span class="delimiter">(</span><a href="#play.runsupport.GlobalStaticVar.remove.name" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="javax.management.InstanceNotFoundException" id="play.runsupport.GlobalStaticVar.remove.e">e</a>: <span title="javax.management.InstanceNotFoundException">InstanceNotFoundException</span> =&gt;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>
        </pre>
    </body>
</html>

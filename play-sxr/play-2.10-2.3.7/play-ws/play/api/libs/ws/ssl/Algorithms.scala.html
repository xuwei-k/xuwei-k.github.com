<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play-ws/play/api/libs/ws/ssl/Algorithms.scala</title>
        <script type="text/javascript" src="../../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 *
 *  * Copyright (C) 2009-2013 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 *
 */</span>
<span class="keyword">package</span> play.api.libs.ws.ssl

<span class="keyword">import</span> javax.crypto.SecretKey
<span class="keyword">import</span> java.security.interfaces._
<span class="keyword">import</span> javax.crypto.interfaces.DHKey
<span class="keyword">import</span> scala.util.parsing.combinator.RegexParsers
<span class="keyword">import</span> java.security.<span class="delimiter">{</span> KeyFactory, Key <span class="delimiter">}</span>
<span class="keyword">import</span> scala.Some

<span class="comment">/**
 * This singleton object provides the code needed to check for minimum standards of an X.509 certificate.  Over 95% of trusted leaf certificates and 95% of trusted signing certificates use &lt;a href=&quot;http://csrc.nist.gov/publications/nistpubs/800-131A/sp800-131A.pdf&quot;&gt;NIST recommended key sizes&lt;/a&gt;.  Play supports Java 1.6, which does not have built in &lt;a href=&quot;http://sim.ivi.co/2013/11/harness-ssl-and-jsse-key-size-control.html&quot;&gt;certificate strength checking&lt;/a&gt;, so we roll our own here.
 *
 * The default settings here are based off &lt;a href=&quot;&quot;&gt;NIST SP 800-57&lt;/a&gt;, using &lt;a href=&quot;https://wiki.mozilla.org/CA:MD5and1024&quot;&gt;Dates for Phasing out MD5-based signatures and 1024-bit moduli&lt;/a&gt; as a practical guide.
 *
 * Note that the key sizes are checked on root CA certificates in the trust store.  As the Mozilla document says:
 *
 * &lt;blockquote&gt;The other concern that needs to be addressed is that of RSA1024 being too small a modulus to be robust against faster computers. Unlike a signature algorithm, where only intermediate and end-entity certificates are impacted, fast math means we have to disable or remove all instances of 1024-bit moduli, including the root certificates.&lt;/blockquote&gt;
 *
 * Relevant key sizes:
 *
 * &lt;blockquote&gt;
 * According to NIST SP 800-57 the recommended algorithms and minimum key sizes are as follows:
 *
 * Through 2010 (minimum of 80 bits of strength)
 * FFC (e.g., DSA, D-H) Minimum: L=1024; N=160
 * IFC (e.g., RSA) Minimum: k=1024
 * ECC (e.g. ECDSA) Minimum: f=160
 * Through 2030 (minimum of 112 bits of strength)
 * FFC (e.g., DSA, D-H) Minimum: L=2048; N=224
 * IFC (e.g., RSA) Minimum: k=2048
 * ECC (e.g. ECDSA) Minimum: f=224
 * Beyond 2030 (minimum of 128 bits of strength)
 * FFC (e.g., DSA, D-H) Minimum: L=3072; N=256
 * IFC (e.g., RSA) Minimum: k=3072
 * ECC (e.g. ECDSA) Minimum: f=256
 * &lt;/blockquote&gt;
 *
 * Relevant signature algorithms:
 *
 * The known weak signature algorithms are &quot;MD2, MD4, MD5&quot;.
 *
 * SHA-1 is considered too weak for new certificates, but is &lt;a href=&quot;http://csrc.nist.gov/groups/ST/hash/policy.html&quot;&gt;still allowed&lt;/a&gt; for verifying old certificates in the chain.  The &lt;a href=&quot;https://blogs.oracle.com/xuelei/entry/tls_and_nist_s_policy&quot;&gt;TLS and NIST'S Policy on Hash Functions&lt;/a&gt; blog post by one of the JSSE authors has more details, in particular the &quot;Put it into practice&quot; section.
 */</span>
<span class="keyword">object</span> <a title="play.api.libs.ws.ssl.Algorithms.type" id="play.api.libs.ws.ssl.Algorithms">Algorithms</a> <a href="#play.api.libs.ws.ssl.Algorithms" title="play.api.libs.ws.ssl.Algorithms.type" class="delimiter">{</a>

  <span class="comment">/**
   * Disabled signature algorithms are applied to signed certificates in a certificate chain, not including CA certs.
   *
   * @return &quot;MD2, MD4, MD5&quot;
   */</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="play.api.libs.ws.ssl.Algorithms.disabledSignatureAlgorithms">disabledSignatureAlgorithms</a>: <span title="String">String</span> = <span title="String(&quot;MD2, MD4, MD5&quot;)" class="string">&quot;MD2, MD4, MD5&quot;</span>

  <span class="comment">/**
   * Disabled key algorithms are applied to all certificates, including the root CAs.
   *
   * @return &quot;RSA keySize &lt; 2048, DSA keySize &lt; 2048, EC keySize &lt; 224&quot;
   */</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="play.api.libs.ws.ssl.Algorithms.disabledKeyAlgorithms">disabledKeyAlgorithms</a>: <span title="String">String</span> = <span title="String(&quot;RSA keySize &lt; 2048, DSA keySize &lt; 2048, EC keySize &lt; 224&quot;)" class="string">&quot;RSA keySize &lt; 2048, DSA keySize &lt; 2048, EC keySize &lt; 224&quot;</span>

  <span class="comment">/**
   * Returns the keySize of the given key, or None if no key exists.
   */</span>
  <span class="keyword">def</span> <a title="(key: java.security.Key)Option[Int]" id="play.api.libs.ws.ssl.Algorithms.keySize">keySize</a><span class="delimiter">(</span><a title="java.security.Key" id="play.api.libs.ws.ssl.Algorithms.keySize.key">key</a>: java.security.<span title="java.security.Key">Key</span><span class="delimiter">)</span>: <span title="Option[Int]">Option</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#play.api.libs.ws.ssl.Algorithms.keySize.key" title="java.security.Key">key</a> <span title="Option[Int]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="javax.crypto.SecretKey" id="play.api.libs.ws.ssl.Algorithms.keySize.sk">sk</a>: <span title="javax.crypto.SecretKey">SecretKey</span> =&gt;
        <span title="Option[Int]" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.keySize.sk" title="javax.crypto.SecretKey">sk</a>.<span title="()String">getFormat</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;RAW&quot;)" class="string">&quot;RAW&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#play.api.libs.ws.ssl.Algorithms.keySize.sk" title="javax.crypto.SecretKey">sk</a>.<span title="()Array[Byte]">getEncoded</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.keySize.sk" title="javax.crypto.SecretKey">sk</a>.<span title="()Array[Byte]">getEncoded</span>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">*</span> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span title="None.type">None</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <span title="security extends java.security.Key with java.security.interfaces.RSAKey">pubk</span>: <span title="java.security.interfaces.RSAKey">RSAKey</span> =&gt;
        <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><span title="security extends java.security.Key with java.security.interfaces.RSAKey">pubk</span>.<span title="()java.math.BigInteger">getModulus</span>.<span title="()Int">bitLength</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="security extends java.security.Key with java.security.interfaces.ECKey">pubk</span>: <span title="java.security.interfaces.ECKey">ECKey</span> =&gt;
        <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><span title="security extends java.security.Key with java.security.interfaces.ECKey">pubk</span>.<span title="()java.security.spec.ECParameterSpec">getParams</span>.<span title="()java.math.BigInteger">getOrder</span>.<span title="()Int">bitLength</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="security extends java.security.Key with java.security.interfaces.DSAKey">pubk</span>: <span title="java.security.interfaces.DSAKey">DSAKey</span> =&gt;
        <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><span title="security extends java.security.Key with java.security.interfaces.DSAKey">pubk</span>.<span title="()java.security.interfaces.DSAParams">getParams</span>.<span title="()java.math.BigInteger">getP</span>.<span title="()Int">bitLength</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="&lt;root&gt; extends java.security.Key with javax.crypto.interfaces.DHKey">pubk</span>: <span title="javax.crypto.interfaces.DHKey">DHKey</span> =&gt;
        <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><span title="&lt;root&gt; extends java.security.Key with javax.crypto.interfaces.DHKey">pubk</span>.<span title="()javax.crypto.spec.DHParameterSpec">getParams</span>.<span title="()java.math.BigInteger">getP</span>.<span title="()Int">bitLength</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="java.security.Key">pubk</span>: <span title="java.security.Key">Key</span> =&gt;
        <span class="keyword">val</span> <a title="java.security.Key" id="play.api.libs.ws.ssl.Algorithms.keySize.translatedKey">translatedKey</a> = <a href="#play.api.libs.ws.ssl.Algorithms.translateKey" title="(pubk: java.security.Key)java.security.Key">translateKey</a><span class="delimiter">(</span><span title="java.security.Key">pubk</span><span class="delimiter">)</span>
        <a href="#play.api.libs.ws.ssl.Algorithms.keySize" title="(key: java.security.Key)Option[Int]">keySize</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.keySize.translatedKey" title="java.security.Key">translatedKey</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="java.security.Key" id="play.api.libs.ws.ssl.Algorithms.keySize.unknownKey">unknownKey</a> =&gt;
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.api.libs.ws.ssl.Algorithms.keySize.lengthMethod">lengthMethod</a> = <a href="#play.api.libs.ws.ssl.Algorithms.keySize.unknownKey" title="java.security.Key">unknownKey</a>.<span title="()Class[_]">getClass</span>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;length&quot;)" class="string">&quot;length&quot;</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Integer" id="play.api.libs.ws.ssl.Algorithms.keySize.l">l</a> = <a href="#play.api.libs.ws.ssl.Algorithms.keySize.lengthMethod" title="java.lang.reflect.Method">lengthMethod</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.keySize.unknownKey" title="java.security.Key">unknownKey</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Integer" class="delimiter">[</span><span title="Integer">Integer</span><span class="delimiter">]</span>
          <span title="Option[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.keySize.l" title="implicit scala.Predef.Integer2int : (x: Integer)Int">l</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.keySize.l" title="implicit scala.Predef.Integer2int : (x: Integer)Int">l</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="None.type">None</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> _: <span title="Throwable">Throwable</span> =&gt;
            <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalStateException" class="keyword">new</span> <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;unknown key &quot;)">unknown key $</span><span class="delimiter">{</span><a href="#play.api.libs.ws.ssl.Algorithms.keySize.key" title="java.security.Key">key</a>.<span title="()Class[_]">getClass</span>.<span title="()String">getName</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="comment">// None</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pubk: java.security.Key)String" id="play.api.libs.ws.ssl.Algorithms.getKeyAlgorithmName">getKeyAlgorithmName</a><span class="delimiter">(</span><a title="java.security.Key" id="play.api.libs.ws.ssl.Algorithms.getKeyAlgorithmName.pubk">pubk</a>: <span title="java.security.Key">Key</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl.Algorithms.getKeyAlgorithmName.name">name</a> = <a href="#play.api.libs.ws.ssl.Algorithms.getKeyAlgorithmName.pubk" title="java.security.Key">pubk</a>.<span title="()String">getAlgorithm</span>
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.getKeyAlgorithmName.name" title="String">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;DH&quot;)" class="string">&quot;DH&quot;</span><span class="delimiter">)</span> <span title="String(&quot;DiffieHellman&quot;)" class="string">&quot;DiffieHellman&quot;</span> <span class="keyword">else</span> <a href="#play.api.libs.ws.ssl.Algorithms.getKeyAlgorithmName.name" title="String">name</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pubk: java.security.Key)java.security.Key" id="play.api.libs.ws.ssl.Algorithms.translateKey">translateKey</a><span class="delimiter">(</span><a title="java.security.Key" id="play.api.libs.ws.ssl.Algorithms.translateKey.pubk">pubk</a>: <span title="java.security.Key">Key</span><span class="delimiter">)</span>: <span title="java.security.Key">Key</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl.Algorithms.translateKey.keyAlgName">keyAlgName</a> = <a href="#play.api.libs.ws.ssl.Algorithms.getKeyAlgorithmName" title="(pubk: java.security.Key)String">getKeyAlgorithmName</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.translateKey.pubk" title="java.security.Key">pubk</a><span class="delimiter">)</span>
    <a href="package.scala.html#play.api.libs.ws.ssl.package.foldVersion" title="(run16: =&gt; java.security.Key, runHigher: =&gt; java.security.Key)java.security.Key">foldVersion</a><span class="delimiter">(</span>
      run16 = <span class="delimiter">{</span>
        <a href="#play.api.libs.ws.ssl.Algorithms.translateKey.keyAlgName" title="String">keyAlgName</a> <span title="java.security.Key" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="String(&quot;EC&quot;)" class="string">&quot;EC&quot;</span> =&gt;
            <span class="comment">// If we are on 1.6, then we can't use the EC factory and have to pull it directly.</span>
            <a href="#play.api.libs.ws.ssl.Algorithms.translateECKey" title="(pubk: java.security.Key)java.security.Key">translateECKey</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.translateKey.pubk" title="java.security.Key">pubk</a><span class="delimiter">)</span>
          <span class="keyword">case</span> _ =&gt;
            <span class="keyword">val</span> <span title="java.security.KeyFactory">keyFactory</span> = <span title="java.security.KeyFactory.type">KeyFactory</span>.<span title="(x$1: String)java.security.KeyFactory">getInstance</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.translateKey.keyAlgName" title="String">keyAlgName</a><span class="delimiter">)</span>
            <span title="java.security.KeyFactory">keyFactory</span>.<span title="(x$1: java.security.Key)java.security.Key">translateKey</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.translateKey.pubk" title="java.security.Key">pubk</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>,
      runHigher = <span class="delimiter">{</span>
        <span class="keyword">val</span> <span title="java.security.KeyFactory">keyFactory</span> = <span title="java.security.KeyFactory.type">KeyFactory</span>.<span title="(x$1: String)java.security.KeyFactory">getInstance</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.translateKey.keyAlgName" title="String">keyAlgName</a><span class="delimiter">)</span>
        <span title="java.security.KeyFactory">keyFactory</span>.<span title="(x$1: java.security.Key)java.security.Key">translateKey</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.translateKey.pubk" title="java.security.Key">pubk</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pubk: java.security.Key)java.security.Key" id="play.api.libs.ws.ssl.Algorithms.translateECKey">translateECKey</a><span class="delimiter">(</span><a title="java.security.Key" id="play.api.libs.ws.ssl.Algorithms.translateECKey.pubk">pubk</a>: <span title="java.security.Key">Key</span><span class="delimiter">)</span>: <span title="java.security.Key">Key</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Class[_]" id="play.api.libs.ws.ssl.Algorithms.translateECKey.keyFactory">keyFactory</a> = <span title="Thread.type">Thread</span>.<span title="()Thread">currentThread</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()ClassLoader">getContextClassLoader</span>.<span title="(x$1: String)Class[_]">loadClass</span><span class="delimiter">(</span><span title="String(&quot;sun.security.ec.ECKeyFactory&quot;)" class="string">&quot;sun.security.ec.ECKeyFactory&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="play.api.libs.ws.ssl.Algorithms.translateECKey.method">method</a> = <a href="#play.api.libs.ws.ssl.Algorithms.translateECKey.keyFactory" title="Class[_]">keyFactory</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;toECKey&quot;)" class="string">&quot;toECKey&quot;</span>, classOf<span title="Class[java.security.Key](classOf[java.security.Key])" class="delimiter">[</span>java.security.Key<span class="delimiter">]</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl.Algorithms.translateECKey.method" title="java.lang.reflect.Method">method</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <a href="#play.api.libs.ws.ssl.Algorithms.translateECKey.pubk" title="java.security.Key">pubk</a><span class="delimiter">)</span> <span title="java.security.Key" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="java.security.interfaces.ECPublicKey">e</span>: <span title="java.security.interfaces.ECPublicKey">ECPublicKey</span> =&gt;
        <span title="java.security.interfaces.ECPublicKey">e</span>
      <span class="keyword">case</span> <span title="java.security.interfaces.ECPrivateKey">e</span>: <span title="java.security.interfaces.ECPrivateKey">ECPrivateKey</span> =&gt;
        <span title="java.security.interfaces.ECPrivateKey">e</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Decompose the standard algorithm name into sub-elements.
   * &lt;p/&gt;
   * For example, we need to decompose &quot;SHA1WithRSA&quot; into &quot;SHA1&quot; and &quot;RSA&quot;
   * so that we can check the &quot;SHA1&quot; and &quot;RSA&quot; algorithm constraints
   * separately.
   * &lt;p/&gt;
   * Please override the method if need to support more name pattern.
   */</span>
  <span class="keyword">def</span> <a title="(algorithm: String)Set[String]" id="play.api.libs.ws.ssl.Algorithms.decomposes">decomposes</a><span class="delimiter">(</span><a title="String" id="play.api.libs.ws.ssl.Algorithms.decomposes.algorithm">algorithm</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Set[String]">Set</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.decomposes.algorithm" title="String">algorithm</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <span title="(x: Boolean)Boolean">||</span> <a href="#play.api.libs.ws.ssl.Algorithms.decomposes.algorithm" title="String">algorithm</a>.<span title="()Int">length</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="String(&quot;Null or blank algorithm found!&quot;)" class="string">&quot;Null or blank algorithm found!&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="play.api.libs.ws.ssl.Algorithms.decomposes.withAndPattern">withAndPattern</a> = <span title="scala.util.matching.Regex" class="keyword">new</span> scala.util.matching.<span title="scala.util.matching.Regex">Regex</span><span class="delimiter">(</span><span title="String(&quot;(?i)with|and&quot;)" class="string">&quot;(?i)with|and&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Array[String]" id="play.api.libs.ws.ssl.Algorithms.decomposes.tokens">tokens</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;/&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>.<span title="(toSplit: CharSequence)Array[String]">split</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.decomposes.algorithm" title="String">algorithm</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Set[String]" id="play.api.libs.ws.ssl.Algorithms.decomposes.elements">elements</a> = <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="String" id="play.api.libs.ws.ssl.Algorithms.decomposes.elements.$anonfun.t">t</a> &lt;- <a href="#play.api.libs.ws.ssl.Algorithms.decomposes.tokens" title="(f: String =&gt; scala.collection.GenTraversableOnce[String])(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],String,Array[String]])Array[String]">tokens</a>
      <a title="String" id="play.api.libs.ws.ssl.Algorithms.decomposes.elements.$anonfun.$anonfun.name">name</a> &lt;- <a href="#play.api.libs.ws.ssl.Algorithms.decomposes.withAndPattern" title="scala.util.matching.Regex">withAndPattern</a>.<span title="(toSplit: CharSequence)Array[String]">split</span><span title="(f: String =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],String,Array[String]])Array[String]" class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.decomposes.elements.$anonfun.t" title="String">t</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <a href="#play.api.libs.ws.ssl.Algorithms.decomposes.elements.$anonfun.$anonfun.name" title="String">name</a>
    <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[String]">toSet</span>

    <span title="scala.collection.immutable.Set[String]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.decomposes.elements" title="scala.collection.immutable.Set[String]">elements</a>.<span title="(elem: String)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;SHA1&quot;)" class="string">&quot;SHA1&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#play.api.libs.ws.ssl.Algorithms.decomposes.elements" title="scala.collection.immutable.Set[String]">elements</a>.<span title="(elem: String)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;SHA-1&quot;)" class="string">&quot;SHA-1&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#play.api.libs.ws.ssl.Algorithms.decomposes.elements" title="scala.collection.immutable.Set[String]">elements</a> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <span title="String(&quot;SHA-1&quot;)" class="string">&quot;SHA-1&quot;</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="scala.collection.immutable.Set[String]" class="keyword">if</span> <span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.Algorithms.decomposes.elements" title="scala.collection.immutable.Set[String]">elements</a>.<span title="(elem: String)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;SHA-1&quot;)" class="string">&quot;SHA-1&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#play.api.libs.ws.ssl.Algorithms.decomposes.elements" title="scala.collection.immutable.Set[String]">elements</a>.<span title="(elem: String)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;SHA1&quot;)" class="string">&quot;SHA1&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#play.api.libs.ws.ssl.Algorithms.decomposes.elements" title="scala.collection.immutable.Set[String]">elements</a> <span title="(elem: String)scala.collection.immutable.Set[String]">+</span> <span title="String(&quot;SHA1&quot;)" class="string">&quot;SHA1&quot;</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#play.api.libs.ws.ssl.Algorithms.decomposes.elements" title="scala.collection.immutable.Set[String]">elements</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class ExpressionSymbol extends AnyRef" id="play.api.libs.ws.ssl;ExpressionSymbol">ExpressionSymbol</a> <a href="#play.api.libs.ws.ssl;ExpressionSymbol" title="play.api.libs.ws.ssl.ExpressionSymbol" class="delimiter">{</a>
  <span class="keyword">def</span> <a title="(actualKeySize: Int)Boolean" id="play.api.libs.ws.ssl;ExpressionSymbol.matches">matches</a><span class="delimiter">(</span><a title="Int" id="play.api.libs.ws.ssl;ExpressionSymbol.matches.actualKeySize">actualKeySize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">case class</span> <a title="class LessThan extends play.api.libs.ws.ssl.ExpressionSymbol with Product with Serializable" id="play.api.libs.ws.ssl.LessThan.readResolve">LessThan</a><a href="#play.api.libs.ws.ssl.LessThan.readResolve" title="Product" class="delimiter">(</a><a title="Int" id="play.api.libs.ws.ssl;LessThan.x">x</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.api.libs.ws.ssl;ExpressionSymbol" title="play.api.libs.ws.ssl.ExpressionSymbol">ExpressionSymbol</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(actualKeySize: Int)Boolean" id="play.api.libs.ws.ssl;LessThan.matches">matches</a><span class="delimiter">(</span><a title="Int" id="play.api.libs.ws.ssl;LessThan.matches.actualKeySize">actualKeySize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#play.api.libs.ws.ssl;LessThan.matches.actualKeySize" title="Int">actualKeySize</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#play.api.libs.ws.ssl;LessThan.x" title="=&gt; Int">x</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="play.api.libs.ws.ssl;LessThan.toString">toString</a> = <span title="String(&quot; keySize &lt; &quot;)" class="string">&quot; keySize &lt; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.libs.ws.ssl;LessThan.x" title="=&gt; Int">x</a>
<span class="delimiter">}</span>

<span class="keyword">case class</span> <a title="class LessThanOrEqual extends play.api.libs.ws.ssl.ExpressionSymbol with Product with Serializable" id="play.api.libs.ws.ssl.LessThanOrEqual.readResolve">LessThanOrEqual</a><a href="#play.api.libs.ws.ssl.LessThanOrEqual.readResolve" title="Product" class="delimiter">(</a><a title="Int" id="play.api.libs.ws.ssl;LessThanOrEqual.x">x</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.api.libs.ws.ssl;ExpressionSymbol" title="play.api.libs.ws.ssl.ExpressionSymbol">ExpressionSymbol</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(actualKeySize: Int)Boolean" id="play.api.libs.ws.ssl;LessThanOrEqual.matches">matches</a><span class="delimiter">(</span><a title="Int" id="play.api.libs.ws.ssl;LessThanOrEqual.matches.actualKeySize">actualKeySize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#play.api.libs.ws.ssl;LessThanOrEqual.matches.actualKeySize" title="Int">actualKeySize</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#play.api.libs.ws.ssl;LessThanOrEqual.x" title="=&gt; Int">x</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="play.api.libs.ws.ssl;LessThanOrEqual.toString">toString</a> = <span title="String(&quot; keySize &lt;= &quot;)" class="string">&quot; keySize &lt;= &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.libs.ws.ssl;LessThanOrEqual.x" title="=&gt; Int">x</a>
<span class="delimiter">}</span>

<span class="keyword">case class</span> <a title="class NotEqual extends play.api.libs.ws.ssl.ExpressionSymbol with Product with Serializable" id="play.api.libs.ws.ssl.NotEqual.readResolve">NotEqual</a><a href="#play.api.libs.ws.ssl.NotEqual.readResolve" title="Product" class="delimiter">(</a><a title="Int" id="play.api.libs.ws.ssl;NotEqual.x">x</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.api.libs.ws.ssl;ExpressionSymbol" title="play.api.libs.ws.ssl.ExpressionSymbol">ExpressionSymbol</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(actualKeySize: Int)Boolean" id="play.api.libs.ws.ssl;NotEqual.matches">matches</a><span class="delimiter">(</span><a title="Int" id="play.api.libs.ws.ssl;NotEqual.matches.actualKeySize">actualKeySize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#play.api.libs.ws.ssl;NotEqual.matches.actualKeySize" title="Int">actualKeySize</a> <span title="(x: Int)Boolean">!=</span> <a href="#play.api.libs.ws.ssl;NotEqual.x" title="=&gt; Int">x</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="play.api.libs.ws.ssl;NotEqual.toString">toString</a> = <span title="String(&quot; keySize != &quot;)" class="string">&quot; keySize != &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.libs.ws.ssl;NotEqual.x" title="=&gt; Int">x</a>
<span class="delimiter">}</span>

<span class="keyword">case class</span> <a title="class Equal extends play.api.libs.ws.ssl.ExpressionSymbol with Product with Serializable" id="play.api.libs.ws.ssl.Equal.readResolve">Equal</a><a href="#play.api.libs.ws.ssl.Equal.readResolve" title="Product" class="delimiter">(</a><a title="Int" id="play.api.libs.ws.ssl;Equal.x">x</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.api.libs.ws.ssl;ExpressionSymbol" title="play.api.libs.ws.ssl.ExpressionSymbol">ExpressionSymbol</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(actualKeySize: Int)Boolean" id="play.api.libs.ws.ssl;Equal.matches">matches</a><span class="delimiter">(</span><a title="Int" id="play.api.libs.ws.ssl;Equal.matches.actualKeySize">actualKeySize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#play.api.libs.ws.ssl;Equal.matches.actualKeySize" title="Int">actualKeySize</a> <span title="(x: Int)Boolean">==</span> <a href="#play.api.libs.ws.ssl;Equal.x" title="=&gt; Int">x</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="play.api.libs.ws.ssl;Equal.toString">toString</a> = <span title="String(&quot; keySize ==&quot;)" class="string">&quot; keySize ==&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.libs.ws.ssl;Equal.x" title="=&gt; Int">x</a>
<span class="delimiter">}</span>

<span class="keyword">case class</span> <a title="class MoreThan extends play.api.libs.ws.ssl.ExpressionSymbol with Product with Serializable" id="play.api.libs.ws.ssl.MoreThan.readResolve">MoreThan</a><a href="#play.api.libs.ws.ssl.MoreThan.readResolve" title="Product" class="delimiter">(</a><a title="Int" id="play.api.libs.ws.ssl;MoreThan.x">x</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.api.libs.ws.ssl;ExpressionSymbol" title="play.api.libs.ws.ssl.ExpressionSymbol">ExpressionSymbol</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(actualKeySize: Int)Boolean" id="play.api.libs.ws.ssl;MoreThan.matches">matches</a><span class="delimiter">(</span><a title="Int" id="play.api.libs.ws.ssl;MoreThan.matches.actualKeySize">actualKeySize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#play.api.libs.ws.ssl;MoreThan.matches.actualKeySize" title="Int">actualKeySize</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#play.api.libs.ws.ssl;MoreThan.x" title="=&gt; Int">x</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="play.api.libs.ws.ssl;MoreThan.toString">toString</a> = <span title="String(&quot; keySize &gt; &quot;)" class="string">&quot; keySize &gt; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.libs.ws.ssl;MoreThan.x" title="=&gt; Int">x</a>
<span class="delimiter">}</span>

<span class="keyword">case class</span> <a title="class MoreThanOrEqual extends play.api.libs.ws.ssl.ExpressionSymbol with Product with Serializable" id="play.api.libs.ws.ssl.MoreThanOrEqual.readResolve">MoreThanOrEqual</a><a href="#play.api.libs.ws.ssl.MoreThanOrEqual.readResolve" title="Product" class="delimiter">(</a><a title="Int" id="play.api.libs.ws.ssl;MoreThanOrEqual.x">x</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#play.api.libs.ws.ssl;ExpressionSymbol" title="play.api.libs.ws.ssl.ExpressionSymbol">ExpressionSymbol</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(actualKeySize: Int)Boolean" id="play.api.libs.ws.ssl;MoreThanOrEqual.matches">matches</a><span class="delimiter">(</span><a title="Int" id="play.api.libs.ws.ssl;MoreThanOrEqual.matches.actualKeySize">actualKeySize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#play.api.libs.ws.ssl;MoreThanOrEqual.matches.actualKeySize" title="Int">actualKeySize</a> <span title="(x: Int)Boolean">&gt;=</span> <a href="#play.api.libs.ws.ssl;MoreThanOrEqual.x" title="=&gt; Int">x</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="play.api.libs.ws.ssl;MoreThanOrEqual.toString">toString</a> = <span title="String(&quot; keySize &gt;= &quot;)" class="string">&quot; keySize &gt;= &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#play.api.libs.ws.ssl;MoreThanOrEqual.x" title="=&gt; Int">x</a>
<span class="delimiter">}</span>

<span class="keyword">case class</span> <a title="class AlgorithmConstraint extends AnyRef with Product with Serializable" id="play.api.libs.ws.ssl.AlgorithmConstraint.readResolve">AlgorithmConstraint</a><a href="#play.api.libs.ws.ssl.AlgorithmConstraint.readResolve" title="Product" class="delimiter">(</a><a title="String" id="play.api.libs.ws.ssl;AlgorithmConstraint.algorithm">algorithm</a>: <span title="String">String</span>, <a title="Option[play.api.libs.ws.ssl.ExpressionSymbol]" id="play.api.libs.ws.ssl.AlgorithmConstraint.apply$default$2">constraint</a>: <span title="Option[play.api.libs.ws.ssl.ExpressionSymbol]">Option</span><span class="delimiter">[</span>ExpressionSymbol<span class="delimiter">]</span> = <span title="None.type">None</span><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="comment">/**
   * Returns true only if the algorithm matches.  Useful for signature algorithms where we don't care about key size.
   */</span>
  <span class="keyword">def</span> <a title="(algorithm: String)Boolean" id="play.api.libs.ws.ssl;AlgorithmConstraint.matches(0945b1969a)">matches</a><span class="delimiter">(</span><a title="String" id="play.api.libs.ws.ssl;AlgorithmConstraint.matches(0945b1969a).algorithm">algorithm</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <a href="#play.api.libs.ws.ssl.AlgorithmConstraint.readResolve" title="AlgorithmConstraint.this.type" class="keyword">this</a>.<a href="#play.api.libs.ws.ssl;AlgorithmConstraint.algorithm" title="=&gt; String">algorithm</a>.<span title="(x$1: String)Boolean">equalsIgnoreCase</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;AlgorithmConstraint.matches(0945b1969a).algorithm" title="String">algorithm</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns true if the algorithm name matches, and if there's a keySize constraint, will match on that as well.
   */</span>
  <span class="keyword">def</span> <a title="(algorithm: String, keySize: Int)Boolean" id="play.api.libs.ws.ssl;AlgorithmConstraint.matches(0a891f0cc7)">matches</a><span class="delimiter">(</span><a title="String" id="play.api.libs.ws.ssl;AlgorithmConstraint.matches(0a891f0cc7).algorithm">algorithm</a>: <span title="String">String</span>, <a title="Int" id="play.api.libs.ws.ssl;AlgorithmConstraint.matches(0a891f0cc7).keySize">keySize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#play.api.libs.ws.ssl;AlgorithmConstraint.matches(0945b1969a)" title="(algorithm: String)Boolean">matches</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;AlgorithmConstraint.matches(0a891f0cc7).algorithm" title="String">algorithm</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Nothing" class="keyword">return</span> <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span>

    <a href="#play.api.libs.ws.ssl.AlgorithmConstraint.apply$default$2" title="=&gt; Option[play.api.libs.ws.ssl.ExpressionSymbol]">constraint</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><a title="play.api.libs.ws.ssl.ExpressionSymbol" id="play.api.libs.ws.ssl;AlgorithmConstraint.matches(0a891f0cc7).expression">expression</a><span class="delimiter">)</span> =&gt;
        <a href="#play.api.libs.ws.ssl;AlgorithmConstraint.matches(0a891f0cc7).expression" title="play.api.libs.ws.ssl.ExpressionSymbol">expression</a>.<a href="#play.api.libs.ws.ssl;ExpressionSymbol.matches" title="(actualKeySize: Int)Boolean">matches</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;AlgorithmConstraint.matches(0a891f0cc7).keySize" title="Int">keySize</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="None.type">None</span> =&gt;
        <span title="Boolean(true)" class="keyword">true</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="play.api.libs.ws.ssl;AlgorithmConstraint.toString">toString</a> = <span class="delimiter">{</span>
    <a href="#play.api.libs.ws.ssl;AlgorithmConstraint.algorithm" title="=&gt; String">algorithm</a> <span title="(x$1: Any)String">+</span> <a href="#play.api.libs.ws.ssl.AlgorithmConstraint.apply$default$2" title="=&gt; Option[play.api.libs.ws.ssl.ExpressionSymbol]">constraint</a>.<span title="(default: =&gt; Object)Object">getOrElse</span><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Parser based on the jdk.certpath.disabledAlgorithm BNF.
 *
 * @see http://sim.ivi.co/2011/07/java-se-7-release-security-enhancements.html
 */</span>
<span class="keyword">object</span> <a title="play.api.libs.ws.ssl.AlgorithmConstraintsParser.type" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser">AlgorithmConstraintsParser</a> <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser" title="play.api.libs.ws.ssl.AlgorithmConstraintsParser.type" class="keyword">extends</a> <span title="scala.util.parsing.combinator.RegexParsers">RegexParsers</span> <span class="delimiter">{</span>

  <span class="keyword">import</span> scala.<span title="language.type">language</span>.postfixOps

  <span class="keyword">def</span> <a title="(input: String)List[play.api.libs.ws.ssl.AlgorithmConstraint]" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.apply">apply</a><span class="delimiter">(</span><a title="String" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.apply.input">input</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="List[play.api.libs.ws.ssl.AlgorithmConstraint]">List</span><span class="delimiter">[</span>AlgorithmConstraint<span class="delimiter">]</span> = <span title="(p: play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[List[play.api.libs.ws.ssl.AlgorithmConstraint]], in: CharSequence)play.api.libs.ws.ssl.AlgorithmConstraintsParser.ParseResult[List[play.api.libs.ws.ssl.AlgorithmConstraint]]">parseAll</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.line" title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[List[play.api.libs.ws.ssl.AlgorithmConstraint]]">line</a>, <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.apply.input" title="String">input</a><span class="delimiter">)</span> <span title="List[play.api.libs.ws.ssl.AlgorithmConstraint]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> Success<span class="delimiter">(</span><a title="List[play.api.libs.ws.ssl.AlgorithmConstraint]" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.apply.result">result</a>, _<span class="delimiter">)</span> =&gt;
      <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.apply.result" title="List[play.api.libs.ws.ssl.AlgorithmConstraint]">result</a>
    <span class="keyword">case</span> <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.apply.<unapply-selector>" title="(x: play.api.libs.ws.ssl.AlgorithmConstraintsParser.ParseResult[List[play.api.libs.ws.ssl.AlgorithmConstraint]])Option[(String, play.api.libs.ws.ssl.AlgorithmConstraintsParser.Input)]">NoSuccess</a><span class="delimiter">(</span><a title="String" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.apply.message">message</a>, _<span class="delimiter">)</span> =&gt;
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Cannot parse string &quot;)">Cannot parse string $</span><a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.apply.input" title="String">input</a><span title="String(&quot;: &quot;)">: $</span><a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.apply.message" title="String">message</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[List[play.api.libs.ws.ssl.AlgorithmConstraint]]" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.line">line</a>: <span title="play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[List[play.api.libs.ws.ssl.AlgorithmConstraint]]">Parser</span><span class="delimiter">[</span>List<span class="delimiter">[</span>AlgorithmConstraint<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="(p: =&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.AlgorithmConstraint], q: =&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[Any])play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[List[play.api.libs.ws.ssl.AlgorithmConstraint]]">repsep</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.expression" title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.AlgorithmConstraint]">expression</a>, <span title="implicit scala.util.parsing.combinator.RegexParsers.literal : (s: String)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]" class="string">&quot;,&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.AlgorithmConstraint]" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.expression">expression</a>: <span title="play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.AlgorithmConstraint]">Parser</span><span class="delimiter">[</span>AlgorithmConstraint<span class="delimiter">]</span> = <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.algorithm" title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">algorithm</a> <span title="(q: =&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[Option[play.api.libs.ws.ssl.ExpressionSymbol]])play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.AlgorithmConstraintsParser.~[String,Option[play.api.libs.ws.ssl.ExpressionSymbol]]]">~</span> <span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.keySizeConstraint" title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.ExpressionSymbol]">keySizeConstraint</a> <span title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[Option[play.api.libs.ws.ssl.ExpressionSymbol]]">?</span><span class="delimiter">)</span> <span title="(f: play.api.libs.ws.ssl.AlgorithmConstraintsParser.~[String,Option[play.api.libs.ws.ssl.ExpressionSymbol]] =&gt; play.api.libs.ws.ssl.AlgorithmConstraint)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.AlgorithmConstraint]">^^</span> <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.expression.$anonfun.x0$1" title="play.api.libs.ws.ssl.AlgorithmConstraint" class="delimiter">{</a>
    <span class="keyword">case</span> <span title="String">algorithm</span> ~ Some<span class="delimiter">(</span><a title="play.api.libs.ws.ssl.ExpressionSymbol" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.expression.$anonfun.constraint">constraint</a><span class="delimiter">)</span> =&gt;
      <a href="#play.api.libs.ws.ssl.AlgorithmConstraint.readResolve" title="(algorithm: String, constraint: Option[play.api.libs.ws.ssl.ExpressionSymbol])play.api.libs.ws.ssl.AlgorithmConstraint">AlgorithmConstraint</a><span class="delimiter">(</span><span title="String">algorithm</span>, <span title="(x: play.api.libs.ws.ssl.ExpressionSymbol)Some[play.api.libs.ws.ssl.ExpressionSymbol]">Some</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.expression.$anonfun.constraint" title="play.api.libs.ws.ssl.ExpressionSymbol">constraint</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <span title="String">algorithm</span> ~ <span title="None.type">None</span> =&gt;
      <a href="#play.api.libs.ws.ssl.AlgorithmConstraint.readResolve" title="(algorithm: String, constraint: Option[play.api.libs.ws.ssl.ExpressionSymbol])play.api.libs.ws.ssl.AlgorithmConstraint">AlgorithmConstraint</a><span class="delimiter">(</span><span title="String">algorithm</span>, <span title="None.type">None</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.ExpressionSymbol]" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.keySizeConstraint">keySizeConstraint</a>: <span title="play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.ExpressionSymbol]">Parser</span><span class="delimiter">[</span>ExpressionSymbol<span class="delimiter">]</span> = <span title="implicit scala.util.parsing.combinator.RegexParsers.literal : (s: String)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]" class="string">&quot;keySize&quot;</span> <span title="(q: =&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String])play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">~&gt;</span> <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.operator" title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">operator</a> <span title="(q: =&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[Int])play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.AlgorithmConstraintsParser.~[String,Int]]">~</span> <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.decimalInteger" title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[Int]">decimalInteger</a> <span title="(f: play.api.libs.ws.ssl.AlgorithmConstraintsParser.~[String,Int] =&gt; play.api.libs.ws.ssl.ExpressionSymbol)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[play.api.libs.ws.ssl.ExpressionSymbol]">^^</span> <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.keySizeConstraint.$anonfun.x0$2" title="play.api.libs.ws.ssl.ExpressionSymbol" class="delimiter">{</a>
    <span class="keyword">case</span> <span title="String(&quot;&lt;=&quot;)" class="string">&quot;&lt;=&quot;</span> ~ <span title="Int">decimal</span> =&gt;
      <a href="#play.api.libs.ws.ssl.LessThanOrEqual.readResolve" title="(x: Int)play.api.libs.ws.ssl.LessThanOrEqual">LessThanOrEqual</a><span class="delimiter">(</span><span title="Int">decimal</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <span title="String(&quot;&lt;&quot;)" class="string">&quot;&lt;&quot;</span> ~ <span title="Int">decimal</span> =&gt;
      <a href="#play.api.libs.ws.ssl.LessThan.readResolve" title="(x: Int)play.api.libs.ws.ssl.LessThan">LessThan</a><span class="delimiter">(</span><span title="Int">decimal</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <span title="String(&quot;==&quot;)" class="string">&quot;==&quot;</span> ~ <span title="Int">decimal</span> =&gt;
      <a href="#play.api.libs.ws.ssl.Equal.readResolve" title="(x: Int)play.api.libs.ws.ssl.Equal">Equal</a><span class="delimiter">(</span><span title="Int">decimal</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <span title="String(&quot;!=&quot;)" class="string">&quot;!=&quot;</span> ~ <span title="Int">decimal</span> =&gt;
      <a href="#play.api.libs.ws.ssl.NotEqual.readResolve" title="(x: Int)play.api.libs.ws.ssl.NotEqual">NotEqual</a><span class="delimiter">(</span><span title="Int">decimal</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <span title="String(&quot;&gt;=&quot;)" class="string">&quot;&gt;=&quot;</span> ~ <span title="Int">decimal</span> =&gt;
      <a href="#play.api.libs.ws.ssl.MoreThanOrEqual.readResolve" title="(x: Int)play.api.libs.ws.ssl.MoreThanOrEqual">MoreThanOrEqual</a><span class="delimiter">(</span><span title="Int">decimal</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <span title="String(&quot;&gt;&quot;)" class="string">&quot;&gt;&quot;</span> ~ <span title="Int">decimal</span> =&gt;
      <a href="#play.api.libs.ws.ssl.MoreThan.readResolve" title="(x: Int)play.api.libs.ws.ssl.MoreThan">MoreThan</a><span class="delimiter">(</span><span title="Int">decimal</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.operator">operator</a>: <span title="play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">Parser</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="implicit scala.util.parsing.combinator.RegexParsers.literal : (s: String)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]" class="string">&quot;&lt;=&quot;</span> <span title="(q: =&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String])play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">|</span> <span title="implicit scala.util.parsing.combinator.RegexParsers.literal : (s: String)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]" class="string">&quot;&lt;&quot;</span> <span title="(q: =&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String])play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">|</span> <span title="implicit scala.util.parsing.combinator.RegexParsers.literal : (s: String)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]" class="string">&quot;==&quot;</span> <span title="(q: =&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String])play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">|</span> <span title="implicit scala.util.parsing.combinator.RegexParsers.literal : (s: String)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]" class="string">&quot;!=&quot;</span> <span title="(q: =&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String])play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">|</span> <span title="implicit scala.util.parsing.combinator.RegexParsers.literal : (s: String)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]" class="string">&quot;&gt;=&quot;</span> <span title="(q: =&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String])play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">|</span> <span title="implicit scala.util.parsing.combinator.RegexParsers.literal : (s: String)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]" class="string">&quot;&gt;&quot;</span>

  <span class="keyword">def</span> <a title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[Int]" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.decimalInteger">decimalInteger</a>: <span title="play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[Int]">Parser</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;\d+&quot;&quot;&quot;</span>.<span title="implicit scala.util.parsing.combinator.RegexParsers.regex : (r: scala.util.matching.Regex)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">r</span> <span title="(f: String =&gt; Int)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[Int]">^^</span> <span class="delimiter">{</span>
    <a title="String" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.decimalInteger.$anonfun.f">f</a> =&gt; <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.decimalInteger.$anonfun.f" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">f</a>.<span title="=&gt; Int">toInt</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.algorithm">algorithm</a>: <span title="play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">Parser</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;\w+&quot;&quot;&quot;</span>.<span title="implicit scala.util.parsing.combinator.RegexParsers.regex : (r: scala.util.matching.Regex)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">r</span> <span title="(f: String =&gt; String)play.api.libs.ws.ssl.AlgorithmConstraintsParser.Parser[String]">^^</span> <span class="delimiter">{</span>
    <a title="String" id="play.api.libs.ws.ssl.AlgorithmConstraintsParser.algorithm.$anonfun.f">f</a> =&gt; <a href="#play.api.libs.ws.ssl.AlgorithmConstraintsParser.algorithm.$anonfun.f" title="String">f</a>.<span title="()String">toString</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>


        </pre>
    </body>
</html>

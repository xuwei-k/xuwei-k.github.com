<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>play-ws/play/api/libs/ws/ssl/CompositeX509TrustManager.scala</title>
        <script type="text/javascript" src="../../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 *
 *  * Copyright (C) 2009-2013 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 *
 */</span>
<span class="keyword">package</span> play.api.libs.ws.ssl

<span class="keyword">import</span> javax.net.ssl.X509TrustManager
<span class="keyword">import</span> java.security.cert._
<span class="keyword">import</span> scala.collection.mutable.ArrayBuffer
<span class="keyword">import</span> scala.util.control.NonFatal
<span class="keyword">import</span> java.security.GeneralSecurityException

<span class="comment">/**
 * A trust manager that is a composite of several smaller trust managers.   It is responsible for verifying the
 * credentials received from a peer.
 */</span>
<span class="keyword">class</span> <a title="class CompositeX509TrustManager extends Object with javax.net.ssl.X509TrustManager" id="play.api.libs.ws.ssl;CompositeX509TrustManager">CompositeX509TrustManager</a><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager" title="play.api.libs.ws.ssl.CompositeX509TrustManager" class="delimiter">(</a><a title="Seq[javax.net.ssl.X509TrustManager]" id="play.api.libs.ws.ssl;CompositeX509TrustManager.trustManagers">trustManagers</a>: <span title="Seq[javax.net.ssl.X509TrustManager]">Seq</span><span class="delimiter">[</span>X509TrustManager<span class="delimiter">]</span>, <a title="play.api.libs.ws.ssl.AlgorithmChecker" id="play.api.libs.ws.ssl;CompositeX509TrustManager.algorithmChecker">algorithmChecker</a>: <a href="AlgorithmChecker.scala.html#play.api.libs.ws.ssl;AlgorithmChecker" title="play.api.libs.ws.ssl.AlgorithmChecker">AlgorithmChecker</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="javax.net.ssl.X509TrustManager">X509TrustManager</span> <span class="delimiter">{</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="org.slf4j.Logger" id="play.api.libs.ws.ssl;CompositeX509TrustManager.logger">logger</a> = org.slf4j.<span title="org.slf4j.LoggerFactory.type">LoggerFactory</span>.<span title="(x$1: Class[_])org.slf4j.Logger">getLogger</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager" title="()Class[_]">getClass</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="()Array[java.security.cert.X509Certificate]" id="play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers">getAcceptedIssuers</a>: <span title="Array[java.security.cert.X509Certificate]">Array</span><span class="delimiter">[</span>X509Certificate<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.logger" title="=&gt; org.slf4j.Logger">logger</a>.<span title="(x$1: String)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;getAcceptedIssuers: &quot;)" class="string">&quot;getAcceptedIssuers: &quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[java.security.cert.X509Certificate]" id="play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.certificates">certificates</a> = <span title="[A](elems: A*)scala.collection.mutable.ArrayBuffer[A]">ArrayBuffer</span><span title="(elems: java.security.cert.X509Certificate*)scala.collection.mutable.ArrayBuffer[java.security.cert.X509Certificate]" class="delimiter">[</span><span title="java.security.cert.X509Certificate">X509Certificate</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Seq[Throwable]" id="play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.exceptionList">exceptionList</a> = <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers" title="(block: javax.net.ssl.X509TrustManager =&gt; Unit)Seq[Throwable]">withTrustManagers</a> <span class="delimiter">{</span>
      <a title="javax.net.ssl.X509TrustManager" id="play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.exceptionList.$anonfun.trustManager">trustManager</a> =&gt;
        <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.certificates" title="scala.collection.mutable.ArrayBuffer[java.security.cert.X509Certificate]">certificates</a>.<span title="(xs: scala.collection.TraversableOnce[java.security.cert.X509Certificate])Unit">appendAll</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.exceptionList.$anonfun.trustManager" title="javax.net.ssl.X509TrustManager">trustManager</a>.<span title="(xs: Array[java.security.cert.X509Certificate])scala.collection.mutable.ArrayOps[java.security.cert.X509Certificate]">getAcceptedIssuers</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="comment">// getAcceptedIssuers should never throw an exception.</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.exceptionList" title="Seq[Throwable]">exceptionList</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.msg">msg</a> = <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.exceptionList" title="(idx: Int)Throwable">exceptionList</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="()String">getMessage</span>
      <span title="Nothing" class="keyword">throw</span> <span title="play.api.libs.ws.ssl.CompositeCertificateException" class="keyword">new</span> <a href="CompositeCertificateException.scala.html#play.api.libs.ws.ssl;CompositeCertificateException" title="play.api.libs.ws.ssl.CompositeCertificateException">CompositeCertificateException</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.msg" title="String">msg</a>, <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.exceptionList" title="Seq[Throwable]">exceptionList</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[Throwable])Array[Throwable]">toArray</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.getAcceptedIssuers.certificates" title="scala.collection.mutable.ArrayBuffer[java.security.cert.X509Certificate]">certificates</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[java.security.cert.X509Certificate])Array[java.security.cert.X509Certificate]">toArray</span>
  <span class="delimiter">}</span>

  <span class="comment">// In 1.6, sun.security.ssl.X509TrustManagerImpl extends from com.sun.net.ssl.internal.ssl.X509ExtendedTrustManager</span>
  <span class="comment">// In 1.7, sun.security.ssl.X509TrustManagerImpl extends from javax.net.ssl.X509ExtendedTrustManager.</span>
  <span class="comment">// The two X509ExtendedTrustManager contain different method signatures, and both are available in 1.7, which means</span>
  <span class="comment">// it's really hard to keep something backwards compatible if something is calling trustManager.asInstanceOf[X509ExtendedTrustManager]</span>
  <span class="comment">// internally.  For now, we have to trust that the internal API holds to the X509TrustManager interface.</span>
  <span class="comment">//</span>
  <span class="comment">//def checkClientTrusted(chain: Array[X509Certificate], authType: String, hostname: String, algorithm: String): Unit = ???</span>
  <span class="comment">//def checkServerTrusted(chain: Array[X509Certificate], authType: String, hostname: String, algorithm: String): Unit = ???</span>

  <span class="keyword">def</span> <a title="(chain: Array[java.security.cert.X509Certificate], authType: String)Unit" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted">checkClientTrusted</a><span class="delimiter">(</span><a title="Array[java.security.cert.X509Certificate]" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.chain">chain</a>: <span title="Array[java.security.cert.X509Certificate]">Array</span><span class="delimiter">[</span>X509Certificate<span class="delimiter">]</span>, <a title="String" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.authType">authType</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.logger" title="=&gt; org.slf4j.Logger">logger</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Object])Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;checkClientTrusted: chain = {}&quot;)" class="string">&quot;checkClientTrusted: chain = {}&quot;</span>, <a href="package.scala.html#play.api.libs.ws.ssl.package.debugChain" title="(chain: Array[java.security.cert.X509Certificate])Seq[String]">debugChain</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.chain" title="Array[java.security.cert.X509Certificate]">chain</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="java.security.cert.TrustAnchor" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.anchor">anchor</a>: <span title="java.security.cert.TrustAnchor">TrustAnchor</span> = <span title="java.security.cert.TrustAnchor" class="keyword">new</span> <span title="java.security.cert.TrustAnchor">TrustAnchor</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.chain" title="(i: Int)java.security.cert.X509Certificate">chain</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.chain" title="Array[java.security.cert.X509Certificate]">chain</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.logger" title="=&gt; org.slf4j.Logger">logger</a>.<span title="(x$1: String)Unit">debug</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;checkClientTrusted: checking key size only on root anchor &quot;)">checkClientTrusted: checking key size only on root anchor $</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.anchor" title="java.security.cert.TrustAnchor">anchor</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.algorithmChecker" title="play.api.libs.ws.ssl.AlgorithmChecker">algorithmChecker</a>.<a href="AlgorithmChecker.scala.html#play.api.libs.ws.ssl;AlgorithmChecker.checkKeyAlgorithms" title="(x509Cert: java.security.cert.X509Certificate)Unit">checkKeyAlgorithms</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.anchor" title="java.security.cert.TrustAnchor">anchor</a>.<span title="()java.security.cert.X509Certificate">getTrustedCert</span><span class="delimiter">)</span>

    <span class="keyword">var</span> <a title="Boolean" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.trusted">trusted</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">val</span> <a title="Seq[Throwable]" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.exceptionList">exceptionList</a> = <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers" title="(block: javax.net.ssl.X509TrustManager =&gt; Unit)Seq[Throwable]">withTrustManagers</a> <span class="delimiter">{</span>
      <a title="javax.net.ssl.X509TrustManager" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.exceptionList.$anonfun.trustManager">trustManager</a> =&gt;
        <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.exceptionList.$anonfun.trustManager" title="javax.net.ssl.X509TrustManager">trustManager</a>.<span title="(x$1: Array[java.security.cert.X509Certificate], x$2: String)Unit">checkClientTrusted</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.chain" title="Array[java.security.cert.X509Certificate]">chain</a>, <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.authType" title="String">authType</a><span class="delimiter">)</span>
        <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.logger" title="=&gt; org.slf4j.Logger">logger</a>.<span title="(x$1: String)Unit">debug</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;checkClientTrusted: trustManager &quot;)">checkClientTrusted: trustManager $</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.exceptionList.$anonfun.trustManager" title="javax.net.ssl.X509TrustManager">trustManager</a><span title="String(&quot; found a match for &quot;)"> found a match for $</span><span class="delimiter">{</span><a href="package.scala.html#play.api.libs.ws.ssl.package.debugChain" title="(chain: Array[java.security.cert.X509Certificate])Seq[String]">debugChain</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.chain" title="Array[java.security.cert.X509Certificate]">chain</a><span class="delimiter">)</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
        <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.trusted" title="Boolean">trusted</a> = <span title="Boolean(true)" class="keyword">true</span>
    <span class="delimiter">}</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.trusted" title="Boolean">trusted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.msg">msg</a> = <span title="String(&quot;No trust manager was able to validate this certificate chain.&quot;)" class="string">&quot;No trust manager was able to validate this certificate chain.&quot;</span>
      <span title="Nothing" class="keyword">throw</span> <span title="play.api.libs.ws.ssl.CompositeCertificateException" class="keyword">new</span> <a href="CompositeCertificateException.scala.html#play.api.libs.ws.ssl;CompositeCertificateException" title="play.api.libs.ws.ssl.CompositeCertificateException">CompositeCertificateException</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.msg" title="String">msg</a>, <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkClientTrusted.exceptionList" title="Seq[Throwable]">exceptionList</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[Throwable])Array[Throwable]">toArray</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(chain: Array[java.security.cert.X509Certificate], authType: String)Unit" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted">checkServerTrusted</a><span class="delimiter">(</span><a title="Array[java.security.cert.X509Certificate]" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.chain">chain</a>: <span title="Array[java.security.cert.X509Certificate]">Array</span><span class="delimiter">[</span>X509Certificate<span class="delimiter">]</span>, <a title="String" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.authType">authType</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.logger" title="=&gt; org.slf4j.Logger">logger</a>.<span title="(x$1: String)Unit">debug</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;checkServerTrusted: chain = &quot;)">checkServerTrusted: chain = $</span><span class="delimiter">{</span><a href="package.scala.html#play.api.libs.ws.ssl.package.debugChain" title="(chain: Array[java.security.cert.X509Certificate])Seq[String]">debugChain</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.chain" title="Array[java.security.cert.X509Certificate]">chain</a><span class="delimiter">)</span><span class="delimiter">}</span><span title="String(&quot;, authType = &quot;)">, authType = $</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.authType" title="String">authType</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>

    <span class="comment">// Trust anchor is at the end of the chain... there is no way to pass a trust anchor</span>
    <span class="comment">// through to a checker in PKIXCertPathValidator.doValidate(), so the trust manager is the</span>
    <span class="comment">// last place we have access to it.</span>
    <span class="keyword">val</span> <a title="java.security.cert.TrustAnchor" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.anchor">anchor</a>: <span title="java.security.cert.TrustAnchor">TrustAnchor</span> = <span title="java.security.cert.TrustAnchor" class="keyword">new</span> <span title="java.security.cert.TrustAnchor">TrustAnchor</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.chain" title="(i: Int)java.security.cert.X509Certificate">chain</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.chain" title="Array[java.security.cert.X509Certificate]">chain</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.logger" title="=&gt; org.slf4j.Logger">logger</a>.<span title="(x$1: String)Unit">debug</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;checkServerTrusted: checking key size only on root anchor &quot;)">checkServerTrusted: checking key size only on root anchor $</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.anchor" title="java.security.cert.TrustAnchor">anchor</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.algorithmChecker" title="play.api.libs.ws.ssl.AlgorithmChecker">algorithmChecker</a>.<a href="AlgorithmChecker.scala.html#play.api.libs.ws.ssl;AlgorithmChecker.checkKeyAlgorithms" title="(x509Cert: java.security.cert.X509Certificate)Unit">checkKeyAlgorithms</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.anchor" title="java.security.cert.TrustAnchor">anchor</a>.<span title="()java.security.cert.X509Certificate">getTrustedCert</span><span class="delimiter">)</span>

    <span class="keyword">var</span> <a title="Boolean" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.trusted">trusted</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">val</span> <a title="Seq[Throwable]" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.exceptionList">exceptionList</a> = <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers" title="(block: javax.net.ssl.X509TrustManager =&gt; Unit)Seq[Throwable]">withTrustManagers</a> <span class="delimiter">{</span>
      <a title="javax.net.ssl.X509TrustManager" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.exceptionList.$anonfun.trustManager">trustManager</a> =&gt;
        <span class="comment">// always run through the trust manager before making any decisions</span>
        <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.exceptionList.$anonfun.trustManager" title="javax.net.ssl.X509TrustManager">trustManager</a>.<span title="(x$1: Array[java.security.cert.X509Certificate], x$2: String)Unit">checkServerTrusted</span><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.chain" title="Array[java.security.cert.X509Certificate]">chain</a>, <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.authType" title="String">authType</a><span class="delimiter">)</span>
        <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.logger" title="=&gt; org.slf4j.Logger">logger</a>.<span title="(x$1: String)Unit">debug</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;checkServerTrusted: trustManager &quot;)">checkServerTrusted: trustManager $</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.exceptionList.$anonfun.trustManager" title="javax.net.ssl.X509TrustManager">trustManager</a><span title="String(&quot; using authType &quot;)"> using authType $</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.authType" title="String">authType</a><span title="String(&quot; found a match for &quot;)"> found a match for $</span><span class="delimiter">{</span><a href="package.scala.html#play.api.libs.ws.ssl.package.debugChain" title="(chain: Array[java.security.cert.X509Certificate])Seq[String]">debugChain</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.chain" title="Array[java.security.cert.X509Certificate]">chain</a><span class="delimiter">)</span>.<span title="=&gt; Seq[String]">toSeq</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
        <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.trusted" title="Boolean">trusted</a> = <span title="Boolean(true)" class="keyword">true</span>
    <span class="delimiter">}</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.trusted" title="Boolean">trusted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.msg">msg</a> = <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;No trust manager was able to validate this certificate chain: # of exceptions = &quot;)">No trust manager was able to validate this certificate chain: # of exceptions = $</span><span class="delimiter">{</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.exceptionList" title="Seq[Throwable]">exceptionList</a>.<span title="=&gt; Int">size</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span>
      <span title="Nothing" class="keyword">throw</span> <span title="play.api.libs.ws.ssl.CompositeCertificateException" class="keyword">new</span> <a href="CompositeCertificateException.scala.html#play.api.libs.ws.ssl;CompositeCertificateException" title="play.api.libs.ws.ssl.CompositeCertificateException">CompositeCertificateException</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.msg" title="String">msg</a>, <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.checkServerTrusted.exceptionList" title="Seq[Throwable]">exceptionList</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[Throwable])Array[Throwable]">toArray</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(block: javax.net.ssl.X509TrustManager =&gt; Unit)Seq[Throwable]" id="play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers">withTrustManagers</a><span class="delimiter">(</span><a title="javax.net.ssl.X509TrustManager =&gt; Unit" id="play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers.block">block</a>: <span class="delimiter">(</span>X509TrustManager =&gt; Unit<span class="delimiter">)</span><span class="delimiter">)</span>: <span title="Seq[Throwable]">Seq</span><span class="delimiter">[</span>Throwable<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[Throwable]" id="play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers.exceptionList">exceptionList</a> = <span title="[A](elems: A*)scala.collection.mutable.ArrayBuffer[A]">ArrayBuffer</span><span title="(elems: Throwable*)scala.collection.mutable.ArrayBuffer[Throwable]" class="delimiter">[</span><span title="Throwable">Throwable</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.trustManagers" title="Seq[javax.net.ssl.X509TrustManager]">trustManagers</a>.<span title="(f: javax.net.ssl.X509TrustManager =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span>
      <a title="javax.net.ssl.X509TrustManager" id="play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers.$anonfun.trustManager">trustManager</a> =&gt;
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers.block" title="(v1: javax.net.ssl.X509TrustManager)Unit">block</a><span class="delimiter">(</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers.$anonfun.trustManager" title="javax.net.ssl.X509TrustManager">trustManager</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="java.security.cert.CertPathBuilderException">e</span>: <span title="java.security.cert.CertPathBuilderException">CertPathBuilderException</span> =&gt;
            <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.logger" title="=&gt; org.slf4j.Logger">logger</a>.<span title="(x$1: String, x$2: Throwable)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;No path found to certificate: this usually means the CA is not in the trust store&quot;)" class="string">&quot;No path found to certificate: this usually means the CA is not in the trust store&quot;</span>, <span title="java.security.cert.CertPathBuilderException">e</span><span class="delimiter">)</span>
            <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers.exceptionList" title="scala.collection.mutable.ArrayBuffer[Throwable]">exceptionList</a>.<span title="(elems: Throwable*)Unit">append</span><span class="delimiter">(</span><span title="java.security.cert.CertPathBuilderException">e</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="java.security.GeneralSecurityException">e</span>: <span title="java.security.GeneralSecurityException">GeneralSecurityException</span> =&gt;
            <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.logger" title="=&gt; org.slf4j.Logger">logger</a>.<span title="(x$1: String, x$2: Throwable)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;General security exception&quot;)" class="string">&quot;General security exception&quot;</span>, <span title="java.security.GeneralSecurityException">e</span><span class="delimiter">)</span>
            <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers.exceptionList" title="scala.collection.mutable.ArrayBuffer[Throwable]">exceptionList</a>.<span title="(elems: Throwable*)Unit">append</span><span class="delimiter">(</span><span title="java.security.GeneralSecurityException">e</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers.$anonfun.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><span title="Throwable">e</span><span class="delimiter">)</span> =&gt;
            <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.logger" title="=&gt; org.slf4j.Logger">logger</a>.<span title="(x$1: String, x$2: Throwable)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;Unexpected exception!&quot;)" class="string">&quot;Unexpected exception!&quot;</span>, <span title="Throwable">e</span><span class="delimiter">)</span>
            <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers.exceptionList" title="scala.collection.mutable.ArrayBuffer[Throwable]">exceptionList</a>.<span title="(elems: Throwable*)Unit">append</span><span class="delimiter">(</span><span title="Throwable">e</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.withTrustManagers.exceptionList" title="scala.collection.mutable.ArrayBuffer[Throwable]">exceptionList</a>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="play.api.libs.ws.ssl;CompositeX509TrustManager.toString">toString</a> = <span class="delimiter">{</span>
    <span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;CompositeX509TrustManager(trustManagers = [&quot;)">CompositeX509TrustManager(trustManagers = [$</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.trustManagers" title="Seq[javax.net.ssl.X509TrustManager]">trustManagers</a><span title="String(&quot;], algorithmChecker = &quot;)">], algorithmChecker = $</span><a href="#play.api.libs.ws.ssl;CompositeX509TrustManager.algorithmChecker" title="play.api.libs.ws.ssl.AlgorithmChecker">algorithmChecker</a><span title="String(&quot;)&quot;)" class="string">)&quot;</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>play/play/core/server/netty/RequestBodyHandler.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> play.core.server.netty

<span class="keyword">import</span> org.jboss.netty.buffer._
<span class="keyword">import</span> org.jboss.netty.channel._
<span class="keyword">import</span> org.jboss.netty.bootstrap._
<span class="keyword">import</span> org.jboss.netty.channel.<span title="object org.jboss.netty.channel.Channels">Channels</span>._
<span class="keyword">import</span> org.jboss.netty.handler.codec.http._
<span class="keyword">import</span> org.jboss.netty.channel.socket.nio._
<span class="keyword">import</span> org.jboss.netty.handler.stream._

<span class="keyword">import</span> org.jboss.netty.channel.group._
<span class="keyword">import</span> java.util.concurrent._

<span class="keyword">import</span> play.core._
<span class="keyword">import</span> server.Server
<span class="keyword">import</span> play.api._
<span class="keyword">import</span> play.api.mvc._
<span class="keyword">import</span> play.api.libs.iteratee._
<span class="keyword">import</span> play.api.libs.iteratee.<a href="../../../api/libs/iteratee/Iteratee.scala.html#14415" title="object play.api.libs.iteratee.Input">Input</a>._
<span class="keyword">import</span> play.api.libs.concurrent._

<span class="keyword">import</span> scala.collection.<span title="object scala.collection.JavaConverters">JavaConverters</span>._

<span class="keyword">private</span><span class="delimiter">[</span>server<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait RequestBodyHandler extends java.lang.Object with ScalaObject" id="20455">RequestBodyHandler</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[R](firstIteratee: play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]], allChannels: org.jboss.netty.channel.group.DefaultChannelGroup, server: play.core.server.Server)(play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]], org.jboss.netty.channel.SimpleChannelUpstreamHandler)" id="325107">newRequestBodyHandler</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="325109">R</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" id="330080">firstIteratee</a>: <a href="../../../api/libs/concurrent/Promise.scala.html#13304" title="play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">Promise</a><span class="delimiter">[</span>Iteratee<span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Either<span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>, <a title="org.jboss.netty.channel.group.DefaultChannelGroup" id="330081">allChannels</a>: <span title="org.jboss.netty.channel.group.DefaultChannelGroup">DefaultChannelGroup</span>, <a title="play.core.server.Server" id="330082">server</a>: <a href="../Server.scala.html#20338" title="play.core.server.Server">Server</a><span class="delimiter">)</span>: <span title="(play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]], org.jboss.netty.channel.SimpleChannelUpstreamHandler)" class="delimiter">(</span>Promise<span class="delimiter">[</span>Iteratee<span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Either<span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>, SimpleChannelUpstreamHandler<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Boolean" id="330418">redeemed</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">var</span> <a title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" id="330419">p</a> = <a href="../../../api/libs/concurrent/Promise.scala.html#79471" title="[A]()play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]">Promise</a><span title="()play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" class="delimiter">[</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#14381" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">Iteratee</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Either<span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="330420">MAX_MESSAGE_WATERMARK</a> = <span title="Int(10)" class="int">10</span>
    <span class="keyword">val</span> <a title="Int" id="330421">MIN_MESSAGE_WATERMARK</a> = <span title="Int(10)" class="int">10</span>
    <span class="keyword">import</span> scala.concurrent.stm._
    <span class="keyword">val</span> <a title="scala.concurrent.stm.Ref[Int]" id="330423">counter</a> = <span title="(initialValue: Int)scala.concurrent.stm.Ref[Int]">Ref</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

    <span class="keyword">var</span> <a title="scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" id="330424">iteratee</a>: <span title="scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">Ref</span><span class="delimiter">[</span>Iteratee<span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Either<span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span> = <span title="(initialValue: play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])(implicit om: scala.reflect.OptManifest[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]])scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">Ref</span><span title="(clazz: java.lang.Class[_], arg1: scala.reflect.OptManifest[_], args: scala.reflect.OptManifest[_]*)scala.reflect.ClassManifest[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" class="delimiter">(</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#14382" title="object play.api.libs.iteratee.Iteratee">Iteratee</a>.<a href="../../../api/libs/iteratee/Iteratee.scala.html#75606" title="(i: play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]])play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">flatten</a><span class="delimiter">(</span><a href="#330080" title="play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">firstIteratee</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, chunk: play.api.libs.iteratee.Input[Array[Byte]])Unit" id="330425">pushChunk</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="330510">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="play.api.libs.iteratee.Input[Array[Byte]]" id="330511">chunk</a>: <a href="../../../api/libs/iteratee/Iteratee.scala.html#14414" title="play.api.libs.iteratee.Input[Array[Byte]]">Input</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#330423" title="scala.concurrent.stm.Ref[Int]">counter</a>.<span title="=&gt; scala.concurrent.stm.Ref.View[Int]">single</span>.<span title="(f: Int =&gt; Int)Int">transformAndGet</span> <span class="delimiter">{</span> <a href="#330514" title="Int">_</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span> <span class="delimiter">}</span> <span title="(x: Int)Boolean">&gt;</span> <a href="#330420" title="Int">MAX_MESSAGE_WATERMARK</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#330510" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()Boolean">isOpen</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#330510" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Boolean)org.jboss.netty.channel.ChannelFuture">setReadable</span><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#330418" title="Boolean">redeemed</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" id="330531">itPromise</a> = <a href="../../../api/libs/concurrent/Promise.scala.html#79471" title="[A]()play.api.libs.concurrent.Promise[A] with play.api.libs.concurrent.Redeemable[A]">Promise</a><span title="()play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]" class="delimiter">[</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#14381" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">Iteratee</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Either<span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]" id="330532">current</a> = <a href="#330424" title="scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">iteratee</a>.<span title="=&gt; scala.concurrent.stm.Ref.View[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">single</span>.<span title="(v: play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">swap</span><span class="delimiter">(</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#14382" title="object play.api.libs.iteratee.Iteratee">Iteratee</a>.<a href="../../../api/libs/iteratee/Iteratee.scala.html#75606" title="(i: play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]])play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">flatten</a><span class="delimiter">(</span><a href="#330531" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">itPromise</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]" id="330533">next</a> = <a href="#330532" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">current</a>.<a href="../../../api/libs/iteratee/Iteratee.scala.html#75090" title="[B, C](done: (Either[play.api.mvc.Result,R], play.api.libs.iteratee.Input[Array[Byte]]) =&gt; play.api.libs.iteratee.Iteratee[B,C], cont: play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]] =&gt; play.api.libs.iteratee.Iteratee[B,C], error: (String, play.api.libs.iteratee.Input[Array[Byte]]) =&gt; play.api.libs.iteratee.Iteratee[B,C])play.api.libs.iteratee.Iteratee[B,C]">pureFlatFold</a><span title="(done: (Either[play.api.mvc.Result,R], play.api.libs.iteratee.Input[Array[Byte]]) =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]], cont: play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]], error: (String, play.api.libs.iteratee.Input[Array[Byte]]) =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]" class="delimiter">[</span><span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <span title="Either[play.api.mvc.Result,R]">Either</span><span class="delimiter">[</span>Result, R<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span>
          <span class="delimiter">(</span><a title="Either[play.api.mvc.Result,R]" id="330548">_</a>, <a title="play.api.libs.iteratee.Input[Array[Byte]]" id="330549">_</a><span class="delimiter">)</span> =&gt; <a href="#330532" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">current</a>,
          <a title="play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]" id="330551">k</a> =&gt; <a href="#330551" title="(v1: play.api.libs.iteratee.Input[Array[Byte]])play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">k</a><span class="delimiter">(</span><a href="#330511" title="play.api.libs.iteratee.Input[Array[Byte]]">chunk</a><span class="delimiter">)</span>,
          <span class="delimiter">(</span><a title="String" id="330554">e</a>, <a title="play.api.libs.iteratee.Input[Array[Byte]]" id="330555">_</a><span class="delimiter">)</span> =&gt; <a href="#330532" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">current</a><span class="delimiter">)</span>

        <a href="#330531" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">itPromise</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#102784" title="(a: =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])Unit">redeem</a><span class="delimiter">(</span><a href="#330533" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">next</a><span class="delimiter">)</span>

        <a href="#330533" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">next</a>.<a href="../../../api/libs/iteratee/Iteratee.scala.html#75087" title="(done: (Either[play.api.mvc.Result,R], play.api.libs.iteratee.Input[Array[Byte]]) =&gt; Any, cont: play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]] =&gt; Any, error: (String, play.api.libs.iteratee.Input[Array[Byte]]) =&gt; Any)play.api.libs.concurrent.Promise[Any]">pureFold</a><span title="Unit" class="delimiter">(</span>
          <span class="delimiter">(</span><a title="Either[play.api.mvc.Result,R]" id="330565">a</a>, <a title="play.api.libs.iteratee.Input[Array[Byte]]" id="330566">e</a><span class="delimiter">)</span> =&gt; <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#330418" title="Boolean">redeemed</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#330419" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">p</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#102784" title="(a: =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])Unit">redeem</a><span class="delimiter">(</span><a href="#330533" title="play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]">next</a><span class="delimiter">)</span>;
            <a href="#330424" title="scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">iteratee</a> = <span title="Null(null)" class="keyword">null</span>; <a href="#330419" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">p</a> = <span title="Null(null)" class="keyword">null</span>; <a href="#330418" title="Boolean">redeemed</a> = <span title="Boolean(true)" class="keyword">true</span>
            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#330510" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()Boolean">isOpen</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#330510" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Boolean)org.jboss.netty.channel.ChannelFuture">setReadable</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>,
          <a title="play.api.libs.iteratee.Input[Array[Byte]] =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]" id="330577">k</a> =&gt;
            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#330423" title="scala.concurrent.stm.Ref[Int]">counter</a>.<span title="=&gt; scala.concurrent.stm.Ref.View[Int]">single</span>.<span title="(f: Int =&gt; Int)Int">transformAndGet</span> <span class="delimiter">{</span> <a href="#330579" title="Int">_</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span> <span class="delimiter">}</span> <span title="(x: Int)Boolean">&lt;=</span> <a href="#330421" title="Int">MIN_MESSAGE_WATERMARK</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#330510" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()Boolean">isOpen</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#330510" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Boolean)org.jboss.netty.channel.ChannelFuture">setReadable</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>,

          <span class="delimiter">(</span><a title="String" id="330597">msg</a>, <a title="play.api.libs.iteratee.Input[Array[Byte]]" id="330598">e</a><span class="delimiter">)</span> =&gt;
            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#330418" title="Boolean">redeemed</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#330419" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">p</a>.<a href="../../../api/libs/concurrent/Promise.scala.html#102784" title="(a: =&gt; play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]])Unit">redeem</a><span class="delimiter">(</span><a href="../../../api/libs/iteratee/Iteratee.scala.html#75236" title="(a: Left[play.api.mvc.Results.Status,Nothing], e: play.api.libs.iteratee.Input[Array[Byte]])play.api.libs.iteratee.Iteratee[Array[Byte],Left[play.api.mvc.Results.Status,Nothing]]">Done</a><span class="delimiter">(</span><span title="(a: play.api.mvc.Results.Status)Left[play.api.mvc.Results.Status,Nothing]">Left</span><span class="delimiter">(</span><a href="../../../api/mvc/Results.scala.html#16686" title="object play.api.mvc.Results">Results</a>.<a href="../../../api/mvc/Results.scala.html#66761" title="=&gt; play.api.mvc.Results.Status">InternalServerError</a><span class="delimiter">)</span>, <a href="#330598" title="play.api.libs.iteratee.Input[Array[Byte]]">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#330424" title="scala.concurrent.stm.Ref[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">iteratee</a> = <span title="Null(null)" class="keyword">null</span>; <a href="#330419" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">p</a> = <span title="Null(null)" class="keyword">null</span>; <a href="#330418" title="Boolean">redeemed</a> = <span title="Boolean(true)" class="keyword">true</span>
              <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#330510" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()Boolean">isOpen</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#330510" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="(x$1: Boolean)org.jboss.netty.channel.ChannelFuture">setReadable</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
            <span class="delimiter">}</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span title="(_1: play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]], _2: org.jboss.netty.channel.SimpleChannelUpstreamHandler)(play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]], org.jboss.netty.channel.SimpleChannelUpstreamHandler)" class="delimiter">(</span><a href="#330419" title="Promise extends play.api.libs.concurrent.Promise[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]] with play.api.libs.concurrent.Redeemable[play.api.libs.iteratee.Iteratee[Array[Byte],Either[play.api.mvc.Result,R]]]">p</a>, <a href="#330624" title="org.jboss.netty.channel.SimpleChannelUpstreamHandler" class="keyword">new</a> <a title="anonymous class $anon extends org.jboss.netty.channel.SimpleChannelUpstreamHandler" id="330624">SimpleChannelUpstreamHandler</a> <span class="delimiter">{</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.MessageEvent)Unit" id="330628">messageReceived</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="330631">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.MessageEvent" id="330632">e</a>: <span title="org.jboss.netty.channel.MessageEvent">MessageEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#330632" title="org.jboss.netty.channel.MessageEvent">e</a>.<span title="()java.lang.Object">getMessage</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>

          <span class="keyword">case</span> <a title="Unit" id="330638">chunk</a>: <span title="org.jboss.netty.handler.codec.http.HttpChunk">HttpChunk</span> <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#330638" title="org.jboss.netty.handler.codec.http.HttpChunk">chunk</a>.<span title="()Boolean">isLast</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="org.jboss.netty.buffer.ChannelBuffer" id="330639">cBuffer</a> = <a href="#330638" title="org.jboss.netty.handler.codec.http.HttpChunk">chunk</a>.<span title="()org.jboss.netty.buffer.ChannelBuffer">getContent</span><span class="delimiter">(</span><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="Array[Byte]" id="330640">bytes</a> = <span title="Array[Byte]" class="keyword">new</span> <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><a href="#330639" title="org.jboss.netty.buffer.ChannelBuffer">cBuffer</a>.<span title="()Int">readableBytes</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#330639" title="org.jboss.netty.buffer.ChannelBuffer">cBuffer</a>.<span title="(x$1: Array[Byte])Unit">readBytes</span><span class="delimiter">(</span><a href="#330640" title="Array[Byte]">bytes</a><span class="delimiter">)</span>
            <a href="#330425" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, chunk: play.api.libs.iteratee.Input[Array[Byte]])Unit">pushChunk</a><span class="delimiter">(</span><a href="#330631" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="../../../api/libs/iteratee/Iteratee.scala.html#75164" title="(e: Array[Byte])play.api.libs.iteratee.Input.El[Array[Byte]]">El</a><span class="delimiter">(</span><a href="#330640" title="Array[Byte]">bytes</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <a title="Unit" id="330650">chunk</a>: <span title="org.jboss.netty.handler.codec.http.HttpChunk">HttpChunk</span> <span class="keyword">if</span> <a href="#330650" title="org.jboss.netty.handler.codec.http.HttpChunk">chunk</a>.<span title="()Boolean">isLast</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
            <a href="#330425" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, chunk: play.api.libs.iteratee.Input[Array[Byte]])Unit">pushChunk</a><span class="delimiter">(</span><a href="#330631" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="../../../api/libs/iteratee/Iteratee.scala.html#67191" title="object play.api.libs.iteratee.Input.EOF">EOF</a><span class="delimiter">)</span>
            <a href="#330631" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span>.<span title="()org.jboss.netty.channel.ChannelPipeline">getPipeline</span>.<span title="(x$1: java.lang.String, x$2: java.lang.String, x$3: org.jboss.netty.channel.ChannelHandler)org.jboss.netty.channel.ChannelHandler">replace</span><span title="Unit" class="delimiter">(</span><span title="java.lang.String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <span title="java.lang.String(&quot;handler&quot;)" class="string">&quot;handler&quot;</span>, <span title="play.core.server.netty.PlayDefaultUpstreamHandler" class="keyword">new</span> <a href="PlayDefaultUpstreamHandler.scala.html#20806" title="play.core.server.netty.PlayDefaultUpstreamHandler">PlayDefaultUpstreamHandler</a><span class="delimiter">(</span><a href="#330082" title="play.core.server.Server">server</a>, <a href="#330081" title="org.jboss.netty.channel.group.DefaultChannelGroup">allChannels</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="keyword">case</span> <a title="Unit" id="330663">unexpected</a> =&gt; <a href="../../../api/Logger.scala.html#82396" title="(name: String)play.api.Logger">Logger</a><span class="delimiter">(</span><span title="java.lang.String(&quot;play&quot;)" class="string">&quot;play&quot;</span><span class="delimiter">)</span>.<a href="../../../api/Logger.scala.html#82390" title="(message: =&gt; String)Unit">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Oops, unexpected message received in NettyServer/ChunkHandler (please report this problem): &quot;)" class="string">&quot;Oops, unexpected message received in NettyServer/ChunkHandler (please report this problem): &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#330663" title="java.lang.Object">unexpected</a><span class="delimiter">)</span>

        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.ExceptionEvent)Unit" id="330629">exceptionCaught</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="330633">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.ExceptionEvent" id="330634">e</a>: <span title="org.jboss.netty.channel.ExceptionEvent">ExceptionEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#330634" title="org.jboss.netty.channel.ExceptionEvent">e</a>.<span title="()java.lang.Throwable">getCause</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>;
        <a href="#330634" title="org.jboss.netty.channel.ExceptionEvent">e</a>.<span title="()org.jboss.netty.channel.Channel">getChannel</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()org.jboss.netty.channel.ChannelFuture">close</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>; <span class="comment">/*really? */</span>
      <span class="delimiter">}</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, e: org.jboss.netty.channel.ChannelStateEvent)Unit" id="330630">channelDisconnected</a><span class="delimiter">(</span><a title="org.jboss.netty.channel.ChannelHandlerContext" id="330635">ctx</a>: <span title="org.jboss.netty.channel.ChannelHandlerContext">ChannelHandlerContext</span>, <a title="org.jboss.netty.channel.ChannelStateEvent" id="330636">e</a>: <span title="org.jboss.netty.channel.ChannelStateEvent">ChannelStateEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#330425" title="(ctx: org.jboss.netty.channel.ChannelHandlerContext, chunk: play.api.libs.iteratee.Input[Array[Byte]])Unit">pushChunk</a><span class="delimiter">(</span><a href="#330635" title="org.jboss.netty.channel.ChannelHandlerContext">ctx</a>, <a href="../../../api/libs/iteratee/Iteratee.scala.html#67191" title="object play.api.libs.iteratee.Input.EOF">EOF</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>
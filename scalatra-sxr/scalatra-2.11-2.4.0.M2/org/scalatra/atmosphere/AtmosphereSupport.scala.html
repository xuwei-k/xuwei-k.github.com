<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>org/scalatra/atmosphere/AtmosphereSupport.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
package org.scalatra
package atmosphere

import json.JsonSupport
import javax.servlet.<span class="delimiter">{</span>ServletContext, ServletConfig, FilterConfig, ServletException<span class="delimiter">}</span>
import org.apache.catalina.CometProcessor
import org.jboss.servlet.http.HttpEventServlet
import java.io.IOException
import org.atmosphere.container.Tomcat7CometSupport
import org.atmosphere.container.TomcatCometSupport
import org.jboss.servlet.http.HttpEvent
import org.atmosphere.container.JBossWebCometSupport
import org.atmosphere.cpr._
import collection.<span title="scala.collection.JavaConverters.type">JavaConverters</span>._
import org.json4s._
import org.atmosphere.cache.<span class="delimiter">{</span>UUIDBroadcasterCache, HeaderBroadcasterCache<span class="delimiter">}</span>
import org.scalatra.util.<a href="../util/RicherString.scala.html#org.scalatra.util.RicherString" title="org.scalatra.util.RicherString.type">RicherString</a>._
import _root_.akka.actor.ActorSystem
import grizzled.slf4j.Logger
import com.typesafe.config.ConfigFactory
import scala.util.control.<span title="scala.util.control.Exception.type">Exception</span>.allCatch
import org.atmosphere.client.TrackMessageSizeInterceptor
import org.atmosphere.interceptor.SessionCreationInterceptor
import javax.servlet.http.<span class="delimiter">{</span>HttpServletResponse, HttpServletRequest<span class="delimiter">}</span>
import servlet.ScalatraAsyncSupport
import java.util

trait <a title="trait AtmosphereSupport extends AnyRef with org.scalatra.Initializable with org.scalatra.Handler with org.apache.catalina.CometProcessor with org.jboss.servlet.http.HttpEventServlet with org.apache.catalina.comet.CometProcessor with org.scalatra.servlet.ScalatraAsyncSupport" id="org.scalatra.atmosphere;AtmosphereSupport">AtmosphereSupport</a> extends <a href="../Initializable.scala.html#org.scalatra;Initializable" title="org.scalatra.Initializable">Initializable</a> with <a href="../Handler.scala.html#org.scalatra;Handler" title="org.scalatra.Handler">Handler</a> with <span title="org.apache.catalina.CometProcessor">CometProcessor</span> with <span title="org.jboss.servlet.http.HttpEventServlet">HttpEventServlet</span> with org.apache.catalina.comet.<span title="org.apache.catalina.comet.CometProcessor">CometProcessor</span> with <a href="../servlet/ScalatraAsyncSupport.scala.html#org.scalatra.servlet;ScalatraAsyncSupport" title="org.scalatra.servlet.ScalatraAsyncSupport">ScalatraAsyncSupport</a> <span class="delimiter">{</span> self: ScalatraBase with org.scalatra.SessionSupport with JsonSupport<span class="delimiter">[</span>_<span class="delimiter">]</span> =&gt;

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> val <a title="grizzled.slf4j.Logger" id="org.scalatra.atmosphere;AtmosphereSupport.logger">logger</a> = <span title="[C]()(implicit evidence$1: scala.reflect.ClassTag[C])grizzled.slf4j.Logger">Logger</span><span title="()(implicit evidence$1: scala.reflect.ClassTag[&lt;refinement&gt;.type])grizzled.slf4j.Logger" class="delimiter">[</span>this.type<span class="delimiter">]</span>

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> val <a title="org.scalatra.atmosphere.JacksonSimpleWireformat" id="org.scalatra.atmosphere;AtmosphereSupport._defaultWireformat">_defaultWireformat</a> = new <a href="JacksonSimpleWireformat.scala.html#org.scalatra.atmosphere;JacksonSimpleWireformat" title="org.scalatra.atmosphere.JacksonSimpleWireformat">JacksonSimpleWireformat</a>

  <span class="comment">/**
   * Override this to use another ScalaBroadcaster like RedisScalatraBroadcaster
   *
   * Example: RedisScalatraBroadcasterConfig(URI.create(&quot;redis://127.0.0.1&quot;), Some(&quot;password&quot;))
   */</span>
  protected val <a title="org.atmosphere.cpr.BroadcasterConf" id="org.scalatra.atmosphere;AtmosphereSupport.broadcasterConfig">broadcasterConfig</a>: <a href="../../atmosphere/cpr/broadcaster_configs.scala.html#org.atmosphere.cpr;BroadcasterConf" title="org.atmosphere.cpr.BroadcasterConf">BroadcasterConf</a> = <a href="../../atmosphere/cpr/broadcaster_configs.scala.html#org.atmosphere.cpr;ScalatraBroadcasterConfig" title="(broadcasterClass: Class[_ &lt;: org.scalatra.atmosphere.ScalatraBroadcaster], uri: java.net.URI, extraSetup: org.atmosphere.cpr.Broadcaster =&gt; Unit)org.atmosphere.cpr.ScalatraBroadcasterConfig">ScalatraBroadcasterConfig</a><span class="delimiter">(</span>classOf<span title="Class[org.scalatra.atmosphere.DefaultScalatraBroadcaster](classOf[org.scalatra.atmosphere.DefaultScalatraBroadcaster])" class="delimiter">[</span>DefaultScalatraBroadcaster<span class="delimiter">]</span><span class="delimiter">)</span>

  implicit protected def <a title="=&gt; org.scalatra.atmosphere.WireFormat" id="org.scalatra.atmosphere;AtmosphereSupport.wireFormat">wireFormat</a>: <a href="wire_format.scala.html#org.scalatra.atmosphere;WireFormat" title="org.scalatra.atmosphere.WireFormat">WireFormat</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport._defaultWireformat" title="org.scalatra.atmosphere.JacksonSimpleWireformat">_defaultWireformat</a>

  implicit def <a title="implicit org.scalatra.atmosphere.AtmosphereSupport.json2JsonMessage : (json: org.json4s.JValue)org.scalatra.atmosphere.OutboundMessage" id="org.scalatra.atmosphere;AtmosphereSupport.json2JsonMessage">json2JsonMessage</a><span class="delimiter">(</span><a title="org.json4s.JValue" id="org.scalatra.atmosphere;AtmosphereSupport.json2JsonMessage.json">json</a>: <span title="org.json4s.JValue">JValue</span><span class="delimiter">)</span>: <a href="messages.scala.html#org.scalatra.atmosphere;OutboundMessage" title="org.scalatra.atmosphere.OutboundMessage">OutboundMessage</a> = <a href="messages.scala.html#org.scalatra.atmosphere;JsonMessage" title="(content: org.json4s.JValue)org.scalatra.atmosphere.JsonMessage">JsonMessage</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.json2JsonMessage.json" title="org.json4s.JValue">json</a><span class="delimiter">)</span>

  implicit def <a title="implicit org.scalatra.atmosphere.AtmosphereSupport.string2Outbound : (text: String)org.scalatra.atmosphere.OutboundMessage" id="org.scalatra.atmosphere;AtmosphereSupport.string2Outbound">string2Outbound</a><span class="delimiter">(</span><a title="String" id="org.scalatra.atmosphere;AtmosphereSupport.string2Outbound.text">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="messages.scala.html#org.scalatra.atmosphere;OutboundMessage" title="org.scalatra.atmosphere.OutboundMessage">OutboundMessage</a> = <a href="../util/RicherString.scala.html#org.scalatra.util.RicherString.stringToRicherString" title="implicit org.scalatra.util.RicherString.stringToRicherString : (s: String)org.scalatra.util.RicherString">text</a>.<a href="../util/RicherString.scala.html#org.scalatra.util;RicherString.blankOption" title="=&gt; Option[String]">blankOption</a> <span title="(f: String =&gt; org.scalatra.atmosphere.ProtocolMessage[_ &gt;: org.json4s.JValue with String &lt;: Object] with Product with Serializable)Option[org.scalatra.atmosphere.ProtocolMessage[_ &gt;: org.json4s.JValue with String &lt;: Object] with Product with Serializable]">map</span> <span class="delimiter">{</span> <a title="String" id="org.scalatra.atmosphere;AtmosphereSupport.string2Outbound.$anonfun.txt">txt</a> =&gt;
    if <span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.string2Outbound.$anonfun.txt" title="String">txt</a>.<span title="(x$1: String)Boolean">startsWith</span><span class="delimiter">(</span><span title="String(&quot;{&quot;)" class="string">&quot;{&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#org.scalatra.atmosphere;AtmosphereSupport.string2Outbound.$anonfun.txt" title="String">txt</a>.<span title="(x$1: String)Boolean">startsWith</span><span class="delimiter">(</span><span title="String(&quot;[&quot;)" class="string">&quot;[&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport" title="(in: org.json4s.JsonInput, useBigDecimalForDouble: Boolean)Option[org.json4s.JValue]">parseOpt</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.string2Outbound.$anonfun.txt" title="implicit org.json4s.package.string2JsonInput : (s: String)org.json4s.JsonInput">txt</a><span class="delimiter">)</span> <span title="(f: org.json4s.JValue =&gt; org.scalatra.atmosphere.JsonMessage)Option[org.scalatra.atmosphere.JsonMessage]">map</span> <a href="messages.scala.html#org.scalatra.atmosphere.JsonMessage" title="org.scalatra.atmosphere.JsonMessage.type">JsonMessage</a>.<a href="messages.scala.html#org.scalatra.atmosphere;JsonMessage" title="(content: org.json4s.JValue)org.scalatra.atmosphere.JsonMessage">apply</a> <span title="(default: =&gt; org.scalatra.atmosphere.ProtocolMessage[_ &gt;: org.json4s.JValue with String &lt;: Object] with Product with Serializable)org.scalatra.atmosphere.ProtocolMessage[_ &gt;: org.json4s.JValue with String &lt;: Object] with Product with Serializable">getOrElse</span> <a href="messages.scala.html#org.scalatra.atmosphere;TextMessage" title="(content: String)org.scalatra.atmosphere.TextMessage">TextMessage</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.string2Outbound.$anonfun.txt" title="String">txt</a><span class="delimiter">)</span>
    else
      <a href="messages.scala.html#org.scalatra.atmosphere;TextMessage" title="(content: String)org.scalatra.atmosphere.TextMessage">TextMessage</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.string2Outbound.$anonfun.txt" title="String">txt</a><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span title="(default: =&gt; org.scalatra.atmosphere.ProtocolMessage[_ &gt;: org.json4s.JValue with String &lt;: Object] with Product with Serializable)org.scalatra.atmosphere.ProtocolMessage[_ &gt;: org.json4s.JValue with String &lt;: Object] with Product with Serializable">getOrElse</span> <a href="messages.scala.html#org.scalatra.atmosphere;TextMessage" title="(content: String)org.scalatra.atmosphere.TextMessage">TextMessage</a><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> def <a title="=&gt; Boolean" id="org.scalatra.atmosphere;AtmosphereSupport.isFilter">isFilter</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport" title="&lt;refinement of org.scalatra.atmosphere.AtmosphereSupport with org.scalatra.ScalatraBase with org.scalatra.SessionSupport with org.scalatra.json.JsonSupport[_]&gt; extends org.scalatra.atmosphere.AtmosphereSupport with org.scalatra.ScalatraBase with org.scalatra.SessionSupport with org.scalatra.json.JsonSupport[_]">self</a> match <span class="delimiter">{</span>
    case _: <a href="../ScalatraFilter.scala.html#org.scalatra;ScalatraFilter" title="org.scalatra.ScalatraFilter">ScalatraFilter</a> =&gt; true
    case _ =&gt; false
  <span class="delimiter">}</span>

  val <a title="org.scalatra.atmosphere.ScalatraAtmosphereFramework" id="org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework">atmosphereFramework</a> = new <a href="ScalatraAtmosphereFramework.scala.html#org.scalatra.atmosphere;ScalatraAtmosphereFramework" title="org.scalatra.atmosphere.ScalatraAtmosphereFramework">ScalatraAtmosphereFramework</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.isFilter" title="=&gt; Boolean">isFilter</a>, false<span class="delimiter">)</span>

  implicit protected def <a title="=&gt; akka.actor.ActorSystem" id="org.scalatra.atmosphere;AtmosphereSupport.scalatraActorSystem">scalatraActorSystem</a>: <span title="akka.actor.ActorSystem">ActorSystem</span> =
    <a href="../servlet/ServletApiImplicits.scala.html#org.scalatra.servlet;ServletApiImplicits.enrichServletContext" title="implicit org.scalatra.servlet.ServletApiImplicits.enrichServletContext : (servletContext: javax.servlet.ServletContext)org.scalatra.servlet.RichServletContext">servletContext</a>.<a href="../servlet/AttributesMap.scala.html#org.scalatra.servlet;AttributesMap.get(adc3586498)" title="(key: String)Option[Any]">get</a><span class="delimiter">(</span><a href="package.scala.html#org.scalatra.atmosphere.package.ActorSystemKey" title="=&gt; String">ActorSystemKey</a><span class="delimiter">)</span>.<span title="(f: Any =&gt; akka.actor.ActorSystem)Option[akka.actor.ActorSystem]">map</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.scalatraActorSystem.$anonfun.x$1" title="Any">_</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.actor.ActorSystem" class="delimiter">[</span><span title="akka.actor.ActorSystem">ActorSystem</span><span class="delimiter">]</span><span class="delimiter">)</span> <span title="(default: =&gt; akka.actor.ActorSystem)akka.actor.ActorSystem">getOrElse</span> <span class="delimiter">{</span>
      val <a title="String" id="org.scalatra.atmosphere;AtmosphereSupport.scalatraActorSystem.msg">msg</a> = <span title="String(&quot;Scalatra Actor system not present. Creating a private actor system&quot;)" class="string">&quot;Scalatra Actor system not present. Creating a private actor system&quot;</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.logger" title="grizzled.slf4j.Logger">logger</a>.<span title="(msg: =&gt; Any)Unit">info</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.scalatraActorSystem.msg" title="String">msg</a><span class="delimiter">)</span>
      val <a title="com.typesafe.config.Config" id="org.scalatra.atmosphere;AtmosphereSupport.scalatraActorSystem.cfg">cfg</a> = <span title="com.typesafe.config.ConfigFactory.type">ConfigFactory</span>.<span title="()com.typesafe.config.Config">load</span>
      val <a title="com.typesafe.config.Config" id="org.scalatra.atmosphere;AtmosphereSupport.scalatraActorSystem.defRef">defRef</a> = <span title="com.typesafe.config.ConfigFactory.type">ConfigFactory</span>.<span title="()com.typesafe.config.Config">defaultReference</span>
      <span title="(name: String, config: com.typesafe.config.Config)akka.actor.ActorSystem">ActorSystem</span><span class="delimiter">(</span><span title="String(&quot;scalatra&quot;)" class="string">&quot;scalatra&quot;</span>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.scalatraActorSystem.cfg" title="com.typesafe.config.Config">cfg</a>.<span title="(x$1: String)com.typesafe.config.Config">getConfig</span><span class="delimiter">(</span><span title="String(&quot;scalatra&quot;)" class="string">&quot;scalatra&quot;</span><span class="delimiter">)</span>.<span title="(x$1: com.typesafe.config.ConfigMergeable)com.typesafe.config.Config">withFallback</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.scalatraActorSystem.defRef" title="com.typesafe.config.Config">defRef</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> implicit def <a title="implicit org.scalatra.atmosphere.AtmosphereSupport.filterConfig2servletConfig : (fc: javax.servlet.FilterConfig)javax.servlet.ServletConfig" id="org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig">filterConfig2servletConfig</a><span class="delimiter">(</span><a title="javax.servlet.FilterConfig" id="org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig.fc">fc</a>: <span title="javax.servlet.FilterConfig">FilterConfig</span><span class="delimiter">)</span>: <span title="javax.servlet.ServletConfig">ServletConfig</span> = <span class="delimiter">{</span>
    new <a title="&lt;$anon: javax.servlet.ServletConfig&gt; extends Object with javax.servlet.ServletConfig" id="org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig;$anon">ServletConfig</a> <span class="delimiter">{</span>
      def <a title="(name: String)String" id="org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig;$anon.getInitParameter">getInitParameter</a><span class="delimiter">(</span><a title="String" id="org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig;$anon.getInitParameter.name">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig;$anon.getServletContext" title="()javax.servlet.ServletContext">getServletContext</a>.<span title="(x$1: String)String">getInitParameter</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig;$anon.getInitParameter.name" title="String">name</a><span class="delimiter">)</span>
      def <a title="()java.util.Enumeration[String]" id="org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig;$anon.getInitParameterNames">getInitParameterNames</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig;$anon.getServletContext" title="()javax.servlet.ServletContext">getServletContext</a>.<span title="()java.util.Enumeration[String]">getInitParameterNames</span><span class="delimiter">(</span><span class="delimiter">)</span>
      def <a title="()String" id="org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig;$anon.getServletName">getServletName</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig.fc" title="javax.servlet.FilterConfig">fc</a>.<span title="()String">getFilterName</span><span class="delimiter">(</span><span class="delimiter">)</span>
      def <a title="()javax.servlet.ServletContext" id="org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig;$anon.getServletContext">getServletContext</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig.fc" title="javax.servlet.FilterConfig">fc</a>.<span title="()javax.servlet.ServletContext">getServletContext</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  abstract override def <a title="(config: AtmosphereSupport.this.ConfigT)Unit" id="org.scalatra.atmosphere;AtmosphereSupport.initialize">initialize</a><span class="delimiter">(</span><a title="AtmosphereSupport.this.ConfigT" id="org.scalatra.atmosphere;AtmosphereSupport.initialize.config">config</a>: <a href="../Initializable.scala.html#org.scalatra;Initializable;ConfigT" title="AtmosphereSupport.this.ConfigT">ConfigT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    super.<a href="../Initializable.scala.html#org.scalatra;Initializable.initialize" title="(config: AtmosphereSupport.this.ConfigT)Unit">initialize</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.initialize.config" title="AtmosphereSupport.this.ConfigT">config</a><span class="delimiter">)</span>
    val <a title="javax.servlet.ServletConfig" id="org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg">cfg</a>: <span title="javax.servlet.ServletConfig">ServletConfig</span> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.initialize.config" title="AtmosphereSupport.this.ConfigT">config</a> match <span class="delimiter">{</span>
      case <span title="javax.servlet.FilterConfig">c</span>: <span title="javax.servlet.FilterConfig">FilterConfig</span> =&gt; <a href="#org.scalatra.atmosphere;AtmosphereSupport.filterConfig2servletConfig" title="implicit org.scalatra.atmosphere.AtmosphereSupport.filterConfig2servletConfig : (fc: javax.servlet.FilterConfig)javax.servlet.ServletConfig">c</a>
      case <span title="javax.servlet.ServletConfig">c</span>: <span title="javax.servlet.ServletConfig">ServletConfig</span> =&gt; new <a title="&lt;$anon: javax.servlet.ServletConfig&gt; extends Object with javax.servlet.ServletConfig" id="org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg;$anon">ServletConfig</a> <span class="delimiter">{</span>
        def <a title="()java.util.Enumeration[String]" id="org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg;$anon.getInitParameterNames">getInitParameterNames</a>: util.<span title="java.util.Enumeration[String]">Enumeration</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg;$anon.getServletContext" title="()javax.servlet.ServletContext">getServletContext</a>.<span title="()java.util.Enumeration[String]">getInitParameterNames</span>
        def <a title="()String" id="org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg;$anon.getServletName">getServletName</a>: <span title="String">String</span> = <span title="javax.servlet.ServletConfig">c</span>.<span title="()String">getServletName</span>
        def <a title="(name: String)String" id="org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg;$anon.getInitParameter">getInitParameter</a><span class="delimiter">(</span><a title="String" id="org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg;$anon.getInitParameter.name">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg;$anon.getServletContext" title="()javax.servlet.ServletContext">getServletContext</a>.<span title="(x$1: String)String">getInitParameter</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg;$anon.getInitParameter.name" title="String">name</a><span class="delimiter">)</span>
        def <a title="()javax.servlet.ServletContext" id="org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg;$anon.getServletContext">getServletContext</a>: <span title="javax.servlet.ServletContext">ServletContext</span> = <span title="javax.servlet.ServletConfig">c</span>.<span title="()javax.servlet.ServletContext">getServletContext</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(f: Throwable =&gt; Unit)util.control.Exception.Catch[Unit]">withApply</span><span title="(body: =&gt; Unit)Unit" class="delimiter">(</span><a title="Throwable" id="org.scalatra.atmosphere;AtmosphereSupport.initialize.$anonfun.ex">ex</a> =&gt; <a href="#org.scalatra.atmosphere;AtmosphereSupport.logger" title="grizzled.slf4j.Logger">logger</a>.<span title="(msg: =&gt; Any, t: =&gt; Throwable)Unit">error</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.initialize.$anonfun.ex" title="Throwable">ex</a>.<span title="()String">getMessage</span>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.initialize.$anonfun.ex" title="Throwable">ex</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<a href="ScalatraAtmosphereFramework.scala.html#org.scalatra.atmosphere;ScalatraAtmosphereFramework.enableSessionSupport" title="()Unit">enableSessionSupport</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.configureBroadcasterCache" title="()Unit">configureBroadcasterCache</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.configureBroadcasterFactory" title="()Unit">configureBroadcasterFactory</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.configureInterceptors" title="(cfg: javax.servlet.ServletConfig)Any">configureInterceptors</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg" title="javax.servlet.ServletConfig">cfg</a><span class="delimiter">)</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<span title="(x$1: javax.servlet.ServletConfig)org.atmosphere.cpr.AtmosphereFramework">init</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg" title="javax.servlet.ServletConfig">cfg</a><span class="delimiter">)</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.setupAtmosphereHandlerMappings" title="(cfg: javax.servlet.ServletConfig)Unit">setupAtmosphereHandlerMappings</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.initialize.cfg" title="javax.servlet.ServletConfig">cfg</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Servlets that want to track atmosphere message size should override this.
    * @see [[TrackMessageSizeInterceptor]]
    */</span>
  protected def <a title="=&gt; Boolean" id="org.scalatra.atmosphere;AtmosphereSupport.trackMessageSize">trackMessageSize</a> : <span title="Boolean">Boolean</span> = false

  protected def <a title="(cfg: javax.servlet.ServletConfig)Any" id="org.scalatra.atmosphere;AtmosphereSupport.configureInterceptors">configureInterceptors</a><span class="delimiter">(</span><a title="javax.servlet.ServletConfig" id="org.scalatra.atmosphere;AtmosphereSupport.configureInterceptors.cfg">cfg</a>: <span title="javax.servlet.ServletConfig">ServletConfig</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<span title="(x$1: org.atmosphere.cpr.AtmosphereInterceptor)org.atmosphere.cpr.AtmosphereFramework">interceptor</span><span class="delimiter">(</span>new <span title="org.atmosphere.interceptor.SessionCreationInterceptor">SessionCreationInterceptor</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.configureInterceptors.cfg" title="javax.servlet.ServletConfig">cfg</a>.<span title="(x$1: String)String">getInitParameter</span><a href="../util/RicherString.scala.html#org.scalatra.util.RicherString.stringToRicherString" title="implicit org.scalatra.util.RicherString.stringToRicherString : (s: String)org.scalatra.util.RicherString" class="delimiter">(</a>ApplicationConfig.<span title="String(&quot;org.atmosphere.useNative&quot;)">PROPERTY_NATIVE_COMETSUPPORT</span><span class="delimiter">)</span>.<a href="../util/RicherString.scala.html#org.scalatra.util;RicherString.isBlank" title="=&gt; Boolean">isBlank</a><span class="delimiter">)</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.configureInterceptors.cfg" title="javax.servlet.ServletConfig">cfg</a>.<span title="()javax.servlet.ServletContext">getServletContext</span>.<span title="(x$1: String, x$2: String)Boolean">setInitParameter</span><span class="delimiter">(</span>ApplicationConfig.<span title="String(&quot;org.atmosphere.useNative&quot;)">PROPERTY_NATIVE_COMETSUPPORT</span>, <span title="String(&quot;true&quot;)" class="string">&quot;true&quot;</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.trackMessageSize" title="=&gt; Boolean">trackMessageSize</a> <span title="(x: Boolean)Boolean">||</span> <a href="#org.scalatra.atmosphere;AtmosphereSupport.configureInterceptors.cfg" title="javax.servlet.ServletConfig">cfg</a>.<span title="(x$1: String)String">getInitParameter</span><a href="../util/RicherString.scala.html#org.scalatra.util.RicherString.stringToRicherString" title="implicit org.scalatra.util.RicherString.stringToRicherString : (s: String)org.scalatra.util.RicherString" class="delimiter">(</a><a href="package.scala.html#org.scalatra.atmosphere.package.TrackMessageSize" title="=&gt; String">TrackMessageSize</a><span class="delimiter">)</span>.<a href="../util/RicherString.scala.html#org.scalatra.util;RicherString.blankOption" title="=&gt; Option[String]">blankOption</a>.<span title="(f: String =&gt; Boolean)Option[Boolean]">map</span><span class="delimiter">(</span><a href="../util/RicherString.scala.html#org.scalatra.util.RicherString.stringToRicherString" title="implicit org.scalatra.util.RicherString.stringToRicherString : (s: String)org.scalatra.util.RicherString">_</a>.<a href="../util/RicherString.scala.html#org.scalatra.util;RicherString.toCheckboxBool" title="=&gt; Boolean">toCheckboxBool</a><span class="delimiter">)</span>.<span title="(default: =&gt; Boolean)Boolean">getOrElse</span><span class="delimiter">(</span>false<span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<span title="(x$1: org.atmosphere.cpr.AtmosphereInterceptor)org.atmosphere.cpr.AtmosphereFramework">interceptor</span><span class="delimiter">(</span>new <span title="org.atmosphere.client.TrackMessageSizeInterceptor">TrackMessageSizeInterceptor</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> def <a title="(cfg: javax.servlet.ServletConfig)Unit" id="org.scalatra.atmosphere;AtmosphereSupport.setupAtmosphereHandlerMappings">setupAtmosphereHandlerMappings</a><span class="delimiter">(</span><a title="javax.servlet.ServletConfig" id="org.scalatra.atmosphere;AtmosphereSupport.setupAtmosphereHandlerMappings.cfg">cfg</a>: <span title="javax.servlet.ServletConfig">ServletConfig</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="comment">// TODO: also support filters?</span>
    val <a title="Option[javax.servlet.ServletRegistration]" id="org.scalatra.atmosphere;AtmosphereSupport.setupAtmosphereHandlerMappings.servletRegistration">servletRegistration</a> = <a href="../ScalatraBase.scala.html#org.scalatra.ScalatraBase" title="org.scalatra.ScalatraBase.type">ScalatraBase</a>.<a href="../ScalatraBase.scala.html#org.scalatra.ScalatraBase.getServletRegistration" title="(app: org.scalatra.ScalatraBase)Option[javax.servlet.ServletRegistration]">getServletRegistration</a><span class="delimiter">(</span>this<span class="delimiter">)</span>
    <a href="#org.scalatra.atmosphere;AtmosphereSupport.setupAtmosphereHandlerMappings.servletRegistration" title="Option[javax.servlet.ServletRegistration]">servletRegistration</a> <span title="(f: javax.servlet.ServletRegistration =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="javax.servlet.ServletRegistration" id="org.scalatra.atmosphere;AtmosphereSupport.setupAtmosphereHandlerMappings.$anonfun.reg">reg</a> =&gt;
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.setupAtmosphereHandlerMappings.$anonfun.reg" title="javax.servlet.ServletRegistration">reg</a>.<span title="(i: java.util.Collection[String])scala.collection.convert.Decorators.AsScala[Iterable[String]]">getMappings</span>.<span title="=&gt; Iterable[String]">asScala</span> <span title="(f: String =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="String" id="org.scalatra.atmosphere;AtmosphereSupport.setupAtmosphereHandlerMappings.$anonfun.$anonfun.mapping">mapping</a> =&gt;
        <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<span title="(x$1: String, x$2: org.atmosphere.cpr.AtmosphereHandler)org.atmosphere.cpr.AtmosphereFramework">addAtmosphereHandler</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.setupAtmosphereHandlerMappings.$anonfun.$anonfun.mapping" title="String">mapping</a>, new <a href="ScalatraAtmosphereHandler.scala.html#org.scalatra.atmosphere;ScalatraAtmosphereHandler" title="org.scalatra.atmosphere.ScalatraAtmosphereHandler">ScalatraAtmosphereHandler</a><span class="delimiter">)</span>.<span title="(x$1: javax.servlet.ServletConfig)Unit">initAtmosphereHandler</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.setupAtmosphereHandlerMappings.cfg" title="javax.servlet.ServletConfig">cfg</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>


  <span class="comment">/**
   * Handles a request and renders a response.
   *
   * $ 1. If the request lacks a character encoding, `defaultCharacterEncoding`
   * is set to the request.
   *
   * $ 2. Sets the response's character encoding to `defaultCharacterEncoding`.
   *
   * $ 3. Binds the current `request`, `response`, and `multiParams`, and calls
   * `executeRoutes()`.
   */</span>
  abstract override def <a title="(request: javax.servlet.http.HttpServletRequest, response: javax.servlet.http.HttpServletResponse)Unit" id="org.scalatra.atmosphere;AtmosphereSupport.handle">handle</a><span class="delimiter">(</span><a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.atmosphere;AtmosphereSupport.handle.request">request</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.atmosphere;AtmosphereSupport.handle.response">response</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="../DynamicScope.scala.html#org.scalatra;DynamicScope.withRequestResponse" title="(request: javax.servlet.http.HttpServletRequest, response: javax.servlet.http.HttpServletResponse)(f: =&gt; Any)Any">withRequestResponse</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.handle.request" title="javax.servlet.http.HttpServletRequest">request</a>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.handle.response" title="javax.servlet.http.HttpServletResponse">response</a><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span>
      val <a title="Option[org.scalatra.MatchedRoute]" id="org.scalatra.atmosphere;AtmosphereSupport.handle.atmoRoute">atmoRoute</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereRoute" title="(req: javax.servlet.http.HttpServletRequest)Option[org.scalatra.MatchedRoute]">atmosphereRoute</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.handle.request" title="javax.servlet.http.HttpServletRequest">request</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.handle.atmoRoute" title="Option[org.scalatra.MatchedRoute]">atmoRoute</a>.<span title="=&gt; Boolean">isDefined</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../servlet/ServletApiImplicits.scala.html#org.scalatra.servlet;ServletApiImplicits.enrichRequest" title="(key: String, value: Any)Unit">request</a><span class="delimiter">(</span><a href="package.scala.html#org.scalatra.atmosphere.package.AtmosphereRouteKey" title="=&gt; String">AtmosphereRouteKey</a><span class="delimiter">)</span> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.handle.atmoRoute" title="Option[org.scalatra.MatchedRoute]">atmoRoute</a>.<span title="=&gt; org.scalatra.MatchedRoute">get</span>
        <a href="#org.scalatra.atmosphere;AtmosphereSupport.handle.request" title="javax.servlet.http.HttpServletRequest">request</a>.<span title="(x$1: Boolean)javax.servlet.http.HttpSession">getSession</span><span class="delimiter">(</span>true<span class="delimiter">)</span> <span class="comment">// force session creation</span>
        if <span class="delimiter">(</span><a href="../servlet/ServletApiImplicits.scala.html#org.scalatra.servlet;ServletApiImplicits.enrichRequest" title="implicit org.scalatra.servlet.ServletApiImplicits.enrichRequest : (request: javax.servlet.http.HttpServletRequest)org.scalatra.servlet.RichRequest">request</a>.<a href="../servlet/AttributesMap.scala.html#org.scalatra.servlet;AttributesMap.get(adc3586498)" title="(key: String)Option[Any]">get</a><span class="delimiter">(</span><span title="org.atmosphere.cpr.FrameworkConfig.type">FrameworkConfig</span>.<span title="String">ATMOSPHERE_HANDLER_WRAPPER</span><span class="delimiter">)</span>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
          <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<span title="(x$1: org.atmosphere.cpr.AtmosphereRequest, x$2: org.atmosphere.cpr.AtmosphereResponse)org.atmosphere.cpr.Action">doCometSupport</span><span class="delimiter">(</span><span title="org.atmosphere.cpr.AtmosphereRequest.type">AtmosphereRequest</span>.<span title="(x$1: javax.servlet.http.HttpServletRequest)org.atmosphere.cpr.AtmosphereRequest">wrap</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.handle.request" title="javax.servlet.http.HttpServletRequest">request</a><span class="delimiter">)</span>, <span title="org.atmosphere.cpr.AtmosphereResponse.type">AtmosphereResponse</span>.<span title="(x$1: javax.servlet.http.HttpServletResponse)org.atmosphere.cpr.AtmosphereResponse">wrap</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.handle.response" title="javax.servlet.http.HttpServletResponse">response</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> else <span class="delimiter">{</span>
        super.<a href="../Handler.scala.html#org.scalatra;Handler.handle" title="(request: javax.servlet.http.HttpServletRequest, res: javax.servlet.http.HttpServletResponse)Unit">handle</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.handle.request" title="javax.servlet.http.HttpServletRequest">request</a>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.handle.response" title="javax.servlet.http.HttpServletResponse">response</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> def <a title="=&gt; Nothing" id="org.scalatra.atmosphere;AtmosphereSupport.noGetRoute">noGetRoute</a> = sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span class="string">&quot;You are using the AtmosphereSupport without defining any Get route,&quot;</span> <span title="String(&quot;You are using the AtmosphereSupport without defining any Get route,you should get rid of it.&quot;)">+</span>
     <span class="string">&quot;you should get rid of it.&quot;</span><span class="delimiter">)</span>

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> def <a title="=&gt; Seq[org.scalatra.Route]" id="org.scalatra.atmosphere;AtmosphereSupport.atmosphereRoutes">atmosphereRoutes</a> = <a href="../ScalatraBase.scala.html#org.scalatra;ScalatraBase.routes" title="=&gt; org.scalatra.RouteRegistry">routes</a>.<a href="../RouteRegistry.scala.html#org.scalatra;RouteRegistry.methodRoutes" title="=&gt; scala.collection.mutable.Map[org.scalatra.HttpMethod,Seq[org.scalatra.Route]]">methodRoutes</a>.<span title="(key: org.scalatra.HttpMethod, default: =&gt; Seq[org.scalatra.Route])Seq[org.scalatra.Route]">getOrElse</span><span class="delimiter">(</span><a href="../HttpMethod.scala.html#org.scalatra.Get" title="org.scalatra.Get.type">Get</a>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.noGetRoute" title="=&gt; Nothing">noGetRoute</a><span class="delimiter">)</span>.<span title="(p: org.scalatra.Route =&gt; Boolean)Seq[org.scalatra.Route]">filter</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereRoutes.$anonfun.x$3" title="org.scalatra.Route">_</a>.<a href="../route.scala.html#org.scalatra;Route.metadata" title="=&gt; Map[Symbol,Any]">metadata</a>.<span title="(key: Symbol)Boolean">contains</span><span class="delimiter">(</span><span title="(name: String)Symbol" class="symbol">'Atmosphere</span><span class="delimiter">)</span><span class="delimiter">)</span>

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> def <a title="(req: javax.servlet.http.HttpServletRequest)Option[org.scalatra.MatchedRoute]" id="org.scalatra.atmosphere;AtmosphereSupport.atmosphereRoute">atmosphereRoute</a><span class="delimiter">(</span><a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.atmosphere;AtmosphereSupport.atmosphereRoute.req">req</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span><span class="delimiter">)</span> = <span class="delimiter">(</span>for <span class="delimiter">{</span>
    <a title="org.scalatra.Route" id="org.scalatra.atmosphere;AtmosphereSupport.atmosphereRoute.$anonfun.route">route</a> &lt;- <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereRoutes" title="=&gt; Seq[org.scalatra.Route]">atmosphereRoutes</a>.<span title="(f: org.scalatra.Route =&gt; scala.collection.GenTraversableOnce[org.scalatra.MatchedRoute])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[org.scalatra.Route],org.scalatra.MatchedRoute,scala.collection.immutable.Stream[org.scalatra.MatchedRoute]])scala.collection.immutable.Stream[org.scalatra.MatchedRoute]">toStream</span>
    <a title="org.scalatra.MatchedRoute" id="org.scalatra.atmosphere;AtmosphereSupport.atmosphereRoute.$anonfun.$anonfun.matched">matched</a> &lt;- <a href="../route.scala.html#org.scalatra;Route.apply" title="(requestPath: String)Option[org.scalatra.MatchedRoute]">route</a><span title="(f: org.scalatra.MatchedRoute =&gt; org.scalatra.MatchedRoute)Option[org.scalatra.MatchedRoute]" class="delimiter">(</span><a href="../ScalatraBase.scala.html#org.scalatra;ScalatraBase.requestPath" title="(implicit request: javax.servlet.http.HttpServletRequest)String">requestPath</a><span class="delimiter">)</span>
  <span class="delimiter">}</span> yield <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereRoute.$anonfun.$anonfun.matched" title="org.scalatra.MatchedRoute">matched</a><span class="delimiter">)</span>.<span title="=&gt; Option[org.scalatra.MatchedRoute]">headOption</span>

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> def <a title="()Unit" id="org.scalatra.atmosphere;AtmosphereSupport.configureBroadcasterFactory">configureBroadcasterFactory</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="org.atmosphere.cpr.ScalatraBroadcasterFactory" id="org.scalatra.atmosphere;AtmosphereSupport.configureBroadcasterFactory.factory">factory</a> = new <a href="../../atmosphere/cpr/ScalatraBroadcasterFactory.scala.html#org.atmosphere.cpr;ScalatraBroadcasterFactory" title="org.atmosphere.cpr.ScalatraBroadcasterFactory">ScalatraBroadcasterFactory</a><span class="delimiter">(</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<span title="()org.atmosphere.cpr.AtmosphereConfig">getAtmosphereConfig</span>,
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.broadcasterConfig" title="=&gt; org.atmosphere.cpr.BroadcasterConf">broadcasterConfig</a><span class="delimiter">)</span>
    <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<span title="(x$1: String)org.atmosphere.cpr.AtmosphereFramework">setDefaultBroadcasterClassName</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.broadcasterConfig" title="=&gt; org.atmosphere.cpr.BroadcasterConf">broadcasterConfig</a>.<a href="../../atmosphere/cpr/broadcaster_configs.scala.html#org.atmosphere.cpr;BroadcasterConf.broadcasterClass" title="=&gt; Class[_ &lt;: org.scalatra.atmosphere.ScalatraBroadcaster]">broadcasterClass</a>.<span title="()String">getName</span><span class="delimiter">)</span>
    <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<span title="(x$1: org.atmosphere.cpr.BroadcasterFactory)org.atmosphere.cpr.AtmosphereFramework">setBroadcasterFactory</span><span title="Unit" class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.configureBroadcasterFactory.factory" title="org.atmosphere.cpr.ScalatraBroadcasterFactory">factory</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> def <a title="()Unit" id="org.scalatra.atmosphere;AtmosphereSupport.configureBroadcasterCache">configureBroadcasterCache</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<a href="../util/RicherString.scala.html#org.scalatra.util.RicherString.stringToRicherString" title="implicit org.scalatra.util.RicherString.stringToRicherString : (s: String)org.scalatra.util.RicherString">getBroadcasterCacheClassName</a>.<a href="../util/RicherString.scala.html#org.scalatra.util;RicherString.isBlank" title="=&gt; Boolean">isBlank</a><span class="delimiter">)</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<span title="(x$1: String)org.atmosphere.cpr.AtmosphereFramework">setBroadcasterCacheClassName</span><span title="Unit" class="delimiter">(</span>classOf<span title="Class[org.atmosphere.cache.UUIDBroadcasterCache](classOf[org.atmosphere.cache.UUIDBroadcasterCache])" class="delimiter">[</span>UUIDBroadcasterCache<span class="delimiter">]</span>.<span title="()String">getName</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private<span class="delimiter">[</span>atmosphere<span class="delimiter">]</span> val <a title="org.scalatra.RouteTransformer" id="org.scalatra.atmosphere;AtmosphereSupport.Atmosphere">Atmosphere</a>: <a href="../package.scala.html#org.scalatra.package;RouteTransformer" title="org.scalatra.RouteTransformer">RouteTransformer</a> = <span class="delimiter">{</span> <span class="delimiter">(</span>route: <a href="../route.scala.html#org.scalatra;Route" title="org.scalatra.Route">Route</a><span class="delimiter">)</span> =&gt;
    <a href="#org.scalatra.atmosphere;AtmosphereSupport.Atmosphere.$anonfun.route" title="org.scalatra.Route">route</a>.<a href="../route.scala.html#org.scalatra;Route.copy$default$1" title="Seq[org.scalatra.RouteMatcher] @scala.reflect.internal.annotations.uncheckedBounds" id="org.scalatra.atmosphere;AtmosphereSupport.Atmosphere.$anonfun.x$7">copy</a><span class="delimiter">(</span>metadata = <a href="#org.scalatra.atmosphere;AtmosphereSupport.Atmosphere.$anonfun.route" title="org.scalatra.Route">route</a>.<a href="../route.scala.html#org.scalatra;Route.metadata" title="=&gt; Map[Symbol,Any]">metadata</a> <a title="scala.collection.immutable.Map[Symbol,Any] @scala.reflect.internal.annotations.uncheckedBounds" id="org.scalatra.atmosphere;AtmosphereSupport.Atmosphere.$anonfun.x$4">+</a> <span class="delimiter">(</span><span title="(self: Symbol)ArrowAssoc[Symbol]" class="symbol">'Atmosphere</span> <span title="(y: Symbol)(Symbol, Symbol)">-&gt;</span> <span title="(name: String)Symbol" class="symbol">'Atmosphere</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(transformers: org.scalatra.RouteTransformer*)(block: =&gt; org.scalatra.atmosphere.AtmosphereClient)org.scalatra.Route" id="org.scalatra.atmosphere;AtmosphereSupport.atmosphere">atmosphere</a><span class="delimiter">(</span><a title="org.scalatra.RouteTransformer*" id="org.scalatra.atmosphere;AtmosphereSupport.atmosphere.transformers">transformers</a>: <span title="org.scalatra.RouteTransformer*">RouteTransformer</span>*<span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; org.scalatra.atmosphere.AtmosphereClient" id="org.scalatra.atmosphere;AtmosphereSupport.atmosphere.block">block</a>: =&gt; AtmosphereClient<span class="delimiter">)</span> = <span class="delimiter">{</span>
    val newTransformers = <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphere.transformers" title="org.scalatra.RouteTransformer*">transformers</a> <a title="Seq[org.scalatra.RouteTransformer]" id="org.scalatra.atmosphere;AtmosphereSupport.atmosphere.newTransformers">:+</a> <a href="#org.scalatra.atmosphere;AtmosphereSupport.Atmosphere" title="=&gt; org.scalatra.RouteTransformer">Atmosphere</a>
    <a href="../ScalatraBase.scala.html#org.scalatra;ScalatraBase.get" title="(transformers: org.scalatra.RouteTransformer*)(action: =&gt; Any)org.scalatra.Route">get</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphere.newTransformers" title="Seq[org.scalatra.RouteTransformer]">newTransformers</a>:_*<span class="delimiter">)</span><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphere.block" title="=&gt; org.scalatra.atmosphere.AtmosphereClient">block</a><span class="delimiter">)</span>
    <a href="../ScalatraBase.scala.html#org.scalatra;ScalatraBase.post" title="(transformers: org.scalatra.RouteTransformer*)(action: =&gt; Any)org.scalatra.Route">post</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphere.newTransformers" title="Seq[org.scalatra.RouteTransformer]">newTransformers</a>:_*<span class="delimiter">)</span><span class="delimiter">{</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Hack to support Tomcat AIO like other WebServer. This method is invoked
   * by Tomcat when it detect a [[javax.servlet.Servlet]] implements the interface
   * [[org.apache.catalina.CometProcessor]] without invoking [[javax.servlet.Servlet#service]]
   *
   * @param cometEvent the [[org.apache.catalina.CometEvent]]
   * @throws java.io.IOException
   * @throws javax.servlet.ServletException
   */</span>
  @throws<span class="delimiter">(</span>classOf<span class="delimiter">[</span>IOException<span class="delimiter">]</span><span class="delimiter">)</span>
  @throws<span class="delimiter">(</span>classOf<span class="delimiter">[</span>ServletException<span class="delimiter">]</span><span class="delimiter">)</span>
  def <a title="(cometEvent: org.apache.catalina.CometEvent)Unit" id="org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507)">event</a><span class="delimiter">(</span><a title="org.apache.catalina.CometEvent" id="org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).cometEvent">cometEvent</a>: org.apache.catalina.<span title="org.apache.catalina.CometEvent">CometEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).req">req</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).cometEvent" title="org.apache.catalina.CometEvent">cometEvent</a>.<span title="()javax.servlet.http.HttpServletRequest">getHttpServletRequest</span>
    val <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).res">res</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).cometEvent" title="org.apache.catalina.CometEvent">cometEvent</a>.<span title="()javax.servlet.http.HttpServletResponse">getHttpServletResponse</span>
    <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="(x$1: String, x$2: Any)Unit">setAttribute</span><span class="delimiter">(</span>TomcatCometSupport.<span title="String(&quot;CometEvent&quot;)">COMET_EVENT</span>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).cometEvent" title="org.apache.catalina.CometEvent">cometEvent</a><span class="delimiter">)</span>

    <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<a href="ScalatraAtmosphereFramework.scala.html#org.scalatra.atmosphere;ScalatraAtmosphereFramework.setupTomcat" title="()Unit">setupTomcat</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="../ScalatraBase.scala.html#org.scalatra;ScalatraBase.handle" title="(request: javax.servlet.http.HttpServletRequest, response: javax.servlet.http.HttpServletResponse)Unit">handle</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).req" title="javax.servlet.http.HttpServletRequest">req</a>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).res" title="javax.servlet.http.HttpServletResponse">res</a><span class="delimiter">)</span>

    val <a title="String" id="org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).transport">transport</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).cometEvent" title="org.apache.catalina.CometEvent">cometEvent</a>.<span title="()javax.servlet.http.HttpServletRequest">getHttpServletRequest</span>.<span title="(x$1: String)String">getParameter</span><span class="delimiter">(</span>HeaderConfig.<span title="String(&quot;X-Atmosphere-Transport&quot;)">X_ATMOSPHERE_TRANSPORT</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).transport" title="String">transport</a> <span title="(x$1: Any)Boolean">!=</span> null <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).transport" title="String">transport</a>.<span title="(x$1: String)Boolean">equalsIgnoreCase</span><span class="delimiter">(</span>HeaderConfig.<span title="String(&quot;websocket&quot;)">WEBSOCKET_TRANSPORT</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(7cfa315507).cometEvent" title="org.apache.catalina.CometEvent">cometEvent</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Hack to support Tomcat 7 AIO
   */</span>
  @throws<span class="delimiter">(</span>classOf<span class="delimiter">[</span>IOException<span class="delimiter">]</span><span class="delimiter">)</span>
  @throws<span class="delimiter">(</span>classOf<span class="delimiter">[</span>ServletException<span class="delimiter">]</span><span class="delimiter">)</span>
  def <a title="(cometEvent: org.apache.catalina.comet.CometEvent)Unit" id="org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c)">event</a><span class="delimiter">(</span><a title="org.apache.catalina.comet.CometEvent" id="org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).cometEvent">cometEvent</a>: org.apache.catalina.comet.<span title="org.apache.catalina.comet.CometEvent">CometEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).req">req</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).cometEvent" title="org.apache.catalina.comet.CometEvent">cometEvent</a>.<span title="()javax.servlet.http.HttpServletRequest">getHttpServletRequest</span>
    val <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).res">res</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).cometEvent" title="org.apache.catalina.comet.CometEvent">cometEvent</a>.<span title="()javax.servlet.http.HttpServletResponse">getHttpServletResponse</span>
    <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="(x$1: String, x$2: Any)Unit">setAttribute</span><span class="delimiter">(</span>Tomcat7CometSupport.<span title="String(&quot;CometEvent&quot;)">COMET_EVENT</span>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).cometEvent" title="org.apache.catalina.comet.CometEvent">cometEvent</a><span class="delimiter">)</span>

    <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<a href="ScalatraAtmosphereFramework.scala.html#org.scalatra.atmosphere;ScalatraAtmosphereFramework.setupTomcat7" title="()Unit">setupTomcat7</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="../ScalatraBase.scala.html#org.scalatra;ScalatraBase.handle" title="(request: javax.servlet.http.HttpServletRequest, response: javax.servlet.http.HttpServletResponse)Unit">handle</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).req" title="javax.servlet.http.HttpServletRequest">req</a>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).res" title="javax.servlet.http.HttpServletResponse">res</a><span class="delimiter">)</span>

    val <a title="String" id="org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).transport">transport</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).cometEvent" title="org.apache.catalina.comet.CometEvent">cometEvent</a>.<span title="()javax.servlet.http.HttpServletRequest">getHttpServletRequest</span>.<span title="(x$1: String)String">getParameter</span><span class="delimiter">(</span>HeaderConfig.<span title="String(&quot;X-Atmosphere-Transport&quot;)">X_ATMOSPHERE_TRANSPORT</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).transport" title="String">transport</a> <span title="(x$1: Any)Boolean">!=</span> null <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).transport" title="String">transport</a>.<span title="(x$1: String)Boolean">equalsIgnoreCase</span><span class="delimiter">(</span>HeaderConfig.<span title="String(&quot;websocket&quot;)">WEBSOCKET_TRANSPORT</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(19104aa52c).cometEvent" title="org.apache.catalina.comet.CometEvent">cometEvent</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Hack to support JBossWeb AIO like other WebServer. This method is invoked
   * by Tomcat when it detect a [[javax.servlet.Servlet]] implements the interface
   * [[org.jboss.servlet.http.HttpEventServlet]] without invoking [[javax.servlet.Servlet#service]]
   *
   * @param httpEvent the [[org.jboss.servlet.http.HttpEvent]]
   * @throws java.io.IOException
   * @throws javax.servlet.ServletException
   */</span>
  @throws<span class="delimiter">(</span>classOf<span class="delimiter">[</span>IOException<span class="delimiter">]</span><span class="delimiter">)</span>
  @throws<span class="delimiter">(</span>classOf<span class="delimiter">[</span>ServletException<span class="delimiter">]</span><span class="delimiter">)</span>
  def <a title="(httpEvent: org.jboss.servlet.http.HttpEvent)Unit" id="org.scalatra.atmosphere;AtmosphereSupport.event(c5233b0da9)">event</a><span class="delimiter">(</span><a title="org.jboss.servlet.http.HttpEvent" id="org.scalatra.atmosphere;AtmosphereSupport.event(c5233b0da9).httpEvent">httpEvent</a>: <span title="org.jboss.servlet.http.HttpEvent">HttpEvent</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.atmosphere;AtmosphereSupport.event(c5233b0da9).req">req</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(c5233b0da9).httpEvent" title="org.jboss.servlet.http.HttpEvent">httpEvent</a>.<span title="()javax.servlet.http.HttpServletRequest">getHttpServletRequest</span>
    val <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.atmosphere;AtmosphereSupport.event(c5233b0da9).res">res</a> = <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(c5233b0da9).httpEvent" title="org.jboss.servlet.http.HttpEvent">httpEvent</a>.<span title="()javax.servlet.http.HttpServletResponse">getHttpServletResponse</span>
    <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(c5233b0da9).req" title="javax.servlet.http.HttpServletRequest">req</a>.<span title="(x$1: String, x$2: Any)Unit">setAttribute</span><span class="delimiter">(</span>JBossWebCometSupport.<span title="String(&quot;HttpEvent&quot;)">HTTP_EVENT</span>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(c5233b0da9).httpEvent" title="org.jboss.servlet.http.HttpEvent">httpEvent</a><span class="delimiter">)</span>

    <a href="#org.scalatra.atmosphere;AtmosphereSupport.atmosphereFramework" title="=&gt; org.scalatra.atmosphere.ScalatraAtmosphereFramework">atmosphereFramework</a>.<a href="ScalatraAtmosphereFramework.scala.html#org.scalatra.atmosphere;ScalatraAtmosphereFramework.setupJBoss" title="()Unit">setupJBoss</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="../ScalatraBase.scala.html#org.scalatra;ScalatraBase.handle" title="(request: javax.servlet.http.HttpServletRequest, response: javax.servlet.http.HttpServletResponse)Unit">handle</a><span class="delimiter">(</span><a href="#org.scalatra.atmosphere;AtmosphereSupport.event(c5233b0da9).req" title="javax.servlet.http.HttpServletRequest">req</a>, <a href="#org.scalatra.atmosphere;AtmosphereSupport.event(c5233b0da9).res" title="javax.servlet.http.HttpServletResponse">res</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

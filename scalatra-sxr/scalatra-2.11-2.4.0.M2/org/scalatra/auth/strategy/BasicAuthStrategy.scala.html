<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>org/scalatra/auth/strategy/BasicAuthStrategy.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
package org.scalatra
package auth
package strategy

import util.<a href="../../util/RicherString.scala.html#org.scalatra.util.RicherString" title="org.scalatra.util.RicherString.type">RicherString</a>._
import org.scalatra.auth.<span class="delimiter">{</span>ScentrySupport, ScentryStrategy<span class="delimiter">}</span>
import net.iharder.Base64
import java.util.Locale
import javax.servlet.http.<span class="delimiter">{</span>HttpServletResponse, HttpServletRequest<span class="delimiter">}</span>
import io.Codec

trait <a title="trait RemoteAddress extends AnyRef" id="org.scalatra.auth.strategy;RemoteAddress">RemoteAddress</a> <span title="Unit" class="delimiter">{</span> self: ScentryStrategy<span class="delimiter">[</span>_<span class="delimiter">]</span>  =&gt;

  protected def <a title="(implicit request: javax.servlet.http.HttpServletRequest)String" id="org.scalatra.auth.strategy;RemoteAddress.remoteAddress">remoteAddress</a><span class="delimiter">(</span>implicit <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy;RemoteAddress.remoteAddress.request">request</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span><span class="delimiter">)</span> =<span class="delimiter">{</span>
    val <a title="String" id="org.scalatra.auth.strategy;RemoteAddress.remoteAddress.proxied">proxied</a> = <a href="#org.scalatra.auth.strategy;RemoteAddress.remoteAddress.request" title="javax.servlet.http.HttpServletRequest">request</a>.<span title="(x$1: String)String">getHeader</span><span class="delimiter">(</span><span title="String(&quot;X-FORWARDED-FOR&quot;)" class="string">&quot;X-FORWARDED-FOR&quot;</span><span class="delimiter">)</span>
    val <a title="String" id="org.scalatra.auth.strategy;RemoteAddress.remoteAddress.res">res</a> = if <span class="delimiter">(</span><a href="../../util/RicherString.scala.html#org.scalatra.util.RicherString.stringToRicherString" title="implicit org.scalatra.util.RicherString.stringToRicherString : (s: String)org.scalatra.util.RicherString">proxied</a>.<a href="../../util/RicherString.scala.html#org.scalatra.util;RicherString.nonBlank" title="=&gt; Boolean">nonBlank</a><span class="delimiter">)</span> <a href="#org.scalatra.auth.strategy;RemoteAddress.remoteAddress.proxied" title="String">proxied</a> else <a href="#org.scalatra.auth.strategy;RemoteAddress.remoteAddress.request" title="javax.servlet.http.HttpServletRequest">request</a>.<span title="()String">getRemoteAddr</span>
    <a href="#org.scalatra.auth.strategy;RemoteAddress.remoteAddress.res" title="String">res</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Provides a hook for the basic auth strategy
 *
 * for more details on usage check:
 * https://gist.github.com/732347
 */</span>
trait <a title="trait BasicAuthSupport[UserType &lt;: AnyRef] extends AnyRef" id="org.scalatra.auth.strategy;BasicAuthSupport">BasicAuthSupport</a><span class="delimiter">[</span><a title=" &lt;: AnyRef" id="org.scalatra.auth.strategy;BasicAuthSupport;UserType">UserType</a> &lt;: AnyRef<span class="delimiter">]</span> <span title="Unit" class="delimiter">{</span> self: <span class="delimiter">(</span>ScalatraBase with ScentrySupport<span class="delimiter">[</span>UserType<span class="delimiter">]</span><span class="delimiter">)</span>  =&gt;

  def <a title="=&gt; String" id="org.scalatra.auth.strategy;BasicAuthSupport.realm">realm</a>: <span title="String">String</span>


  protected def <a title="()(implicit request: javax.servlet.http.HttpServletRequest, implicit response: javax.servlet.http.HttpServletResponse)Option[UserType]" id="org.scalatra.auth.strategy;BasicAuthSupport.basicAuth">basicAuth</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">(</span>implicit <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy;BasicAuthSupport.basicAuth.request">request</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.auth.strategy;BasicAuthSupport.basicAuth.response">response</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    val <a title="org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest" id="org.scalatra.auth.strategy;BasicAuthSupport.basicAuth.baReq">baReq</a> = new <a href="#org.scalatra.auth.strategy.BasicAuthStrategy" title="org.scalatra.auth.strategy.BasicAuthStrategy.type">BasicAuthStrategy</a>.<a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest" title="org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest">BasicAuthRequest</a><span class="delimiter">(</span><a href="#org.scalatra.auth.strategy;BasicAuthSupport.basicAuth.request" title="javax.servlet.http.HttpServletRequest">request</a><span class="delimiter">)</span>
    if<span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#org.scalatra.auth.strategy;BasicAuthSupport.basicAuth.baReq" title="org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest">baReq</a>.<a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.providesAuth" title="=&gt; Boolean">providesAuth</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#org.scalatra.auth.strategy;BasicAuthSupport.basicAuth.response" title="javax.servlet.http.HttpServletResponse">response</a>.<span title="(x$1: String, x$2: String)Unit">setHeader</span><span class="delimiter">(</span><span title="String(&quot;WWW-Authenticate&quot;)" class="string">&quot;WWW-Authenticate&quot;</span>, <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Basic realm=\&quot;%s\&quot;&quot;</span> <span title="(args: Any*)String">format</span> <a href="#org.scalatra.auth.strategy;BasicAuthSupport.realm" title="=&gt; String">realm</a><span class="delimiter">)</span>
      <a href="../../control.scala.html#org.scalatra;Control.halt(aaab4af702)" title="(status: Integer, body: String, headers: Map[String,String], reason: String)(implicit evidence$1: Manifest[String])Nothing">halt</a><span title="(clazz: Class[_])scala.reflect.Manifest[String]" class="delimiter">(</span><span title="implicit scala.Predef.int2Integer : (x: Int)Integer" class="int">401</span>, <span title="String(&quot;Unauthenticated&quot;)" class="string">&quot;Unauthenticated&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    if<span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#org.scalatra.auth.strategy;BasicAuthSupport.basicAuth.baReq" title="org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest">baReq</a>.<a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.isBasicAuth" title="=&gt; Boolean">isBasicAuth</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../control.scala.html#org.scalatra;Control.halt(aaab4af702)" title="(status: Integer, body: String, headers: Map[String,String], reason: String)(implicit evidence$1: Manifest[String])Nothing">halt</a><span title="(clazz: Class[_])scala.reflect.Manifest[String]" class="delimiter">(</span><span title="implicit scala.Predef.int2Integer : (x: Int)Integer" class="int">400</span>, <span title="String(&quot;Bad Request&quot;)" class="string">&quot;Bad Request&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="../ScentrySupport.scala.html#org.scalatra.auth;ScentrySupport.scentry" title="(implicit request: javax.servlet.http.HttpServletRequest)org.scalatra.auth.Scentry[UserType]">scentry</a>.<a href="../Scentry.scala.html#org.scalatra.auth;Scentry.authenticate(1fbf7e616f)" title="(names: String*)(implicit request: javax.servlet.http.HttpServletRequest, implicit response: javax.servlet.http.HttpServletResponse)Option[UserType]">authenticate</a><a href="#org.scalatra.auth.strategy;BasicAuthSupport.basicAuth.request" title="javax.servlet.http.HttpServletRequest" class="delimiter">(</a><span title="String(&quot;Basic&quot;)" class="string">&quot;Basic&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

object <a title="org.scalatra.auth.strategy.BasicAuthStrategy.type" id="org.scalatra.auth.strategy.BasicAuthStrategy">BasicAuthStrategy</a> <a href="#org.scalatra.auth.strategy.BasicAuthStrategy" title="org.scalatra.auth.strategy.BasicAuthStrategy.type" class="delimiter">{</a>

  private val <a title="List[String]" id="org.scalatra.auth.strategy.BasicAuthStrategy.AUTHORIZATION_KEYS">AUTHORIZATION_KEYS</a> = <span title="(xs: String*)List[String]">List</span><span class="delimiter">(</span><span title="String(&quot;Authorization&quot;)" class="string">&quot;Authorization&quot;</span>, <span title="String(&quot;HTTP_AUTHORIZATION&quot;)" class="string">&quot;HTTP_AUTHORIZATION&quot;</span>, <span title="String(&quot;X-HTTP_AUTHORIZATION&quot;)" class="string">&quot;X-HTTP_AUTHORIZATION&quot;</span>, <span title="String(&quot;X_HTTP_AUTHORIZATION&quot;)" class="string">&quot;X_HTTP_AUTHORIZATION&quot;</span><span class="delimiter">)</span>
  class <a title="class BasicAuthRequest extends AnyRef" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest">BasicAuthRequest</a><a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest" title="org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest" class="delimiter">(</a><a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.r">r</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span><span class="delimiter">)</span> <span class="delimiter">{</span>

    def <a title="=&gt; List[String]" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.parts">parts</a> = <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.authorizationKey" title="=&gt; Option[String]">authorizationKey</a> <span title="(f: String =&gt; List[String])Option[List[String]]">map</span> <span class="delimiter">{</span> <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.r" title="javax.servlet.http.HttpServletRequest">r</a>.<span title="(x$1: String)String">getHeader</span><span class="delimiter">(</span><a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.parts.$anonfun.x$1" title="String">_</a><span class="delimiter">)</span>.<span title="(x$1: String, x$2: Int)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="String(&quot; &quot;)" class="string">&quot; &quot;</span>, <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>.<span title="=&gt; List[String]">toList</span> <span class="delimiter">}</span> <span title="(default: =&gt; List[String])List[String]">getOrElse</span> <span title="scala.collection.immutable.Nil.type">Nil</span>
    def <a title="=&gt; Option[String]" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.scheme">scheme</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.parts" title="=&gt; List[String]">parts</a>.<span title="=&gt; Option[String]">headOption</span>.<span title="(f: String =&gt; String)Option[String]">map</span><span class="delimiter">(</span><a title="String" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.scheme.$anonfun.sch">sch</a> =&gt; <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.scheme.$anonfun.sch" title="String">sch</a>.<span title="(x$1: java.util.Locale)String">toLowerCase</span><span class="delimiter">(</span><span title="java.util.Locale.type">Locale</span>.<span title="java.util.Locale">ENGLISH</span><span class="delimiter">)</span><span class="delimiter">)</span>
    def <a title="=&gt; Option[String]" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.params">params</a> = <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.parts" title="=&gt; List[String]">parts</a>.<span title="=&gt; Option[String]">lastOption</span>

    private def <a title="=&gt; Option[String]" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.authorizationKey">authorizationKey</a> = <a href="#org.scalatra.auth.strategy.BasicAuthStrategy.AUTHORIZATION_KEYS" title="=&gt; List[String]">AUTHORIZATION_KEYS</a>.<span title="(p: String =&gt; Boolean)Option[String]">find</span><span class="delimiter">(</span><a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.r" title="javax.servlet.http.HttpServletRequest">r</a>.<span title="(x$1: String)String">getHeader</span><span class="delimiter">(</span><a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.authorizationKey.$anonfun.x$2" title="String">_</a><span class="delimiter">)</span> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span>

    def <a title="=&gt; Boolean" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.isBasicAuth">isBasicAuth</a> = <span class="delimiter">(</span>false <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.isBasicAuth.x$3" title="(z: Boolean)(op: (Boolean, String) =&gt; Boolean)Boolean">/:</a> <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.scheme" title="(xo: Option[String])Iterable[String]">scheme</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="Boolean" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.isBasicAuth.$anonfun.x$4">_</a>, <a title="String" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.isBasicAuth.$anonfun.sch">sch</a><span class="delimiter">)</span> =&gt; <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.isBasicAuth.$anonfun.sch" title="String">sch</a> <span title="(x$1: Any)Boolean">==</span> <span title="String(&quot;basic&quot;)" class="string">&quot;basic&quot;</span> <span class="delimiter">}</span>
    def <a title="=&gt; Boolean" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.providesAuth">providesAuth</a> = <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.authorizationKey" title="=&gt; Option[String]">authorizationKey</a>.<span title="=&gt; Boolean">isDefined</span>

    private<span class="delimiter">[</span>this<span class="delimiter">]</span> var <a title="Option[(String, String)]" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest._credentials">_credentials</a>: <span title="Option[(String, String)]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span>String, String<span class="delimiter">)</span><span class="delimiter">]</span> = <span title="None.type">None</span>
    def <a title="=&gt; Option[(String, String)]" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials">credentials</a> = <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest._credentials" title="Option[(String, String)]">_credentials</a>.<span title="=&gt; Boolean">isEmpty</span> <span class="delimiter">)</span>
        <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest._credentials" title="Option[(String, String)]">_credentials</a> = <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.params" title="=&gt; Option[String]">params</a> <span title="(f: String =&gt; (String, String))Option[(String, String)]">map</span> <span class="delimiter">{</span> <a title="String" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials.$anonfun.p">p</a> =&gt;
          <span class="delimiter">(</span>null.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="(String, String)" class="delimiter">[</span><span title="(String, String)" class="delimiter">(</span>String, String<span class="delimiter">)</span><span class="delimiter">]</span> <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials.$anonfun.x$5" title="(z: (String, String))(op: ((String, String), String) =&gt; (String, String))(String, String)">/:</a> new <span title="String">String</span><span class="delimiter">(</span><span title="net.iharder.Base64.type">Base64</span>.<span title="(x$1: String)Array[Byte]">decode</span><span class="delimiter">(</span><a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials.$anonfun.p" title="String">p</a><span class="delimiter">)</span>, <span title="scala.io.Codec.type">Codec</span>.<span title="=&gt; scala.io.Codec">UTF8</span>.<span title="=&gt; java.nio.charset.Charset">charSet</span><span class="delimiter">)</span>.<span title="(x$1: String, x$2: Int)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="String(&quot;:&quot;)" class="string">&quot;:&quot;</span>, <span title="Int(2)" class="int">2</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="(String, String)" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials.$anonfun.$anonfun.t">t</a>, <a title="String" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials.$anonfun.$anonfun.l">l</a><span class="delimiter">)</span> =&gt;
            if<span class="delimiter">(</span><a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials.$anonfun.$anonfun.t" title="(String, String)">t</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span> <span title="(_1: String, _2: Null)(String, Null)" class="delimiter">(</span><a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials.$anonfun.$anonfun.l" title="String">l</a>, null<span class="delimiter">)</span> else <span title="(_1: String, _2: String)(String, String)" class="delimiter">(</span><a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials.$anonfun.$anonfun.t" title="(String, String)">t</a>.<span title="=&gt; String">_1</span>, <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials.$anonfun.$anonfun.l" title="String">l</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest._credentials" title="Option[(String, String)]">_credentials</a>
    <span class="delimiter">}</span>
    def <a title="=&gt; String" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.username">username</a> = <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials" title="=&gt; Option[(String, String)]">credentials</a> <span title="(f: ((String, String)) =&gt; String)Option[String]">map</span> <span class="delimiter">{</span> <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.username.$anonfun.x$6" title="(String, String)">_</a>.<span title="=&gt; String">_1</span> <span class="delimiter">}</span> <span title="(default: =&gt; String)String">getOrElse</span> null
    def <a title="=&gt; String" id="org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.password">password</a> = <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.credentials" title="=&gt; Option[(String, String)]">credentials</a> <span title="(f: ((String, String)) =&gt; String)Option[String]">map</span> <span class="delimiter">{</span> <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.password.$anonfun.x$7" title="(String, String)">_</a>.<span title="=&gt; String">_2</span> <span class="delimiter">}</span> <span title="(default: =&gt; String)String">getOrElse</span> null
  <span class="delimiter">}</span>
<a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest" title="AnyRef" class="delimiter">}</a>
abstract class <a title="class BasicAuthStrategy[UserType &lt;: AnyRef] extends AnyRef with org.scalatra.auth.ScentryStrategy[UserType] with org.scalatra.auth.strategy.RemoteAddress" id="org.scalatra.auth.strategy;BasicAuthStrategy">BasicAuthStrategy</a><span class="delimiter">[</span><a title=" &lt;: AnyRef" id="org.scalatra.auth.strategy;BasicAuthStrategy;UserType">UserType</a> &lt;: AnyRef<span class="delimiter">]</span><a href="#org.scalatra.auth.strategy;BasicAuthStrategy" title="org.scalatra.auth.strategy.BasicAuthStrategy[UserType]" class="delimiter">(</a>protected val <a title="org.scalatra.ScalatraBase" id="org.scalatra.auth.strategy;BasicAuthStrategy.app">app</a>: <a href="../../ScalatraBase.scala.html#org.scalatra;ScalatraBase" title="org.scalatra.ScalatraBase">ScalatraBase</a>, <a title="String" id="org.scalatra.auth.strategy;BasicAuthStrategy.realm">realm</a>: <span title="String">String</span><span class="delimiter">)</span>
  extends <a href="../ScentryStrategy.scala.html#org.scalatra.auth;ScentryStrategy" title="org.scalatra.auth.ScentryStrategy[UserType]">ScentryStrategy</a><span class="delimiter">[</span>UserType<span class="delimiter">]</span>
  with <a href="#org.scalatra.auth.strategy;RemoteAddress" title="org.scalatra.auth.strategy.RemoteAddress">RemoteAddress</a> <span class="delimiter">{</span>

  import <a href="#org.scalatra.auth.strategy.BasicAuthStrategy" title="org.scalatra.auth.strategy.BasicAuthStrategy.type">BasicAuthStrategy</a>._

  private<span class="delimiter">[</span>this<span class="delimiter">]</span> val <a title="String" id="org.scalatra.auth.strategy;BasicAuthStrategy.REMOTE_USER">REMOTE_USER</a> = <span title="String(&quot;REMOTE_USER&quot;)" class="string">&quot;REMOTE_USER&quot;</span>

  implicit def <a title="implicit org.scalatra.auth.strategy.BasicAuthStrategy.request2BasicAuthRequest : (r: javax.servlet.http.HttpServletRequest)org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest" id="org.scalatra.auth.strategy;BasicAuthStrategy.request2BasicAuthRequest">request2BasicAuthRequest</a><span class="delimiter">(</span><a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy;BasicAuthStrategy.request2BasicAuthRequest.r">r</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span><span class="delimiter">)</span> = new <a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest" title="org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest">BasicAuthRequest</a><span class="delimiter">(</span><a href="#org.scalatra.auth.strategy;BasicAuthStrategy.request2BasicAuthRequest.r" title="javax.servlet.http.HttpServletRequest">r</a><span class="delimiter">)</span>

  protected def <a title="=&gt; String" id="org.scalatra.auth.strategy;BasicAuthStrategy.challenge">challenge</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Basic realm=\&quot;%s\&quot;&quot;</span> <span title="(args: Any*)String">format</span> <a href="#org.scalatra.auth.strategy;BasicAuthStrategy.realm" title="String">realm</a>


  override def <a title="(implicit request: javax.servlet.http.HttpServletRequest)Boolean" id="org.scalatra.auth.strategy;BasicAuthStrategy.isValid">isValid</a><span class="delimiter">(</span>implicit <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy;BasicAuthStrategy.isValid.request">request</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span><span class="delimiter">)</span> = <a href="#org.scalatra.auth.strategy;BasicAuthStrategy.request2BasicAuthRequest" title="implicit org.scalatra.auth.strategy.BasicAuthStrategy.request2BasicAuthRequest : (r: javax.servlet.http.HttpServletRequest)org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest">request</a>.<a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.isBasicAuth" title="=&gt; Boolean">isBasicAuth</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#org.scalatra.auth.strategy;BasicAuthStrategy.request2BasicAuthRequest" title="implicit org.scalatra.auth.strategy.BasicAuthStrategy.request2BasicAuthRequest : (r: javax.servlet.http.HttpServletRequest)org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest">request</a>.<a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.providesAuth" title="=&gt; Boolean">providesAuth</a>

  def <a title="()(implicit request: javax.servlet.http.HttpServletRequest, implicit response: javax.servlet.http.HttpServletResponse)Option[UserType]" id="org.scalatra.auth.strategy;BasicAuthStrategy.authenticate">authenticate</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">(</span>implicit <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy;BasicAuthStrategy.authenticate.request">request</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.auth.strategy;BasicAuthStrategy.authenticate.response">response</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span> =
    <a href="#org.scalatra.auth.strategy;BasicAuthStrategy.validate" title="(userName: String, password: String)(implicit request: javax.servlet.http.HttpServletRequest, implicit response: javax.servlet.http.HttpServletResponse)Option[UserType]">validate</a><a href="#org.scalatra.auth.strategy;BasicAuthStrategy.authenticate.request" title="javax.servlet.http.HttpServletRequest" class="delimiter">(</a><a href="#org.scalatra.auth.strategy;BasicAuthStrategy.request2BasicAuthRequest" title="implicit org.scalatra.auth.strategy.BasicAuthStrategy.request2BasicAuthRequest : (r: javax.servlet.http.HttpServletRequest)org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest">request</a>.<a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.username" title="=&gt; String">username</a>, <a href="#org.scalatra.auth.strategy;BasicAuthStrategy.request2BasicAuthRequest" title="implicit org.scalatra.auth.strategy.BasicAuthStrategy.request2BasicAuthRequest : (r: javax.servlet.http.HttpServletRequest)org.scalatra.auth.strategy.BasicAuthStrategy.BasicAuthRequest">request</a>.<a href="#org.scalatra.auth.strategy.BasicAuthStrategy;BasicAuthRequest.password" title="=&gt; String">password</a><span class="delimiter">)</span>

  protected def <a title="(user: UserType)(implicit request: javax.servlet.http.HttpServletRequest, implicit response: javax.servlet.http.HttpServletResponse)String" id="org.scalatra.auth.strategy;BasicAuthStrategy.getUserId">getUserId</a><span class="delimiter">(</span><a title="UserType" id="org.scalatra.auth.strategy;BasicAuthStrategy.getUserId.user">user</a>: <a href="#org.scalatra.auth.strategy;BasicAuthStrategy;UserType" title="UserType">UserType</a><span class="delimiter">)</span><span class="delimiter">(</span>implicit <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy;BasicAuthStrategy.getUserId.request">request</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.auth.strategy;BasicAuthStrategy.getUserId.response">response</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span>: <span title="String">String</span>
  protected def <a title="(userName: String, password: String)(implicit request: javax.servlet.http.HttpServletRequest, implicit response: javax.servlet.http.HttpServletResponse)Option[UserType]" id="org.scalatra.auth.strategy;BasicAuthStrategy.validate">validate</a><span class="delimiter">(</span><a title="String" id="org.scalatra.auth.strategy;BasicAuthStrategy.validate.userName">userName</a>: <span title="String">String</span>, <a title="String" id="org.scalatra.auth.strategy;BasicAuthStrategy.validate.password">password</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span>implicit <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy;BasicAuthStrategy.validate.request">request</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.auth.strategy;BasicAuthStrategy.validate.response">response</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span>: <span title="Option[UserType]">Option</span><span class="delimiter">[</span>UserType<span class="delimiter">]</span>


  override def <a title="(user: UserType)(implicit request: javax.servlet.http.HttpServletRequest, implicit response: javax.servlet.http.HttpServletResponse)Unit" id="org.scalatra.auth.strategy;BasicAuthStrategy.afterSetUser">afterSetUser</a><span class="delimiter">(</span><a title="UserType" id="org.scalatra.auth.strategy;BasicAuthStrategy.afterSetUser.user">user</a>: <a href="#org.scalatra.auth.strategy;BasicAuthStrategy;UserType" title="UserType">UserType</a><span class="delimiter">)</span><span class="delimiter">(</span>implicit <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy;BasicAuthStrategy.afterSetUser.request">request</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.auth.strategy;BasicAuthStrategy.afterSetUser.response">response</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#org.scalatra.auth.strategy;BasicAuthStrategy.afterSetUser.response" title="javax.servlet.http.HttpServletResponse">response</a>.<span title="(x$1: String, x$2: String)Unit">setHeader</span><span class="delimiter">(</span><a href="#org.scalatra.auth.strategy;BasicAuthStrategy.REMOTE_USER" title="String">REMOTE_USER</a>, <a href="#org.scalatra.auth.strategy;BasicAuthStrategy.getUserId" title="(user: UserType)(implicit request: javax.servlet.http.HttpServletRequest, implicit response: javax.servlet.http.HttpServletResponse)String">getUserId</a><a href="#org.scalatra.auth.strategy;BasicAuthStrategy.afterSetUser.request" title="javax.servlet.http.HttpServletRequest" class="delimiter">(</a><a href="#org.scalatra.auth.strategy;BasicAuthStrategy.afterSetUser.user" title="UserType">user</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>


  override def <a title="()(implicit request: javax.servlet.http.HttpServletRequest, implicit response: javax.servlet.http.HttpServletResponse)Unit" id="org.scalatra.auth.strategy;BasicAuthStrategy.unauthenticated">unauthenticated</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">(</span>implicit <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy;BasicAuthStrategy.unauthenticated.request">request</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.auth.strategy;BasicAuthStrategy.unauthenticated.response">response</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#org.scalatra.auth.strategy;BasicAuthStrategy.app" title="=&gt; org.scalatra.ScalatraBase">app</a> <a href="../../control.scala.html#org.scalatra;Control.halt(7895b1044b)" title="(result: org.scalatra.ActionResult)Nothing">halt</a> <a href="../../ActionResult.scala.html#org.scalatra.Unauthorized.apply$default$1" title="Any" id="org.scalatra.auth.strategy;BasicAuthStrategy.unauthenticated.x$10">Unauthorized</a><span class="delimiter">(</span>headers = <span title="(elems: (String, String)*)scala.collection.immutable.Map[String,String]">Map</span><a title="scala.collection.immutable.Map[String,String] @scala.reflect.internal.annotations.uncheckedBounds" id="org.scalatra.auth.strategy;BasicAuthStrategy.unauthenticated.x$8" class="delimiter">(</a><span title="(self: String)ArrowAssoc[String]" class="string">&quot;WWW-Authenticate&quot;</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#org.scalatra.auth.strategy;BasicAuthStrategy.challenge" title="=&gt; String">challenge</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="(user: UserType)(implicit request: javax.servlet.http.HttpServletRequest, implicit response: javax.servlet.http.HttpServletResponse)Unit" id="org.scalatra.auth.strategy;BasicAuthStrategy.afterLogout">afterLogout</a><span class="delimiter">(</span><a title="UserType" id="org.scalatra.auth.strategy;BasicAuthStrategy.afterLogout.user">user</a>: <a href="#org.scalatra.auth.strategy;BasicAuthStrategy;UserType" title="UserType">UserType</a><span class="delimiter">)</span><span class="delimiter">(</span>implicit <a title="javax.servlet.http.HttpServletRequest" id="org.scalatra.auth.strategy;BasicAuthStrategy.afterLogout.request">request</a>: <span title="javax.servlet.http.HttpServletRequest">HttpServletRequest</span>, <a title="javax.servlet.http.HttpServletResponse" id="org.scalatra.auth.strategy;BasicAuthStrategy.afterLogout.response">response</a>: <span title="javax.servlet.http.HttpServletResponse">HttpServletResponse</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#org.scalatra.auth.strategy;BasicAuthStrategy.afterLogout.response" title="javax.servlet.http.HttpServletResponse">response</a>.<span title="(x$1: String, x$2: String)Unit">setHeader</span><span class="delimiter">(</span><a href="#org.scalatra.auth.strategy;BasicAuthStrategy.REMOTE_USER" title="String">REMOTE_USER</a>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scalikejdbc-test/scalikejdbc/specs2/AutoRollbackLike.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalikejdbc.specs2

<span class="keyword">import</span> scalikejdbc._
<span class="keyword">import</span> org.specs2.specification.After

/**
 * AutoRollback support for specs2
 */
<span class="keyword">trait</span> <a title="trait AutoRollbackLike extends Object with org.specs2.specification.After" id="9186">AutoRollbackLike</a> <span title="Unit" class="keyword">extends</span> <span title="org.specs2.specification.After">After</span> <span class="delimiter">{</span>

  /**
   * Creates a [[scalikejdbc.DB]] instance.
   * @return DB instance
   */
  <span class="keyword">def</span> <a title="()scalikejdbc.DB" id="49173">db</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../scalikejdbc/scalikejdbc/DB.scala.html#7869" title="scalikejdbc.DB">DB</a> = <a href="../../../scalikejdbc/scalikejdbc/DB.scala.html#33489" title="(conn: java.sql.Connection)scalikejdbc.DB">DB</a><span class="delimiter">(</span><a href="../../../scalikejdbc/scalikejdbc/ConnectionPool.scala.html#8350" title="scalikejdbc.ConnectionPool.type">ConnectionPool</a>.<a href="../../../scalikejdbc/scalikejdbc/ConnectionPool.scala.html#13384" title="(name: Any)java.sql.Connection">borrow</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

  /**
   * Prepares database for the test.
   * @param session db session implicitly
   */
  <span class="keyword">def</span> <a title="(implicit session: scalikejdbc.DBSession)Unit" id="49174">fixture</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalikejdbc.DBSession" id="49191">session</a>: <a href="../../../scalikejdbc/scalikejdbc/DBSession.scala.html#7794" title="scalikejdbc.DBSession">DBSession</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>

  // ------------------------------
  // before execution
  // ------------------------------
  <span class="keyword">val</span> <a title="scalikejdbc.DB" id="49175">_db</a> = <a href="#49173" title="()scalikejdbc.DB">db</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <a href="#49175" title="=&gt; scalikejdbc.DB">_db</a>.<a href="../../../scalikejdbc/scalikejdbc/DB.scala.html#45668" title="()Unit">begin</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <a href="#49175" title="=&gt; scalikejdbc.DB">_db</a>.<a href="../../../scalikejdbc/scalikejdbc/DB.scala.html#45688" title="(execution: scalikejdbc.DBSession =&gt; Unit)Unit">withinTx</a> <span class="delimiter">{</span> <span class="keyword">implicit</span> <a title="scalikejdbc.DBSession" id="49197">session</a> =&gt;
    <a href="#49174" title="(implicit session: scalikejdbc.DBSession)Unit">fixture</a><span class="delimiter">(</span><a href="#49197" title="scalikejdbc.DBSession">session</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  // ------------------------------
  // after execution
  // ------------------------------
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Any" id="49177">after</a>: <span title="Any">Any</span> = <a href="../../../scalikejdbc/scalikejdbc/package.scala.html#9664" title="(resource: scalikejdbc.DB)(f: scalikejdbc.DB =&gt; Unit)Unit">using</a><span class="delimiter">(</span><a href="#49175" title="=&gt; scalikejdbc.DB">_db</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="scalikejdbc.DB" id="49211">_db</a> =&gt;
    <a href="#49211" title="scalikejdbc.DB">_db</a>.<a href="../../../scalikejdbc/scalikejdbc/DB.scala.html#45672" title="()Unit">rollbackIfActive</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /*
   * Passes implicit DBSession instance to the block
   */
  <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="scalikejdbc.DBSession" id="49178">session</a>: <a href="../../../scalikejdbc/scalikejdbc/DBSession.scala.html#7794" title="scalikejdbc.DBSession">DBSession</a> = <a href="#49175" title="=&gt; scalikejdbc.DB">_db</a>.<a href="../../../scalikejdbc/scalikejdbc/DB.scala.html#45687" title="(tx: scalikejdbc.Tx)scalikejdbc.DBSession">withinTxSession</a><span class="delimiter">(</span><span class="delimiter">)</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>
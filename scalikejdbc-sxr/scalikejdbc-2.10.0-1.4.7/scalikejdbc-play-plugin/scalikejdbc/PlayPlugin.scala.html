<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scalikejdbc-play-plugin/scalikejdbc/PlayPlugin.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/*
 * Copyright 2012 Kazuhiro Sera
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 */
<span class="keyword">package</span> scalikejdbc

<span class="keyword">import</span> play.api._

/**
 * The Play plugin to use ScalikeJDBC
 */
<span class="keyword">class</span> <a title="class PlayPlugin extends Object with play.api.Plugin" id="8925">PlayPlugin</a><a href="#8925" title="scalikejdbc.PlayPlugin" class="delimiter">(</a><a title="play.api.Application" id="42481">app</a>: <span title="play.api.Application">Application</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="play.api.Plugin">Plugin</span> <span class="delimiter">{</span>

  <span class="keyword">import</span> <a href="#8926" title="scalikejdbc.PlayPlugin.type">PlayPlugin</a>._

  // Play DB configuration

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.api.Configuration" id="42309">playDbConfig</a> = <a href="#42481" title="play.api.Application">app</a>.<span title="=&gt; play.api.Configuration">configuration</span>.<span title="(path: String)Option[play.api.Configuration]">getConfig</span><span class="delimiter">(</span><span title="String(&quot;db&quot;)" class="string">&quot;db&quot;</span><span class="delimiter">)</span>.<span title="(default: =&gt; play.api.Configuration)play.api.Configuration">getOrElse</span><span class="delimiter">(</span><span title="play.api.Configuration.type">Configuration</span>.<span title="=&gt; play.api.Configuration">empty</span><span class="delimiter">)</span>

  // ScalikeJDBC global configuration

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.api.Configuration" id="42311">globalConfig</a> = <a href="#42481" title="play.api.Application">app</a>.<span title="=&gt; play.api.Configuration">configuration</span>.<span title="(path: String)Option[play.api.Configuration]">getConfig</span><span class="delimiter">(</span><span title="String(&quot;scalikejdbc.global&quot;)" class="string">&quot;scalikejdbc.global&quot;</span><span class="delimiter">)</span>.<span title="(default: =&gt; play.api.Configuration)play.api.Configuration">getOrElse</span><span class="delimiter">(</span><span title="play.api.Configuration.type">Configuration</span>.<span title="=&gt; play.api.Configuration">empty</span><span class="delimiter">)</span>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="play.api.Configuration" id="42313">playConfig</a> = <a href="#42481" title="play.api.Application">app</a>.<span title="=&gt; play.api.Configuration">configuration</span>.<span title="(path: String)Option[play.api.Configuration]">getConfig</span><span class="delimiter">(</span><span title="String(&quot;scalikejdbc.play&quot;)" class="string">&quot;scalikejdbc.play&quot;</span><span class="delimiter">)</span>.<span title="(default: =&gt; play.api.Configuration)play.api.Configuration">getOrElse</span><span class="delimiter">(</span><span title="play.api.Configuration.type">Configuration</span>.<span title="=&gt; play.api.Configuration">empty</span><span class="delimiter">)</span>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">val</span> <a title="String" id="42315">loggingSQLAndTime</a> = <span title="String(&quot;loggingSQLAndTime&quot;)" class="string">&quot;loggingSQLAndTime&quot;</span>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="Boolean" id="42316">closeAllOnStop</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="42317">onStart</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#42309" title="=&gt; play.api.Configuration">playDbConfig</a>.<span title="=&gt; Set[String]">subKeys</span> <span title="(f: String =&gt; Unit)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[String],Unit,scala.collection.immutable.Set[Unit]])scala.collection.immutable.Set[Unit]">map</span> <span class="delimiter">{</span>
      <a title="String" id="42833">name</a> =&gt;
        <span class="keyword">def</span> <a title="(name: String)(String, String, String, scalikejdbc.ConnectionPoolSettings)" id="42834">load</a><span class="delimiter">(</span><a title="String" id="42835">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="(String, String, String, scalikejdbc.ConnectionPoolSettings)" class="delimiter">(</span>String, String, String, ConnectionPoolSettings<span class="delimiter">)</span> = <span class="delimiter">{</span>
          <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="play.api.Configuration" id="42836">config</a> = <a href="#42309" title="=&gt; play.api.Configuration">playDbConfig</a>
          <span title="Class.type">Class</span>.<span title="(x$1: String)Class[_]">forName</span><span class="delimiter">(</span><a href="#42473" title="(name: String, key: String)(implicit config: play.api.Configuration)String">require</a><a href="#42836" title="play.api.Configuration" class="delimiter">(</a><a href="#42835" title="String">name</a>, <span title="String(&quot;driver&quot;)" class="string">&quot;driver&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="scalikejdbc.ConnectionPoolSettings" id="42837">default</a> = <a href="../../scalikejdbc/scalikejdbc/ConnectionPoolSettings.scala.html#31789" title="(initialSize: Int, maxSize: Int, validationQuery: String)scalikejdbc.ConnectionPoolSettings">ConnectionPoolSettings</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="scalikejdbc.ConnectionPoolSettings" id="42838">settings</a> = <a href="../../scalikejdbc/scalikejdbc/ConnectionPoolSettings.scala.html#31789" title="(initialSize: Int, maxSize: Int, validationQuery: String)scalikejdbc.ConnectionPoolSettings">ConnectionPoolSettings</a><span class="delimiter">(</span>
            initialSize = <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><a href="#42836" title="play.api.Configuration" class="delimiter">(</a><a href="#42835" title="String">name</a>, <span title="String(&quot;poolInitialSize&quot;)" class="string">&quot;poolInitialSize&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Int)Option[Int]">map</span><span class="delimiter">(</span><a title="String" id="42856">v</a> =&gt; <a href="#42856" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">v</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>.<span title="(default: =&gt; Int)Int">getOrElse</span><span class="delimiter">(</span><a href="#42837" title="scalikejdbc.ConnectionPoolSettings">default</a>.<a href="../../scalikejdbc/scalikejdbc/ConnectionPoolSettings.scala.html#15341" title="=&gt; Int">initialSize</a><span class="delimiter">)</span>,
            maxSize = <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><a href="#42836" title="play.api.Configuration" class="delimiter">(</a><a href="#42835" title="String">name</a>, <span title="String(&quot;poolMaxSize&quot;)" class="string">&quot;poolMaxSize&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Int)Option[Int]">map</span><span class="delimiter">(</span><a title="String" id="42869">v</a> =&gt; <a href="#42869" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">v</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>.<span title="(default: =&gt; Int)Int">getOrElse</span><span class="delimiter">(</span><a href="#42837" title="scalikejdbc.ConnectionPoolSettings">default</a>.<a href="../../scalikejdbc/scalikejdbc/ConnectionPoolSettings.scala.html#15343" title="=&gt; Int">maxSize</a><span class="delimiter">)</span>,
            validationQuery = <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><a href="#42836" title="play.api.Configuration" class="delimiter">(</a><a href="#42835" title="String">name</a>, <span title="String(&quot;poolValidationQuery&quot;)" class="string">&quot;poolValidationQuery&quot;</span><span class="delimiter">)</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><a href="#42837" title="scalikejdbc.ConnectionPoolSettings">default</a>.<a href="../../scalikejdbc/scalikejdbc/ConnectionPoolSettings.scala.html#15345" title="=&gt; String">validationQuery</a><span class="delimiter">)</span>
          <span class="delimiter">)</span>
          <span title="(_1: String, _2: String, _3: String, _4: scalikejdbc.ConnectionPoolSettings)(String, String, String, scalikejdbc.ConnectionPoolSettings)" class="delimiter">(</span><a href="#42473" title="(name: String, key: String)(implicit config: play.api.Configuration)String">require</a><a href="#42836" title="play.api.Configuration" class="delimiter">(</a><a href="#42835" title="String">name</a>, <span title="String(&quot;url&quot;)" class="string">&quot;url&quot;</span><span class="delimiter">)</span>, <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><a href="#42836" title="play.api.Configuration" class="delimiter">(</a><a href="#42835" title="String">name</a>, <span title="String(&quot;user&quot;)" class="string">&quot;user&quot;</span><span class="delimiter">)</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><a href="#42836" title="play.api.Configuration" class="delimiter">(</a><a href="#42835" title="String">name</a>, <span title="String(&quot;password&quot;)" class="string">&quot;password&quot;</span><span class="delimiter">)</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <a href="#42838" title="scalikejdbc.ConnectionPoolSettings">settings</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <a href="#42470" title="=&gt; scala.collection.mutable.ListBuffer[String]">registeredPoolNames</a>.<span title="(x$1: Unit)Unit">synchronized</span> <span class="delimiter">{</span>
          <a href="#42833" title="String">name</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#98237" title="Unit" class="string">&quot;global&quot;</a> =&gt;
              // because &quot;db.global&quot; was used as &quot;scalikejdbc.global&quot; previously
              <span title="(clazz: Class[scalikejdbc.PlayPlugin])play.api.Logger">Logger</span><span class="delimiter">(</span>classOf<span title="Class[scalikejdbc.PlayPlugin](classOf[scalikejdbc.PlayPlugin])" class="delimiter">[</span>PlayPlugin<span class="delimiter">]</span><span class="delimiter">)</span>.<span title="(message: =&gt; String)Unit">warn</span><a href="#98245" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;Configuration with \&quot;db.global\&quot; is ignored. Use \&quot;scalikejdbc.global\&quot; instead.&quot;)" class="string">&quot;Configuration with \&quot;db.global\&quot; is ignored. Use \&quot;scalikejdbc.global\&quot; instead.&quot;</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="#98237" title="Unit" class="string">&quot;default&quot;</a> =&gt;
              <a href="#98245" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#42470" title="=&gt; scala.collection.mutable.ListBuffer[String]">registeredPoolNames</a>.<span title="(elem: Any)Boolean">contains</span><span class="delimiter">(</span><span title="String(&quot;default&quot;)" class="string">&quot;default&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a href="#98227" title="(x: (String, String, String, scalikejdbc.ConnectionPoolSettings))(String, String, String, scalikejdbc.ConnectionPoolSettings)" class="delimiter">(</a><a href="#98225" title="String" id="42994">url</a>, <a href="#98225" title="String" id="42995">user</a>, <a href="#98225" title="String" id="42996">password</a>, <a href="#98225" title="scalikejdbc.ConnectionPoolSettings" id="42997">settings</a><span class="delimiter">)</span> = <a href="#42834" title="(name: String)(String, String, String, scalikejdbc.ConnectionPoolSettings)">load</a><a href="#98225" title="(String, String, String, scalikejdbc.ConnectionPoolSettings) @unchecked" class="delimiter">(</a><a href="#42833" title="String">name</a><span class="delimiter">)</span>
                <a href="../../scalikejdbc/scalikejdbc/ConnectionPool.scala.html#8341" title="scalikejdbc.ConnectionPool.type">ConnectionPool</a>.<a href="../../scalikejdbc/scalikejdbc/ConnectionPool.scala.html#13337" title="(url: String, user: String, password: String, settings: scalikejdbc.ConnectionPool.CPSettings)(implicit factory: scalikejdbc.ConnectionPool.CPFactory)Unit">singleton</a><a href="../../scalikejdbc/scalikejdbc/ConnectionPool.scala.html#43026" title="scalikejdbc.ConnectionPool.CPFactory" id="43045" class="delimiter">(</a><a href="#42994" title="String" id="43032">url</a>, <a href="#42995" title="String" id="43033">user</a>, <a href="#42996" title="String" id="43034">password</a>, <a href="#42997" title="scalikejdbc.ConnectionPoolSettings" id="43035">settings</a><span class="delimiter">)</span>
                <a href="#42470" title="=&gt; scala.collection.mutable.ListBuffer[String]">registeredPoolNames</a>.<span title="(elems: String*)Unit">append</span><span class="delimiter">(</span><span title="String(&quot;default&quot;)" class="string">&quot;default&quot;</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="keyword">case</span> _ =&gt;
              <a href="#98245" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#42470" title="=&gt; scala.collection.mutable.ListBuffer[String]">registeredPoolNames</a>.<span title="(elem: Any)Boolean">contains</span><span class="delimiter">(</span><a href="#42833" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a href="#98233" title="(x: (String, String, String, scalikejdbc.ConnectionPoolSettings))(String, String, String, scalikejdbc.ConnectionPoolSettings)" class="delimiter">(</a><a href="#98231" title="String" id="43048">url</a>, <a href="#98231" title="String" id="43049">user</a>, <a href="#98231" title="String" id="43050">password</a>, <a href="#98231" title="scalikejdbc.ConnectionPoolSettings" id="43051">settings</a><span class="delimiter">)</span> = <a href="#42834" title="(name: String)(String, String, String, scalikejdbc.ConnectionPoolSettings)">load</a><a href="#98231" title="(String, String, String, scalikejdbc.ConnectionPoolSettings) @unchecked" class="delimiter">(</a><a href="#42833" title="String">name</a><span class="delimiter">)</span>
                <a href="../../scalikejdbc/scalikejdbc/ConnectionPool.scala.html#8341" title="scalikejdbc.ConnectionPool.type">ConnectionPool</a>.<a href="../../scalikejdbc/scalikejdbc/ConnectionPool.scala.html#13336" title="(name: Any, url: String, user: String, password: String, settings: scalikejdbc.ConnectionPool.CPSettings)(implicit factory: scalikejdbc.ConnectionPool.CPFactory)Unit">add</a><a href="../../scalikejdbc/scalikejdbc/ConnectionPool.scala.html#17469" title="scalikejdbc.ConnectionPool.CPFactory" id="43080" class="delimiter">(</a><span title="(name: String)Symbol">Symbol</span><a title="Symbol" id="43075" class="delimiter">(</a><a href="#42833" title="String">name</a><span class="delimiter">)</span>, <a href="#43048" title="String" id="43076">url</a>, <a href="#43049" title="String" id="43077">user</a>, <a href="#43050" title="String" id="43078">password</a>, <a href="#43051" title="scalikejdbc.ConnectionPoolSettings" id="43079">settings</a><span class="delimiter">)</span>
                <a href="#42470" title="=&gt; scala.collection.mutable.ListBuffer[String]">registeredPoolNames</a>.<span title="(elems: String*)Unit">append</span><span class="delimiter">(</span><a href="#42833" title="String">name</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><span class="delimiter">(</span><a href="#42315" title="String">loggingSQLAndTime</a>, <span title="String(&quot;enabled&quot;)" class="string">&quot;enabled&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#42311" title="=&gt; play.api.Configuration">globalConfig</a><span class="delimiter">)</span>.<span title="(f: String =&gt; Boolean)Option[Boolean]">map</span><span class="delimiter">(</span><a href="#43518" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="=&gt; Boolean">toBoolean</span><span class="delimiter">)</span>.<span title="(f: Boolean =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span>
      <a title="Boolean" id="43527">enabled</a> =&gt;
        <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="play.api.Configuration" id="43528">config</a> = <a href="#42311" title="=&gt; play.api.Configuration">globalConfig</a>
        <span class="keyword">val</span> <a title="scalikejdbc.LoggingSQLAndTimeSettings" id="43529">default</a> = <a href="../../scalikejdbc/scalikejdbc/LoggingSQLAndTimeSettings.scala.html#31883" title="(enabled: Boolean, logLevel: Symbol, warningEnabled: Boolean, warningThresholdMillis: Long, warningLogLevel: Symbol)scalikejdbc.LoggingSQLAndTimeSettings">LoggingSQLAndTimeSettings</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="../../scalikejdbc/scalikejdbc/GlobalSettings.scala.html#7960" title="scalikejdbc.GlobalSettings.type">GlobalSettings</a>.<a href="../../scalikejdbc/scalikejdbc/GlobalSettings.scala.html#31945" title="(x$1: scalikejdbc.LoggingSQLAndTimeSettings)Unit">loggingSQLAndTime</a> = <a href="../../scalikejdbc/scalikejdbc/LoggingSQLAndTimeSettings.scala.html#31883" title="(enabled: Boolean, logLevel: Symbol, warningEnabled: Boolean, warningThresholdMillis: Long, warningLogLevel: Symbol)scalikejdbc.LoggingSQLAndTimeSettings">LoggingSQLAndTimeSettings</a><span class="delimiter">(</span>
          enabled = <a href="#43527" title="Boolean">enabled</a>,
          logLevel = <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><a href="#43528" title="play.api.Configuration" class="delimiter">(</a><a href="#42315" title="String">loggingSQLAndTime</a>, <span title="String(&quot;logLevel&quot;)" class="string">&quot;logLevel&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Symbol)Option[Symbol]">map</span><span class="delimiter">(</span><a title="String" id="43538">v</a> =&gt; <span title="(name: String)Symbol">Symbol</span><span class="delimiter">(</span><a href="#43538" title="String">v</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; Symbol)Symbol">getOrElse</span><span class="delimiter">(</span><a href="#43529" title="scalikejdbc.LoggingSQLAndTimeSettings">default</a>.<a href="../../scalikejdbc/scalikejdbc/LoggingSQLAndTimeSettings.scala.html#31913" title="=&gt; Symbol">logLevel</a><span class="delimiter">)</span>,
          warningEnabled = <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><a href="#43528" title="play.api.Configuration" class="delimiter">(</a><a href="#42315" title="String">loggingSQLAndTime</a>, <span title="String(&quot;warningEnabled&quot;)" class="string">&quot;warningEnabled&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Boolean)Option[Boolean]">map</span><span class="delimiter">(</span><a href="#43550" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="=&gt; Boolean">toBoolean</span><span class="delimiter">)</span>.<span title="(default: =&gt; Boolean)Boolean">getOrElse</span><span class="delimiter">(</span><a href="#43529" title="scalikejdbc.LoggingSQLAndTimeSettings">default</a>.<a href="../../scalikejdbc/scalikejdbc/LoggingSQLAndTimeSettings.scala.html#31915" title="=&gt; Boolean">warningEnabled</a><span class="delimiter">)</span>,
          warningThresholdMillis = <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><a href="#43528" title="play.api.Configuration" class="delimiter">(</a><a href="#42315" title="String">loggingSQLAndTime</a>, <span title="String(&quot;warningThresholdMillis&quot;)" class="string">&quot;warningThresholdMillis&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Long)Option[Long]">map</span><span class="delimiter">(</span><a href="#43563" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>.<span title="(default: =&gt; Long)Long">getOrElse</span><span class="delimiter">(</span><a href="#43529" title="scalikejdbc.LoggingSQLAndTimeSettings">default</a>.<a href="../../scalikejdbc/scalikejdbc/LoggingSQLAndTimeSettings.scala.html#31917" title="=&gt; Long">warningThresholdMillis</a><span class="delimiter">)</span>,
          warningLogLevel = <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><a href="#43528" title="play.api.Configuration" class="delimiter">(</a><a href="#42315" title="String">loggingSQLAndTime</a>, <span title="String(&quot;warningLogLevel&quot;)" class="string">&quot;warningLogLevel&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Symbol)Option[Symbol]">map</span><span class="delimiter">(</span><a title="String" id="43576">v</a> =&gt; <span title="(name: String)Symbol">Symbol</span><span class="delimiter">(</span><a href="#43576" title="String">v</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; Symbol)Symbol">getOrElse</span><span class="delimiter">(</span><a href="#43529" title="scalikejdbc.LoggingSQLAndTimeSettings">default</a>.<a href="../../scalikejdbc/scalikejdbc/LoggingSQLAndTimeSettings.scala.html#31919" title="=&gt; Symbol">warningLogLevel</a><span class="delimiter">)</span>
        <span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="#42472" title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]">opt</a><span class="delimiter">(</span><span title="String(&quot;closeAllOnStop&quot;)" class="string">&quot;closeAllOnStop&quot;</span>, <span title="String(&quot;enabled&quot;)" class="string">&quot;enabled&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#42313" title="=&gt; play.api.Configuration">playConfig</a><span class="delimiter">)</span>.<span title="(f: String =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="String" id="43590">enabled</a> =&gt; <a href="#42316" title="Boolean">closeAllOnStop</a> = <a href="#43590" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">enabled</a>.<span title="=&gt; Boolean">toBoolean</span> <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="42318">onStop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#42316" title="Boolean">closeAllOnStop</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="../../scalikejdbc/scalikejdbc/ConnectionPool.scala.html#8341" title="scalikejdbc.ConnectionPool.type">ConnectionPool</a>.<a href="../../scalikejdbc/scalikejdbc/ConnectionPool.scala.html#13341" title="()Unit">closeAll</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#42470" title="=&gt; scala.collection.mutable.ListBuffer[String]">registeredPoolNames</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="scalikejdbc.PlayPlugin.type" id="8926">PlayPlugin</a> <a href="#8927" title="scalikejdbc.PlayPlugin.type" class="delimiter">{</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[String]" id="42470">registeredPoolNames</a> = <span title="scala.collection.mutable.ListBuffer[String]" class="keyword">new</span> scala.collection.mutable.<span title="scala.collection.mutable.ListBuffer[String]">ListBuffer</span><span class="delimiter">[</span>String<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(name: String, key: String)(implicit config: play.api.Configuration)Option[String]" id="42472">opt</a><span class="delimiter">(</span><a title="String" id="42849">name</a>: <span title="String">String</span>, <a title="String" id="42850">key</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="play.api.Configuration" id="42851">config</a>: <span title="play.api.Configuration">Configuration</span><span class="delimiter">)</span>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#42851" title="play.api.Configuration">config</a>.<span title="(path: String, validValues: Option[Set[String]])Option[String]">getString</span><span class="delimiter">(</span><a href="#42849" title="String">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.&quot;)" class="string">&quot;.&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#42850" title="String">key</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(name: String, key: String)(implicit config: play.api.Configuration)String" id="42473">require</a><span class="delimiter">(</span><a title="String" id="42842">name</a>: <span title="String">String</span>, <a title="String" id="42843">key</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="play.api.Configuration" id="42844">config</a>: <span title="play.api.Configuration">Configuration</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <a href="#42844" title="play.api.Configuration">config</a>.<span title="(path: String, validValues: Option[Set[String]])Option[String]">getString</span><span class="delimiter">(</span><a href="#42842" title="String">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.&quot;)" class="string">&quot;.&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#42843" title="String">key</a><span class="delimiter">)</span> <span title="(default: =&gt; String)String">getOrElse</span> <span class="delimiter">{</span>
      <span title="Nothing" class="keyword">throw</span> <a href="#42844" title="play.api.Configuration">config</a>.<span title="(path: String, message: String, e: Option[Throwable])play.api.PlayException">reportError</span><span class="delimiter">(</span><a href="#42842" title="String">name</a>, <span title="String(&quot;Missing configuration [db.&quot;)" class="string">&quot;Missing configuration [db.&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#42842" title="String">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.&quot;)" class="string">&quot;.&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#42843" title="String">key</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;]&quot;)" class="string">&quot;]&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>


        </pre>
    </body>
</html>
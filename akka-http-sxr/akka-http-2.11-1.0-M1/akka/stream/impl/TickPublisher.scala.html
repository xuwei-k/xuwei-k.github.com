<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>akka/stream/impl/TickPublisher.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
package akka.stream.impl

import java.util.concurrent.atomic.AtomicBoolean

import akka.actor.<span class="delimiter">{</span> Actor, ActorRef, Cancellable, Props, SupervisorStrategy <span class="delimiter">}</span>
import akka.stream.MaterializerSettings
import org.reactivestreams.<span class="delimiter">{</span> Subscriber, Subscription <span class="delimiter">}</span>

import scala.collection.mutable
import scala.concurrent.duration.FiniteDuration
import scala.util.control.NonFatal

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> object <a title="akka.stream.impl.TickPublisher.type" id="akka.stream.impl.TickPublisher">TickPublisher</a> <a href="#akka.stream.impl.TickPublisher" title="akka.stream.impl.TickPublisher.type" class="delimiter">{</a>
  def <a title="(initialDelay: scala.concurrent.duration.FiniteDuration, interval: scala.concurrent.duration.FiniteDuration, tick: () =&gt; Any, settings: akka.stream.MaterializerSettings, cancelled: java.util.concurrent.atomic.AtomicBoolean)akka.actor.Props" id="akka.stream.impl.TickPublisher.props">props</a><span class="delimiter">(</span><a title="scala.concurrent.duration.FiniteDuration" id="akka.stream.impl.TickPublisher.props.initialDelay">initialDelay</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span>, <a title="scala.concurrent.duration.FiniteDuration" id="akka.stream.impl.TickPublisher.props.interval">interval</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span>, <a title="() =&gt; Any" id="akka.stream.impl.TickPublisher.props.tick">tick</a>: <span class="delimiter">(</span><span class="delimiter">)</span> â‡’ Any,
            <a title="akka.stream.MaterializerSettings" id="akka.stream.impl.TickPublisher.props.settings">settings</a>: <a href="../FlowMaterializer.scala.html#akka.stream;MaterializerSettings" title="akka.stream.MaterializerSettings">MaterializerSettings</a>, <a title="java.util.concurrent.atomic.AtomicBoolean" id="akka.stream.impl.TickPublisher.props.cancelled">cancelled</a>: <span title="java.util.concurrent.atomic.AtomicBoolean">AtomicBoolean</span><span class="delimiter">)</span>: <span title="akka.actor.Props">Props</span> =
    <span title="(creator: =&gt; akka.stream.impl.TickPublisher)(implicit evidence$2: scala.reflect.ClassTag[akka.stream.impl.TickPublisher])akka.actor.Props">Props</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[akka.stream.impl.TickPublisher]" class="delimiter">(</span>new <a href="#akka.stream.impl;TickPublisher" title="akka.stream.impl.TickPublisher">TickPublisher</a><span class="delimiter">(</span><a href="#akka.stream.impl.TickPublisher.props.initialDelay" title="scala.concurrent.duration.FiniteDuration">initialDelay</a>, <a href="#akka.stream.impl.TickPublisher.props.interval" title="scala.concurrent.duration.FiniteDuration">interval</a>, <a href="#akka.stream.impl.TickPublisher.props.tick" title="() =&gt; Any">tick</a>, <a href="#akka.stream.impl.TickPublisher.props.settings" title="akka.stream.MaterializerSettings">settings</a>, <a href="#akka.stream.impl.TickPublisher.props.cancelled" title="java.util.concurrent.atomic.AtomicBoolean">cancelled</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(d: String)akka.actor.Props">withDispatcher</span><span class="delimiter">(</span><a href="#akka.stream.impl.TickPublisher.props.settings" title="akka.stream.MaterializerSettings">settings</a>.<a href="../FlowMaterializer.scala.html#akka.stream;MaterializerSettings.dispatcher" title="=&gt; String">dispatcher</a><span class="delimiter">)</span>

  object <a title="akka.stream.impl.TickPublisher.TickPublisherSubscription.type" id="akka.stream.impl.TickPublisher.TickPublisherSubscription">TickPublisherSubscription</a> <a href="#akka.stream.impl.TickPublisher.TickPublisherSubscription" title="akka.stream.impl.TickPublisher.TickPublisherSubscription.type" class="delimiter">{</a>
    case object <a href="#akka.stream.impl.TickPublisher.TickPublisherSubscription.Cancel.productElement.x$1" title="akka.stream.impl.TickPublisher.TickPublisherSubscription.Cancel.type" id="akka.stream.impl.TickPublisher.TickPublisherSubscription.Cancel.readResolve">Cancel</a>
    case class <a title="class RequestMore extends AnyRef with Product with Serializable" id="akka.stream.impl.TickPublisher.TickPublisherSubscription.RequestMore.readResolve">RequestMore</a><a href="#akka.stream.impl.TickPublisher.TickPublisherSubscription.RequestMore.readResolve" title="Product" class="delimiter">(</a><a title="Long" id="akka.stream.impl.TickPublisher.TickPublisherSubscription;RequestMore.elements">elements</a>: <span title="Long">Long</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  class <a title="class TickPublisherSubscription extends Object with org.reactivestreams.Subscription" id="akka.stream.impl.TickPublisher;TickPublisherSubscription">TickPublisherSubscription</a><a href="#akka.stream.impl.TickPublisher;TickPublisherSubscription" title="akka.stream.impl.TickPublisher.TickPublisherSubscription" class="delimiter">(</a><a title="akka.actor.ActorRef" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.ref">ref</a>: <span title="akka.actor.ActorRef">ActorRef</span><span class="delimiter">)</span> extends <a href="#akka.stream.impl.TickPublisher;TickPublisherSubscription" title="org.reactivestreams.Subscription">Subscription</a> <span class="delimiter">{</span>
    import akka.stream.impl.<a href="#akka.stream.impl.TickPublisher" title="akka.stream.impl.TickPublisher.type">TickPublisher</a>.<a href="#akka.stream.impl.TickPublisher.TickPublisherSubscription" title="akka.stream.impl.TickPublisher.TickPublisherSubscription.type">TickPublisherSubscription</a>._
    def <a title="()Unit" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.cancel">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl.TickPublisher;TickPublisherSubscription.ref" title="akka.actor.ScalaActorRef" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.cancel.qual$1">ref</a> <a title="akka.actor.ActorRef" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.cancel.x$3">!</a> <a href="#akka.stream.impl.TickPublisher.TickPublisherSubscription.Cancel.readResolve" title="akka.stream.impl.TickPublisher.TickPublisherSubscription.Cancel.type" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.cancel.x$2">Cancel</a>
    def <a title="(elements: Long)Unit" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.request">request</a><span class="delimiter">(</span><a title="Long" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.request.elements">elements</a>: <span title="Long">Long</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      if <span class="delimiter">(</span><a href="#akka.stream.impl.TickPublisher;TickPublisherSubscription.request.elements" title="Long">elements</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> throw new <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span>ReactiveStreamsCompliance.<span title="String(&quot;The number of requested elements must be &gt; 0 (see reactive-streams specification, rule 3.9)&quot;)">NumberOfElementsInRequestMustBePositiveMsg</span><span class="delimiter">)</span>
      else <a href="#akka.stream.impl.TickPublisher;TickPublisherSubscription.ref" title="akka.actor.ScalaActorRef" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.request.qual$2">ref</a> <a title="akka.actor.ActorRef" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.request.x$5">!</a> <a href="#akka.stream.impl.TickPublisher.TickPublisherSubscription.RequestMore.readResolve" title="(elements: Long)akka.stream.impl.TickPublisher.TickPublisherSubscription.RequestMore">RequestMore</a><a title="akka.stream.impl.TickPublisher.TickPublisherSubscription.RequestMore" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.request.x$4" class="delimiter">(</a><a href="#akka.stream.impl.TickPublisher;TickPublisherSubscription.request.elements" title="Long">elements</a><span class="delimiter">)</span>
    override def <a title="()String" id="akka.stream.impl.TickPublisher;TickPublisherSubscription.toString">toString</a> = <span title="String(&quot;TickPublisherSubscription&quot;)" class="string">&quot;TickPublisherSubscription&quot;</span>
  <span class="delimiter">}</span>

  private case object <a href="#akka.stream.impl.TickPublisher.Tick.productElement.x$1" title="akka.stream.impl.TickPublisher.Tick.type" id="akka.stream.impl.TickPublisher.Tick.readResolve">Tick</a>
<a href="#akka.stream.impl.TickPublisher.Tick.readResolve" title="akka.stream.impl.TickPublisher.Tick.type" class="delimiter">}</a>

<span class="comment">/**
 * INTERNAL API
 *
 * Elements are produced from the tick closure periodically with the specified interval. Supports only one subscriber.
 * The subscriber will receive the tick element if it has requested any elements,
 * otherwise the tick element is dropped.
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> class <a title="class TickPublisher extends AnyRef with akka.actor.Actor with akka.stream.impl.SoftShutdown" id="akka.stream.impl;TickPublisher">TickPublisher</a><a href="#akka.stream.impl;TickPublisher" title="akka.stream.impl.TickPublisher" class="delimiter">(</a><a title="scala.concurrent.duration.FiniteDuration" id="akka.stream.impl;TickPublisher.initialDelay">initialDelay</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span>, <a title="scala.concurrent.duration.FiniteDuration" id="akka.stream.impl;TickPublisher.interval">interval</a>: <span title="scala.concurrent.duration.FiniteDuration">FiniteDuration</span>, <a title="() =&gt; Any" id="akka.stream.impl;TickPublisher.tick">tick</a>: <span class="delimiter">(</span><span class="delimiter">)</span> â‡’ Any,
                                  <a title="akka.stream.MaterializerSettings" id="akka.stream.impl;TickPublisher.settings">settings</a>: <a href="../FlowMaterializer.scala.html#akka.stream;MaterializerSettings" title="akka.stream.MaterializerSettings">MaterializerSettings</a>, <a title="java.util.concurrent.atomic.AtomicBoolean" id="akka.stream.impl;TickPublisher.cancelled">cancelled</a>: <span title="java.util.concurrent.atomic.AtomicBoolean">AtomicBoolean</span><span class="delimiter">)</span> extends <a href="#akka.stream.impl;TickPublisher" title="akka.actor.Actor">Actor</a> with <a href="ActorPublisher.scala.html#akka.stream.impl;SoftShutdown" title="akka.stream.impl.SoftShutdown">SoftShutdown</a> <span class="delimiter">{</span>
  import akka.stream.impl.<a href="#akka.stream.impl.TickPublisher" title="akka.stream.impl.TickPublisher.type">TickPublisher</a>.<a href="#akka.stream.impl.TickPublisher.TickPublisherSubscription" title="akka.stream.impl.TickPublisher.TickPublisherSubscription.type">TickPublisherSubscription</a>._
  import akka.stream.impl.<a href="#akka.stream.impl.TickPublisher" title="akka.stream.impl.TickPublisher.type">TickPublisher</a>._

  var <a title="akka.stream.impl.ActorPublisher[Any]" id="akka.stream.impl;TickPublisher.exposedPublisher_=">exposedPublisher</a>: <a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher" title="akka.stream.impl.ActorPublisher[Any]">ActorPublisher</a><span class="delimiter">[</span>Any<span class="delimiter">]</span> = _
  private var <a title="org.reactivestreams.Subscriber[_ &gt;: Any]" id="akka.stream.impl;TickPublisher.subscriber_=">subscriber</a>: <span title="org.reactivestreams.Subscriber[_ &gt;: Any]">Subscriber</span><span class="delimiter">[</span>_ &gt;: Any<span class="delimiter">]</span> = null
  private var <a title="Long" id="akka.stream.impl;TickPublisher.demand_=">demand</a>: <span title="Long">Long</span> = <span title="Long(0L)" class="int">0</span>

  override val <a title="akka.actor.SupervisorStrategy" id="akka.stream.impl;TickPublisher.supervisorStrategy">supervisorStrategy</a> = <span title="akka.actor.SupervisorStrategy.type">SupervisorStrategy</span>.<span title="=&gt; akka.actor.SupervisorStrategy">stoppingStrategy</span>

  var <a title="Option[akka.actor.Cancellable]" id="akka.stream.impl;TickPublisher.tickTask_=">tickTask</a>: <span title="Option[akka.actor.Cancellable]">Option</span><span class="delimiter">[</span>Cancellable<span class="delimiter">]</span> = <span title="None.type">None</span>

  def <a title="=&gt; PartialFunction[Any,Unit]" id="akka.stream.impl;TickPublisher.receive">receive</a> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;TickPublisher.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case ExposedPublisher<span class="delimiter">(</span><a title="akka.stream.impl.ActorPublisher[Any]" id="akka.stream.impl;TickPublisher.receive;$anonfun.isDefinedAt.publisher">publisher</a><span class="delimiter">)</span> â‡’
      <a href="#akka.stream.impl;TickPublisher.exposedPublisher_=" title="(x$1: akka.stream.impl.ActorPublisher[Any])Unit">exposedPublisher</a> = <a href="#akka.stream.impl;TickPublisher.receive;$anonfun.isDefinedAt.publisher" title="akka.stream.impl.ActorPublisher[Any]">publisher</a>
      <a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(behavior: akka.actor.Actor.Receive)Unit">become</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.waitingForFirstSubscriber" title="=&gt; TickPublisher.this.Receive">waitingForFirstSubscriber</a><span class="delimiter">)</span>
    case _ â‡’ throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;The first message must be ExposedPublisher&quot;)" class="string">&quot;The first message must be ExposedPublisher&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="=&gt; TickPublisher.this.Receive" id="akka.stream.impl;TickPublisher.waitingForFirstSubscriber">waitingForFirstSubscriber</a>: <span title="TickPublisher.this.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;TickPublisher.waitingForFirstSubscriber;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case <a href="Messages.scala.html#akka.stream.impl.SubscribePending" title="akka.stream.impl.SubscribePending.type">SubscribePending</a> â‡’
      <a href="#akka.stream.impl;TickPublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.takePendingSubscribers" title="()scala.collection.immutable.Seq[org.reactivestreams.Subscriber[_ &gt;: Any]]">takePendingSubscribers</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(f: org.reactivestreams.Subscriber[_ &gt;: Any] =&gt; Unit)Unit">foreach</span> <a href="#akka.stream.impl;TickPublisher.registerSubscriber" title="(s: org.reactivestreams.Subscriber[_ &gt;: Any])Unit">registerSubscriber</a>
      import <a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorContext">context</a>.dispatcher
      <a href="#akka.stream.impl;TickPublisher.tickTask_=" title="(x$1: Option[akka.actor.Cancellable])Unit">tickTask</a> = <span title="(x: akka.actor.Cancellable)Some[akka.actor.Cancellable]">Some</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorContext">context</a>.<span title="=&gt; akka.actor.ActorSystem">system</span>.<span title="=&gt; akka.actor.Scheduler">scheduler</span>.<span title="(initialDelay: scala.concurrent.duration.FiniteDuration, interval: scala.concurrent.duration.FiniteDuration, receiver: akka.actor.ActorRef, message: Any)(implicit executor: scala.concurrent.ExecutionContext, implicit sender: akka.actor.ActorRef)akka.actor.Cancellable">schedule</span><a href="#akka.stream.impl;TickPublisher" title="=&gt; scala.concurrent.ExecutionContextExecutor" class="delimiter">(</a><a href="#akka.stream.impl;TickPublisher.initialDelay" title="scala.concurrent.duration.FiniteDuration">initialDelay</a>, <a href="#akka.stream.impl;TickPublisher.interval" title="scala.concurrent.duration.FiniteDuration">interval</a>, <a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorRef">self</a>, <a href="#akka.stream.impl.TickPublisher.Tick.readResolve" title="akka.stream.impl.TickPublisher.Tick.type">Tick</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(behavior: akka.actor.Actor.Receive)Unit">become</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.active" title="=&gt; TickPublisher.this.Receive">active</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="=&gt; TickPublisher.this.Receive" id="akka.stream.impl;TickPublisher.active">active</a>: <span title="TickPublisher.this.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;TickPublisher.active;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case <a href="#akka.stream.impl.TickPublisher.Tick.readResolve" title="akka.stream.impl.TickPublisher.Tick.type">Tick</a> â‡’
      try <span class="delimiter">{</span>
        val <a title="Any" id="akka.stream.impl;TickPublisher.active;$anonfun.applyOrElse.tickElement">tickElement</a> = <a href="#akka.stream.impl;TickPublisher.tick" title="()Any">tick</a><span class="delimiter">(</span><span class="delimiter">)</span>
        if <span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.demand_=" title="=&gt; Long">demand</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#akka.stream.impl;TickPublisher.demand_=" title="(x$1: Long)Unit">demand</a> <span title="(x: Int)Long">-=</span> <span title="Int(1)" class="int">1</span>
          <a href="#akka.stream.impl;TickPublisher.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[_ &gt;: Any]">subscriber</a>.<span title="(x$1: _$1)Unit">onNext</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.active;$anonfun.applyOrElse.tickElement" title="Any">tickElement</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> catch <span class="delimiter">{</span>
        case <a href="#akka.stream.impl;TickPublisher.active;$anonfun.applyOrElse.<unapply-selector>" title="(t: Throwable)Option[Throwable]">NonFatal</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;TickPublisher.active;$anonfun.applyOrElse.e">e</a><span class="delimiter">)</span> â‡’
          if <span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[_ &gt;: Any]">subscriber</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#akka.stream.impl;TickPublisher.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[_ &gt;: Any]">subscriber</a>.<span title="(x$1: Throwable)Unit">onError</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.active;$anonfun.applyOrElse.e" title="Throwable">e</a><span class="delimiter">)</span>
            <a href="#akka.stream.impl;TickPublisher.subscriber_=" title="(x$1: org.reactivestreams.Subscriber[_ &gt;: Any])Unit">subscriber</a> = null
          <span class="delimiter">}</span>
          <a href="#akka.stream.impl;TickPublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><span title="(x: Throwable)Some[Throwable]">Some</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.active;$anonfun.applyOrElse.e" title="Throwable">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(actor: akka.actor.ActorRef)Unit">stop</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    case RequestMore<span class="delimiter">(</span><a title="Long" id="akka.stream.impl;TickPublisher.active;$anonfun.isDefinedAt.elements">elements</a><span class="delimiter">)</span> â‡’
      <a href="#akka.stream.impl;TickPublisher.demand_=" title="(x$1: Long)Unit">demand</a> <span title="(x: Long)Long">+=</span> <a href="#akka.stream.impl;TickPublisher.active;$anonfun.isDefinedAt.elements" title="Long">elements</a>
      if <span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.demand_=" title="=&gt; Long">demand</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// Long has overflown, reactive-streams specification rule 3.17</span>
        <a href="#akka.stream.impl;TickPublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><span title="(x: IllegalStateException)Some[IllegalStateException]">Some</span><span class="delimiter">(</span>
          new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span>ReactiveStreamsCompliance.<span title="String(&quot;Total pending demand MUST NOT be &gt; `java.lang.Long.MAX_VALUE` (see reactive-streams specification, rule 3.17)&quot;)">TotalPendingDemandMustNotExceedLongMaxValue</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(actor: akka.actor.ActorRef)Unit">stop</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    case <a href="#akka.stream.impl.TickPublisher.TickPublisherSubscription.Cancel.readResolve" title="akka.stream.impl.TickPublisher.TickPublisherSubscription.Cancel.type">Cancel</a> â‡’
      <a href="#akka.stream.impl;TickPublisher.subscriber_=" title="(x$1: org.reactivestreams.Subscriber[_ &gt;: Any])Unit">subscriber</a> = null
      <a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(actor: akka.actor.ActorRef)Unit">stop</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>

    case <a href="Messages.scala.html#akka.stream.impl.SubscribePending" title="akka.stream.impl.SubscribePending.type">SubscribePending</a> â‡’
      <a href="#akka.stream.impl;TickPublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.takePendingSubscribers" title="()scala.collection.immutable.Seq[org.reactivestreams.Subscriber[_ &gt;: Any]]">takePendingSubscribers</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(f: org.reactivestreams.Subscriber[_ &gt;: Any] =&gt; Unit)Unit">foreach</span> <a href="#akka.stream.impl;TickPublisher.registerSubscriber" title="(s: org.reactivestreams.Subscriber[_ &gt;: Any])Unit">registerSubscriber</a>

  <span class="delimiter">}</span>

  def <a title="(s: org.reactivestreams.Subscriber[_ &gt;: Any])Unit" id="akka.stream.impl;TickPublisher.registerSubscriber">registerSubscriber</a><span class="delimiter">(</span><a title="org.reactivestreams.Subscriber[_ &gt;: Any]" id="akka.stream.impl;TickPublisher.registerSubscriber.s">s</a>: <span title="org.reactivestreams.Subscriber[_ &gt;: Any]">Subscriber</span><span class="delimiter">[</span>_ &gt;: Any<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[_ &gt;: Any]">subscriber</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl;TickPublisher.registerSubscriber.s" title="org.reactivestreams.Subscriber[_ &gt;: Any]">s</a>.<span title="(x$1: Throwable)Unit">onError</span><span class="delimiter">(</span>new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;&quot;)">$</span><span class="delimiter">{</span><a href="#akka.stream.impl;TickPublisher" title="()Class[_]">getClass</a>.<span title="()String">getSimpleName</span><span class="delimiter">}</span><span title="String(&quot; [&quot;)"> [$</span><a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorRef">self</a><span title="String(&quot;, sub: &quot;)">, sub: $</span><a href="#akka.stream.impl;TickPublisher.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[_ &gt;: Any]">subscriber</a><span title="String(&quot;] &quot;)">] $</span><span class="delimiter">{</span>ReactiveStreamsCompliance.<span title="String(&quot;can not subscribe the same subscriber multiple times (see reactive-streams specification, rules 1.10 and 2.12)&quot;)">CanNotSubscribeTheSameSubscriberMultipleTimes</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    else <span class="delimiter">{</span>
      val <a title="akka.stream.impl.TickPublisher.TickPublisherSubscription" id="akka.stream.impl;TickPublisher.registerSubscriber.subscription">subscription</a> = new <a href="#akka.stream.impl.TickPublisher;TickPublisherSubscription" title="akka.stream.impl.TickPublisher.TickPublisherSubscription">TickPublisherSubscription</a><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
      <a href="#akka.stream.impl;TickPublisher.subscriber_=" title="(x$1: org.reactivestreams.Subscriber[_ &gt;: Any])Unit">subscriber</a> = <a href="#akka.stream.impl;TickPublisher.registerSubscriber.s" title="org.reactivestreams.Subscriber[_ &gt;: Any]">s</a>
      <a href="#akka.stream.impl;TickPublisher.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[_ &gt;: Any]">subscriber</a>.<span title="(x$1: org.reactivestreams.Subscription)Unit">onSubscribe</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.registerSubscriber.subscription" title="akka.stream.impl.TickPublisher.TickPublisherSubscription">subscription</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  override def <a title="()Unit" id="akka.stream.impl;TickPublisher.postStop">postStop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl;TickPublisher.tickTask_=" title="=&gt; Option[akka.actor.Cancellable]">tickTask</a>.<span title="(f: akka.actor.Cancellable =&gt; Boolean)Unit">foreach</span><span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.postStop.$anonfun.x$1" title="akka.actor.Cancellable">_</a>.<span title="()Boolean">cancel</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl;TickPublisher.cancelled" title="java.util.concurrent.atomic.AtomicBoolean">cancelled</a>.<span title="(x$1: Boolean)Unit">set</span><span class="delimiter">(</span>true<span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[_ &gt;: Any]">subscriber</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl;TickPublisher.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[_ &gt;: Any]">subscriber</a>.<span title="()Unit">onComplete</span><span class="delimiter">(</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.impl;TickPublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span>
      <a href="#akka.stream.impl;TickPublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><a href="ActorPublisher.scala.html#akka.stream.impl.ActorPublisher" title="akka.stream.impl.ActorPublisher.type">ActorPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl.ActorPublisher.NormalShutdownReason" title="=&gt; Option[Throwable]">NormalShutdownReason</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>


        </pre>
    </body>
</html>

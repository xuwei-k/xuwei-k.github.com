<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>akka/stream/impl/ActorProcessor.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
package akka.stream.impl

import java.util.Arrays

import akka.actor._
import akka.stream.MaterializerSettings
import akka.stream.actor.<a href="../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriber" title="akka.stream.actor.ActorSubscriber.type">ActorSubscriber</a>.OnSubscribe
import akka.stream.actor.<a href="../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriberMessage" title="akka.stream.actor.ActorSubscriberMessage.type">ActorSubscriberMessage</a>.<span class="delimiter">{</span> OnNext, OnComplete, OnError <span class="delimiter">}</span>
import org.reactivestreams.<span class="delimiter">{</span> Subscriber, Subscription, Processor <span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> object <a title="akka.stream.impl.ActorProcessor.type" id="akka.stream.impl.ActorProcessor">ActorProcessor</a> <a href="#akka.stream.impl.ActorProcessor" title="akka.stream.impl.ActorProcessor.type" class="delimiter">{</a>

  def <a title="[I, O](impl: akka.actor.ActorRef)akka.stream.impl.ActorProcessor[I,O]" id="akka.stream.impl.ActorProcessor.apply">apply</a><span class="delimiter">[</span><a title="" id="akka.stream.impl.ActorProcessor.apply;I">I</a>, <a title="" id="akka.stream.impl.ActorProcessor.apply;O">O</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="akka.actor.ActorRef" id="akka.stream.impl.ActorProcessor.apply.impl">impl</a>: <span title="akka.actor.ActorRef">ActorRef</span><span class="delimiter">)</span>: <a href="#akka.stream.impl;ActorProcessor" title="akka.stream.impl.ActorProcessor[I,O]">ActorProcessor</a><span class="delimiter">[</span>I, O<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="akka.stream.impl.ActorProcessor[I,O]" id="akka.stream.impl.ActorProcessor.apply.p">p</a> = new <a href="#akka.stream.impl;ActorProcessor" title="akka.stream.impl.ActorProcessor[I,O]">ActorProcessor</a><span class="delimiter">[</span>I, O<span class="delimiter">]</span><span class="delimiter">(</span><a href="#akka.stream.impl.ActorProcessor.apply.impl" title="akka.actor.ActorRef">impl</a><span class="delimiter">)</span>
    <a href="#akka.stream.impl.ActorProcessor.apply.impl" title="akka.actor.ScalaActorRef" id="akka.stream.impl.ActorProcessor.apply.qual$1">impl</a> <a title="akka.actor.ActorRef" id="akka.stream.impl.ActorProcessor.apply.x$2">!</a> <a href="Messages.scala.html#akka.stream.impl;ExposedPublisher" title="(publisher: akka.stream.impl.ActorPublisher[Any])akka.stream.impl.ExposedPublisher">ExposedPublisher</a><a title="akka.stream.impl.ExposedPublisher" id="akka.stream.impl.ActorProcessor.apply.x$1" class="delimiter">(</a><a href="#akka.stream.impl.ActorProcessor.apply.p" title="akka.stream.impl.ActorProcessor[I,O]">p</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.stream.impl.ActorPublisher[Any]" class="delimiter">[</span><a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher" title="akka.stream.impl.ActorPublisher[Any]">ActorPublisher</a><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl.ActorProcessor.apply.p" title="akka.stream.impl.ActorProcessor[I,O]">p</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> class <a title="class ActorProcessor[I, O] extends akka.stream.impl.ActorPublisher[O] with org.reactivestreams.Processor[I,O]" id="akka.stream.impl;ActorProcessor">ActorProcessor</a><span class="delimiter">[</span><a title="" id="akka.stream.impl;ActorProcessor;I">I</a>, <a title="" id="akka.stream.impl;ActorProcessor;O">O</a><span class="delimiter">]</span><a href="#akka.stream.impl;ActorProcessor" title="akka.stream.impl.ActorProcessor[I,O]" class="delimiter">(</a><a title="akka.actor.ActorRef" id="akka.stream.impl;ActorProcessor.impl">impl</a>: <span title="akka.actor.ActorRef">ActorRef</span><span class="delimiter">)</span> extends <a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher" title="akka.stream.impl.ActorPublisher[O]">ActorPublisher</a><span class="delimiter">[</span>O<span class="delimiter">]</span><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessor.impl" title="akka.actor.ActorRef">impl</a><span class="delimiter">)</span>
  with <span title="org.reactivestreams.Processor[I,O]">Processor</span><span class="delimiter">[</span>I, O<span class="delimiter">]</span> <span class="delimiter">{</span>
  override def <a title="(s: org.reactivestreams.Subscription)Unit" id="akka.stream.impl;ActorProcessor.onSubscribe">onSubscribe</a><span class="delimiter">(</span><a title="org.reactivestreams.Subscription" id="akka.stream.impl;ActorProcessor.onSubscribe.s">s</a>: <span title="org.reactivestreams.Subscription">Subscription</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl;ActorProcessor.impl" title="akka.actor.ScalaActorRef" id="akka.stream.impl;ActorProcessor.onSubscribe.qual$2">impl</a> <a title="akka.actor.ActorRef" id="akka.stream.impl;ActorProcessor.onSubscribe.x$4">!</a> <a href="../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriber;OnSubscribe" title="(subscription: org.reactivestreams.Subscription)akka.stream.actor.ActorSubscriber.OnSubscribe">OnSubscribe</a><a title="akka.stream.actor.ActorSubscriber.OnSubscribe" id="akka.stream.impl;ActorProcessor.onSubscribe.x$3" class="delimiter">(</a><a href="#akka.stream.impl;ActorProcessor.onSubscribe.s" title="org.reactivestreams.Subscription">s</a><span class="delimiter">)</span>
  override def <a title="(t: Throwable)Unit" id="akka.stream.impl;ActorProcessor.onError">onError</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;ActorProcessor.onError.t">t</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl;ActorProcessor.impl" title="akka.actor.ScalaActorRef" id="akka.stream.impl;ActorProcessor.onError.qual$3">impl</a> <a title="akka.actor.ActorRef" id="akka.stream.impl;ActorProcessor.onError.x$6">!</a> <a href="../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriberMessage;OnError" title="(cause: Throwable)akka.stream.actor.ActorSubscriberMessage.OnError">OnError</a><a title="akka.stream.actor.ActorSubscriberMessage.OnError" id="akka.stream.impl;ActorProcessor.onError.x$5" class="delimiter">(</a><a href="#akka.stream.impl;ActorProcessor.onError.t" title="Throwable">t</a><span class="delimiter">)</span>
  override def <a title="()Unit" id="akka.stream.impl;ActorProcessor.onComplete">onComplete</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl;ActorProcessor.impl" title="akka.actor.ScalaActorRef" id="akka.stream.impl;ActorProcessor.onComplete.qual$4">impl</a> <a title="akka.actor.ActorRef" id="akka.stream.impl;ActorProcessor.onComplete.x$8">!</a> <a href="../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriberMessage.OnComplete" title="akka.stream.actor.ActorSubscriberMessage.OnComplete.type" id="akka.stream.impl;ActorProcessor.onComplete.x$7">OnComplete</a>
  override def <a title="(t: I)Unit" id="akka.stream.impl;ActorProcessor.onNext">onNext</a><span class="delimiter">(</span><a title="I" id="akka.stream.impl;ActorProcessor.onNext.t">t</a>: <a href="#akka.stream.impl;ActorProcessor;I" title="I">I</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl;ActorProcessor.impl" title="akka.actor.ScalaActorRef" id="akka.stream.impl;ActorProcessor.onNext.qual$5">impl</a> <a title="akka.actor.ActorRef" id="akka.stream.impl;ActorProcessor.onNext.x$10">!</a> <a href="../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriberMessage;OnNext" title="(element: Any)akka.stream.actor.ActorSubscriberMessage.OnNext">OnNext</a><a title="akka.stream.actor.ActorSubscriberMessage.OnNext" id="akka.stream.impl;ActorProcessor.onNext.x$9" class="delimiter">(</a><a href="#akka.stream.impl;ActorProcessor.onNext.t" title="I">t</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> abstract class <a title="class BatchingInputBuffer extends AnyRef with akka.stream.impl.DefaultInputTransferStates" id="akka.stream.impl;BatchingInputBuffer">BatchingInputBuffer</a><a href="#akka.stream.impl;BatchingInputBuffer" title="akka.stream.impl.BatchingInputBuffer" class="delimiter">(</a>val <a title="Int" id="akka.stream.impl;BatchingInputBuffer.size">size</a>: <span title="Int">Int</span>, val <a title="akka.stream.impl.Pump" id="akka.stream.impl;BatchingInputBuffer.pump">pump</a>: <a href="Transfer.scala.html#akka.stream.impl;Pump" title="akka.stream.impl.Pump">Pump</a><span class="delimiter">)</span> extends <a href="Transfer.scala.html#akka.stream.impl;DefaultInputTransferStates" title="akka.stream.impl.DefaultInputTransferStates">DefaultInputTransferStates</a> <span class="delimiter">{</span>
  <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.size" title="=&gt; Int">size</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span>, <span title="String(&quot;buffer size cannot be zero&quot;)" class="string">&quot;buffer size cannot be zero&quot;</span><span class="delimiter">)</span>
  <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.size" title="=&gt; Int">size</a> <span title="(x: Int)Int">&amp;</span> <span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.size" title="=&gt; Int">size</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span>, <span title="String(&quot;buffer size must be a power of two&quot;)" class="string">&quot;buffer size must be a power of two&quot;</span><span class="delimiter">)</span>
  <span class="comment">// TODO: buffer and batch sizing heuristics</span>
  private var <a title="org.reactivestreams.Subscription" id="akka.stream.impl;BatchingInputBuffer.upstream_=">upstream</a>: <span title="org.reactivestreams.Subscription">Subscription</span> = _
  private val <a title="Array[AnyRef]" id="akka.stream.impl;BatchingInputBuffer.inputBuffer">inputBuffer</a> = <span title="Array.type">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassTag[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassTag[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.ClassTag[AnyRef]" class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.size" title="=&gt; Int">size</a><span class="delimiter">)</span>
  private var <a title="Int" id="akka.stream.impl;BatchingInputBuffer.inputBufferElements_=">inputBufferElements</a> = <span title="Int(0)" class="int">0</span>
  private var <a title="Int" id="akka.stream.impl;BatchingInputBuffer.nextInputElementCursor_=">nextInputElementCursor</a> = <span title="Int(0)" class="int">0</span>
  private var <a title="Boolean" id="akka.stream.impl;BatchingInputBuffer.upstreamCompleted_=">upstreamCompleted</a> = false
  private val IndexMask = <a href="#akka.stream.impl;BatchingInputBuffer.size" title="=&gt; Int">size</a> <a title="Int" id="akka.stream.impl;BatchingInputBuffer.IndexMask">-</a> <span title="Int(1)" class="int">1</span>

  private def <a title="=&gt; Int" id="akka.stream.impl;BatchingInputBuffer.requestBatchSize">requestBatchSize</a> = math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>, <a href="#akka.stream.impl;BatchingInputBuffer.inputBuffer" title="=&gt; Array[AnyRef]">inputBuffer</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">/</span> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
  private var <a title="Int" id="akka.stream.impl;BatchingInputBuffer.batchRemaining_=">batchRemaining</a> = <a href="#akka.stream.impl;BatchingInputBuffer.requestBatchSize" title="=&gt; Int">requestBatchSize</a>

  override val <a title="akka.stream.impl.SubReceive" id="akka.stream.impl;BatchingInputBuffer.subreceive">subreceive</a>: <a href="Transfer.scala.html#akka.stream.impl;SubReceive" title="akka.stream.impl.SubReceive">SubReceive</a> = new <a href="Transfer.scala.html#akka.stream.impl;SubReceive" title="akka.stream.impl.SubReceive">SubReceive</a><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.waitingForUpstream" title="=&gt; akka.actor.Actor.Receive">waitingForUpstream</a><span class="delimiter">)</span>

  override def <a title="()Any" id="akka.stream.impl;BatchingInputBuffer.dequeueInputElement">dequeueInputElement</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Any">Any</span> = <span class="delimiter">{</span>
    val <a title="AnyRef" id="akka.stream.impl;BatchingInputBuffer.dequeueInputElement.elem">elem</a> = <a href="#akka.stream.impl;BatchingInputBuffer.inputBuffer" title="(i: Int)AnyRef">inputBuffer</a><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.nextInputElementCursor_=" title="=&gt; Int">nextInputElementCursor</a><span class="delimiter">)</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.inputBuffer" title="(i: Int, x: AnyRef)Unit">inputBuffer</a><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.nextInputElementCursor_=" title="=&gt; Int">nextInputElementCursor</a><span class="delimiter">)</span> = null

    <a href="#akka.stream.impl;BatchingInputBuffer.batchRemaining_=" title="(x$1: Int)Unit">batchRemaining</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>
    if <span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.batchRemaining_=" title="=&gt; Int">batchRemaining</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#akka.stream.impl;BatchingInputBuffer.upstreamCompleted_=" title="=&gt; Boolean">upstreamCompleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.stream.impl;BatchingInputBuffer.upstream_=" title="=&gt; org.reactivestreams.Subscription">upstream</a>.<span title="(x$1: Long)Unit">request</span><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.requestBatchSize" title="=&gt; Long">requestBatchSize</a><span class="delimiter">)</span>
      <a href="#akka.stream.impl;BatchingInputBuffer.batchRemaining_=" title="(x$1: Int)Unit">batchRemaining</a> = <a href="#akka.stream.impl;BatchingInputBuffer.requestBatchSize" title="=&gt; Int">requestBatchSize</a>
    <span class="delimiter">}</span>

    <a href="#akka.stream.impl;BatchingInputBuffer.inputBufferElements_=" title="(x$1: Int)Unit">inputBufferElements</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.nextInputElementCursor_=" title="(x$1: Int)Unit">nextInputElementCursor</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.nextInputElementCursor_=" title="(x$1: Int)Unit">nextInputElementCursor</a> <span title="(x: Int)Int">&amp;=</span> <a href="#akka.stream.impl;BatchingInputBuffer.IndexMask" title="=&gt; Int">IndexMask</a>
    <a href="#akka.stream.impl;BatchingInputBuffer.dequeueInputElement.elem" title="AnyRef">elem</a>
  <span class="delimiter">}</span>

  protected final def <a title="(elem: Any)Unit" id="akka.stream.impl;BatchingInputBuffer.enqueueInputElement">enqueueInputElement</a><span class="delimiter">(</span><a title="Any" id="akka.stream.impl;BatchingInputBuffer.enqueueInputElement.elem">elem</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="Transfer.scala.html#akka.stream.impl;Inputs.isOpen" title="=&gt; Boolean">isOpen</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.inputBufferElements_=" title="=&gt; Int">inputBufferElements</a> <span title="(x: Int)Boolean">==</span> <a href="#akka.stream.impl;BatchingInputBuffer.size" title="=&gt; Int">size</a><span class="delimiter">)</span> throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;Input buffer overrun&quot;)" class="string">&quot;Input buffer overrun&quot;</span><span class="delimiter">)</span>
      <a href="#akka.stream.impl;BatchingInputBuffer.inputBuffer" title="(i: Int, x: AnyRef)Unit">inputBuffer</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.nextInputElementCursor_=" title="=&gt; Int">nextInputElementCursor</a> <span title="(x: Int)Int">+</span> <a href="#akka.stream.impl;BatchingInputBuffer.inputBufferElements_=" title="=&gt; Int">inputBufferElements</a><span class="delimiter">)</span> <span title="(x: Int)Int">&amp;</span> <a href="#akka.stream.impl;BatchingInputBuffer.IndexMask" title="=&gt; Int">IndexMask</a><span class="delimiter">)</span> = <a href="#akka.stream.impl;BatchingInputBuffer.enqueueInputElement.elem" title="Any">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
      <a href="#akka.stream.impl;BatchingInputBuffer.inputBufferElements_=" title="(x$1: Int)Unit">inputBufferElements</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.pump" title="=&gt; akka.stream.impl.Pump">pump</a>.<a href="Transfer.scala.html#akka.stream.impl;Pump.pump" title="()Unit">pump</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="()Unit" id="akka.stream.impl;BatchingInputBuffer.cancel">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.impl;BatchingInputBuffer.upstreamCompleted_=" title="=&gt; Boolean">upstreamCompleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.stream.impl;BatchingInputBuffer.upstreamCompleted_=" title="(x$1: Boolean)Unit">upstreamCompleted</a> = true
      if <span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.upstream_=" title="=&gt; org.reactivestreams.Subscription">upstream</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl;BatchingInputBuffer.upstream_=" title="=&gt; org.reactivestreams.Subscription">upstream</a>.<span title="()Unit">cancel</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.stream.impl;BatchingInputBuffer.clear" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  override def <a title="=&gt; Boolean" id="akka.stream.impl;BatchingInputBuffer.isClosed">isClosed</a>: <span title="Boolean">Boolean</span> = <a href="#akka.stream.impl;BatchingInputBuffer.upstreamCompleted_=" title="=&gt; Boolean">upstreamCompleted</a>

  private def <a title="()Unit" id="akka.stream.impl;BatchingInputBuffer.clear">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span title="java.util.Arrays.type">Arrays</span>.<span title="(x$1: Array[Object], x$2: Int, x$3: Int, x$4: Any)Unit">fill</span><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.inputBuffer" title="=&gt; Array[AnyRef]">inputBuffer</a>, <span title="Int(0)" class="int">0</span>, <a href="#akka.stream.impl;BatchingInputBuffer.inputBuffer" title="=&gt; Array[AnyRef]">inputBuffer</a>.<span title="=&gt; Int">length</span>, null<span class="delimiter">)</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.inputBufferElements_=" title="(x$1: Int)Unit">inputBufferElements</a> = <span title="Int(0)" class="int">0</span>
  <span class="delimiter">}</span>

  override def <a title="=&gt; Boolean" id="akka.stream.impl;BatchingInputBuffer.inputsDepleted">inputsDepleted</a> = <a href="#akka.stream.impl;BatchingInputBuffer.upstreamCompleted_=" title="=&gt; Boolean">upstreamCompleted</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#akka.stream.impl;BatchingInputBuffer.inputBufferElements_=" title="=&gt; Int">inputBufferElements</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span>
  override def <a title="=&gt; Boolean" id="akka.stream.impl;BatchingInputBuffer.inputsAvailable">inputsAvailable</a> = <a href="#akka.stream.impl;BatchingInputBuffer.inputBufferElements_=" title="=&gt; Int">inputBufferElements</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span>

  protected def <a title="()Unit" id="akka.stream.impl;BatchingInputBuffer.onComplete">onComplete</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.upstreamCompleted_=" title="(x$1: Boolean)Unit">upstreamCompleted</a> = true
    <a href="#akka.stream.impl;BatchingInputBuffer.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a>.<a href="Transfer.scala.html#akka.stream.impl;SubReceive.become" title="(newBehavior: akka.actor.Actor.Receive)Unit">become</a><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.completed" title="=&gt; akka.actor.Actor.Receive">completed</a><span class="delimiter">)</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.pump" title="=&gt; akka.stream.impl.Pump">pump</a>.<a href="Transfer.scala.html#akka.stream.impl;Pump.pump" title="()Unit">pump</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  protected def <a title="(subscription: org.reactivestreams.Subscription)Unit" id="akka.stream.impl;BatchingInputBuffer.onSubscribe">onSubscribe</a><span class="delimiter">(</span><a title="org.reactivestreams.Subscription" id="akka.stream.impl;BatchingInputBuffer.onSubscribe.subscription">subscription</a>: <span title="org.reactivestreams.Subscription">Subscription</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.onSubscribe.subscription" title="org.reactivestreams.Subscription">subscription</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.upstream_=" title="(x$1: org.reactivestreams.Subscription)Unit">upstream</a> = <a href="#akka.stream.impl;BatchingInputBuffer.onSubscribe.subscription" title="org.reactivestreams.Subscription">subscription</a>
    <span class="comment">// Prefetch</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.upstream_=" title="=&gt; org.reactivestreams.Subscription">upstream</a>.<span title="(x$1: Long)Unit">request</span><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.inputBuffer" title="=&gt; Array[AnyRef]">inputBuffer</a>.<span title="=&gt; Long">length</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a>.<a href="Transfer.scala.html#akka.stream.impl;SubReceive.become" title="(newBehavior: akka.actor.Actor.Receive)Unit">become</a><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.upstreamRunning" title="=&gt; akka.actor.Actor.Receive">upstreamRunning</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  protected def <a title="(e: Throwable)Unit" id="akka.stream.impl;BatchingInputBuffer.onError">onError</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;BatchingInputBuffer.onError.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.upstreamCompleted_=" title="(x$1: Boolean)Unit">upstreamCompleted</a> = true
    <a href="#akka.stream.impl;BatchingInputBuffer.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a>.<a href="Transfer.scala.html#akka.stream.impl;SubReceive.become" title="(newBehavior: akka.actor.Actor.Receive)Unit">become</a><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.completed" title="=&gt; akka.actor.Actor.Receive">completed</a><span class="delimiter">)</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.inputOnError" title="(e: Throwable)Unit">inputOnError</a><span class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.onError.e" title="Throwable">e</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  protected def <a title="=&gt; akka.actor.Actor.Receive" id="akka.stream.impl;BatchingInputBuffer.waitingForUpstream">waitingForUpstream</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;BatchingInputBuffer.waitingForUpstream;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case <a href="../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriberMessage.OnComplete" title="akka.stream.actor.ActorSubscriberMessage.OnComplete.type">OnComplete</a>                ⇒ <a href="#akka.stream.impl;BatchingInputBuffer.onComplete" title="()Unit">onComplete</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span>
    case OnSubscribe<span class="delimiter">(</span><a title="org.reactivestreams.Subscription" id="akka.stream.impl;BatchingInputBuffer.waitingForUpstream;$anonfun.isDefinedAt.subscription">subscription</a><span class="delimiter">)</span> ⇒ <a href="#akka.stream.impl;BatchingInputBuffer.onSubscribe" title="(subscription: org.reactivestreams.Subscription)Unit">onSubscribe</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.waitingForUpstream;$anonfun.isDefinedAt.subscription" title="org.reactivestreams.Subscription">subscription</a><span class="delimiter">)</span>
    case OnError<span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;BatchingInputBuffer.waitingForUpstream;$anonfun.isDefinedAt.cause">cause</a><span class="delimiter">)</span>            ⇒ <a href="#akka.stream.impl;BatchingInputBuffer.onError" title="(e: Throwable)Unit">onError</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.waitingForUpstream;$anonfun.isDefinedAt.cause" title="Throwable">cause</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  protected def <a title="=&gt; akka.actor.Actor.Receive" id="akka.stream.impl;BatchingInputBuffer.upstreamRunning">upstreamRunning</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;BatchingInputBuffer.upstreamRunning;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case OnNext<span class="delimiter">(</span><a title="Any" id="akka.stream.impl;BatchingInputBuffer.upstreamRunning;$anonfun.isDefinedAt.element">element</a><span class="delimiter">)</span>           ⇒ <a href="#akka.stream.impl;BatchingInputBuffer.enqueueInputElement" title="(elem: Any)Unit">enqueueInputElement</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.upstreamRunning;$anonfun.isDefinedAt.element" title="Any">element</a><span class="delimiter">)</span>
    case <a href="../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriberMessage.OnComplete" title="akka.stream.actor.ActorSubscriberMessage.OnComplete.type">OnComplete</a>                ⇒ <a href="#akka.stream.impl;BatchingInputBuffer.onComplete" title="()Unit">onComplete</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span>
    case OnError<span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;BatchingInputBuffer.upstreamRunning;$anonfun.isDefinedAt.cause">cause</a><span class="delimiter">)</span>            ⇒ <a href="#akka.stream.impl;BatchingInputBuffer.onError" title="(e: Throwable)Unit">onError</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.stream.impl;BatchingInputBuffer.upstreamRunning;$anonfun.isDefinedAt.cause" title="Throwable">cause</a><span class="delimiter">)</span>
    case OnSubscribe<span class="delimiter">(</span><a title="org.reactivestreams.Subscription" id="akka.stream.impl;BatchingInputBuffer.upstreamRunning;$anonfun.isDefinedAt.subscription">subscription</a><span class="delimiter">)</span> ⇒ <a href="#akka.stream.impl;BatchingInputBuffer.upstreamRunning;$anonfun.isDefinedAt.subscription" title="org.reactivestreams.Subscription">subscription</a>.<span title="()Unit">cancel</span><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span> <span class="comment">// spec rule 2.5</span>
  <span class="delimiter">}</span>

  protected def <a title="=&gt; akka.actor.Actor.Receive" id="akka.stream.impl;BatchingInputBuffer.completed">completed</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;BatchingInputBuffer.completed;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case OnSubscribe<span class="delimiter">(</span><a title="org.reactivestreams.Subscription" id="akka.stream.impl;BatchingInputBuffer.completed;$anonfun.isDefinedAt.subscription">subscription</a><span class="delimiter">)</span> ⇒ throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;Cannot subscribe shutdown subscriber&quot;)" class="string">&quot;Cannot subscribe shutdown subscriber&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  protected def <a title="(e: Throwable)Unit" id="akka.stream.impl;BatchingInputBuffer.inputOnError">inputOnError</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;BatchingInputBuffer.inputOnError.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl;BatchingInputBuffer.clear" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> class <a title="class SimpleOutputs extends AnyRef with akka.stream.impl.DefaultOutputTransferStates" id="akka.stream.impl;SimpleOutputs">SimpleOutputs</a><a href="#akka.stream.impl;SimpleOutputs" title="akka.stream.impl.SimpleOutputs" class="delimiter">(</a>val <a title="akka.actor.ActorRef" id="akka.stream.impl;SimpleOutputs.actor">actor</a>: <span title="akka.actor.ActorRef">ActorRef</span>, val <a title="akka.stream.impl.Pump" id="akka.stream.impl;SimpleOutputs.pump">pump</a>: <a href="Transfer.scala.html#akka.stream.impl;Pump" title="akka.stream.impl.Pump">Pump</a><span class="delimiter">)</span> extends <a href="Transfer.scala.html#akka.stream.impl;DefaultOutputTransferStates" title="akka.stream.impl.DefaultOutputTransferStates">DefaultOutputTransferStates</a> <span class="delimiter">{</span>

  protected var <a title="akka.stream.impl.ActorPublisher[Any]" id="akka.stream.impl;SimpleOutputs.exposedPublisher_=">exposedPublisher</a>: <a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher" title="akka.stream.impl.ActorPublisher[Any]">ActorPublisher</a><span class="delimiter">[</span>Any<span class="delimiter">]</span> = _

  protected var <a title="org.reactivestreams.Subscriber[Any]" id="akka.stream.impl;SimpleOutputs.subscriber_=">subscriber</a>: <span title="org.reactivestreams.Subscriber[Any]">Subscriber</span><span class="delimiter">[</span>Any<span class="delimiter">]</span> = _
  protected var <a title="Long" id="akka.stream.impl;SimpleOutputs.downstreamDemand_=">downstreamDemand</a>: <span title="Long">Long</span> = <span title="Long(0L)" class="long">0L</span>
  protected var <a title="Boolean" id="akka.stream.impl;SimpleOutputs.downstreamCompleted_=">downstreamCompleted</a> = false
  override def <a title="=&gt; Boolean" id="akka.stream.impl;SimpleOutputs.demandAvailable">demandAvailable</a> = <a href="#akka.stream.impl;SimpleOutputs.downstreamDemand_=" title="=&gt; Long">downstreamDemand</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span>
  override def <a title="=&gt; Long" id="akka.stream.impl;SimpleOutputs.demandCount">demandCount</a>: <span title="Long">Long</span> = <a href="#akka.stream.impl;SimpleOutputs.downstreamDemand_=" title="=&gt; Long">downstreamDemand</a>

  override def <a title="=&gt; akka.stream.impl.SubReceive" id="akka.stream.impl;SimpleOutputs.subreceive">subreceive</a> = <a href="#akka.stream.impl;SimpleOutputs._subreceive" title="=&gt; akka.stream.impl.SubReceive">_subreceive</a>
  private val <a title="akka.stream.impl.SubReceive" id="akka.stream.impl;SimpleOutputs._subreceive">_subreceive</a> = new <a href="Transfer.scala.html#akka.stream.impl;SubReceive" title="akka.stream.impl.SubReceive">SubReceive</a><span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.waitingExposedPublisher" title="=&gt; akka.actor.Actor.Receive">waitingExposedPublisher</a><span class="delimiter">)</span>

  def <a title="(elem: Any)Unit" id="akka.stream.impl;SimpleOutputs.enqueueOutputElement">enqueueOutputElement</a><span class="delimiter">(</span><a title="Any" id="akka.stream.impl;SimpleOutputs.enqueueOutputElement.elem">elem</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl;SimpleOutputs.downstreamDemand_=" title="(x$1: Long)Unit">downstreamDemand</a> <span title="(x: Int)Long">-=</span> <span title="Int(1)" class="int">1</span>
    <a href="#akka.stream.impl;SimpleOutputs.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="(x$1: Any)Unit">onNext</span><span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.enqueueOutputElement.elem" title="Any">elem</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="()Unit" id="akka.stream.impl;SimpleOutputs.complete">complete</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.impl;SimpleOutputs.downstreamCompleted_=" title="=&gt; Boolean">downstreamCompleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.stream.impl;SimpleOutputs.downstreamCompleted_=" title="(x$1: Boolean)Unit">downstreamCompleted</a> = true
      if <span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl;SimpleOutputs.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="()Unit">onComplete</span><span class="delimiter">(</span><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl;SimpleOutputs.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><span title="None.type">None</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(e: Throwable)Unit" id="akka.stream.impl;SimpleOutputs.cancel">cancel</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;SimpleOutputs.cancel.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.impl;SimpleOutputs.downstreamCompleted_=" title="=&gt; Boolean">downstreamCompleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.stream.impl;SimpleOutputs.downstreamCompleted_=" title="(x$1: Boolean)Unit">downstreamCompleted</a> = true
      if <span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl;SimpleOutputs.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="(x$1: Throwable)Unit">onError</span><span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.cancel.e" title="Throwable">e</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl;SimpleOutputs.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><span title="(x: Throwable)Some[Throwable]">Some</span><span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.cancel.e" title="Throwable">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="=&gt; Boolean" id="akka.stream.impl;SimpleOutputs.isClosed">isClosed</a>: <span title="Boolean">Boolean</span> = <a href="#akka.stream.impl;SimpleOutputs.downstreamCompleted_=" title="=&gt; Boolean">downstreamCompleted</a>

  protected def <a title="()org.reactivestreams.Subscription" id="akka.stream.impl;SimpleOutputs.createSubscription">createSubscription</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="org.reactivestreams.Subscription">Subscription</span> = <span class="delimiter">{</span>
    new <a href="ActorPublisher.scala.html#akka.stream.impl;ActorSubscription" title="akka.stream.impl.ActorSubscription[Any]">ActorSubscription</a><span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.actor" title="=&gt; akka.actor.ActorRef">actor</a>, <a href="#akka.stream.impl;SimpleOutputs.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="(subscribers: Seq[org.reactivestreams.Subscriber[Any]])Unit" id="akka.stream.impl;SimpleOutputs.subscribePending">subscribePending</a><span class="delimiter">(</span><a title="Seq[org.reactivestreams.Subscriber[Any]]" id="akka.stream.impl;SimpleOutputs.subscribePending.subscribers">subscribers</a>: <span title="Seq[org.reactivestreams.Subscriber[Any]]">Seq</span><span class="delimiter">[</span>Subscriber<span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a href="#akka.stream.impl;SimpleOutputs.subscribePending.subscribers" title="Seq[org.reactivestreams.Subscriber[Any]]">subscribers</a> <span title="(f: org.reactivestreams.Subscriber[Any] =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="org.reactivestreams.Subscriber[Any]" id="akka.stream.impl;SimpleOutputs.subscribePending.$anonfun.sub">sub</a> ⇒
      if <span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a> <span title="(x$1: AnyRef)Boolean">eq</span> null<span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#akka.stream.impl;SimpleOutputs.subscriber_=" title="(x$1: org.reactivestreams.Subscriber[Any])Unit">subscriber</a> = <a href="#akka.stream.impl;SimpleOutputs.subscribePending.$anonfun.sub" title="org.reactivestreams.Subscriber[Any]">sub</a>
        <a href="#akka.stream.impl;SimpleOutputs.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="(x$1: org.reactivestreams.Subscription)Unit">onSubscribe</span><span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.createSubscription" title="()org.reactivestreams.Subscription">createSubscription</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> else <a href="#akka.stream.impl;SimpleOutputs.subscribePending.$anonfun.sub" title="org.reactivestreams.Subscriber[Any]">sub</a>.<span title="(x$1: Throwable)Unit">onError</span><span class="delimiter">(</span>new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;&quot;)">$</span><span class="delimiter">{</span><a href="#akka.stream.impl;SimpleOutputs" title="()Class[_]">getClass</a>.<span title="()String">getSimpleName</span><span class="delimiter">}</span><span title="String(&quot; &quot;)"> $</span><span class="delimiter">{</span>ReactiveStreamsCompliance.<span title="String(&quot;only supports one subscriber (which is allowed, see reactive-streams specification, rule 1.12)&quot;)">SupportsOnlyASingleSubscriber</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  protected def <a title="=&gt; akka.actor.Actor.Receive" id="akka.stream.impl;SimpleOutputs.waitingExposedPublisher">waitingExposedPublisher</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;SimpleOutputs.waitingExposedPublisher;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case ExposedPublisher<span class="delimiter">(</span><a title="akka.stream.impl.ActorPublisher[Any]" id="akka.stream.impl;SimpleOutputs.waitingExposedPublisher;$anonfun.isDefinedAt.publisher">publisher</a><span class="delimiter">)</span> ⇒
      <a href="#akka.stream.impl;SimpleOutputs.exposedPublisher_=" title="(x$1: akka.stream.impl.ActorPublisher[Any])Unit">exposedPublisher</a> = <a href="#akka.stream.impl;SimpleOutputs.waitingExposedPublisher;$anonfun.isDefinedAt.publisher" title="akka.stream.impl.ActorPublisher[Any]">publisher</a>
      <a href="#akka.stream.impl;SimpleOutputs.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a>.<a href="Transfer.scala.html#akka.stream.impl;SubReceive.become" title="(newBehavior: akka.actor.Actor.Receive)Unit">become</a><span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.downstreamRunning" title="=&gt; akka.actor.Actor.Receive">downstreamRunning</a><span class="delimiter">)</span>
    case <a title="Any" id="akka.stream.impl;SimpleOutputs.waitingExposedPublisher;$anonfun.isDefinedAt.other">other</a> ⇒
      throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;The first message must be ExposedPublisher but was [&quot;)">The first message must be ExposedPublisher but was [$</span><a href="#akka.stream.impl;SimpleOutputs.waitingExposedPublisher;$anonfun.isDefinedAt.other" title="Any">other</a><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  protected def <a title="=&gt; akka.actor.Actor.Receive" id="akka.stream.impl;SimpleOutputs.downstreamRunning">downstreamRunning</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;SimpleOutputs.downstreamRunning;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case <a href="Messages.scala.html#akka.stream.impl.SubscribePending" title="akka.stream.impl.SubscribePending.type">SubscribePending</a> ⇒
      <a href="#akka.stream.impl;SimpleOutputs.subscribePending" title="(subscribers: Seq[org.reactivestreams.Subscriber[Any]])Unit">subscribePending</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.takePendingSubscribers" title="()scala.collection.immutable.Seq[org.reactivestreams.Subscriber[_ &gt;: Any]]">takePendingSubscribers</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    case RequestMore<span class="delimiter">(</span><span title="akka.stream.impl.ActorSubscription[_]">subscription</span>, <a title="Long" id="akka.stream.impl;SimpleOutputs.downstreamRunning;$anonfun.isDefinedAt.elements">elements</a><span class="delimiter">)</span> ⇒

      <a href="#akka.stream.impl;SimpleOutputs.downstreamDemand_=" title="(x$1: Long)Unit">downstreamDemand</a> <span title="(x: Long)Long">+=</span> <a href="#akka.stream.impl;SimpleOutputs.downstreamRunning;$anonfun.isDefinedAt.elements" title="Long">elements</a>
      if <span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.downstreamDemand_=" title="=&gt; Long">downstreamDemand</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// Long has overflown</span>
        val <a title="IllegalStateException" id="akka.stream.impl;SimpleOutputs.downstreamRunning;$anonfun.applyOrElse.demandOverflowException">demandOverflowException</a> = new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span>ReactiveStreamsCompliance.<span title="String(&quot;Total pending demand MUST NOT be &gt; `java.lang.Long.MAX_VALUE` (see reactive-streams specification, rule 3.17)&quot;)">TotalPendingDemandMustNotExceedLongMaxValue</span><span class="delimiter">)</span>
        <a href="#akka.stream.impl;SimpleOutputs.cancel" title="(e: Throwable)Unit">cancel</a><span class="delimiter">(</span><a href="#akka.stream.impl;SimpleOutputs.downstreamRunning;$anonfun.applyOrElse.demandOverflowException" title="IllegalStateException">demandOverflowException</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#akka.stream.impl;SimpleOutputs.pump" title="=&gt; akka.stream.impl.Pump">pump</a>.<a href="Transfer.scala.html#akka.stream.impl;Pump.pump" title="()Unit">pump</a><span class="delimiter">(</span><span class="delimiter">)</span>
    case Cancel<span class="delimiter">(</span><span title="akka.stream.impl.ActorSubscription[_]">subscription</span><span class="delimiter">)</span> ⇒
      <a href="#akka.stream.impl;SimpleOutputs.downstreamCompleted_=" title="(x$1: Boolean)Unit">downstreamCompleted</a> = true
      <a href="#akka.stream.impl;SimpleOutputs.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><span title="(x: akka.stream.impl.ActorPublisher.NormalShutdownException)Some[akka.stream.impl.ActorPublisher.NormalShutdownException]">Some</span><span class="delimiter">(</span>new <a href="ActorPublisher.scala.html#akka.stream.impl.ActorPublisher" title="akka.stream.impl.ActorPublisher.type">ActorPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl.ActorPublisher;NormalShutdownException" title="akka.stream.impl.ActorPublisher.NormalShutdownException">NormalShutdownException</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.stream.impl;SimpleOutputs.pump" title="=&gt; akka.stream.impl.Pump">pump</a>.<a href="Transfer.scala.html#akka.stream.impl;Pump.pump" title="()Unit">pump</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> abstract class <a title="class ActorProcessorImpl extends AnyRef with akka.actor.Actor with akka.actor.ActorLogging with akka.stream.impl.Pump with akka.actor.Stash" id="akka.stream.impl;ActorProcessorImpl">ActorProcessorImpl</a><a href="#akka.stream.impl;ActorProcessorImpl" title="akka.stream.impl.ActorProcessorImpl" class="delimiter">(</a>val <a title="akka.stream.MaterializerSettings" id="akka.stream.impl;ActorProcessorImpl.settings">settings</a>: <a href="../FlowMaterializer.scala.html#akka.stream;MaterializerSettings" title="akka.stream.MaterializerSettings">MaterializerSettings</a><span class="delimiter">)</span>
  extends <a href="#akka.stream.impl;ActorProcessorImpl" title="akka.actor.Actor">Actor</a>
  with <span title="akka.actor.ActorLogging">ActorLogging</span>
  with <a href="Transfer.scala.html#akka.stream.impl;Pump" title="akka.stream.impl.Pump">Pump</a>
  with <span title="akka.actor.Stash">Stash</span> <span class="delimiter">{</span>

  <span class="comment">// FIXME: make pump a member</span>
  protected val <a title="akka.stream.impl.Inputs" id="akka.stream.impl;ActorProcessorImpl.primaryInputs">primaryInputs</a>: <a href="Transfer.scala.html#akka.stream.impl;Inputs" title="akka.stream.impl.Inputs">Inputs</a> = new <a href="#akka.stream.impl;BatchingInputBuffer" title="&lt;$anon: akka.stream.impl.BatchingInputBuffer&gt; extends akka.stream.impl.BatchingInputBuffer" id="akka.stream.impl;ActorProcessorImpl.primaryInputs;$anon">BatchingInputBuffer</a><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl.settings" title="=&gt; akka.stream.MaterializerSettings">settings</a>.<a href="../FlowMaterializer.scala.html#akka.stream;MaterializerSettings.initialInputBufferSize" title="=&gt; Int">initialInputBufferSize</a>, this<span class="delimiter">)</span> <span class="delimiter">{</span>
    override def <a title="(e: Throwable)Unit" id="akka.stream.impl;ActorProcessorImpl.primaryInputs;$anon.inputOnError">inputOnError</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;ActorProcessorImpl.primaryInputs;$anon.inputOnError.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl;ActorProcessorImpl" title="ActorProcessorImpl.this.type">ActorProcessorImpl</a>.this.<a href="#akka.stream.impl;ActorProcessorImpl.onError" title="(e: Throwable)Unit">onError</a><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl.primaryInputs;$anon.inputOnError.e" title="Throwable">e</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  protected val <a title="akka.stream.impl.Outputs" id="akka.stream.impl;ActorProcessorImpl.primaryOutputs">primaryOutputs</a>: <a href="Transfer.scala.html#akka.stream.impl;Outputs" title="akka.stream.impl.Outputs">Outputs</a> = new <a href="#akka.stream.impl;SimpleOutputs" title="akka.stream.impl.SimpleOutputs">SimpleOutputs</a><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl" title="=&gt; akka.actor.ActorRef">self</a>, this<span class="delimiter">)</span>

  <span class="comment">/**
   * Subclass may override [[#activeReceive]]
   */</span>
  final override def <a title="=&gt; PartialFunction[Any,Unit]" id="akka.stream.impl;ActorProcessorImpl.receive">receive</a> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;ActorProcessorImpl.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    <span class="comment">// FIXME using Stash mailbox is not the best for performance, we probably want a better solution to this</span>
    case <a title="akka.stream.impl.ExposedPublisher" id="akka.stream.impl;ActorProcessorImpl.receive;$anonfun.isDefinedAt.ep">ep</a>: <a href="Messages.scala.html#akka.stream.impl;ExposedPublisher" title="akka.stream.impl.ExposedPublisher">ExposedPublisher</a> ⇒
      <a href="#akka.stream.impl;ActorProcessorImpl.primaryOutputs" title="=&gt; akka.stream.impl.Outputs">primaryOutputs</a>.<a href="Transfer.scala.html#akka.stream.impl;SubReceive.apply" title="(msg: Any)Unit">subreceive</a><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl.receive;$anonfun.isDefinedAt.ep" title="akka.stream.impl.ExposedPublisher">ep</a><span class="delimiter">)</span>
      <a href="#akka.stream.impl;ActorProcessorImpl" title="=&gt; akka.actor.ActorContext">context</a> <span title="(behavior: akka.actor.Actor.Receive)Unit">become</span> <a href="#akka.stream.impl;ActorProcessorImpl.activeReceive" title="=&gt; ActorProcessorImpl.this.Receive">activeReceive</a>
      <a href="#akka.stream.impl;ActorProcessorImpl" title="()Unit">unstashAll</a><span class="delimiter">(</span><span class="delimiter">)</span>
    case _ ⇒ <a href="#akka.stream.impl;ActorProcessorImpl" title="()Unit">stash</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="=&gt; ActorProcessorImpl.this.Receive" id="akka.stream.impl;ActorProcessorImpl.activeReceive">activeReceive</a>: <span title="ActorProcessorImpl.this.Receive">Receive</span> = <a href="#akka.stream.impl;ActorProcessorImpl.primaryInputs" title="=&gt; akka.stream.impl.Inputs">primaryInputs</a>.<a href="Transfer.scala.html#akka.stream.impl;Inputs.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a> <span title="(that: PartialFunction[Any,Unit])PartialFunction[Any,Unit]">orElse</span> <a href="#akka.stream.impl;ActorProcessorImpl.primaryOutputs" title="=&gt; akka.stream.impl.Outputs">primaryOutputs</a>.<a href="Transfer.scala.html#akka.stream.impl;Outputs.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a>

  protected def <a title="(e: Throwable)Unit" id="akka.stream.impl;ActorProcessorImpl.onError">onError</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;ActorProcessorImpl.onError.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl;ActorProcessorImpl.fail" title="(e: Throwable)Unit">fail</a><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl.onError.e" title="Throwable">e</a><span class="delimiter">)</span>

  protected def <a title="(e: Throwable)Unit" id="akka.stream.impl;ActorProcessorImpl.fail">fail</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;ActorProcessorImpl.fail.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl;ActorProcessorImpl" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(cause: Throwable, message: String)Unit">error</span><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl.fail.e" title="Throwable">e</a>, <span title="String(&quot;failure during processing&quot;)" class="string">&quot;failure during processing&quot;</span><span class="delimiter">)</span> <span class="comment">// FIXME: escalate to supervisor instead</span>
    <a href="#akka.stream.impl;ActorProcessorImpl.primaryInputs" title="=&gt; akka.stream.impl.Inputs">primaryInputs</a>.<a href="Transfer.scala.html#akka.stream.impl;Inputs.cancel" title="()Unit">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl;ActorProcessorImpl.primaryOutputs" title="=&gt; akka.stream.impl.Outputs">primaryOutputs</a>.<a href="Transfer.scala.html#akka.stream.impl;Outputs.cancel" title="(e: Throwable)Unit">cancel</a><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl.fail.e" title="Throwable">e</a><span class="delimiter">)</span>
    <a href="#akka.stream.impl;ActorProcessorImpl" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(actor: akka.actor.ActorRef)Unit">stop</span><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="()Unit" id="akka.stream.impl;ActorProcessorImpl.pumpFinished">pumpFinished</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl;ActorProcessorImpl.primaryInputs" title="=&gt; akka.stream.impl.Inputs">primaryInputs</a>.<a href="Transfer.scala.html#akka.stream.impl;Inputs.cancel" title="()Unit">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl;ActorProcessorImpl.primaryOutputs" title="=&gt; akka.stream.impl.Outputs">primaryOutputs</a>.<a href="Transfer.scala.html#akka.stream.impl;Outputs.complete" title="()Unit">complete</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl;ActorProcessorImpl" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(actor: akka.actor.ActorRef)Unit">stop</span><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="(e: Throwable)Unit" id="akka.stream.impl;ActorProcessorImpl.pumpFailed">pumpFailed</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;ActorProcessorImpl.pumpFailed.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl;ActorProcessorImpl.fail" title="(e: Throwable)Unit">fail</a><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl.pumpFailed.e" title="Throwable">e</a><span class="delimiter">)</span>

  override def <a title="()Unit" id="akka.stream.impl;ActorProcessorImpl.postStop">postStop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl;ActorProcessorImpl.primaryInputs" title="=&gt; akka.stream.impl.Inputs">primaryInputs</a>.<a href="Transfer.scala.html#akka.stream.impl;Inputs.cancel" title="()Unit">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl;ActorProcessorImpl.primaryOutputs" title="=&gt; akka.stream.impl.Outputs">primaryOutputs</a>.<a href="Transfer.scala.html#akka.stream.impl;Outputs.cancel" title="(e: Throwable)Unit">cancel</a><span class="delimiter">(</span>new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;Processor actor terminated abruptly&quot;)" class="string">&quot;Processor actor terminated abruptly&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="(reason: Throwable)Unit" id="akka.stream.impl;ActorProcessorImpl.postRestart">postRestart</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;ActorProcessorImpl.postRestart.reason">reason</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    super.<span title="(reason: Throwable)Unit">postRestart</span><span class="delimiter">(</span><a href="#akka.stream.impl;ActorProcessorImpl.postRestart.reason" title="Throwable">reason</a><span class="delimiter">)</span>
    throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;This actor cannot be restarted&quot;)" class="string">&quot;This actor cannot be restarted&quot;</span>, <a href="#akka.stream.impl;ActorProcessorImpl.postRestart.reason" title="Throwable">reason</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>akka/stream/impl/FuturePublisher.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
package akka.stream.impl

import scala.concurrent.Future
import scala.util.Failure
import scala.util.Success
import scala.util.Try

import akka.actor.Actor
import akka.actor.ActorRef
import akka.actor.Props
import akka.actor.Status
import akka.actor.SupervisorStrategy
import akka.stream.MaterializerSettings

import akka.pattern.pipe
import org.reactivestreams.Subscriber
import org.reactivestreams.Subscription

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> object <a title="akka.stream.impl.FuturePublisher.type" id="akka.stream.impl.FuturePublisher">FuturePublisher</a> <a href="#akka.stream.impl.FuturePublisher" title="akka.stream.impl.FuturePublisher.type" class="delimiter">{</a>
  def <a title="(future: scala.concurrent.Future[Any], settings: akka.stream.MaterializerSettings)akka.actor.Props" id="akka.stream.impl.FuturePublisher.props">props</a><span class="delimiter">(</span><a title="scala.concurrent.Future[Any]" id="akka.stream.impl.FuturePublisher.props.future">future</a>: <span title="scala.concurrent.Future[Any]">Future</span><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="akka.stream.MaterializerSettings" id="akka.stream.impl.FuturePublisher.props.settings">settings</a>: <a href="../FlowMaterializer.scala.html#akka.stream;MaterializerSettings" title="akka.stream.MaterializerSettings">MaterializerSettings</a><span class="delimiter">)</span>: <span title="akka.actor.Props">Props</span> =
    <span title="(creator: =&gt; akka.stream.impl.FuturePublisher)(implicit evidence$2: scala.reflect.ClassTag[akka.stream.impl.FuturePublisher])akka.actor.Props">Props</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[akka.stream.impl.FuturePublisher]" class="delimiter">(</span>new <a href="#akka.stream.impl;FuturePublisher" title="akka.stream.impl.FuturePublisher">FuturePublisher</a><span class="delimiter">(</span><a href="#akka.stream.impl.FuturePublisher.props.future" title="scala.concurrent.Future[Any]">future</a>, <a href="#akka.stream.impl.FuturePublisher.props.settings" title="akka.stream.MaterializerSettings">settings</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(d: String)akka.actor.Props">withDispatcher</span><span class="delimiter">(</span><a href="#akka.stream.impl.FuturePublisher.props.settings" title="akka.stream.MaterializerSettings">settings</a>.<a href="../FlowMaterializer.scala.html#akka.stream;MaterializerSettings.dispatcher" title="=&gt; String">dispatcher</a><span class="delimiter">)</span>

  object <a title="akka.stream.impl.FuturePublisher.FutureSubscription.type" id="akka.stream.impl.FuturePublisher.FutureSubscription">FutureSubscription</a> <a href="#akka.stream.impl.FuturePublisher.FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription.type" class="delimiter">{</a>
    case class <a title="class Cancel extends AnyRef with Product with Serializable" id="akka.stream.impl.FuturePublisher.FutureSubscription.Cancel.readResolve">Cancel</a><a href="#akka.stream.impl.FuturePublisher.FutureSubscription.Cancel.readResolve" title="Product" class="delimiter">(</a><a title="akka.stream.impl.FuturePublisher.FutureSubscription" id="akka.stream.impl.FuturePublisher.FutureSubscription;Cancel.subscription">subscription</a>: <a href="#akka.stream.impl.FuturePublisher;FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">FutureSubscription</a><span class="delimiter">)</span>
    case class <a title="class RequestMore extends AnyRef with Product with Serializable" id="akka.stream.impl.FuturePublisher.FutureSubscription.RequestMore.readResolve">RequestMore</a><a href="#akka.stream.impl.FuturePublisher.FutureSubscription.RequestMore.readResolve" title="Product" class="delimiter">(</a><a title="akka.stream.impl.FuturePublisher.FutureSubscription" id="akka.stream.impl.FuturePublisher.FutureSubscription;RequestMore.subscription">subscription</a>: <a href="#akka.stream.impl.FuturePublisher;FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">FutureSubscription</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  class <a title="class FutureSubscription extends Object with org.reactivestreams.Subscription" id="akka.stream.impl.FuturePublisher;FutureSubscription">FutureSubscription</a><a href="#akka.stream.impl.FuturePublisher;FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription" class="delimiter">(</a><a title="akka.actor.ActorRef" id="akka.stream.impl.FuturePublisher;FutureSubscription.ref">ref</a>: <span title="akka.actor.ActorRef">ActorRef</span><span class="delimiter">)</span> extends <a href="#akka.stream.impl.FuturePublisher;FutureSubscription" title="org.reactivestreams.Subscription">Subscription</a> <span class="delimiter">{</span>
    import akka.stream.impl.<a href="#akka.stream.impl.FuturePublisher" title="akka.stream.impl.FuturePublisher.type">FuturePublisher</a>.<a href="#akka.stream.impl.FuturePublisher.FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription.type">FutureSubscription</a>._
    def <a title="()Unit" id="akka.stream.impl.FuturePublisher;FutureSubscription.cancel">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl.FuturePublisher;FutureSubscription.ref" title="akka.actor.ScalaActorRef" id="akka.stream.impl.FuturePublisher;FutureSubscription.cancel.qual$1">ref</a> <a title="akka.actor.ActorRef" id="akka.stream.impl.FuturePublisher;FutureSubscription.cancel.x$2">!</a> <a href="#akka.stream.impl.FuturePublisher.FutureSubscription.Cancel.readResolve" title="(subscription: akka.stream.impl.FuturePublisher.FutureSubscription)akka.stream.impl.FuturePublisher.FutureSubscription.Cancel">Cancel</a><a title="akka.stream.impl.FuturePublisher.FutureSubscription.Cancel" id="akka.stream.impl.FuturePublisher;FutureSubscription.cancel.x$1" class="delimiter">(</a>this<span class="delimiter">)</span>
    def <a title="(elements: Long)Unit" id="akka.stream.impl.FuturePublisher;FutureSubscription.request">request</a><span class="delimiter">(</span><a title="Long" id="akka.stream.impl.FuturePublisher;FutureSubscription.request.elements">elements</a>: <span title="Long">Long</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      if <span class="delimiter">(</span><a href="#akka.stream.impl.FuturePublisher;FutureSubscription.request.elements" title="Long">elements</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> throw new <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span>ReactiveStreamsCompliance.<span title="String(&quot;The number of requested elements must be &gt; 0 (see reactive-streams specification, rule 3.9)&quot;)">NumberOfElementsInRequestMustBePositiveMsg</span><span class="delimiter">)</span>
      else <a href="#akka.stream.impl.FuturePublisher;FutureSubscription.ref" title="akka.actor.ScalaActorRef" id="akka.stream.impl.FuturePublisher;FutureSubscription.request.qual$2">ref</a> <a title="akka.actor.ActorRef" id="akka.stream.impl.FuturePublisher;FutureSubscription.request.x$4">!</a> <a href="#akka.stream.impl.FuturePublisher.FutureSubscription.RequestMore.readResolve" title="(subscription: akka.stream.impl.FuturePublisher.FutureSubscription)akka.stream.impl.FuturePublisher.FutureSubscription.RequestMore">RequestMore</a><a title="akka.stream.impl.FuturePublisher.FutureSubscription.RequestMore" id="akka.stream.impl.FuturePublisher;FutureSubscription.request.x$3" class="delimiter">(</a>this<span class="delimiter">)</span>
    override def <a title="()String" id="akka.stream.impl.FuturePublisher;FutureSubscription.toString">toString</a> = <span title="String(&quot;FutureSubscription&quot;)" class="string">&quot;FutureSubscription&quot;</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
<span class="comment">//FIXME why do we need to have an actor to drive a Future?</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> class <a title="class FuturePublisher extends AnyRef with akka.actor.Actor with akka.stream.impl.SoftShutdown" id="akka.stream.impl;FuturePublisher">FuturePublisher</a><a href="#akka.stream.impl;FuturePublisher" title="akka.stream.impl.FuturePublisher" class="delimiter">(</a><a title="scala.concurrent.Future[Any]" id="akka.stream.impl;FuturePublisher.future">future</a>: <span title="scala.concurrent.Future[Any]">Future</span><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="akka.stream.MaterializerSettings" id="akka.stream.impl;FuturePublisher.settings">settings</a>: <a href="../FlowMaterializer.scala.html#akka.stream;MaterializerSettings" title="akka.stream.MaterializerSettings">MaterializerSettings</a><span class="delimiter">)</span> extends <a href="#akka.stream.impl;FuturePublisher" title="akka.actor.Actor">Actor</a> with <a href="ActorPublisher.scala.html#akka.stream.impl;SoftShutdown" title="akka.stream.impl.SoftShutdown">SoftShutdown</a> <span class="delimiter">{</span>
  import akka.stream.impl.<a href="#akka.stream.impl.FuturePublisher" title="akka.stream.impl.FuturePublisher.type">FuturePublisher</a>.FutureSubscription
  import akka.stream.impl.<a href="#akka.stream.impl.FuturePublisher" title="akka.stream.impl.FuturePublisher.type">FuturePublisher</a>.<a href="#akka.stream.impl.FuturePublisher.FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription.type">FutureSubscription</a>.Cancel
  import akka.stream.impl.<a href="#akka.stream.impl.FuturePublisher" title="akka.stream.impl.FuturePublisher.type">FuturePublisher</a>.<a href="#akka.stream.impl.FuturePublisher.FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription.type">FutureSubscription</a>.RequestMore

  var <a title="akka.stream.impl.ActorPublisher[Any]" id="akka.stream.impl;FuturePublisher.exposedPublisher_=">exposedPublisher</a>: <a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher" title="akka.stream.impl.ActorPublisher[Any]">ActorPublisher</a><span class="delimiter">[</span>Any<span class="delimiter">]</span> = _
  var <a title="scala.collection.immutable.Map[org.reactivestreams.Subscriber[Any],akka.stream.impl.FuturePublisher.FutureSubscription]" id="akka.stream.impl;FuturePublisher.subscribers_=">subscribers</a> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[org.reactivestreams.Subscriber[Any],akka.stream.impl.FuturePublisher.FutureSubscription]" class="delimiter">[</span><span title="org.reactivestreams.Subscriber[Any]">Subscriber</span><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a href="#akka.stream.impl.FuturePublisher;FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">FutureSubscription</a><span class="delimiter">]</span>
  var <a title="scala.collection.immutable.Map[akka.stream.impl.FuturePublisher.FutureSubscription,org.reactivestreams.Subscriber[Any]]" id="akka.stream.impl;FuturePublisher.subscriptions_=">subscriptions</a> = <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[akka.stream.impl.FuturePublisher.FutureSubscription,org.reactivestreams.Subscriber[Any]]" class="delimiter">[</span><a href="#akka.stream.impl.FuturePublisher;FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">FutureSubscription</a>, <span title="org.reactivestreams.Subscriber[Any]">Subscriber</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span>
  var <a title="scala.collection.immutable.Set[akka.stream.impl.FuturePublisher.FutureSubscription]" id="akka.stream.impl;FuturePublisher.subscriptionsReadyForPush_=">subscriptionsReadyForPush</a> = <span title="=&gt; scala.collection.immutable.Set.type">Set</span>.<span title="[A]=&gt; scala.collection.immutable.Set[A]">empty</span><span title="scala.collection.immutable.Set[akka.stream.impl.FuturePublisher.FutureSubscription]" class="delimiter">[</span><a href="#akka.stream.impl.FuturePublisher;FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">FutureSubscription</a><span class="delimiter">]</span>
  var <a title="Option[scala.util.Try[Any]]" id="akka.stream.impl;FuturePublisher.futureValue_=">futureValue</a>: <span title="Option[scala.util.Try[Any]]">Option</span><span class="delimiter">[</span>Try<span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#akka.stream.impl;FuturePublisher.future" title="scala.concurrent.Future[Any]">future</a>.<span title="=&gt; Option[scala.util.Try[Any]]">value</span>
  var <a title="Option[Throwable]" id="akka.stream.impl;FuturePublisher.shutdownReason_=">shutdownReason</a> = <a href="ActorPublisher.scala.html#akka.stream.impl.ActorPublisher" title="akka.stream.impl.ActorPublisher.type">ActorPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl.ActorPublisher.NormalShutdownReason" title="=&gt; Option[Throwable]">NormalShutdownReason</a>

  override val <a title="akka.actor.SupervisorStrategy" id="akka.stream.impl;FuturePublisher.supervisorStrategy">supervisorStrategy</a> = <span title="akka.actor.SupervisorStrategy.type">SupervisorStrategy</span>.<span title="=&gt; akka.actor.SupervisorStrategy">stoppingStrategy</span>

  def <a title="=&gt; PartialFunction[Any,Unit]" id="akka.stream.impl;FuturePublisher.receive">receive</a> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;FuturePublisher.receive;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case ExposedPublisher<span class="delimiter">(</span><a title="akka.stream.impl.ActorPublisher[Any]" id="akka.stream.impl;FuturePublisher.receive;$anonfun.isDefinedAt.publisher">publisher</a><span class="delimiter">)</span> ⇒
      <a href="#akka.stream.impl;FuturePublisher.exposedPublisher_=" title="(x$1: akka.stream.impl.ActorPublisher[Any])Unit">exposedPublisher</a> = <a href="#akka.stream.impl;FuturePublisher.receive;$anonfun.isDefinedAt.publisher" title="akka.stream.impl.ActorPublisher[Any]">publisher</a>
      <a href="#akka.stream.impl;FuturePublisher" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(behavior: akka.actor.Actor.Receive)Unit">become</span><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.waitingForFirstSubscriber" title="=&gt; FuturePublisher.this.Receive">waitingForFirstSubscriber</a><span class="delimiter">)</span>
    case _ ⇒ throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;The first message must be ExposedPublisher&quot;)" class="string">&quot;The first message must be ExposedPublisher&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="=&gt; FuturePublisher.this.Receive" id="akka.stream.impl;FuturePublisher.waitingForFirstSubscriber">waitingForFirstSubscriber</a>: <span title="FuturePublisher.this.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;FuturePublisher.waitingForFirstSubscriber;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case <a href="Messages.scala.html#akka.stream.impl.SubscribePending" title="akka.stream.impl.SubscribePending.type">SubscribePending</a> ⇒
      <a href="#akka.stream.impl;FuturePublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.takePendingSubscribers" title="()scala.collection.immutable.Seq[org.reactivestreams.Subscriber[_ &gt;: Any]]">takePendingSubscribers</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(f: org.reactivestreams.Subscriber[_ &gt;: Any] =&gt; Unit)Unit">foreach</span> <a href="#akka.stream.impl;FuturePublisher.registerSubscriber" title="(subscriber: org.reactivestreams.Subscriber[Any])Unit">registerSubscriber</a>
      import <a href="#akka.stream.impl;FuturePublisher" title="=&gt; akka.actor.ActorContext">context</a>.dispatcher
      <a href="#akka.stream.impl;FuturePublisher.future" title="(future: scala.concurrent.Future[Any])(implicit executionContext: scala.concurrent.ExecutionContext)akka.pattern.PipeableFuture[Any]">future</a>.<span title="(recipient: akka.actor.ActorRef)(implicit sender: akka.actor.ActorRef)scala.concurrent.Future[Any]">pipeTo</span><a href="#akka.stream.impl;FuturePublisher" title="=&gt; akka.actor.ActorRef" class="delimiter">(</a><a href="#akka.stream.impl;FuturePublisher" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(behavior: akka.actor.Actor.Receive)Unit">become</span><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.active" title="=&gt; FuturePublisher.this.Receive">active</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="=&gt; FuturePublisher.this.Receive" id="akka.stream.impl;FuturePublisher.active">active</a>: <span title="FuturePublisher.this.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl;FuturePublisher.active;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case <a href="Messages.scala.html#akka.stream.impl.SubscribePending" title="akka.stream.impl.SubscribePending.type">SubscribePending</a> ⇒
      <a href="#akka.stream.impl;FuturePublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.takePendingSubscribers" title="()scala.collection.immutable.Seq[org.reactivestreams.Subscriber[_ &gt;: Any]]">takePendingSubscribers</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(f: org.reactivestreams.Subscriber[_ &gt;: Any] =&gt; Unit)Unit">foreach</span> <a href="#akka.stream.impl;FuturePublisher.registerSubscriber" title="(subscriber: org.reactivestreams.Subscriber[Any])Unit">registerSubscriber</a>
    case RequestMore<span class="delimiter">(</span><span title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</span><span class="delimiter">)</span> ⇒
      if <span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.subscriptions_=" title="=&gt; scala.collection.immutable.Map[akka.stream.impl.FuturePublisher.FutureSubscription,org.reactivestreams.Subscriber[Any]]">subscriptions</a>.<span title="(key: akka.stream.impl.FuturePublisher.FutureSubscription)Boolean">contains</span><span class="delimiter">(</span><span title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#akka.stream.impl;FuturePublisher.subscriptionsReadyForPush_=" title="(x$1: scala.collection.immutable.Set[akka.stream.impl.FuturePublisher.FutureSubscription])Unit">subscriptionsReadyForPush</a> <span title="(elem: akka.stream.impl.FuturePublisher.FutureSubscription)scala.collection.immutable.Set[akka.stream.impl.FuturePublisher.FutureSubscription]">+=</span> <span title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</span>
        <a href="#akka.stream.impl;FuturePublisher.push" title="(subscriber: org.reactivestreams.Subscriber[Any])Unit">push</a><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.subscriptions_=" title="(key: akka.stream.impl.FuturePublisher.FutureSubscription)org.reactivestreams.Subscriber[Any]">subscriptions</a><span class="delimiter">(</span><span title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    case Cancel<span class="delimiter">(</span><span title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</span><span class="delimiter">)</span> if <a href="#akka.stream.impl;FuturePublisher.subscriptions_=" title="=&gt; scala.collection.immutable.Map[akka.stream.impl.FuturePublisher.FutureSubscription,org.reactivestreams.Subscriber[Any]]">subscriptions</a>.<span title="(key: akka.stream.impl.FuturePublisher.FutureSubscription)Boolean">contains</span><span class="delimiter">(</span><span title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</span><span class="delimiter">)</span> ⇒
      <a href="#akka.stream.impl;FuturePublisher.removeSubscriber" title="(subscriber: org.reactivestreams.Subscriber[Any])Unit">removeSubscriber</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.subscriptions_=" title="(key: akka.stream.impl.FuturePublisher.FutureSubscription)org.reactivestreams.Subscriber[Any]">subscriptions</a><span class="delimiter">(</span><span title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</span><span class="delimiter">)</span><span class="delimiter">)</span>
    case Status.Failure<span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;FuturePublisher.active;$anonfun.isDefinedAt.ex">ex</a><span class="delimiter">)</span> ⇒
      <a href="#akka.stream.impl;FuturePublisher.futureValue_=" title="(x$1: Option[scala.util.Try[Any]])Unit">futureValue</a> = <span title="(x: scala.util.Failure[Nothing])Some[scala.util.Failure[Nothing]]">Some</span><span class="delimiter">(</span><span title="(exception: Throwable)scala.util.Failure[Nothing]">Failure</span><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.active;$anonfun.isDefinedAt.ex" title="Throwable">ex</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher.pushToAll" title="()Unit">pushToAll</a><span class="delimiter">(</span><span class="delimiter">)</span>
    case <a title="Any" id="akka.stream.impl;FuturePublisher.active;$anonfun.isDefinedAt.value">value</a> ⇒
      <a href="#akka.stream.impl;FuturePublisher.futureValue_=" title="(x$1: Option[scala.util.Try[Any]])Unit">futureValue</a> = <span title="(x: scala.util.Success[Any])Some[scala.util.Success[Any]]">Some</span><span class="delimiter">(</span><span title="(value: Any)scala.util.Success[Any]">Success</span><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.active;$anonfun.isDefinedAt.value" title="Any">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher.pushToAll" title="()Unit">pushToAll</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="()Unit" id="akka.stream.impl;FuturePublisher.pushToAll">pushToAll</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl;FuturePublisher.subscriptionsReadyForPush_=" title="=&gt; scala.collection.immutable.Set[akka.stream.impl.FuturePublisher.FutureSubscription]">subscriptionsReadyForPush</a> <span title="(f: akka.stream.impl.FuturePublisher.FutureSubscription =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="akka.stream.impl.FuturePublisher.FutureSubscription" id="akka.stream.impl;FuturePublisher.pushToAll.$anonfun.subscription">subscription</a> ⇒ <a href="#akka.stream.impl;FuturePublisher.push" title="(subscriber: org.reactivestreams.Subscriber[Any])Unit">push</a><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.subscriptions_=" title="(key: akka.stream.impl.FuturePublisher.FutureSubscription)org.reactivestreams.Subscriber[Any]">subscriptions</a><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.pushToAll.$anonfun.subscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span>

  def <a title="(subscriber: org.reactivestreams.Subscriber[Any])Unit" id="akka.stream.impl;FuturePublisher.push">push</a><span class="delimiter">(</span><a title="org.reactivestreams.Subscriber[Any]" id="akka.stream.impl;FuturePublisher.push.subscriber">subscriber</a>: <span title="org.reactivestreams.Subscriber[Any]">Subscriber</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.impl;FuturePublisher.futureValue_=" title="=&gt; Option[scala.util.Try[Any]]">futureValue</a> match <span class="delimiter">{</span>
    case Some<span class="delimiter">(</span>Success<span class="delimiter">(</span><a title="Any" id="akka.stream.impl;FuturePublisher.push.value">value</a><span class="delimiter">)</span><span class="delimiter">)</span> ⇒
      <a href="#akka.stream.impl;FuturePublisher.push.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="(x$1: Any)Unit">onNext</span><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.push.value" title="Any">value</a><span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher.push.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="()Unit">onComplete</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher.removeSubscriber" title="(subscriber: org.reactivestreams.Subscriber[Any])Unit">removeSubscriber</a><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.push.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a><span class="delimiter">)</span>
    case Some<span class="delimiter">(</span>Failure<span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl;FuturePublisher.push.t">t</a><span class="delimiter">)</span><span class="delimiter">)</span> ⇒
      <a href="#akka.stream.impl;FuturePublisher.push.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="(x$1: Throwable)Unit">onError</span><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.push.t" title="Throwable">t</a><span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher.removeSubscriber" title="(subscriber: org.reactivestreams.Subscriber[Any])Unit">removeSubscriber</a><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.push.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a><span class="delimiter">)</span>
    case <span title="None.type">None</span> ⇒ <span class="comment">// not completed yet</span>
  <span class="delimiter">}</span>

  def <a title="(subscriber: org.reactivestreams.Subscriber[Any])Unit" id="akka.stream.impl;FuturePublisher.registerSubscriber">registerSubscriber</a><span class="delimiter">(</span><a title="org.reactivestreams.Subscriber[Any]" id="akka.stream.impl;FuturePublisher.registerSubscriber.subscriber">subscriber</a>: <span title="org.reactivestreams.Subscriber[Any]">Subscriber</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.subscribers_=" title="=&gt; scala.collection.immutable.Map[org.reactivestreams.Subscriber[Any],akka.stream.impl.FuturePublisher.FutureSubscription]">subscribers</a>.<span title="(key: org.reactivestreams.Subscriber[Any])Boolean">contains</span><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.registerSubscriber.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher.registerSubscriber.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="(x$1: Throwable)Unit">onError</span><span class="delimiter">(</span>new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;&quot;)">$</span><span class="delimiter">{</span><a href="#akka.stream.impl;FuturePublisher" title="()Class[_]">getClass</a>.<span title="()String">getSimpleName</span><span class="delimiter">}</span><span title="String(&quot; [&quot;)"> [$</span><a href="#akka.stream.impl;FuturePublisher" title="=&gt; akka.actor.ActorRef">self</a><span title="String(&quot;, sub: &quot;)">, sub: $</span><a href="#akka.stream.impl;FuturePublisher.registerSubscriber.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a><span title="String(&quot;] &quot;)">] $</span><span class="delimiter">{</span>ReactiveStreamsCompliance.<span title="String(&quot;can not subscribe the same subscriber multiple times (see reactive-streams specification, rules 1.10 and 2.12)&quot;)">CanNotSubscribeTheSameSubscriberMultipleTimes</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    else <span class="delimiter">{</span>
      val <a title="akka.stream.impl.FuturePublisher.FutureSubscription" id="akka.stream.impl;FuturePublisher.registerSubscriber.subscription">subscription</a> = new <a href="#akka.stream.impl.FuturePublisher;FutureSubscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">FutureSubscription</a><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher.subscribers_=" title="(x$1: scala.collection.immutable.Map[org.reactivestreams.Subscriber[Any],akka.stream.impl.FuturePublisher.FutureSubscription])Unit">subscribers</a> = <a href="#akka.stream.impl;FuturePublisher.subscribers_=" title="=&gt; scala.collection.immutable.Map[org.reactivestreams.Subscriber[Any],akka.stream.impl.FuturePublisher.FutureSubscription]">subscribers</a>.<span title="(key: org.reactivestreams.Subscriber[Any], value: akka.stream.impl.FuturePublisher.FutureSubscription)scala.collection.immutable.Map[org.reactivestreams.Subscriber[Any],akka.stream.impl.FuturePublisher.FutureSubscription]">updated</span><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.registerSubscriber.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a>, <a href="#akka.stream.impl;FuturePublisher.registerSubscriber.subscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</a><span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher.subscriptions_=" title="(x$1: scala.collection.immutable.Map[akka.stream.impl.FuturePublisher.FutureSubscription,org.reactivestreams.Subscriber[Any]])Unit">subscriptions</a> = <a href="#akka.stream.impl;FuturePublisher.subscriptions_=" title="=&gt; scala.collection.immutable.Map[akka.stream.impl.FuturePublisher.FutureSubscription,org.reactivestreams.Subscriber[Any]]">subscriptions</a>.<span title="(key: akka.stream.impl.FuturePublisher.FutureSubscription, value: org.reactivestreams.Subscriber[Any])scala.collection.immutable.Map[akka.stream.impl.FuturePublisher.FutureSubscription,org.reactivestreams.Subscriber[Any]]">updated</span><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.registerSubscriber.subscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</a>, <a href="#akka.stream.impl;FuturePublisher.registerSubscriber.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a><span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher.registerSubscriber.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="(x$1: org.reactivestreams.Subscription)Unit">onSubscribe</span><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.registerSubscriber.subscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(subscriber: org.reactivestreams.Subscriber[Any])Unit" id="akka.stream.impl;FuturePublisher.removeSubscriber">removeSubscriber</a><span class="delimiter">(</span><a title="org.reactivestreams.Subscriber[Any]" id="akka.stream.impl;FuturePublisher.removeSubscriber.subscriber">subscriber</a>: <span title="org.reactivestreams.Subscriber[Any]">Subscriber</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    val <a title="akka.stream.impl.FuturePublisher.FutureSubscription" id="akka.stream.impl;FuturePublisher.removeSubscriber.subscription">subscription</a> = <a href="#akka.stream.impl;FuturePublisher.subscribers_=" title="(key: org.reactivestreams.Subscriber[Any])akka.stream.impl.FuturePublisher.FutureSubscription">subscribers</a><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.removeSubscriber.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a><span class="delimiter">)</span>
    <a href="#akka.stream.impl;FuturePublisher.subscriptions_=" title="(x$1: scala.collection.immutable.Map[akka.stream.impl.FuturePublisher.FutureSubscription,org.reactivestreams.Subscriber[Any]])Unit">subscriptions</a> <span title="(key: akka.stream.impl.FuturePublisher.FutureSubscription)scala.collection.immutable.Map[akka.stream.impl.FuturePublisher.FutureSubscription,org.reactivestreams.Subscriber[Any]]">-=</span> <a href="#akka.stream.impl;FuturePublisher.removeSubscriber.subscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</a>
    <a href="#akka.stream.impl;FuturePublisher.subscriptionsReadyForPush_=" title="(x$1: scala.collection.immutable.Set[akka.stream.impl.FuturePublisher.FutureSubscription])Unit">subscriptionsReadyForPush</a> <span title="(elem: akka.stream.impl.FuturePublisher.FutureSubscription)scala.collection.immutable.Set[akka.stream.impl.FuturePublisher.FutureSubscription]">-=</span> <a href="#akka.stream.impl;FuturePublisher.removeSubscriber.subscription" title="akka.stream.impl.FuturePublisher.FutureSubscription">subscription</a>
    <a href="#akka.stream.impl;FuturePublisher.subscribers_=" title="(x$1: scala.collection.immutable.Map[org.reactivestreams.Subscriber[Any],akka.stream.impl.FuturePublisher.FutureSubscription])Unit">subscribers</a> <span title="(key: org.reactivestreams.Subscriber[Any])scala.collection.immutable.Map[org.reactivestreams.Subscriber[Any],akka.stream.impl.FuturePublisher.FutureSubscription]">-=</span> <a href="#akka.stream.impl;FuturePublisher.removeSubscriber.subscriber" title="org.reactivestreams.Subscriber[Any]">subscriber</a>
    if <span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.subscribers_=" title="=&gt; scala.collection.immutable.Map[org.reactivestreams.Subscriber[Any],akka.stream.impl.FuturePublisher.FutureSubscription]">subscribers</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.stream.impl;FuturePublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.shutdownReason_=" title="=&gt; Option[Throwable]">shutdownReason</a><span class="delimiter">)</span>
      <a href="ActorPublisher.scala.html#akka.stream.impl;SoftShutdown.softShutdown" title="()Unit">softShutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  override def <a title="()Unit" id="akka.stream.impl;FuturePublisher.postStop">postStop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    if <span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span>
      <a href="#akka.stream.impl;FuturePublisher.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><a href="#akka.stream.impl;FuturePublisher.shutdownReason_=" title="=&gt; Option[Throwable]">shutdownReason</a><span class="delimiter">)</span>

<span class="delimiter">}</span>


        </pre>
    </body>
</html>

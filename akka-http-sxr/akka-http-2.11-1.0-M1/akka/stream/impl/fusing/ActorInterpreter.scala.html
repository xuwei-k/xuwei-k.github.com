<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>akka/stream/impl/fusing/ActorInterpreter.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>
package akka.stream.impl.fusing

import java.util.Arrays
import akka.actor.<span class="delimiter">{</span> Actor, ActorRef <span class="delimiter">}</span>
import akka.event.Logging
import akka.stream.MaterializerSettings
import akka.stream.actor.<a href="../../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriber" title="akka.stream.actor.ActorSubscriber.type">ActorSubscriber</a>.OnSubscribe
import akka.stream.actor.<a href="../../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriberMessage" title="akka.stream.actor.ActorSubscriberMessage.type">ActorSubscriberMessage</a>.<span class="delimiter">{</span> OnNext, OnError, OnComplete <span class="delimiter">}</span>
import akka.stream.impl._
import akka.stream.stage._
import org.reactivestreams.<span class="delimiter">{</span> Subscriber, Subscription <span class="delimiter">}</span>
import scala.util.control.NonFatal
import akka.actor.Props

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> class <a title="class BatchingActorInputBoundary extends akka.stream.impl.fusing.BoundaryStage" id="akka.stream.impl.fusing;BatchingActorInputBoundary">BatchingActorInputBoundary</a><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary" title="akka.stream.impl.fusing.BatchingActorInputBoundary" class="delimiter">(</a>val <a title="Int" id="akka.stream.impl.fusing;BatchingActorInputBoundary.size">size</a>: <span title="Int">Int</span><span class="delimiter">)</span> extends <a href="Interpreter.scala.html#akka.stream.impl.fusing;BoundaryStage" title="akka.stream.impl.fusing.BoundaryStage">BoundaryStage</a> <span class="delimiter">{</span>
  <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.size" title="=&gt; Int">size</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span>, <span title="String(&quot;buffer size cannot be zero&quot;)" class="string">&quot;buffer size cannot be zero&quot;</span><span class="delimiter">)</span>
  <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.size" title="=&gt; Int">size</a> <span title="(x: Int)Int">&amp;</span> <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.size" title="=&gt; Int">size</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span>, <span title="String(&quot;buffer size must be a power of two&quot;)" class="string">&quot;buffer size must be a power of two&quot;</span><span class="delimiter">)</span>

  <span class="comment">// TODO: buffer and batch sizing heuristics</span>
  private var <a title="org.reactivestreams.Subscription" id="akka.stream.impl.fusing;BatchingActorInputBoundary.upstream_=">upstream</a>: <span title="org.reactivestreams.Subscription">Subscription</span> = _
  private val <a title="Array[AnyRef]" id="akka.stream.impl.fusing;BatchingActorInputBoundary.inputBuffer">inputBuffer</a> = <span title="Array.type">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassTag[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassTag[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.ClassTag[AnyRef]" class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.size" title="=&gt; Int">size</a><span class="delimiter">)</span>
  private var <a title="Int" id="akka.stream.impl.fusing;BatchingActorInputBoundary.inputBufferElements_=">inputBufferElements</a> = <span title="Int(0)" class="int">0</span>
  private var <a title="Int" id="akka.stream.impl.fusing;BatchingActorInputBoundary.nextInputElementCursor_=">nextInputElementCursor</a> = <span title="Int(0)" class="int">0</span>
  private var <a title="Boolean" id="akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamCompleted_=">upstreamCompleted</a> = false
  private var <a title="Boolean" id="akka.stream.impl.fusing;BatchingActorInputBoundary.downstreamWaiting_=">downstreamWaiting</a> = false
  private val IndexMask = <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.size" title="=&gt; Int">size</a> <a title="Int" id="akka.stream.impl.fusing;BatchingActorInputBoundary.IndexMask">-</a> <span title="Int(1)" class="int">1</span>

  private def <a title="=&gt; Int" id="akka.stream.impl.fusing;BatchingActorInputBoundary.requestBatchSize">requestBatchSize</a> = math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>, <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBuffer" title="=&gt; Array[AnyRef]">inputBuffer</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">/</span> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
  private var <a title="Int" id="akka.stream.impl.fusing;BatchingActorInputBoundary.batchRemaining_=">batchRemaining</a> = <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.requestBatchSize" title="=&gt; Int">requestBatchSize</a>

  val <a title="akka.stream.impl.SubReceive" id="akka.stream.impl.fusing;BatchingActorInputBoundary.subreceive">subreceive</a>: <a href="../Transfer.scala.html#akka.stream.impl;SubReceive" title="akka.stream.impl.SubReceive">SubReceive</a> = new <a href="../Transfer.scala.html#akka.stream.impl;SubReceive" title="akka.stream.impl.SubReceive">SubReceive</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.waitingForUpstream" title="=&gt; akka.actor.Actor.Receive">waitingForUpstream</a><span class="delimiter">)</span>

  private def <a title="()Any" id="akka.stream.impl.fusing;BatchingActorInputBoundary.dequeue">dequeue</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Any">Any</span> = <span class="delimiter">{</span>
    val <a title="AnyRef" id="akka.stream.impl.fusing;BatchingActorInputBoundary.dequeue.elem">elem</a> = <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBuffer" title="(i: Int)AnyRef">inputBuffer</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.nextInputElementCursor_=" title="=&gt; Int">nextInputElementCursor</a><span class="delimiter">)</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.dequeue.elem" title="AnyRef">elem</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBuffer" title="(i: Int, x: AnyRef)Unit">inputBuffer</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.nextInputElementCursor_=" title="=&gt; Int">nextInputElementCursor</a><span class="delimiter">)</span> = null

    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.batchRemaining_=" title="(x$1: Int)Unit">batchRemaining</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>
    if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.batchRemaining_=" title="=&gt; Int">batchRemaining</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamCompleted_=" title="=&gt; Boolean">upstreamCompleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstream_=" title="=&gt; org.reactivestreams.Subscription">upstream</a>.<span title="(x$1: Long)Unit">request</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.requestBatchSize" title="=&gt; Long">requestBatchSize</a><span class="delimiter">)</span>
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.batchRemaining_=" title="(x$1: Int)Unit">batchRemaining</a> = <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.requestBatchSize" title="=&gt; Int">requestBatchSize</a>
    <span class="delimiter">}</span>

    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBufferElements_=" title="(x$1: Int)Unit">inputBufferElements</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.nextInputElementCursor_=" title="(x$1: Int)Unit">nextInputElementCursor</a> = <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.nextInputElementCursor_=" title="=&gt; Int">nextInputElementCursor</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: Int)Int">&amp;</span> <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.IndexMask" title="=&gt; Int">IndexMask</a>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.dequeue.elem" title="AnyRef">elem</a>
  <span class="delimiter">}</span>

  private def <a title="(elem: Any)Unit" id="akka.stream.impl.fusing;BatchingActorInputBoundary.enqueue">enqueue</a><span class="delimiter">(</span><a title="Any" id="akka.stream.impl.fusing;BatchingActorInputBoundary.enqueue.elem">elem</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamCompleted_=" title="=&gt; Boolean">upstreamCompleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBufferElements_=" title="=&gt; Int">inputBufferElements</a> <span title="(x: Int)Boolean">==</span> <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.size" title="=&gt; Int">size</a><span class="delimiter">)</span> throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;Input buffer overrun&quot;)" class="string">&quot;Input buffer overrun&quot;</span><span class="delimiter">)</span>
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBuffer" title="(i: Int, x: AnyRef)Unit">inputBuffer</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.nextInputElementCursor_=" title="=&gt; Int">nextInputElementCursor</a> <span title="(x: Int)Int">+</span> <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBufferElements_=" title="=&gt; Int">inputBufferElements</a><span class="delimiter">)</span> <span title="(x: Int)Int">&amp;</span> <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.IndexMask" title="=&gt; Int">IndexMask</a><span class="delimiter">)</span> = <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.enqueue.elem" title="Any">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBufferElements_=" title="(x$1: Int)Unit">inputBufferElements</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  override def <a title="(elem: Any, ctx: akka.stream.stage.BoundaryContext)akka.stream.stage.Directive" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onPush">onPush</a><span class="delimiter">(</span><a title="Any" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onPush.elem">elem</a>: <span title="Any">Any</span>, <a title="akka.stream.stage.BoundaryContext" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onPush.ctx">ctx</a>: <a href="../../stage/Stage.scala.html#akka.stream.stage;BoundaryContext" title="akka.stream.stage.BoundaryContext">BoundaryContext</a><span class="delimiter">)</span>: <a href="../../stage/Stage.scala.html#akka.stream.stage;Directive" title="akka.stream.stage.Directive">Directive</a> =
    throw new <span title="UnsupportedOperationException">UnsupportedOperationException</span><span class="delimiter">(</span><span title="String(&quot;BUG: Cannot push the upstream boundary&quot;)" class="string">&quot;BUG: Cannot push the upstream boundary&quot;</span><span class="delimiter">)</span>

  override def <a title="(ctx: akka.stream.stage.BoundaryContext)akka.stream.stage.Directive" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onPull">onPull</a><span class="delimiter">(</span><a title="akka.stream.stage.BoundaryContext" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onPull.ctx">ctx</a>: <a href="../../stage/Stage.scala.html#akka.stream.stage;BoundaryContext" title="akka.stream.stage.BoundaryContext">BoundaryContext</a><span class="delimiter">)</span>: <a href="../../stage/Stage.scala.html#akka.stream.stage;Directive" title="akka.stream.stage.Directive">Directive</a> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBufferElements_=" title="=&gt; Int">inputBufferElements</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onPull.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.push" title="(elem: Any)akka.stream.stage.DownstreamDirective">push</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.dequeue" title="()Any">dequeue</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    else if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBufferElements_=" title="=&gt; Int">inputBufferElements</a> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamCompleted_=" title="=&gt; Boolean">upstreamCompleted</a><span class="delimiter">)</span> <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onPull.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.pushAndFinish" title="(elem: Any)akka.stream.stage.DownstreamDirective">pushAndFinish</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.dequeue" title="()Any">dequeue</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      else <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onPull.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.push" title="(elem: Any)akka.stream.stage.DownstreamDirective">push</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.dequeue" title="()Any">dequeue</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamCompleted_=" title="=&gt; Boolean">upstreamCompleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onPull.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.finish" title="()akka.stream.stage.FreeDirective">finish</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> else <span class="delimiter">{</span>
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.downstreamWaiting_=" title="(x$1: Boolean)Unit">downstreamWaiting</a> = true
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onPull.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;BoundaryContext.exit" title="()akka.stream.stage.FreeDirective">exit</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  override def <a title="(ctx: akka.stream.stage.BoundaryContext)akka.stream.stage.TerminationDirective" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onDownstreamFinish">onDownstreamFinish</a><span class="delimiter">(</span><a title="akka.stream.stage.BoundaryContext" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onDownstreamFinish.ctx">ctx</a>: <a href="../../stage/Stage.scala.html#akka.stream.stage;BoundaryContext" title="akka.stream.stage.BoundaryContext">BoundaryContext</a><span class="delimiter">)</span>: <a href="../../stage/Stage.scala.html#akka.stream.stage;TerminationDirective" title="akka.stream.stage.TerminationDirective">TerminationDirective</a> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.cancel" title="()Unit">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onDownstreamFinish.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;BoundaryContext.exit" title="()akka.stream.stage.FreeDirective">exit</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="()Unit" id="akka.stream.impl.fusing;BatchingActorInputBoundary.cancel">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamCompleted_=" title="=&gt; Boolean">upstreamCompleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamCompleted_=" title="(x$1: Boolean)Unit">upstreamCompleted</a> = true
      if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstream_=" title="=&gt; org.reactivestreams.Subscription">upstream</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstream_=" title="=&gt; org.reactivestreams.Subscription">upstream</a>.<span title="()Unit">cancel</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.downstreamWaiting_=" title="(x$1: Boolean)Unit">downstreamWaiting</a> = false
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.clear" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  private def <a title="()Unit" id="akka.stream.impl.fusing;BatchingActorInputBoundary.clear">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span title="java.util.Arrays.type">Arrays</span>.<span title="(x$1: Array[Object], x$2: Int, x$3: Int, x$4: Any)Unit">fill</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBuffer" title="=&gt; Array[AnyRef]">inputBuffer</a>, <span title="Int(0)" class="int">0</span>, <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBuffer" title="=&gt; Array[AnyRef]">inputBuffer</a>.<span title="=&gt; Int">length</span>, null<span class="delimiter">)</span>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBufferElements_=" title="(x$1: Int)Unit">inputBufferElements</a> = <span title="Int(0)" class="int">0</span>
  <span class="delimiter">}</span>

  private def <a title="()Unit" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onComplete">onComplete</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamCompleted_=" title="(x$1: Boolean)Unit">upstreamCompleted</a> = true
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a>.<a href="../Transfer.scala.html#akka.stream.impl;SubReceive.become" title="(newBehavior: akka.actor.Actor.Receive)Unit">become</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.completed" title="=&gt; akka.actor.Actor.Receive">completed</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBufferElements_=" title="=&gt; Int">inputBufferElements</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="Interpreter.scala.html#akka.stream.impl.fusing;BoundaryStage.enter" title="()akka.stream.stage.BoundaryContext">enter</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.finish" title="()akka.stream.stage.FreeDirective">finish</a><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="(subscription: org.reactivestreams.Subscription)Unit" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onSubscribe">onSubscribe</a><span class="delimiter">(</span><a title="org.reactivestreams.Subscription" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onSubscribe.subscription">subscription</a>: <span title="org.reactivestreams.Subscription">Subscription</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onSubscribe.subscription" title="org.reactivestreams.Subscription">subscription</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstream_=" title="(x$1: org.reactivestreams.Subscription)Unit">upstream</a> = <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onSubscribe.subscription" title="org.reactivestreams.Subscription">subscription</a>
    <span class="comment">// Prefetch</span>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstream_=" title="=&gt; org.reactivestreams.Subscription">upstream</a>.<span title="(x$1: Long)Unit">request</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.inputBuffer" title="=&gt; Array[AnyRef]">inputBuffer</a>.<span title="=&gt; Long">length</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a>.<a href="../Transfer.scala.html#akka.stream.impl;SubReceive.become" title="(newBehavior: akka.actor.Actor.Receive)Unit">become</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamRunning" title="=&gt; akka.actor.Actor.Receive">upstreamRunning</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="(e: Throwable)Unit" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onError">onError</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl.fusing;BatchingActorInputBoundary.onError.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamCompleted_=" title="(x$1: Boolean)Unit">upstreamCompleted</a> = true
    <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a>.<a href="../Transfer.scala.html#akka.stream.impl;SubReceive.become" title="(newBehavior: akka.actor.Actor.Receive)Unit">become</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.completed" title="=&gt; akka.actor.Actor.Receive">completed</a><span class="delimiter">)</span>
    <a href="Interpreter.scala.html#akka.stream.impl.fusing;BoundaryStage.enter" title="()akka.stream.stage.BoundaryContext">enter</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.fail" title="(cause: Throwable)akka.stream.stage.FreeDirective">fail</a><span title="Unit" class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onError.e" title="Throwable">e</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="=&gt; akka.actor.Actor.Receive" id="akka.stream.impl.fusing;BatchingActorInputBoundary.waitingForUpstream">waitingForUpstream</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl.fusing;BatchingActorInputBoundary.waitingForUpstream;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case <a href="../../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriberMessage.OnComplete" title="akka.stream.actor.ActorSubscriberMessage.OnComplete.type">OnComplete</a>                ⇒ <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onComplete" title="()Unit">onComplete</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span>
    case OnSubscribe<span class="delimiter">(</span><a title="org.reactivestreams.Subscription" id="akka.stream.impl.fusing;BatchingActorInputBoundary.waitingForUpstream;$anonfun.isDefinedAt.subscription">subscription</a><span class="delimiter">)</span> ⇒ <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onSubscribe" title="(subscription: org.reactivestreams.Subscription)Unit">onSubscribe</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.waitingForUpstream;$anonfun.isDefinedAt.subscription" title="org.reactivestreams.Subscription">subscription</a><span class="delimiter">)</span>
    case OnError<span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl.fusing;BatchingActorInputBoundary.waitingForUpstream;$anonfun.isDefinedAt.cause">cause</a><span class="delimiter">)</span>            ⇒ <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onError" title="(e: Throwable)Unit">onError</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.waitingForUpstream;$anonfun.isDefinedAt.cause" title="Throwable">cause</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="=&gt; akka.actor.Actor.Receive" id="akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamRunning">upstreamRunning</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamRunning;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case OnNext<span class="delimiter">(</span><a title="Any" id="akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamRunning;$anonfun.isDefinedAt.element">element</a><span class="delimiter">)</span> ⇒
      <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.enqueue" title="(elem: Any)Unit">enqueue</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamRunning;$anonfun.isDefinedAt.element" title="Any">element</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.downstreamWaiting_=" title="=&gt; Boolean">downstreamWaiting</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.downstreamWaiting_=" title="(x$1: Boolean)Unit">downstreamWaiting</a> = false
        <a href="Interpreter.scala.html#akka.stream.impl.fusing;BoundaryStage.enter" title="()akka.stream.stage.BoundaryContext">enter</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.push" title="(elem: Any)akka.stream.stage.DownstreamDirective">push</a><span title="Unit" class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.dequeue" title="()Any">dequeue</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    case <a href="../../actor/ActorSubscriber.scala.html#akka.stream.actor.ActorSubscriberMessage.OnComplete" title="akka.stream.actor.ActorSubscriberMessage.OnComplete.type">OnComplete</a>                ⇒ <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onComplete" title="()Unit">onComplete</a><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span>
    case OnError<span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamRunning;$anonfun.isDefinedAt.cause">cause</a><span class="delimiter">)</span>            ⇒ <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.onError" title="(e: Throwable)Unit">onError</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamRunning;$anonfun.isDefinedAt.cause" title="Throwable">cause</a><span class="delimiter">)</span>
    case OnSubscribe<span class="delimiter">(</span><a title="org.reactivestreams.Subscription" id="akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamRunning;$anonfun.isDefinedAt.subscription">subscription</a><span class="delimiter">)</span> ⇒ <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.upstreamRunning;$anonfun.isDefinedAt.subscription" title="org.reactivestreams.Subscription">subscription</a>.<span title="()Unit">cancel</span><span title="Boolean(true)" class="delimiter">(</span><span class="delimiter">)</span> <span class="comment">// spec rule 2.5</span>
  <span class="delimiter">}</span>

  private def <a title="=&gt; akka.actor.Actor.Receive" id="akka.stream.impl.fusing;BatchingActorInputBoundary.completed">completed</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl.fusing;BatchingActorInputBoundary.completed;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case OnSubscribe<span class="delimiter">(</span><a title="org.reactivestreams.Subscription" id="akka.stream.impl.fusing;BatchingActorInputBoundary.completed;$anonfun.isDefinedAt.subscription">subscription</a><span class="delimiter">)</span> ⇒ throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;Cannot subscribe shutdown subscriber&quot;)" class="string">&quot;Cannot subscribe shutdown subscriber&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> class <a title="class ActorOutputBoundary extends akka.stream.impl.fusing.BoundaryStage" id="akka.stream.impl.fusing;ActorOutputBoundary">ActorOutputBoundary</a><a href="#akka.stream.impl.fusing;ActorOutputBoundary" title="akka.stream.impl.fusing.ActorOutputBoundary" class="delimiter">(</a>val <a title="akka.actor.ActorRef" id="akka.stream.impl.fusing;ActorOutputBoundary.actor">actor</a>: <span title="akka.actor.ActorRef">ActorRef</span><span class="delimiter">)</span> extends <a href="Interpreter.scala.html#akka.stream.impl.fusing;BoundaryStage" title="akka.stream.impl.fusing.BoundaryStage">BoundaryStage</a> <span class="delimiter">{</span>

  private var <a title="akka.stream.impl.ActorPublisher[Any]" id="akka.stream.impl.fusing;ActorOutputBoundary.exposedPublisher_=">exposedPublisher</a>: <a href="../ActorPublisher.scala.html#akka.stream.impl;ActorPublisher" title="akka.stream.impl.ActorPublisher[Any]">ActorPublisher</a><span class="delimiter">[</span>Any<span class="delimiter">]</span> = _

  private var <a title="org.reactivestreams.Subscriber[Any]" id="akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=">subscriber</a>: <span title="org.reactivestreams.Subscriber[Any]">Subscriber</span><span class="delimiter">[</span>Any<span class="delimiter">]</span> = _
  private var <a title="Long" id="akka.stream.impl.fusing;ActorOutputBoundary.downstreamDemand_=">downstreamDemand</a>: <span title="Long">Long</span> = <span title="Long(0L)" class="long">0L</span>
  <span class="comment">// This flag is only used if complete/fail is called externally since this op turns into a Finished one inside the</span>
  <span class="comment">// interpreter (i.e. inside this op this flag has no effects since if it is completed the op will not be invoked)</span>
  private var <a title="Boolean" id="akka.stream.impl.fusing;ActorOutputBoundary.downstreamCompleted_=">downstreamCompleted</a> = false
  private var <a title="Boolean" id="akka.stream.impl.fusing;ActorOutputBoundary.upstreamWaiting_=">upstreamWaiting</a> = true

  val <a title="akka.stream.impl.SubReceive" id="akka.stream.impl.fusing;ActorOutputBoundary.subreceive">subreceive</a> = new <a href="../Transfer.scala.html#akka.stream.impl;SubReceive" title="akka.stream.impl.SubReceive">SubReceive</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.waitingExposedPublisher" title="=&gt; akka.actor.Actor.Receive">waitingExposedPublisher</a><span class="delimiter">)</span>

  private def <a title="(elem: Any)Unit" id="akka.stream.impl.fusing;ActorOutputBoundary.onNext">onNext</a><span class="delimiter">(</span><a title="Any" id="akka.stream.impl.fusing;ActorOutputBoundary.onNext.elem">elem</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamDemand_=" title="(x$1: Long)Unit">downstreamDemand</a> <span title="(x: Int)Long">-=</span> <span title="Int(1)" class="int">1</span>
    <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="(x$1: Any)Unit">onNext</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.onNext.elem" title="Any">elem</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="()Unit" id="akka.stream.impl.fusing;ActorOutputBoundary.complete">complete</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamCompleted_=" title="=&gt; Boolean">downstreamCompleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamCompleted_=" title="(x$1: Boolean)Unit">downstreamCompleted</a> = true
      if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="()Unit">onComplete</span><span class="delimiter">(</span><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl.fusing;ActorOutputBoundary.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="../ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><span title="None.type">None</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(e: Throwable)Unit" id="akka.stream.impl.fusing;ActorOutputBoundary.fail">fail</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl.fusing;ActorOutputBoundary.fail.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamCompleted_=" title="=&gt; Boolean">downstreamCompleted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamCompleted_=" title="(x$1: Boolean)Unit">downstreamCompleted</a> = true
      if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="(x$1: Throwable)Unit">onError</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.fail.e" title="Throwable">e</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a> <span title="(x$1: AnyRef)Boolean">ne</span> null<span class="delimiter">)</span> <a href="#akka.stream.impl.fusing;ActorOutputBoundary.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="../ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><span title="(x: Throwable)Some[Throwable]">Some</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.fail.e" title="Throwable">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  override def <a title="(elem: Any, ctx: akka.stream.stage.BoundaryContext)akka.stream.stage.Directive" id="akka.stream.impl.fusing;ActorOutputBoundary.onPush">onPush</a><span class="delimiter">(</span><a title="Any" id="akka.stream.impl.fusing;ActorOutputBoundary.onPush.elem">elem</a>: <span title="Any">Any</span>, <a title="akka.stream.stage.BoundaryContext" id="akka.stream.impl.fusing;ActorOutputBoundary.onPush.ctx">ctx</a>: <a href="../../stage/Stage.scala.html#akka.stream.stage;BoundaryContext" title="akka.stream.stage.BoundaryContext">BoundaryContext</a><span class="delimiter">)</span>: <a href="../../stage/Stage.scala.html#akka.stream.stage;Directive" title="akka.stream.stage.Directive">Directive</a> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl.fusing;ActorOutputBoundary.onNext" title="(elem: Any)Unit">onNext</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.onPush.elem" title="Any">elem</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamDemand_=" title="=&gt; Long">downstreamDemand</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#akka.stream.impl.fusing;ActorOutputBoundary.onPush.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.pull" title="()akka.stream.stage.UpstreamDirective">pull</a><span class="delimiter">(</span><span class="delimiter">)</span>
    else if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamCompleted_=" title="=&gt; Boolean">downstreamCompleted</a><span class="delimiter">)</span> <a href="#akka.stream.impl.fusing;ActorOutputBoundary.onPush.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.finish" title="()akka.stream.stage.FreeDirective">finish</a><span class="delimiter">(</span><span class="delimiter">)</span>
    else <span class="delimiter">{</span>
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.upstreamWaiting_=" title="(x$1: Boolean)Unit">upstreamWaiting</a> = true
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.onPush.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;BoundaryContext.exit" title="()akka.stream.stage.FreeDirective">exit</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  override def <a title="(ctx: akka.stream.stage.BoundaryContext)akka.stream.stage.Directive" id="akka.stream.impl.fusing;ActorOutputBoundary.onPull">onPull</a><span class="delimiter">(</span><a title="akka.stream.stage.BoundaryContext" id="akka.stream.impl.fusing;ActorOutputBoundary.onPull.ctx">ctx</a>: <a href="../../stage/Stage.scala.html#akka.stream.stage;BoundaryContext" title="akka.stream.stage.BoundaryContext">BoundaryContext</a><span class="delimiter">)</span>: <a href="../../stage/Stage.scala.html#akka.stream.stage;Directive" title="akka.stream.stage.Directive">Directive</a> =
    throw new <span title="UnsupportedOperationException">UnsupportedOperationException</span><span class="delimiter">(</span><span title="String(&quot;BUG: Cannot pull the downstream boundary&quot;)" class="string">&quot;BUG: Cannot pull the downstream boundary&quot;</span><span class="delimiter">)</span>

  override def <a title="(ctx: akka.stream.stage.BoundaryContext)akka.stream.stage.TerminationDirective" id="akka.stream.impl.fusing;ActorOutputBoundary.onUpstreamFinish">onUpstreamFinish</a><span class="delimiter">(</span><a title="akka.stream.stage.BoundaryContext" id="akka.stream.impl.fusing;ActorOutputBoundary.onUpstreamFinish.ctx">ctx</a>: <a href="../../stage/Stage.scala.html#akka.stream.stage;BoundaryContext" title="akka.stream.stage.BoundaryContext">BoundaryContext</a><span class="delimiter">)</span>: <a href="../../stage/Stage.scala.html#akka.stream.stage;TerminationDirective" title="akka.stream.stage.TerminationDirective">TerminationDirective</a> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl.fusing;ActorOutputBoundary.complete" title="()Unit">complete</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl.fusing;ActorOutputBoundary.onUpstreamFinish.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.finish" title="()akka.stream.stage.FreeDirective">finish</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="(cause: Throwable, ctx: akka.stream.stage.BoundaryContext)akka.stream.stage.TerminationDirective" id="akka.stream.impl.fusing;ActorOutputBoundary.onUpstreamFailure">onUpstreamFailure</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl.fusing;ActorOutputBoundary.onUpstreamFailure.cause">cause</a>: <span title="Throwable">Throwable</span>, <a title="akka.stream.stage.BoundaryContext" id="akka.stream.impl.fusing;ActorOutputBoundary.onUpstreamFailure.ctx">ctx</a>: <a href="../../stage/Stage.scala.html#akka.stream.stage;BoundaryContext" title="akka.stream.stage.BoundaryContext">BoundaryContext</a><span class="delimiter">)</span>: <a href="../../stage/Stage.scala.html#akka.stream.stage;TerminationDirective" title="akka.stream.stage.TerminationDirective">TerminationDirective</a> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl.fusing;ActorOutputBoundary.fail" title="(e: Throwable)Unit">fail</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.onUpstreamFailure.cause" title="Throwable">cause</a><span class="delimiter">)</span>
    <a href="#akka.stream.impl.fusing;ActorOutputBoundary.onUpstreamFailure.ctx" title="akka.stream.stage.BoundaryContext">ctx</a>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.fail" title="(cause: Throwable)akka.stream.stage.FreeDirective">fail</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.onUpstreamFailure.cause" title="Throwable">cause</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="(subscribers: Seq[org.reactivestreams.Subscriber[Any]])Unit" id="akka.stream.impl.fusing;ActorOutputBoundary.subscribePending">subscribePending</a><span class="delimiter">(</span><a title="Seq[org.reactivestreams.Subscriber[Any]]" id="akka.stream.impl.fusing;ActorOutputBoundary.subscribePending.subscribers">subscribers</a>: <span title="Seq[org.reactivestreams.Subscriber[Any]]">Seq</span><span class="delimiter">[</span>Subscriber<span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
    <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscribePending.subscribers" title="Seq[org.reactivestreams.Subscriber[Any]]">subscribers</a> <span title="(f: org.reactivestreams.Subscriber[Any] =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="org.reactivestreams.Subscriber[Any]" id="akka.stream.impl.fusing;ActorOutputBoundary.subscribePending.$anonfun.sub">sub</a> ⇒
      if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a> <span title="(x$1: AnyRef)Boolean">eq</span> null<span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=" title="(x$1: org.reactivestreams.Subscriber[Any])Unit">subscriber</a> = <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscribePending.$anonfun.sub" title="org.reactivestreams.Subscriber[Any]">sub</a>
        <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a>.<span title="(x$1: org.reactivestreams.Subscription)Unit">onSubscribe</span><span class="delimiter">(</span>new <a href="../ActorPublisher.scala.html#akka.stream.impl;ActorSubscription" title="akka.stream.impl.ActorSubscription[Any]">ActorSubscription</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.actor" title="=&gt; akka.actor.ActorRef">actor</a>, <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=" title="=&gt; org.reactivestreams.Subscriber[Any]">subscriber</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> else <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscribePending.$anonfun.sub" title="org.reactivestreams.Subscriber[Any]">sub</a>.<span title="(x$1: Throwable)Unit">onError</span><span class="delimiter">(</span>new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;&quot;)">$</span><span class="delimiter">{</span><span title="akka.event.Logging.type">Logging</span>.<span title="(obj: AnyRef)String">simpleName</span><span class="delimiter">(</span>this<span class="delimiter">)</span><span class="delimiter">}</span><span title="String(&quot; &quot;)"> $</span><span class="delimiter">{</span>ReactiveStreamsCompliance.<span title="String(&quot;only supports one subscriber (which is allowed, see reactive-streams specification, rule 1.12)&quot;)">SupportsOnlyASingleSubscriber</span><span class="delimiter">}</span><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  protected def <a title="=&gt; akka.actor.Actor.Receive" id="akka.stream.impl.fusing;ActorOutputBoundary.waitingExposedPublisher">waitingExposedPublisher</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl.fusing;ActorOutputBoundary.waitingExposedPublisher;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case ExposedPublisher<span class="delimiter">(</span><a title="akka.stream.impl.ActorPublisher[Any]" id="akka.stream.impl.fusing;ActorOutputBoundary.waitingExposedPublisher;$anonfun.isDefinedAt.publisher">publisher</a><span class="delimiter">)</span> ⇒
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.exposedPublisher_=" title="(x$1: akka.stream.impl.ActorPublisher[Any])Unit">exposedPublisher</a> = <a href="#akka.stream.impl.fusing;ActorOutputBoundary.waitingExposedPublisher;$anonfun.isDefinedAt.publisher" title="akka.stream.impl.ActorPublisher[Any]">publisher</a>
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a>.<a href="../Transfer.scala.html#akka.stream.impl;SubReceive.become" title="(newBehavior: akka.actor.Actor.Receive)Unit">become</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamRunning" title="=&gt; akka.actor.Actor.Receive">downstreamRunning</a><span class="delimiter">)</span>
    case <a title="Any" id="akka.stream.impl.fusing;ActorOutputBoundary.waitingExposedPublisher;$anonfun.isDefinedAt.other">other</a> ⇒
      throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;The first message must be ExposedPublisher but was [&quot;)">The first message must be ExposedPublisher but was [$</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.waitingExposedPublisher;$anonfun.isDefinedAt.other" title="Any">other</a><span title="String(&quot;]&quot;)" class="string">]&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  protected def <a title="=&gt; akka.actor.Actor.Receive" id="akka.stream.impl.fusing;ActorOutputBoundary.downstreamRunning">downstreamRunning</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span> = <a title="&lt;$anon: Any =&gt; Unit&gt; extends scala.runtime.AbstractPartialFunction[Any,Unit] with Serializable" id="akka.stream.impl.fusing;ActorOutputBoundary.downstreamRunning;$anonfun.isDefinedAt.defaultCase$" class="delimiter">{</a>
    case <a href="../Messages.scala.html#akka.stream.impl.SubscribePending" title="akka.stream.impl.SubscribePending.type">SubscribePending</a> ⇒
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscribePending" title="(subscribers: Seq[org.reactivestreams.Subscriber[Any]])Unit">subscribePending</a><span title="Boolean(true)" class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="../ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.takePendingSubscribers" title="()scala.collection.immutable.Seq[org.reactivestreams.Subscriber[_ &gt;: Any]]">takePendingSubscribers</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    case RequestMore<span class="delimiter">(</span><span title="akka.stream.impl.ActorSubscription[_]">subscription</span>, <a title="Long" id="akka.stream.impl.fusing;ActorOutputBoundary.downstreamRunning;$anonfun.isDefinedAt.elements">elements</a><span class="delimiter">)</span> ⇒

      <span class="comment">// TODO centralize overflow protection</span>
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamDemand_=" title="(x$1: Long)Unit">downstreamDemand</a> <span title="(x: Long)Long">+=</span> <a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamRunning;$anonfun.isDefinedAt.elements" title="Long">elements</a>
      if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamDemand_=" title="=&gt; Long">downstreamDemand</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// Long has overflown</span>
        val <a title="IllegalStateException" id="akka.stream.impl.fusing;ActorOutputBoundary.downstreamRunning;$anonfun.applyOrElse.demandOverflowException">demandOverflowException</a> = new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span>ReactiveStreamsCompliance.<span title="String(&quot;Total pending demand MUST NOT be &gt; `java.lang.Long.MAX_VALUE` (see reactive-streams specification, rule 3.17)&quot;)">TotalPendingDemandMustNotExceedLongMaxValue</span><span class="delimiter">)</span>
        <a href="Interpreter.scala.html#akka.stream.impl.fusing;BoundaryStage.enter" title="()akka.stream.stage.BoundaryContext">enter</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.finish" title="()akka.stream.stage.FreeDirective">finish</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#akka.stream.impl.fusing;ActorOutputBoundary.fail" title="(e: Throwable)Unit">fail</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamRunning;$anonfun.applyOrElse.demandOverflowException" title="IllegalStateException">demandOverflowException</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> else if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorOutputBoundary.upstreamWaiting_=" title="=&gt; Boolean">upstreamWaiting</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#akka.stream.impl.fusing;ActorOutputBoundary.upstreamWaiting_=" title="(x$1: Boolean)Unit">upstreamWaiting</a> = false
        <a href="Interpreter.scala.html#akka.stream.impl.fusing;BoundaryStage.enter" title="()akka.stream.stage.BoundaryContext">enter</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.pull" title="()akka.stream.stage.UpstreamDirective">pull</a><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    case Cancel<span class="delimiter">(</span><span title="akka.stream.impl.ActorSubscription[_]">subscription</span><span class="delimiter">)</span> ⇒
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.downstreamCompleted_=" title="(x$1: Boolean)Unit">downstreamCompleted</a> = true
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.subscriber_=" title="(x$1: org.reactivestreams.Subscriber[Any])Unit">subscriber</a> = null
      <a href="#akka.stream.impl.fusing;ActorOutputBoundary.exposedPublisher_=" title="=&gt; akka.stream.impl.ActorPublisher[Any]">exposedPublisher</a>.<a href="../ActorPublisher.scala.html#akka.stream.impl;ActorPublisher.shutdown" title="(reason: Option[Throwable])Unit">shutdown</a><span class="delimiter">(</span><span title="(x: akka.stream.impl.ActorPublisher.NormalShutdownException)Some[akka.stream.impl.ActorPublisher.NormalShutdownException]">Some</span><span class="delimiter">(</span>new <a href="../ActorPublisher.scala.html#akka.stream.impl.ActorPublisher" title="akka.stream.impl.ActorPublisher.type">ActorPublisher</a>.<a href="../ActorPublisher.scala.html#akka.stream.impl.ActorPublisher;NormalShutdownException" title="akka.stream.impl.ActorPublisher.NormalShutdownException">NormalShutdownException</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="Interpreter.scala.html#akka.stream.impl.fusing;BoundaryStage.enter" title="()akka.stream.stage.BoundaryContext">enter</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="../../stage/Stage.scala.html#akka.stream.stage;Context.finish" title="()akka.stream.stage.FreeDirective">finish</a><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> object <a title="akka.stream.impl.fusing.ActorInterpreter.type" id="akka.stream.impl.fusing.ActorInterpreter">ActorInterpreter</a> <a href="#akka.stream.impl.fusing.ActorInterpreter" title="akka.stream.impl.fusing.ActorInterpreter.type" class="delimiter">{</a>
  def <a title="(settings: akka.stream.MaterializerSettings, ops: Seq[akka.stream.stage.Stage[_, _]])akka.actor.Props" id="akka.stream.impl.fusing.ActorInterpreter.props">props</a><span class="delimiter">(</span><a title="akka.stream.MaterializerSettings" id="akka.stream.impl.fusing.ActorInterpreter.props.settings">settings</a>: <a href="../../FlowMaterializer.scala.html#akka.stream;MaterializerSettings" title="akka.stream.MaterializerSettings">MaterializerSettings</a>, <a title="Seq[akka.stream.stage.Stage[_, _]]" id="akka.stream.impl.fusing.ActorInterpreter.props.ops">ops</a>: <span title="Seq[akka.stream.stage.Stage[_, _]]">Seq</span><span class="delimiter">[</span>Stage<span class="delimiter">[</span>_, _<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <span title="akka.actor.Props">Props</span> =
    <span title="(creator: =&gt; akka.stream.impl.fusing.ActorInterpreter)(implicit evidence$2: scala.reflect.ClassTag[akka.stream.impl.fusing.ActorInterpreter])akka.actor.Props">Props</span><span title="(runtimeClass1: Class[_])scala.reflect.ClassTag[akka.stream.impl.fusing.ActorInterpreter]" class="delimiter">(</span>new <a href="#akka.stream.impl.fusing;ActorInterpreter" title="akka.stream.impl.fusing.ActorInterpreter">ActorInterpreter</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing.ActorInterpreter.props.settings" title="akka.stream.MaterializerSettings">settings</a>, <a href="#akka.stream.impl.fusing.ActorInterpreter.props.ops" title="Seq[akka.stream.stage.Stage[_, _]]">ops</a><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * INTERNAL API
 */</span>
private<span class="delimiter">[</span>akka<span class="delimiter">]</span> class <a title="class ActorInterpreter extends AnyRef with akka.actor.Actor" id="akka.stream.impl.fusing;ActorInterpreter">ActorInterpreter</a><a href="#akka.stream.impl.fusing;ActorInterpreter" title="akka.stream.impl.fusing.ActorInterpreter" class="delimiter">(</a>val <a title="akka.stream.MaterializerSettings" id="akka.stream.impl.fusing;ActorInterpreter.settings">settings</a>: <a href="../../FlowMaterializer.scala.html#akka.stream;MaterializerSettings" title="akka.stream.MaterializerSettings">MaterializerSettings</a>, val <a title="Seq[akka.stream.stage.Stage[_, _]]" id="akka.stream.impl.fusing;ActorInterpreter.ops">ops</a>: <span title="Seq[akka.stream.stage.Stage[_, _]]">Seq</span><span class="delimiter">[</span>Stage<span class="delimiter">[</span>_, _<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
  extends <a href="#akka.stream.impl.fusing;ActorInterpreter" title="akka.actor.Actor">Actor</a> <span class="delimiter">{</span>

  private val <a title="akka.stream.impl.fusing.BatchingActorInputBoundary" id="akka.stream.impl.fusing;ActorInterpreter.upstream">upstream</a> = new <a href="#akka.stream.impl.fusing;BatchingActorInputBoundary" title="akka.stream.impl.fusing.BatchingActorInputBoundary">BatchingActorInputBoundary</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorInterpreter.settings" title="=&gt; akka.stream.MaterializerSettings">settings</a>.<a href="../../FlowMaterializer.scala.html#akka.stream;MaterializerSettings.initialInputBufferSize" title="=&gt; Int">initialInputBufferSize</a><span class="delimiter">)</span>
  private val <a title="akka.stream.impl.fusing.ActorOutputBoundary" id="akka.stream.impl.fusing;ActorInterpreter.downstream">downstream</a> = new <a href="#akka.stream.impl.fusing;ActorOutputBoundary" title="akka.stream.impl.fusing.ActorOutputBoundary">ActorOutputBoundary</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorInterpreter" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
  private val <a title="akka.stream.impl.fusing.OneBoundedInterpreter" id="akka.stream.impl.fusing;ActorInterpreter.interpreter">interpreter</a> = new <a href="Interpreter.scala.html#akka.stream.impl.fusing;OneBoundedInterpreter" title="akka.stream.impl.fusing.OneBoundedInterpreter">OneBoundedInterpreter</a><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorInterpreter.upstream" title="=&gt; akka.stream.impl.fusing.BatchingActorInputBoundary">upstream</a> <a href="#akka.stream.impl.fusing;ActorInterpreter.interpreter.x$1" title="(elem: akka.stream.stage.Stage[_, _])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[akka.stream.stage.Stage[_, _]],akka.stream.stage.Stage[_, _],Seq[akka.stream.stage.Stage[_, _]]])Seq[akka.stream.stage.Stage[_, _]]">+:</a> <a href="#akka.stream.impl.fusing;ActorInterpreter.ops" title="=&gt; Seq[akka.stream.stage.Stage[_, _]]">ops</a> <span title="(elem: akka.stream.stage.Stage[_, _])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[akka.stream.stage.Stage[_, _]],akka.stream.stage.Stage[_, _],Seq[akka.stream.stage.Stage[_, _]]])Seq[akka.stream.stage.Stage[_, _]]">:+</span> <a href="#akka.stream.impl.fusing;ActorInterpreter.downstream" title="=&gt; akka.stream.impl.fusing.ActorOutputBoundary">downstream</a><span class="delimiter">)</span>
  <a href="#akka.stream.impl.fusing;ActorInterpreter.interpreter" title="=&gt; akka.stream.impl.fusing.OneBoundedInterpreter">interpreter</a>.<a href="Interpreter.scala.html#akka.stream.impl.fusing;OneBoundedInterpreter.init" title="()Unit">init</a><span class="delimiter">(</span><span class="delimiter">)</span>

  def <a title="=&gt; ActorInterpreter.this.Receive" id="akka.stream.impl.fusing;ActorInterpreter.receive">receive</a>: <span title="ActorInterpreter.this.Receive">Receive</span> = <a href="#akka.stream.impl.fusing;ActorInterpreter.upstream" title="=&gt; akka.stream.impl.fusing.BatchingActorInputBoundary">upstream</a>.<a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a> <span title="(that: PartialFunction[Any,Unit])PartialFunction[Any,Unit]">orElse</span> <a href="#akka.stream.impl.fusing;ActorInterpreter.downstream" title="=&gt; akka.stream.impl.fusing.ActorOutputBoundary">downstream</a>.<a href="#akka.stream.impl.fusing;ActorOutputBoundary.subreceive" title="=&gt; akka.stream.impl.SubReceive">subreceive</a>

  override protected<span class="delimiter">[</span>akka<span class="delimiter">]</span> def <a title="(receive: akka.actor.Actor.Receive, msg: Any)Unit" id="akka.stream.impl.fusing;ActorInterpreter.aroundReceive">aroundReceive</a><span class="delimiter">(</span><a title="akka.actor.Actor.Receive" id="akka.stream.impl.fusing;ActorInterpreter.aroundReceive.receive">receive</a>: Actor.<span title="akka.actor.Actor.Receive">Receive</span>, <a title="Any" id="akka.stream.impl.fusing;ActorInterpreter.aroundReceive.msg">msg</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    super.<span title="(receive: akka.actor.Actor.Receive, msg: Any)Unit">aroundReceive</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorInterpreter.aroundReceive.receive" title="akka.actor.Actor.Receive">receive</a>, <a href="#akka.stream.impl.fusing;ActorInterpreter.aroundReceive.msg" title="Any">msg</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorInterpreter.interpreter" title="=&gt; akka.stream.impl.fusing.OneBoundedInterpreter">interpreter</a>.<a href="Interpreter.scala.html#akka.stream.impl.fusing;OneBoundedInterpreter.isFinished" title="=&gt; Boolean">isFinished</a><span class="delimiter">)</span> <a href="#akka.stream.impl.fusing;ActorInterpreter" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(actor: akka.actor.ActorRef)Unit">stop</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorInterpreter" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="()Unit" id="akka.stream.impl.fusing;ActorInterpreter.postStop">postStop</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.impl.fusing;ActorInterpreter.upstream" title="=&gt; akka.stream.impl.fusing.BatchingActorInputBoundary">upstream</a>.<a href="#akka.stream.impl.fusing;BatchingActorInputBoundary.cancel" title="()Unit">cancel</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.stream.impl.fusing;ActorInterpreter.downstream" title="=&gt; akka.stream.impl.fusing.ActorOutputBoundary">downstream</a>.<a href="#akka.stream.impl.fusing;ActorOutputBoundary.fail" title="(e: Throwable)Unit">fail</a><span class="delimiter">(</span>new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;Processor actor terminated abruptly&quot;)" class="string">&quot;Processor actor terminated abruptly&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="(reason: Throwable)Unit" id="akka.stream.impl.fusing;ActorInterpreter.postRestart">postRestart</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.impl.fusing;ActorInterpreter.postRestart.reason">reason</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    super.<span title="(reason: Throwable)Unit">postRestart</span><span class="delimiter">(</span><a href="#akka.stream.impl.fusing;ActorInterpreter.postRestart.reason" title="Throwable">reason</a><span class="delimiter">)</span>
    throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="String(&quot;This actor cannot be restarted&quot;)" class="string">&quot;This actor cannot be restarted&quot;</span>, <a href="#akka.stream.impl.fusing;ActorInterpreter.postRestart.reason" title="Throwable">reason</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>

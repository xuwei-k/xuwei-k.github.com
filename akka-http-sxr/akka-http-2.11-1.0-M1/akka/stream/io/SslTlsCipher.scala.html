<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>akka/stream/io/SslTlsCipher.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (C) 2009-2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>

package akka.stream.io

import java.nio.ByteBuffer
import java.security.Principal
import java.security.cert.Certificate
import javax.net.ssl.<span title="javax.net.ssl.SSLEngineResult.type">SSLEngineResult</span>.<span title="javax.net.ssl.SSLEngineResult.HandshakeStatus.type">HandshakeStatus</span>._
import javax.net.ssl.<span title="javax.net.ssl.SSLEngineResult.type">SSLEngineResult</span>.<span title="javax.net.ssl.SSLEngineResult.Status.type">Status</span>._
import javax.net.ssl.SSLEngine
import javax.net.ssl.SSLEngineResult
import javax.net.ssl.SSLPeerUnverifiedException
import javax.net.ssl.SSLSession

import akka.actor.Actor
import akka.actor.ActorLogging
import akka.actor.ActorRef
import akka.stream.MaterializerSettings
import akka.stream.impl._
import akka.util.ByteString
import akka.util.ByteStringBuilder
import org.reactivestreams.Publisher
import org.reactivestreams.Subscriber

import scala.annotation.tailrec

object <a title="akka.stream.io.SslTlsCipher.type" id="akka.stream.io.SslTlsCipher.readResolve">SslTlsCipher</a> <a href="#akka.stream.io.SslTlsCipher.readResolve" title="akka.stream.io.SslTlsCipher.type" class="delimiter">{</a>

  <span class="comment">/**
   * An established SSL session.
   */</span>
  final case class <a title="class InboundSession extends AnyRef with Product with Serializable" id="akka.stream.io.SslTlsCipher.InboundSession.readResolve">InboundSession</a><a href="#akka.stream.io.SslTlsCipher.InboundSession.readResolve" title="Product" class="delimiter">(</a>
    <a title="akka.stream.io.SslTlsCipher.SessionInfo" id="akka.stream.io.SslTlsCipher;InboundSession.sessionInfo">sessionInfo</a>: <a href="#akka.stream.io.SslTlsCipher;SessionInfo" title="akka.stream.io.SslTlsCipher.SessionInfo">SessionInfo</a>,
    <a title="org.reactivestreams.Publisher[akka.util.ByteString]" id="akka.stream.io.SslTlsCipher;InboundSession.data">data</a>: <span title="org.reactivestreams.Publisher[akka.util.ByteString]">Publisher</span><span class="delimiter">[</span>ByteString<span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="comment">/**
   * A request to establish an SSL session.
   * FIXME Not used right now since there is only one session established
   */</span>
  final case class <a title="class OutboundSession extends AnyRef with Product with Serializable" id="akka.stream.io.SslTlsCipher.OutboundSession.readResolve">OutboundSession</a><a href="#akka.stream.io.SslTlsCipher.OutboundSession.readResolve" title="Product" class="delimiter">(</a>
    <a title="akka.stream.io.SslTlsCipher.SessionNegotiation" id="akka.stream.io.SslTlsCipher;OutboundSession.negotiation">negotiation</a>: <a href="#akka.stream.io.SslTlsCipher.SessionNegotiation.readResolve" title="akka.stream.io.SslTlsCipher.SessionNegotiation">SessionNegotiation</a>,
    <a title="org.reactivestreams.Subscriber[akka.util.ByteString]" id="akka.stream.io.SslTlsCipher;OutboundSession.data">data</a>: <span title="org.reactivestreams.Subscriber[akka.util.ByteString]">Subscriber</span><span class="delimiter">[</span>ByteString<span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Information about the established SSL session.
   */</span>
  final case class <a title="class SessionInfo extends AnyRef with Product with Serializable" id="akka.stream.io.SslTlsCipher;SessionInfo">SessionInfo</a><a href="#akka.stream.io.SslTlsCipher;SessionInfo" title="Product" class="delimiter">(</a>
    <a title="String" id="akka.stream.io.SslTlsCipher;SessionInfo.cipherSuite">cipherSuite</a>: <span title="String">String</span>,
    <a title="List[java.security.cert.Certificate]" id="akka.stream.io.SslTlsCipher;SessionInfo.localCertificates">localCertificates</a>: <span title="List[java.security.cert.Certificate]">List</span><span class="delimiter">[</span>Certificate<span class="delimiter">]</span>,
    <a title="Option[java.security.Principal]" id="akka.stream.io.SslTlsCipher;SessionInfo.localPrincipal">localPrincipal</a>: <span title="Option[java.security.Principal]">Option</span><span class="delimiter">[</span>Principal<span class="delimiter">]</span>,
    <a title="List[java.security.cert.Certificate]" id="akka.stream.io.SslTlsCipher;SessionInfo.peerCertificates">peerCertificates</a>: <span title="List[java.security.cert.Certificate]">List</span><span class="delimiter">[</span>Certificate<span class="delimiter">]</span>,
    <a title="Option[java.security.Principal]" id="akka.stream.io.SslTlsCipher;SessionInfo.peerPrincipal">peerPrincipal</a>: <span title="Option[java.security.Principal]">Option</span><span class="delimiter">[</span>Principal<span class="delimiter">]</span><span class="delimiter">)</span>

  object <a title="akka.stream.io.SslTlsCipher.SessionInfo.type" id="akka.stream.io.SslTlsCipher.SessionInfo.readResolve">SessionInfo</a> <a href="#akka.stream.io.SslTlsCipher.SessionInfo.readResolve" title="akka.stream.io.SslTlsCipher.SessionInfo.type" class="delimiter">{</a>

    def <a title="(engine: javax.net.ssl.SSLEngine)akka.stream.io.SslTlsCipher.SessionInfo" id="akka.stream.io.SslTlsCipher.SessionInfo.apply(4877517ff3)">apply</a><span class="delimiter">(</span><a title="javax.net.ssl.SSLEngine" id="akka.stream.io.SslTlsCipher.SessionInfo.apply(4877517ff3).engine">engine</a>: <span title="javax.net.ssl.SSLEngine">SSLEngine</span><span class="delimiter">)</span>: <a href="#akka.stream.io.SslTlsCipher;SessionInfo" title="akka.stream.io.SslTlsCipher.SessionInfo">SessionInfo</a> =
      <a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee)" title="(session: javax.net.ssl.SSLSession)akka.stream.io.SslTlsCipher.SessionInfo">apply</a><span class="delimiter">(</span><a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(4877517ff3).engine" title="javax.net.ssl.SSLEngine">engine</a>.<span title="()javax.net.ssl.SSLSession">getSession</span><span class="delimiter">)</span>

    def <a title="(session: javax.net.ssl.SSLSession)akka.stream.io.SslTlsCipher.SessionInfo" id="akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee)">apply</a><span class="delimiter">(</span><a title="javax.net.ssl.SSLSession" id="akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).session">session</a>: <span title="javax.net.ssl.SSLSession">SSLSession</span><span class="delimiter">)</span>: <a href="#akka.stream.io.SslTlsCipher;SessionInfo" title="akka.stream.io.SslTlsCipher.SessionInfo">SessionInfo</a> = <span class="delimiter">{</span>
      val localCertificates = <span title="(x: Array[java.security.cert.Certificate])Option[Array[java.security.cert.Certificate]]">Option</span><span class="delimiter">(</span><a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).session" title="javax.net.ssl.SSLSession">session</a>.<span title="()Array[java.security.cert.Certificate]">getLocalCertificates</span><span class="delimiter">)</span>.<span title="(f: Array[java.security.cert.Certificate] =&gt; List[java.security.cert.Certificate])Option[List[java.security.cert.Certificate]]">map</span> <span class="delimiter">{</span> <a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).localCertificates.$anonfun.x$1" title="(xs: Array[java.security.cert.Certificate])scala.collection.mutable.ArrayOps[java.security.cert.Certificate]">_</a>.<span title="=&gt; List[java.security.cert.Certificate]">toList</span> <span class="delimiter">}</span> <a title="List[java.security.cert.Certificate]" id="akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).localCertificates">getOrElse</a> <span title="scala.collection.immutable.Nil.type">Nil</span>
      val <a title="Option[java.security.Principal]" id="akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).localPrincipal">localPrincipal</a> = <span title="(x: java.security.Principal)Option[java.security.Principal]">Option</span><span class="delimiter">(</span><a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).session" title="javax.net.ssl.SSLSession">session</a>.<span title="()java.security.Principal">getLocalPrincipal</span><span class="delimiter">)</span>
      val <a title="List[java.security.cert.Certificate]" id="akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).peerCertificates">peerCertificates</a> =
        try <a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).session" title="javax.net.ssl.SSLSession">session</a>.<span title="(xs: Array[java.security.cert.Certificate])scala.collection.mutable.ArrayOps[java.security.cert.Certificate]">getPeerCertificates</span>.<span title="=&gt; List[java.security.cert.Certificate]">toList</span>
        catch <span class="delimiter">{</span> case <a title="javax.net.ssl.SSLPeerUnverifiedException" id="akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).peerCertificates.e">e</a>: <span title="javax.net.ssl.SSLPeerUnverifiedException">SSLPeerUnverifiedException</span> â‡’ <span title="scala.collection.immutable.Nil.type">Nil</span> <span class="delimiter">}</span>
      val <a title="Option[java.security.Principal]" id="akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).peerPrincipal">peerPrincipal</a> =
        try <span title="(x: java.security.Principal)Option[java.security.Principal]">Option</span><span class="delimiter">(</span><a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).session" title="javax.net.ssl.SSLSession">session</a>.<span title="()java.security.Principal">getPeerPrincipal</span><span class="delimiter">)</span>
        catch <span class="delimiter">{</span> case <a title="javax.net.ssl.SSLPeerUnverifiedException" id="akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).peerPrincipal.e">e</a>: <span title="javax.net.ssl.SSLPeerUnverifiedException">SSLPeerUnverifiedException</span> â‡’ <span title="None.type">None</span> <span class="delimiter">}</span>
      <a href="#akka.stream.io.SslTlsCipher;SessionInfo" title="(cipherSuite: String, localCertificates: List[java.security.cert.Certificate], localPrincipal: Option[java.security.Principal], peerCertificates: List[java.security.cert.Certificate], peerPrincipal: Option[java.security.Principal])akka.stream.io.SslTlsCipher.SessionInfo">SessionInfo</a><span class="delimiter">(</span><a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).session" title="javax.net.ssl.SSLSession">session</a>.<span title="()String">getCipherSuite</span>, <a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).localCertificates" title="List[java.security.cert.Certificate]">localCertificates</a>, <a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).localPrincipal" title="Option[java.security.Principal]">localPrincipal</a>, <a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).peerCertificates" title="List[java.security.cert.Certificate]">peerCertificates</a>, <a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(2c8b1a7eee).peerPrincipal" title="Option[java.security.Principal]">peerPrincipal</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Information needed to establish an SSL session.
   */</span>
  final case class <a title="class SessionNegotiation extends AnyRef with Product with Serializable" id="akka.stream.io.SslTlsCipher.SessionNegotiation.readResolve">SessionNegotiation</a><a href="#akka.stream.io.SslTlsCipher.SessionNegotiation.readResolve" title="Product" class="delimiter">(</a><a title="javax.net.ssl.SSLEngine" id="akka.stream.io.SslTlsCipher;SessionNegotiation.engine">engine</a>: <span title="javax.net.ssl.SSLEngine">SSLEngine</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

final case class <a title="(sessionInbound: org.reactivestreams.Publisher[akka.stream.io.SslTlsCipher.InboundSession], plainTextOutbound: org.reactivestreams.Subscriber[akka.util.ByteString], cipherTextInbound: org.reactivestreams.Subscriber[akka.util.ByteString], cipherTextOutbound: org.reactivestreams.Publisher[akka.util.ByteString])akka.stream.io.SslTlsCipher" id="akka.stream.io;SslTlsCipher.equals">SslTlsCipher</a><a href="#akka.stream.io;SslTlsCipher.equals" title="Product" class="delimiter">(</a>
  <a title="org.reactivestreams.Publisher[akka.stream.io.SslTlsCipher.InboundSession]" id="akka.stream.io;SslTlsCipher.copy$default$1">sessionInbound</a>: <span title="org.reactivestreams.Publisher[akka.stream.io.SslTlsCipher.InboundSession]">Publisher</span><span class="delimiter">[</span>SslTlsCipher.InboundSession<span class="delimiter">]</span>,
  <span class="comment">// FIXME We only have one session, and the SessionNegotiation is passed in via the constructor.</span>
  <span class="comment">// This should really be a Subscriber[SslTlsCipher.OutboundSession]</span>
  <a title="org.reactivestreams.Subscriber[akka.util.ByteString]" id="akka.stream.io;SslTlsCipher.copy$default$2">plainTextOutbound</a>: <span title="org.reactivestreams.Subscriber[akka.util.ByteString]">Subscriber</span><span class="delimiter">[</span>ByteString<span class="delimiter">]</span>,
  <a title="org.reactivestreams.Subscriber[akka.util.ByteString]" id="akka.stream.io;SslTlsCipher.copy$default$3">cipherTextInbound</a>: <span title="org.reactivestreams.Subscriber[akka.util.ByteString]">Subscriber</span><span class="delimiter">[</span>ByteString<span class="delimiter">]</span>,
  <a title="org.reactivestreams.Publisher[akka.util.ByteString]" id="akka.stream.io;SslTlsCipher.copy$default$4">cipherTextOutbound</a>: <span title="org.reactivestreams.Publisher[akka.util.ByteString]">Publisher</span><span class="delimiter">[</span>ByteString<span class="delimiter">]</span><span class="delimiter">)</span>

object <a title="akka.stream.io.SslTlsCipherActor.type" id="akka.stream.io.SslTlsCipherActor">SslTlsCipherActor</a> <a href="#akka.stream.io.SslTlsCipherActor" title="akka.stream.io.SslTlsCipherActor.type" class="delimiter">{</a>
  val <a title="Array[Byte]" id="akka.stream.io.SslTlsCipherActor.EmptyByteArray">EmptyByteArray</a> = <span title="Array.type">Array</span>.<span title="[T](implicit evidence$1: scala.reflect.ClassTag[T])Array[T]">empty</span><span title="(implicit evidence$1: scala.reflect.ClassTag[Byte])Array[Byte]" class="delimiter">[</span><span title="Byte">Byte</span><span class="delimiter">]</span>
  val <a title="java.nio.ByteBuffer" id="akka.stream.io.SslTlsCipherActor.EmptyByteBuffer">EmptyByteBuffer</a> = <span title="java.nio.ByteBuffer.type">ByteBuffer</span>.<span title="(x$1: Array[Byte])java.nio.ByteBuffer">wrap</span><span class="delimiter">(</span><a href="#akka.stream.io.SslTlsCipherActor.EmptyByteArray" title="=&gt; Array[Byte]">EmptyByteArray</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

class <a title="class SslTlsCipherActor extends AnyRef with akka.actor.Actor with akka.actor.ActorLogging with akka.stream.impl.Pump with akka.stream.impl.MultiStreamOutputProcessorLike with akka.stream.impl.MultiStreamInputProcessorLike" id="akka.stream.io;SslTlsCipherActor">SslTlsCipherActor</a><a href="#akka.stream.io;SslTlsCipherActor" title="akka.stream.io.SslTlsCipherActor" class="delimiter">(</a>val <a title="akka.actor.ActorRef" id="akka.stream.io;SslTlsCipherActor.requester">requester</a>: <span title="akka.actor.ActorRef">ActorRef</span>, val <a title="akka.stream.io.SslTlsCipher.SessionNegotiation" id="akka.stream.io;SslTlsCipherActor.sessionNegotioation">sessionNegotioation</a>: SslTlsCipher.<a href="#akka.stream.io.SslTlsCipher.SessionNegotiation.readResolve" title="akka.stream.io.SslTlsCipher.SessionNegotiation">SessionNegotiation</a>, <a title="Boolean" id="akka.stream.io;SslTlsCipherActor.tracing">tracing</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>
  extends <a href="#akka.stream.io;SslTlsCipherActor" title="akka.actor.Actor">Actor</a>
  with <span title="akka.actor.ActorLogging">ActorLogging</span>
  with <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump" title="akka.stream.impl.Pump">Pump</a>
  with <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamOutputProcessorLike" title="akka.stream.impl.MultiStreamOutputProcessorLike">MultiStreamOutputProcessorLike</a>
  with <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamInputProcessorLike" title="akka.stream.impl.MultiStreamInputProcessorLike">MultiStreamInputProcessorLike</a> <span class="delimiter">{</span>

  override val <a title="akka.stream.StreamSubscriptionTimeoutSettings" id="akka.stream.io;SslTlsCipherActor.subscriptionTimeoutSettings">subscriptionTimeoutSettings</a> = <a href="../FlowMaterializer.scala.html#akka.stream.MaterializerSettings.apply(beeccf56d5)" title="(system: akka.actor.ActorSystem)akka.stream.MaterializerSettings">MaterializerSettings</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.actor.ActorContext">context</a>.<span title="=&gt; akka.actor.ActorSystem">system</span><span class="delimiter">)</span>.<a href="../FlowMaterializer.scala.html#akka.stream;MaterializerSettings.subscriptionTimeoutSettings" title="=&gt; akka.stream.StreamSubscriptionTimeoutSettings">subscriptionTimeoutSettings</a>

  def this<span class="delimiter">(</span><a title="akka.actor.ActorRef" id="akka.stream.io;SslTlsCipherActor.<init>(8f17e041d8).requester">requester</a>: <span title="akka.actor.ActorRef">ActorRef</span>, <a title="akka.stream.io.SslTlsCipher.SessionNegotiation" id="akka.stream.io;SslTlsCipherActor.<init>(8f17e041d8).sessionNegotioation">sessionNegotioation</a>: SslTlsCipher.<a href="#akka.stream.io.SslTlsCipher.SessionNegotiation.readResolve" title="akka.stream.io.SslTlsCipher.SessionNegotiation">SessionNegotiation</a><span class="delimiter">)</span> =
    this<span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.<init>(8f17e041d8).requester" title="akka.actor.ActorRef">requester</a>, <a href="#akka.stream.io;SslTlsCipherActor.<init>(8f17e041d8).sessionNegotioation" title="akka.stream.io.SslTlsCipher.SessionNegotiation">sessionNegotioation</a>, false<span class="delimiter">)</span>

  import <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl.MultiStreamInputProcessor" title="akka.stream.impl.MultiStreamInputProcessor.type">MultiStreamInputProcessor</a>.SubstreamSubscriber
  import <a href="#akka.stream.io.SslTlsCipherActor" title="akka.stream.io.SslTlsCipherActor.type">SslTlsCipherActor</a>._

  private var <a title="Long" id="akka.stream.io;SslTlsCipherActor._nextId_=">_nextId</a> = <span title="Long(0L)" class="long">0L</span>
  protected def <a title="()Long" id="akka.stream.io;SslTlsCipherActor.nextId">nextId</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Long">Long</span> = <span class="delimiter">{</span> <a href="#akka.stream.io;SslTlsCipherActor._nextId_=" title="(x$1: Long)Unit">_nextId</a> <span title="(x: Int)Long">+=</span> <span title="Int(1)" class="int">1</span>; <a href="#akka.stream.io;SslTlsCipherActor._nextId_=" title="=&gt; Long">_nextId</a> <span class="delimiter">}</span>
  override protected val <a title="Int" id="akka.stream.io;SslTlsCipherActor.inputBufferSize">inputBufferSize</a> = <span title="Int(1)" class="int">1</span>

  <span class="comment">// The cipherTextInput (Subscriber[ByteString])</span>
  val <a title="akka.stream.impl.MultiStreamInputProcessor.SubstreamInput" id="akka.stream.io;SslTlsCipherActor.inboundCipherTextInput">inboundCipherTextInput</a> = <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamInputProcessorLike.createSubstreamInput" title="()akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">createSubstreamInput</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">// The cipherTextOutput (Publisher[ByteString])</span>
  val <a title="akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput" id="akka.stream.io;SslTlsCipherActor.outboundCipherTextOutput">outboundCipherTextOutput</a> = <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamOutputProcessorLike.createSubstreamOutput" title="()akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">createSubstreamOutput</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">// The Publisher[SslTlsCipher.InboundSession]</span>
  <span class="comment">// FIXME For now there is only one session ever exposed</span>
  val <a title="akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput" id="akka.stream.io;SslTlsCipherActor.inboundSessionOutput">inboundSessionOutput</a> = <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamOutputProcessorLike.createSubstreamOutput" title="()akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">createSubstreamOutput</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">// The read side for the user (Publisher[ByteString])</span>
  <span class="comment">// FIXME For now there is only one session ever exposed</span>
  val <a title="akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput" id="akka.stream.io;SslTlsCipherActor.inboundPlaintextOutput">inboundPlaintextOutput</a> = <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamOutputProcessorLike.createSubstreamOutput" title="()akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">createSubstreamOutput</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">// The write side for the user (Subscriber[ByteString])</span>
  <span class="comment">// FIXME For now there is only one session ever exposed</span>
  val <a title="akka.stream.impl.MultiStreamInputProcessor.SubstreamInput" id="akka.stream.io;SslTlsCipherActor.outboundPlaintextInput">outboundPlaintextInput</a> = <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamInputProcessorLike.createSubstreamInput" title="()akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">createSubstreamInput</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">// Plaintext bytes to be encrypted</span>
  var <a title="java.nio.ByteBuffer" id="akka.stream.io;SslTlsCipherActor.plaintextOutboundBytes_=">plaintextOutboundBytes</a> = <a href="#akka.stream.io.SslTlsCipherActor.EmptyByteBuffer" title="=&gt; java.nio.ByteBuffer">EmptyByteBuffer</a>
  val <a title="&lt;refinement of akka.stream.impl.TransferState&gt; extends AnyRef with akka.stream.impl.TransferState" id="akka.stream.io;SslTlsCipherActor.plaintextOutboundBytesPending">plaintextOutboundBytesPending</a> = new <a title="&lt;$anon: akka.stream.impl.TransferState&gt; extends AnyRef with akka.stream.impl.TransferState" id="akka.stream.io;SslTlsCipherActor.plaintextOutboundBytesPending;$anon">TransferState</a> <span class="delimiter">{</span>
    override def <a title="=&gt; Boolean" id="akka.stream.io;SslTlsCipherActor.plaintextOutboundBytesPending;$anon.isReady">isReady</a> = <a href="#akka.stream.io;SslTlsCipherActor.plaintextOutboundBytes_=" title="=&gt; java.nio.ByteBuffer">plaintextOutboundBytes</a>.<span title="()Boolean">hasRemaining</span>
    override def <a title="=&gt; Boolean" id="akka.stream.io;SslTlsCipherActor.plaintextOutboundBytesPending;$anon.isCompleted">isCompleted</a> = false
  <span class="delimiter">}</span>

  <span class="comment">// Encrypted bytes to be sent</span>
  val <a title="akka.util.ByteStringBuilder" id="akka.stream.io;SslTlsCipherActor.cipherTextOutboundBytes">cipherTextOutboundBytes</a> = new <span title="akka.util.ByteStringBuilder">ByteStringBuilder</span>

  <span class="comment">// Encrypted bytes to be decrypted</span>
  var <a title="java.nio.ByteBuffer" id="akka.stream.io;SslTlsCipherActor.cipherTextInboundBytes_=">cipherTextInboundBytes</a> = <a href="#akka.stream.io.SslTlsCipherActor.EmptyByteBuffer" title="=&gt; java.nio.ByteBuffer">EmptyByteBuffer</a>
  val <a title="&lt;refinement of akka.stream.impl.TransferState&gt; extends AnyRef with akka.stream.impl.TransferState" id="akka.stream.io;SslTlsCipherActor.cipherTextInboundBytesPending">cipherTextInboundBytesPending</a> = new <a title="&lt;$anon: akka.stream.impl.TransferState&gt; extends AnyRef with akka.stream.impl.TransferState" id="akka.stream.io;SslTlsCipherActor.cipherTextInboundBytesPending;$anon">TransferState</a> <span class="delimiter">{</span>
    override def <a title="=&gt; Boolean" id="akka.stream.io;SslTlsCipherActor.cipherTextInboundBytesPending;$anon.isReady">isReady</a> = <a href="#akka.stream.io;SslTlsCipherActor.cipherTextInboundBytes_=" title="=&gt; java.nio.ByteBuffer">cipherTextInboundBytes</a>.<span title="()Boolean">hasRemaining</span>
    override def <a title="=&gt; Boolean" id="akka.stream.io;SslTlsCipherActor.cipherTextInboundBytesPending;$anon.isCompleted">isCompleted</a> = false
  <span class="delimiter">}</span>

  <span class="comment">// Plaintext bytes to be received</span>
  val <a title="akka.util.ByteStringBuilder" id="akka.stream.io;SslTlsCipherActor.plaintextInboundBytes">plaintextInboundBytes</a> = new <span title="akka.util.ByteStringBuilder">ByteStringBuilder</span>

  <span class="comment">// FIXME: Change this into a pool of ByteBuffer later</span>
  <span class="comment">// These are Nettys default values</span>
  <span class="comment">// 16665 + 1024 (room for compressed data) + 1024 (for OpenJDK compatibility)</span>
  val <a title="java.nio.ByteBuffer" id="akka.stream.io;SslTlsCipherActor.temporaryBuffer">temporaryBuffer</a> = <span title="java.nio.ByteBuffer.type">ByteBuffer</span>.<span title="(x$1: Int)java.nio.ByteBuffer">allocate</span><span class="delimiter">(</span><span class="int">16665</span> <span title="Int(18713)">+</span> <span class="int">2048</span><span class="delimiter">)</span>

  val <a title="javax.net.ssl.SSLEngine" id="akka.stream.io;SslTlsCipherActor.engine">engine</a>: <span title="javax.net.ssl.SSLEngine">SSLEngine</span> = <a href="#akka.stream.io;SslTlsCipherActor.sessionNegotioation" title="=&gt; akka.stream.io.SslTlsCipher.SessionNegotiation">sessionNegotioation</a>.<a href="#akka.stream.io.SslTlsCipher;SessionNegotiation.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>

  def <a title="(tempBuf: java.nio.ByteBuffer)javax.net.ssl.SSLEngineResult" id="akka.stream.io;SslTlsCipherActor.doWrap">doWrap</a><span class="delimiter">(</span><a title="java.nio.ByteBuffer" id="akka.stream.io;SslTlsCipherActor.doWrap.tempBuf">tempBuf</a>: <span title="java.nio.ByteBuffer">ByteBuffer</span><span class="delimiter">)</span>: <span title="javax.net.ssl.SSLEngineResult">SSLEngineResult</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.io;SslTlsCipherActor.doWrap.tempBuf" title="java.nio.ByteBuffer">tempBuf</a>.<span title="()java.nio.Buffer">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;before wrap {}&quot;)" class="string">&quot;before wrap {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.plaintextOutboundBytes_=" title="=&gt; java.nio.ByteBuffer">plaintextOutboundBytes</a>.<span title="()Int">remaining</span><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult" id="akka.stream.io;SslTlsCipherActor.doWrap.result">result</a> = <a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>.<span title="(x$1: java.nio.ByteBuffer, x$2: java.nio.ByteBuffer)javax.net.ssl.SSLEngineResult">wrap</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.plaintextOutboundBytes_=" title="=&gt; java.nio.ByteBuffer">plaintextOutboundBytes</a>, <a href="#akka.stream.io;SslTlsCipherActor.doWrap.tempBuf" title="java.nio.ByteBuffer">tempBuf</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;after wrap {}&quot;)" class="string">&quot;after wrap {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.plaintextOutboundBytes_=" title="=&gt; java.nio.ByteBuffer">plaintextOutboundBytes</a>.<span title="()Int">remaining</span><span class="delimiter">)</span>
    <a href="#akka.stream.io;SslTlsCipherActor.doWrap.tempBuf" title="java.nio.ByteBuffer">tempBuf</a>.<span title="()java.nio.Buffer">flip</span><span class="delimiter">(</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.doWrap.tempBuf" title="java.nio.ByteBuffer">tempBuf</a>.<span title="()Boolean">hasRemaining</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="akka.util.ByteString" id="akka.stream.io;SslTlsCipherActor.doWrap.bs">bs</a> = <span title="(bytes: java.nio.ByteBuffer)akka.util.ByteString">ByteString</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.doWrap.tempBuf" title="java.nio.ByteBuffer">tempBuf</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;wrap Enqueue cipher bytes {}&quot;)" class="string">&quot;wrap Enqueue cipher bytes {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.doWrap.bs" title="akka.util.ByteString">bs</a><span class="delimiter">)</span>
      <a href="#akka.stream.io;SslTlsCipherActor.cipherTextOutboundBytes" title="=&gt; akka.util.ByteStringBuilder">cipherTextOutboundBytes</a> <span title="(xs: TraversableOnce[Byte])SslTlsCipherActor.this.cipherTextOutboundBytes.type">++=</span> <a href="#akka.stream.io;SslTlsCipherActor.doWrap.bs" title="akka.util.ByteString">bs</a>
    <span class="delimiter">}</span>
    <a href="#akka.stream.io;SslTlsCipherActor.doWrap.result" title="javax.net.ssl.SSLEngineResult">result</a>
  <span class="delimiter">}</span>

  def <a title="(tempBuf: java.nio.ByteBuffer)javax.net.ssl.SSLEngineResult" id="akka.stream.io;SslTlsCipherActor.doUnwrap">doUnwrap</a><span class="delimiter">(</span><a title="java.nio.ByteBuffer" id="akka.stream.io;SslTlsCipherActor.doUnwrap.tempBuf">tempBuf</a>: <span title="java.nio.ByteBuffer">ByteBuffer</span><span class="delimiter">)</span>: <span title="javax.net.ssl.SSLEngineResult">SSLEngineResult</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.io;SslTlsCipherActor.doUnwrap.tempBuf" title="java.nio.ByteBuffer">tempBuf</a>.<span title="()java.nio.Buffer">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;before unwrap {}&quot;)" class="string">&quot;before unwrap {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.cipherTextInboundBytes_=" title="=&gt; java.nio.ByteBuffer">cipherTextInboundBytes</a>.<span title="()Int">remaining</span><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult" id="akka.stream.io;SslTlsCipherActor.doUnwrap.result">result</a> = <a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>.<span title="(x$1: java.nio.ByteBuffer, x$2: java.nio.ByteBuffer)javax.net.ssl.SSLEngineResult">unwrap</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.cipherTextInboundBytes_=" title="=&gt; java.nio.ByteBuffer">cipherTextInboundBytes</a>, <a href="#akka.stream.io;SslTlsCipherActor.doUnwrap.tempBuf" title="java.nio.ByteBuffer">tempBuf</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;after unwrap {}&quot;)" class="string">&quot;after unwrap {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.cipherTextInboundBytes_=" title="=&gt; java.nio.ByteBuffer">cipherTextInboundBytes</a>.<span title="()Int">remaining</span><span class="delimiter">)</span>
    <a href="#akka.stream.io;SslTlsCipherActor.doUnwrap.tempBuf" title="java.nio.ByteBuffer">tempBuf</a>.<span title="()java.nio.Buffer">flip</span><span class="delimiter">(</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.doUnwrap.tempBuf" title="java.nio.ByteBuffer">tempBuf</a>.<span title="()Boolean">hasRemaining</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="akka.util.ByteString" id="akka.stream.io;SslTlsCipherActor.doUnwrap.bs">bs</a> = <span title="(bytes: java.nio.ByteBuffer)akka.util.ByteString">ByteString</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.doUnwrap.tempBuf" title="java.nio.ByteBuffer">tempBuf</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;unwrap Enqueue cipher bytes {}&quot;)" class="string">&quot;unwrap Enqueue cipher bytes {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.doUnwrap.bs" title="akka.util.ByteString">bs</a><span class="delimiter">)</span>
      <a href="#akka.stream.io;SslTlsCipherActor.plaintextInboundBytes" title="=&gt; akka.util.ByteStringBuilder">plaintextInboundBytes</a> <span title="(xs: TraversableOnce[Byte])SslTlsCipherActor.this.plaintextInboundBytes.type">++=</span> <a href="#akka.stream.io;SslTlsCipherActor.doUnwrap.bs" title="akka.util.ByteString">bs</a>
    <span class="delimiter">}</span>
    <a href="#akka.stream.io;SslTlsCipherActor.doUnwrap.result" title="javax.net.ssl.SSLEngineResult">result</a>
  <span class="delimiter">}</span>

  def <a title="(data: akka.util.ByteString)Unit" id="akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes">enqueueCipherInputBytes</a><span class="delimiter">(</span><a title="akka.util.ByteString" id="akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes.data">data</a>: <span title="akka.util.ByteString">ByteString</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.io;SslTlsCipherActor.cipherTextInboundBytes_=" title="(x$1: java.nio.ByteBuffer)Unit">cipherTextInboundBytes</a> =
      if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.cipherTextInboundBytes_=" title="=&gt; java.nio.ByteBuffer">cipherTextInboundBytes</a>.<span title="()Boolean">hasRemaining</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        val <a title="java.nio.ByteBuffer" id="akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes.buffer">buffer</a> = <span title="java.nio.ByteBuffer.type">ByteBuffer</span>.<span title="(x$1: Int)java.nio.ByteBuffer">allocate</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.cipherTextInboundBytes_=" title="=&gt; java.nio.ByteBuffer">cipherTextInboundBytes</a>.<span title="()Int">remaining</span> <span title="(x: Int)Int">+</span> <a href="#akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes.data" title="akka.util.ByteString">data</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
        <a href="#akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes.buffer" title="java.nio.ByteBuffer">buffer</a>.<span title="(x$1: java.nio.ByteBuffer)java.nio.ByteBuffer">put</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.cipherTextInboundBytes_=" title="=&gt; java.nio.ByteBuffer">cipherTextInboundBytes</a><span class="delimiter">)</span>
        <a href="#akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes.data" title="akka.util.ByteString">data</a>.<span title="(buffer: java.nio.ByteBuffer)Int">copyToBuffer</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes.buffer" title="java.nio.ByteBuffer">buffer</a><span class="delimiter">)</span>
        <a href="#akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes.buffer" title="java.nio.ByteBuffer">buffer</a>.<span title="()java.nio.Buffer">flip</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes.buffer" title="java.nio.ByteBuffer">buffer</a>
      <span class="delimiter">}</span> else <a href="#akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes.data" title="akka.util.ByteString">data</a>.<span title="=&gt; java.nio.ByteBuffer">toByteBuffer</span>
  <span class="delimiter">}</span>

  def <a title="()Unit" id="akka.stream.io;SslTlsCipherActor.writeCipherTextOutboundBytes">writeCipherTextOutboundBytes</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.cipherTextOutboundBytes" title="=&gt; akka.util.ByteStringBuilder">cipherTextOutboundBytes</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="akka.util.ByteString" id="akka.stream.io;SslTlsCipherActor.writeCipherTextOutboundBytes.bs">bs</a> = <a href="#akka.stream.io;SslTlsCipherActor.cipherTextOutboundBytes" title="=&gt; akka.util.ByteStringBuilder">cipherTextOutboundBytes</a>.<span title="()akka.util.ByteString">result</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.stream.io;SslTlsCipherActor.cipherTextOutboundBytes" title="=&gt; akka.util.ByteStringBuilder">cipherTextOutboundBytes</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.stream.io;SslTlsCipherActor.outboundCipherTextOutput" title="=&gt; akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">outboundCipherTextOutput</a>.<a href="../impl/ActorProcessor.scala.html#akka.stream.impl;SimpleOutputs.enqueueOutputElement" title="(elem: Any)Unit">enqueueOutputElement</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.writeCipherTextOutboundBytes.bs" title="akka.util.ByteString">bs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="()Unit" id="akka.stream.io;SslTlsCipherActor.writePlaintextInboundBytes">writePlaintextInboundBytes</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.plaintextInboundBytes" title="=&gt; akka.util.ByteStringBuilder">plaintextInboundBytes</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="akka.util.ByteString" id="akka.stream.io;SslTlsCipherActor.writePlaintextInboundBytes.bs">bs</a> = <a href="#akka.stream.io;SslTlsCipherActor.plaintextInboundBytes" title="=&gt; akka.util.ByteStringBuilder">plaintextInboundBytes</a>.<span title="()akka.util.ByteString">result</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.stream.io;SslTlsCipherActor.plaintextInboundBytes" title="=&gt; akka.util.ByteStringBuilder">plaintextInboundBytes</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.stream.io;SslTlsCipherActor.inboundPlaintextOutput" title="=&gt; akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">inboundPlaintextOutput</a>.<a href="../impl/ActorProcessor.scala.html#akka.stream.impl;SimpleOutputs.enqueueOutputElement" title="(elem: Any)Unit">enqueueOutputElement</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.writePlaintextInboundBytes.bs" title="akka.util.ByteString">bs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  @tailrec
  private def <a title="()Unit" id="akka.stream.io;SslTlsCipherActor.runDelegatedTasks">runDelegatedTasks</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    val <a title="Runnable" id="akka.stream.io;SslTlsCipherActor.runDelegatedTasks.task">task</a> = <a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>.<span title="()Runnable">getDelegatedTask</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.runDelegatedTasks.task" title="Runnable">task</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span> <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;Running delegated task {}&quot;)" class="string">&quot;Running delegated task {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.runDelegatedTasks.task" title="Runnable">task</a><span class="delimiter">)</span>
      <a href="#akka.stream.io;SslTlsCipherActor.runDelegatedTasks.task" title="Runnable">task</a>.<span title="()Unit">run</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#akka.stream.io;SslTlsCipherActor.runDelegatedTasks" title="()Unit">runDelegatedTasks</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="()Unit" id="akka.stream.io;SslTlsCipherActor.publishSSLSessionEstablished">publishSSLSessionEstablished</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    import <a href="#akka.stream.io.SslTlsCipher.readResolve" title="akka.stream.io.SslTlsCipher.type">SslTlsCipher</a>._
    val <a title="akka.stream.io.SslTlsCipher.SessionInfo" id="akka.stream.io;SslTlsCipherActor.publishSSLSessionEstablished.info">info</a> = <a href="#akka.stream.io.SslTlsCipher.SessionInfo.apply(4877517ff3)" title="(engine: javax.net.ssl.SSLEngine)akka.stream.io.SslTlsCipher.SessionInfo">SessionInfo</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a><span class="delimiter">)</span>
    val <a title="akka.stream.io.SslTlsCipher.InboundSession" id="akka.stream.io;SslTlsCipherActor.publishSSLSessionEstablished.is">is</a> = <a href="#akka.stream.io.SslTlsCipher.InboundSession.readResolve" title="(sessionInfo: akka.stream.io.SslTlsCipher.SessionInfo, data: org.reactivestreams.Publisher[akka.util.ByteString])akka.stream.io.SslTlsCipher.InboundSession">InboundSession</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.publishSSLSessionEstablished.info" title="akka.stream.io.SslTlsCipher.SessionInfo">info</a>, <a href="#akka.stream.io;SslTlsCipherActor.inboundPlaintextOutput" title="=&gt; akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">inboundPlaintextOutput</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="org.reactivestreams.Publisher[akka.util.ByteString]" class="delimiter">[</span><span title="org.reactivestreams.Publisher[akka.util.ByteString]">Publisher</span><span class="delimiter">[</span>ByteString<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(message: String)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;#### Handshake done!&quot;)" class="string">&quot;#### Handshake done!&quot;</span><span class="delimiter">)</span>
    <a href="#akka.stream.io;SslTlsCipherActor.inboundSessionOutput" title="=&gt; akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">inboundSessionOutput</a>.<a href="../impl/ActorProcessor.scala.html#akka.stream.impl;SimpleOutputs.enqueueOutputElement" title="(elem: Any)Unit">enqueueOutputElement</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.publishSSLSessionEstablished.is" title="akka.stream.io.SslTlsCipher.InboundSession">is</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  val <a title="akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.unwrapPhase">unwrapPhase</a>: <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="akka.stream.impl.TransferPhase">TransferPhase</a> = <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="(precondition: akka.stream.impl.TransferState)(action: () =&gt; Unit)akka.stream.impl.TransferPhase">TransferPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.inboundCipherTextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">inboundCipherTextInput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultInputTransferStates.NeedsInput" title="=&gt; akka.stream.impl.TransferState">NeedsInput</a> <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.||" title="(other: akka.stream.impl.TransferState)akka.stream.impl.TransferState">||</a> <a href="#akka.stream.io;SslTlsCipherActor.cipherTextInboundBytesPending" title="=&gt; akka.stream.impl.TransferState">cipherTextInboundBytesPending</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><span class="delimiter">)</span> â‡’
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(message: String)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;### UNWRAP&quot;)" class="string">&quot;### UNWRAP&quot;</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.inboundCipherTextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">inboundCipherTextInput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultInputTransferStates.NeedsInput" title="=&gt; akka.stream.impl.TransferState">NeedsInput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.isReady" title="=&gt; Boolean">isReady</a><span class="delimiter">)</span>
      <a href="#akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes" title="(data: akka.util.ByteString)Unit">enqueueCipherInputBytes</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.inboundCipherTextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">inboundCipherTextInput</a>.<a href="../impl/ActorProcessor.scala.html#akka.stream.impl;BatchingInputBuffer.dequeueInputElement" title="()Any">dequeueInputElement</a><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.util.ByteString" class="delimiter">[</span><span title="akka.util.ByteString">ByteString</span><span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult" id="akka.stream.io;SslTlsCipherActor.unwrapPhase.$anonfun.result">result</a> = <a href="#akka.stream.io;SslTlsCipherActor.doUnwrap" title="(tempBuf: java.nio.ByteBuffer)javax.net.ssl.SSLEngineResult">doUnwrap</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.temporaryBuffer" title="=&gt; java.nio.ByteBuffer">temporaryBuffer</a><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult.Status" id="akka.stream.io;SslTlsCipherActor.unwrapPhase.$anonfun.rs">rs</a> = <a href="#akka.stream.io;SslTlsCipherActor.unwrapPhase.$anonfun.result" title="javax.net.ssl.SSLEngineResult">result</a>.<span title="()javax.net.ssl.SSLEngineResult.Status">getStatus</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;## UNWRAP {}&quot;)" class="string">&quot;## UNWRAP {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.unwrapPhase.$anonfun.rs" title="javax.net.ssl.SSLEngineResult.Status">rs</a><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult.HandshakeStatus" id="akka.stream.io;SslTlsCipherActor.unwrapPhase.$anonfun.hs">hs</a> = <a href="#akka.stream.io;SslTlsCipherActor.unwrapPhase.$anonfun.result" title="javax.net.ssl.SSLEngineResult">result</a>.<span title="()javax.net.ssl.SSLEngineResult.HandshakeStatus">getHandshakeStatus</span>
    val <a title="akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.unwrapPhase.$anonfun.next">next</a> = <a href="#akka.stream.io;SslTlsCipherActor.unwrapPhase.$anonfun.rs" title="javax.net.ssl.SSLEngineResult.Status">rs</a> match <span class="delimiter">{</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(OK)">OK</span> â‡’
        <a href="#akka.stream.io;SslTlsCipherActor.handshakePhase" title="(hs: javax.net.ssl.SSLEngineResult.HandshakeStatus)akka.stream.impl.TransferPhase">handshakePhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.unwrapPhase.$anonfun.hs" title="javax.net.ssl.SSLEngineResult.HandshakeStatus">hs</a><span class="delimiter">)</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(CLOSED)">CLOSED</span>           â‡’ if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>.<span title="()Boolean">isInboundDone</span><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase" title="=&gt; akka.stream.impl.TransferPhase">encryptionPhase</a> else <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.completedPhase" title="=&gt; akka.stream.impl.TransferPhase">completedPhase</a>
      case <span title="javax.net.ssl.SSLEngineResult.Status(BUFFER_OVERFLOW)">BUFFER_OVERFLOW</span>  â‡’ throw new <span title="IllegalStateException">IllegalStateException</span> <span class="comment">// the SslBufferPool should make sure that buffers are never too small</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(BUFFER_UNDERFLOW)">BUFFER_UNDERFLOW</span> â‡’ throw new <span title="IllegalStateException">IllegalStateException</span> <span class="comment">// should never appear as a result of a wrap</span>
    <span class="delimiter">}</span>
    <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.nextPhase" title="(phase: akka.stream.impl.TransferPhase)Unit">nextPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.unwrapPhase.$anonfun.next" title="akka.stream.impl.TransferPhase">next</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  val <a title="akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.wrapPhase">wrapPhase</a>: <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="akka.stream.impl.TransferPhase">TransferPhase</a> = <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="(precondition: akka.stream.impl.TransferState)(action: () =&gt; Unit)akka.stream.impl.TransferPhase">TransferPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.outboundCipherTextOutput" title="=&gt; akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">outboundCipherTextOutput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultOutputTransferStates.NeedsDemand" title="=&gt; akka.stream.impl.TransferState">NeedsDemand</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><span class="delimiter">)</span> â‡’
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(message: String)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;### WRAP&quot;)" class="string">&quot;### WRAP&quot;</span><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult" id="akka.stream.io;SslTlsCipherActor.wrapPhase.$anonfun.result">result</a> = <a href="#akka.stream.io;SslTlsCipherActor.doWrap" title="(tempBuf: java.nio.ByteBuffer)javax.net.ssl.SSLEngineResult">doWrap</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.temporaryBuffer" title="=&gt; java.nio.ByteBuffer">temporaryBuffer</a><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult.Status" id="akka.stream.io;SslTlsCipherActor.wrapPhase.$anonfun.rs">rs</a> = <a href="#akka.stream.io;SslTlsCipherActor.wrapPhase.$anonfun.result" title="javax.net.ssl.SSLEngineResult">result</a>.<span title="()javax.net.ssl.SSLEngineResult.Status">getStatus</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;## WRAP {}&quot;)" class="string">&quot;## WRAP {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.wrapPhase.$anonfun.rs" title="javax.net.ssl.SSLEngineResult.Status">rs</a><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult.HandshakeStatus" id="akka.stream.io;SslTlsCipherActor.wrapPhase.$anonfun.hs">hs</a> = <a href="#akka.stream.io;SslTlsCipherActor.wrapPhase.$anonfun.result" title="javax.net.ssl.SSLEngineResult">result</a>.<span title="()javax.net.ssl.SSLEngineResult.HandshakeStatus">getHandshakeStatus</span>
    val <a title="akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.wrapPhase.$anonfun.next">next</a> = <a href="#akka.stream.io;SslTlsCipherActor.wrapPhase.$anonfun.rs" title="javax.net.ssl.SSLEngineResult.Status">rs</a> match <span class="delimiter">{</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(OK)">OK</span> â‡’
        <a href="#akka.stream.io;SslTlsCipherActor.writeCipherTextOutboundBytes" title="()Unit">writeCipherTextOutboundBytes</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#akka.stream.io;SslTlsCipherActor.handshakePhase" title="(hs: javax.net.ssl.SSLEngineResult.HandshakeStatus)akka.stream.impl.TransferPhase">handshakePhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.wrapPhase.$anonfun.hs" title="javax.net.ssl.SSLEngineResult.HandshakeStatus">hs</a><span class="delimiter">)</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(CLOSED)">CLOSED</span>           â‡’ if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>.<span title="()Boolean">isInboundDone</span><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase" title="=&gt; akka.stream.impl.TransferPhase">decryptionPhase</a> else <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.completedPhase" title="=&gt; akka.stream.impl.TransferPhase">completedPhase</a>
      case <span title="javax.net.ssl.SSLEngineResult.Status(BUFFER_OVERFLOW)">BUFFER_OVERFLOW</span>  â‡’ throw new <span title="IllegalStateException">IllegalStateException</span> <span class="comment">// the SslBufferPool should make sure that buffers are never too small</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(BUFFER_UNDERFLOW)">BUFFER_UNDERFLOW</span> â‡’ throw new <span title="IllegalStateException">IllegalStateException</span> <span class="comment">// should never appear as a result of a wrap</span>
    <span class="delimiter">}</span>
    <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.nextPhase" title="(phase: akka.stream.impl.TransferPhase)Unit">nextPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.wrapPhase.$anonfun.next" title="akka.stream.impl.TransferPhase">next</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(hs: javax.net.ssl.SSLEngineResult.HandshakeStatus)akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.handshakePhase">handshakePhase</a><span class="delimiter">(</span><a title="javax.net.ssl.SSLEngineResult.HandshakeStatus" id="akka.stream.io;SslTlsCipherActor.handshakePhase.hs">hs</a>: SSLEngineResult.<span title="javax.net.ssl.SSLEngineResult.HandshakeStatus">HandshakeStatus</span><span class="delimiter">)</span>: <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="akka.stream.impl.TransferPhase">TransferPhase</a> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;### HS {}&quot;)" class="string">&quot;### HS {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.handshakePhase.hs" title="javax.net.ssl.SSLEngineResult.HandshakeStatus">hs</a><span class="delimiter">)</span>
    <a href="#akka.stream.io;SslTlsCipherActor.handshakePhase.hs" title="javax.net.ssl.SSLEngineResult.HandshakeStatus">hs</a> match <span class="delimiter">{</span>
      case <a title="javax.net.ssl.SSLEngineResult.HandshakeStatus" id="akka.stream.io;SslTlsCipherActor.handshakePhase.status">status</a> @ <span class="delimiter">(</span><span title="javax.net.ssl.SSLEngineResult.HandshakeStatus(NOT_HANDSHAKING)">NOT_HANDSHAKING</span> | <span title="javax.net.ssl.SSLEngineResult.HandshakeStatus(FINISHED)">FINISHED</span><span class="delimiter">)</span> â‡’
        if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.handshakePhase.status" title="javax.net.ssl.SSLEngineResult.HandshakeStatus">status</a> <span title="(x$1: Any)Boolean">==</span> <span title="javax.net.ssl.SSLEngineResult.HandshakeStatus(FINISHED)">FINISHED</span><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor.publishSSLSessionEstablished" title="()Unit">publishSSLSessionEstablished</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#akka.stream.io;SslTlsCipherActor.engineRunningPhase" title="=&gt; akka.stream.impl.TransferPhase">engineRunningPhase</a>
      case <span title="javax.net.ssl.SSLEngineResult.HandshakeStatus(NEED_WRAP)">NEED_WRAP</span>   â‡’ <a href="#akka.stream.io;SslTlsCipherActor.wrapPhase" title="=&gt; akka.stream.impl.TransferPhase">wrapPhase</a>
      case <span title="javax.net.ssl.SSLEngineResult.HandshakeStatus(NEED_UNWRAP)">NEED_UNWRAP</span> â‡’ <a href="#akka.stream.io;SslTlsCipherActor.unwrapPhase" title="=&gt; akka.stream.impl.TransferPhase">unwrapPhase</a>
      case <span title="javax.net.ssl.SSLEngineResult.HandshakeStatus(NEED_TASK)">NEED_TASK</span> â‡’
        <a href="#akka.stream.io;SslTlsCipherActor.runDelegatedTasks" title="()Unit">runDelegatedTasks</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>.<span title="()javax.net.ssl.SSLEngineResult.HandshakeStatus">getHandshakeStatus</span> match <span class="delimiter">{</span>
          case <span title="javax.net.ssl.SSLEngineResult.HandshakeStatus(NEED_WRAP)">NEED_WRAP</span>   â‡’ <a href="#akka.stream.io;SslTlsCipherActor.wrapPhase" title="=&gt; akka.stream.impl.TransferPhase">wrapPhase</a>
          case <span title="javax.net.ssl.SSLEngineResult.HandshakeStatus(NEED_UNWRAP)">NEED_UNWRAP</span> â‡’ <a href="#akka.stream.io;SslTlsCipherActor.unwrapPhase" title="=&gt; akka.stream.impl.TransferPhase">unwrapPhase</a>
          case <a title="javax.net.ssl.SSLEngineResult.HandshakeStatus" id="akka.stream.io;SslTlsCipherActor.handshakePhase.x">x</a>           â‡’ throw new <span title="IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="(args: Any*)String">s</span>&quot;<span title="String(&quot;Bad Handshake status &quot;)">Bad Handshake status $</span><a href="#akka.stream.io;SslTlsCipherActor.handshakePhase.x" title="javax.net.ssl.SSLEngineResult.HandshakeStatus">x</a><span title="String(&quot;&quot;)" class="string">&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  val <a title="akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.waitForHandshakeStartPhase">waitForHandshakeStartPhase</a>: <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="akka.stream.impl.TransferPhase">TransferPhase</a> = <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="(precondition: akka.stream.impl.TransferState)(action: () =&gt; Unit)akka.stream.impl.TransferPhase">TransferPhase</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.outboundPlaintextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">outboundPlaintextInput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultInputTransferStates.NeedsInput" title="=&gt; akka.stream.impl.TransferState">NeedsInput</a> <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.||" title="(other: akka.stream.impl.TransferState)akka.stream.impl.TransferState">||</a> <a href="#akka.stream.io;SslTlsCipherActor.inboundCipherTextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">inboundCipherTextInput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultInputTransferStates.NeedsInput" title="=&gt; akka.stream.impl.TransferState">NeedsInput</a><span class="delimiter">)</span> <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.&&" title="(other: akka.stream.impl.TransferState)akka.stream.impl.TransferState">&amp;&amp;</a> <a href="#akka.stream.io;SslTlsCipherActor.inboundSessionOutput" title="=&gt; akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">inboundSessionOutput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultOutputTransferStates.NeedsDemand" title="=&gt; akka.stream.impl.TransferState">NeedsDemand</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><span class="delimiter">)</span> â‡’
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(message: String)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;#### Starting Handshake&quot;)" class="string">&quot;#### Starting Handshake&quot;</span><span class="delimiter">)</span>
    <a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>.<span title="()Unit">beginHandshake</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.nextPhase" title="(phase: akka.stream.impl.TransferPhase)Unit">nextPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.handshakePhase" title="(hs: javax.net.ssl.SSLEngineResult.HandshakeStatus)akka.stream.impl.TransferPhase">handshakePhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>.<span title="()javax.net.ssl.SSLEngineResult.HandshakeStatus">getHandshakeStatus</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  val encryptionInputAvailable = <a href="#akka.stream.io;SslTlsCipherActor.outboundPlaintextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">outboundPlaintextInput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultInputTransferStates.NeedsInput" title="=&gt; akka.stream.impl.TransferState">NeedsInput</a> <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.||" title="akka.stream.impl.TransferState" id="akka.stream.io;SslTlsCipherActor.encryptionInputAvailable">||</a> <a href="#akka.stream.io;SslTlsCipherActor.plaintextOutboundBytesPending" title="=&gt; akka.stream.impl.TransferState">plaintextOutboundBytesPending</a>
  val decryptionInputAvailable = <a href="#akka.stream.io;SslTlsCipherActor.inboundCipherTextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">inboundCipherTextInput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultInputTransferStates.NeedsInput" title="=&gt; akka.stream.impl.TransferState">NeedsInput</a> <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.||" title="akka.stream.impl.TransferState" id="akka.stream.io;SslTlsCipherActor.decryptionInputAvailable">||</a> <a href="#akka.stream.io;SslTlsCipherActor.cipherTextInboundBytesPending" title="=&gt; akka.stream.impl.TransferState">cipherTextInboundBytesPending</a>

  val canEncrypt = <a href="#akka.stream.io;SslTlsCipherActor.encryptionInputAvailable" title="=&gt; akka.stream.impl.TransferState">encryptionInputAvailable</a> <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.&&" title="akka.stream.impl.TransferState" id="akka.stream.io;SslTlsCipherActor.canEncrypt">&amp;&amp;</a> <a href="#akka.stream.io;SslTlsCipherActor.outboundCipherTextOutput" title="=&gt; akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">outboundCipherTextOutput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultOutputTransferStates.NeedsDemand" title="=&gt; akka.stream.impl.TransferState">NeedsDemand</a>
  val canDecrypt = <a href="#akka.stream.io;SslTlsCipherActor.decryptionInputAvailable" title="=&gt; akka.stream.impl.TransferState">decryptionInputAvailable</a> <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.&&" title="akka.stream.impl.TransferState" id="akka.stream.io;SslTlsCipherActor.canDecrypt">&amp;&amp;</a> <a href="#akka.stream.io;SslTlsCipherActor.inboundPlaintextOutput" title="=&gt; akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">inboundPlaintextOutput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultOutputTransferStates.NeedsDemand" title="=&gt; akka.stream.impl.TransferState">NeedsDemand</a>

  val <a title="akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.engineRunningPhase">engineRunningPhase</a>: <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="akka.stream.impl.TransferPhase">TransferPhase</a> = <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="(precondition: akka.stream.impl.TransferState)(action: () =&gt; Unit)akka.stream.impl.TransferPhase">TransferPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.canEncrypt" title="=&gt; akka.stream.impl.TransferState">canEncrypt</a> <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.||" title="(other: akka.stream.impl.TransferState)akka.stream.impl.TransferState">||</a> <a href="#akka.stream.io;SslTlsCipherActor.canDecrypt" title="=&gt; akka.stream.impl.TransferState">canDecrypt</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><span class="delimiter">)</span> â‡’
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(message: String)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;#### Engine running&quot;)" class="string">&quot;#### Engine running&quot;</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.canEncrypt" title="=&gt; akka.stream.impl.TransferState">canEncrypt</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.isExecutable" title="=&gt; Boolean">isExecutable</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.nextPhase" title="(phase: akka.stream.impl.TransferPhase)Unit">nextPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase" title="=&gt; akka.stream.impl.TransferPhase">encryptionPhase</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> else <span class="delimiter">{</span>
      <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.nextPhase" title="(phase: akka.stream.impl.TransferPhase)Unit">nextPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase" title="=&gt; akka.stream.impl.TransferPhase">decryptionPhase</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  val <a title="akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.encryptionPhase">encryptionPhase</a>: <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="akka.stream.impl.TransferPhase">TransferPhase</a> = <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="(precondition: akka.stream.impl.TransferState)(action: () =&gt; Unit)akka.stream.impl.TransferPhase">TransferPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.canEncrypt" title="=&gt; akka.stream.impl.TransferState">canEncrypt</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><span class="delimiter">)</span> â‡’
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(message: String)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;### Encrypting&quot;)" class="string">&quot;### Encrypting&quot;</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.io;SslTlsCipherActor.plaintextOutboundBytesPending" title="=&gt; akka.stream.impl.TransferState">plaintextOutboundBytesPending</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.isReady" title="=&gt; Boolean">isReady</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#akka.stream.io;SslTlsCipherActor.outboundPlaintextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">outboundPlaintextInput</a>.<a href="../impl/ActorProcessor.scala.html#akka.stream.impl;BatchingInputBuffer.inputsAvailable" title="=&gt; Boolean">inputsAvailable</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="akka.util.ByteString" id="akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.elem">elem</a> = <a href="#akka.stream.io;SslTlsCipherActor.outboundPlaintextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">outboundPlaintextInput</a>.<a href="../impl/ActorProcessor.scala.html#akka.stream.impl;BatchingInputBuffer.dequeueInputElement" title="()Any">dequeueInputElement</a><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.util.ByteString" class="delimiter">[</span><span title="akka.util.ByteString">ByteString</span><span class="delimiter">]</span>
      <a href="#akka.stream.io;SslTlsCipherActor.plaintextOutboundBytes_=" title="(x$1: java.nio.ByteBuffer)Unit">plaintextOutboundBytes</a> = <a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.elem" title="akka.util.ByteString">elem</a>.<span title="=&gt; java.nio.ByteBuffer">asByteBuffer</span>
    <span class="delimiter">}</span>
    val <a title="javax.net.ssl.SSLEngineResult" id="akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.result">result</a> = <a href="#akka.stream.io;SslTlsCipherActor.doWrap" title="(tempBuf: java.nio.ByteBuffer)javax.net.ssl.SSLEngineResult">doWrap</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.temporaryBuffer" title="=&gt; java.nio.ByteBuffer">temporaryBuffer</a><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult.Status" id="akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.rs">rs</a> = <a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.result" title="javax.net.ssl.SSLEngineResult">result</a>.<span title="()javax.net.ssl.SSLEngineResult.Status">getStatus</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;## Encrypting {}&quot;)" class="string">&quot;## Encrypting {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.rs" title="javax.net.ssl.SSLEngineResult.Status">rs</a><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult.HandshakeStatus" id="akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.hs">hs</a> = <a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.result" title="javax.net.ssl.SSLEngineResult">result</a>.<span title="()javax.net.ssl.SSLEngineResult.HandshakeStatus">getHandshakeStatus</span>
    val <a title="akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.next">next</a> = <a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.rs" title="javax.net.ssl.SSLEngineResult.Status">rs</a> match <span class="delimiter">{</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(OK)">OK</span> â‡’
        if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.hs" title="javax.net.ssl.SSLEngineResult.HandshakeStatus">hs</a> <span title="(x$1: Any)Boolean">==</span> <span title="javax.net.ssl.SSLEngineResult.HandshakeStatus(NOT_HANDSHAKING)">NOT_HANDSHAKING</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#akka.stream.io;SslTlsCipherActor.writeCipherTextOutboundBytes" title="()Unit">writeCipherTextOutboundBytes</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#akka.stream.io;SslTlsCipherActor.engineRunningPhase" title="=&gt; akka.stream.impl.TransferPhase">engineRunningPhase</a>
        <span class="delimiter">}</span> else <a href="#akka.stream.io;SslTlsCipherActor.handshakePhase" title="(hs: javax.net.ssl.SSLEngineResult.HandshakeStatus)akka.stream.impl.TransferPhase">handshakePhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.hs" title="javax.net.ssl.SSLEngineResult.HandshakeStatus">hs</a><span class="delimiter">)</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(CLOSED)">CLOSED</span>           â‡’ if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>.<span title="()Boolean">isInboundDone</span><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase" title="=&gt; akka.stream.impl.TransferPhase">decryptionPhase</a> else <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.completedPhase" title="=&gt; akka.stream.impl.TransferPhase">completedPhase</a>
      case <span title="javax.net.ssl.SSLEngineResult.Status(BUFFER_OVERFLOW)">BUFFER_OVERFLOW</span>  â‡’ throw new <span title="IllegalStateException">IllegalStateException</span> <span class="comment">// the SslBufferPool should make sure that buffers are never too small</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(BUFFER_UNDERFLOW)">BUFFER_UNDERFLOW</span> â‡’ throw new <span title="IllegalStateException">IllegalStateException</span> <span class="comment">// should never appear as a result of a wrap</span>
    <span class="delimiter">}</span>
    <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.nextPhase" title="(phase: akka.stream.impl.TransferPhase)Unit">nextPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase.$anonfun.next" title="akka.stream.impl.TransferPhase">next</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  val <a title="akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.decryptionPhase">decryptionPhase</a>: <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="akka.stream.impl.TransferPhase">TransferPhase</a> = <a href="../impl/Transfer.scala.html#akka.stream.impl;TransferPhase" title="(precondition: akka.stream.impl.TransferState)(action: () =&gt; Unit)akka.stream.impl.TransferPhase">TransferPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.canDecrypt" title="=&gt; akka.stream.impl.TransferState">canDecrypt</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><span class="delimiter">)</span> â‡’
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(message: String)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;### Decrypting&quot;)" class="string">&quot;### Decrypting&quot;</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.inboundCipherTextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">inboundCipherTextInput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;DefaultInputTransferStates.NeedsInput" title="=&gt; akka.stream.impl.TransferState">NeedsInput</a>.<a href="../impl/Transfer.scala.html#akka.stream.impl;TransferState.isReady" title="=&gt; Boolean">isReady</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="akka.util.ByteString" id="akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.elem">elem</a> = <a href="#akka.stream.io;SslTlsCipherActor.inboundCipherTextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">inboundCipherTextInput</a>.<a href="../impl/ActorProcessor.scala.html#akka.stream.impl;BatchingInputBuffer.dequeueInputElement" title="()Any">dequeueInputElement</a><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="akka.util.ByteString" class="delimiter">[</span><span title="akka.util.ByteString">ByteString</span><span class="delimiter">]</span>
      <a href="#akka.stream.io;SslTlsCipherActor.enqueueCipherInputBytes" title="(data: akka.util.ByteString)Unit">enqueueCipherInputBytes</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.elem" title="akka.util.ByteString">elem</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    val <a title="javax.net.ssl.SSLEngineResult" id="akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.result">result</a> = <a href="#akka.stream.io;SslTlsCipherActor.doUnwrap" title="(tempBuf: java.nio.ByteBuffer)javax.net.ssl.SSLEngineResult">doUnwrap</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.temporaryBuffer" title="=&gt; java.nio.ByteBuffer">temporaryBuffer</a><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult.Status" id="akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.rs">rs</a> = <a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.result" title="javax.net.ssl.SSLEngineResult">result</a>.<span title="()javax.net.ssl.SSLEngineResult.Status">getStatus</span>
    if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.tracing" title="Boolean">tracing</a><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(template: String, arg1: Any)Unit">debug</span><span class="delimiter">(</span><span title="String(&quot;## Decrypting {}&quot;)" class="string">&quot;## Decrypting {}&quot;</span>, <a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.rs" title="javax.net.ssl.SSLEngineResult.Status">rs</a><span class="delimiter">)</span>
    val <a title="javax.net.ssl.SSLEngineResult.HandshakeStatus" id="akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.hs">hs</a> = <a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.result" title="javax.net.ssl.SSLEngineResult">result</a>.<span title="()javax.net.ssl.SSLEngineResult.HandshakeStatus">getHandshakeStatus</span>
    val <a title="akka.stream.impl.TransferPhase" id="akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.next">next</a> = <a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.rs" title="javax.net.ssl.SSLEngineResult.Status">rs</a> match <span class="delimiter">{</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(OK)">OK</span> â‡’
        if <span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.hs" title="javax.net.ssl.SSLEngineResult.HandshakeStatus">hs</a> <span title="(x$1: Any)Boolean">==</span> <span title="javax.net.ssl.SSLEngineResult.HandshakeStatus(NOT_HANDSHAKING)">NOT_HANDSHAKING</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#akka.stream.io;SslTlsCipherActor.writePlaintextInboundBytes" title="()Unit">writePlaintextInboundBytes</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#akka.stream.io;SslTlsCipherActor.engineRunningPhase" title="=&gt; akka.stream.impl.TransferPhase">engineRunningPhase</a>
        <span class="delimiter">}</span> else <a href="#akka.stream.io;SslTlsCipherActor.handshakePhase" title="(hs: javax.net.ssl.SSLEngineResult.HandshakeStatus)akka.stream.impl.TransferPhase">handshakePhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.hs" title="javax.net.ssl.SSLEngineResult.HandshakeStatus">hs</a><span class="delimiter">)</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(CLOSED)">CLOSED</span>           â‡’ if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#akka.stream.io;SslTlsCipherActor.engine" title="=&gt; javax.net.ssl.SSLEngine">engine</a>.<span title="()Boolean">isOutboundDone</span><span class="delimiter">)</span> <a href="#akka.stream.io;SslTlsCipherActor.encryptionPhase" title="=&gt; akka.stream.impl.TransferPhase">encryptionPhase</a> else <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.completedPhase" title="=&gt; akka.stream.impl.TransferPhase">completedPhase</a>
      case <span title="javax.net.ssl.SSLEngineResult.Status(BUFFER_OVERFLOW)">BUFFER_OVERFLOW</span>  â‡’ throw new <span title="IllegalStateException">IllegalStateException</span> <span class="comment">// the SslBufferPool should make sure that buffers are never too small</span>
      case <span title="javax.net.ssl.SSLEngineResult.Status(BUFFER_UNDERFLOW)">BUFFER_UNDERFLOW</span> â‡’ throw new <span title="IllegalStateException">IllegalStateException</span> <span class="comment">// should never appear as a result of a wrap</span>
    <span class="delimiter">}</span>
    <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.nextPhase" title="(phase: akka.stream.impl.TransferPhase)Unit">nextPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.decryptionPhase.$anonfun.next" title="akka.stream.impl.TransferPhase">next</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <a href="../impl/Transfer.scala.html#akka.stream.impl;Pump.nextPhase" title="(phase: akka.stream.impl.TransferPhase)Unit">nextPhase</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.waitForHandshakeStartPhase" title="=&gt; akka.stream.impl.TransferPhase">waitForHandshakeStartPhase</a><span class="delimiter">)</span>

  override def <a title="()Unit" id="akka.stream.io;SslTlsCipherActor.preStart">preStart</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="org.reactivestreams.Publisher[akka.stream.io.SslTlsCipher.InboundSession]" id="akka.stream.io;SslTlsCipherActor.preStart.plainTextInput">plainTextInput</a> = <a href="#akka.stream.io;SslTlsCipherActor.inboundSessionOutput" title="=&gt; akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">inboundSessionOutput</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="org.reactivestreams.Publisher[akka.stream.io.SslTlsCipher.InboundSession]" class="delimiter">[</span><span title="org.reactivestreams.Publisher[akka.stream.io.SslTlsCipher.InboundSession]">Publisher</span><span class="delimiter">[</span>SslTlsCipher.InboundSession<span class="delimiter">]</span><span class="delimiter">]</span>
    val <a title="akka.stream.impl.MultiStreamInputProcessor.SubstreamSubscriber[akka.util.ByteString]" id="akka.stream.io;SslTlsCipherActor.preStart.plainTextOutput">plainTextOutput</a> = new <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl.MultiStreamInputProcessor;SubstreamSubscriber" title="akka.stream.impl.MultiStreamInputProcessor.SubstreamSubscriber[akka.util.ByteString]">SubstreamSubscriber</a><span class="delimiter">[</span>ByteString<span class="delimiter">]</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.actor.ActorRef">self</a>, <a href="#akka.stream.io;SslTlsCipherActor.outboundPlaintextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">outboundPlaintextInput</a>.<a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl.MultiStreamInputProcessor;SubstreamInput.key" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamKey">key</a><span class="delimiter">)</span>
    val <a title="akka.stream.impl.MultiStreamInputProcessor.SubstreamSubscriber[akka.util.ByteString]" id="akka.stream.io;SslTlsCipherActor.preStart.cipherTextInput">cipherTextInput</a> = new <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl.MultiStreamInputProcessor;SubstreamSubscriber" title="akka.stream.impl.MultiStreamInputProcessor.SubstreamSubscriber[akka.util.ByteString]">SubstreamSubscriber</a><span class="delimiter">[</span>ByteString<span class="delimiter">]</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.actor.ActorRef">self</a>, <a href="#akka.stream.io;SslTlsCipherActor.inboundCipherTextInput" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamInput">inboundCipherTextInput</a>.<a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl.MultiStreamInputProcessor;SubstreamInput.key" title="=&gt; akka.stream.impl.MultiStreamInputProcessor.SubstreamKey">key</a><span class="delimiter">)</span>
    val <a title="org.reactivestreams.Publisher[akka.util.ByteString]" id="akka.stream.io;SslTlsCipherActor.preStart.cipherTextOutput">cipherTextOutput</a> = <a href="#akka.stream.io;SslTlsCipherActor.outboundCipherTextOutput" title="=&gt; akka.stream.impl.MultiStreamOutputProcessor.SubstreamOutput">outboundCipherTextOutput</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="org.reactivestreams.Publisher[akka.util.ByteString]" class="delimiter">[</span><span title="org.reactivestreams.Publisher[akka.util.ByteString]">Publisher</span><span class="delimiter">[</span>ByteString<span class="delimiter">]</span><span class="delimiter">]</span>
    <a href="#akka.stream.io;SslTlsCipherActor.requester" title="implicit akka.actor.package.actorRef2Scala : (ref: akka.actor.ActorRef)akka.actor.ScalaActorRef">requester</a> <a href="#akka.stream.io;SslTlsCipherActor" title="(message: Any)(implicit sender: akka.actor.ActorRef)Unit">!</a> <a href="#akka.stream.io;SslTlsCipher.equals" title="(sessionInbound: org.reactivestreams.Publisher[akka.stream.io.SslTlsCipher.InboundSession], plainTextOutbound: org.reactivestreams.Subscriber[akka.util.ByteString], cipherTextInbound: org.reactivestreams.Subscriber[akka.util.ByteString], cipherTextOutbound: org.reactivestreams.Publisher[akka.util.ByteString])akka.stream.io.SslTlsCipher">SslTlsCipher</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.preStart.plainTextInput" title="org.reactivestreams.Publisher[akka.stream.io.SslTlsCipher.InboundSession]">plainTextInput</a>, <a href="#akka.stream.io;SslTlsCipherActor.preStart.plainTextOutput" title="akka.stream.impl.MultiStreamInputProcessor.SubstreamSubscriber[akka.util.ByteString]">plainTextOutput</a>, <a href="#akka.stream.io;SslTlsCipherActor.preStart.cipherTextInput" title="akka.stream.impl.MultiStreamInputProcessor.SubstreamSubscriber[akka.util.ByteString]">cipherTextInput</a>, <a href="#akka.stream.io;SslTlsCipherActor.preStart.cipherTextOutput" title="org.reactivestreams.Publisher[akka.util.ByteString]">cipherTextOutput</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override def <a title="=&gt; PartialFunction[Any,Unit]" id="akka.stream.io;SslTlsCipherActor.receive">receive</a> = <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamInputProcessorLike.inputSubstreamManagement" title="=&gt; SslTlsCipherActor.this.Receive">inputSubstreamManagement</a> <span title="(that: PartialFunction[Any,Unit])PartialFunction[Any,Unit]">orElse</span> <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamOutputProcessorLike.outputSubstreamManagement" title="=&gt; SslTlsCipherActor.this.Receive">outputSubstreamManagement</a>

  protected def <a title="(e: Throwable)Unit" id="akka.stream.io;SslTlsCipherActor.fail">fail</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.io;SslTlsCipherActor.fail.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.event.LoggingAdapter">log</a>.<span title="(cause: Throwable, message: String)Unit">error</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.fail.e" title="Throwable">e</a>, <span title="String(&quot;failure during processing&quot;)" class="string">&quot;failure during processing&quot;</span><span class="delimiter">)</span> <span class="comment">// FIXME: escalate to supervisor instead</span>
    <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamInputProcessorLike.failInputs" title="(e: Throwable)Unit">failInputs</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.fail.e" title="Throwable">e</a><span class="delimiter">)</span>
    <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamOutputProcessorLike.failOutputs" title="(e: Throwable)Unit">failOutputs</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.fail.e" title="Throwable">e</a><span class="delimiter">)</span>
    <a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.actor.ActorContext">context</a>.<span title="(actor: akka.actor.ActorRef)Unit">stop</span><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor" title="=&gt; akka.actor.ActorRef">self</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  override protected def <a title="(e: Throwable)Unit" id="akka.stream.io;SslTlsCipherActor.pumpFailed">pumpFailed</a><span class="delimiter">(</span><a title="Throwable" id="akka.stream.io;SslTlsCipherActor.pumpFailed.e">e</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#akka.stream.io;SslTlsCipherActor.fail" title="(e: Throwable)Unit">fail</a><span class="delimiter">(</span><a href="#akka.stream.io;SslTlsCipherActor.pumpFailed.e" title="Throwable">e</a><span class="delimiter">)</span>

  override protected def <a title="()Unit" id="akka.stream.io;SslTlsCipherActor.pumpFinished">pumpFinished</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamInputProcessorLike.finishInputs" title="()Unit">finishInputs</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="../impl/StreamOfStreamProcessors.scala.html#akka.stream.impl;MultiStreamOutputProcessorLike.finishOutputs" title="()Unit">finishOutputs</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

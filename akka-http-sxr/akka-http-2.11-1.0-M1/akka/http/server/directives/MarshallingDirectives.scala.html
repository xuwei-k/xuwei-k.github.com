<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>akka/http/server/directives/MarshallingDirectives.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2009-2014 Typesafe Inc. &lt;http://www.typesafe.com&gt;
 */</span>

package akka.http.server
package directives

import scala.concurrent.Promise
import scala.util.<span class="delimiter">{</span> Failure, Success <span class="delimiter">}</span>
import akka.http.marshalling.ToResponseMarshaller
import akka.http.unmarshalling.<span class="delimiter">{</span> Unmarshaller, FromRequestUnmarshaller <span class="delimiter">}</span>
import akka.http.util._

trait <a title="trait MarshallingDirectives extends AnyRef" id="akka.http.server.directives;MarshallingDirectives">MarshallingDirectives</a> <span title="Unit" class="delimiter">{</span>
  import <a href="BasicDirectives.scala.html#akka.http.server.directives.BasicDirectives" title="akka.http.server.directives.BasicDirectives.type">BasicDirectives</a>._
  import <a href="FutureDirectives.scala.html#akka.http.server.directives.FutureDirectives" title="akka.http.server.directives.FutureDirectives.type">FutureDirectives</a>._
  import <a href="RouteDirectives.scala.html#akka.http.server.directives.RouteDirectives" title="akka.http.server.directives.RouteDirectives.type">RouteDirectives</a>._

  <span class="comment">/**
   * Unmarshalls the requests entity to the given type passes it to its inner Route.
   * If there is a problem with unmarshalling the request is rejected with the [[Rejection]]
   * produced by the unmarshaller.
   */</span>
  def <a title="[T](um: akka.http.unmarshalling.FromRequestUnmarshaller[T])akka.http.server.Directive1[T]" id="akka.http.server.directives;MarshallingDirectives.entity">entity</a><span class="delimiter">[</span><a title="" id="akka.http.server.directives;MarshallingDirectives.entity;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="akka.http.unmarshalling.FromRequestUnmarshaller[T]" id="akka.http.server.directives;MarshallingDirectives.entity.um">um</a>: <a href="../../unmarshalling/Unmarshaller.scala.html#akka.http.unmarshalling;Unmarshaller" title="akka.http.unmarshalling.FromRequestUnmarshaller[T]">FromRequestUnmarshaller</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../Directive.scala.html#akka.http.server;Directive" title="akka.http.server.Directive1[T]">Directive1</a><span class="delimiter">[</span>T<span class="delimiter">]</span> =
    <a href="../Directive.scala.html#akka.http.server.Directive.SingleValueModifiers" title="(underlying: akka.http.server.Directive1[akka.http.model.HttpRequest])akka.http.server.Directive.SingleValueModifiers[akka.http.model.HttpRequest]">extractRequest</a>.<a href="../Directive.scala.html#akka.http.server.Directive;SingleValueModifiers.flatMap" title="[R](f: akka.http.model.HttpRequest =&gt; akka.http.server.Directive[R])(implicit evidence$5: akka.http.server.util.Tuple[R])akka.http.server.Directive[R]">flatMap</a><span title="(f: akka.http.model.HttpRequest =&gt; akka.http.server.Directive[(T,)])(implicit evidence$5: akka.http.server.util.Tuple[(T,)])akka.http.server.Directive[(T,)]" class="delimiter">[</span><span title="(T,)">Tuple1</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> <a href="../util/Tuple.scala.html#akka.http.server.util.Tuple.forTuple1" title="akka.http.server.util.Tuple[(T,)]" class="delimiter">{</a> <a title="akka.http.model.HttpRequest" id="akka.http.server.directives;MarshallingDirectives.entity.$anonfun.request">request</a> ⇒
      <a href="FutureDirectives.scala.html#akka.http.server.directives;FutureDirectives.onComplete" title="(future: =&gt; scala.concurrent.Future[T])akka.http.server.Directive1[scala.util.Try[T]]">onComplete</a><a href="../Directive.scala.html#akka.http.server.Directive.SingleValueModifiers" title="(underlying: akka.http.server.Directive1[scala.util.Try[T]])akka.http.server.Directive.SingleValueModifiers[scala.util.Try[T]]" class="delimiter">(</a><a href="#akka.http.server.directives;MarshallingDirectives.entity.um" title="(v1: akka.http.model.HttpRequest)scala.concurrent.Future[T]">um</a><span class="delimiter">(</span><a href="#akka.http.server.directives;MarshallingDirectives.entity.$anonfun.request" title="akka.http.model.HttpRequest">request</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../Directive.scala.html#akka.http.server.Directive;SingleValueModifiers.flatMap" title="(f: scala.util.Try[T] =&gt; akka.http.server.Directive[(T,)])(implicit evidence$5: akka.http.server.util.Tuple[(T,)])akka.http.server.Directive[(T,)]">flatMap</a> <a href="#akka.http.server.directives;MarshallingDirectives.entity.$anonfun.$anonfun.x0$1" title="akka.http.server.Directive[(T,)]" class="delimiter">{</a>
        case Success<span class="delimiter">(</span><a title="T" id="akka.http.server.directives;MarshallingDirectives.entity.$anonfun.$anonfun.value">value</a><span class="delimiter">)</span> ⇒ <a href="BasicDirectives.scala.html#akka.http.server.directives;BasicDirectives.provide" title="(value: T)akka.http.server.Directive1[T]">provide</a><span class="delimiter">(</span><a href="#akka.http.server.directives;MarshallingDirectives.entity.$anonfun.$anonfun.value" title="T">value</a><span class="delimiter">)</span>
        case Failure<span class="delimiter">(</span><a href="../../unmarshalling/Unmarshaller.scala.html#akka.http.unmarshalling.Unmarshaller" title="akka.http.unmarshalling.Unmarshaller.type">Unmarshaller</a>.<a href="../../unmarshalling/Unmarshaller.scala.html#akka.http.unmarshalling.Unmarshaller.NoContentException" title="akka.http.unmarshalling.Unmarshaller.NoContentException.type">NoContentException</a><span class="delimiter">)</span> ⇒ <a href="RouteDirectives.scala.html#akka.http.server.directives;RouteDirectives.reject(6cf95b673e)" title="(rejections: akka.http.server.Rejection*)akka.http.server.StandardRoute">reject</a><a href="../StandardRoute.scala.html#akka.http.server.StandardRoute.toDirective" title="(route: akka.http.server.StandardRoute)(implicit evidence$2: akka.http.server.util.Tuple[(T,)])akka.http.server.Directive[(T,)]" class="delimiter">(</a><a href="../Rejection.scala.html#akka.http.server.RequestEntityExpectedRejection" title="akka.http.server.RequestEntityExpectedRejection.type">RequestEntityExpectedRejection</a><span class="delimiter">)</span>
        case Failure<span class="delimiter">(</span>Unmarshaller.UnsupportedContentTypeException<span class="delimiter">(</span><span title="Set[akka.http.model.ContentTypeRange]">x</span><span class="delimiter">)</span><span class="delimiter">)</span> ⇒ <a href="RouteDirectives.scala.html#akka.http.server.directives;RouteDirectives.reject(6cf95b673e)" title="(rejections: akka.http.server.Rejection*)akka.http.server.StandardRoute">reject</a><a href="../StandardRoute.scala.html#akka.http.server.StandardRoute.toDirective" title="(route: akka.http.server.StandardRoute)(implicit evidence$2: akka.http.server.util.Tuple[(T,)])akka.http.server.Directive[(T,)]" class="delimiter">(</a><a href="../Rejection.scala.html#akka.http.server;UnsupportedRequestContentTypeRejection" title="(supported: Set[akka.http.model.ContentTypeRange])akka.http.server.UnsupportedRequestContentTypeRejection">UnsupportedRequestContentTypeRejection</a><span class="delimiter">(</span><span title="Set[akka.http.model.ContentTypeRange]">x</span><span class="delimiter">)</span><span class="delimiter">)</span>
        case Failure<span class="delimiter">(</span><span title="Throwable">x</span><span class="delimiter">)</span> ⇒ <a href="RouteDirectives.scala.html#akka.http.server.directives;RouteDirectives.reject(6cf95b673e)" title="(rejections: akka.http.server.Rejection*)akka.http.server.StandardRoute">reject</a><a href="../StandardRoute.scala.html#akka.http.server.StandardRoute.toDirective" title="(route: akka.http.server.StandardRoute)(implicit evidence$2: akka.http.server.util.Tuple[(T,)])akka.http.server.Directive[(T,)]" class="delimiter">(</a><a href="../Rejection.scala.html#akka.http.server;MalformedRequestContentRejection" title="(message: String, cause: Option[Throwable])akka.http.server.MalformedRequestContentRejection">MalformedRequestContentRejection</a><span class="delimiter">(</span><span title="Throwable">x</span>.<a href="../../util/package.scala.html#akka.http.util.package.enhanceString_" title="implicit akka.http.util.package.enhanceString_ : (s: String)akka.http.util.EnhancedString">getMessage</a>.<a href="../../util/EnhancedString.scala.html#akka.http.util;EnhancedString.nullAsEmpty" title="=&gt; String">nullAsEmpty</a>, <span title="(x: Throwable)Option[Throwable]">Option</span><span class="delimiter">(</span><span title="Throwable">x</span>.<span title="()Throwable">getCause</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <a href="../Directive.scala.html#akka.http.server;Directive.&" title="(magnet: akka.http.server.ConjunctionMagnet[(T,)])magnet.Out">&amp;</a> <a href="BasicDirectives.scala.html#akka.http.server.directives;BasicDirectives.cancelRejections(9c5c1ec5cc)" title="(classes: Class[_]*)akka.http.server.Directive0">cancelRejections</a><a href="../Directive.scala.html#akka.http.server.ConjunctionMagnet.fromDirective" title="(other: akka.http.server.Directive[Unit])(implicit join: akka.http.server.util.TupleOps.Join[(T,),Unit])akka.http.server.ConjunctionMagnet[(T,)]{type Out = akka.http.server.Directive[join.Out]}" class="delimiter">(</a><a href="../Rejection.scala.html#akka.http.server.RequestEntityExpectedRejection" title="akka.http.server.RequestEntityExpectedRejection.type">RequestEntityExpectedRejection</a>.<span title="()Class[_]">getClass</span>, classOf<span title="Class[akka.http.server.UnsupportedRequestContentTypeRejection](classOf[akka.http.server.UnsupportedRequestContentTypeRejection])" class="delimiter">[</span>UnsupportedRequestContentTypeRejection<span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns the in-scope [[FromRequestUnmarshaller]] for the given type.
   */</span>
  def <a title="[T](implicit um: akka.http.unmarshalling.FromRequestUnmarshaller[T])akka.http.unmarshalling.FromRequestUnmarshaller[T]" id="akka.http.server.directives;MarshallingDirectives.as">as</a><span class="delimiter">[</span><a title="" id="akka.http.server.directives;MarshallingDirectives.as;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span>implicit <a title="akka.http.unmarshalling.FromRequestUnmarshaller[T]" id="akka.http.server.directives;MarshallingDirectives.as.um">um</a>: <a href="../../unmarshalling/Unmarshaller.scala.html#akka.http.unmarshalling;Unmarshaller" title="akka.http.unmarshalling.FromRequestUnmarshaller[T]">FromRequestUnmarshaller</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#akka.http.server.directives;MarshallingDirectives.as.um" title="akka.http.unmarshalling.FromRequestUnmarshaller[T]">um</a>

  <span class="comment">/**
   * Uses the marshaller for the given type to produce a completion function that is passed to its inner function.
   * You can use it do decouple marshaller resolution from request completion.
   */</span>
  def <a title="[T](marshaller: akka.http.marshalling.ToResponseMarshaller[T])(inner: (T =&gt; Unit) =&gt; Unit)akka.http.server.Route" id="akka.http.server.directives;MarshallingDirectives.completeWith">completeWith</a><span class="delimiter">[</span><a title="" id="akka.http.server.directives;MarshallingDirectives.completeWith;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="akka.http.marshalling.ToResponseMarshaller[T]" id="akka.http.server.directives;MarshallingDirectives.completeWith.marshaller">marshaller</a>: <a href="../../marshalling/Marshaller.scala.html#akka.http.marshalling;Marshaller" title="akka.http.marshalling.ToResponseMarshaller[T]">ToResponseMarshaller</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="(T =&gt; Unit) =&gt; Unit" id="akka.http.server.directives;MarshallingDirectives.completeWith.inner">inner</a>: <span class="delimiter">(</span>T ⇒ Unit<span class="delimiter">)</span> ⇒ Unit<span class="delimiter">)</span>: <span title="akka.http.server.Route">Route</span> = <span class="delimiter">{</span> <a title="akka.http.server.RequestContext" id="akka.http.server.directives;MarshallingDirectives.completeWith.$anonfun.ctx">ctx</a> ⇒
    import <a href="#akka.http.server.directives;MarshallingDirectives.completeWith.$anonfun.ctx" title="akka.http.server.RequestContext">ctx</a>.executionContext
    implicit val <a title="akka.http.marshalling.ToResponseMarshaller[T]" id="akka.http.server.directives;MarshallingDirectives.completeWith.$anonfun.m">m</a> = <a href="#akka.http.server.directives;MarshallingDirectives.completeWith.marshaller" title="akka.http.marshalling.ToResponseMarshaller[T]">marshaller</a>
    val <a title="scala.concurrent.Promise[T]" id="akka.http.server.directives;MarshallingDirectives.completeWith.$anonfun.promise">promise</a> = <span title="[T]()scala.concurrent.Promise[T]">Promise</span><span title="()scala.concurrent.Promise[T]" class="delimiter">[</span><a href="#akka.http.server.directives;MarshallingDirectives.completeWith;T" title="T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#akka.http.server.directives;MarshallingDirectives.completeWith.inner" title="(v1: T =&gt; Unit)Unit">inner</a><span class="delimiter">(</span><a href="#akka.http.server.directives;MarshallingDirectives.completeWith.$anonfun.promise" title="scala.concurrent.Promise[T]">promise</a>.<span title="(value: T)promise.type">success</span><span title="Unit" class="delimiter">(</span><a href="#akka.http.server.directives;MarshallingDirectives.completeWith.$anonfun.$anonfun.x$1" title="T">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#akka.http.server.directives;MarshallingDirectives.completeWith.$anonfun.ctx" title="akka.http.server.RequestContext">ctx</a>.<a href="../RequestContext.scala.html#akka.http.server;RequestContext.complete" title="(obj: akka.http.marshalling.ToResponseMarshallable)scala.concurrent.Future[akka.http.server.RouteResult]">complete</a><span class="delimiter">(</span><a href="#akka.http.server.directives;MarshallingDirectives.completeWith.$anonfun.promise" title="scala.concurrent.Promise[T]">promise</a>.<a href="../../marshalling/ToResponseMarshallable.scala.html#akka.http.marshalling.ToResponseMarshallable.apply" title="(_value: scala.concurrent.Future[T])(implicit _marshaller: akka.http.marshalling.ToResponseMarshaller[scala.concurrent.Future[T]])akka.http.marshalling.ToResponseMarshallable">future</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the in-scope Marshaller for the given type.
   */</span>
  def <a title="[T](implicit m: akka.http.marshalling.ToResponseMarshaller[T])akka.http.marshalling.ToResponseMarshaller[T]" id="akka.http.server.directives;MarshallingDirectives.instanceOf">instanceOf</a><span class="delimiter">[</span><a title="" id="akka.http.server.directives;MarshallingDirectives.instanceOf;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span>implicit <a title="akka.http.marshalling.ToResponseMarshaller[T]" id="akka.http.server.directives;MarshallingDirectives.instanceOf.m">m</a>: <a href="../../marshalling/Marshaller.scala.html#akka.http.marshalling;Marshaller" title="akka.http.marshalling.ToResponseMarshaller[T]">ToResponseMarshaller</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../marshalling/Marshaller.scala.html#akka.http.marshalling;Marshaller" title="akka.http.marshalling.ToResponseMarshaller[T]">ToResponseMarshaller</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <a href="#akka.http.server.directives;MarshallingDirectives.instanceOf.m" title="akka.http.marshalling.ToResponseMarshaller[T]">m</a>

  <span class="comment">/**
   * Completes the request using the given function. The input to the function is produced with the in-scope
   * entity unmarshaller and the result value of the function is marshalled with the in-scope marshaller.
   */</span>
  def <a title="[A, B](f: A =&gt; B)(implicit um: akka.http.unmarshalling.FromRequestUnmarshaller[A], implicit m: akka.http.marshalling.ToResponseMarshaller[B])akka.http.server.Route" id="akka.http.server.directives;MarshallingDirectives.handleWith">handleWith</a><span class="delimiter">[</span><a title="" id="akka.http.server.directives;MarshallingDirectives.handleWith;A">A</a>, <a title="" id="akka.http.server.directives;MarshallingDirectives.handleWith;B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; B" id="akka.http.server.directives;MarshallingDirectives.handleWith.f">f</a>: A ⇒ B<span class="delimiter">)</span><span class="delimiter">(</span>implicit <a title="akka.http.unmarshalling.FromRequestUnmarshaller[A]" id="akka.http.server.directives;MarshallingDirectives.handleWith.um">um</a>: <a href="../../unmarshalling/Unmarshaller.scala.html#akka.http.unmarshalling;Unmarshaller" title="akka.http.unmarshalling.FromRequestUnmarshaller[A]">FromRequestUnmarshaller</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="akka.http.marshalling.ToResponseMarshaller[B]" id="akka.http.server.directives;MarshallingDirectives.handleWith.m">m</a>: <a href="../../marshalling/Marshaller.scala.html#akka.http.marshalling;Marshaller" title="akka.http.marshalling.ToResponseMarshaller[B]">ToResponseMarshaller</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="akka.http.server.Route">Route</span> =
    <a href="#akka.http.server.directives;MarshallingDirectives.entity" title="(um: akka.http.unmarshalling.FromRequestUnmarshaller[A])akka.http.server.Directive1[A]">entity</a><a href="../Directive.scala.html#akka.http.server.Directive.addDirectiveApply" title="(v1: A =&gt; (akka.http.server.RequestContext =&gt; scala.concurrent.Future[akka.http.server.RouteResult]))akka.http.server.RequestContext =&gt; scala.concurrent.Future[akka.http.server.RouteResult]" class="delimiter">(</a><a href="#akka.http.server.directives;MarshallingDirectives.handleWith.um" title="akka.http.unmarshalling.FromRequestUnmarshaller[A]">um</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="A" id="akka.http.server.directives;MarshallingDirectives.handleWith.$anonfun.a">a</a> ⇒ <a href="RouteDirectives.scala.html#akka.http.server.directives;RouteDirectives.complete" title="(m: =&gt; akka.http.marshalling.ToResponseMarshallable)akka.http.server.StandardRoute">complete</a><span class="delimiter">(</span><a href="#akka.http.server.directives;MarshallingDirectives.handleWith.f" title="(v1: A)B">f</a><a href="../../marshalling/ToResponseMarshallable.scala.html#akka.http.marshalling.ToResponseMarshallable.apply" title="(_value: B)(implicit _marshaller: akka.http.marshalling.ToResponseMarshaller[B])akka.http.marshalling.ToResponseMarshallable" class="delimiter">(</a><a href="#akka.http.server.directives;MarshallingDirectives.handleWith.$anonfun.a" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span>
<span class="delimiter">}</span>

object <a title="akka.http.server.directives.MarshallingDirectives.type" id="akka.http.server.directives.MarshallingDirectives">MarshallingDirectives</a> extends <a href="#akka.http.server.directives;MarshallingDirectives" title="akka.http.server.directives.MarshallingDirectives">MarshallingDirectives</a>

        </pre>
    </body>
</html>

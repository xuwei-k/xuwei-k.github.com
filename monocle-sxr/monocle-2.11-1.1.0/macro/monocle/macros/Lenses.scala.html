<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>macro/monocle/macros/Lenses.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
package monocle.macros

import monocle.macros.internal.MacrosCompatibility

class <a title="class Lenses extends scala.annotation.Annotation with scala.annotation.StaticAnnotation" id="monocle.macros.Lenses">Lenses</a><a href="#monocle.macros.Lenses" title="monocle.macros.Lenses" class="delimiter">(</a><a title="String" id="monocle.macros.Lenses.<init>$default$1">prefix</a>: <span title="String">String</span> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> extends scala.annotation.<a href="#monocle.macros.Lenses" title="scala.annotation.StaticAnnotation">StaticAnnotation</a> <span class="delimiter">{</span>
  def <a title="(annottees: Any*)Any" id="monocle.macros;Lenses.macroTransform">macroTransform</a><span class="delimiter">(</span><a title="Any*" id="monocle.macros;Lenses.macroTransform.annottees">annottees</a>: <span title="Any*">Any</span>*<span class="delimiter">)</span>: <span title="Any">Any</span> = macro <a href="#monocle.macros.LensesImpl" title="monocle.macros.LensesImpl.type">LensesImpl</a>.<a href="#monocle.macros.LensesImpl.annotationMacro" title="(c: monocle.macros.LensesImpl.Context)(annottees: c.Expr[Any]*)c.Expr[Any]">annotationMacro</a>
<span class="delimiter">}</span>

private<span class="delimiter">[</span>macros<span class="delimiter">]</span> object <a title="monocle.macros.LensesImpl.type" id="monocle.macros.LensesImpl">LensesImpl</a> extends <a href="../../monocle.macros.internal/MacrosCompatibility.scala.html#monocle.macros.internal;MacrosCompatibility" title="monocle.macros.internal.MacrosCompatibility">MacrosCompatibility</a> <span class="delimiter">{</span>

  def <a title="(c: monocle.macros.LensesImpl.Context)(annottees: c.Expr[Any]*)c.Expr[Any]" id="monocle.macros.LensesImpl.annotationMacro">annotationMacro</a><span class="delimiter">(</span><a title="monocle.macros.LensesImpl.Context" id="monocle.macros.LensesImpl.annotationMacro.c">c</a>: <span title="monocle.macros.LensesImpl.Context">Context</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="c.Expr[Any]*" id="monocle.macros.LensesImpl.annotationMacro.annottees">annottees</a>: c.<span title="c.Expr[Any]*">Expr</span><span class="delimiter">[</span>Any<span class="delimiter">]</span>*<span class="delimiter">)</span>: c.<span title="c.Expr[Any]">Expr</span><span class="delimiter">[</span>Any<span class="delimiter">]</span> = <span class="delimiter">{</span>
    import <a href="#monocle.macros.LensesImpl.annotationMacro.c" title="monocle.macros.LensesImpl.Context">c</a>.<span title="=&gt; scala.reflect.macros.Universe">universe</span>._

    val <a title="c.universe.TypeName" id="monocle.macros.LensesImpl.annotationMacro.LensesTpe">LensesTpe</a> = <a href="../../monocle.macros.internal/MacrosCompatibility.scala.html#monocle.macros.internal;MacrosCompatibility.createTypeName" title="(c: monocle.macros.LensesImpl.Context)(name: String)c.universe.TypeName">createTypeName</a><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="monocle.macros.LensesImpl.Context">c</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="String(&quot;Lenses&quot;)" class="string">&quot;Lenses&quot;</span><span class="delimiter">)</span>
    val <a title="String" id="monocle.macros.LensesImpl.annotationMacro.prefix">prefix</a> = <a href="#monocle.macros.LensesImpl.annotationMacro.c" title="monocle.macros.LensesImpl.Context">c</a>.<span title="=&gt; c.Tree">macroApplication</span> match <span class="delimiter">{</span>
      case <a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(x: Any)Option[c.universe.Apply]">Apply</a><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(x: Any)Option[c.universe.Select]">Select</a><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(x: Any)Option[c.universe.Apply]">Apply</a><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(x: Any)Option[c.universe.Select]">Select</a><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(x: Any)Option[c.universe.New]">New</a><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(x: Any)Option[c.universe.Ident]">Ident</a><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.LensesTpe" title="c.universe.TypeName">LensesTpe</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a title="c.universe.Name" id="monocle.macros.LensesImpl.annotationMacro.prefix.t">t</a><span class="delimiter">)</span>, <a title="List[c.universe.Tree]" id="monocle.macros.LensesImpl.annotationMacro.prefix.args">args</a><span class="delimiter">)</span>, _<span class="delimiter">)</span>, _<span class="delimiter">)</span> if <a href="#monocle.macros.LensesImpl.annotationMacro.prefix.t" title="c.universe.Name">t</a> <span title="(x$1: Any)Boolean">==</span> <a href="../../monocle.macros.internal/MacrosCompatibility.scala.html#monocle.macros.internal;MacrosCompatibility.getTermNames" title="(c: monocle.macros.LensesImpl.Context)c.universe.TermNamesApi">getTermNames</a><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="monocle.macros.LensesImpl.Context">c</a><span class="delimiter">)</span>.<span title="=&gt; c.universe.TermName">CONSTRUCTOR</span> =&gt; <a href="#monocle.macros.LensesImpl.annotationMacro.prefix.args" title="List[c.universe.Tree]">args</a> match <span class="delimiter">{</span>
        case <a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(x: Any)Option[c.universe.Literal]">Literal</a><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(x: Any)Option[c.universe.Constant]">Constant</a><span class="delimiter">(</span><a title="String" id="monocle.macros.LensesImpl.annotationMacro.prefix.s">s</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">)</span> :: <span title="scala.collection.immutable.Nil.type">Nil</span> =&gt; <a href="#monocle.macros.LensesImpl.annotationMacro.prefix.s" title="String">s</a>
        case _ =&gt; <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <span class="delimiter">}</span>
      case _ =&gt; <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="delimiter">}</span>

    def <a title="(tpname: c.universe.TypeName, tparams: List[c.universe.TypeDef], paramss: List[List[c.universe.ValDef]])List[c.universe.Tree]" id="monocle.macros.LensesImpl.annotationMacro.lenses">lenses</a><span class="delimiter">(</span><a title="c.universe.TypeName" id="monocle.macros.LensesImpl.annotationMacro.lenses.tpname">tpname</a>: <span title="c.universe.TypeName">TypeName</span>, <a title="List[c.universe.TypeDef]" id="monocle.macros.LensesImpl.annotationMacro.lenses.tparams">tparams</a>: <span title="List[c.universe.TypeDef]">List</span><span class="delimiter">[</span>TypeDef<span class="delimiter">]</span>, <a title="List[List[c.universe.ValDef]]" id="monocle.macros.LensesImpl.annotationMacro.lenses.paramss">paramss</a>: <span title="List[List[c.universe.ValDef]]">List</span><span class="delimiter">[</span>List<span class="delimiter">[</span>ValDef<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[c.universe.Tree]">List</span><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#monocle.macros.LensesImpl.annotationMacro.lenses.paramss" title="List[List[c.universe.ValDef]]">paramss</a>.<span title="=&gt; List[c.universe.ValDef]">head</span> <span title="(f: c.universe.ValDef =&gt; c.universe.ValOrDefDef with c.universe.ValOrDefDefApi with c.universe.MemberDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[c.universe.ValDef],c.universe.ValOrDefDef with c.universe.ValOrDefDefApi with c.universe.MemberDef,List[c.universe.Tree]])List[c.universe.Tree]">map</span> <span class="delimiter">{</span> <a title="c.universe.ValDef" id="monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.param">param</a> =&gt;
        val <a title="c.universe.TermName" id="monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.lensName">lensName</a> = <a href="../../monocle.macros.internal/MacrosCompatibility.scala.html#monocle.macros.internal;MacrosCompatibility.createTermName" title="(c: monocle.macros.LensesImpl.Context)(name: String)c.universe.TermName">createTermName</a><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="monocle.macros.LensesImpl.Context">c</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.prefix" title="String">prefix</a> <span title="(x$1: Any)String">+</span> <a href="#monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.param" title="c.universe.ValDef">param</a>.<span title="=&gt; c.universe.TermName">name</span>.<span title="=&gt; c.universe.Name">decodedName</span><span class="delimiter">)</span>
        if <span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.lenses.tparams" title="List[c.universe.TypeDef]">tparams</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
          <a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(mods: c.universe.Modifiers, name: c.universe.TermName, tpt: c.universe.Tree, rhs: c.universe.Tree)c.universe.ValDef">q</a>&quot;&quot;&quot;val $<a href="#monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.lensName" title="c.universe.TermName">lensName</a> = monocle.macros.internal.Macro.mkLens[$<a href="#monocle.macros.LensesImpl.annotationMacro.lenses.tpname" title="c.universe.TypeName">tpname</a>, $<span class="delimiter">{</span><a href="#monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.param" title="c.universe.ValDef">param</a>.<span title="=&gt; c.universe.Tree">tpt</span><span class="delimiter">}</span>]($<span class="delimiter">{</span><a href="#monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.param" title="c.universe.ValDef">param</a>.<span title="=&gt; c.universe.TermName">name</span>.<span title="()String">toString</span><span class="delimiter">}</span><span class="string">)&quot;&quot;&quot;</span>
        else
          <a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(mods: c.universe.Modifiers, name: c.universe.TermName, tparams: List[c.universe.Tree], vparamss: List[List[c.universe.Tree]], tpt: c.universe.Tree, rhs: c.universe.Tree)c.universe.DefDef" id="monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.$anonfun.fresh$macro$43">q</a>&quot;&quot;&quot;def $<a href="#monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.lensName" title="c.universe.TermName">lensName</a>[..$<a href="#monocle.macros.LensesImpl.annotationMacro.lenses.tparams" title="List[c.universe.TypeDef]">tparams</a>] = 
                 monocle.macros.internal.Macro.mkLens[$<a href="#monocle.macros.LensesImpl.annotationMacro.lenses.tpname" title="c.universe.TypeName">tpname</a>[..$<span class="delimiter">{</span><a href="#monocle.macros.LensesImpl.annotationMacro.lenses.tparams" title="List[c.universe.TypeDef]">tparams</a>.<span title="(f: c.universe.TypeDef =&gt; c.universe.TypeName)(implicit bf: scala.collection.generic.CanBuildFrom[List[c.universe.TypeDef],c.universe.TypeName,List[c.universe.TypeName]])List[c.universe.TypeName]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,c.universe.TypeName,List[c.universe.TypeName]]" class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.$anonfun.x$1" title="c.universe.TypeDef">_</a>.<span title="=&gt; c.universe.TypeName">name</span><span class="delimiter">)</span><span class="delimiter">}</span>], $<span class="delimiter">{</span><a href="#monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.param" title="c.universe.ValDef">param</a>.<span title="=&gt; c.universe.Tree">tpt</span><span class="delimiter">}</span>]($<span class="delimiter">{</span><a href="#monocle.macros.LensesImpl.annotationMacro.lenses.$anonfun.param" title="c.universe.ValDef">param</a>.<span title="=&gt; c.universe.TermName">name</span>.<span title="()String">toString</span><span class="delimiter">}</span><span class="string">)&quot;&quot;&quot;</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    val <a title="c.universe.Tree" id="monocle.macros.LensesImpl.annotationMacro.result">result</a> = <a href="#monocle.macros.LensesImpl.annotationMacro.annottees" title="c.Expr[Any]*">annottees</a> <span title="(f: c.Expr[Any] =&gt; c.universe.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[c.Expr[Any]],c.universe.Tree,Seq[c.universe.Tree]])Seq[c.universe.Tree]">map</span> <span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.result.$anonfun.x$2" title="c.Expr[Any]">_</a>.<span title="=&gt; c.universe.Tree">tree</span><span class="delimiter">)</span> match <span class="delimiter">{</span>
      case <span class="delimiter">(</span><span title="c.universe.Tree">classDef</span> @ <a title="(val tree: Any)Option[(c.universe.Modifiers, c.universe.TypeName, List[c.universe.TypeDef], c.universe.Modifiers, List[List[c.universe.ValDef]], List[c.universe.Tree], List[c.universe.Tree], c.universe.ValDef, List[c.universe.Tree])]" id="monocle.macros.LensesImpl.annotationMacro.result;$anon.unapply.qq$dbf889e8$macro$54">q</a>&quot;$<span title="c.universe.Modifiers">mods</span> class $<span title="c.universe.TypeName">tpname</span>[..$<span title="List[c.universe.TypeDef]">tparams</span>] $<span title="c.universe.Modifiers">ctorMods</span>(...$<span title="List[List[c.universe.ValDef]]">paramss</span>) extends { ..$<span title="List[c.universe.Tree]">earlydefns</span> } with ..$<span title="List[c.universe.Tree]">parents</span> { $<span title="c.universe.ValDef">self</span> =&gt; ..$<span title="List[c.universe.Tree]">stats</span><span class="string"> }&quot;</span><span class="delimiter">)</span>
        :: <span title="scala.collection.immutable.Nil.type">Nil</span> if <span title="c.universe.Modifiers">mods</span>.<span title="(flag: c.universe.FlagSet)Boolean">hasFlag</span><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="=&gt; c.universe.FlagValues">Flag</a>.<span title="=&gt; c.universe.FlagSet">CASE</span><span class="delimiter">)</span> =&gt;
        val <a title="c.universe.TermName" id="monocle.macros.LensesImpl.annotationMacro.result.name">name</a> = <span title="c.universe.TypeName">tpname</span>.<span title="=&gt; c.universe.TermName">toTermName</span>
        <a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(stats: List[c.universe.Tree])c.universe.Tree">q</a>&quot;&quot;&quot;
         $<span title="c.universe.Tree">classDef</span>
         object $<a href="#monocle.macros.LensesImpl.annotationMacro.result.name" title="c.universe.TermName">name</a> {
           ..$<span class="delimiter">{</span><a href="#monocle.macros.LensesImpl.annotationMacro.lenses" title="(tpname: c.universe.TypeName, tparams: List[c.universe.TypeDef], paramss: List[List[c.universe.ValDef]])List[c.universe.Tree]">lenses</a><span class="delimiter">(</span><span title="c.universe.TypeName">tpname</span>, <span title="List[c.universe.TypeDef]">tparams</span>, <span title="List[List[c.universe.ValDef]]">paramss</span><span class="delimiter">)</span><span class="delimiter">}</span><span class="string">
         }
         &quot;&quot;&quot;</span>
      case <span class="delimiter">(</span><span title="c.universe.Tree">classDef</span> @ <a title="(val tree: Any)Option[(c.universe.Modifiers, c.universe.TypeName, List[c.universe.TypeDef], c.universe.Modifiers, List[List[c.universe.ValDef]], List[c.universe.Tree], List[c.universe.Tree], c.universe.ValDef, List[c.universe.Tree])]" id="monocle.macros.LensesImpl.annotationMacro.result;$anon.unapply.qq$5ffffde2$macro$66">q</a>&quot;$<span title="c.universe.Modifiers">mods</span> class $<span title="c.universe.TypeName">tpname</span>[..$<span title="List[c.universe.TypeDef]">tparams</span>] $<span title="c.universe.Modifiers">ctorMods</span>(...$<span title="List[List[c.universe.ValDef]]">paramss</span>) extends { ..$<span title="List[c.universe.Tree]">earlydefns</span> } with ..$<span title="List[c.universe.Tree]">parents</span> { $<span title="c.universe.ValDef">self</span> =&gt; ..$<span title="List[c.universe.Tree]">stats</span><span class="string"> }&quot;</span><span class="delimiter">)</span>
        :: <a title="(val tree: Any)Option[(c.universe.TermName, List[c.universe.Tree])]" id="monocle.macros.LensesImpl.annotationMacro.result;$anon.unapply.qq$d9cc9a7a$macro$68">q</a>&quot;object $<a title="c.universe.TermName" id="monocle.macros.LensesImpl.annotationMacro.result.objName">objName</a> {..$<a title="List[c.universe.Tree]" id="monocle.macros.LensesImpl.annotationMacro.result.objDefs">objDefs</a><span class="string">}&quot;</span>
        :: <span title="scala.collection.immutable.Nil.type">Nil</span> if <span title="c.universe.Modifiers">mods</span>.<span title="(flag: c.universe.FlagSet)Boolean">hasFlag</span><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="=&gt; c.universe.FlagValues">Flag</a>.<span title="=&gt; c.universe.FlagSet">CASE</span><span class="delimiter">)</span> =&gt;
        <a href="#monocle.macros.LensesImpl.annotationMacro.c" title="(stats: List[c.universe.Tree])c.universe.Tree">q</a>&quot;&quot;&quot;
         $<span title="c.universe.Tree">classDef</span>
         object $<a href="#monocle.macros.LensesImpl.annotationMacro.result.objName" title="c.universe.TermName">objName</a> {
           ..$<span class="delimiter">{</span><a href="#monocle.macros.LensesImpl.annotationMacro.lenses" title="(tpname: c.universe.TypeName, tparams: List[c.universe.TypeDef], paramss: List[List[c.universe.ValDef]])List[c.universe.Tree]">lenses</a><span class="delimiter">(</span><span title="c.universe.TypeName">tpname</span>, <span title="List[c.universe.TypeDef]">tparams</span>, <span title="List[List[c.universe.ValDef]]">paramss</span><span class="delimiter">)</span><span class="delimiter">}</span>
           ..$<a href="#monocle.macros.LensesImpl.annotationMacro.result.objDefs" title="List[c.universe.Tree]">objDefs</a><span class="string">
         }
         &quot;&quot;&quot;</span>
      case _ =&gt; <a href="#monocle.macros.LensesImpl.annotationMacro.c" title="monocle.macros.LensesImpl.Context">c</a>.<span title="(pos: c.Position, msg: String)Nothing">abort</span><span class="delimiter">(</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="monocle.macros.LensesImpl.Context">c</a>.<span title="=&gt; c.Position">enclosingPosition</span>, <span title="String(&quot;Invalid annotation target: must be a case class&quot;)" class="string">&quot;Invalid annotation target: must be a case class&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="#monocle.macros.LensesImpl.annotationMacro.c" title="monocle.macros.LensesImpl.Context">c</a>.<span title="[T](tree: c.Tree)(implicit evidence$1: c.WeakTypeTag[T])c.Expr[T]">Expr</span><span title="(tree: c.Tree)(implicit evidence$1: c.WeakTypeTag[Any])c.Expr[Any]" class="delimiter">[</span><span title="Any">Any</span><span class="delimiter">]</span><a href="#monocle.macros.LensesImpl.annotationMacro.c" title="=&gt; c.universe.WeakTypeTag[Any]" class="delimiter">(</a><a href="#monocle.macros.LensesImpl.annotationMacro.result" title="c.universe.Tree">result</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

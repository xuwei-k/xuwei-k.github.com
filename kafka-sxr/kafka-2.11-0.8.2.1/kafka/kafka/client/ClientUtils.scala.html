<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>kafka/kafka/client/ClientUtils.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 * 
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>
 package kafka.client

import scala.collection._
import kafka.cluster._
import kafka.api._
import kafka.producer._
import kafka.common.<span class="delimiter">{</span>ErrorMapping, KafkaException<span class="delimiter">}</span>
import kafka.utils.<span class="delimiter">{</span>Utils, Logging<span class="delimiter">}</span>
import java.util.Properties
import util.Random
 import kafka.network.BlockingChannel
 import kafka.utils.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>._
 import org.I0Itec.zkclient.ZkClient
 import java.io.IOException
import org.apache.kafka.common.utils.<span title="org.apache.kafka.common.utils.Utils.type">Utils</span>.<span class="delimiter">{</span>getHost, getPort<span class="delimiter">}</span>

 <span class="comment">/**
 * Helper functions common to clients (producer, consumer, or admin)
 */</span>
object <a title="kafka.client.ClientUtils.type" id="kafka.client.ClientUtils">ClientUtils</a> extends <a href="../utils/Logging.scala.html#kafka.utils;Logging" title="kafka.utils.Logging">Logging</a><span class="delimiter">{</span>

  <span class="comment">/**
   * Used by the producer to send a metadata request since it has access to the ProducerConfig
   * @param topics The topics for which the metadata needs to be fetched
   * @param brokers The brokers in the cluster as configured on the producer through metadata.broker.list
   * @param producerConfig The producer's config
   * @return topic metadata response
   */</span>
  def <a title="(topics: scala.collection.Set[String], brokers: Seq[kafka.cluster.Broker], producerConfig: kafka.producer.ProducerConfig, correlationId: Int)kafka.api.TopicMetadataResponse" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72)">fetchTopicMetadata</a><span class="delimiter">(</span><a title="scala.collection.Set[String]" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topics">topics</a>: <span title="scala.collection.Set[String]">Set</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="Seq[kafka.cluster.Broker]" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).brokers">brokers</a>: <span title="Seq[kafka.cluster.Broker]">Seq</span><span class="delimiter">[</span>Broker<span class="delimiter">]</span>, <a title="kafka.producer.ProducerConfig" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).producerConfig">producerConfig</a>: <a href="../producer/ProducerConfig.scala.html#kafka.producer;ProducerConfig" title="kafka.producer.ProducerConfig">ProducerConfig</a>, <a title="Int" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).correlationId">correlationId</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="../api/TopicMetadataResponse.scala.html#kafka.api;TopicMetadataResponse" title="kafka.api.TopicMetadataResponse">TopicMetadataResponse</a> = <span class="delimiter">{</span>
    var <a title="Boolean" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).fetchMetaDataSucceeded">fetchMetaDataSucceeded</a>: <span title="Boolean">Boolean</span> = false
    var <a title="Int" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).i">i</a>: <span title="Int">Int</span> = <span title="Int(0)" class="int">0</span>
    val <a title="kafka.api.TopicMetadataRequest" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topicMetadataRequest">topicMetadataRequest</a> = new <a href="../api/TopicMetadataRequest.scala.html#kafka.api;TopicMetadataRequest" title="kafka.api.TopicMetadataRequest">TopicMetadataRequest</a><span class="delimiter">(</span><a href="../api/TopicMetadataRequest.scala.html#kafka.api.TopicMetadataRequest" title="kafka.api.TopicMetadataRequest.type">TopicMetadataRequest</a>.<a href="../api/TopicMetadataRequest.scala.html#kafka.api.TopicMetadataRequest.CurrentVersion" title="=&gt; Short">CurrentVersion</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).correlationId" title="Int">correlationId</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).producerConfig" title="kafka.producer.ProducerConfig">producerConfig</a>.<a href="../producer/SyncProducerConfig.scala.html#kafka.producer;SyncProducerConfigShared.clientId" title="=&gt; String">clientId</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topics" title="scala.collection.Set[String]">topics</a>.<span title="=&gt; Seq[String]">toSeq</span><span class="delimiter">)</span>
    var <a title="kafka.api.TopicMetadataResponse" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topicMetadataResponse">topicMetadataResponse</a>: <a href="../api/TopicMetadataResponse.scala.html#kafka.api;TopicMetadataResponse" title="kafka.api.TopicMetadataResponse">TopicMetadataResponse</a> = null
    var <a title="Throwable" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).t">t</a>: <span title="Throwable">Throwable</span> = null
    <span class="comment">// shuffle the list of brokers before sending metadata requests so that most requests don't get routed to the</span>
    <span class="comment">// same broker</span>
    val <a title="Seq[kafka.cluster.Broker]" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).shuffledBrokers">shuffledBrokers</a> = <span title="scala.util.Random.type">Random</span>.<span title="(xs: Seq[kafka.cluster.Broker])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[kafka.cluster.Broker],kafka.cluster.Broker,Seq[kafka.cluster.Broker]])Seq[kafka.cluster.Broker]">shuffle</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,kafka.cluster.Broker,Seq[kafka.cluster.Broker]]" class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).brokers" title="Seq[kafka.cluster.Broker]">brokers</a><span class="delimiter">)</span>
    while<span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).i" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).shuffledBrokers" title="Seq[kafka.cluster.Broker]">shuffledBrokers</a>.<span title="=&gt; Int">size</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).fetchMetaDataSucceeded" title="Boolean">fetchMetaDataSucceeded</a><span class="delimiter">)</span> <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).while$1" title="()Unit" class="delimiter">{</a>
      val <a title="kafka.producer.SyncProducer" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).producer">producer</a>: <a href="../producer/SyncProducer.scala.html#kafka.producer;SyncProducer" title="kafka.producer.SyncProducer">SyncProducer</a> = <a href="../producer/ProducerPool.scala.html#kafka.producer.ProducerPool" title="kafka.producer.ProducerPool.type">ProducerPool</a>.<a href="../producer/ProducerPool.scala.html#kafka.producer.ProducerPool.createSyncProducer" title="(config: kafka.producer.ProducerConfig, broker: kafka.cluster.Broker)kafka.producer.SyncProducer">createSyncProducer</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).producerConfig" title="kafka.producer.ProducerConfig">producerConfig</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).shuffledBrokers" title="(idx: Int)kafka.cluster.Broker">shuffledBrokers</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).i" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../utils/Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Fetching metadata from broker %s with correlation id %d for %d topic(s) %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).shuffledBrokers" title="(idx: Int)kafka.cluster.Broker">shuffledBrokers</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).i" title="Int">i</a><span class="delimiter">)</span>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).correlationId" title="Int">correlationId</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topics" title="scala.collection.Set[String]">topics</a>.<span title="=&gt; Int">size</span>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topics" title="scala.collection.Set[String]">topics</a><span class="delimiter">)</span><span class="delimiter">)</span>
      try <span class="delimiter">{</span>
        <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topicMetadataResponse" title="kafka.api.TopicMetadataResponse">topicMetadataResponse</a> = <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).producer" title="kafka.producer.SyncProducer">producer</a>.<a href="../producer/SyncProducer.scala.html#kafka.producer;SyncProducer.send(5d9dc6b855)" title="(request: kafka.api.TopicMetadataRequest)kafka.api.TopicMetadataResponse">send</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topicMetadataRequest" title="kafka.api.TopicMetadataRequest">topicMetadataRequest</a><span class="delimiter">)</span>
        <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).fetchMetaDataSucceeded" title="Boolean">fetchMetaDataSucceeded</a> = true
      <span class="delimiter">}</span>
      catch <span class="delimiter">{</span>
        case <a title="Throwable" id="kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).e">e</a>: <span title="Throwable">Throwable</span> =&gt;
          <a href="../utils/Logging.scala.html#kafka.utils;Logging.warn(cfd112d89b)" title="(msg: =&gt; String, e: =&gt; Throwable)Unit">warn</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Fetching topic metadata with correlation id %d for topics [%s] from broker [%s] failed&quot;</span>
            .<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).correlationId" title="Int">correlationId</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topics" title="scala.collection.Set[String]">topics</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).shuffledBrokers" title="(idx: Int)kafka.cluster.Broker">shuffledBrokers</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).i" title="Int">i</a><span class="delimiter">)</span>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.toString" title="()String">toString</a><span class="delimiter">)</span>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).e" title="Throwable">e</a><span class="delimiter">)</span>
          <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).t" title="Throwable">t</a> = <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).e" title="Throwable">e</a>
      <span class="delimiter">}</span> finally <span class="delimiter">{</span>
        <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).i" title="Int">i</a> = <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).i" title="Int">i</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
        <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).producer" title="kafka.producer.SyncProducer">producer</a>.<a href="../producer/SyncProducer.scala.html#kafka.producer;SyncProducer.close" title="()Unit">close</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    if<span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).fetchMetaDataSucceeded" title="Boolean">fetchMetaDataSucceeded</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      throw new <a href="../common/KafkaException.scala.html#kafka.common;KafkaException" title="kafka.common.KafkaException">KafkaException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;fetching topic metadata for topics [%s] from broker [%s] failed&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topics" title="scala.collection.Set[String]">topics</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).shuffledBrokers" title="Seq[kafka.cluster.Broker]">shuffledBrokers</a><span class="delimiter">)</span>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).t" title="Throwable">t</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> else <span class="delimiter">{</span>
      <a href="../utils/Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Successfully fetched metadata for %d topic(s) %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topics" title="scala.collection.Set[String]">topics</a>.<span title="=&gt; Int">size</span>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topics" title="scala.collection.Set[String]">topics</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    return <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72).topicMetadataResponse" title="kafka.api.TopicMetadataResponse">topicMetadataResponse</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Used by a non-producer client to send a metadata request
   * @param topics The topics for which the metadata needs to be fetched
   * @param brokers The brokers in the cluster as configured on the client
   * @param clientId The client's identifier
   * @return topic metadata response
   */</span>
  def <a title="(topics: scala.collection.Set[String], brokers: Seq[kafka.cluster.Broker], clientId: String, timeoutMs: Int, correlationId: Int)kafka.api.TopicMetadataResponse" id="kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb)">fetchTopicMetadata</a><span class="delimiter">(</span><a title="scala.collection.Set[String]" id="kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).topics">topics</a>: <span title="scala.collection.Set[String]">Set</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="Seq[kafka.cluster.Broker]" id="kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).brokers">brokers</a>: <span title="Seq[kafka.cluster.Broker]">Seq</span><span class="delimiter">[</span>Broker<span class="delimiter">]</span>, <a title="String" id="kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).clientId">clientId</a>: <span title="String">String</span>, <a title="Int" id="kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).timeoutMs">timeoutMs</a>: <span title="Int">Int</span>,
                         <a title="Int" id="kafka.client.ClientUtils.fetchTopicMetadata$default$5">correlationId</a>: <span title="Int">Int</span> = <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>: <a href="../api/TopicMetadataResponse.scala.html#kafka.api;TopicMetadataResponse" title="kafka.api.TopicMetadataResponse">TopicMetadataResponse</a> = <span class="delimiter">{</span>
    val <a title="java.util.Properties" id="kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).props">props</a> = new <span title="java.util.Properties">Properties</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).props" title="java.util.Properties">props</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;metadata.broker.list&quot;)" class="string">&quot;metadata.broker.list&quot;</span>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).brokers" title="Seq[kafka.cluster.Broker]">brokers</a>.<span title="(f: kafka.cluster.Broker =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[kafka.cluster.Broker],String,Seq[String]])Seq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,String,Seq[String]]" class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).$anonfun.x$1" title="kafka.cluster.Broker">_</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.connectionString" title="=&gt; String">connectionString</a><span class="delimiter">)</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).props" title="java.util.Properties">props</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;client.id&quot;)" class="string">&quot;client.id&quot;</span>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).clientId" title="String">clientId</a><span class="delimiter">)</span>
    <a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).props" title="java.util.Properties">props</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;request.timeout.ms&quot;)" class="string">&quot;request.timeout.ms&quot;</span>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).timeoutMs" title="Int">timeoutMs</a>.<span title="()String">toString</span><span class="delimiter">)</span>
    val <a title="kafka.producer.ProducerConfig" id="kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).producerConfig">producerConfig</a> = new <a href="../producer/ProducerConfig.scala.html#kafka.producer;ProducerConfig" title="kafka.producer.ProducerConfig">ProducerConfig</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).props" title="java.util.Properties">props</a><span class="delimiter">)</span>
    <a href="#kafka.client.ClientUtils.fetchTopicMetadata(cbd8040d72)" title="(topics: scala.collection.Set[String], brokers: Seq[kafka.cluster.Broker], producerConfig: kafka.producer.ProducerConfig, correlationId: Int)kafka.api.TopicMetadataResponse">fetchTopicMetadata</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).topics" title="scala.collection.Set[String]">topics</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).brokers" title="Seq[kafka.cluster.Broker]">brokers</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb).producerConfig" title="kafka.producer.ProducerConfig">producerConfig</a>, <a href="#kafka.client.ClientUtils.fetchTopicMetadata$default$5" title="Int">correlationId</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Parse a list of broker urls in the form host1:port1, host2:port2, ... 
   */</span>
  def <a title="(brokerListStr: String)Seq[kafka.cluster.Broker]" id="kafka.client.ClientUtils.parseBrokerList">parseBrokerList</a><span class="delimiter">(</span><a title="String" id="kafka.client.ClientUtils.parseBrokerList.brokerListStr">brokerListStr</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Seq[kafka.cluster.Broker]">Seq</span><span class="delimiter">[</span>Broker<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="Seq[String]" id="kafka.client.ClientUtils.parseBrokerList.brokersStr">brokersStr</a> = <a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.parseCsvList" title="(csvList: String)Seq[String]">parseCsvList</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.parseBrokerList.brokerListStr" title="String">brokerListStr</a><span class="delimiter">)</span>

    <a href="#kafka.client.ClientUtils.parseBrokerList.brokersStr" title="Seq[String]">brokersStr</a>.<span title="(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],(String, Int),Seq[(String, Int)]])Seq[(String, Int)]">zipWithIndex</span>.<span title="(f: ((String, Int)) =&gt; kafka.cluster.Broker)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, Int)],kafka.cluster.Broker,Seq[kafka.cluster.Broker]])Seq[kafka.cluster.Broker]">map</span> <a href="#kafka.client.ClientUtils.parseBrokerList.$anonfun.x0$1" title="kafka.cluster.Broker" class="delimiter">{</a> case <span class="delimiter">(</span><a title="String" id="kafka.client.ClientUtils.parseBrokerList.$anonfun.address">address</a>, <a title="Int" id="kafka.client.ClientUtils.parseBrokerList.$anonfun.brokerId">brokerId</a><span class="delimiter">)</span> =&gt;
      new <a href="../cluster/Broker.scala.html#kafka.cluster;Broker" title="kafka.cluster.Broker">Broker</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.parseBrokerList.$anonfun.brokerId" title="Int">brokerId</a>, <span title="(x$1: String)String">getHost</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.parseBrokerList.$anonfun.address" title="String">address</a><span class="delimiter">)</span>, <span title="(x$1: String)Integer">getPort</span><span title="implicit scala.Predef.Integer2int : (x: Integer)Int" class="delimiter">(</span><a href="#kafka.client.ClientUtils.parseBrokerList.$anonfun.address" title="String">address</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

   <span class="comment">/**
    * Creates a blocking channel to a random broker
    */</span>
   def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, socketTimeoutMs: Int)kafka.network.BlockingChannel" id="kafka.client.ClientUtils.channelToAnyBroker">channelToAnyBroker</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.client.ClientUtils.channelToAnyBroker.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="Int" id="kafka.client.ClientUtils.channelToAnyBroker$default$2">socketTimeoutMs</a>: <span title="Int">Int</span> = <span title="Int(3000)" class="int">3000</span><span class="delimiter">)</span> : <a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel" title="kafka.network.BlockingChannel">BlockingChannel</a> = <span class="delimiter">{</span>
     var <a title="kafka.network.BlockingChannel" id="kafka.client.ClientUtils.channelToAnyBroker.channel">channel</a>: <a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel" title="kafka.network.BlockingChannel">BlockingChannel</a> = null
     var <a title="Boolean" id="kafka.client.ClientUtils.channelToAnyBroker.connected">connected</a> = false
     while <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.client.ClientUtils.channelToAnyBroker.connected" title="Boolean">connected</a><span class="delimiter">)</span> <a href="#kafka.client.ClientUtils.channelToAnyBroker.while$2" title="()Unit" class="delimiter">{</a>
       val <a title="Seq[kafka.cluster.Broker]" id="kafka.client.ClientUtils.channelToAnyBroker.allBrokers">allBrokers</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getAllBrokersInCluster" title="(zkClient: org.I0Itec.zkclient.ZkClient)Seq[kafka.cluster.Broker]">getAllBrokersInCluster</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToAnyBroker.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a><span class="delimiter">)</span>
       <span title="scala.util.Random.type">Random</span>.<span title="(xs: Seq[kafka.cluster.Broker])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[kafka.cluster.Broker],kafka.cluster.Broker,Seq[kafka.cluster.Broker]])Seq[kafka.cluster.Broker]">shuffle</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,kafka.cluster.Broker,Seq[kafka.cluster.Broker]]" class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToAnyBroker.allBrokers" title="Seq[kafka.cluster.Broker]">allBrokers</a><span class="delimiter">)</span>.<span title="(p: kafka.cluster.Broker =&gt; Boolean)Option[kafka.cluster.Broker]">find</span> <span class="delimiter">{</span> <a title="kafka.cluster.Broker" id="kafka.client.ClientUtils.channelToAnyBroker.$anonfun.broker">broker</a> =&gt;
         <a href="../utils/Logging.scala.html#kafka.utils;Logging.trace(1729dbc42f)" title="(msg: =&gt; String)Unit">trace</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Connecting to broker %s:%d.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToAnyBroker.$anonfun.broker" title="kafka.cluster.Broker">broker</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.host" title="=&gt; String">host</a>, <a href="#kafka.client.ClientUtils.channelToAnyBroker.$anonfun.broker" title="kafka.cluster.Broker">broker</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.port" title="=&gt; Int">port</a><span class="delimiter">)</span><span class="delimiter">)</span>
         try <span class="delimiter">{</span>
           <a href="#kafka.client.ClientUtils.channelToAnyBroker.channel" title="kafka.network.BlockingChannel">channel</a> = new <a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel" title="kafka.network.BlockingChannel">BlockingChannel</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToAnyBroker.$anonfun.broker" title="kafka.cluster.Broker">broker</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.host" title="=&gt; String">host</a>, <a href="#kafka.client.ClientUtils.channelToAnyBroker.$anonfun.broker" title="kafka.cluster.Broker">broker</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.port" title="=&gt; Int">port</a>, <a href="../network/BlockingChannel.scala.html#kafka.network.BlockingChannel" title="kafka.network.BlockingChannel.type">BlockingChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network.BlockingChannel.UseDefaultBufferSize" title="=&gt; Int">UseDefaultBufferSize</a>, <a href="../network/BlockingChannel.scala.html#kafka.network.BlockingChannel" title="kafka.network.BlockingChannel.type">BlockingChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network.BlockingChannel.UseDefaultBufferSize" title="=&gt; Int">UseDefaultBufferSize</a>, <a href="#kafka.client.ClientUtils.channelToAnyBroker$default$2" title="Int">socketTimeoutMs</a><span class="delimiter">)</span>
           <a href="#kafka.client.ClientUtils.channelToAnyBroker.channel" title="kafka.network.BlockingChannel">channel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.connect" title="()Unit">connect</a><span class="delimiter">(</span><span class="delimiter">)</span>
           <a href="../utils/Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Created channel to broker %s:%d.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToAnyBroker.channel" title="kafka.network.BlockingChannel">channel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.host" title="=&gt; String">host</a>, <a href="#kafka.client.ClientUtils.channelToAnyBroker.channel" title="kafka.network.BlockingChannel">channel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.port" title="=&gt; Int">port</a><span class="delimiter">)</span><span class="delimiter">)</span>
           true
         <span class="delimiter">}</span> catch <span class="delimiter">{</span>
           case <a title="Exception" id="kafka.client.ClientUtils.channelToAnyBroker.$anonfun.e">e</a>: <span title="Exception">Exception</span> =&gt;
             if <span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToAnyBroker.channel" title="kafka.network.BlockingChannel">channel</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span> <a href="#kafka.client.ClientUtils.channelToAnyBroker.channel" title="kafka.network.BlockingChannel">channel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.disconnect" title="()Unit">disconnect</a><span class="delimiter">(</span><span class="delimiter">)</span>
             <a href="#kafka.client.ClientUtils.channelToAnyBroker.channel" title="kafka.network.BlockingChannel">channel</a> = null
             <a href="../utils/Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Error while creating channel to %s:%d.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToAnyBroker.$anonfun.broker" title="kafka.cluster.Broker">broker</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.host" title="=&gt; String">host</a>, <a href="#kafka.client.ClientUtils.channelToAnyBroker.$anonfun.broker" title="kafka.cluster.Broker">broker</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.port" title="=&gt; Int">port</a><span class="delimiter">)</span><span class="delimiter">)</span>
             false
         <span class="delimiter">}</span>
       <span class="delimiter">}</span>
       <a href="#kafka.client.ClientUtils.channelToAnyBroker.connected" title="Boolean">connected</a> = if <span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToAnyBroker.channel" title="kafka.network.BlockingChannel">channel</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span> false else true
     <span class="delimiter">}</span>

     <a href="#kafka.client.ClientUtils.channelToAnyBroker.channel" title="kafka.network.BlockingChannel">channel</a>
   <span class="delimiter">}</span>

   <span class="comment">/**
    * Creates a blocking channel to the offset manager of the given group
    */</span>
   def <a title="(group: String, zkClient: org.I0Itec.zkclient.ZkClient, socketTimeoutMs: Int, retryBackOffMs: Int)kafka.network.BlockingChannel" id="kafka.client.ClientUtils.channelToOffsetManager">channelToOffsetManager</a><span class="delimiter">(</span><a title="String" id="kafka.client.ClientUtils.channelToOffsetManager.group">group</a>: <span title="String">String</span>, <a title="org.I0Itec.zkclient.ZkClient" id="kafka.client.ClientUtils.channelToOffsetManager.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="Int" id="kafka.client.ClientUtils.channelToOffsetManager$default$3">socketTimeoutMs</a>: <span title="Int">Int</span> = <span title="Int(3000)" class="int">3000</span>, <a title="Int" id="kafka.client.ClientUtils.channelToOffsetManager$default$4">retryBackOffMs</a>: <span title="Int">Int</span> = <span title="Int(1000)" class="int">1000</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
     var <a title="kafka.network.BlockingChannel" id="kafka.client.ClientUtils.channelToOffsetManager.queryChannel">queryChannel</a> = <a href="#kafka.client.ClientUtils.channelToAnyBroker" title="(zkClient: org.I0Itec.zkclient.ZkClient, socketTimeoutMs: Int)kafka.network.BlockingChannel">channelToAnyBroker</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a><span class="delimiter">)</span>

     var <a title="Option[kafka.network.BlockingChannel]" id="kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannelOpt">offsetManagerChannelOpt</a>: <span title="Option[kafka.network.BlockingChannel]">Option</span><span class="delimiter">[</span>BlockingChannel<span class="delimiter">]</span> = <span title="None.type">None</span>

     while <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannelOpt" title="Option[kafka.network.BlockingChannel]">offsetManagerChannelOpt</a>.<span title="=&gt; Boolean">isDefined</span><span class="delimiter">)</span> <a href="#kafka.client.ClientUtils.channelToOffsetManager.while$4" title="()Unit" class="delimiter">{</a>

       var <a title="Option[kafka.cluster.Broker]" id="kafka.client.ClientUtils.channelToOffsetManager.coordinatorOpt">coordinatorOpt</a>: <span title="Option[kafka.cluster.Broker]">Option</span><span class="delimiter">[</span>Broker<span class="delimiter">]</span> = <span title="None.type">None</span>

       while <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.coordinatorOpt" title="Option[kafka.cluster.Broker]">coordinatorOpt</a>.<span title="=&gt; Boolean">isDefined</span><span class="delimiter">)</span> <span class="delimiter">{</span>
         try <span class="delimiter">{</span>
           if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.isConnected" title="=&gt; Boolean">isConnected</a><span class="delimiter">)</span>
             <a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a> = <a href="#kafka.client.ClientUtils.channelToAnyBroker" title="(zkClient: org.I0Itec.zkclient.ZkClient, socketTimeoutMs: Int)kafka.network.BlockingChannel">channelToAnyBroker</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a><span class="delimiter">)</span>
           <a href="../utils/Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Querying %s:%d to locate offset manager for %s.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.host" title="=&gt; String">host</a>, <a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.port" title="=&gt; Int">port</a>, <a href="#kafka.client.ClientUtils.channelToOffsetManager.group" title="String">group</a><span class="delimiter">)</span><span class="delimiter">)</span>
           <a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.send" title="(request: kafka.api.RequestOrResponse)Int">send</a><span class="delimiter">(</span><a href="../api/ConsumerMetadataRequest.scala.html#kafka.api;ConsumerMetadataRequest" title="(group: String, versionId: Short, correlationId: Int, clientId: String)kafka.api.ConsumerMetadataRequest">ConsumerMetadataRequest</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.group" title="String">group</a><span class="delimiter">)</span><span class="delimiter">)</span>
           val <a title="kafka.network.Receive" id="kafka.client.ClientUtils.channelToOffsetManager.response">response</a> = <a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.receive" title="()kafka.network.Receive">receive</a><span class="delimiter">(</span><span class="delimiter">)</span>
           val <a title="kafka.api.ConsumerMetadataResponse" id="kafka.client.ClientUtils.channelToOffsetManager.consumerMetadataResponse">consumerMetadataResponse</a> =  <a href="../api/ConsumerMetadataResponse.scala.html#kafka.api.ConsumerMetadataResponse" title="kafka.api.ConsumerMetadataResponse.type">ConsumerMetadataResponse</a>.<a href="../api/ConsumerMetadataResponse.scala.html#kafka.api.ConsumerMetadataResponse.readFrom" title="(buffer: java.nio.ByteBuffer)kafka.api.ConsumerMetadataResponse">readFrom</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.response" title="kafka.network.Receive">response</a>.<a href="../network/Transmission.scala.html#kafka.network;Receive.buffer" title="=&gt; java.nio.ByteBuffer">buffer</a><span class="delimiter">)</span>
           <a href="../utils/Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Consumer metadata response: &quot;)" class="string">&quot;Consumer metadata response: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.client.ClientUtils.channelToOffsetManager.consumerMetadataResponse" title="kafka.api.ConsumerMetadataResponse">consumerMetadataResponse</a>.<a href="../api/ConsumerMetadataResponse.scala.html#kafka.api;ConsumerMetadataResponse.toString" title="()String">toString</a><span class="delimiter">)</span>
           if <span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.consumerMetadataResponse" title="kafka.api.ConsumerMetadataResponse">consumerMetadataResponse</a>.<a href="../api/ConsumerMetadataResponse.scala.html#kafka.api;ConsumerMetadataResponse.errorCode" title="=&gt; Short">errorCode</a> <span title="(x: Short)Boolean">==</span> <a href="../common/ErrorMapping.scala.html#kafka.common.ErrorMapping" title="kafka.common.ErrorMapping.type">ErrorMapping</a>.<a href="../common/ErrorMapping.scala.html#kafka.common.ErrorMapping.NoError" title="=&gt; Short">NoError</a><span class="delimiter">)</span>
             <a href="#kafka.client.ClientUtils.channelToOffsetManager.coordinatorOpt" title="Option[kafka.cluster.Broker]">coordinatorOpt</a> = <a href="#kafka.client.ClientUtils.channelToOffsetManager.consumerMetadataResponse" title="kafka.api.ConsumerMetadataResponse">consumerMetadataResponse</a>.<a href="../api/ConsumerMetadataResponse.scala.html#kafka.api;ConsumerMetadataResponse.coordinatorOpt" title="=&gt; Option[kafka.cluster.Broker]">coordinatorOpt</a>
           else <span class="delimiter">{</span>
             <a href="../utils/Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Query to %s:%d to locate offset manager for %s failed - will retry in %d milliseconds.&quot;</span>
                  .<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.host" title="=&gt; String">host</a>, <a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.port" title="=&gt; Int">port</a>, <a href="#kafka.client.ClientUtils.channelToOffsetManager.group" title="String">group</a>, <a href="#kafka.client.ClientUtils.channelToOffsetManager$default$4" title="Int">retryBackOffMs</a><span class="delimiter">)</span><span class="delimiter">)</span>
             <span title="Thread.type">Thread</span>.<span title="(x$1: Long)Unit">sleep</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager$default$4" title="=&gt; Long">retryBackOffMs</a><span class="delimiter">)</span>
           <span class="delimiter">}</span>
         <span class="delimiter">}</span>
         catch <span class="delimiter">{</span>
           case <span title="java.io.IOException">ioe</span>: <span title="java.io.IOException">IOException</span> =&gt;
             <a href="../utils/Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Failed to fetch consumer metadata from %s:%d.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.host" title="=&gt; String">host</a>, <a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.port" title="=&gt; Int">port</a><span class="delimiter">)</span><span class="delimiter">)</span>
             <a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.disconnect" title="()Unit">disconnect</a><span class="delimiter">(</span><span class="delimiter">)</span>
         <span class="delimiter">}</span>
       <span class="delimiter">}</span>

       val <a title="kafka.cluster.Broker" id="kafka.client.ClientUtils.channelToOffsetManager.coordinator">coordinator</a> = <a href="#kafka.client.ClientUtils.channelToOffsetManager.coordinatorOpt" title="Option[kafka.cluster.Broker]">coordinatorOpt</a>.<span title="=&gt; kafka.cluster.Broker">get</span>
       if <span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.coordinator" title="kafka.cluster.Broker">coordinator</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.host" title="=&gt; String">host</a> <span title="(x$1: Any)Boolean">==</span> <a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.host" title="=&gt; String">host</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#kafka.client.ClientUtils.channelToOffsetManager.coordinator" title="kafka.cluster.Broker">coordinator</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.port" title="=&gt; Int">port</a> <span title="(x: Int)Boolean">==</span> <a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.port" title="=&gt; Int">port</a><span class="delimiter">)</span> <span class="delimiter">{</span>
         <a href="#kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannelOpt" title="Option[kafka.network.BlockingChannel]">offsetManagerChannelOpt</a> = <span title="(x: kafka.network.BlockingChannel)Some[kafka.network.BlockingChannel]">Some</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a><span class="delimiter">)</span>
       <span class="delimiter">}</span> else <span class="delimiter">{</span>
         val <a title="String" id="kafka.client.ClientUtils.channelToOffsetManager.connectString">connectString</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s:%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.coordinator" title="kafka.cluster.Broker">coordinator</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.host" title="=&gt; String">host</a>, <a href="#kafka.client.ClientUtils.channelToOffsetManager.coordinator" title="kafka.cluster.Broker">coordinator</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.port" title="=&gt; Int">port</a><span class="delimiter">)</span>
         var <a title="kafka.network.BlockingChannel" id="kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannel">offsetManagerChannel</a>: <a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel" title="kafka.network.BlockingChannel">BlockingChannel</a> = null
         try <span class="delimiter">{</span>
           <a href="../utils/Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Connecting to offset manager %s.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.connectString" title="String">connectString</a><span class="delimiter">)</span><span class="delimiter">)</span>
           <a href="#kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannel" title="kafka.network.BlockingChannel">offsetManagerChannel</a> = new <a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel" title="kafka.network.BlockingChannel">BlockingChannel</a><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.coordinator" title="kafka.cluster.Broker">coordinator</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.host" title="=&gt; String">host</a>, <a href="#kafka.client.ClientUtils.channelToOffsetManager.coordinator" title="kafka.cluster.Broker">coordinator</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.port" title="=&gt; Int">port</a>,
                                                      <a href="../network/BlockingChannel.scala.html#kafka.network.BlockingChannel" title="kafka.network.BlockingChannel.type">BlockingChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network.BlockingChannel.UseDefaultBufferSize" title="=&gt; Int">UseDefaultBufferSize</a>,
                                                      <a href="../network/BlockingChannel.scala.html#kafka.network.BlockingChannel" title="kafka.network.BlockingChannel.type">BlockingChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network.BlockingChannel.UseDefaultBufferSize" title="=&gt; Int">UseDefaultBufferSize</a>,
                                                      <a href="#kafka.client.ClientUtils.channelToOffsetManager$default$3" title="Int">socketTimeoutMs</a><span class="delimiter">)</span>
           <a href="#kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannel" title="kafka.network.BlockingChannel">offsetManagerChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.connect" title="()Unit">connect</a><span class="delimiter">(</span><span class="delimiter">)</span>
           <a href="#kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannelOpt" title="Option[kafka.network.BlockingChannel]">offsetManagerChannelOpt</a> = <span title="(x: kafka.network.BlockingChannel)Some[kafka.network.BlockingChannel]">Some</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannel" title="kafka.network.BlockingChannel">offsetManagerChannel</a><span class="delimiter">)</span>
           <a href="#kafka.client.ClientUtils.channelToOffsetManager.queryChannel" title="kafka.network.BlockingChannel">queryChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.disconnect" title="()Unit">disconnect</a><span class="delimiter">(</span><span class="delimiter">)</span>
         <span class="delimiter">}</span>
         catch <span class="delimiter">{</span>
           case <span title="java.io.IOException">ioe</span>: <span title="java.io.IOException">IOException</span> =&gt; <span class="comment">// offsets manager may have moved</span>
             <a href="../utils/Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Error while connecting to %s.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.connectString" title="String">connectString</a><span class="delimiter">)</span><span class="delimiter">)</span>
             if <span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannel" title="kafka.network.BlockingChannel">offsetManagerChannel</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span> <a href="#kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannel" title="kafka.network.BlockingChannel">offsetManagerChannel</a>.<a href="../network/BlockingChannel.scala.html#kafka.network;BlockingChannel.disconnect" title="()Unit">disconnect</a><span class="delimiter">(</span><span class="delimiter">)</span>
             <span title="Thread.type">Thread</span>.<span title="(x$1: Long)Unit">sleep</span><span class="delimiter">(</span><a href="#kafka.client.ClientUtils.channelToOffsetManager$default$4" title="=&gt; Long">retryBackOffMs</a><span class="delimiter">)</span>
             <a href="#kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannelOpt" title="Option[kafka.network.BlockingChannel]">offsetManagerChannelOpt</a> = <span title="None.type">None</span> <span class="comment">// just in case someone decides to change shutdownChannel to not swallow exceptions</span>
         <span class="delimiter">}</span>
       <span class="delimiter">}</span>
     <span class="delimiter">}</span>

     <a href="#kafka.client.ClientUtils.channelToOffsetManager.offsetManagerChannelOpt" title="Option[kafka.network.BlockingChannel]">offsetManagerChannelOpt</a>.<span title="=&gt; kafka.network.BlockingChannel">get</span>
   <span class="delimiter">}</span>
 <span class="delimiter">}</span>

        </pre>
    </body>
</html>

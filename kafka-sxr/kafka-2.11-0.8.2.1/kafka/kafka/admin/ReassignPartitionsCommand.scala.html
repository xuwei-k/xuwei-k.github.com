<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>kafka/kafka/admin/ReassignPartitionsCommand.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>
package kafka.admin

import joptsimple.OptionParser
import kafka.utils._
import collection._
import org.I0Itec.zkclient.ZkClient
import org.I0Itec.zkclient.exception.ZkNodeExistsException
import kafka.common.<span class="delimiter">{</span>TopicAndPartition, AdminCommandFailedException<span class="delimiter">}</span>

object <a title="kafka.admin.ReassignPartitionsCommand.type" id="kafka.admin.ReassignPartitionsCommand">ReassignPartitionsCommand</a> extends <a href="../utils/Logging.scala.html#kafka.utils;Logging" title="kafka.utils.Logging">Logging</a> <span class="delimiter">{</span>

  def <a title="(args: Array[String])Unit" id="kafka.admin.ReassignPartitionsCommand.main">main</a><span class="delimiter">(</span><a title="Array[String]" id="kafka.admin.ReassignPartitionsCommand.main.args">args</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>

    val <a title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions" id="kafka.admin.ReassignPartitionsCommand.main.opts">opts</a> = new <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">ReassignPartitionsCommandOptions</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.args" title="Array[String]">args</a><span class="delimiter">)</span>

    <span class="comment">// should have exactly one action</span>
    val <a title="Int" id="kafka.admin.ReassignPartitionsCommand.main.actions">actions</a> = <span title="(elems: joptsimple.OptionSpecBuilder*)Seq[joptsimple.OptionSpecBuilder]">Seq</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.generateOpt" title="=&gt; joptsimple.OptionSpecBuilder">generateOpt</a>, <a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.executeOpt" title="=&gt; joptsimple.OptionSpecBuilder">executeOpt</a>, <a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.verifyOpt" title="=&gt; joptsimple.OptionSpecBuilder">verifyOpt</a><span class="delimiter">)</span>.<span title="(p: joptsimple.OptionSpecBuilder =&gt; Boolean)Int">count</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<a href="#kafka.admin.ReassignPartitionsCommand.main.actions.$anonfun.x$1" title="(x$1: joptsimple.OptionSpec[_])Boolean">has</a> _<span class="delimiter">)</span>
    if<span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.actions" title="Int">actions</a> <span title="(x: Int)Boolean">!=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.printUsageAndDie" title="(parser: joptsimple.OptionParser, message: String)Unit">printUsageAndDie</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>, <span title="String(&quot;Command must include exactly one action: --generate, --execute or --verify&quot;)" class="string">&quot;Command must include exactly one action: --generate, --execute or --verify&quot;</span><span class="delimiter">)</span>

    <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.checkRequiredArgs" title="(parser: joptsimple.OptionParser, options: joptsimple.OptionSet, required: joptsimple.OptionSpec[_]*)Unit">checkRequiredArgs</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>, <a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>, <a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.zkConnectOpt" title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">zkConnectOpt</a><span class="delimiter">)</span>

    val <a title="String" id="kafka.admin.ReassignPartitionsCommand.main.zkConnect">zkConnect</a> = <a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.zkConnectOpt" title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">zkConnectOpt</a><span class="delimiter">)</span>
    var <a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.ReassignPartitionsCommand.main.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span> = new <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.zkConnect" title="String">zkConnect</a>, <span title="Int(30000)" class="int">30000</span>, <span title="Int(30000)" class="int">30000</span>, <a href="../utils/ZkUtils.scala.html#kafka.utils.ZKStringSerializer" title="kafka.utils.ZKStringSerializer.type">ZKStringSerializer</a><span class="delimiter">)</span>
    try <span class="delimiter">{</span>
      if<span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.verifyOpt" title="=&gt; joptsimple.OptionSpecBuilder">verifyOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment" title="(zkClient: org.I0Itec.zkclient.ZkClient, opts: kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions)Unit">verifyAssignment</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a><span class="delimiter">)</span>
      else if<span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.generateOpt" title="=&gt; joptsimple.OptionSpecBuilder">generateOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment" title="(zkClient: org.I0Itec.zkclient.ZkClient, opts: kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions)Unit">generateAssignment</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a><span class="delimiter">)</span>
      else if <span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.executeOpt" title="=&gt; joptsimple.OptionSpecBuilder">executeOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment" title="(zkClient: org.I0Itec.zkclient.ZkClient, opts: kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions)Unit">executeAssignment</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.ReassignPartitionsCommand.main.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="Throwable" id="kafka.admin.ReassignPartitionsCommand.main.e">e</a>: <span title="Throwable">Throwable</span> =&gt;
        <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;Partitions reassignment failed due to &quot;)" class="string">&quot;Partitions reassignment failed due to &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.ReassignPartitionsCommand.main.e" title="Throwable">e</a>.<span title="()String">getMessage</span><span class="delimiter">)</span>
        <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.stackTrace" title="(e: Throwable)String">stackTrace</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.e" title="Throwable">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> finally <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.main.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span>
        <a href="#kafka.admin.ReassignPartitionsCommand.main.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, opts: kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions)Unit" id="kafka.admin.ReassignPartitionsCommand.verifyAssignment">verifyAssignment</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.ReassignPartitionsCommand.verifyAssignment.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions" id="kafka.admin.ReassignPartitionsCommand.verifyAssignment.opts">opts</a>: <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">ReassignPartitionsCommandOptions</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    if<span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.reassignmentJsonFileOpt" title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">reassignmentJsonFileOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.printUsageAndDie" title="(parser: joptsimple.OptionParser, message: String)Unit">printUsageAndDie</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>, <span title="String(&quot;If --verify option is used, command must include --reassignment-json-file that was used during the --execute option&quot;)" class="string">&quot;If --verify option is used, command must include --reassignment-json-file that was used during the --execute option&quot;</span><span class="delimiter">)</span>
    val <a title="String" id="kafka.admin.ReassignPartitionsCommand.verifyAssignment.jsonFile">jsonFile</a> = <a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.reassignmentJsonFileOpt" title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">reassignmentJsonFileOpt</a><span class="delimiter">)</span>
    val <a title="String" id="kafka.admin.ReassignPartitionsCommand.verifyAssignment.jsonString">jsonString</a> = <a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.readFileAsString" title="(path: String, charset: java.nio.charset.Charset)String">readFileAsString</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.jsonFile" title="String">jsonFile</a><span class="delimiter">)</span>
    val <a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin.ReassignPartitionsCommand.verifyAssignment.partitionsToBeReassigned">partitionsToBeReassigned</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.parsePartitionReassignmentData" title="(jsonData: String)scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">parsePartitionReassignmentData</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.jsonString" title="String">jsonString</a><span class="delimiter">)</span>

    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;Status of partition reassignment:&quot;)" class="string">&quot;Status of partition reassignment:&quot;</span><span class="delimiter">)</span>
    val <a title="scala.collection.Map[kafka.common.TopicAndPartition,kafka.admin.ReassignmentStatus]" id="kafka.admin.ReassignPartitionsCommand.verifyAssignment.reassignedPartitionsStatus">reassignedPartitionsStatus</a> = <a href="#kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded" title="(zkClient: org.I0Itec.zkclient.ZkClient, partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])scala.collection.Map[kafka.common.TopicAndPartition,kafka.admin.ReassignmentStatus]">checkIfReassignmentSucceeded</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.partitionsToBeReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsToBeReassigned</a><span class="delimiter">)</span>
    <a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.reassignedPartitionsStatus" title="scala.collection.Map[kafka.common.TopicAndPartition,kafka.admin.ReassignmentStatus]">reassignedPartitionsStatus</a>.<span title="(f: ((kafka.common.TopicAndPartition, kafka.admin.ReassignmentStatus)) =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="(kafka.common.TopicAndPartition, kafka.admin.ReassignmentStatus)" id="kafka.admin.ReassignPartitionsCommand.verifyAssignment.$anonfun.partition">partition</a> =&gt;
      <a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.$anonfun.partition" title="(kafka.common.TopicAndPartition, kafka.admin.ReassignmentStatus)">partition</a>.<span title="=&gt; kafka.admin.ReassignmentStatus">_2</span> match <span class="delimiter">{</span>
        case <a href="#kafka.admin.ReassignmentCompleted.readResolve" title="kafka.admin.ReassignmentCompleted.type">ReassignmentCompleted</a> =&gt;
          <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Reassignment of partition %s completed successfully&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.$anonfun.partition" title="(kafka.common.TopicAndPartition, kafka.admin.ReassignmentStatus)">partition</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span><span class="delimiter">)</span><span class="delimiter">)</span>
        case <a href="#kafka.admin.ReassignmentFailed.readResolve" title="kafka.admin.ReassignmentFailed.type">ReassignmentFailed</a> =&gt;
          <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Reassignment of partition %s failed&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.$anonfun.partition" title="(kafka.common.TopicAndPartition, kafka.admin.ReassignmentStatus)">partition</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span><span class="delimiter">)</span><span class="delimiter">)</span>
        case <a href="#kafka.admin.ReassignmentInProgress.readResolve" title="kafka.admin.ReassignmentInProgress.type">ReassignmentInProgress</a> =&gt;
          <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Reassignment of partition %s is still in progress&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.verifyAssignment.$anonfun.partition" title="(kafka.common.TopicAndPartition, kafka.admin.ReassignmentStatus)">partition</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, opts: kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions)Unit" id="kafka.admin.ReassignPartitionsCommand.generateAssignment">generateAssignment</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.opts">opts</a>: <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">ReassignPartitionsCommandOptions</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    if<span class="delimiter">(</span><span title="=&gt; Boolean">!</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.topicsToMoveJsonFileOpt" title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">topicsToMoveJsonFileOpt</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.brokerListOpt" title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">brokerListOpt</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.printUsageAndDie" title="(parser: joptsimple.OptionParser, message: String)Unit">printUsageAndDie</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>, <span title="String(&quot;If --generate option is used, command must include both --topics-to-move-json-file and --broker-list options&quot;)" class="string">&quot;If --generate option is used, command must include both --topics-to-move-json-file and --broker-list options&quot;</span><span class="delimiter">)</span>
    val <a title="String" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.topicsToMoveJsonFile">topicsToMoveJsonFile</a> = <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.topicsToMoveJsonFileOpt" title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">topicsToMoveJsonFileOpt</a><span class="delimiter">)</span>
    val <a title="Array[Int]" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.brokerListToReassign">brokerListToReassign</a> = <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.brokerListOpt" title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">brokerListOpt</a><span class="delimiter">)</span>.<span title="(separator: Char)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="Char(',')" class="char">','</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],Int,Array[Int]])Array[Int]">map</span><span title="(implicit t: scala.reflect.ClassTag[Int])scala.collection.generic.CanBuildFrom[Array[_],Int,Array[Int]]" class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.brokerListToReassign.$anonfun.x$1" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>
    val <a title="Iterable[Int]" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.duplicateReassignments">duplicateReassignments</a> = <a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.duplicates" title="(s: Traversable[Int])Iterable[Int]">duplicates</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.brokerListToReassign" title="implicit scala.LowPriorityImplicits.wrapIntArray : (xs: Array[Int])scala.collection.mutable.WrappedArray[Int]">brokerListToReassign</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.duplicateReassignments" title="Iterable[Int]">duplicateReassignments</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span>
      throw new <a href="../common/AdminCommandFailedException.scala.html#kafka.common;AdminCommandFailedException" title="kafka.common.AdminCommandFailedException">AdminCommandFailedException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Broker list contains duplicate entries: %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.duplicateReassignments" title="Iterable[Int]">duplicateReassignments</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    val <a title="String" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.topicsToMoveJsonString">topicsToMoveJsonString</a> = <a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.readFileAsString" title="(path: String, charset: java.nio.charset.Charset)String">readFileAsString</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.topicsToMoveJsonFile" title="String">topicsToMoveJsonFile</a><span class="delimiter">)</span>
    val <a title="Seq[String]" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.topicsToReassign">topicsToReassign</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.parseTopicsData" title="(jsonData: String)Seq[String]">parseTopicsData</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.topicsToMoveJsonString" title="String">topicsToMoveJsonString</a><span class="delimiter">)</span>
    val <a title="Iterable[String]" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.duplicateTopicsToReassign">duplicateTopicsToReassign</a> = <a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.duplicates" title="(s: Traversable[String])Iterable[String]">duplicates</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.topicsToReassign" title="Seq[String]">topicsToReassign</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.duplicateTopicsToReassign" title="Iterable[String]">duplicateTopicsToReassign</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span>
      throw new <a href="../common/AdminCommandFailedException.scala.html#kafka.common;AdminCommandFailedException" title="kafka.common.AdminCommandFailedException">AdminCommandFailedException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;List of topics to reassign contains duplicate entries: %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.duplicateTopicsToReassign" title="Iterable[String]">duplicateTopicsToReassign</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    val <a title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.topicPartitionsToReassign">topicPartitionsToReassign</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getReplicaAssignmentForTopics" title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">getReplicaAssignmentForTopics</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.topicsToReassign" title="Seq[String]">topicsToReassign</a><span class="delimiter">)</span>

    var <a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.partitionsToBeReassigned">partitionsToBeReassigned</a> : <span title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">Map</span><span class="delimiter">[</span>TopicAndPartition, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span> = new mutable.<span title="scala.collection.mutable.HashMap[kafka.common.TopicAndPartition,List[Int]]">HashMap</span><span class="delimiter">[</span>TopicAndPartition, List<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    val <a title="scala.collection.immutable.Map[String,scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]]" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.groupedByTopic">groupedByTopic</a> = <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.topicPartitionsToReassign" title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">topicPartitionsToReassign</a>.<span title="(f: ((kafka.common.TopicAndPartition, Seq[Int])) =&gt; String)scala.collection.immutable.Map[String,scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]]">groupBy</span><span class="delimiter">(</span><a title="(kafka.common.TopicAndPartition, Seq[Int])" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.groupedByTopic.$anonfun.tp">tp</a> =&gt; <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.groupedByTopic.$anonfun.tp" title="(kafka.common.TopicAndPartition, Seq[Int])">tp</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.topic" title="=&gt; String">topic</a><span class="delimiter">)</span>
    <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.groupedByTopic" title="scala.collection.immutable.Map[String,scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]]">groupedByTopic</a>.<span title="(f: ((String, scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]])) =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="(String, scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]])" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.$anonfun.topicInfo">topicInfo</a> =&gt;
      val <a title="scala.collection.Map[Int,Seq[Int]]" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.$anonfun.assignedReplicas">assignedReplicas</a> = <a href="AdminUtils.scala.html#kafka.admin.AdminUtils" title="kafka.admin.AdminUtils.type">AdminUtils</a>.<a href="AdminUtils.scala.html#kafka.admin.AdminUtils.assignReplicasToBrokers" title="(brokerList: Seq[Int], nPartitions: Int, replicationFactor: Int, fixedStartIndex: Int, startPartitionId: Int)scala.collection.Map[Int,Seq[Int]]">assignReplicasToBrokers</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.brokerListToReassign" title="implicit scala.LowPriorityImplicits.wrapIntArray : (xs: Array[Int])scala.collection.mutable.WrappedArray[Int]">brokerListToReassign</a>, <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.$anonfun.topicInfo" title="(String, scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]])">topicInfo</a>.<span title="=&gt; scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">_2</span>.<span title="=&gt; Int">size</span>,
        <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.$anonfun.topicInfo" title="(String, scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]])">topicInfo</a>.<span title="=&gt; scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">_2</span>.<span title="=&gt; (kafka.common.TopicAndPartition, Seq[Int])">head</span>.<span title="=&gt; Seq[Int]">_2</span>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
      <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.partitionsToBeReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsToBeReassigned</a> <span title="(xs: scala.collection.GenTraversableOnce[(kafka.common.TopicAndPartition, Seq[Int])])scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">++=</span> <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.$anonfun.assignedReplicas" title="scala.collection.Map[Int,Seq[Int]]">assignedReplicas</a>.<span title="(f: ((Int, Seq[Int])) =&gt; (kafka.common.TopicAndPartition, Seq[Int]))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.Map[Int,Seq[Int]],(kafka.common.TopicAndPartition, Seq[Int]),scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]])scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Map.Coll,(kafka.common.TopicAndPartition, Seq[Int]),scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]]" class="delimiter">(</span><a title="(Int, Seq[Int])" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.$anonfun.$anonfun.replicaInfo">replicaInfo</a> =&gt; <span class="delimiter">(</span><a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition" title="(topic: String, partition: Int)kafka.common.TopicAndPartition">TopicAndPartition</a><span title="(self: kafka.common.TopicAndPartition)ArrowAssoc[kafka.common.TopicAndPartition]" class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.$anonfun.topicInfo" title="(String, scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]])">topicInfo</a>.<span title="=&gt; String">_1</span>, <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.$anonfun.$anonfun.replicaInfo" title="(Int, Seq[Int])">replicaInfo</a>.<span title="=&gt; Int">_1</span><span class="delimiter">)</span> <span title="(y: Seq[Int])(kafka.common.TopicAndPartition, Seq[Int])">-&gt;</span> <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.$anonfun.$anonfun.replicaInfo" title="(Int, Seq[Int])">replicaInfo</a>.<span title="=&gt; Seq[Int]">_2</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    val <a title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin.ReassignPartitionsCommand.generateAssignment.currentPartitionReplicaAssignment">currentPartitionReplicaAssignment</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getReplicaAssignmentForTopics" title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">getReplicaAssignmentForTopics</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.partitionsToBeReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsToBeReassigned</a>.<span title="(f: ((kafka.common.TopicAndPartition, Seq[Int])) =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]],String,Iterable[String]])Iterable[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Iterable.Coll,String,Iterable[String]]" class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.currentPartitionReplicaAssignment.$anonfun.x$2" title="(kafka.common.TopicAndPartition, Seq[Int])">_</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.topic" title="=&gt; String">topic</a><span class="delimiter">)</span>.<span title="=&gt; Seq[String]">toSeq</span><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Current partition replica assignment\n\n%s&quot;</span>
      .<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getPartitionReassignmentZkData" title="(partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])String">getPartitionReassignmentZkData</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.currentPartitionReplicaAssignment" title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">currentPartitionReplicaAssignment</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Proposed partition reassignment configuration\n\n%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getPartitionReassignmentZkData" title="(partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])String">getPartitionReassignmentZkData</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.generateAssignment.partitionsToBeReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsToBeReassigned</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, opts: kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions)Unit" id="kafka.admin.ReassignPartitionsCommand.executeAssignment">executeAssignment</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.opts">opts</a>: <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">ReassignPartitionsCommandOptions</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    if<span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.reassignmentJsonFileOpt" title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">reassignmentJsonFileOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.printUsageAndDie" title="(parser: joptsimple.OptionParser, message: String)Unit">printUsageAndDie</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>, <span class="string">&quot;If --execute option is used, command must include --reassignment-json-file that was output &quot;</span> <span title="String(&quot;If --execute option is used, command must include --reassignment-json-file that was output during the --generate option&quot;)">+</span> <span class="string">&quot;during the --generate option&quot;</span><span class="delimiter">)</span>
    val <a title="String" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.reassignmentJsonFile">reassignmentJsonFile</a> =  <a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options" title="=&gt; joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.opts" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions">opts</a>.<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.reassignmentJsonFileOpt" title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">reassignmentJsonFileOpt</a><span class="delimiter">)</span>
    val <a title="String" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.reassignmentJsonString">reassignmentJsonString</a> = <a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.readFileAsString" title="(path: String, charset: java.nio.charset.Charset)String">readFileAsString</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.reassignmentJsonFile" title="String">reassignmentJsonFile</a><span class="delimiter">)</span>
    val <a title="Seq[(kafka.common.TopicAndPartition, Seq[Int])]" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.partitionsToBeReassigned">partitionsToBeReassigned</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup" title="(jsonData: String)Seq[(kafka.common.TopicAndPartition, Seq[Int])]">parsePartitionReassignmentDataWithoutDedup</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.reassignmentJsonString" title="String">reassignmentJsonString</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.partitionsToBeReassigned" title="Seq[(kafka.common.TopicAndPartition, Seq[Int])]">partitionsToBeReassigned</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
      throw new <a href="../common/AdminCommandFailedException.scala.html#kafka.common;AdminCommandFailedException" title="kafka.common.AdminCommandFailedException">AdminCommandFailedException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Partition reassignment data file %s is empty&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.reassignmentJsonFile" title="String">reassignmentJsonFile</a><span class="delimiter">)</span><span class="delimiter">)</span>
    val <a title="Iterable[kafka.common.TopicAndPartition]" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateReassignedPartitions">duplicateReassignedPartitions</a> = <a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.duplicates" title="(s: Traversable[kafka.common.TopicAndPartition])Iterable[kafka.common.TopicAndPartition]">duplicates</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.partitionsToBeReassigned" title="Seq[(kafka.common.TopicAndPartition, Seq[Int])]">partitionsToBeReassigned</a>.<span title="(f: ((kafka.common.TopicAndPartition, Seq[Int])) =&gt; kafka.common.TopicAndPartition)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(kafka.common.TopicAndPartition, Seq[Int])],kafka.common.TopicAndPartition,Seq[kafka.common.TopicAndPartition]])Seq[kafka.common.TopicAndPartition]">map</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateReassignedPartitions.$anonfun.x0$1" title="kafka.common.TopicAndPartition" class="delimiter">{</a> case<span class="delimiter">(</span><a title="kafka.common.TopicAndPartition" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateReassignedPartitions.$anonfun.tp">tp</a>,<a title="Seq[Int]" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateReassignedPartitions.$anonfun.replicas">replicas</a><span class="delimiter">)</span> =&gt; <a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateReassignedPartitions.$anonfun.tp" title="kafka.common.TopicAndPartition">tp</a><span class="delimiter">}</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateReassignedPartitions" title="Iterable[kafka.common.TopicAndPartition]">duplicateReassignedPartitions</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span>
      throw new <a href="../common/AdminCommandFailedException.scala.html#kafka.common;AdminCommandFailedException" title="kafka.common.AdminCommandFailedException">AdminCommandFailedException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Partition reassignment contains duplicate topic partitions: %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateReassignedPartitions" title="Iterable[kafka.common.TopicAndPartition]">duplicateReassignedPartitions</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    val <a title="Seq[(kafka.common.TopicAndPartition, Iterable[Int])]" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateEntries">duplicateEntries</a>= <a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.partitionsToBeReassigned" title="Seq[(kafka.common.TopicAndPartition, Seq[Int])]">partitionsToBeReassigned</a>
      .<span title="(f: ((kafka.common.TopicAndPartition, Seq[Int])) =&gt; (kafka.common.TopicAndPartition, Iterable[Int]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(kafka.common.TopicAndPartition, Seq[Int])],(kafka.common.TopicAndPartition, Iterable[Int]),Seq[(kafka.common.TopicAndPartition, Iterable[Int])]])Seq[(kafka.common.TopicAndPartition, Iterable[Int])]">map</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateEntries.$anonfun.x0$2" title="(kafka.common.TopicAndPartition, Iterable[Int])" class="delimiter">{</a> case<span class="delimiter">(</span><span title="kafka.common.TopicAndPartition">tp</span>,<a title="Seq[Int]" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateEntries.$anonfun.replicas">replicas</a><span class="delimiter">)</span> =&gt; <span title="(_1: kafka.common.TopicAndPartition, _2: Iterable[Int])(kafka.common.TopicAndPartition, Iterable[Int])" class="delimiter">(</span><span title="kafka.common.TopicAndPartition">tp</span>, <a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.duplicates" title="(s: Traversable[Int])Iterable[Int]">duplicates</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateEntries.$anonfun.replicas" title="Seq[Int]">replicas</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">}</span>
      .<span title="(p: ((kafka.common.TopicAndPartition, Iterable[Int])) =&gt; Boolean)Seq[(kafka.common.TopicAndPartition, Iterable[Int])]">filter</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateEntries.$anonfun.x0$3" title="Boolean" class="delimiter">{</a> case <span class="delimiter">(</span><span title="kafka.common.TopicAndPartition">tp</span>,<a title="Iterable[Int]" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateEntries.$anonfun.duplicatedReplicas">duplicatedReplicas</a><span class="delimiter">)</span> =&gt; <a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateEntries.$anonfun.duplicatedReplicas" title="Iterable[Int]">duplicatedReplicas</a>.<span title="=&gt; Boolean">nonEmpty</span> <span class="delimiter">}</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateEntries" title="Seq[(kafka.common.TopicAndPartition, Iterable[Int])]">duplicateEntries</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="String" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicatesMsg">duplicatesMsg</a> = <a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicateEntries" title="Seq[(kafka.common.TopicAndPartition, Iterable[Int])]">duplicateEntries</a>
        .<span title="(f: ((kafka.common.TopicAndPartition, Iterable[Int])) =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(kafka.common.TopicAndPartition, Iterable[Int])],String,Seq[String]])Seq[String]">map</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicatesMsg.$anonfun.x0$4" title="String" class="delimiter">{</a> case <span class="delimiter">(</span><a title="kafka.common.TopicAndPartition" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicatesMsg.$anonfun.tp">tp</a>,<a title="Iterable[Int]" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicatesMsg.$anonfun.duplicateReplicas">duplicateReplicas</a><span class="delimiter">)</span> =&gt; <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s contains multiple entries for %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicatesMsg.$anonfun.tp" title="kafka.common.TopicAndPartition">tp</a>, <a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicatesMsg.$anonfun.duplicateReplicas" title="Iterable[Int]">duplicateReplicas</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span>
        .<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;. &quot;)" class="string">&quot;. &quot;</span><span class="delimiter">)</span>
      throw new <a href="../common/AdminCommandFailedException.scala.html#kafka.common;AdminCommandFailedException" title="kafka.common.AdminCommandFailedException">AdminCommandFailedException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Partition replica lists may not contain duplicate entries: %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.duplicatesMsg" title="String">duplicatesMsg</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    val <a title="kafka.admin.ReassignPartitionsCommand" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.reassignPartitionsCommand">reassignPartitionsCommand</a> = new <a href="#kafka.admin;ReassignPartitionsCommand" title="kafka.admin.ReassignPartitionsCommand">ReassignPartitionsCommand</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.partitionsToBeReassigned" title="Seq[(kafka.common.TopicAndPartition, Seq[Int])]">partitionsToBeReassigned</a>.<span title="(implicit ev: &lt;:&lt;[(kafka.common.TopicAndPartition, Seq[Int]),(kafka.common.TopicAndPartition, Seq[Int])])scala.collection.immutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">toMap</span><span class="delimiter">)</span>
    <span class="comment">// before starting assignment, output the current replica assignment to facilitate rollback</span>
    val <a title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin.ReassignPartitionsCommand.executeAssignment.currentPartitionReplicaAssignment">currentPartitionReplicaAssignment</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getReplicaAssignmentForTopics" title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">getReplicaAssignmentForTopics</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.partitionsToBeReassigned" title="Seq[(kafka.common.TopicAndPartition, Seq[Int])]">partitionsToBeReassigned</a>.<span title="(f: ((kafka.common.TopicAndPartition, Seq[Int])) =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(kafka.common.TopicAndPartition, Seq[Int])],String,Seq[String]])Seq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,String,Seq[String]]" class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.currentPartitionReplicaAssignment.$anonfun.x$3" title="(kafka.common.TopicAndPartition, Seq[Int])">_</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.topic" title="=&gt; String">topic</a><span class="delimiter">)</span>.<span title="=&gt; Seq[String]">toSeq</span><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Current partition replica assignment\n\n%s\n\nSave this to use as the --reassignment-json-file option during rollback&quot;</span>
      .<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getPartitionReassignmentZkData" title="(partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])String">getPartitionReassignmentZkData</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.currentPartitionReplicaAssignment" title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">currentPartitionReplicaAssignment</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="comment">// start the reassignment</span>
    if<span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.reassignPartitionsCommand" title="kafka.admin.ReassignPartitionsCommand">reassignPartitionsCommand</a>.<a href="#kafka.admin;ReassignPartitionsCommand.reassignPartitions" title="()Boolean">reassignPartitions</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Successfully started reassignment of partitions %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getPartitionReassignmentZkData" title="(partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])String">getPartitionReassignmentZkData</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.partitionsToBeReassigned" title="Seq[(kafka.common.TopicAndPartition, Seq[Int])]">partitionsToBeReassigned</a>.<span title="(implicit ev: &lt;:&lt;[(kafka.common.TopicAndPartition, Seq[Int]),(kafka.common.TopicAndPartition, Seq[Int])])scala.collection.immutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">toMap</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    else
      <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Failed to reassign partitions %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.executeAssignment.partitionsToBeReassigned" title="Seq[(kafka.common.TopicAndPartition, Seq[Int])]">partitionsToBeReassigned</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])scala.collection.Map[kafka.common.TopicAndPartition,kafka.admin.ReassignmentStatus]" id="kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded">checkIfReassignmentSucceeded</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.partitionsToBeReassigned">partitionsToBeReassigned</a>: <span title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">Map</span><span class="delimiter">[</span>TopicAndPartition, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
  :<span title="scala.collection.Map[kafka.common.TopicAndPartition,kafka.admin.ReassignmentStatus]">Map</span><span class="delimiter">[</span>TopicAndPartition, ReassignmentStatus<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.partitionsBeingReassigned">partitionsBeingReassigned</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getPartitionsBeingReassigned" title="(zkClient: org.I0Itec.zkclient.ZkClient)scala.collection.Map[kafka.common.TopicAndPartition,kafka.controller.ReassignedPartitionsContext]">getPartitionsBeingReassigned</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a><span class="delimiter">)</span>.<span title="(f: kafka.controller.ReassignedPartitionsContext =&gt; Seq[Int])scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">mapValues</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.partitionsBeingReassigned.$anonfun.x$4" title="kafka.controller.ReassignedPartitionsContext">_</a>.<a href="../controller/KafkaController.scala.html#kafka.controller;ReassignedPartitionsContext.newReplicas" title="=&gt; Seq[Int]">newReplicas</a><span class="delimiter">)</span>
    <a href="#kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.partitionsToBeReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsToBeReassigned</a>.<span title="(f: ((kafka.common.TopicAndPartition, Seq[Int])) =&gt; (kafka.common.TopicAndPartition, kafka.admin.ReassignmentStatus))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]],(kafka.common.TopicAndPartition, kafka.admin.ReassignmentStatus),scala.collection.Map[kafka.common.TopicAndPartition,kafka.admin.ReassignmentStatus]])scala.collection.Map[kafka.common.TopicAndPartition,kafka.admin.ReassignmentStatus]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Map.Coll,(kafka.common.TopicAndPartition, kafka.admin.ReassignmentStatus),scala.collection.Map[kafka.common.TopicAndPartition,kafka.admin.ReassignmentStatus]]" class="delimiter">{</span> <a title="(kafka.common.TopicAndPartition, Seq[Int])" id="kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.$anonfun.topicAndPartition">topicAndPartition</a> =&gt;
      <span title="(_1: kafka.common.TopicAndPartition, _2: kafka.admin.ReassignmentStatus)(kafka.common.TopicAndPartition, kafka.admin.ReassignmentStatus)" class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.$anonfun.topicAndPartition" title="(kafka.common.TopicAndPartition, Seq[Int])">topicAndPartition</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span>, <a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded" title="(zkClient: org.I0Itec.zkclient.ZkClient, topicAndPartition: kafka.common.TopicAndPartition, reassignedReplicas: Seq[Int], partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]], partitionsBeingReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])kafka.admin.ReassignmentStatus">checkIfPartitionReassignmentSucceeded</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.$anonfun.topicAndPartition" title="(kafka.common.TopicAndPartition, Seq[Int])">topicAndPartition</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span>,
        <a href="#kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.$anonfun.topicAndPartition" title="(kafka.common.TopicAndPartition, Seq[Int])">topicAndPartition</a>.<span title="=&gt; Seq[Int]">_2</span>, <a href="#kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.partitionsToBeReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsToBeReassigned</a>, <a href="#kafka.admin.ReassignPartitionsCommand.checkIfReassignmentSucceeded.partitionsBeingReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsBeingReassigned</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topicAndPartition: kafka.common.TopicAndPartition, reassignedReplicas: Seq[Int], partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]], partitionsBeingReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])kafka.admin.ReassignmentStatus" id="kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded">checkIfPartitionReassignmentSucceeded</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="kafka.common.TopicAndPartition" id="kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.topicAndPartition">topicAndPartition</a>: <a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition" title="kafka.common.TopicAndPartition">TopicAndPartition</a>,
                                            <a title="Seq[Int]" id="kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.reassignedReplicas">reassignedReplicas</a>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>,
                                            <a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.partitionsToBeReassigned">partitionsToBeReassigned</a>: <span title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">Map</span><span class="delimiter">[</span>TopicAndPartition, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span>,
                                            <a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.partitionsBeingReassigned">partitionsBeingReassigned</a>: <span title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">Map</span><span class="delimiter">[</span>TopicAndPartition, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#kafka.admin;ReassignmentStatus" title="kafka.admin.ReassignmentStatus">ReassignmentStatus</a> = <span class="delimiter">{</span>
    val <a title="Seq[Int]" id="kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.newReplicas">newReplicas</a> = <a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.partitionsToBeReassigned" title="(key: kafka.common.TopicAndPartition)Seq[Int]">partitionsToBeReassigned</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.topicAndPartition" title="kafka.common.TopicAndPartition">topicAndPartition</a><span class="delimiter">)</span>
    <a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.partitionsBeingReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsBeingReassigned</a>.<span title="(key: kafka.common.TopicAndPartition)Option[Seq[Int]]">get</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.topicAndPartition" title="kafka.common.TopicAndPartition">topicAndPartition</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="Seq[Int]" id="kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.partition">partition</a><span class="delimiter">)</span> =&gt; <a href="#kafka.admin.ReassignmentInProgress.readResolve" title="kafka.admin.ReassignmentInProgress.type">ReassignmentInProgress</a>
      case <span title="None.type">None</span> =&gt;
        <span class="comment">// check if the current replica assignment matches the expected one after reassignment</span>
        val <a title="Seq[Int]" id="kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.assignedReplicas">assignedReplicas</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getReplicasForPartition" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Seq[Int]">getReplicasForPartition</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.topicAndPartition" title="kafka.common.TopicAndPartition">topicAndPartition</a>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.topic" title="=&gt; String">topic</a>, <a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.topicAndPartition" title="kafka.common.TopicAndPartition">topicAndPartition</a>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.partition" title="=&gt; Int">partition</a><span class="delimiter">)</span>
        if<span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.assignedReplicas" title="Seq[Int]">assignedReplicas</a> <span title="(x$1: Any)Boolean">==</span> <a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.newReplicas" title="Seq[Int]">newReplicas</a><span class="delimiter">)</span>
          <a href="#kafka.admin.ReassignmentCompleted.readResolve" title="kafka.admin.ReassignmentCompleted.type">ReassignmentCompleted</a>
        else <span class="delimiter">{</span>
          <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span class="delimiter">(</span><span class="string">&quot;ERROR: Assigned replicas (%s) don't match the list of replicas for reassignment (%s)&quot;</span> <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">+</span>
            <span class="string">&quot; for partition %s&quot;</span><span class="delimiter">)</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.assignedReplicas" title="Seq[Int]">assignedReplicas</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span>, <a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.newReplicas" title="Seq[Int]">newReplicas</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span>, <a href="#kafka.admin.ReassignPartitionsCommand.checkIfPartitionReassignmentSucceeded.topicAndPartition" title="kafka.common.TopicAndPartition">topicAndPartition</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#kafka.admin.ReassignmentFailed.readResolve" title="kafka.admin.ReassignmentFailed.type">ReassignmentFailed</a>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  class <a title="class ReassignPartitionsCommandOptions extends AnyRef" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions">ReassignPartitionsCommandOptions</a><a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions" title="kafka.admin.ReassignPartitionsCommand.ReassignPartitionsCommandOptions" class="delimiter">(</a><a title="Array[String]" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.args">args</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="joptsimple.OptionParser" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser">parser</a> = new <span title="joptsimple.OptionParser">OptionParser</span>

    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.zkConnectOpt">zkConnectOpt</a> = <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;zookeeper&quot;)" class="string">&quot;zookeeper&quot;</span>, <span class="string">&quot;REQUIRED: The connection string for the zookeeper connection in the &quot;</span> <span title="String(&quot;REQUIRED: The connection string for the zookeeper connection in the form host:port. Multiple URLS can be given to allow fail-over.&quot;)">+</span>
                      <span class="string">&quot;form host:port. Multiple URLS can be given to allow fail-over.&quot;</span><span class="delimiter">)</span>
                      .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
                      .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;urls&quot;)" class="string">&quot;urls&quot;</span><span class="delimiter">)</span>
                      .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.OptionSpecBuilder" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.generateOpt">generateOpt</a> = <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;generate&quot;)" class="string">&quot;generate&quot;</span>, <span class="string">&quot;Generate a candidate partition reassignment configuration.&quot;</span> <span title="String(&quot;Generate a candidate partition reassignment configuration. Note that this only generates a candidate assignment, it does not execute it.&quot;)">+</span>
      <span class="string">&quot; Note that this only generates a candidate assignment, it does not execute it.&quot;</span><span class="delimiter">)</span>
    val <a title="joptsimple.OptionSpecBuilder" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.executeOpt">executeOpt</a> = <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;execute&quot;)" class="string">&quot;execute&quot;</span>, <span title="String(&quot;Kick off the reassignment as specified by the --reassignment-json-file option.&quot;)" class="string">&quot;Kick off the reassignment as specified by the --reassignment-json-file option.&quot;</span><span class="delimiter">)</span>
    val <a title="joptsimple.OptionSpecBuilder" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.verifyOpt">verifyOpt</a> = <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;verify&quot;)" class="string">&quot;verify&quot;</span>, <span title="String(&quot;Verify if the reassignment completed as specified by the --reassignment-json-file option.&quot;)" class="string">&quot;Verify if the reassignment completed as specified by the --reassignment-json-file option.&quot;</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.reassignmentJsonFileOpt">reassignmentJsonFileOpt</a> = <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;reassignment-json-file&quot;)" class="string">&quot;reassignment-json-file&quot;</span>, <span class="string">&quot;The JSON file with the partition reassignment configuration&quot;</span> +
                      <span class="string">&quot;The format to use is - \n&quot;</span> <span title="String(&quot;The JSON file with the partition reassignment configurationThe format to use is - \n{\&quot;partitions\&quot;:\n\t[{\&quot;topic\&quot;: \&quot;foo\&quot;,\n\t  \&quot;partition\&quot;: 1,\n\t  \&quot;replicas\&quot;: [1,2,3] }],\n\&quot;version\&quot;:1\n}&quot;)">+</span>
                      <span class="string">&quot;{\&quot;partitions\&quot;:\n\t[{\&quot;topic\&quot;: \&quot;foo\&quot;,\n\t  \&quot;partition\&quot;: 1,\n\t  \&quot;replicas\&quot;: [1,2,3] }],\n\&quot;version\&quot;:1\n}&quot;</span><span class="delimiter">)</span>
                      .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
                      .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;manual assignment json file path&quot;)" class="string">&quot;manual assignment json file path&quot;</span><span class="delimiter">)</span>
                      .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.topicsToMoveJsonFileOpt">topicsToMoveJsonFileOpt</a> = <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;topics-to-move-json-file&quot;)" class="string">&quot;topics-to-move-json-file&quot;</span>, <span class="string">&quot;Generate a reassignment configuration to move the partitions&quot;</span> +
                      <span class="string">&quot; of the specified topics to the list of brokers specified by the --broker-list option. The format to use is - \n&quot;</span> <span title="String(&quot;Generate a reassignment configuration to move the partitions of the specified topics to the list of brokers specified by the --broker-list option. The format to use is - \n{\&quot;topics\&quot;:\n\t[{\&quot;topic\&quot;: \&quot;foo\&quot;},{\&quot;topic\&quot;: \&quot;foo1\&quot;}],\n\&quot;version\&quot;:1\n}&quot;)">+</span>
                      <span class="string">&quot;{\&quot;topics\&quot;:\n\t[{\&quot;topic\&quot;: \&quot;foo\&quot;},{\&quot;topic\&quot;: \&quot;foo1\&quot;}],\n\&quot;version\&quot;:1\n}&quot;</span><span class="delimiter">)</span>
                      .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
                      .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;topics to reassign json file path&quot;)" class="string">&quot;topics to reassign json file path&quot;</span><span class="delimiter">)</span>
                      .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.brokerListOpt">brokerListOpt</a> = <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;broker-list&quot;)" class="string">&quot;broker-list&quot;</span>, <span class="string">&quot;The list of brokers to which the partitions need to be reassigned&quot;</span> <span title="String(&quot;The list of brokers to which the partitions need to be reassigned in the form \&quot;0,1,2\&quot;. This is required if --topics-to-move-json-file is used to generate reassignment configuration&quot;)">+</span>
                      <span class="string">&quot; in the form \&quot;0,1,2\&quot;. This is required if --topics-to-move-json-file is used to generate reassignment configuration&quot;</span><span class="delimiter">)</span>
                      .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
                      .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;brokerlist&quot;)" class="string">&quot;brokerlist&quot;</span><span class="delimiter">)</span>
                      .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
                      
    if<span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.args" title="Array[String]">args</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.printUsageAndDie" title="(parser: joptsimple.OptionParser, message: String)Unit">printUsageAndDie</a><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>, <span title="String(&quot;This command moves topic partitions between replicas.&quot;)" class="string">&quot;This command moves topic partitions between replicas.&quot;</span><span class="delimiter">)</span>

    val <a title="joptsimple.OptionSet" id="kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.options">options</a> = <a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.parser" title="=&gt; joptsimple.OptionParser">parser</a>.<span title="(x$1: String*)joptsimple.OptionSet">parse</span><span class="delimiter">(</span><a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions.args" title="Array[String]">args</a> : _*<span class="delimiter">)</span>
  <span class="delimiter">}</span>
<a href="#kafka.admin.ReassignPartitionsCommand;ReassignPartitionsCommandOptions" title="AnyRef" class="delimiter">}</a>

class <a title="class ReassignPartitionsCommand extends AnyRef with kafka.utils.Logging" id="kafka.admin;ReassignPartitionsCommand">ReassignPartitionsCommand</a><a href="#kafka.admin;ReassignPartitionsCommand" title="kafka.admin.ReassignPartitionsCommand" class="delimiter">(</a><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin;ReassignPartitionsCommand.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin;ReassignPartitionsCommand.partitions">partitions</a>: collection.<span title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">Map</span><span class="delimiter">[</span>TopicAndPartition, collection.Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
  extends <a href="../utils/Logging.scala.html#kafka.utils;Logging" title="kafka.utils.Logging">Logging</a> <span class="delimiter">{</span>
  def <a title="()Boolean" id="kafka.admin;ReassignPartitionsCommand.reassignPartitions">reassignPartitions</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      val <a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin;ReassignPartitionsCommand.reassignPartitions.validPartitions">validPartitions</a> = <a href="#kafka.admin;ReassignPartitionsCommand.partitions" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitions</a>.<span title="(p: ((kafka.common.TopicAndPartition, Seq[Int])) =&gt; Boolean)scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">filter</span><span class="delimiter">(</span><a title="(kafka.common.TopicAndPartition, Seq[Int])" id="kafka.admin;ReassignPartitionsCommand.reassignPartitions.validPartitions.$anonfun.p">p</a> =&gt; <a href="#kafka.admin;ReassignPartitionsCommand.validatePartition" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Boolean">validatePartition</a><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin;ReassignPartitionsCommand.reassignPartitions.validPartitions.$anonfun.p" title="(kafka.common.TopicAndPartition, Seq[Int])">p</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.topic" title="=&gt; String">topic</a>, <a href="#kafka.admin;ReassignPartitionsCommand.reassignPartitions.validPartitions.$anonfun.p" title="(kafka.common.TopicAndPartition, Seq[Int])">p</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.partition" title="=&gt; Int">partition</a><span class="delimiter">)</span><span class="delimiter">)</span>
      val <a title="String" id="kafka.admin;ReassignPartitionsCommand.reassignPartitions.jsonReassignmentData">jsonReassignmentData</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getPartitionReassignmentZkData" title="(partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])String">getPartitionReassignmentZkData</a><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.reassignPartitions.validPartitions" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">validPartitions</a><span class="delimiter">)</span>
      <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.createPersistentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit">createPersistentPath</a><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.ReassignPartitionsPath" title="=&gt; String">ReassignPartitionsPath</a>, <a href="#kafka.admin;ReassignPartitionsCommand.reassignPartitions.jsonReassignmentData" title="String">jsonReassignmentData</a><span class="delimiter">)</span>
      true
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNodeExistsException" id="kafka.admin;ReassignPartitionsCommand.reassignPartitions.ze">ze</a>: <span title="org.I0Itec.zkclient.exception.ZkNodeExistsException">ZkNodeExistsException</span> =&gt;
        val <a title="scala.collection.Map[kafka.common.TopicAndPartition,kafka.controller.ReassignedPartitionsContext]" id="kafka.admin;ReassignPartitionsCommand.reassignPartitions.partitionsBeingReassigned">partitionsBeingReassigned</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getPartitionsBeingReassigned" title="(zkClient: org.I0Itec.zkclient.ZkClient)scala.collection.Map[kafka.common.TopicAndPartition,kafka.controller.ReassignedPartitionsContext]">getPartitionsBeingReassigned</a><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a><span class="delimiter">)</span>
        throw new <a href="../common/AdminCommandFailedException.scala.html#kafka.common;AdminCommandFailedException" title="kafka.common.AdminCommandFailedException">AdminCommandFailedException</a><span class="delimiter">(</span><span title="String(&quot;Partition reassignment currently in &quot;)" class="string">&quot;Partition reassignment currently in &quot;</span> <span title="(x$1: Any)String">+</span>
        <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;progress for %s. Aborting operation&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.reassignPartitions.partitionsBeingReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,kafka.controller.ReassignedPartitionsContext]">partitionsBeingReassigned</a><span class="delimiter">)</span><span class="delimiter">)</span>
      case <a title="Throwable" id="kafka.admin;ReassignPartitionsCommand.reassignPartitions.e">e</a>: <span title="Throwable">Throwable</span> =&gt; <a href="../utils/Logging.scala.html#kafka.utils;Logging.error(cfd112d89b)" title="(msg: =&gt; String, e: =&gt; Throwable)Unit">error</a><span class="delimiter">(</span><span title="String(&quot;Admin command failed&quot;)" class="string">&quot;Admin command failed&quot;</span>, <a href="#kafka.admin;ReassignPartitionsCommand.reassignPartitions.e" title="Throwable">e</a><span class="delimiter">)</span>; false
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Boolean" id="kafka.admin;ReassignPartitionsCommand.validatePartition">validatePartition</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin;ReassignPartitionsCommand.validatePartition.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.admin;ReassignPartitionsCommand.validatePartition.topic">topic</a>: <span title="String">String</span>, <a title="Int" id="kafka.admin;ReassignPartitionsCommand.validatePartition.partition">partition</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span class="comment">// check if partition exists</span>
    val <a title="Option[Seq[Int]]" id="kafka.admin;ReassignPartitionsCommand.validatePartition.partitionsOpt">partitionsOpt</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getPartitionsForTopics" title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[String,Seq[Int]]">getPartitionsForTopics</a><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <span title="(xs: String*)List[String]">List</span><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(key: String)Option[Seq[Int]]">get</span><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.topic" title="String">topic</a><span class="delimiter">)</span>
    <a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.partitionsOpt" title="Option[Seq[Int]]">partitionsOpt</a> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="Seq[Int]" id="kafka.admin;ReassignPartitionsCommand.validatePartition.partitions">partitions</a><span class="delimiter">)</span> =&gt;
        if<span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.partitions" title="Seq[Int]">partitions</a>.<span title="(elem: Int)Boolean">contains</span><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.partition" title="Int">partition</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          true
        <span class="delimiter">}</span>else<span class="delimiter">{</span>
          <a href="../utils/Logging.scala.html#kafka.utils;Logging.error(1729dbc42f)" title="(msg: =&gt; String)Unit">error</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Skipping reassignment of partition [%s,%d] &quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.topic" title="String">topic</a>, <a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.partition" title="Int">partition</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span>
            <span title="String(&quot;since it doesn\'t exist&quot;)" class="string">&quot;since it doesn't exist&quot;</span><span class="delimiter">)</span>
          false
        <span class="delimiter">}</span>
      case <span title="None.type">None</span> =&gt; <a href="../utils/Logging.scala.html#kafka.utils;Logging.error(1729dbc42f)" title="(msg: =&gt; String)Unit">error</a><span class="delimiter">(</span><span title="String(&quot;Skipping reassignment of partition &quot;)" class="string">&quot;Skipping reassignment of partition &quot;</span> <span title="(x$1: Any)String">+</span>
        <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;[%s,%d] since topic %s doesn't exist&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.topic" title="String">topic</a>, <a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.partition" title="Int">partition</a>, <a href="#kafka.admin;ReassignPartitionsCommand.validatePartition.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>
        false
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

sealed trait <a title="trait ReassignmentStatus extends AnyRef" id="kafka.admin;ReassignmentStatus">ReassignmentStatus</a> <span class="delimiter">{</span> def <a title="=&gt; Int" id="kafka.admin;ReassignmentStatus.status">status</a>: <span title="Int">Int</span> <span class="delimiter">}</span>
case object <a href="#kafka.admin.ReassignmentCompleted.productElement.x$1" title="kafka.admin.ReassignmentCompleted.type" id="kafka.admin.ReassignmentCompleted.readResolve">ReassignmentCompleted</a> extends <a href="#kafka.admin;ReassignmentStatus" title="kafka.admin.ReassignmentStatus">ReassignmentStatus</a> <span class="delimiter">{</span> val <a title="Int" id="kafka.admin.ReassignmentCompleted.status">status</a> = <span title="Int(1)" class="int">1</span> <span class="delimiter">}</span>
case object <a href="#kafka.admin.ReassignmentInProgress.productElement.x$1" title="kafka.admin.ReassignmentInProgress.type" id="kafka.admin.ReassignmentInProgress.readResolve">ReassignmentInProgress</a> extends <a href="#kafka.admin;ReassignmentStatus" title="kafka.admin.ReassignmentStatus">ReassignmentStatus</a> <span class="delimiter">{</span> val <a title="Int" id="kafka.admin.ReassignmentInProgress.status">status</a> = <span title="Int(0)" class="int">0</span> <span class="delimiter">}</span>
case object <a href="#kafka.admin.ReassignmentFailed.productElement.x$1" title="kafka.admin.ReassignmentFailed.type" id="kafka.admin.ReassignmentFailed.readResolve">ReassignmentFailed</a> extends <a href="#kafka.admin;ReassignmentStatus" title="kafka.admin.ReassignmentStatus">ReassignmentStatus</a> <span class="delimiter">{</span> val <a title="Int" id="kafka.admin.ReassignmentFailed.status">status</a> = -<span title="Int(-1)" class="int">1</span> <span class="delimiter">}</span>

        </pre>
    </body>
</html>

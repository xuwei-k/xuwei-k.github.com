<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>kafka/kafka/admin/AdminUtils.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

package kafka.admin

import java.util.Random
import java.util.Properties
import kafka.api.<span class="delimiter">{</span>TopicMetadata, PartitionMetadata<span class="delimiter">}</span>
import kafka.cluster.Broker
import kafka.log.LogConfig
import kafka.utils.<span class="delimiter">{</span>Logging, ZkUtils, Json<span class="delimiter">}</span>
import org.I0Itec.zkclient.ZkClient
import org.I0Itec.zkclient.exception.ZkNodeExistsException
import scala.collection._
import mutable.ListBuffer
import scala.collection.mutable
import kafka.common._
import scala.<span title="type">Predef</span>._
import collection.Map
import scala.Some
import collection.Set

object <a title="kafka.admin.AdminUtils.type" id="kafka.admin.AdminUtils">AdminUtils</a> extends <a href="../utils/Logging.scala.html#kafka.utils;Logging" title="kafka.utils.Logging">Logging</a> <span class="delimiter">{</span>
  val <a title="java.util.Random" id="kafka.admin.AdminUtils.rand">rand</a> = new <span title="java.util.Random">Random</span>
  val <a title="String" id="kafka.admin.AdminUtils.TopicConfigChangeZnodePrefix">TopicConfigChangeZnodePrefix</a> = <span title="String(&quot;config_change_&quot;)" class="string">&quot;config_change_&quot;</span>

  <span class="comment">/**
   * There are 2 goals of replica assignment:
   * 1. Spread the replicas evenly among brokers.
   * 2. For partitions assigned to a particular broker, their other replicas are spread over the other brokers.
   *
   * To achieve this goal, we:
   * 1. Assign the first replica of each partition by round-robin, starting from a random position in the broker list.
   * 2. Assign the remaining replicas of each partition with an increasing shift.
   *
   * Here is an example of assigning
   * broker-0  broker-1  broker-2  broker-3  broker-4
   * p0        p1        p2        p3        p4       (1st replica)
   * p5        p6        p7        p8        p9       (1st replica)
   * p4        p0        p1        p2        p3       (2nd replica)
   * p8        p9        p5        p6        p7       (2nd replica)
   * p3        p4        p0        p1        p2       (3nd replica)
   * p7        p8        p9        p5        p6       (3nd replica)
   */</span>
  def <a title="(brokerList: Seq[Int], nPartitions: Int, replicationFactor: Int, fixedStartIndex: Int, startPartitionId: Int)scala.collection.Map[Int,Seq[Int]]" id="kafka.admin.AdminUtils.assignReplicasToBrokers">assignReplicasToBrokers</a><span class="delimiter">(</span><a title="Seq[Int]" id="kafka.admin.AdminUtils.assignReplicasToBrokers.brokerList">brokerList</a>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>,
                              <a title="Int" id="kafka.admin.AdminUtils.assignReplicasToBrokers.nPartitions">nPartitions</a>: <span title="Int">Int</span>,
                              <a title="Int" id="kafka.admin.AdminUtils.assignReplicasToBrokers.replicationFactor">replicationFactor</a>: <span title="Int">Int</span>,
                              <a title="Int" id="kafka.admin.AdminUtils.assignReplicasToBrokers$default$4">fixedStartIndex</a>: <span title="Int">Int</span> = -<span title="Int(-1)" class="int">1</span>,
                              <a title="Int" id="kafka.admin.AdminUtils.assignReplicasToBrokers$default$5">startPartitionId</a>: <span title="Int">Int</span> = -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span>
  : <span title="scala.collection.Map[Int,Seq[Int]]">Map</span><span class="delimiter">[</span>Int, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.nPartitions" title="Int">nPartitions</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span title="String(&quot;number of partitions must be larger than 0&quot;)" class="string">&quot;number of partitions must be larger than 0&quot;</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.replicationFactor" title="Int">replicationFactor</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span title="String(&quot;replication factor must be larger than 0&quot;)" class="string">&quot;replication factor must be larger than 0&quot;</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.replicationFactor" title="Int">replicationFactor</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.brokerList" title="Seq[Int]">brokerList</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
      throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span title="String(&quot;replication factor: &quot;)" class="string">&quot;replication factor: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.replicationFactor" title="Int">replicationFactor</a> <span title="(x$1: Any)String">+</span>
        <span title="String(&quot; larger than available brokers: &quot;)" class="string">&quot; larger than available brokers: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.brokerList" title="Seq[Int]">brokerList</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
    val <a title="scala.collection.mutable.HashMap[Int,List[Int]]" id="kafka.admin.AdminUtils.assignReplicasToBrokers.ret">ret</a> = new mutable.<span title="scala.collection.mutable.HashMap[Int,List[Int]]">HashMap</span><span class="delimiter">[</span>Int, List<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    val <a title="Int" id="kafka.admin.AdminUtils.assignReplicasToBrokers.startIndex">startIndex</a> = if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers$default$4" title="Int">fixedStartIndex</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers$default$4" title="Int">fixedStartIndex</a> else <a href="#kafka.admin.AdminUtils.rand" title="=&gt; java.util.Random">rand</a>.<span title="(x$1: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.brokerList" title="Seq[Int]">brokerList</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
    var <a title="Int" id="kafka.admin.AdminUtils.assignReplicasToBrokers.currentPartitionId">currentPartitionId</a> = if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers$default$5" title="Int">startPartitionId</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers$default$5" title="Int">startPartitionId</a> else <span title="Int(0)" class="int">0</span>

    var <a title="Int" id="kafka.admin.AdminUtils.assignReplicasToBrokers.nextReplicaShift">nextReplicaShift</a> = if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers$default$4" title="Int">fixedStartIndex</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers$default$4" title="Int">fixedStartIndex</a> else <a href="#kafka.admin.AdminUtils.rand" title="=&gt; java.util.Random">rand</a>.<span title="(x$1: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.brokerList" title="Seq[Int]">brokerList</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
    for <span class="delimiter">(</span><a title="Int" id="kafka.admin.AdminUtils.assignReplicasToBrokers.$anonfun.i">i</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.nPartitions" title="Int">nPartitions</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.currentPartitionId" title="Int">currentPartitionId</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.currentPartitionId" title="Int">currentPartitionId</a> <span title="(x: Int)Int">%</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.brokerList" title="Seq[Int]">brokerList</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.nextReplicaShift" title="Int">nextReplicaShift</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
      val firstReplicaIndex = <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.currentPartitionId" title="Int">currentPartitionId</a> <span title="(x: Int)Int">+</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.startIndex" title="Int">startIndex</a><span class="delimiter">)</span> <a title="Int" id="kafka.admin.AdminUtils.assignReplicasToBrokers.$anonfun.firstReplicaIndex">%</a> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.brokerList" title="Seq[Int]">brokerList</a>.<span title="=&gt; Int">size</span>
      var <a title="List[Int]" id="kafka.admin.AdminUtils.assignReplicasToBrokers.$anonfun.replicaList">replicaList</a> = <span title="(xs: Int*)List[Int]">List</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.brokerList" title="(idx: Int)Int">brokerList</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.$anonfun.firstReplicaIndex" title="Int">firstReplicaIndex</a><span class="delimiter">)</span><span class="delimiter">)</span>
      for <span class="delimiter">(</span><a title="Int" id="kafka.admin.AdminUtils.assignReplicasToBrokers.$anonfun.$anonfun.j">j</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.replicationFactor" title="Int">replicationFactor</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.$anonfun.replicaList" title="List[Int]">replicaList</a> <span title="(x: Int)List[Int]">::=</span> <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.brokerList" title="(idx: Int)Int">brokerList</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.replicaIndex" title="(firstReplicaIndex: Int, secondReplicaShift: Int, replicaIndex: Int, nBrokers: Int)Int">replicaIndex</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.$anonfun.firstReplicaIndex" title="Int">firstReplicaIndex</a>, <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.nextReplicaShift" title="Int">nextReplicaShift</a>, <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.$anonfun.$anonfun.j" title="Int">j</a>, <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.brokerList" title="Seq[Int]">brokerList</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.ret" title="scala.collection.mutable.HashMap[Int,List[Int]]">ret</a>.<span title="(key: Int, value: List[Int])Option[List[Int]]">put</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.currentPartitionId" title="Int">currentPartitionId</a>, <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.$anonfun.replicaList" title="List[Int]">replicaList</a>.<span title="=&gt; List[Int]">reverse</span><span class="delimiter">)</span>
      <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.currentPartitionId" title="Int">currentPartitionId</a> = <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.currentPartitionId" title="Int">currentPartitionId</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#kafka.admin.AdminUtils.assignReplicasToBrokers.ret" title="scala.collection.mutable.HashMap[Int,List[Int]]">ret</a>.<span title="(implicit ev: &lt;:&lt;[(Int, List[Int]),(Int, Seq[Int])])scala.collection.immutable.Map[Int,Seq[Int]]">toMap</span>
  <span class="delimiter">}</span>


 <span class="comment">/**
  * Add partitions to existing topic with optional replica assignment
  *
  * @param zkClient Zookeeper client
  * @param topic Topic for adding partitions to
  * @param numPartitions Number of partitions to be set
  * @param replicaAssignmentStr Manual replica assignment
  * @param checkBrokerAvailable Ignore checking if assigned replica broker is available. Only used for testing
  * @param config Pre-existing properties that should be preserved
  */</span>
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, numPartitions: Int, replicaAssignmentStr: String, checkBrokerAvailable: Boolean, config: java.util.Properties)Unit" id="kafka.admin.AdminUtils.addPartitions">addPartitions</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.addPartitions.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>,
                    <a title="String" id="kafka.admin.AdminUtils.addPartitions.topic">topic</a>: <span title="String">String</span>,
                    <a title="Int" id="kafka.admin.AdminUtils.addPartitions$default$3">numPartitions</a>: <span title="Int">Int</span> = <span title="Int(1)" class="int">1</span>,
                    <a title="String" id="kafka.admin.AdminUtils.addPartitions$default$4">replicaAssignmentStr</a>: <span title="String">String</span> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>,
                    <a title="Boolean" id="kafka.admin.AdminUtils.addPartitions$default$5">checkBrokerAvailable</a>: <span title="Boolean">Boolean</span> = true,
                    <a title="java.util.Properties" id="kafka.admin.AdminUtils.addPartitions$default$6">config</a>: <span title="java.util.Properties">Properties</span> = new <span title="java.util.Properties">Properties</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.admin.AdminUtils.addPartitions.existingPartitionsReplicaList">existingPartitionsReplicaList</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getReplicaAssignmentForTopics" title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">getReplicaAssignmentForTopics</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <span title="(xs: String*)List[String]">List</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.existingPartitionsReplicaList" title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">existingPartitionsReplicaList</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;The topic %s does not exist&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>

    val <a title="Seq[Int]" id="kafka.admin.AdminUtils.addPartitions.existingReplicaList">existingReplicaList</a> = <a href="#kafka.admin.AdminUtils.addPartitions.existingPartitionsReplicaList" title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">existingPartitionsReplicaList</a>.<span title="=&gt; (kafka.common.TopicAndPartition, Seq[Int])">head</span>.<span title="=&gt; Seq[Int]">_2</span>
    val partitionsToAdd = <a href="#kafka.admin.AdminUtils.addPartitions$default$3" title="Int">numPartitions</a> <a title="Int" id="kafka.admin.AdminUtils.addPartitions.partitionsToAdd">-</a> <a href="#kafka.admin.AdminUtils.addPartitions.existingPartitionsReplicaList" title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">existingPartitionsReplicaList</a>.<span title="=&gt; Int">size</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.partitionsToAdd" title="Int">partitionsToAdd</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span title="String(&quot;The number of partitions for a topic can only be increased&quot;)" class="string">&quot;The number of partitions for a topic can only be increased&quot;</span><span class="delimiter">)</span>

    <span class="comment">// create the new partition replication list</span>
    val <a title="Seq[Int]" id="kafka.admin.AdminUtils.addPartitions.brokerList">brokerList</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getSortedBrokerList" title="(zkClient: org.I0Itec.zkclient.ZkClient)Seq[Int]">getSortedBrokerList</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a><span class="delimiter">)</span>
    val <a title="scala.collection.Map[Int,Seq[Int]]" id="kafka.admin.AdminUtils.addPartitions.newPartitionReplicaList">newPartitionReplicaList</a> = if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions$default$4" title="String">replicaAssignmentStr</a> <span title="(x$1: Any)Boolean">==</span> null <span title="(x: Boolean)Boolean">||</span> <a href="#kafka.admin.AdminUtils.addPartitions$default$4" title="String">replicaAssignmentStr</a> <span title="(x$1: Any)Boolean">==</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
      <a href="#kafka.admin.AdminUtils" title="kafka.admin.AdminUtils.type">AdminUtils</a>.<a href="#kafka.admin.AdminUtils.assignReplicasToBrokers" title="(brokerList: Seq[Int], nPartitions: Int, replicationFactor: Int, fixedStartIndex: Int, startPartitionId: Int)scala.collection.Map[Int,Seq[Int]]">assignReplicasToBrokers</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.brokerList" title="Seq[Int]">brokerList</a>, <a href="#kafka.admin.AdminUtils.addPartitions.partitionsToAdd" title="Int">partitionsToAdd</a>, <a href="#kafka.admin.AdminUtils.addPartitions.existingReplicaList" title="Seq[Int]">existingReplicaList</a>.<span title="=&gt; Int">size</span>, <a href="#kafka.admin.AdminUtils.addPartitions.existingReplicaList" title="Seq[Int]">existingReplicaList</a>.<span title="=&gt; Int">head</span>, <a href="#kafka.admin.AdminUtils.addPartitions.existingPartitionsReplicaList" title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">existingPartitionsReplicaList</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
    else
      <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment" title="(replicaAssignmentList: String, availableBrokerList: scala.collection.Set[Int], startPartitionId: Int, checkBrokerAvailable: Boolean)scala.collection.Map[Int,List[Int]]">getManualReplicaAssignment</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions$default$4" title="String">replicaAssignmentStr</a>, <a href="#kafka.admin.AdminUtils.addPartitions.brokerList" title="Seq[Int]">brokerList</a>.<span title="scala.collection.immutable.Set[Int]">toSet</span>, <a href="#kafka.admin.AdminUtils.addPartitions.existingPartitionsReplicaList" title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">existingPartitionsReplicaList</a>.<span title="=&gt; Int">size</span>, <a href="#kafka.admin.AdminUtils.addPartitions$default$5" title="Boolean">checkBrokerAvailable</a><span class="delimiter">)</span>

    <span class="comment">// check if manual assignment has the right replication factor</span>
    val <a title="Iterable[Seq[Int]]" id="kafka.admin.AdminUtils.addPartitions.unmatchedRepFactorList">unmatchedRepFactorList</a> = <a href="#kafka.admin.AdminUtils.addPartitions.newPartitionReplicaList" title="scala.collection.Map[Int,Seq[Int]]">newPartitionReplicaList</a>.<span title="=&gt; Iterable[Seq[Int]]">values</span>.<span title="(p: Seq[Int] =&gt; Boolean)Iterable[Seq[Int]]">filter</span><span class="delimiter">(</span><a title="Seq[Int]" id="kafka.admin.AdminUtils.addPartitions.unmatchedRepFactorList.$anonfun.p">p</a> =&gt; <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.unmatchedRepFactorList.$anonfun.p" title="Seq[Int]">p</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">!=</span> <a href="#kafka.admin.AdminUtils.addPartitions.existingReplicaList" title="Seq[Int]">existingReplicaList</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.unmatchedRepFactorList" title="Iterable[Seq[Int]]">unmatchedRepFactorList</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span class="string">&quot;The replication factor in manual replication assignment &quot;</span> <span title="String(&quot;The replication factor in manual replication assignment  is not equal to the existing replication factor for the topic &quot;)">+</span>
        <span class="string">&quot; is not equal to the existing replication factor for the topic &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.addPartitions.existingReplicaList" title="Seq[Int]">existingReplicaList</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>

    <a href="../utils/Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Add partition list for %s is %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.addPartitions.newPartitionReplicaList" title="scala.collection.Map[Int,Seq[Int]]">newPartitionReplicaList</a><span class="delimiter">)</span><span class="delimiter">)</span>
    val <a title="scala.collection.mutable.Map[Int,Seq[Int]]" id="kafka.admin.AdminUtils.addPartitions.partitionReplicaList">partitionReplicaList</a> = <a href="#kafka.admin.AdminUtils.addPartitions.existingPartitionsReplicaList" title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">existingPartitionsReplicaList</a>.<span title="(f: ((kafka.common.TopicAndPartition, Seq[Int])) =&gt; (Int, Seq[Int]))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]],(Int, Seq[Int]),scala.collection.mutable.Map[Int,Seq[Int]]])scala.collection.mutable.Map[Int,Seq[Int]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.mutable.Map.Coll,(Int, Seq[Int]),scala.collection.mutable.Map[Int,Seq[Int]]]" class="delimiter">(</span><a title="(kafka.common.TopicAndPartition, Seq[Int])" id="kafka.admin.AdminUtils.addPartitions.partitionReplicaList.$anonfun.p">p</a> =&gt; <a href="#kafka.admin.AdminUtils.addPartitions.partitionReplicaList.$anonfun.p" title="(kafka.common.TopicAndPartition, Seq[Int])">p</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.partition" title="(self: Int)ArrowAssoc[Int]">partition</a> <span title="(y: Seq[Int])(Int, Seq[Int])">-&gt;</span> <a href="#kafka.admin.AdminUtils.addPartitions.partitionReplicaList.$anonfun.p" title="(kafka.common.TopicAndPartition, Seq[Int])">p</a>.<span title="=&gt; Seq[Int]">_2</span><span class="delimiter">)</span>
    <span class="comment">// add the new list</span>
    <a href="#kafka.admin.AdminUtils.addPartitions.partitionReplicaList" title="scala.collection.mutable.Map[Int,Seq[Int]]">partitionReplicaList</a> <span title="(xs: scala.collection.TraversableOnce[(Int, Seq[Int])])partitionReplicaList.type">++=</span> <a href="#kafka.admin.AdminUtils.addPartitions.newPartitionReplicaList" title="scala.collection.Map[Int,Seq[Int]]">newPartitionReplicaList</a>
    <a href="#kafka.admin.AdminUtils" title="kafka.admin.AdminUtils.type">AdminUtils</a>.<a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partitionReplicaAssignment: scala.collection.Map[Int,Seq[Int]], config: java.util.Properties, update: Boolean)Unit">createOrUpdateTopicPartitionAssignmentPathInZK</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.addPartitions.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.addPartitions.topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.addPartitions.partitionReplicaList" title="scala.collection.mutable.Map[Int,Seq[Int]]">partitionReplicaList</a>, <a href="#kafka.admin.AdminUtils.addPartitions$default$6" title="java.util.Properties">config</a>, true<span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(replicaAssignmentList: String, availableBrokerList: scala.collection.Set[Int], startPartitionId: Int, checkBrokerAvailable: Boolean)scala.collection.Map[Int,List[Int]]" id="kafka.admin.AdminUtils.getManualReplicaAssignment">getManualReplicaAssignment</a><span class="delimiter">(</span><a title="String" id="kafka.admin.AdminUtils.getManualReplicaAssignment.replicaAssignmentList">replicaAssignmentList</a>: <span title="String">String</span>, <a title="scala.collection.Set[Int]" id="kafka.admin.AdminUtils.getManualReplicaAssignment.availableBrokerList">availableBrokerList</a>: <span title="scala.collection.Set[Int]">Set</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <a title="Int" id="kafka.admin.AdminUtils.getManualReplicaAssignment.startPartitionId">startPartitionId</a>: <span title="Int">Int</span>, <a title="Boolean" id="kafka.admin.AdminUtils.getManualReplicaAssignment$default$4">checkBrokerAvailable</a>: <span title="Boolean">Boolean</span> = true<span class="delimiter">)</span>: <span title="scala.collection.Map[Int,List[Int]]">Map</span><span class="delimiter">[</span>Int, List<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    var <a title="Array[String]" id="kafka.admin.AdminUtils.getManualReplicaAssignment.partitionList">partitionList</a> = <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.replicaAssignmentList" title="String">replicaAssignmentList</a>.<span title="(x$1: String)Array[String]">split</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span>
    val <a title="scala.collection.mutable.HashMap[Int,List[Int]]" id="kafka.admin.AdminUtils.getManualReplicaAssignment.ret">ret</a> = new mutable.<span title="scala.collection.mutable.HashMap[Int,List[Int]]">HashMap</span><span class="delimiter">[</span>Int, List<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    var <a title="Int" id="kafka.admin.AdminUtils.getManualReplicaAssignment.partitionId">partitionId</a> = <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.startPartitionId" title="Int">startPartitionId</a>
    <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.partitionList" title="Array[String]">partitionList</a> = <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.partitionList" title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]">partitionList</a>.<span title="(n: Int)Array[String]">takeRight</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.partitionList" title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]">partitionList</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">-</span> <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.partitionId" title="Int">partitionId</a><span class="delimiter">)</span>
    for <span class="delimiter">(</span><a title="Int" id="kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.i">i</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.partitionList" title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]">partitionList</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="Array[Int]" id="kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList">brokerList</a> = <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.partitionList" title="(i: Int)String">partitionList</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.i" title="Int">i</a><span class="delimiter">)</span>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="String(&quot;:&quot;)" class="string">&quot;:&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],Int,Array[Int]])Array[Int]">map</span><span title="(implicit t: scala.reflect.ClassTag[Int])scala.collection.generic.CanBuildFrom[Array[_],Int,Array[Int]]" class="delimiter">(</span><a title="String" id="kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList.$anonfun.s">s</a> =&gt; <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList.$anonfun.s" title="String">s</a>.<span title="()String">trim</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList" title="implicit scala.Predef.intArrayOps : (xs: Array[Int])scala.collection.mutable.ArrayOps[Int]">brokerList</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span title="String(&quot;replication factor must be larger than 0&quot;)" class="string">&quot;replication factor must be larger than 0&quot;</span><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList" title="implicit scala.Predef.intArrayOps : (xs: Array[Int])scala.collection.mutable.ArrayOps[Int]">brokerList</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">!=</span> <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList" title="implicit scala.Predef.intArrayOps : (xs: Array[Int])scala.collection.mutable.ArrayOps[Int]">brokerList</a>.<span title="scala.collection.immutable.Set[Int]">toSet</span>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
        throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span title="String(&quot;duplicate brokers in replica assignment: &quot;)" class="string">&quot;duplicate brokers in replica assignment: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList" title="Array[Int]">brokerList</a><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment$default$4" title="Boolean">checkBrokerAvailable</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList" title="implicit scala.Predef.intArrayOps : (xs: Array[Int])scala.collection.mutable.ArrayOps[Int]">brokerList</a>.<span title="scala.collection.immutable.Set[Int]">toSet</span>.<span title="(that: scala.collection.GenSet[Int])Boolean">subsetOf</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.availableBrokerList" title="scala.collection.Set[Int]">availableBrokerList</a><span class="delimiter">)</span><span class="delimiter">)</span>
        throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span title="String(&quot;some specified brokers not available. specified brokers: &quot;)" class="string">&quot;some specified brokers not available. specified brokers: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList" title="Array[Int]">brokerList</a>.<span title="()String">toString</span> <span title="(x$1: Any)String">+</span>
          <span title="String(&quot;available broker:&quot;)" class="string">&quot;available broker:&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.availableBrokerList" title="scala.collection.Set[Int]">availableBrokerList</a>.<span title="()String">toString</span><span class="delimiter">)</span>
      <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.ret" title="scala.collection.mutable.HashMap[Int,List[Int]]">ret</a>.<span title="(key: Int, value: List[Int])Option[List[Int]]">put</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.partitionId" title="Int">partitionId</a>, <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList" title="implicit scala.Predef.intArrayOps : (xs: Array[Int])scala.collection.mutable.ArrayOps[Int]">brokerList</a>.<span title="=&gt; List[Int]">toList</span><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.ret" title="(key: Int)List[Int]">ret</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.partitionId" title="Int">partitionId</a><span class="delimiter">)</span>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">!=</span> <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.ret" title="(key: Int)List[Int]">ret</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.startPartitionId" title="Int">startPartitionId</a><span class="delimiter">)</span>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
        throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span title="String(&quot;partition &quot;)" class="string">&quot;partition &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.i" title="Int">i</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; has different replication factor: &quot;)" class="string">&quot; has different replication factor: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.$anonfun.brokerList" title="Array[Int]">brokerList</a><span class="delimiter">)</span>
      <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.partitionId" title="Int">partitionId</a> = <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.partitionId" title="Int">partitionId</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#kafka.admin.AdminUtils.getManualReplicaAssignment.ret" title="scala.collection.mutable.HashMap[Int,List[Int]]">ret</a>.<span title="(implicit ev: &lt;:&lt;[(Int, List[Int]),(Int, List[Int])])scala.collection.immutable.Map[Int,List[Int]]">toMap</span>
  <span class="delimiter">}</span>
  
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String)Unit" id="kafka.admin.AdminUtils.deleteTopic">deleteTopic</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.deleteTopic.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.admin.AdminUtils.deleteTopic.topic">topic</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.createPersistentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit">createPersistentPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.deleteTopic.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getDeleteTopicPath" title="(topic: String)String">getDeleteTopicPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.deleteTopic.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String)Boolean" id="kafka.admin.AdminUtils.topicExists">topicExists</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.topicExists.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.admin.AdminUtils.topicExists.topic">topic</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = 
    <a href="#kafka.admin.AdminUtils.topicExists.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>.<span title="(x$1: String)Boolean">exists</span><span class="delimiter">(</span><a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getTopicPath" title="(topic: String)String">getTopicPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.topicExists.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>
    
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partitions: Int, replicationFactor: Int, topicConfig: java.util.Properties)Unit" id="kafka.admin.AdminUtils.createTopic">createTopic</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.createTopic.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>,
                  <a title="String" id="kafka.admin.AdminUtils.createTopic.topic">topic</a>: <span title="String">String</span>,
                  <a title="Int" id="kafka.admin.AdminUtils.createTopic.partitions">partitions</a>: <span title="Int">Int</span>, 
                  <a title="Int" id="kafka.admin.AdminUtils.createTopic.replicationFactor">replicationFactor</a>: <span title="Int">Int</span>, 
                  <a title="java.util.Properties" id="kafka.admin.AdminUtils.createTopic$default$5">topicConfig</a>: <span title="java.util.Properties">Properties</span> = new <span title="java.util.Properties">Properties</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="Seq[Int]" id="kafka.admin.AdminUtils.createTopic.brokerList">brokerList</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getSortedBrokerList" title="(zkClient: org.I0Itec.zkclient.ZkClient)Seq[Int]">getSortedBrokerList</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createTopic.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a><span class="delimiter">)</span>
    val <a title="scala.collection.Map[Int,Seq[Int]]" id="kafka.admin.AdminUtils.createTopic.replicaAssignment">replicaAssignment</a> = <a href="#kafka.admin.AdminUtils" title="kafka.admin.AdminUtils.type">AdminUtils</a>.<a href="#kafka.admin.AdminUtils.assignReplicasToBrokers" title="(brokerList: Seq[Int], nPartitions: Int, replicationFactor: Int, fixedStartIndex: Int, startPartitionId: Int)scala.collection.Map[Int,Seq[Int]]">assignReplicasToBrokers</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createTopic.brokerList" title="Seq[Int]">brokerList</a>, <a href="#kafka.admin.AdminUtils.createTopic.partitions" title="Int">partitions</a>, <a href="#kafka.admin.AdminUtils.createTopic.replicationFactor" title="Int">replicationFactor</a><span class="delimiter">)</span>
    <a href="#kafka.admin.AdminUtils" title="kafka.admin.AdminUtils.type">AdminUtils</a>.<a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partitionReplicaAssignment: scala.collection.Map[Int,Seq[Int]], config: java.util.Properties, update: Boolean)Unit">createOrUpdateTopicPartitionAssignmentPathInZK</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createTopic.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.createTopic.topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.createTopic.replicaAssignment" title="scala.collection.Map[Int,Seq[Int]]">replicaAssignment</a>, <a href="#kafka.admin.AdminUtils.createTopic$default$5" title="java.util.Properties">topicConfig</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
                  
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partitionReplicaAssignment: scala.collection.Map[Int,Seq[Int]], config: java.util.Properties, update: Boolean)Unit" id="kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK">createOrUpdateTopicPartitionAssignmentPathInZK</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>,
                                                     <a title="String" id="kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.topic">topic</a>: <span title="String">String</span>,
                                                     <a title="scala.collection.Map[Int,Seq[Int]]" id="kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.partitionReplicaAssignment">partitionReplicaAssignment</a>: <span title="scala.collection.Map[Int,Seq[Int]]">Map</span><span class="delimiter">[</span>Int, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span>,
                                                     <a title="java.util.Properties" id="kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK$default$4">config</a>: <span title="java.util.Properties">Properties</span> = new <span title="java.util.Properties">Properties</span>,
                                                     <a title="Boolean" id="kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK$default$5">update</a>: <span title="Boolean">Boolean</span> = false<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="comment">// validate arguments</span>
    <a href="../common/Topic.scala.html#kafka.common.Topic" title="kafka.common.Topic.type">Topic</a>.<a href="../common/Topic.scala.html#kafka.common.Topic.validate" title="(topic: String)Unit">validate</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.topic" title="String">topic</a><span class="delimiter">)</span>
    <a href="../log/LogConfig.scala.html#kafka.log.LogConfig" title="kafka.log.LogConfig.type">LogConfig</a>.<a href="../log/LogConfig.scala.html#kafka.log.LogConfig.validate" title="(props: java.util.Properties)Unit">validate</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK$default$4" title="java.util.Properties">config</a><span class="delimiter">)</span>
    <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.partitionReplicaAssignment" title="scala.collection.Map[Int,Seq[Int]]">partitionReplicaAssignment</a>.<span title="=&gt; Iterable[Seq[Int]]">values</span>.<span title="(f: Seq[Int] =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Iterable[Seq[Int]],Int,Iterable[Int]])Iterable[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Iterable.Coll,Int,Iterable[Int]]" class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.$anonfun.x$1" title="Seq[Int]">_</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[Int]">toSet</span>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span>, <span title="String(&quot;All partitions should have the same number of replicas.&quot;)" class="string">&quot;All partitions should have the same number of replicas.&quot;</span><span class="delimiter">)</span>

    val <a title="String" id="kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.topicPath">topicPath</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getTopicPath" title="(topic: String)String">getTopicPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.topic" title="String">topic</a><span class="delimiter">)</span>
    if<span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK$default$5" title="Boolean">update</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>.<span title="(x$1: String)Boolean">exists</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.topicPath" title="String">topicPath</a><span class="delimiter">)</span><span class="delimiter">)</span>
      throw new <a href="../common/TopicExistsException.scala.html#kafka.common;TopicExistsException" title="kafka.common.TopicExistsException">TopicExistsException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Topic \&quot;%s\&quot; already exists.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.partitionReplicaAssignment" title="scala.collection.Map[Int,Seq[Int]]">partitionReplicaAssignment</a>.<span title="=&gt; Iterable[Seq[Int]]">values</span>.<span title="(f: Seq[Int] =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a title="Seq[Int]" id="kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.$anonfun.reps">reps</a> =&gt; <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.$anonfun.reps" title="Seq[Int]">reps</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">==</span> <a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.$anonfun.reps" title="Seq[Int]">reps</a>.<span title="scala.collection.immutable.Set[Int]">toSet</span>.<span title="=&gt; Int">size</span>, <span title="String(&quot;Duplicate replica assignment found: &quot;)" class="string">&quot;Duplicate replica assignment found: &quot;</span>  <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.partitionReplicaAssignment" title="scala.collection.Map[Int,Seq[Int]]">partitionReplicaAssignment</a><span class="delimiter">)</span><span class="delimiter">)</span>
    
    <span class="comment">// write out the config if there is any, this isn't transactional with the partition assignments</span>
    <a href="#kafka.admin.AdminUtils.writeTopicConfig" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, config: java.util.Properties)Unit">writeTopicConfig</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK$default$4" title="java.util.Properties">config</a><span class="delimiter">)</span>
    
    <span class="comment">// create the partition assignment</span>
    <a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, replicaAssignment: scala.collection.Map[Int,Seq[Int]], update: Boolean)Unit">writeTopicPartitionAssignment</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK.partitionReplicaAssignment" title="scala.collection.Map[Int,Seq[Int]]">partitionReplicaAssignment</a>, <a href="#kafka.admin.AdminUtils.createOrUpdateTopicPartitionAssignmentPathInZK$default$5" title="Boolean">update</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  
  private def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, replicaAssignment: scala.collection.Map[Int,Seq[Int]], update: Boolean)Unit" id="kafka.admin.AdminUtils.writeTopicPartitionAssignment">writeTopicPartitionAssignment</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.writeTopicPartitionAssignment.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.admin.AdminUtils.writeTopicPartitionAssignment.topic">topic</a>: <span title="String">String</span>, <a title="scala.collection.Map[Int,Seq[Int]]" id="kafka.admin.AdminUtils.writeTopicPartitionAssignment.replicaAssignment">replicaAssignment</a>: <span title="scala.collection.Map[Int,Seq[Int]]">Map</span><span class="delimiter">[</span>Int, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Boolean" id="kafka.admin.AdminUtils.writeTopicPartitionAssignment.update">update</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      val <a title="String" id="kafka.admin.AdminUtils.writeTopicPartitionAssignment.zkPath">zkPath</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getTopicPath" title="(topic: String)String">getTopicPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.topic" title="String">topic</a><span class="delimiter">)</span>
      val <a title="String" id="kafka.admin.AdminUtils.writeTopicPartitionAssignment.jsonPartitionData">jsonPartitionData</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.replicaAssignmentZkData" title="(map: scala.collection.Map[String,Seq[Int]])String">replicaAssignmentZkData</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.replicaAssignment" title="scala.collection.Map[Int,Seq[Int]]">replicaAssignment</a>.<span title="(f: ((Int, Seq[Int])) =&gt; (String, Seq[Int]))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.Map[Int,Seq[Int]],(String, Seq[Int]),scala.collection.Map[String,Seq[Int]]])scala.collection.Map[String,Seq[Int]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Map.Coll,(String, Seq[Int]),scala.collection.Map[String,Seq[Int]]]" class="delimiter">(</span><a title="(Int, Seq[Int])" id="kafka.admin.AdminUtils.writeTopicPartitionAssignment.jsonPartitionData.$anonfun.e">e</a> =&gt; <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.jsonPartitionData.$anonfun.e" title="(Int, Seq[Int])">e</a>.<span title="=&gt; Int">_1</span>.<span title="(self: String)ArrowAssoc[String]">toString</span> <span title="(y: Seq[Int])(String, Seq[Int])">-&gt;</span> <a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.jsonPartitionData.$anonfun.e" title="(Int, Seq[Int])">e</a>.<span title="=&gt; Seq[Int]">_2</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

      if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.update" title="Boolean">update</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../utils/Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="String(&quot;Topic creation &quot;)" class="string">&quot;Topic creation &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.jsonPartitionData" title="String">jsonPartitionData</a>.<span title="()String">toString</span><span class="delimiter">)</span>
        <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.createPersistentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit">createPersistentPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.zkPath" title="String">zkPath</a>, <a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.jsonPartitionData" title="String">jsonPartitionData</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> else <span class="delimiter">{</span>
        <a href="../utils/Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="String(&quot;Topic update &quot;)" class="string">&quot;Topic update &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.jsonPartitionData" title="String">jsonPartitionData</a>.<span title="()String">toString</span><span class="delimiter">)</span>
        <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.updatePersistentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit">updatePersistentPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.zkPath" title="String">zkPath</a>, <a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.jsonPartitionData" title="String">jsonPartitionData</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="../utils/Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Updated path %s with %s for replica assignment&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.zkPath" title="String">zkPath</a>, <a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.jsonPartitionData" title="String">jsonPartitionData</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNodeExistsException" id="kafka.admin.AdminUtils.writeTopicPartitionAssignment.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNodeExistsException">ZkNodeExistsException</span> =&gt; throw new <a href="../common/TopicExistsException.scala.html#kafka.common;TopicExistsException" title="kafka.common.TopicExistsException">TopicExistsException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;topic %s already exists&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>
      case <a title="Throwable" id="kafka.admin.AdminUtils.writeTopicPartitionAssignment.e2">e2</a>: <span title="Throwable">Throwable</span> =&gt; throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicPartitionAssignment.e2" title="Throwable">e2</a>.<span title="()String">toString</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="comment">/**
   * Update the config for an existing topic and create a change notification so the change will propagate to other brokers
   * @param zkClient: The ZkClient handle used to write the new config to zookeeper
   * @param topic: The topic for which configs are being changed
   * @param configs: The final set of configs that will be applied to the topic. If any new configs need to be added or
   *                 existing configs need to be deleted, it should be done prior to invoking this API
   *
   */</span>
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, configs: java.util.Properties)Unit" id="kafka.admin.AdminUtils.changeTopicConfig">changeTopicConfig</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.changeTopicConfig.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.admin.AdminUtils.changeTopicConfig.topic">topic</a>: <span title="String">String</span>, <a title="java.util.Properties" id="kafka.admin.AdminUtils.changeTopicConfig.configs">configs</a>: <span title="java.util.Properties">Properties</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    if<span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.admin.AdminUtils.topicExists" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String)Boolean">topicExists</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.changeTopicConfig.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.changeTopicConfig.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>
      throw new <a href="AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Topic \&quot;%s\&quot; does not exist.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.changeTopicConfig.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="comment">// remove the topic overrides</span>
    <a href="../log/LogConfig.scala.html#kafka.log.LogConfig" title="kafka.log.LogConfig.type">LogConfig</a>.<a href="../log/LogConfig.scala.html#kafka.log.LogConfig.validate" title="(props: java.util.Properties)Unit">validate</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.changeTopicConfig.configs" title="java.util.Properties">configs</a><span class="delimiter">)</span>

    <span class="comment">// write the new config--may not exist if there were previously no overrides</span>
    <a href="#kafka.admin.AdminUtils.writeTopicConfig" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, config: java.util.Properties)Unit">writeTopicConfig</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.changeTopicConfig.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.changeTopicConfig.topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.changeTopicConfig.configs" title="java.util.Properties">configs</a><span class="delimiter">)</span>
    
    <span class="comment">// create the change notification</span>
    <a href="#kafka.admin.AdminUtils.changeTopicConfig.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>.<span title="(x$1: String, x$2: Any)String">createPersistentSequential</span><span title="Unit" class="delimiter">(</span><a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.TopicConfigChangesPath" title="=&gt; String">TopicConfigChangesPath</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.TopicConfigChangeZnodePrefix" title="=&gt; String">TopicConfigChangeZnodePrefix</a>, <a href="../utils/Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="../utils/Json.scala.html#kafka.utils.Json.encode" title="(obj: Any)String">encode</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.changeTopicConfig.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  
  <span class="comment">/**
   * Write out the topic config to zk, if there is any
   */</span>
  private def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, config: java.util.Properties)Unit" id="kafka.admin.AdminUtils.writeTopicConfig">writeTopicConfig</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.writeTopicConfig.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.admin.AdminUtils.writeTopicConfig.topic">topic</a>: <span title="String">String</span>, <a title="java.util.Properties" id="kafka.admin.AdminUtils.writeTopicConfig.config">config</a>: <span title="java.util.Properties">Properties</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="scala.collection.mutable.Map[String,String]" id="kafka.admin.AdminUtils.writeTopicConfig.configMap">configMap</a>: mutable.<span title="scala.collection.mutable.Map[String,String]">Map</span><span class="delimiter">[</span>String, String<span class="delimiter">]</span> = <span class="delimiter">{</span>
      import <span title="scala.collection.JavaConversions.type">JavaConversions</span>._
      <a href="#kafka.admin.AdminUtils.writeTopicConfig.config" title="implicit scala.collection.convert.WrapAsScala.propertiesAsScalaMap : (p: java.util.Properties)scala.collection.mutable.Map[String,String]">config</a>
    <span class="delimiter">}</span>
    val <a title="scala.collection.Map[String,Any]" id="kafka.admin.AdminUtils.writeTopicConfig.map">map</a> = <span title="(elems: (String, Any)*)scala.collection.Map[String,Any]">Map</span><span class="delimiter">(</span><span title="(self: String)ArrowAssoc[String]" class="string">&quot;version&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <span title="Int(1)" class="int">1</span>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;config&quot;</span> <span title="(y: scala.collection.mutable.Map[String,String])(String, scala.collection.mutable.Map[String,String])">-&gt;</span> <a href="#kafka.admin.AdminUtils.writeTopicConfig.configMap" title="scala.collection.mutable.Map[String,String]">configMap</a><span class="delimiter">)</span>
    <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.updatePersistentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit">updatePersistentPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicConfig.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getTopicConfigPath" title="(topic: String)String">getTopicConfigPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicConfig.topic" title="String">topic</a><span class="delimiter">)</span>, <a href="../utils/Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="../utils/Json.scala.html#kafka.utils.Json.encode" title="(obj: Any)String">encode</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.writeTopicConfig.map" title="scala.collection.Map[String,Any]">map</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  
  <span class="comment">/**
   * Read the topic config (if any) from zk
   */</span>
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String)java.util.Properties" id="kafka.admin.AdminUtils.fetchTopicConfig">fetchTopicConfig</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.fetchTopicConfig.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.admin.AdminUtils.fetchTopicConfig.topic">topic</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="java.util.Properties">Properties</span> = <span class="delimiter">{</span>
    val <a title="String" id="kafka.admin.AdminUtils.fetchTopicConfig.str">str</a>: <span title="String">String</span> = <a href="#kafka.admin.AdminUtils.fetchTopicConfig.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>.<span title="(x$1: String, x$2: Boolean)Nothing">readData</span><span class="delimiter">(</span><a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getTopicConfigPath" title="(topic: String)String">getTopicConfigPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicConfig.topic" title="String">topic</a><span class="delimiter">)</span>, true<span class="delimiter">)</span>
    val <a title="java.util.Properties" id="kafka.admin.AdminUtils.fetchTopicConfig.props">props</a> = new <span title="java.util.Properties">Properties</span><span class="delimiter">(</span><span class="delimiter">)</span>
    if<span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicConfig.str" title="String">str</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../utils/Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="../utils/Json.scala.html#kafka.utils.Json.parseFull" title="(input: String)Option[Any]">parseFull</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicConfig.str" title="String">str</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
        case <span title="None.type">None</span> =&gt; <span class="comment">// there are no config overrides</span>
        case Some<span class="delimiter">(</span><a title="scala.collection.Map[String,_]" id="kafka.admin.AdminUtils.fetchTopicConfig.map">map</a>: <span title="scala.collection.Map[String,_]">Map</span><span class="delimiter">[</span>String, _<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; 
          <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicConfig.map" title="(key: String)_">map</a><span class="delimiter">(</span><span title="String(&quot;version&quot;)" class="string">&quot;version&quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
          <a href="#kafka.admin.AdminUtils.fetchTopicConfig.map" title="scala.collection.Map[String,_]">map</a>.<span title="(key: String)Option[_]">get</span><span class="delimiter">(</span><span title="String(&quot;config&quot;)" class="string">&quot;config&quot;</span><span class="delimiter">)</span> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><a title="scala.collection.Map[String,String]" id="kafka.admin.AdminUtils.fetchTopicConfig.config">config</a>: <span title="scala.collection.Map[String,String]">Map</span><span class="delimiter">[</span>String, String<span class="delimiter">]</span><span class="delimiter">)</span> =&gt;
              for<span class="delimiter">(</span><span class="delimiter">(</span><a title="String" id="kafka.admin.AdminUtils.fetchTopicConfig.$anonfun.k">k</a>,<a title="String" id="kafka.admin.AdminUtils.fetchTopicConfig.$anonfun.v">v</a><span class="delimiter">)</span> &lt;- <a href="#kafka.admin.AdminUtils.fetchTopicConfig.config" title="(f: ((String, String)) =&gt; Object)Unit">config</a><span class="delimiter">)</span>
                <a href="#kafka.admin.AdminUtils.fetchTopicConfig.props" title="java.util.Properties">props</a>.<span title="(x$1: String, x$2: String)Object">setProperty</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicConfig.$anonfun.k" title="String">k</a>, <a href="#kafka.admin.AdminUtils.fetchTopicConfig.$anonfun.v" title="String">v</a><span class="delimiter">)</span>
            case _ =&gt; throw new <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="String(&quot;Invalid topic config: &quot;)" class="string">&quot;Invalid topic config: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.fetchTopicConfig.str" title="String">str</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        case <a title="Option[Any]" id="kafka.admin.AdminUtils.fetchTopicConfig.o">o</a> =&gt; throw new <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="String(&quot;Unexpected value in config: &quot;)" class="string">&quot;Unexpected value in config: &quot;</span>  <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.fetchTopicConfig.str" title="String">str</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#kafka.admin.AdminUtils.fetchTopicConfig.props" title="java.util.Properties">props</a>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient)scala.collection.Map[String,java.util.Properties]" id="kafka.admin.AdminUtils.fetchAllTopicConfigs">fetchAllTopicConfigs</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.fetchAllTopicConfigs.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span>: <span title="scala.collection.Map[String,java.util.Properties]">Map</span><span class="delimiter">[</span>String, Properties<span class="delimiter">]</span> =
    <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getAllTopics" title="(zkClient: org.I0Itec.zkclient.ZkClient)Seq[String]">getAllTopics</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchAllTopicConfigs.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a><span class="delimiter">)</span>.<span title="(f: String =&gt; (String, java.util.Properties))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],(String, java.util.Properties),Seq[(String, java.util.Properties)]])Seq[(String, java.util.Properties)]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(String, java.util.Properties),Seq[(String, java.util.Properties)]]" class="delimiter">(</span><a title="String" id="kafka.admin.AdminUtils.fetchAllTopicConfigs.$anonfun.topic">topic</a> =&gt; <span title="(_1: String, _2: java.util.Properties)(String, java.util.Properties)" class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchAllTopicConfigs.$anonfun.topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.fetchTopicConfig" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String)java.util.Properties">fetchTopicConfig</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchAllTopicConfigs.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.fetchAllTopicConfigs.$anonfun.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ev: &lt;:&lt;[(String, java.util.Properties),(String, java.util.Properties)])scala.collection.immutable.Map[String,java.util.Properties]">toMap</span>

  def <a title="(topic: String, zkClient: org.I0Itec.zkclient.ZkClient)kafka.api.TopicMetadata" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(6f4bebf923)">fetchTopicMetadataFromZk</a><span class="delimiter">(</span><a title="String" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(6f4bebf923).topic">topic</a>: <span title="String">String</span>, <a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(6f4bebf923).zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span>: <a href="../api/TopicMetadata.scala.html#kafka.api;TopicMetadata" title="kafka.api.TopicMetadata">TopicMetadata</a> =
    <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960)" title="(topic: String, zkClient: org.I0Itec.zkclient.ZkClient, cachedBrokerInfo: scala.collection.mutable.HashMap[Int,kafka.cluster.Broker])kafka.api.TopicMetadata">fetchTopicMetadataFromZk</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(6f4bebf923).topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(6f4bebf923).zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, new mutable.<span title="scala.collection.mutable.HashMap[Int,kafka.cluster.Broker]">HashMap</span><span class="delimiter">[</span>Int, Broker<span class="delimiter">]</span><span class="delimiter">)</span>

  def <a title="(topics: scala.collection.Set[String], zkClient: org.I0Itec.zkclient.ZkClient)scala.collection.Set[kafka.api.TopicMetadata]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(fc1b91744b)">fetchTopicMetadataFromZk</a><span class="delimiter">(</span><a title="scala.collection.Set[String]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(fc1b91744b).topics">topics</a>: <span title="scala.collection.Set[String]">Set</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(fc1b91744b).zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span>: <span title="scala.collection.Set[kafka.api.TopicMetadata]">Set</span><span class="delimiter">[</span>TopicMetadata<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="scala.collection.mutable.HashMap[Int,kafka.cluster.Broker]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(fc1b91744b).cachedBrokerInfo">cachedBrokerInfo</a> = new mutable.<span title="scala.collection.mutable.HashMap[Int,kafka.cluster.Broker]">HashMap</span><span class="delimiter">[</span>Int, Broker<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(fc1b91744b).topics" title="scala.collection.Set[String]">topics</a>.<span title="(f: String =&gt; kafka.api.TopicMetadata)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.Set[String],kafka.api.TopicMetadata,scala.collection.Set[kafka.api.TopicMetadata]])scala.collection.Set[kafka.api.TopicMetadata]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Set.Coll,kafka.api.TopicMetadata,scala.collection.Set[kafka.api.TopicMetadata]]" class="delimiter">(</span><a title="String" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(fc1b91744b).$anonfun.topic">topic</a> =&gt; <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960)" title="(topic: String, zkClient: org.I0Itec.zkclient.ZkClient, cachedBrokerInfo: scala.collection.mutable.HashMap[Int,kafka.cluster.Broker])kafka.api.TopicMetadata">fetchTopicMetadataFromZk</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(fc1b91744b).$anonfun.topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(fc1b91744b).zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(fc1b91744b).cachedBrokerInfo" title="scala.collection.mutable.HashMap[Int,kafka.cluster.Broker]">cachedBrokerInfo</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="(topic: String, zkClient: org.I0Itec.zkclient.ZkClient, cachedBrokerInfo: scala.collection.mutable.HashMap[Int,kafka.cluster.Broker])kafka.api.TopicMetadata" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960)">fetchTopicMetadataFromZk</a><span class="delimiter">(</span><a title="String" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topic">topic</a>: <span title="String">String</span>, <a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="scala.collection.mutable.HashMap[Int,kafka.cluster.Broker]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).cachedBrokerInfo">cachedBrokerInfo</a>: mutable.<span title="scala.collection.mutable.HashMap[Int,kafka.cluster.Broker]">HashMap</span><span class="delimiter">[</span>Int, Broker<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../api/TopicMetadata.scala.html#kafka.api;TopicMetadata" title="kafka.api.TopicMetadata">TopicMetadata</a> = <span class="delimiter">{</span>
    if<span class="delimiter">(</span><a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.pathExists" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Boolean">pathExists</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getTopicPath" title="(topic: String)String">getTopicPath</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="scala.collection.Map[Int,Seq[Int]]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topicPartitionAssignment">topicPartitionAssignment</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getPartitionAssignmentForTopics" title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[String,scala.collection.Map[Int,Seq[Int]]]">getPartitionAssignmentForTopics</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <span title="(xs: String*)List[String]">List</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(key: String)Option[scala.collection.Map[Int,Seq[Int]]]">get</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topic" title="String">topic</a><span class="delimiter">)</span>.<span title="=&gt; scala.collection.Map[Int,Seq[Int]]">get</span>
      val <a title="List[(Int, Seq[Int])]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).sortedPartitions">sortedPartitions</a> = <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topicPartitionAssignment" title="scala.collection.Map[Int,Seq[Int]]">topicPartitionAssignment</a>.<span title="=&gt; List[(Int, Seq[Int])]">toList</span>.<span title="(lt: ((Int, Seq[Int]), (Int, Seq[Int])) =&gt; Boolean)List[(Int, Seq[Int])]">sortWith</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="(Int, Seq[Int])" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).sortedPartitions.$anonfun.m1">m1</a>, <a title="(Int, Seq[Int])" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).sortedPartitions.$anonfun.m2">m2</a><span class="delimiter">)</span> =&gt; <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).sortedPartitions.$anonfun.m1" title="(Int, Seq[Int])">m1</a>.<span title="=&gt; Int">_1</span> <span title="(x: Int)Boolean">&lt;</span> <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).sortedPartitions.$anonfun.m2" title="(Int, Seq[Int])">m2</a>.<span title="=&gt; Int">_1</span><span class="delimiter">)</span>
      val <a title="List[kafka.api.PartitionMetadata]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata">partitionMetadata</a> = <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).sortedPartitions" title="List[(Int, Seq[Int])]">sortedPartitions</a>.<span title="(f: ((Int, Seq[Int])) =&gt; kafka.api.PartitionMetadata)(implicit bf: scala.collection.generic.CanBuildFrom[List[(Int, Seq[Int])],kafka.api.PartitionMetadata,List[kafka.api.PartitionMetadata]])List[kafka.api.PartitionMetadata]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,kafka.api.PartitionMetadata,List[kafka.api.PartitionMetadata]]" class="delimiter">{</span> <a title="(Int, Seq[Int])" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partitionMap">partitionMap</a> =&gt;
        val <a title="Int" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partition">partition</a> = <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partitionMap" title="(Int, Seq[Int])">partitionMap</a>.<span title="=&gt; Int">_1</span>
        val <a title="Seq[Int]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicas">replicas</a> = <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partitionMap" title="(Int, Seq[Int])">partitionMap</a>.<span title="=&gt; Seq[Int]">_2</span>
        val <a title="Seq[Int]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.inSyncReplicas">inSyncReplicas</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getInSyncReplicasForPartition" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Seq[Int]">getInSyncReplicasForPartition</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partition" title="Int">partition</a><span class="delimiter">)</span>
        val <a title="Option[Int]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.leader">leader</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getLeaderForPartition" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Option[Int]">getLeaderForPartition</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partition" title="Int">partition</a><span class="delimiter">)</span>
        <a href="../utils/Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;replicas = &quot;)" class="string">&quot;replicas = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicas" title="Seq[Int]">replicas</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, in sync replicas = &quot;)" class="string">&quot;, in sync replicas = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.inSyncReplicas" title="Seq[Int]">inSyncReplicas</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, leader = &quot;)" class="string">&quot;, leader = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.leader" title="Option[Int]">leader</a><span class="delimiter">)</span>

        var <a title="Option[kafka.cluster.Broker]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.leaderInfo">leaderInfo</a>: <span title="Option[kafka.cluster.Broker]">Option</span><span class="delimiter">[</span>Broker<span class="delimiter">]</span> = <span title="None.type">None</span>
        var <a title="Seq[kafka.cluster.Broker]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicaInfo">replicaInfo</a>: <span title="Seq[kafka.cluster.Broker]">Seq</span><span class="delimiter">[</span>Broker<span class="delimiter">]</span> = <span title="scala.collection.immutable.Nil.type">Nil</span>
        var <a title="Seq[kafka.cluster.Broker]" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.isrInfo">isrInfo</a>: <span title="Seq[kafka.cluster.Broker]">Seq</span><span class="delimiter">[</span>Broker<span class="delimiter">]</span> = <span title="scala.collection.immutable.Nil.type">Nil</span>
        try <span class="delimiter">{</span>
          <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.leaderInfo" title="Option[kafka.cluster.Broker]">leaderInfo</a> = <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.leader" title="Option[Int]">leader</a> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><a title="Int" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.l">l</a><span class="delimiter">)</span> =&gt;
              try <span class="delimiter">{</span>
                <span title="(x: kafka.cluster.Broker)Some[kafka.cluster.Broker]">Some</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache" title="(zkClient: org.I0Itec.zkclient.ZkClient, cachedBrokerInfo: scala.collection.mutable.Map[Int,kafka.cluster.Broker], brokerIds: Seq[Int])Seq[kafka.cluster.Broker]">getBrokerInfoFromCache</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).cachedBrokerInfo" title="scala.collection.mutable.HashMap[Int,kafka.cluster.Broker]">cachedBrokerInfo</a>, <span title="(xs: Int*)List[Int]">List</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.l" title="Int">l</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; kafka.cluster.Broker">head</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> catch <span class="delimiter">{</span>
                case <span title="Throwable">e</span>: <span title="Throwable">Throwable</span> =&gt; throw new <a href="../common/LeaderNotAvailableException.scala.html#kafka.common;LeaderNotAvailableException" title="kafka.common.LeaderNotAvailableException">LeaderNotAvailableException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Leader not available for partition [%s,%d]&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partition" title="Int">partition</a><span class="delimiter">)</span>, <span title="Throwable">e</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            case <span title="None.type">None</span> =&gt; throw new <a href="../common/LeaderNotAvailableException.scala.html#kafka.common;LeaderNotAvailableException" title="kafka.common.LeaderNotAvailableException">LeaderNotAvailableException</a><span class="delimiter">(</span><span title="String(&quot;No leader exists for partition &quot;)" class="string">&quot;No leader exists for partition &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partition" title="Int">partition</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          try <span class="delimiter">{</span>
            <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicaInfo" title="Seq[kafka.cluster.Broker]">replicaInfo</a> = <a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache" title="(zkClient: org.I0Itec.zkclient.ZkClient, cachedBrokerInfo: scala.collection.mutable.Map[Int,kafka.cluster.Broker], brokerIds: Seq[Int])Seq[kafka.cluster.Broker]">getBrokerInfoFromCache</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).cachedBrokerInfo" title="scala.collection.mutable.HashMap[Int,kafka.cluster.Broker]">cachedBrokerInfo</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicas" title="Seq[Int]">replicas</a>.<span title="(f: Int =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[Int],Int,Seq[Int]])Seq[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Int,Seq[Int]]" class="delimiter">(</span><a title="Int" id="kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.$anonfun.id">id</a> =&gt; <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.$anonfun.id" title="Int">id</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.isrInfo" title="Seq[kafka.cluster.Broker]">isrInfo</a> = <a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache" title="(zkClient: org.I0Itec.zkclient.ZkClient, cachedBrokerInfo: scala.collection.mutable.Map[Int,kafka.cluster.Broker], brokerIds: Seq[Int])Seq[kafka.cluster.Broker]">getBrokerInfoFromCache</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).cachedBrokerInfo" title="scala.collection.mutable.HashMap[Int,kafka.cluster.Broker]">cachedBrokerInfo</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.inSyncReplicas" title="Seq[Int]">inSyncReplicas</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> catch <span class="delimiter">{</span>
            case <span title="Throwable">e</span>: <span title="Throwable">Throwable</span> =&gt; throw new <a href="../common/ReplicaNotAvailableException.scala.html#kafka.common;ReplicaNotAvailableException" title="kafka.common.ReplicaNotAvailableException">ReplicaNotAvailableException</a><span class="delimiter">(</span><span title="Throwable">e</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          if<span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicaInfo" title="Seq[kafka.cluster.Broker]">replicaInfo</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&lt;</span> <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicas" title="Seq[Int]">replicas</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
            throw new <a href="../common/ReplicaNotAvailableException.scala.html#kafka.common;ReplicaNotAvailableException" title="kafka.common.ReplicaNotAvailableException">ReplicaNotAvailableException</a><span class="delimiter">(</span><span title="String(&quot;Replica information not available for following brokers: &quot;)" class="string">&quot;Replica information not available for following brokers: &quot;</span> <span title="(x$1: Any)String">+</span>
              <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicas" title="Seq[Int]">replicas</a>.<span title="(p: Int =&gt; Boolean)Seq[Int]">filterNot</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicaInfo" title="Seq[kafka.cluster.Broker]">replicaInfo</a>.<span title="(f: kafka.cluster.Broker =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[kafka.cluster.Broker],Int,Seq[Int]])Seq[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Int,Seq[Int]]" class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.$anonfun.$anonfun.x$3" title="kafka.cluster.Broker">_</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.id" title="=&gt; Int">id</a><span class="delimiter">)</span>.<span title="(elem: Int)Boolean">contains</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.$anonfun.x$4" title="Int">_</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          if<span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.isrInfo" title="Seq[kafka.cluster.Broker]">isrInfo</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&lt;</span> <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.inSyncReplicas" title="Seq[Int]">inSyncReplicas</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
            throw new <a href="../common/ReplicaNotAvailableException.scala.html#kafka.common;ReplicaNotAvailableException" title="kafka.common.ReplicaNotAvailableException">ReplicaNotAvailableException</a><span class="delimiter">(</span><span title="String(&quot;In Sync Replica information not available for following brokers: &quot;)" class="string">&quot;In Sync Replica information not available for following brokers: &quot;</span> <span title="(x$1: Any)String">+</span>
              <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.inSyncReplicas" title="Seq[Int]">inSyncReplicas</a>.<span title="(p: Int =&gt; Boolean)Seq[Int]">filterNot</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.isrInfo" title="Seq[kafka.cluster.Broker]">isrInfo</a>.<span title="(f: kafka.cluster.Broker =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[kafka.cluster.Broker],Int,Seq[Int]])Seq[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Int,Seq[Int]]" class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.$anonfun.$anonfun.x$5" title="kafka.cluster.Broker">_</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.id" title="=&gt; Int">id</a><span class="delimiter">)</span>.<span title="(elem: Int)Boolean">contains</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.$anonfun.x$6" title="Int">_</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          new <a href="../api/TopicMetadata.scala.html#kafka.api;PartitionMetadata" title="kafka.api.PartitionMetadata">PartitionMetadata</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partition" title="Int">partition</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.leaderInfo" title="Option[kafka.cluster.Broker]">leaderInfo</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicaInfo" title="Seq[kafka.cluster.Broker]">replicaInfo</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.isrInfo" title="Seq[kafka.cluster.Broker]">isrInfo</a>, <a href="../common/ErrorMapping.scala.html#kafka.common.ErrorMapping" title="kafka.common.ErrorMapping.type">ErrorMapping</a>.<a href="../common/ErrorMapping.scala.html#kafka.common.ErrorMapping.NoError" title="=&gt; Short">NoError</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> catch <span class="delimiter">{</span>
          case <span title="Throwable">e</span>: <span title="Throwable">Throwable</span> =&gt;
            <a href="../utils/Logging.scala.html#kafka.utils;Logging.debug(cfd112d89b)" title="(msg: =&gt; String, e: =&gt; Throwable)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Error while fetching metadata for partition [%s,%d]&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partition" title="Int">partition</a><span class="delimiter">)</span>, <span title="Throwable">e</span><span class="delimiter">)</span>
            new <a href="../api/TopicMetadata.scala.html#kafka.api;PartitionMetadata" title="kafka.api.PartitionMetadata">PartitionMetadata</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.partition" title="Int">partition</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.leaderInfo" title="Option[kafka.cluster.Broker]">leaderInfo</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.replicaInfo" title="Seq[kafka.cluster.Broker]">replicaInfo</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata.$anonfun.isrInfo" title="Seq[kafka.cluster.Broker]">isrInfo</a>,
              <a href="../common/ErrorMapping.scala.html#kafka.common.ErrorMapping" title="kafka.common.ErrorMapping.type">ErrorMapping</a>.<a href="../common/ErrorMapping.scala.html#kafka.common.ErrorMapping.codeFor" title="(exception: Class[Throwable])Short">codeFor</a><span class="delimiter">(</span><span title="Throwable">e</span>.<span title="()Class[_]">getClass</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[Throwable]" class="delimiter">[</span><span title="Class[Throwable]">Class</span><span class="delimiter">[</span>Throwable<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      new <a href="../api/TopicMetadata.scala.html#kafka.api;TopicMetadata" title="kafka.api.TopicMetadata">TopicMetadata</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topic" title="String">topic</a>, <a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).partitionMetadata" title="List[kafka.api.PartitionMetadata]">partitionMetadata</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> else <span class="delimiter">{</span>
      <span class="comment">// topic doesn't exist, send appropriate error code</span>
      new <a href="../api/TopicMetadata.scala.html#kafka.api;TopicMetadata" title="kafka.api.TopicMetadata">TopicMetadata</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.fetchTopicMetadataFromZk(5fc434e960).topic" title="String">topic</a>, <span title="scala.collection.Seq.type">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[kafka.api.PartitionMetadata]" class="delimiter">[</span><a href="../api/TopicMetadata.scala.html#kafka.api;PartitionMetadata" title="kafka.api.PartitionMetadata">PartitionMetadata</a><span class="delimiter">]</span>, <a href="../common/ErrorMapping.scala.html#kafka.common.ErrorMapping" title="kafka.common.ErrorMapping.type">ErrorMapping</a>.<a href="../common/ErrorMapping.scala.html#kafka.common.ErrorMapping.UnknownTopicOrPartitionCode" title="=&gt; Short">UnknownTopicOrPartitionCode</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  private def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, cachedBrokerInfo: scala.collection.mutable.Map[Int,kafka.cluster.Broker], brokerIds: Seq[Int])Seq[kafka.cluster.Broker]" id="kafka.admin.AdminUtils.getBrokerInfoFromCache">getBrokerInfoFromCache</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.admin.AdminUtils.getBrokerInfoFromCache.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>,
                                     <a title="scala.collection.mutable.Map[Int,kafka.cluster.Broker]" id="kafka.admin.AdminUtils.getBrokerInfoFromCache.cachedBrokerInfo">cachedBrokerInfo</a>: scala.collection.mutable.<span title="scala.collection.mutable.Map[Int,kafka.cluster.Broker]">Map</span><span class="delimiter">[</span>Int, Broker<span class="delimiter">]</span>,
                                     <a title="Seq[Int]" id="kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerIds">brokerIds</a>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Seq[kafka.cluster.Broker]">Seq</span><span class="delimiter">[</span>Broker<span class="delimiter">]</span> = <span class="delimiter">{</span>
    var <a title="scala.collection.mutable.ListBuffer[Int]" id="kafka.admin.AdminUtils.getBrokerInfoFromCache.failedBrokerIds">failedBrokerIds</a>: <span title="scala.collection.mutable.ListBuffer[Int]">ListBuffer</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = new <span title="scala.collection.mutable.ListBuffer[Int]">ListBuffer</span><span class="delimiter">(</span><span class="delimiter">)</span>
    val <a title="Seq[Option[kafka.cluster.Broker]]" id="kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerMetadata">brokerMetadata</a> = <a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerIds" title="Seq[Int]">brokerIds</a>.<span title="(f: Int =&gt; Option[kafka.cluster.Broker])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[Int],Option[kafka.cluster.Broker],Seq[Option[kafka.cluster.Broker]]])Seq[Option[kafka.cluster.Broker]]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Option[kafka.cluster.Broker],Seq[Option[kafka.cluster.Broker]]]" class="delimiter">{</span> <a title="Int" id="kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerMetadata.$anonfun.id">id</a> =&gt;
      val <a title="Option[kafka.cluster.Broker]" id="kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerMetadata.$anonfun.optionalBrokerInfo">optionalBrokerInfo</a> = <a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.cachedBrokerInfo" title="scala.collection.mutable.Map[Int,kafka.cluster.Broker]">cachedBrokerInfo</a>.<span title="(key: Int)Option[kafka.cluster.Broker]">get</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerMetadata.$anonfun.id" title="Int">id</a><span class="delimiter">)</span>
      <a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerMetadata.$anonfun.optionalBrokerInfo" title="Option[kafka.cluster.Broker]">optionalBrokerInfo</a> match <span class="delimiter">{</span>
        case Some<span class="delimiter">(</span><span title="kafka.cluster.Broker">brokerInfo</span><span class="delimiter">)</span> =&gt; <span title="(x: kafka.cluster.Broker)Some[kafka.cluster.Broker]">Some</span><span class="delimiter">(</span><span title="kafka.cluster.Broker">brokerInfo</span><span class="delimiter">)</span> <span class="comment">// return broker info from the cache</span>
        case <span title="None.type">None</span> =&gt; <span class="comment">// fetch it from zookeeper</span>
          <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getBrokerInfo" title="(zkClient: org.I0Itec.zkclient.ZkClient, brokerId: Int)Option[kafka.cluster.Broker]">getBrokerInfo</a><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerMetadata.$anonfun.id" title="Int">id</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><span title="kafka.cluster.Broker">brokerInfo</span><span class="delimiter">)</span> =&gt;
              <a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.cachedBrokerInfo" title="scala.collection.mutable.Map[Int,kafka.cluster.Broker]">cachedBrokerInfo</a> <span title="(kv: (Int, kafka.cluster.Broker))cachedBrokerInfo.type">+=</span> <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerMetadata.$anonfun.id" title="(self: Int)ArrowAssoc[Int]">id</a> <span title="(y: kafka.cluster.Broker)(Int, kafka.cluster.Broker)">-&gt;</span> <span title="kafka.cluster.Broker">brokerInfo</span><span class="delimiter">)</span>
              <span title="(x: kafka.cluster.Broker)Some[kafka.cluster.Broker]">Some</span><span class="delimiter">(</span><span title="kafka.cluster.Broker">brokerInfo</span><span class="delimiter">)</span>
            case <span title="None.type">None</span> =&gt;
              <a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.failedBrokerIds" title="scala.collection.mutable.ListBuffer[Int]">failedBrokerIds</a> <span title="(x: Int)scala.collection.mutable.ListBuffer[Int]">+=</span> <a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerMetadata.$anonfun.id" title="Int">id</a>
              <span title="None.type">None</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.brokerMetadata" title="Seq[Option[kafka.cluster.Broker]]">brokerMetadata</a>.<span title="(p: Option[kafka.cluster.Broker] =&gt; Boolean)Seq[Option[kafka.cluster.Broker]]">filter</span><span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.$anonfun.x$7" title="Option[kafka.cluster.Broker]">_</a>.<span title="=&gt; Boolean">isDefined</span><span class="delimiter">)</span>.<span title="(f: Option[kafka.cluster.Broker] =&gt; kafka.cluster.Broker)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[Option[kafka.cluster.Broker]],kafka.cluster.Broker,Seq[kafka.cluster.Broker]])Seq[kafka.cluster.Broker]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,kafka.cluster.Broker,Seq[kafka.cluster.Broker]]" class="delimiter">(</span><a href="#kafka.admin.AdminUtils.getBrokerInfoFromCache.$anonfun.x$8" title="Option[kafka.cluster.Broker]">_</a>.<span title="=&gt; kafka.cluster.Broker">get</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="(firstReplicaIndex: Int, secondReplicaShift: Int, replicaIndex: Int, nBrokers: Int)Int" id="kafka.admin.AdminUtils.replicaIndex">replicaIndex</a><span class="delimiter">(</span><a title="Int" id="kafka.admin.AdminUtils.replicaIndex.firstReplicaIndex">firstReplicaIndex</a>: <span title="Int">Int</span>, <a title="Int" id="kafka.admin.AdminUtils.replicaIndex.secondReplicaShift">secondReplicaShift</a>: <span title="Int">Int</span>, <a title="Int" id="kafka.admin.AdminUtils.replicaIndex.replicaIndex">replicaIndex</a>: <span title="Int">Int</span>, <a title="Int" id="kafka.admin.AdminUtils.replicaIndex.nBrokers">nBrokers</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    val shift = <span title="Int(1)" class="int">1</span> <a title="Int" id="kafka.admin.AdminUtils.replicaIndex.shift">+</a> <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.replicaIndex.secondReplicaShift" title="Int">secondReplicaShift</a> <span title="(x: Int)Int">+</span> <a href="#kafka.admin.AdminUtils.replicaIndex.replicaIndex" title="Int">replicaIndex</a><span class="delimiter">)</span> <span title="(x: Int)Int">%</span> <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.replicaIndex.nBrokers" title="Int">nBrokers</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">(</span><a href="#kafka.admin.AdminUtils.replicaIndex.firstReplicaIndex" title="Int">firstReplicaIndex</a> <span title="(x: Int)Int">+</span> <a href="#kafka.admin.AdminUtils.replicaIndex.shift" title="Int">shift</a><span class="delimiter">)</span> <span title="(x: Int)Int">%</span> <a href="#kafka.admin.AdminUtils.replicaIndex.nBrokers" title="Int">nBrokers</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

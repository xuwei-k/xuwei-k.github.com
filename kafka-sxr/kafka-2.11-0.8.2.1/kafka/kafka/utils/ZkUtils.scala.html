<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>kafka/kafka/utils/ZkUtils.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

package kafka.utils

import kafka.cluster.<span class="delimiter">{</span>Broker, Cluster<span class="delimiter">}</span>
import kafka.consumer.<span class="delimiter">{</span>ConsumerThreadId, TopicCount<span class="delimiter">}</span>
import org.I0Itec.zkclient.ZkClient
import org.I0Itec.zkclient.exception.<span class="delimiter">{</span>ZkNodeExistsException, ZkNoNodeException,
  ZkMarshallingError, ZkBadVersionException<span class="delimiter">}</span>
import org.I0Itec.zkclient.serialize.ZkSerializer
import collection._
import kafka.api.LeaderAndIsr
import org.apache.zookeeper.data.Stat
import kafka.admin._
import kafka.common.<span class="delimiter">{</span>KafkaException, NoEpochForPartitionException<span class="delimiter">}</span>
import kafka.controller.ReassignedPartitionsContext
import kafka.controller.KafkaController
import scala.Some
import kafka.controller.LeaderIsrAndControllerEpoch
import kafka.common.TopicAndPartition
import scala.collection

object <a title="kafka.utils.ZkUtils.type" id="kafka.utils.ZkUtils">ZkUtils</a> extends <a href="Logging.scala.html#kafka.utils;Logging" title="kafka.utils.Logging">Logging</a> <span class="delimiter">{</span>
  val <a title="String" id="kafka.utils.ZkUtils.ConsumersPath">ConsumersPath</a> = <span title="String(&quot;/consumers&quot;)" class="string">&quot;/consumers&quot;</span>
  val <a title="String" id="kafka.utils.ZkUtils.BrokerIdsPath">BrokerIdsPath</a> = <span title="String(&quot;/brokers/ids&quot;)" class="string">&quot;/brokers/ids&quot;</span>
  val <a title="String" id="kafka.utils.ZkUtils.BrokerTopicsPath">BrokerTopicsPath</a> = <span title="String(&quot;/brokers/topics&quot;)" class="string">&quot;/brokers/topics&quot;</span>
  val <a title="String" id="kafka.utils.ZkUtils.TopicConfigPath">TopicConfigPath</a> = <span title="String(&quot;/config/topics&quot;)" class="string">&quot;/config/topics&quot;</span>
  val <a title="String" id="kafka.utils.ZkUtils.TopicConfigChangesPath">TopicConfigChangesPath</a> = <span title="String(&quot;/config/changes&quot;)" class="string">&quot;/config/changes&quot;</span>
  val <a title="String" id="kafka.utils.ZkUtils.ControllerPath">ControllerPath</a> = <span title="String(&quot;/controller&quot;)" class="string">&quot;/controller&quot;</span>
  val <a title="String" id="kafka.utils.ZkUtils.ControllerEpochPath">ControllerEpochPath</a> = <span title="String(&quot;/controller_epoch&quot;)" class="string">&quot;/controller_epoch&quot;</span>
  val <a title="String" id="kafka.utils.ZkUtils.ReassignPartitionsPath">ReassignPartitionsPath</a> = <span title="String(&quot;/admin/reassign_partitions&quot;)" class="string">&quot;/admin/reassign_partitions&quot;</span>
  val <a title="String" id="kafka.utils.ZkUtils.DeleteTopicsPath">DeleteTopicsPath</a> = <span title="String(&quot;/admin/delete_topics&quot;)" class="string">&quot;/admin/delete_topics&quot;</span>
  val <a title="String" id="kafka.utils.ZkUtils.PreferredReplicaLeaderElectionPath">PreferredReplicaLeaderElectionPath</a> = <span title="String(&quot;/admin/preferred_replica_election&quot;)" class="string">&quot;/admin/preferred_replica_election&quot;</span>

  def <a title="(topic: String)String" id="kafka.utils.ZkUtils.getTopicPath">getTopicPath</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getTopicPath.topic">topic</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <a href="#kafka.utils.ZkUtils.BrokerTopicsPath" title="=&gt; String">BrokerTopicsPath</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.getTopicPath.topic" title="String">topic</a>
  <span class="delimiter">}</span>

  def <a title="(topic: String)String" id="kafka.utils.ZkUtils.getTopicPartitionsPath">getTopicPartitionsPath</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getTopicPartitionsPath.topic">topic</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <a href="#kafka.utils.ZkUtils.getTopicPath" title="(topic: String)String">getTopicPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getTopicPartitionsPath.topic" title="String">topic</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/partitions&quot;)" class="string">&quot;/partitions&quot;</span>
  <span class="delimiter">}</span>

  def <a title="(topic: String)String" id="kafka.utils.ZkUtils.getTopicConfigPath">getTopicConfigPath</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getTopicConfigPath.topic">topic</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> =
    <a href="#kafka.utils.ZkUtils.TopicConfigPath" title="=&gt; String">TopicConfigPath</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.getTopicConfigPath.topic" title="String">topic</a>

  def <a title="(topic: String)String" id="kafka.utils.ZkUtils.getDeleteTopicPath">getDeleteTopicPath</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getDeleteTopicPath.topic">topic</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> =
    <a href="#kafka.utils.ZkUtils.DeleteTopicsPath" title="=&gt; String">DeleteTopicsPath</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.getDeleteTopicPath.topic" title="String">topic</a>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient)Int" id="kafka.utils.ZkUtils.getController">getController</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getController.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    <a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getController.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.ControllerPath" title="=&gt; String">ControllerPath</a><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getController.controller">controller</a><span class="delimiter">)</span> =&gt; <a href="../controller/KafkaController.scala.html#kafka.controller.KafkaController" title="kafka.controller.KafkaController.type">KafkaController</a>.<a href="../controller/KafkaController.scala.html#kafka.controller.KafkaController.parseControllerId" title="(controllerInfoString: String)Int">parseControllerId</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getController.controller" title="String">controller</a><span class="delimiter">)</span>
      case <span title="None.type">None</span> =&gt; throw new <a href="../common/KafkaException.scala.html#kafka.common;KafkaException" title="kafka.common.KafkaException">KafkaException</a><span class="delimiter">(</span><span title="String(&quot;Controller doesn\'t exist&quot;)" class="string">&quot;Controller doesn't exist&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(topic: String, partitionId: Int)String" id="kafka.utils.ZkUtils.getTopicPartitionPath">getTopicPartitionPath</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getTopicPartitionPath.topic">topic</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.getTopicPartitionPath.partitionId">partitionId</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> =
    <a href="#kafka.utils.ZkUtils.getTopicPartitionsPath" title="(topic: String)String">getTopicPartitionsPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getTopicPartitionPath.topic" title="String">topic</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.getTopicPartitionPath.partitionId" title="Int">partitionId</a>

  def <a title="(topic: String, partitionId: Int)String" id="kafka.utils.ZkUtils.getTopicPartitionLeaderAndIsrPath">getTopicPartitionLeaderAndIsrPath</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getTopicPartitionLeaderAndIsrPath.topic">topic</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.getTopicPartitionLeaderAndIsrPath.partitionId">partitionId</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> =
    <a href="#kafka.utils.ZkUtils.getTopicPartitionPath" title="(topic: String, partitionId: Int)String">getTopicPartitionPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getTopicPartitionLeaderAndIsrPath.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getTopicPartitionLeaderAndIsrPath.partitionId" title="Int">partitionId</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;state&quot;)" class="string">&quot;state&quot;</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient)Seq[Int]" id="kafka.utils.ZkUtils.getSortedBrokerList">getSortedBrokerList</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getSortedBrokerList.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> =
    <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.getChildren" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Seq[String]">getChildren</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getSortedBrokerList.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.BrokerIdsPath" title="=&gt; String">BrokerIdsPath</a><span class="delimiter">)</span>.<span title="(f: String =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],Int,Seq[Int]])Seq[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Int,Seq[Int]]" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getSortedBrokerList.$anonfun.x$1" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[Int])Seq[Int]">sorted</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient)Seq[kafka.cluster.Broker]" id="kafka.utils.ZkUtils.getAllBrokersInCluster">getAllBrokersInCluster</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getAllBrokersInCluster.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span>: <span title="Seq[kafka.cluster.Broker]">Seq</span><span class="delimiter">[</span>Broker<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="Seq[String]" id="kafka.utils.ZkUtils.getAllBrokersInCluster.brokerIds">brokerIds</a> = <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.getChildrenParentMayNotExist" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Seq[String]">getChildrenParentMayNotExist</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllBrokersInCluster.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.BrokerIdsPath" title="=&gt; String">BrokerIdsPath</a><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])Seq[String]">sorted</span>
    <a href="#kafka.utils.ZkUtils.getAllBrokersInCluster.brokerIds" title="Seq[String]">brokerIds</a>.<span title="(f: String =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],Int,Seq[Int]])Seq[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Int,Seq[Int]]" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllBrokersInCluster.$anonfun.x$2" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>.<span title="(f: Int =&gt; Option[kafka.cluster.Broker])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[Int],Option[kafka.cluster.Broker],Seq[Option[kafka.cluster.Broker]]])Seq[Option[kafka.cluster.Broker]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Option[kafka.cluster.Broker],Seq[Option[kafka.cluster.Broker]]]" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getBrokerInfo" title="(zkClient: org.I0Itec.zkclient.ZkClient, brokerId: Int)Option[kafka.cluster.Broker]">getBrokerInfo</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllBrokersInCluster.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getAllBrokersInCluster.$anonfun.x$3" title="Int">_</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(p: Option[kafka.cluster.Broker] =&gt; Boolean)Seq[Option[kafka.cluster.Broker]]">filter</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllBrokersInCluster.$anonfun.x$4" title="Option[kafka.cluster.Broker]">_</a>.<span title="=&gt; Boolean">isDefined</span><span class="delimiter">)</span>.<span title="(f: Option[kafka.cluster.Broker] =&gt; kafka.cluster.Broker)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[Option[kafka.cluster.Broker]],kafka.cluster.Broker,Seq[kafka.cluster.Broker]])Seq[kafka.cluster.Broker]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,kafka.cluster.Broker,Seq[kafka.cluster.Broker]]" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllBrokersInCluster.$anonfun.x$5" title="Option[kafka.cluster.Broker]">_</a>.<span title="=&gt; kafka.cluster.Broker">get</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Option[kafka.api.LeaderAndIsr]" id="kafka.utils.ZkUtils.getLeaderAndIsrForPartition">getLeaderAndIsrForPartition</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getLeaderAndIsrForPartition.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.getLeaderAndIsrForPartition.topic">topic</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.getLeaderAndIsrForPartition.partition">partition</a>: <span title="Int">Int</span><span class="delimiter">)</span>:<span title="Option[kafka.api.LeaderAndIsr]">Option</span><span class="delimiter">[</span>LeaderAndIsr<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="ReplicationUtils.scala.html#kafka.utils.ReplicationUtils" title="kafka.utils.ReplicationUtils.type">ReplicationUtils</a>.<a href="ReplicationUtils.scala.html#kafka.utils.ReplicationUtils.getLeaderIsrAndEpochForPartition" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Option[kafka.controller.LeaderIsrAndControllerEpoch]">getLeaderIsrAndEpochForPartition</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getLeaderAndIsrForPartition.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getLeaderAndIsrForPartition.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getLeaderAndIsrForPartition.partition" title="Int">partition</a><span class="delimiter">)</span>.<span title="(f: kafka.controller.LeaderIsrAndControllerEpoch =&gt; kafka.api.LeaderAndIsr)Option[kafka.api.LeaderAndIsr]">map</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getLeaderAndIsrForPartition.$anonfun.x$6" title="kafka.controller.LeaderIsrAndControllerEpoch">_</a>.<a href="../controller/KafkaController.scala.html#kafka.controller;LeaderIsrAndControllerEpoch.leaderAndIsr" title="=&gt; kafka.api.LeaderAndIsr">leaderAndIsr</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient)Unit" id="kafka.utils.ZkUtils.setupCommonPaths">setupCommonPaths</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.setupCommonPaths.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    for<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.setupCommonPaths.$anonfun.path">path</a> &lt;- <span title="(elems: String*)Seq[String]">Seq</span><span title="(f: String =&gt; Unit)Unit" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.ConsumersPath" title="=&gt; String">ConsumersPath</a>, <a href="#kafka.utils.ZkUtils.BrokerIdsPath" title="=&gt; String">BrokerIdsPath</a>, <a href="#kafka.utils.ZkUtils.BrokerTopicsPath" title="=&gt; String">BrokerTopicsPath</a>, <a href="#kafka.utils.ZkUtils.TopicConfigChangesPath" title="=&gt; String">TopicConfigChangesPath</a>, <a href="#kafka.utils.ZkUtils.TopicConfigPath" title="=&gt; String">TopicConfigPath</a>, <a href="#kafka.utils.ZkUtils.DeleteTopicsPath" title="=&gt; String">DeleteTopicsPath</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#kafka.utils.ZkUtils.makeSurePersistentPathExists" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Unit">makeSurePersistentPathExists</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.setupCommonPaths.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.setupCommonPaths.$anonfun.path" title="String">path</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Option[Int]" id="kafka.utils.ZkUtils.getLeaderForPartition">getLeaderForPartition</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getLeaderForPartition.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.getLeaderForPartition.topic">topic</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.getLeaderForPartition.partition">partition</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Option[Int]">Option</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="Option[String]" id="kafka.utils.ZkUtils.getLeaderForPartition.leaderAndIsrOpt">leaderAndIsrOpt</a> = <a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getLeaderForPartition.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getTopicPartitionLeaderAndIsrPath" title="(topic: String, partitionId: Int)String">getTopicPartitionLeaderAndIsrPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getLeaderForPartition.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getLeaderForPartition.partition" title="Int">partition</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span>
    <a href="#kafka.utils.ZkUtils.getLeaderForPartition.leaderAndIsrOpt" title="Option[String]">leaderAndIsrOpt</a> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getLeaderForPartition.leaderAndIsr">leaderAndIsr</a><span class="delimiter">)</span> =&gt;
        <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.parseFull" title="(input: String)Option[Any]">parseFull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getLeaderForPartition.leaderAndIsr" title="String">leaderAndIsr</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
          case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.getLeaderForPartition.m">m</a><span class="delimiter">)</span> =&gt;
            <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getLeaderForPartition.m" title="Any">m</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Any]" class="delimiter">[</span><span title="scala.collection.Map[String,Any]">Map</span><span class="delimiter">[</span>String, Any<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;leader&quot;)" class="string">&quot;leader&quot;</span><span class="delimiter">)</span>.<span title="=&gt; Any">get</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span><span class="delimiter">)</span>
          case <span title="None.type">None</span> =&gt; <span title="None.type">None</span>
        <span class="delimiter">}</span>
      case <span title="None.type">None</span> =&gt; <span title="None.type">None</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * This API should read the epoch in the ISR path. It is sufficient to read the epoch in the ISR path, since if the
   * leader fails after updating epoch in the leader path and before updating epoch in the ISR path, effectively some
   * other broker will retry becoming leader with the same new epoch value.
   */</span>
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Int" id="kafka.utils.ZkUtils.getEpochForPartition">getEpochForPartition</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getEpochForPartition.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.getEpochForPartition.topic">topic</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.getEpochForPartition.partition">partition</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    val <a title="Option[String]" id="kafka.utils.ZkUtils.getEpochForPartition.leaderAndIsrOpt">leaderAndIsrOpt</a> = <a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getEpochForPartition.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getTopicPartitionLeaderAndIsrPath" title="(topic: String, partitionId: Int)String">getTopicPartitionLeaderAndIsrPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getEpochForPartition.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getEpochForPartition.partition" title="Int">partition</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span>
    <a href="#kafka.utils.ZkUtils.getEpochForPartition.leaderAndIsrOpt" title="Option[String]">leaderAndIsrOpt</a> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getEpochForPartition.leaderAndIsr">leaderAndIsr</a><span class="delimiter">)</span> =&gt;
        <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.parseFull" title="(input: String)Option[Any]">parseFull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getEpochForPartition.leaderAndIsr" title="String">leaderAndIsr</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
          case <span title="None.type">None</span> =&gt; throw new <a href="../common/NoEpochForPartitionException.scala.html#kafka.common;NoEpochForPartitionException" title="kafka.common.NoEpochForPartitionException">NoEpochForPartitionException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;No epoch, leaderAndISR data for partition [%s,%d] is invalid&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getEpochForPartition.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getEpochForPartition.partition" title="Int">partition</a><span class="delimiter">)</span><span class="delimiter">)</span>
          case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.getEpochForPartition.m">m</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getEpochForPartition.m" title="Any">m</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Any]" class="delimiter">[</span><span title="scala.collection.Map[String,Any]">Map</span><span class="delimiter">[</span>String, Any<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;leader_epoch&quot;)" class="string">&quot;leader_epoch&quot;</span><span class="delimiter">)</span>.<span title="=&gt; Any">get</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span>
        <span class="delimiter">}</span>
      case <span title="None.type">None</span> =&gt; throw new <a href="../common/NoEpochForPartitionException.scala.html#kafka.common;NoEpochForPartitionException" title="kafka.common.NoEpochForPartitionException">NoEpochForPartitionException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;No epoch, ISR path for partition [%s,%d] is empty&quot;</span>
        .<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getEpochForPartition.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getEpochForPartition.partition" title="Int">partition</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Gets the in-sync replicas (ISR) for a specific topic and partition
   */</span>
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Seq[Int]" id="kafka.utils.ZkUtils.getInSyncReplicasForPartition">getInSyncReplicasForPartition</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getInSyncReplicasForPartition.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.getInSyncReplicasForPartition.topic">topic</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.getInSyncReplicasForPartition.partition">partition</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="Option[String]" id="kafka.utils.ZkUtils.getInSyncReplicasForPartition.leaderAndIsrOpt">leaderAndIsrOpt</a> = <a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getInSyncReplicasForPartition.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getTopicPartitionLeaderAndIsrPath" title="(topic: String, partitionId: Int)String">getTopicPartitionLeaderAndIsrPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getInSyncReplicasForPartition.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getInSyncReplicasForPartition.partition" title="Int">partition</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span>
    <a href="#kafka.utils.ZkUtils.getInSyncReplicasForPartition.leaderAndIsrOpt" title="Option[String]">leaderAndIsrOpt</a> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getInSyncReplicasForPartition.leaderAndIsr">leaderAndIsr</a><span class="delimiter">)</span> =&gt;
        <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.parseFull" title="(input: String)Option[Any]">parseFull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getInSyncReplicasForPartition.leaderAndIsr" title="String">leaderAndIsr</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
          case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.getInSyncReplicasForPartition.m">m</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getInSyncReplicasForPartition.m" title="Any">m</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Any]" class="delimiter">[</span><span title="scala.collection.Map[String,Any]">Map</span><span class="delimiter">[</span>String, Any<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;isr&quot;)" class="string">&quot;isr&quot;</span><span class="delimiter">)</span>.<span title="=&gt; Any">get</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Seq[Int]" class="delimiter">[</span><span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span>
          case <span title="None.type">None</span> =&gt; <span title="scala.collection.Seq.type">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[Int]" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span>
        <span class="delimiter">}</span>
      case <span title="None.type">None</span> =&gt; <span title="scala.collection.Seq.type">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[Int]" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Gets the assigned replicas (AR) for a specific topic and partition
   */</span>
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Seq[Int]" id="kafka.utils.ZkUtils.getReplicasForPartition">getReplicasForPartition</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getReplicasForPartition.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.getReplicasForPartition.topic">topic</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.getReplicasForPartition.partition">partition</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="Option[String]" id="kafka.utils.ZkUtils.getReplicasForPartition.jsonPartitionMapOpt">jsonPartitionMapOpt</a> = <a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getReplicasForPartition.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getTopicPath" title="(topic: String)String">getTopicPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getReplicasForPartition.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span>
    <a href="#kafka.utils.ZkUtils.getReplicasForPartition.jsonPartitionMapOpt" title="Option[String]">jsonPartitionMapOpt</a> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getReplicasForPartition.jsonPartitionMap">jsonPartitionMap</a><span class="delimiter">)</span> =&gt;
        <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.parseFull" title="(input: String)Option[Any]">parseFull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getReplicasForPartition.jsonPartitionMap" title="String">jsonPartitionMap</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
          case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.getReplicasForPartition.m">m</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getReplicasForPartition.m" title="Any">m</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Any]" class="delimiter">[</span><span title="scala.collection.Map[String,Any]">Map</span><span class="delimiter">[</span>String, Any<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;partitions&quot;)" class="string">&quot;partitions&quot;</span><span class="delimiter">)</span> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.getReplicasForPartition.replicaMap">replicaMap</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getReplicasForPartition.replicaMap" title="Any">replicaMap</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Seq[Int]]" class="delimiter">[</span><span title="scala.collection.Map[String,Seq[Int]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(key: String)Option[Seq[Int]]">get</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getReplicasForPartition.partition" title="Int">partition</a>.<span title="()String">toString</span><span class="delimiter">)</span> match <span class="delimiter">{</span>
              case Some<span class="delimiter">(</span><a title="Seq[Int]" id="kafka.utils.ZkUtils.getReplicasForPartition.seq">seq</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getReplicasForPartition.seq" title="Seq[Int]">seq</a>
              case <span title="None.type">None</span> =&gt; <span title="scala.collection.Seq.type">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[Int]" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span>
            <span class="delimiter">}</span>
            case <span title="None.type">None</span> =&gt; <span title="scala.collection.Seq.type">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[Int]" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span>
          <span class="delimiter">}</span>
          case <span title="None.type">None</span> =&gt; <span title="scala.collection.Seq.type">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[Int]" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span>
        <span class="delimiter">}</span>
      case <span title="None.type">None</span> =&gt; <span title="scala.collection.Seq.type">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[Int]" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, id: Int, host: String, port: Int, timeout: Int, jmxPort: Int)Unit" id="kafka.utils.ZkUtils.registerBrokerInZk">registerBrokerInZk</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.registerBrokerInZk.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="Int" id="kafka.utils.ZkUtils.registerBrokerInZk.id">id</a>: <span title="Int">Int</span>, <a title="String" id="kafka.utils.ZkUtils.registerBrokerInZk.host">host</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.registerBrokerInZk.port">port</a>: <span title="Int">Int</span>, <a title="Int" id="kafka.utils.ZkUtils.registerBrokerInZk.timeout">timeout</a>: <span title="Int">Int</span>, <a title="Int" id="kafka.utils.ZkUtils.registerBrokerInZk.jmxPort">jmxPort</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val brokerIdPath = <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.BrokerIdsPath" title="=&gt; String">BrokerIdsPath</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <a title="String" id="kafka.utils.ZkUtils.registerBrokerInZk.brokerIdPath">+</a> <a href="#kafka.utils.ZkUtils.registerBrokerInZk.id" title="Int">id</a>
    val <a title="String" id="kafka.utils.ZkUtils.registerBrokerInZk.timestamp">timestamp</a> = <a href="Time.scala.html#kafka.utils.SystemTime" title="kafka.utils.SystemTime.type">SystemTime</a>.<a href="Time.scala.html#kafka.utils.SystemTime.milliseconds" title="=&gt; Long">milliseconds</a>.<span title="()String">toString</span>
    val <a title="String" id="kafka.utils.ZkUtils.registerBrokerInZk.brokerInfo">brokerInfo</a> = <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.encode" title="(obj: Any)String">encode</a><span class="delimiter">(</span><span title="(elems: (String, Any)*)scala.collection.Map[String,Any]">Map</span><span class="delimiter">(</span><span title="(self: String)ArrowAssoc[String]" class="string">&quot;version&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <span title="Int(1)" class="int">1</span>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;host&quot;</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#kafka.utils.ZkUtils.registerBrokerInZk.host" title="String">host</a>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;port&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <a href="#kafka.utils.ZkUtils.registerBrokerInZk.port" title="Int">port</a>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;jmx_port&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <a href="#kafka.utils.ZkUtils.registerBrokerInZk.jmxPort" title="Int">jmxPort</a>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;timestamp&quot;</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#kafka.utils.ZkUtils.registerBrokerInZk.timestamp" title="String">timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span>
    val <a title="kafka.cluster.Broker" id="kafka.utils.ZkUtils.registerBrokerInZk.expectedBroker">expectedBroker</a> = new <a href="../cluster/Broker.scala.html#kafka.cluster;Broker" title="kafka.cluster.Broker">Broker</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.registerBrokerInZk.id" title="Int">id</a>, <a href="#kafka.utils.ZkUtils.registerBrokerInZk.host" title="String">host</a>, <a href="#kafka.utils.ZkUtils.registerBrokerInZk.port" title="Int">port</a><span class="delimiter">)</span>

    try <span class="delimiter">{</span>
      <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug" title="(zkClient: org.I0Itec.zkclient.ZkClient, path: String, data: String, expectedCallerData: Any, checker: (String, Any) =&gt; Boolean, backoffTime: Int)Unit">createEphemeralPathExpectConflictHandleZKBug</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.registerBrokerInZk.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.registerBrokerInZk.brokerIdPath" title="String">brokerIdPath</a>, <a href="#kafka.utils.ZkUtils.registerBrokerInZk.brokerInfo" title="String">brokerInfo</a>, <a href="#kafka.utils.ZkUtils.registerBrokerInZk.expectedBroker" title="kafka.cluster.Broker">expectedBroker</a>,
        <span class="delimiter">(</span>brokerString: <span title="String">String</span>, broker: <span title="Any">Any</span><span class="delimiter">)</span> =&gt; <a href="../cluster/Broker.scala.html#kafka.cluster.Broker" title="kafka.cluster.Broker.type">Broker</a>.<a href="../cluster/Broker.scala.html#kafka.cluster.Broker.createBroker" title="(id: Int, brokerInfoString: String)kafka.cluster.Broker">createBroker</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.registerBrokerInZk.$anonfun.broker" title="Any">broker</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="kafka.cluster.Broker" class="delimiter">[</span><a href="../cluster/Broker.scala.html#kafka.cluster;Broker" title="kafka.cluster.Broker">Broker</a><span class="delimiter">]</span>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.id" title="=&gt; Int">id</a>, <a href="#kafka.utils.ZkUtils.registerBrokerInZk.$anonfun.brokerString" title="String">brokerString</a><span class="delimiter">)</span>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.equals" title="(obj: Any)Boolean">equals</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.registerBrokerInZk.$anonfun.broker" title="Any">broker</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="kafka.cluster.Broker" class="delimiter">[</span><a href="../cluster/Broker.scala.html#kafka.cluster;Broker" title="kafka.cluster.Broker">Broker</a><span class="delimiter">]</span><span class="delimiter">)</span>,
        <a href="#kafka.utils.ZkUtils.registerBrokerInZk.timeout" title="Int">timeout</a><span class="delimiter">)</span>

    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNodeExistsException" id="kafka.utils.ZkUtils.registerBrokerInZk.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNodeExistsException">ZkNodeExistsException</span> =&gt;
        throw new <span title="RuntimeException">RuntimeException</span><span class="delimiter">(</span><span title="String(&quot;A broker is already registered on the path &quot;)" class="string">&quot;A broker is already registered on the path &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.registerBrokerInZk.brokerIdPath" title="String">brokerIdPath</a>
          <span title="(x$1: Any)String">+</span> <span title="String(&quot;. This probably &quot;)" class="string">&quot;. This probably &quot;</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;indicates that you either have configured a brokerid that is already in use, or &quot;)" class="string">&quot;indicates that you either have configured a brokerid that is already in use, or &quot;</span>
          <span title="(x$1: Any)String">+</span> <span title="String(&quot;else you have shutdown this broker and restarted it faster than the zookeeper &quot;)" class="string">&quot;else you have shutdown this broker and restarted it faster than the zookeeper &quot;</span>
          <span title="(x$1: Any)String">+</span> <span title="String(&quot;timeout so it appears to be re-registering.&quot;)" class="string">&quot;timeout so it appears to be re-registering.&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Registered broker %d at path %s with address %s:%d.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.registerBrokerInZk.id" title="Int">id</a>, <a href="#kafka.utils.ZkUtils.registerBrokerInZk.brokerIdPath" title="String">brokerIdPath</a>, <a href="#kafka.utils.ZkUtils.registerBrokerInZk.host" title="String">host</a>, <a href="#kafka.utils.ZkUtils.registerBrokerInZk.port" title="Int">port</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(group: String, topic: String, partition: Int)String" id="kafka.utils.ZkUtils.getConsumerPartitionOwnerPath">getConsumerPartitionOwnerPath</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getConsumerPartitionOwnerPath.group">group</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.getConsumerPartitionOwnerPath.topic">topic</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.getConsumerPartitionOwnerPath.partition">partition</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    val <a title="kafka.utils.ZKGroupTopicDirs" id="kafka.utils.ZkUtils.getConsumerPartitionOwnerPath.topicDirs">topicDirs</a> = new <a href="#kafka.utils;ZKGroupTopicDirs" title="kafka.utils.ZKGroupTopicDirs">ZKGroupTopicDirs</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumerPartitionOwnerPath.group" title="String">group</a>, <a href="#kafka.utils.ZkUtils.getConsumerPartitionOwnerPath.topic" title="String">topic</a><span class="delimiter">)</span>
    <a href="#kafka.utils.ZkUtils.getConsumerPartitionOwnerPath.topicDirs" title="kafka.utils.ZKGroupTopicDirs">topicDirs</a>.<a href="#kafka.utils;ZKGroupTopicDirs.consumerOwnerDir" title="=&gt; String">consumerOwnerDir</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.getConsumerPartitionOwnerPath.partition" title="Int">partition</a>
  <span class="delimiter">}</span>


  def <a title="(leaderAndIsr: kafka.api.LeaderAndIsr, controllerEpoch: Int)String" id="kafka.utils.ZkUtils.leaderAndIsrZkData">leaderAndIsrZkData</a><span class="delimiter">(</span><a title="kafka.api.LeaderAndIsr" id="kafka.utils.ZkUtils.leaderAndIsrZkData.leaderAndIsr">leaderAndIsr</a>: <a href="../api/LeaderAndIsrRequest.scala.html#kafka.api;LeaderAndIsr" title="kafka.api.LeaderAndIsr">LeaderAndIsr</a>, <a title="Int" id="kafka.utils.ZkUtils.leaderAndIsrZkData.controllerEpoch">controllerEpoch</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.encode" title="(obj: Any)String">encode</a><span class="delimiter">(</span><span title="(elems: (String, Any)*)scala.collection.Map[String,Any]">Map</span><span class="delimiter">(</span><span title="(self: String)ArrowAssoc[String]" class="string">&quot;version&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <span title="Int(1)" class="int">1</span>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;leader&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <a href="#kafka.utils.ZkUtils.leaderAndIsrZkData.leaderAndIsr" title="kafka.api.LeaderAndIsr">leaderAndIsr</a>.<a href="../api/LeaderAndIsrRequest.scala.html#kafka.api;LeaderAndIsr.leader" title="=&gt; Int">leader</a>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;leader_epoch&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <a href="#kafka.utils.ZkUtils.leaderAndIsrZkData.leaderAndIsr" title="kafka.api.LeaderAndIsr">leaderAndIsr</a>.<a href="../api/LeaderAndIsrRequest.scala.html#kafka.api;LeaderAndIsr.leaderEpoch" title="=&gt; Int">leaderEpoch</a>,
                    <span title="(self: String)ArrowAssoc[String]" class="string">&quot;controller_epoch&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <a href="#kafka.utils.ZkUtils.leaderAndIsrZkData.controllerEpoch" title="Int">controllerEpoch</a>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;isr&quot;</span> <span title="(y: List[Int])(String, List[Int])">-&gt;</span> <a href="#kafka.utils.ZkUtils.leaderAndIsrZkData.leaderAndIsr" title="kafka.api.LeaderAndIsr">leaderAndIsr</a>.<a href="../api/LeaderAndIsrRequest.scala.html#kafka.api;LeaderAndIsr.isr" title="=&gt; List[Int]">isr</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Get JSON partition to replica map from zookeeper.
   */</span>
  def <a title="(map: scala.collection.Map[String,Seq[Int]])String" id="kafka.utils.ZkUtils.replicaAssignmentZkData">replicaAssignmentZkData</a><span class="delimiter">(</span><a title="scala.collection.Map[String,Seq[Int]]" id="kafka.utils.ZkUtils.replicaAssignmentZkData.map">map</a>: <span title="scala.collection.Map[String,Seq[Int]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.encode" title="(obj: Any)String">encode</a><span class="delimiter">(</span><span title="(elems: (String, Any)*)scala.collection.Map[String,Any]">Map</span><span class="delimiter">(</span><span title="(self: String)ArrowAssoc[String]" class="string">&quot;version&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <span title="Int(1)" class="int">1</span>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;partitions&quot;</span> <span title="(y: scala.collection.Map[String,Seq[Int]])(String, scala.collection.Map[String,Seq[Int]])">-&gt;</span> <a href="#kafka.utils.ZkUtils.replicaAssignmentZkData.map" title="scala.collection.Map[String,Seq[Int]]">map</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   *  make sure a persistent path exists in ZK. Create the path if not exist.
   */</span>
  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String)Unit" id="kafka.utils.ZkUtils.makeSurePersistentPathExists">makeSurePersistentPathExists</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.makeSurePersistentPathExists.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.makeSurePersistentPathExists.path">path</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.utils.ZkUtils.makeSurePersistentPathExists.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String)Boolean">exists</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.makeSurePersistentPathExists.path" title="String">path</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#kafka.utils.ZkUtils.makeSurePersistentPathExists.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Boolean)Unit">createPersistent</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.makeSurePersistentPathExists.path" title="String">path</a>, true<span class="delimiter">)</span> <span class="comment">// won't throw NoNodeException or NodeExistsException</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   *  create the parent path
   */</span>
  private def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String)Unit" id="kafka.utils.ZkUtils.createParentPath">createParentPath</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.createParentPath.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.createParentPath.path">path</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    val <a title="String" id="kafka.utils.ZkUtils.createParentPath.parentDir">parentDir</a> = <a href="#kafka.utils.ZkUtils.createParentPath.path" title="String">path</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#kafka.utils.ZkUtils.createParentPath.path" title="String">path</a>.<span title="(x$1: Int)Int">lastIndexOf</span><span class="delimiter">(</span><span title="Int(47)" class="char">'/'</span><span class="delimiter">)</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createParentPath.parentDir" title="String">parentDir</a>.<span title="()Int">length</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#kafka.utils.ZkUtils.createParentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Boolean)Unit">createPersistent</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createParentPath.parentDir" title="String">parentDir</a>, true<span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Create an ephemeral node with the given path and data. Create parents if necessary.
   */</span>
  private def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit" id="kafka.utils.ZkUtils.createEphemeralPath">createEphemeralPath</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.createEphemeralPath.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.createEphemeralPath.path">path</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.createEphemeralPath.data">data</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      <a href="#kafka.utils.ZkUtils.createEphemeralPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any)Unit">createEphemeral</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPath.data" title="String">data</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNoNodeException" id="kafka.utils.ZkUtils.createEphemeralPath.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt; <span class="delimiter">{</span>
        <a href="#kafka.utils.ZkUtils.createParentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Unit">createParentPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPath.path" title="String">path</a><span class="delimiter">)</span>
        <a href="#kafka.utils.ZkUtils.createEphemeralPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any)Unit">createEphemeral</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPath.data" title="String">data</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Create an ephemeral node with the given path and data.
   * Throw NodeExistException if node already exists.
   */</span>
  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflict">createEphemeralPathExpectConflict</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflict.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflict.path">path</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflict.data">data</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      <a href="#kafka.utils.ZkUtils.createEphemeralPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit">createEphemeralPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.client" title="org.I0Itec.zkclient.ZkClient">client</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.data" title="String">data</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNodeExistsException" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflict.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNodeExistsException">ZkNodeExistsException</span> =&gt; <span class="delimiter">{</span>
        <span class="comment">// this can happen when there is connection loss; make sure the data is what we intend to write</span>
        var <a title="String" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflict.storedData">storedData</a>: <span title="String">String</span> = null
        try <span class="delimiter">{</span>
          <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.storedData" title="String">storedData</a> = <a href="#kafka.utils.ZkUtils.readData" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(String, org.apache.zookeeper.data.Stat)">readData</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.client" title="org.I0Itec.zkclient.ZkClient">client</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.path" title="String">path</a><span class="delimiter">)</span>.<span title="=&gt; String">_1</span>
        <span class="delimiter">}</span> catch <span class="delimiter">{</span>
          case <a title="org.I0Itec.zkclient.exception.ZkNoNodeException" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflict.e1">e1</a>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt; <span class="comment">// the node disappeared; treat as if node existed and let caller handles this</span>
          case <span title="Throwable">e2</span>: <span title="Throwable">Throwable</span> =&gt; throw <span title="Throwable">e2</span>
        <span class="delimiter">}</span>
        if <span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.storedData" title="String">storedData</a> <span title="(x$1: Any)Boolean">==</span> null <span title="(x: Boolean)Boolean">||</span> <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.storedData" title="String">storedData</a> <span title="(x$1: Any)Boolean">!=</span> <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.data" title="String">data</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="String(&quot;conflict in &quot;)" class="string">&quot;conflict in &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.path" title="String">path</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; data: &quot;)" class="string">&quot; data: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.data" title="String">data</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; stored data: &quot;)" class="string">&quot; stored data: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.storedData" title="String">storedData</a><span class="delimiter">)</span>
          throw <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.e" title="org.I0Itec.zkclient.exception.ZkNodeExistsException">e</a>
        <span class="delimiter">}</span> else <span class="delimiter">{</span>
          <span class="comment">// otherwise, the creation succeeded, return normally</span>
          <a href="Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.path" title="String">path</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; exists with value &quot;)" class="string">&quot; exists with value &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict.data" title="String">data</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; during connection loss; this is ok&quot;)" class="string">&quot; during connection loss; this is ok&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      case <span title="Throwable">e2</span>: <span title="Throwable">Throwable</span> =&gt; throw <span title="Throwable">e2</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Create an ephemeral node with the given path and data.
   * Throw NodeExistsException if node already exists.
   * Handles the following ZK session timeout bug:
   *
   * https://issues.apache.org/jira/browse/ZOOKEEPER-1740
   *
   * Upon receiving a NodeExistsException, read the data from the conflicted path and
   * trigger the checker function comparing the read data and the expected data,
   * If the checker function returns true then the above bug might be encountered, back off and retry;
   * otherwise re-throw the exception
   */</span>
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, path: String, data: String, expectedCallerData: Any, checker: (String, Any) =&gt; Boolean, backoffTime: Int)Unit" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug">createEphemeralPathExpectConflictHandleZKBug</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.path">path</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.data">data</a>: <span title="String">String</span>, <a title="Any" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.expectedCallerData">expectedCallerData</a>: <span title="Any">Any</span>, <a title="(String, Any) =&gt; Boolean" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.checker">checker</a>: <span class="delimiter">(</span>String, Any<span class="delimiter">)</span> =&gt; Boolean, <a title="Int" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.backoffTime">backoffTime</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    while <span class="delimiter">(</span>true<span class="delimiter">)</span> <span class="delimiter">{</span>
      try <span class="delimiter">{</span>
        <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflict" title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit">createEphemeralPathExpectConflict</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.data" title="String">data</a><span class="delimiter">)</span>
        return
      <span class="delimiter">}</span> catch <span class="delimiter">{</span>
        case <a title="org.I0Itec.zkclient.exception.ZkNodeExistsException" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNodeExistsException">ZkNodeExistsException</span> =&gt; <span class="delimiter">{</span>
          <span class="comment">// An ephemeral node may still exist even after its corresponding session has expired</span>
          <span class="comment">// due to a Zookeeper bug, in this case we need to retry writing until the previous node is deleted</span>
          <span class="comment">// and hence the write succeeds without ZkNodeExistsException</span>
          <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.path" title="String">path</a><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.writtenData">writtenData</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
              if <span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.checker" title="(v1: String, v2: Any)Boolean">checker</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.writtenData" title="String">writtenData</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.expectedCallerData" title="Any">expectedCallerData</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;I wrote this conflicted ephemeral node [%s] at %s a while back in a different session, &quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.data" title="String">data</a>, <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.path" title="String">path</a><span class="delimiter">)</span>
                  <span title="(x$1: Any)String">+</span> <span title="String(&quot;hence I will backoff for this node to be deleted by Zookeeper and retry&quot;)" class="string">&quot;hence I will backoff for this node to be deleted by Zookeeper and retry&quot;</span><span class="delimiter">)</span>

                <span title="Thread.type">Thread</span>.<span title="(x$1: Long)Unit">sleep</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.backoffTime" title="=&gt; Long">backoffTime</a><span class="delimiter">)</span>
              <span class="delimiter">}</span> else <span class="delimiter">{</span>
                throw <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.e" title="org.I0Itec.zkclient.exception.ZkNodeExistsException">e</a>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
            case <span title="None.type">None</span> =&gt; <span class="comment">// the node disappeared; retry creating the ephemeral node immediately</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
        case <a title="Throwable" id="kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.e2">e2</a>: <span title="Throwable">Throwable</span> =&gt; throw <a href="#kafka.utils.ZkUtils.createEphemeralPathExpectConflictHandleZKBug.e2" title="Throwable">e2</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Create an persistent node with the given path and data. Create parents if necessary.
   */</span>
  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit" id="kafka.utils.ZkUtils.createPersistentPath">createPersistentPath</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.createPersistentPath.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.createPersistentPath.path">path</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.createPersistentPath$default$3">data</a>: <span title="String">String</span> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      <a href="#kafka.utils.ZkUtils.createPersistentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any)Unit">createPersistent</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createPersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.createPersistentPath$default$3" title="String">data</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNoNodeException" id="kafka.utils.ZkUtils.createPersistentPath.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt; <span class="delimiter">{</span>
        <a href="#kafka.utils.ZkUtils.createParentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Unit">createParentPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createPersistentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>, <a href="#kafka.utils.ZkUtils.createPersistentPath.path" title="String">path</a><span class="delimiter">)</span>
        <a href="#kafka.utils.ZkUtils.createPersistentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any)Unit">createPersistent</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createPersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.createPersistentPath$default$3" title="String">data</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)String" id="kafka.utils.ZkUtils.createSequentialPersistentPath">createSequentialPersistentPath</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.createSequentialPersistentPath.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.createSequentialPersistentPath.path">path</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.createSequentialPersistentPath$default$3">data</a>: <span title="String">String</span> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <a href="#kafka.utils.ZkUtils.createSequentialPersistentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any)String">createPersistentSequential</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.createSequentialPersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.createSequentialPersistentPath$default$3" title="String">data</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Update the value of a persistent node with the given path and data.
   * create parrent directory if necessary. Never throw NodeExistException.
   * Return the updated path zkVersion
   */</span>
  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit" id="kafka.utils.ZkUtils.updatePersistentPath">updatePersistentPath</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.updatePersistentPath.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.updatePersistentPath.path">path</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.updatePersistentPath.data">data</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      <a href="#kafka.utils.ZkUtils.updatePersistentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any)Unit">writeData</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.updatePersistentPath.data" title="String">data</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">e</span>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt; <span class="delimiter">{</span>
        <a href="#kafka.utils.ZkUtils.createParentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Unit">createParentPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePersistentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>, <a href="#kafka.utils.ZkUtils.updatePersistentPath.path" title="String">path</a><span class="delimiter">)</span>
        try <span class="delimiter">{</span>
          <a href="#kafka.utils.ZkUtils.updatePersistentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any)Unit">createPersistent</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.updatePersistentPath.data" title="String">data</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> catch <span class="delimiter">{</span>
          case <span title="org.I0Itec.zkclient.exception.ZkNodeExistsException">e</span>: <span title="org.I0Itec.zkclient.exception.ZkNodeExistsException">ZkNodeExistsException</span> =&gt;
            <a href="#kafka.utils.ZkUtils.updatePersistentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any)Unit">writeData</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.updatePersistentPath.data" title="String">data</a><span class="delimiter">)</span>
          case <span title="Throwable">e2</span>: <span title="Throwable">Throwable</span> =&gt; throw <span title="Throwable">e2</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      case <span title="Throwable">e2</span>: <span title="Throwable">Throwable</span> =&gt; throw <span title="Throwable">e2</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Conditional update the persistent path data, return (true, newVersion) if it succeeds, otherwise (the path doesn't
   * exist, the current version is not the expected version, etc.) return (false, -1)
   *
   * When there is a ConnectionLossException during the conditional update, zkClient will retry the update and may fail
   * since the previous update may have succeeded (but the stored zkVersion no longer matches the expected one).
   * In this case, we will run the optionalChecker to further check if the previous write did indeed succeeded.
   */</span>
  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String, expectVersion: Int, optionalChecker: Option[(org.I0Itec.zkclient.ZkClient, String, String) =&gt; (Boolean, Int)])(Boolean, Int)" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPath">conditionalUpdatePersistentPath</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPath.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPath.path">path</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPath.data">data</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPath.expectVersion">expectVersion</a>: <span title="Int">Int</span>,
    <a title="Option[(org.I0Itec.zkclient.ZkClient, String, String) =&gt; (Boolean, Int)]" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPath$default$5">optionalChecker</a>:<span title="Option[(org.I0Itec.zkclient.ZkClient, String, String) =&gt; (Boolean, Int)]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span>ZkClient, String, String<span class="delimiter">)</span> =&gt; <span class="delimiter">(</span>Boolean,Int<span class="delimiter">)</span><span class="delimiter">]</span> = <span title="None.type">None</span><span class="delimiter">)</span>: <span title="(Boolean, Int)" class="delimiter">(</span>Boolean, Int<span class="delimiter">)</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      val <a title="org.apache.zookeeper.data.Stat" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPath.stat">stat</a> = <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any, x$3: Int)org.apache.zookeeper.data.Stat">writeDataReturnStat</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.data" title="String">data</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.expectVersion" title="Int">expectVersion</a><span class="delimiter">)</span>
      <a href="Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Conditional update of path %s with value %s and expected version %d succeeded, returning the new version: %d&quot;</span>
        .<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.data" title="String">data</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.expectVersion" title="Int">expectVersion</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.stat" title="org.apache.zookeeper.data.Stat">stat</a>.<span title="()Int">getVersion</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="(_1: Boolean, _2: Int)(Boolean, Int)" class="delimiter">(</span>true, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.stat" title="org.apache.zookeeper.data.Stat">stat</a>.<span title="()Int">getVersion</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkBadVersionException" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPath.e1">e1</a>: <span title="org.I0Itec.zkclient.exception.ZkBadVersionException">ZkBadVersionException</span> =&gt;
        <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath$default$5" title="Option[(org.I0Itec.zkclient.ZkClient, String, String) =&gt; (Boolean, Int)]">optionalChecker</a> match <span class="delimiter">{</span>
          case Some<span class="delimiter">(</span><a title="(org.I0Itec.zkclient.ZkClient, String, String) =&gt; (Boolean, Int)" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPath.checker">checker</a><span class="delimiter">)</span> =&gt; return <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.checker" title="(v1: org.I0Itec.zkclient.ZkClient, v2: String, v3: String)(Boolean, Int)">checker</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.data" title="String">data</a><span class="delimiter">)</span>
          case _ =&gt; <a href="Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Checker method is not passed skipping zkData match&quot;)" class="string">&quot;Checker method is not passed skipping zkData match&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="Logging.scala.html#kafka.utils;Logging.warn(1729dbc42f)" title="(msg: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Conditional update of path %s with data %s and expected version %d failed due to %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.data" title="String">data</a>,
          <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.expectVersion" title="Int">expectVersion</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.e1" title="org.I0Itec.zkclient.exception.ZkBadVersionException">e1</a>.<span title="()String">getMessage</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="(_1: Boolean, _2: Int)(Boolean, Int)" class="delimiter">(</span>false, -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span>
      case <a title="Exception" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPath.e2">e2</a>: <span title="Exception">Exception</span> =&gt;
        <a href="Logging.scala.html#kafka.utils;Logging.warn(1729dbc42f)" title="(msg: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Conditional update of path %s with data %s and expected version %d failed due to %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.data" title="String">data</a>,
          <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.expectVersion" title="Int">expectVersion</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPath.e2" title="Exception">e2</a>.<span title="()String">getMessage</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="(_1: Boolean, _2: Int)(Boolean, Int)" class="delimiter">(</span>false, -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Conditional update the persistent path data, return (true, newVersion) if it succeeds, otherwise (the current
   * version is not the expected version, etc.) return (false, -1). If path doesn't exist, throws ZkNoNodeException
   */</span>
  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String, expectVersion: Int)(Boolean, Int)" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists">conditionalUpdatePersistentPathIfExists</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.path">path</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.data">data</a>: <span title="String">String</span>, <a title="Int" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.expectVersion">expectVersion</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(Boolean, Int)" class="delimiter">(</span>Boolean, Int<span class="delimiter">)</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      val <a title="org.apache.zookeeper.data.Stat" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.stat">stat</a> = <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any, x$3: Int)org.apache.zookeeper.data.Stat">writeDataReturnStat</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.data" title="String">data</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.expectVersion" title="Int">expectVersion</a><span class="delimiter">)</span>
      <a href="Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Conditional update of path %s with value %s and expected version %d succeeded, returning the new version: %d&quot;</span>
        .<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.data" title="String">data</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.expectVersion" title="Int">expectVersion</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.stat" title="org.apache.zookeeper.data.Stat">stat</a>.<span title="()Int">getVersion</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="(_1: Boolean, _2: Int)(Boolean, Int)" class="delimiter">(</span>true, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.stat" title="org.apache.zookeeper.data.Stat">stat</a>.<span title="()Int">getVersion</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNoNodeException" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.nne">nne</a>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt; throw <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.nne" title="org.I0Itec.zkclient.exception.ZkNoNodeException">nne</a>
      case <a title="Exception" id="kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.e">e</a>: <span title="Exception">Exception</span> =&gt;
        <a href="Logging.scala.html#kafka.utils;Logging.error(1729dbc42f)" title="(msg: =&gt; String)Unit">error</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Conditional update of path %s with data %s and expected version %d failed due to %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.data" title="String">data</a>,
          <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.expectVersion" title="Int">expectVersion</a>, <a href="#kafka.utils.ZkUtils.conditionalUpdatePersistentPathIfExists.e" title="Exception">e</a>.<span title="()String">getMessage</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="(_1: Boolean, _2: Int)(Boolean, Int)" class="delimiter">(</span>false, -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Update the value of a persistent node with the given path and data.
   * create parrent directory if necessary. Never throw NodeExistException.
   */</span>
  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit" id="kafka.utils.ZkUtils.updateEphemeralPath">updateEphemeralPath</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.updateEphemeralPath.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.updateEphemeralPath.path">path</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.updateEphemeralPath.data">data</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      <a href="#kafka.utils.ZkUtils.updateEphemeralPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any)Unit">writeData</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updateEphemeralPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.updateEphemeralPath.data" title="String">data</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNoNodeException" id="kafka.utils.ZkUtils.updateEphemeralPath.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt; <span class="delimiter">{</span>
        <a href="#kafka.utils.ZkUtils.createParentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Unit">createParentPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updateEphemeralPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>, <a href="#kafka.utils.ZkUtils.updateEphemeralPath.path" title="String">path</a><span class="delimiter">)</span>
        <a href="#kafka.utils.ZkUtils.updateEphemeralPath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: Any)Unit">createEphemeral</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updateEphemeralPath.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.updateEphemeralPath.data" title="String">data</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      case <a title="Throwable" id="kafka.utils.ZkUtils.updateEphemeralPath.e2">e2</a>: <span title="Throwable">Throwable</span> =&gt; throw <a href="#kafka.utils.ZkUtils.updateEphemeralPath.e2" title="Throwable">e2</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String)Boolean" id="kafka.utils.ZkUtils.deletePath">deletePath</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.deletePath.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.deletePath.path">path</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      <a href="#kafka.utils.ZkUtils.deletePath.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String)Boolean">delete</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.deletePath.path" title="String">path</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNoNodeException" id="kafka.utils.ZkUtils.deletePath.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt;
        <span class="comment">// this can happen during a connection loss event, return normally</span>
        <a href="Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.deletePath.path" title="String">path</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; deleted during connection loss; this is ok&quot;)" class="string">&quot; deleted during connection loss; this is ok&quot;</span><span class="delimiter">)</span>
        false
      case <a title="Throwable" id="kafka.utils.ZkUtils.deletePath.e2">e2</a>: <span title="Throwable">Throwable</span> =&gt; throw <a href="#kafka.utils.ZkUtils.deletePath.e2" title="Throwable">e2</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String)Unit" id="kafka.utils.ZkUtils.deletePathRecursive">deletePathRecursive</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.deletePathRecursive.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.deletePathRecursive.path">path</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      <a href="#kafka.utils.ZkUtils.deletePathRecursive.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String)Boolean">deleteRecursive</span><span title="Unit" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.deletePathRecursive.path" title="String">path</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNoNodeException" id="kafka.utils.ZkUtils.deletePathRecursive.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt;
        <span class="comment">// this can happen during a connection loss event, return normally</span>
        <a href="Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.deletePathRecursive.path" title="String">path</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; deleted during connection loss; this is ok&quot;)" class="string">&quot; deleted during connection loss; this is ok&quot;</span><span class="delimiter">)</span>
      case <a title="Throwable" id="kafka.utils.ZkUtils.deletePathRecursive.e2">e2</a>: <span title="Throwable">Throwable</span> =&gt; throw <a href="#kafka.utils.ZkUtils.deletePathRecursive.e2" title="Throwable">e2</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkUrl: String, dir: String)Unit" id="kafka.utils.ZkUtils.maybeDeletePath">maybeDeletePath</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.maybeDeletePath.zkUrl">zkUrl</a>: <span title="String">String</span>, <a title="String" id="kafka.utils.ZkUtils.maybeDeletePath.dir">dir</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      val <a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.maybeDeletePath.zk">zk</a> = new <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.maybeDeletePath.zkUrl" title="String">zkUrl</a>, <span class="int">30</span><span title="Int(30000)">*</span><span class="int">1000</span>, <span class="int">30</span><span title="Int(30000)">*</span><span class="int">1000</span>, <a href="#kafka.utils.ZKStringSerializer" title="kafka.utils.ZKStringSerializer.type">ZKStringSerializer</a><span class="delimiter">)</span>
      <a href="#kafka.utils.ZkUtils.maybeDeletePath.zk" title="org.I0Itec.zkclient.ZkClient">zk</a>.<span title="(x$1: String)Boolean">deleteRecursive</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.maybeDeletePath.dir" title="String">dir</a><span class="delimiter">)</span>
      <a href="#kafka.utils.ZkUtils.maybeDeletePath.zk" title="org.I0Itec.zkclient.ZkClient">zk</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case _: <span title="Throwable">Throwable</span> =&gt; <span class="comment">// swallow</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String)(String, org.apache.zookeeper.data.Stat)" id="kafka.utils.ZkUtils.readData">readData</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.readData.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.readData.path">path</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="(String, org.apache.zookeeper.data.Stat)" class="delimiter">(</span>String, Stat<span class="delimiter">)</span> = <span class="delimiter">{</span>
    val <a title="org.apache.zookeeper.data.Stat" id="kafka.utils.ZkUtils.readData.stat">stat</a>: <span title="org.apache.zookeeper.data.Stat">Stat</span> = new <span title="org.apache.zookeeper.data.Stat">Stat</span><span class="delimiter">(</span><span class="delimiter">)</span>
    val <a title="String" id="kafka.utils.ZkUtils.readData.dataStr">dataStr</a>: <span title="String">String</span> = <a href="#kafka.utils.ZkUtils.readData.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: org.apache.zookeeper.data.Stat)Nothing">readData</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.readData.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.readData.stat" title="org.apache.zookeeper.data.Stat">stat</a><span class="delimiter">)</span>
    <span title="(_1: String, _2: org.apache.zookeeper.data.Stat)(String, org.apache.zookeeper.data.Stat)" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.readData.dataStr" title="String">dataStr</a>, <a href="#kafka.utils.ZkUtils.readData.stat" title="org.apache.zookeeper.data.Stat">stat</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)" id="kafka.utils.ZkUtils.readDataMaybeNull">readDataMaybeNull</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.readDataMaybeNull.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.readDataMaybeNull.path">path</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="(Option[String], org.apache.zookeeper.data.Stat)" class="delimiter">(</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Stat<span class="delimiter">)</span> = <span class="delimiter">{</span>
    val <a title="org.apache.zookeeper.data.Stat" id="kafka.utils.ZkUtils.readDataMaybeNull.stat">stat</a>: <span title="org.apache.zookeeper.data.Stat">Stat</span> = new <span title="org.apache.zookeeper.data.Stat">Stat</span><span class="delimiter">(</span><span class="delimiter">)</span>
    val <a title="(Option[Nothing], org.apache.zookeeper.data.Stat)" id="kafka.utils.ZkUtils.readDataMaybeNull.dataAndStat">dataAndStat</a> = try <span class="delimiter">{</span>
                        <span title="(_1: Some[Nothing], _2: org.apache.zookeeper.data.Stat)(Some[Nothing], org.apache.zookeeper.data.Stat)" class="delimiter">(</span><span title="(x: Nothing)Some[Nothing]">Some</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.readDataMaybeNull.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String, x$2: org.apache.zookeeper.data.Stat)Nothing">readData</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.readDataMaybeNull.path" title="String">path</a>, <a href="#kafka.utils.ZkUtils.readDataMaybeNull.stat" title="org.apache.zookeeper.data.Stat">stat</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#kafka.utils.ZkUtils.readDataMaybeNull.stat" title="org.apache.zookeeper.data.Stat">stat</a><span class="delimiter">)</span>
                      <span class="delimiter">}</span> catch <span class="delimiter">{</span>
                        case <a title="org.I0Itec.zkclient.exception.ZkNoNodeException" id="kafka.utils.ZkUtils.readDataMaybeNull.dataAndStat.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt;
                          <span title="(_1: None.type, _2: org.apache.zookeeper.data.Stat)(None.type, org.apache.zookeeper.data.Stat)" class="delimiter">(</span><span title="None.type">None</span>, <a href="#kafka.utils.ZkUtils.readDataMaybeNull.stat" title="org.apache.zookeeper.data.Stat">stat</a><span class="delimiter">)</span>
                        case <a title="Throwable" id="kafka.utils.ZkUtils.readDataMaybeNull.dataAndStat.e2">e2</a>: <span title="Throwable">Throwable</span> =&gt; throw <a href="#kafka.utils.ZkUtils.readDataMaybeNull.dataAndStat.e2" title="Throwable">e2</a>
                      <span class="delimiter">}</span>
    <a href="#kafka.utils.ZkUtils.readDataMaybeNull.dataAndStat" title="(Option[Nothing], org.apache.zookeeper.data.Stat)">dataAndStat</a>
  <span class="delimiter">}</span>

  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String)Seq[String]" id="kafka.utils.ZkUtils.getChildren">getChildren</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getChildren.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.getChildren.path">path</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    import scala.collection.<span title="scala.collection.JavaConversions.type">JavaConversions</span>._
    <span class="comment">// triggers implicit conversion from java list to scala Seq</span>
    <a href="#kafka.utils.ZkUtils.getChildren.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String)java.util.List[String]">getChildren</span><span title="(l: java.util.List[String])scala.collection.mutable.Buffer[String]" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getChildren.path" title="String">path</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String)Seq[String]" id="kafka.utils.ZkUtils.getChildrenParentMayNotExist">getChildrenParentMayNotExist</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getChildrenParentMayNotExist.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.getChildrenParentMayNotExist.path">path</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    import scala.collection.<span title="scala.collection.JavaConversions.type">JavaConversions</span>._
    <span class="comment">// triggers implicit conversion from java list to scala Seq</span>
    try <span class="delimiter">{</span>
      <a href="#kafka.utils.ZkUtils.getChildrenParentMayNotExist.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String)java.util.List[String]">getChildren</span><span title="(l: java.util.List[String])scala.collection.mutable.Buffer[String]" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getChildrenParentMayNotExist.path" title="String">path</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="org.I0Itec.zkclient.exception.ZkNoNodeException" id="kafka.utils.ZkUtils.getChildrenParentMayNotExist.e">e</a>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt; return <span title="scala.collection.immutable.Nil.type">Nil</span>
      case <a title="Throwable" id="kafka.utils.ZkUtils.getChildrenParentMayNotExist.e2">e2</a>: <span title="Throwable">Throwable</span> =&gt; throw <a href="#kafka.utils.ZkUtils.getChildrenParentMayNotExist.e2" title="Throwable">e2</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Check if the given path exists
   */</span>
  def <a title="(client: org.I0Itec.zkclient.ZkClient, path: String)Boolean" id="kafka.utils.ZkUtils.pathExists">pathExists</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.pathExists.client">client</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.pathExists.path">path</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <a href="#kafka.utils.ZkUtils.pathExists.client" title="org.I0Itec.zkclient.ZkClient">client</a>.<span title="(x$1: String)Boolean">exists</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.pathExists.path" title="String">path</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient)kafka.cluster.Cluster" id="kafka.utils.ZkUtils.getCluster">getCluster</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getCluster.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span> : <a href="../cluster/Cluster.scala.html#kafka.cluster;Cluster" title="kafka.cluster.Cluster">Cluster</a> = <span class="delimiter">{</span>
    val <a title="kafka.cluster.Cluster" id="kafka.utils.ZkUtils.getCluster.cluster">cluster</a> = new <a href="../cluster/Cluster.scala.html#kafka.cluster;Cluster" title="kafka.cluster.Cluster">Cluster</a>
    val <a title="Seq[String]" id="kafka.utils.ZkUtils.getCluster.nodes">nodes</a> = <a href="#kafka.utils.ZkUtils.getChildrenParentMayNotExist" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Seq[String]">getChildrenParentMayNotExist</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getCluster.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.BrokerIdsPath" title="=&gt; String">BrokerIdsPath</a><span class="delimiter">)</span>
    for <span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getCluster.$anonfun.node">node</a> &lt;- <a href="#kafka.utils.ZkUtils.getCluster.nodes" title="(f: String =&gt; Option[kafka.cluster.Broker])Unit">nodes</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="String" id="kafka.utils.ZkUtils.getCluster.$anonfun.brokerZKString">brokerZKString</a> = <a href="#kafka.utils.ZkUtils.readData" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(String, org.apache.zookeeper.data.Stat)">readData</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getCluster.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.BrokerIdsPath" title="=&gt; String">BrokerIdsPath</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.getCluster.$anonfun.node" title="String">node</a><span class="delimiter">)</span>.<span title="=&gt; String">_1</span>
      <a href="#kafka.utils.ZkUtils.getCluster.cluster" title="kafka.cluster.Cluster">cluster</a>.<a href="../cluster/Cluster.scala.html#kafka.cluster;Cluster.add" title="(broker: kafka.cluster.Broker)Option[kafka.cluster.Broker]">add</a><span class="delimiter">(</span><a href="../cluster/Broker.scala.html#kafka.cluster.Broker" title="kafka.cluster.Broker.type">Broker</a>.<a href="../cluster/Broker.scala.html#kafka.cluster.Broker.createBroker" title="(id: Int, brokerInfoString: String)kafka.cluster.Broker">createBroker</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getCluster.$anonfun.node" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">node</a>.<span title="=&gt; Int">toInt</span>, <a href="#kafka.utils.ZkUtils.getCluster.$anonfun.brokerZKString" title="String">brokerZKString</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#kafka.utils.ZkUtils.getCluster.cluster" title="kafka.cluster.Cluster">cluster</a>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topicAndPartitions: scala.collection.Set[kafka.common.TopicAndPartition])scala.collection.mutable.Map[kafka.common.TopicAndPartition,kafka.controller.LeaderIsrAndControllerEpoch]" id="kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics">getPartitionLeaderAndIsrForTopics</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="scala.collection.Set[kafka.common.TopicAndPartition]" id="kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.topicAndPartitions">topicAndPartitions</a>: <span title="scala.collection.Set[kafka.common.TopicAndPartition]">Set</span><span class="delimiter">[</span>TopicAndPartition<span class="delimiter">]</span><span class="delimiter">)</span>
  : mutable.<span title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,kafka.controller.LeaderIsrAndControllerEpoch]">Map</span><span class="delimiter">[</span>TopicAndPartition, LeaderIsrAndControllerEpoch<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="scala.collection.mutable.HashMap[kafka.common.TopicAndPartition,kafka.controller.LeaderIsrAndControllerEpoch]" id="kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.ret">ret</a> = new mutable.<span title="scala.collection.mutable.HashMap[kafka.common.TopicAndPartition,kafka.controller.LeaderIsrAndControllerEpoch]">HashMap</span><span class="delimiter">[</span>TopicAndPartition, LeaderIsrAndControllerEpoch<span class="delimiter">]</span>
    for<span class="delimiter">(</span><a title="kafka.common.TopicAndPartition" id="kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.$anonfun.topicAndPartition">topicAndPartition</a> &lt;- <a href="#kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.topicAndPartitions" title="(f: kafka.common.TopicAndPartition =&gt; Any)Unit">topicAndPartitions</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="ReplicationUtils.scala.html#kafka.utils.ReplicationUtils" title="kafka.utils.ReplicationUtils.type">ReplicationUtils</a>.<a href="ReplicationUtils.scala.html#kafka.utils.ReplicationUtils.getLeaderIsrAndEpochForPartition" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Option[kafka.controller.LeaderIsrAndControllerEpoch]">getLeaderIsrAndEpochForPartition</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.$anonfun.topicAndPartition" title="kafka.common.TopicAndPartition">topicAndPartition</a>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.topic" title="=&gt; String">topic</a>, <a href="#kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.$anonfun.topicAndPartition" title="kafka.common.TopicAndPartition">topicAndPartition</a>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.partition" title="=&gt; Int">partition</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
        case Some<span class="delimiter">(</span><a title="kafka.controller.LeaderIsrAndControllerEpoch" id="kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.$anonfun.leaderIsrAndControllerEpoch">leaderIsrAndControllerEpoch</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.ret" title="scala.collection.mutable.HashMap[kafka.common.TopicAndPartition,kafka.controller.LeaderIsrAndControllerEpoch]">ret</a>.<span title="(key: kafka.common.TopicAndPartition, value: kafka.controller.LeaderIsrAndControllerEpoch)Option[kafka.controller.LeaderIsrAndControllerEpoch]">put</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.$anonfun.topicAndPartition" title="kafka.common.TopicAndPartition">topicAndPartition</a>, <a href="#kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.$anonfun.leaderIsrAndControllerEpoch" title="kafka.controller.LeaderIsrAndControllerEpoch">leaderIsrAndControllerEpoch</a><span class="delimiter">)</span>
        case <span title="None.type">None</span> =&gt;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#kafka.utils.ZkUtils.getPartitionLeaderAndIsrForTopics.ret" title="scala.collection.mutable.HashMap[kafka.common.TopicAndPartition,kafka.controller.LeaderIsrAndControllerEpoch]">ret</a>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics">getReplicaAssignmentForTopics</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="Seq[String]" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.topics">topics</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: mutable.<span title="scala.collection.mutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">Map</span><span class="delimiter">[</span>TopicAndPartition, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="scala.collection.mutable.HashMap[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.ret">ret</a> = new mutable.<span title="scala.collection.mutable.HashMap[kafka.common.TopicAndPartition,Seq[Int]]">HashMap</span><span class="delimiter">[</span>TopicAndPartition, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span>
    <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.topics" title="Seq[String]">topics</a>.<span title="(f: String =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="String" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.topic">topic</a> =&gt;
      val <a title="Option[String]" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.jsonPartitionMapOpt">jsonPartitionMapOpt</a> = <a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getTopicPath" title="(topic: String)String">getTopicPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span>
      <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.jsonPartitionMapOpt" title="Option[String]">jsonPartitionMapOpt</a> match <span class="delimiter">{</span>
        case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.jsonPartitionMap">jsonPartitionMap</a><span class="delimiter">)</span> =&gt;
          <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.parseFull" title="(input: String)Option[Any]">parseFull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.jsonPartitionMap" title="String">jsonPartitionMap</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.m">m</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.m" title="Any">m</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Any]" class="delimiter">[</span><span title="scala.collection.Map[String,Any]">Map</span><span class="delimiter">[</span>String, Any<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;partitions&quot;)" class="string">&quot;partitions&quot;</span><span class="delimiter">)</span> match <span class="delimiter">{</span>
              case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.repl">repl</a><span class="delimiter">)</span>  =&gt;
                val <a title="scala.collection.Map[String,Seq[Int]]" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.replicaMap">replicaMap</a> = <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.repl" title="Any">repl</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Seq[Int]]" class="delimiter">[</span><span title="scala.collection.Map[String,Seq[Int]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>
                for<span class="delimiter">(</span><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.$anonfun.partition">partition</a>, <a title="Seq[Int]" id="kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.$anonfun.replicas">replicas</a><span class="delimiter">)</span> &lt;- <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.replicaMap" title="(f: ((String, Seq[Int])) =&gt; Unit)Unit">replicaMap</a><span class="delimiter">)</span><span class="delimiter">{</span>
                  <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.ret" title="scala.collection.mutable.HashMap[kafka.common.TopicAndPartition,Seq[Int]]">ret</a>.<span title="(key: kafka.common.TopicAndPartition, value: Seq[Int])Option[Seq[Int]]">put</span><span class="delimiter">(</span><a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition" title="(topic: String, partition: Int)kafka.common.TopicAndPartition">TopicAndPartition</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.$anonfun.partition" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">partition</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>, <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.$anonfun.replicas" title="Seq[Int]">replicas</a><span class="delimiter">)</span>
                  <a href="Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Replicas assigned to topic [%s], partition [%s] are [%s]&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.$anonfun.partition" title="String">partition</a>, <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.$anonfun.$anonfun.replicas" title="Seq[Int]">replicas</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              case <span title="None.type">None</span> =&gt;
            <span class="delimiter">}</span>
            case <span title="None.type">None</span> =&gt;
          <span class="delimiter">}</span>
        case <span title="None.type">None</span> =&gt;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#kafka.utils.ZkUtils.getReplicaAssignmentForTopics.ret" title="scala.collection.mutable.HashMap[kafka.common.TopicAndPartition,Seq[Int]]">ret</a>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[String,scala.collection.Map[Int,Seq[Int]]]" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics">getPartitionAssignmentForTopics</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="Seq[String]" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.topics">topics</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: mutable.<span title="scala.collection.mutable.Map[String,scala.collection.Map[Int,Seq[Int]]]">Map</span><span class="delimiter">[</span>String, collection.Map<span class="delimiter">[</span>Int, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="scala.collection.mutable.HashMap[String,scala.collection.Map[Int,Seq[Int]]]" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.ret">ret</a> = new mutable.<span title="scala.collection.mutable.HashMap[String,scala.collection.Map[Int,Seq[Int]]]">HashMap</span><span class="delimiter">[</span>String, Map<span class="delimiter">[</span>Int, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.topics" title="Seq[String]">topics</a>.<span title="(f: String =&gt; scala.collection.mutable.HashMap[String,scala.collection.Map[Int,Seq[Int]]])Unit">foreach</span><span class="delimiter">{</span> <a title="String" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.topic">topic</a> =&gt;
      val <a title="Option[String]" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.jsonPartitionMapOpt">jsonPartitionMapOpt</a> = <a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getTopicPath" title="(topic: String)String">getTopicPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span>
      val <a title="scala.collection.Map[Int,Seq[Int]]" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap">partitionMap</a> = <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.jsonPartitionMapOpt" title="Option[String]">jsonPartitionMapOpt</a> match <span class="delimiter">{</span>
        case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.jsonPartitionMap">jsonPartitionMap</a><span class="delimiter">)</span> =&gt;
          <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.parseFull" title="(input: String)Option[Any]">parseFull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.jsonPartitionMap" title="String">jsonPartitionMap</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.m">m</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.m" title="Any">m</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Any]" class="delimiter">[</span><span title="scala.collection.Map[String,Any]">Map</span><span class="delimiter">[</span>String, Any<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;partitions&quot;)" class="string">&quot;partitions&quot;</span><span class="delimiter">)</span> match <span class="delimiter">{</span>
              case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.replicaMap">replicaMap</a><span class="delimiter">)</span> =&gt;
                val <a title="scala.collection.Map[String,Seq[Int]]" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.m1">m1</a> = <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.replicaMap" title="Any">replicaMap</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Seq[Int]]" class="delimiter">[</span><span title="scala.collection.Map[String,Seq[Int]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>
                <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.m1" title="scala.collection.Map[String,Seq[Int]]">m1</a>.<span title="(f: ((String, Seq[Int])) =&gt; (Int, Seq[Int]))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.Map[String,Seq[Int]],(Int, Seq[Int]),scala.collection.Map[Int,Seq[Int]]])scala.collection.Map[Int,Seq[Int]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Map.Coll,(Int, Seq[Int]),scala.collection.Map[Int,Seq[Int]]]" class="delimiter">(</span><a title="(String, Seq[Int])" id="kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.$anonfun.p">p</a> =&gt; <span title="(_1: Int, _2: Seq[Int])(Int, Seq[Int])" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.$anonfun.p" title="(String, Seq[Int])">p</a>.<span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_1</span>.<span title="=&gt; Int">toInt</span>, <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap.$anonfun.p" title="(String, Seq[Int])">p</a>.<span title="=&gt; Seq[Int]">_2</span><span class="delimiter">)</span><span class="delimiter">)</span>
              case <span title="None.type">None</span> =&gt; <span title="[A, B](elems: (A, B)*)scala.collection.Map[A,B]">Map</span><span title="(elems: (Int, Seq[Int])*)scala.collection.Map[Int,Seq[Int]]" class="delimiter">[</span><span title="Int">Int</span>, <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            case <span title="None.type">None</span> =&gt; <span title="[A, B](elems: (A, B)*)scala.collection.Map[A,B]">Map</span><span title="(elems: (Int, Seq[Int])*)scala.collection.Map[Int,Seq[Int]]" class="delimiter">[</span><span title="Int">Int</span>, <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        case <span title="None.type">None</span> =&gt; <span title="[A, B](elems: (A, B)*)scala.collection.Map[A,B]">Map</span><span title="(elems: (Int, Seq[Int])*)scala.collection.Map[Int,Seq[Int]]" class="delimiter">[</span><span title="Int">Int</span>, <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Partition map for /brokers/topics/%s is %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap" title="scala.collection.Map[Int,Seq[Int]]">partitionMap</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.ret" title="scala.collection.mutable.HashMap[String,scala.collection.Map[Int,Seq[Int]]]">ret</a> <span title="(kv: (String, scala.collection.Map[Int,Seq[Int]]))ret.type">+=</span> <span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.topic" title="(self: String)ArrowAssoc[String]">topic</a> <span title="(y: scala.collection.Map[Int,Seq[Int]])(String, scala.collection.Map[Int,Seq[Int]])">-&gt;</span> <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.$anonfun.partitionMap" title="scala.collection.Map[Int,Seq[Int]]">partitionMap</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics.ret" title="scala.collection.mutable.HashMap[String,scala.collection.Map[Int,Seq[Int]]]">ret</a>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[String,Seq[Int]]" id="kafka.utils.ZkUtils.getPartitionsForTopics">getPartitionsForTopics</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getPartitionsForTopics.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="Seq[String]" id="kafka.utils.ZkUtils.getPartitionsForTopics.topics">topics</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: mutable.<span title="scala.collection.mutable.Map[String,Seq[Int]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#kafka.utils.ZkUtils.getPartitionAssignmentForTopics" title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[String,scala.collection.Map[Int,Seq[Int]]]">getPartitionAssignmentForTopics</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionsForTopics.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getPartitionsForTopics.topics" title="Seq[String]">topics</a><span class="delimiter">)</span>.<span title="(f: ((String, scala.collection.Map[Int,Seq[Int]])) =&gt; (String, Seq[Int]))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.mutable.Map[String,scala.collection.Map[Int,Seq[Int]]],(String, Seq[Int]),scala.collection.mutable.Map[String,Seq[Int]]])scala.collection.mutable.Map[String,Seq[Int]]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.mutable.Map.Coll,(String, Seq[Int]),scala.collection.mutable.Map[String,Seq[Int]]]" class="delimiter">{</span> <a title="(String, scala.collection.Map[Int,Seq[Int]])" id="kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.topicAndPartitionMap">topicAndPartitionMap</a> =&gt;
      val <a title="String" id="kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.topic">topic</a> = <a href="#kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.topicAndPartitionMap" title="(String, scala.collection.Map[Int,Seq[Int]])">topicAndPartitionMap</a>.<span title="=&gt; String">_1</span>
      val <a title="scala.collection.Map[Int,Seq[Int]]" id="kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.partitionMap">partitionMap</a> = <a href="#kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.topicAndPartitionMap" title="(String, scala.collection.Map[Int,Seq[Int]])">topicAndPartitionMap</a>.<span title="=&gt; scala.collection.Map[Int,Seq[Int]]">_2</span>
      <a href="Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;partition assignment of /brokers/topics/%s is %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.partitionMap" title="scala.collection.Map[Int,Seq[Int]]">partitionMap</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.topic" title="(self: String)ArrowAssoc[String]">topic</a> <span title="(y: Seq[Int])(String, Seq[Int])">-&gt;</span> <a href="#kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.partitionMap" title="scala.collection.Map[Int,Seq[Int]]">partitionMap</a>.<span title="=&gt; Iterable[Int]">keys</span>.<span title="=&gt; Seq[Int]">toSeq</span>.<span title="(lt: (Int, Int) =&gt; Boolean)Seq[Int]">sortWith</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="Int" id="kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.$anonfun.s">s</a>,<a title="Int" id="kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.$anonfun.t">t</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.$anonfun.s" title="Int">s</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#kafka.utils.ZkUtils.getPartitionsForTopics.$anonfun.$anonfun.t" title="Int">t</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient)scala.collection.Map[kafka.common.TopicAndPartition,kafka.controller.ReassignedPartitionsContext]" id="kafka.utils.ZkUtils.getPartitionsBeingReassigned">getPartitionsBeingReassigned</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getPartitionsBeingReassigned.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span>: <span title="scala.collection.Map[kafka.common.TopicAndPartition,kafka.controller.ReassignedPartitionsContext]">Map</span><span class="delimiter">[</span>TopicAndPartition, ReassignedPartitionsContext<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="comment">// read the partitions and their new replica list</span>
    val <a title="Option[String]" id="kafka.utils.ZkUtils.getPartitionsBeingReassigned.jsonPartitionMapOpt">jsonPartitionMapOpt</a> = <a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionsBeingReassigned.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.ReassignPartitionsPath" title="=&gt; String">ReassignPartitionsPath</a><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span>
    <a href="#kafka.utils.ZkUtils.getPartitionsBeingReassigned.jsonPartitionMapOpt" title="Option[String]">jsonPartitionMapOpt</a> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getPartitionsBeingReassigned.jsonPartitionMap">jsonPartitionMap</a><span class="delimiter">)</span> =&gt;
        val <a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.utils.ZkUtils.getPartitionsBeingReassigned.reassignedPartitions">reassignedPartitions</a> = <a href="#kafka.utils.ZkUtils.parsePartitionReassignmentData" title="(jsonData: String)scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">parsePartitionReassignmentData</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionsBeingReassigned.jsonPartitionMap" title="String">jsonPartitionMap</a><span class="delimiter">)</span>
        <a href="#kafka.utils.ZkUtils.getPartitionsBeingReassigned.reassignedPartitions" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">reassignedPartitions</a>.<span title="(f: ((kafka.common.TopicAndPartition, Seq[Int])) =&gt; (kafka.common.TopicAndPartition, kafka.controller.ReassignedPartitionsContext))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]],(kafka.common.TopicAndPartition, kafka.controller.ReassignedPartitionsContext),scala.collection.Map[kafka.common.TopicAndPartition,kafka.controller.ReassignedPartitionsContext]])scala.collection.Map[kafka.common.TopicAndPartition,kafka.controller.ReassignedPartitionsContext]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Map.Coll,(kafka.common.TopicAndPartition, kafka.controller.ReassignedPartitionsContext),scala.collection.Map[kafka.common.TopicAndPartition,kafka.controller.ReassignedPartitionsContext]]" class="delimiter">(</span><a title="(kafka.common.TopicAndPartition, Seq[Int])" id="kafka.utils.ZkUtils.getPartitionsBeingReassigned.$anonfun.p">p</a> =&gt; <span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionsBeingReassigned.$anonfun.p" title="(kafka.common.TopicAndPartition, Seq[Int])">p</a>.<span title="(self: kafka.common.TopicAndPartition)ArrowAssoc[kafka.common.TopicAndPartition]">_1</span> <span title="(y: kafka.controller.ReassignedPartitionsContext)(kafka.common.TopicAndPartition, kafka.controller.ReassignedPartitionsContext)">-&gt;</span> new <a href="../controller/KafkaController.scala.html#kafka.controller;ReassignedPartitionsContext" title="kafka.controller.ReassignedPartitionsContext">ReassignedPartitionsContext</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionsBeingReassigned.$anonfun.p" title="(kafka.common.TopicAndPartition, Seq[Int])">p</a>.<span title="=&gt; Seq[Int]">_2</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      case <span title="None.type">None</span> =&gt; <span title="scala.collection.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[kafka.common.TopicAndPartition,kafka.controller.ReassignedPartitionsContext]" class="delimiter">[</span><a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition" title="kafka.common.TopicAndPartition">TopicAndPartition</a>, <a href="../controller/KafkaController.scala.html#kafka.controller;ReassignedPartitionsContext" title="kafka.controller.ReassignedPartitionsContext">ReassignedPartitionsContext</a><span class="delimiter">]</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">// Parses without deduplicating keys so the the data can be checked before allowing reassignment to proceed</span>
  def <a title="(jsonData: String)Seq[(kafka.common.TopicAndPartition, Seq[Int])]" id="kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup">parsePartitionReassignmentDataWithoutDedup</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.jsonData">jsonData</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Seq[(kafka.common.TopicAndPartition, Seq[Int])]">Seq</span><span class="delimiter">[</span><span class="delimiter">(</span>TopicAndPartition, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.parseFull" title="(input: String)Option[Any]">parseFull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.jsonData" title="String">jsonData</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.m">m</a><span class="delimiter">)</span> =&gt;
        <a href="#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.m" title="Any">m</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Any]" class="delimiter">[</span><span title="scala.collection.Map[String,Any]">Map</span><span class="delimiter">[</span>String, Any<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;partitions&quot;)" class="string">&quot;partitions&quot;</span><span class="delimiter">)</span> match <span class="delimiter">{</span>
          case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.partitionsSeq">partitionsSeq</a><span class="delimiter">)</span> =&gt;
            <a href="#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.partitionsSeq" title="Any">partitionsSeq</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Seq[scala.collection.Map[String,Any]]" class="delimiter">[</span><span title="Seq[scala.collection.Map[String,Any]]">Seq</span><span class="delimiter">[</span>Map<span class="delimiter">[</span>String, Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(f: scala.collection.Map[String,Any] =&gt; (kafka.common.TopicAndPartition, Seq[Int]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[scala.collection.Map[String,Any]],(kafka.common.TopicAndPartition, Seq[Int]),Seq[(kafka.common.TopicAndPartition, Seq[Int])]])Seq[(kafka.common.TopicAndPartition, Seq[Int])]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(kafka.common.TopicAndPartition, Seq[Int]),Seq[(kafka.common.TopicAndPartition, Seq[Int])]]" class="delimiter">(</span><a title="scala.collection.Map[String,Any]" id="kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.$anonfun.p">p</a> =&gt; <span class="delimiter">{</span>
              val <a title="String" id="kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.$anonfun.topic">topic</a> = <a href="#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.$anonfun.p" title="scala.collection.Map[String,Any]">p</a>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;topic&quot;)" class="string">&quot;topic&quot;</span><span class="delimiter">)</span>.<span title="=&gt; Any">get</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="String" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span>
              val <a title="Int" id="kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.$anonfun.partition">partition</a> = <a href="#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.$anonfun.p" title="scala.collection.Map[String,Any]">p</a>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;partition&quot;)" class="string">&quot;partition&quot;</span><span class="delimiter">)</span>.<span title="=&gt; Any">get</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span>
              val <a title="Seq[Int]" id="kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.$anonfun.newReplicas">newReplicas</a> = <a href="#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.$anonfun.p" title="scala.collection.Map[String,Any]">p</a>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;replicas&quot;)" class="string">&quot;replicas&quot;</span><span class="delimiter">)</span>.<span title="=&gt; Any">get</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Seq[Int]" class="delimiter">[</span><span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span>
              <a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition" title="(topic: String, partition: Int)kafka.common.TopicAndPartition">TopicAndPartition</a><span title="(self: kafka.common.TopicAndPartition)ArrowAssoc[kafka.common.TopicAndPartition]" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.$anonfun.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.$anonfun.partition" title="Int">partition</a><span class="delimiter">)</span> <span title="(y: Seq[Int])(kafka.common.TopicAndPartition, Seq[Int])">-&gt;</span> <a href="#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup.$anonfun.newReplicas" title="Seq[Int]">newReplicas</a>
            <span class="delimiter">}</span><span class="delimiter">)</span>
          case <span title="None.type">None</span> =&gt;
            <span title="scala.collection.Seq.type">Seq</span>.<span title="Seq[Nothing]">empty</span>
        <span class="delimiter">}</span>
      case <span title="None.type">None</span> =&gt;
        <span title="scala.collection.Seq.type">Seq</span>.<span title="Seq[Nothing]">empty</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(jsonData: String)scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.utils.ZkUtils.parsePartitionReassignmentData">parsePartitionReassignmentData</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.parsePartitionReassignmentData.jsonData">jsonData</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">Map</span><span class="delimiter">[</span>TopicAndPartition, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#kafka.utils.ZkUtils.parsePartitionReassignmentDataWithoutDedup" title="(jsonData: String)Seq[(kafka.common.TopicAndPartition, Seq[Int])]">parsePartitionReassignmentDataWithoutDedup</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.parsePartitionReassignmentData.jsonData" title="String">jsonData</a><span class="delimiter">)</span>.<span title="(implicit ev: &lt;:&lt;[(kafka.common.TopicAndPartition, Seq[Int]),(kafka.common.TopicAndPartition, Seq[Int])])scala.collection.immutable.Map[kafka.common.TopicAndPartition,Seq[Int]]">toMap</span>
  <span class="delimiter">}</span>

  def <a title="(jsonData: String)Seq[String]" id="kafka.utils.ZkUtils.parseTopicsData">parseTopicsData</a><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.parseTopicsData.jsonData">jsonData</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    var <a title="List[String]" id="kafka.utils.ZkUtils.parseTopicsData.topics">topics</a> = <span title="scala.collection.immutable.List.type">List</span>.<span title="[A]=&gt; List[A]">empty</span><span title="List[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span>
    <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.parseFull" title="(input: String)Option[Any]">parseFull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.parseTopicsData.jsonData" title="String">jsonData</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.parseTopicsData.m">m</a><span class="delimiter">)</span> =&gt;
        <a href="#kafka.utils.ZkUtils.parseTopicsData.m" title="Any">m</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.Map[String,Any]" class="delimiter">[</span><span title="scala.collection.Map[String,Any]">Map</span><span class="delimiter">[</span>String, Any<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;topics&quot;)" class="string">&quot;topics&quot;</span><span class="delimiter">)</span> match <span class="delimiter">{</span>
          case Some<span class="delimiter">(</span><a title="Any" id="kafka.utils.ZkUtils.parseTopicsData.partitionsSeq">partitionsSeq</a><span class="delimiter">)</span> =&gt;
            val <a title="Seq[scala.collection.Map[String,Any]]" id="kafka.utils.ZkUtils.parseTopicsData.mapPartitionSeq">mapPartitionSeq</a> = <a href="#kafka.utils.ZkUtils.parseTopicsData.partitionsSeq" title="Any">partitionsSeq</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Seq[scala.collection.Map[String,Any]]" class="delimiter">[</span><span title="Seq[scala.collection.Map[String,Any]]">Seq</span><span class="delimiter">[</span>Map<span class="delimiter">[</span>String, Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span>
            <a href="#kafka.utils.ZkUtils.parseTopicsData.mapPartitionSeq" title="Seq[scala.collection.Map[String,Any]]">mapPartitionSeq</a>.<span title="(f: scala.collection.Map[String,Any] =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a title="scala.collection.Map[String,Any]" id="kafka.utils.ZkUtils.parseTopicsData.$anonfun.p">p</a> =&gt; <span class="delimiter">{</span>
              val <a title="String" id="kafka.utils.ZkUtils.parseTopicsData.$anonfun.topic">topic</a> = <a href="#kafka.utils.ZkUtils.parseTopicsData.$anonfun.p" title="scala.collection.Map[String,Any]">p</a>.<span title="(key: String)Option[Any]">get</span><span class="delimiter">(</span><span title="String(&quot;topic&quot;)" class="string">&quot;topic&quot;</span><span class="delimiter">)</span>.<span title="=&gt; Any">get</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="String" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span>
              <a href="#kafka.utils.ZkUtils.parseTopicsData.topics" title="List[String]">topics</a> <span title="(that: scala.collection.GenTraversableOnce[String])(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">++=</span> <span title="(xs: String*)List[String]">List</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.parseTopicsData.$anonfun.topic" title="String">topic</a><span class="delimiter">)</span>
            <span class="delimiter">}</span><span class="delimiter">)</span>
          case <span title="None.type">None</span> =&gt;
        <span class="delimiter">}</span>
      case <span title="None.type">None</span> =&gt;
    <span class="delimiter">}</span>
    <a href="#kafka.utils.ZkUtils.parseTopicsData.topics" title="List[String]">topics</a>
  <span class="delimiter">}</span>

  def <a title="(partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])String" id="kafka.utils.ZkUtils.getPartitionReassignmentZkData">getPartitionReassignmentZkData</a><span class="delimiter">(</span><a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.utils.ZkUtils.getPartitionReassignmentZkData.partitionsToBeReassigned">partitionsToBeReassigned</a>: <span title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">Map</span><span class="delimiter">[</span>TopicAndPartition, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <a href="Json.scala.html#kafka.utils.Json" title="kafka.utils.Json.type">Json</a>.<a href="Json.scala.html#kafka.utils.Json.encode" title="(obj: Any)String">encode</a><span class="delimiter">(</span><span title="(elems: (String, Any)*)scala.collection.Map[String,Any]">Map</span><span class="delimiter">(</span><span title="(self: String)ArrowAssoc[String]" class="string">&quot;version&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <span title="Int(1)" class="int">1</span>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;partitions&quot;</span> <span title="(y: Iterable[scala.collection.Map[String,Any]])(String, Iterable[scala.collection.Map[String,Any]])">-&gt;</span> <a href="#kafka.utils.ZkUtils.getPartitionReassignmentZkData.partitionsToBeReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsToBeReassigned</a>.<span title="(f: ((kafka.common.TopicAndPartition, Seq[Int])) =&gt; scala.collection.Map[String,Any])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]],scala.collection.Map[String,Any],Iterable[scala.collection.Map[String,Any]]])Iterable[scala.collection.Map[String,Any]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Iterable.Coll,scala.collection.Map[String,Any],Iterable[scala.collection.Map[String,Any]]]" class="delimiter">(</span><a title="(kafka.common.TopicAndPartition, Seq[Int])" id="kafka.utils.ZkUtils.getPartitionReassignmentZkData.$anonfun.e">e</a> =&gt; <span title="(elems: (String, Any)*)scala.collection.Map[String,Any]">Map</span><span class="delimiter">(</span><span title="(self: String)ArrowAssoc[String]" class="string">&quot;topic&quot;</span> <span title="(y: String)(String, String)">-&gt;</span> <a href="#kafka.utils.ZkUtils.getPartitionReassignmentZkData.$anonfun.e" title="(kafka.common.TopicAndPartition, Seq[Int])">e</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.topic" title="=&gt; String">topic</a>, <span title="(self: String)ArrowAssoc[String]" class="string">&quot;partition&quot;</span> <span title="(y: Int)(String, Int)">-&gt;</span> <a href="#kafka.utils.ZkUtils.getPartitionReassignmentZkData.$anonfun.e" title="(kafka.common.TopicAndPartition, Seq[Int])">e</a>.<span title="=&gt; kafka.common.TopicAndPartition">_1</span>.<a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition.partition" title="=&gt; Int">partition</a>,
                                                                                          <span title="(self: String)ArrowAssoc[String]" class="string">&quot;replicas&quot;</span> <span title="(y: Seq[Int])(String, Seq[Int])">-&gt;</span> <a href="#kafka.utils.ZkUtils.getPartitionReassignmentZkData.$anonfun.e" title="(kafka.common.TopicAndPartition, Seq[Int])">e</a>.<span title="=&gt; Seq[Int]">_2</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])Unit" id="kafka.utils.ZkUtils.updatePartitionReassignmentData">updatePartitionReassignmentData</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.updatePartitionReassignmentData.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]" id="kafka.utils.ZkUtils.updatePartitionReassignmentData.partitionsToBeReassigned">partitionsToBeReassigned</a>: <span title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">Map</span><span class="delimiter">[</span>TopicAndPartition, Seq<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="String" id="kafka.utils.ZkUtils.updatePartitionReassignmentData.zkPath">zkPath</a> = <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.ReassignPartitionsPath" title="=&gt; String">ReassignPartitionsPath</a>
    <a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.partitionsToBeReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsToBeReassigned</a>.<span title="=&gt; Int">size</span> match <span class="delimiter">{</span>
      case <span title="Int(0)" class="int">0</span> =&gt; <span class="comment">// need to delete the /admin/reassign_partitions path</span>
        <a href="#kafka.utils.ZkUtils.deletePath" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Boolean">deletePath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.zkPath" title="String">zkPath</a><span class="delimiter">)</span>
        <a href="Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;No more partitions need to be reassigned. Deleting zk path %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.zkPath" title="String">zkPath</a><span class="delimiter">)</span><span class="delimiter">)</span>
      case _ =&gt;
        val <a title="String" id="kafka.utils.ZkUtils.updatePartitionReassignmentData.jsonData">jsonData</a> = <a href="#kafka.utils.ZkUtils.getPartitionReassignmentZkData" title="(partitionsToBeReassigned: scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]])String">getPartitionReassignmentZkData</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.partitionsToBeReassigned" title="scala.collection.Map[kafka.common.TopicAndPartition,Seq[Int]]">partitionsToBeReassigned</a><span class="delimiter">)</span>
        try <span class="delimiter">{</span>
          <a href="#kafka.utils.ZkUtils.updatePersistentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit">updatePersistentPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.zkPath" title="String">zkPath</a>, <a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.jsonData" title="String">jsonData</a><span class="delimiter">)</span>
          <a href="Logging.scala.html#kafka.utils;Logging.info(1729dbc42f)" title="(msg: =&gt; String)Unit">info</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Updated partition reassignment path with %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.jsonData" title="String">jsonData</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> catch <span class="delimiter">{</span>
          case <a title="org.I0Itec.zkclient.exception.ZkNoNodeException" id="kafka.utils.ZkUtils.updatePartitionReassignmentData.nne">nne</a>: <span title="org.I0Itec.zkclient.exception.ZkNoNodeException">ZkNoNodeException</span> =&gt;
            <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.createPersistentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit">createPersistentPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.zkPath" title="String">zkPath</a>, <a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.jsonData" title="String">jsonData</a><span class="delimiter">)</span>
            <a href="Logging.scala.html#kafka.utils;Logging.debug(1729dbc42f)" title="(msg: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Created path %s with %s for partition reassignment&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.zkPath" title="String">zkPath</a>, <a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.jsonData" title="String">jsonData</a><span class="delimiter">)</span><span class="delimiter">)</span>
          case <a title="Throwable" id="kafka.utils.ZkUtils.updatePartitionReassignmentData.e2">e2</a>: <span title="Throwable">Throwable</span> =&gt; throw new <a href="../admin/AdminOperationException.scala.html#kafka.admin;AdminOperationException" title="kafka.admin.AdminOperationException">AdminOperationException</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.updatePartitionReassignmentData.e2" title="Throwable">e2</a>.<span title="()String">toString</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient)scala.collection.Set[kafka.common.TopicAndPartition]" id="kafka.utils.ZkUtils.getPartitionsUndergoingPreferredReplicaElection">getPartitionsUndergoingPreferredReplicaElection</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getPartitionsUndergoingPreferredReplicaElection.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span>: <span title="scala.collection.Set[kafka.common.TopicAndPartition]">Set</span><span class="delimiter">[</span>TopicAndPartition<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="comment">// read the partitions and their new replica list</span>
    val <a title="Option[String]" id="kafka.utils.ZkUtils.getPartitionsUndergoingPreferredReplicaElection.jsonPartitionListOpt">jsonPartitionListOpt</a> = <a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionsUndergoingPreferredReplicaElection.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.PreferredReplicaLeaderElectionPath" title="=&gt; String">PreferredReplicaLeaderElectionPath</a><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span>
    <a href="#kafka.utils.ZkUtils.getPartitionsUndergoingPreferredReplicaElection.jsonPartitionListOpt" title="Option[String]">jsonPartitionListOpt</a> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getPartitionsUndergoingPreferredReplicaElection.jsonPartitionList">jsonPartitionList</a><span class="delimiter">)</span> =&gt; <a href="../admin/PreferredReplicaLeaderElectionCommand.scala.html#kafka.admin.PreferredReplicaLeaderElectionCommand" title="kafka.admin.PreferredReplicaLeaderElectionCommand.type">PreferredReplicaLeaderElectionCommand</a>.<a href="../admin/PreferredReplicaLeaderElectionCommand.scala.html#kafka.admin.PreferredReplicaLeaderElectionCommand.parsePreferredReplicaElectionData" title="(jsonString: String)scala.collection.immutable.Set[kafka.common.TopicAndPartition]">parsePreferredReplicaElectionData</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getPartitionsUndergoingPreferredReplicaElection.jsonPartitionList" title="String">jsonPartitionList</a><span class="delimiter">)</span>
      case <span title="None.type">None</span> =&gt; <span title="scala.collection.Set.type">Set</span>.<span title="[A]=&gt; scala.collection.Set[A]">empty</span><span title="scala.collection.Set[kafka.common.TopicAndPartition]" class="delimiter">[</span><a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition" title="kafka.common.TopicAndPartition">TopicAndPartition</a><span class="delimiter">]</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, brokerId: Int, topic: String)Unit" id="kafka.utils.ZkUtils.deletePartition">deletePartition</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.deletePartition.zkClient">zkClient</a> : <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="Int" id="kafka.utils.ZkUtils.deletePartition.brokerId">brokerId</a>: <span title="Int">Int</span>, <a title="String" id="kafka.utils.ZkUtils.deletePartition.topic">topic</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val brokerIdPath = <a href="#kafka.utils.ZkUtils.BrokerIdsPath" title="=&gt; String">BrokerIdsPath</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <a title="String" id="kafka.utils.ZkUtils.deletePartition.brokerIdPath">+</a> <a href="#kafka.utils.ZkUtils.deletePartition.brokerId" title="Int">brokerId</a>
    <a href="#kafka.utils.ZkUtils.deletePartition.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>.<span title="(x$1: String)Boolean">delete</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.deletePartition.brokerIdPath" title="String">brokerIdPath</a><span class="delimiter">)</span>
    val brokerPartTopicPath = <a href="#kafka.utils.ZkUtils.BrokerTopicsPath" title="=&gt; String">BrokerTopicsPath</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.deletePartition.topic" title="String">topic</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <a title="String" id="kafka.utils.ZkUtils.deletePartition.brokerPartTopicPath">+</a> <a href="#kafka.utils.ZkUtils.deletePartition.brokerId" title="Int">brokerId</a>
    <a href="#kafka.utils.ZkUtils.deletePartition.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>.<span title="(x$1: String)Boolean">delete</span><span title="Unit" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.deletePartition.brokerPartTopicPath" title="String">brokerPartTopicPath</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, group: String)Seq[String]" id="kafka.utils.ZkUtils.getConsumersInGroup">getConsumersInGroup</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getConsumersInGroup.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.getConsumersInGroup.group">group</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="kafka.utils.ZKGroupDirs" id="kafka.utils.ZkUtils.getConsumersInGroup.dirs">dirs</a> = new <a href="#kafka.utils;ZKGroupDirs" title="kafka.utils.ZKGroupDirs">ZKGroupDirs</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumersInGroup.group" title="String">group</a><span class="delimiter">)</span>
    <a href="#kafka.utils.ZkUtils.getChildren" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Seq[String]">getChildren</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumersInGroup.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getConsumersInGroup.dirs" title="kafka.utils.ZKGroupDirs">dirs</a>.<a href="#kafka.utils;ZKGroupDirs.consumerRegistryDir" title="=&gt; String">consumerRegistryDir</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, group: String, excludeInternalTopics: Boolean)scala.collection.mutable.Map[String,List[kafka.consumer.ConsumerThreadId]]" id="kafka.utils.ZkUtils.getConsumersPerTopic">getConsumersPerTopic</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getConsumersPerTopic.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="String" id="kafka.utils.ZkUtils.getConsumersPerTopic.group">group</a>: <span title="String">String</span>, <a title="Boolean" id="kafka.utils.ZkUtils.getConsumersPerTopic.excludeInternalTopics">excludeInternalTopics</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> : mutable.<span title="scala.collection.mutable.Map[String,List[kafka.consumer.ConsumerThreadId]]">Map</span><span class="delimiter">[</span>String, List<span class="delimiter">[</span>ConsumerThreadId<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="kafka.utils.ZKGroupDirs" id="kafka.utils.ZkUtils.getConsumersPerTopic.dirs">dirs</a> = new <a href="#kafka.utils;ZKGroupDirs" title="kafka.utils.ZKGroupDirs">ZKGroupDirs</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumersPerTopic.group" title="String">group</a><span class="delimiter">)</span>
    val <a title="Seq[String]" id="kafka.utils.ZkUtils.getConsumersPerTopic.consumers">consumers</a> = <a href="#kafka.utils.ZkUtils.getChildrenParentMayNotExist" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Seq[String]">getChildrenParentMayNotExist</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumersPerTopic.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.dirs" title="kafka.utils.ZKGroupDirs">dirs</a>.<a href="#kafka.utils;ZKGroupDirs.consumerRegistryDir" title="=&gt; String">consumerRegistryDir</a><span class="delimiter">)</span>
    val <a title="scala.collection.mutable.HashMap[String,List[kafka.consumer.ConsumerThreadId]]" id="kafka.utils.ZkUtils.getConsumersPerTopic.consumersPerTopicMap">consumersPerTopicMap</a> = new mutable.<span title="scala.collection.mutable.HashMap[String,List[kafka.consumer.ConsumerThreadId]]">HashMap</span><span class="delimiter">[</span>String, List<span class="delimiter">[</span>ConsumerThreadId<span class="delimiter">]</span><span class="delimiter">]</span>
    for <span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.consumer">consumer</a> &lt;- <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.consumers" title="(f: String =&gt; Unit)Unit">consumers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="kafka.consumer.TopicCount" id="kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.topicCount">topicCount</a> = <a href="../consumer/TopicCount.scala.html#kafka.consumer.TopicCount" title="kafka.consumer.TopicCount.type">TopicCount</a>.<a href="../consumer/TopicCount.scala.html#kafka.consumer.TopicCount.constructTopicCount(14f9b37225)" title="(group: String, consumerId: String, zkClient: org.I0Itec.zkclient.ZkClient, excludeInternalTopics: Boolean)kafka.consumer.TopicCount">constructTopicCount</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumersPerTopic.group" title="String">group</a>, <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.consumer" title="String">consumer</a>, <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.excludeInternalTopics" title="Boolean">excludeInternalTopics</a><span class="delimiter">)</span>
      for <span class="delimiter">(</span><span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.topic">topic</a>, <a title="scala.collection.Set[kafka.consumer.ConsumerThreadId]" id="kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.consumerThreadIdSet">consumerThreadIdSet</a><span class="delimiter">)</span> &lt;- <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.topicCount" title="kafka.consumer.TopicCount">topicCount</a>.<a href="../consumer/TopicCount.scala.html#kafka.consumer;TopicCount.getConsumerThreadIdsPerTopic" title="(f: ((String, scala.collection.Set[kafka.consumer.ConsumerThreadId])) =&gt; Unit)Unit">getConsumerThreadIdsPerTopic</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        for <span class="delimiter">(</span><a title="kafka.consumer.ConsumerThreadId" id="kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.$anonfun.consumerThreadId">consumerThreadId</a> &lt;- <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.consumerThreadIdSet" title="(f: kafka.consumer.ConsumerThreadId =&gt; Option[List[kafka.consumer.ConsumerThreadId]])Unit">consumerThreadIdSet</a><span class="delimiter">)</span>
          <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.consumersPerTopicMap" title="scala.collection.mutable.HashMap[String,List[kafka.consumer.ConsumerThreadId]]">consumersPerTopicMap</a>.<span title="(key: String)Option[List[kafka.consumer.ConsumerThreadId]]">get</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.topic" title="String">topic</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><a title="List[kafka.consumer.ConsumerThreadId]" id="kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.$anonfun.curConsumers">curConsumers</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.consumersPerTopicMap" title="scala.collection.mutable.HashMap[String,List[kafka.consumer.ConsumerThreadId]]">consumersPerTopicMap</a>.<span title="(key: String, value: List[kafka.consumer.ConsumerThreadId])Option[List[kafka.consumer.ConsumerThreadId]]">put</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.$anonfun.consumerThreadId" title="kafka.consumer.ConsumerThreadId">consumerThreadId</a> <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.$anonfun.x$8" title="(x: kafka.consumer.ConsumerThreadId)List[kafka.consumer.ConsumerThreadId]">::</a> <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.$anonfun.curConsumers" title="List[kafka.consumer.ConsumerThreadId]">curConsumers</a><span class="delimiter">)</span>
            case _ =&gt; <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.consumersPerTopicMap" title="scala.collection.mutable.HashMap[String,List[kafka.consumer.ConsumerThreadId]]">consumersPerTopicMap</a>.<span title="(key: String, value: List[kafka.consumer.ConsumerThreadId])Option[List[kafka.consumer.ConsumerThreadId]]">put</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.topic" title="String">topic</a>, <span title="(xs: kafka.consumer.ConsumerThreadId*)List[kafka.consumer.ConsumerThreadId]">List</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.$anonfun.consumerThreadId" title="kafka.consumer.ConsumerThreadId">consumerThreadId</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    for <span class="delimiter">(</span> <span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.topic">topic</a>, <a title="List[kafka.consumer.ConsumerThreadId]" id="kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.consumerList">consumerList</a><span class="delimiter">)</span> &lt;- <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.consumersPerTopicMap" title="(f: ((String, List[kafka.consumer.ConsumerThreadId])) =&gt; Option[List[kafka.consumer.ConsumerThreadId]])Unit">consumersPerTopicMap</a> <span class="delimiter">)</span>
      <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.consumersPerTopicMap" title="scala.collection.mutable.HashMap[String,List[kafka.consumer.ConsumerThreadId]]">consumersPerTopicMap</a>.<span title="(key: String, value: List[kafka.consumer.ConsumerThreadId])Option[List[kafka.consumer.ConsumerThreadId]]">put</span><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.consumerList" title="List[kafka.consumer.ConsumerThreadId]">consumerList</a>.<span title="(lt: (kafka.consumer.ConsumerThreadId, kafka.consumer.ConsumerThreadId) =&gt; Boolean)List[kafka.consumer.ConsumerThreadId]">sortWith</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="kafka.consumer.ConsumerThreadId" id="kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.s">s</a>,<a title="kafka.consumer.ConsumerThreadId" id="kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.t">t</a><span class="delimiter">)</span> =&gt; <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.s" title="kafka.consumer.ConsumerThreadId">s</a> <span title="(that: kafka.consumer.ConsumerThreadId)Boolean">&lt;</span> <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.$anonfun.$anonfun.t" title="kafka.consumer.ConsumerThreadId">t</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#kafka.utils.ZkUtils.getConsumersPerTopic.consumersPerTopicMap" title="scala.collection.mutable.HashMap[String,List[kafka.consumer.ConsumerThreadId]]">consumersPerTopicMap</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * This API takes in a broker id, queries zookeeper for the broker metadata and returns the metadata for that broker
   * or throws an exception if the broker dies before the query to zookeeper finishes
   * @param brokerId The broker id
   * @param zkClient The zookeeper client connection
   * @return An optional Broker object encapsulating the broker metadata
   */</span>
  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, brokerId: Int)Option[kafka.cluster.Broker]" id="kafka.utils.ZkUtils.getBrokerInfo">getBrokerInfo</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getBrokerInfo.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="Int" id="kafka.utils.ZkUtils.getBrokerInfo.brokerId">brokerId</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Option[kafka.cluster.Broker]">Option</span><span class="delimiter">[</span>Broker<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.readDataMaybeNull" title="(client: org.I0Itec.zkclient.ZkClient, path: String)(Option[String], org.apache.zookeeper.data.Stat)">readDataMaybeNull</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getBrokerInfo.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.BrokerIdsPath" title="=&gt; String">BrokerIdsPath</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils.ZkUtils.getBrokerInfo.brokerId" title="Int">brokerId</a><span class="delimiter">)</span>.<span title="=&gt; Option[String]">_1</span> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="String" id="kafka.utils.ZkUtils.getBrokerInfo.brokerInfo">brokerInfo</a><span class="delimiter">)</span> =&gt; <span title="(x: kafka.cluster.Broker)Some[kafka.cluster.Broker]">Some</span><span class="delimiter">(</span><a href="../cluster/Broker.scala.html#kafka.cluster.Broker" title="kafka.cluster.Broker.type">Broker</a>.<a href="../cluster/Broker.scala.html#kafka.cluster.Broker.createBroker" title="(id: Int, brokerInfoString: String)kafka.cluster.Broker">createBroker</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getBrokerInfo.brokerId" title="Int">brokerId</a>, <a href="#kafka.utils.ZkUtils.getBrokerInfo.brokerInfo" title="String">brokerInfo</a><span class="delimiter">)</span><span class="delimiter">)</span>
      case <span title="None.type">None</span> =&gt; <span title="None.type">None</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient)Seq[String]" id="kafka.utils.ZkUtils.getAllTopics">getAllTopics</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getAllTopics.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="Seq[String]" id="kafka.utils.ZkUtils.getAllTopics.topics">topics</a> = <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.getChildrenParentMayNotExist" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Seq[String]">getChildrenParentMayNotExist</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllTopics.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.BrokerTopicsPath" title="=&gt; String">BrokerTopicsPath</a><span class="delimiter">)</span>
    if<span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllTopics.topics" title="Seq[String]">topics</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span>
      <span title="scala.collection.Seq.type">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span>
    else
      <a href="#kafka.utils.ZkUtils.getAllTopics.topics" title="Seq[String]">topics</a>
  <span class="delimiter">}</span>

  def <a title="(zkClient: org.I0Itec.zkclient.ZkClient)scala.collection.Set[kafka.common.TopicAndPartition]" id="kafka.utils.ZkUtils.getAllPartitions">getAllPartitions</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.utils.ZkUtils.getAllPartitions.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">)</span>: <span title="scala.collection.Set[kafka.common.TopicAndPartition]">Set</span><span class="delimiter">[</span>TopicAndPartition<span class="delimiter">]</span> = <span class="delimiter">{</span>
    val <a title="Seq[String]" id="kafka.utils.ZkUtils.getAllPartitions.topics">topics</a> = <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.getChildrenParentMayNotExist" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Seq[String]">getChildrenParentMayNotExist</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllPartitions.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.BrokerTopicsPath" title="=&gt; String">BrokerTopicsPath</a><span class="delimiter">)</span>
    if<span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllPartitions.topics" title="Seq[String]">topics</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span> <span title="scala.collection.Set.type">Set</span>.<span title="[A]=&gt; scala.collection.Set[A]">empty</span><span title="scala.collection.Set[kafka.common.TopicAndPartition]" class="delimiter">[</span><a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition" title="kafka.common.TopicAndPartition">TopicAndPartition</a><span class="delimiter">]</span>
    else <span class="delimiter">{</span>
      <a href="#kafka.utils.ZkUtils.getAllPartitions.topics" title="Seq[String]">topics</a>.<span title="(f: String =&gt; Seq[kafka.common.TopicAndPartition])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],Seq[kafka.common.TopicAndPartition],Seq[Seq[kafka.common.TopicAndPartition]]])Seq[Seq[kafka.common.TopicAndPartition]]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Seq[kafka.common.TopicAndPartition],Seq[Seq[kafka.common.TopicAndPartition]]]" class="delimiter">{</span> <a title="String" id="kafka.utils.ZkUtils.getAllPartitions.$anonfun.topic">topic</a> =&gt;
        <a href="#kafka.utils.ZkUtils.getChildren" title="(client: org.I0Itec.zkclient.ZkClient, path: String)Seq[String]">getChildren</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllPartitions.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.utils.ZkUtils.getTopicPartitionsPath" title="(topic: String)String">getTopicPartitionsPath</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllPartitions.$anonfun.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],Int,Seq[Int]])Seq[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Int,Seq[Int]]" class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllPartitions.$anonfun.$anonfun.x$11" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>.<span title="(f: Int =&gt; kafka.common.TopicAndPartition)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[Int],kafka.common.TopicAndPartition,Seq[kafka.common.TopicAndPartition]])Seq[kafka.common.TopicAndPartition]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,kafka.common.TopicAndPartition,Seq[kafka.common.TopicAndPartition]]" class="delimiter">(</span><a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition" title="(topic: String, partition: Int)kafka.common.TopicAndPartition">TopicAndPartition</a><span class="delimiter">(</span><a href="#kafka.utils.ZkUtils.getAllPartitions.$anonfun.topic" title="String">topic</a>, <a href="#kafka.utils.ZkUtils.getAllPartitions.$anonfun.$anonfun.x$12" title="Int">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>.<span title="(implicit asTraversable: Seq[kafka.common.TopicAndPartition] =&gt; scala.collection.GenTraversableOnce[kafka.common.TopicAndPartition])Seq[kafka.common.TopicAndPartition]">flatten</span>.<span title="scala.collection.immutable.Set[kafka.common.TopicAndPartition]">toSet</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

object <a title="kafka.utils.ZKStringSerializer.type" id="kafka.utils.ZKStringSerializer">ZKStringSerializer</a> extends <span title="org.I0Itec.zkclient.serialize.ZkSerializer">ZkSerializer</span> <span class="delimiter">{</span>

  @throws<span class="delimiter">(</span>classOf<span class="delimiter">[</span>ZkMarshallingError<span class="delimiter">]</span><span class="delimiter">)</span>
  def <a title="(data: Object)Array[Byte]" id="kafka.utils.ZKStringSerializer.serialize">serialize</a><span class="delimiter">(</span><a title="Object" id="kafka.utils.ZKStringSerializer.serialize.data">data</a> : <span title="Object">Object</span><span class="delimiter">)</span> : <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span> = <a href="#kafka.utils.ZKStringSerializer.serialize.data" title="Object">data</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="String" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span>.<span title="(x$1: String)Array[Byte]">getBytes</span><span class="delimiter">(</span><span title="String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span>

  @throws<span class="delimiter">(</span>classOf<span class="delimiter">[</span>ZkMarshallingError<span class="delimiter">]</span><span class="delimiter">)</span>
  def <a title="(bytes: Array[Byte])Object" id="kafka.utils.ZKStringSerializer.deserialize">deserialize</a><span class="delimiter">(</span><a title="Array[Byte]" id="kafka.utils.ZKStringSerializer.deserialize.bytes">bytes</a> : <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span> : <span title="Object">Object</span> = <span class="delimiter">{</span>
    if <span class="delimiter">(</span><a href="#kafka.utils.ZKStringSerializer.deserialize.bytes" title="Array[Byte]">bytes</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span>
      null
    else
      new <span title="String">String</span><span class="delimiter">(</span><a href="#kafka.utils.ZKStringSerializer.deserialize.bytes" title="Array[Byte]">bytes</a>, <span title="String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

class <a title="class ZKGroupDirs extends AnyRef" id="kafka.utils;ZKGroupDirs">ZKGroupDirs</a><a href="#kafka.utils;ZKGroupDirs" title="kafka.utils.ZKGroupDirs" class="delimiter">(</a>val <a title="String" id="kafka.utils;ZKGroupDirs.group">group</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  def <a title="=&gt; String" id="kafka.utils;ZKGroupDirs.consumerDir">consumerDir</a> = <a href="#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="#kafka.utils.ZkUtils.ConsumersPath" title="=&gt; String">ConsumersPath</a>
  def <a title="=&gt; String" id="kafka.utils;ZKGroupDirs.consumerGroupDir">consumerGroupDir</a> = <a href="#kafka.utils;ZKGroupDirs.consumerDir" title="=&gt; String">consumerDir</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils;ZKGroupDirs.group" title="=&gt; String">group</a>
  def <a title="=&gt; String" id="kafka.utils;ZKGroupDirs.consumerRegistryDir">consumerRegistryDir</a> = <a href="#kafka.utils;ZKGroupDirs.consumerGroupDir" title="=&gt; String">consumerGroupDir</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/ids&quot;)" class="string">&quot;/ids&quot;</span>
<span class="delimiter">}</span>

class <a title="class ZKGroupTopicDirs extends kafka.utils.ZKGroupDirs" id="kafka.utils;ZKGroupTopicDirs">ZKGroupTopicDirs</a><a href="#kafka.utils;ZKGroupTopicDirs" title="kafka.utils.ZKGroupTopicDirs" class="delimiter">(</a><a title="String" id="kafka.utils;ZKGroupTopicDirs.group">group</a>: <span title="String">String</span>, <a title="String" id="kafka.utils;ZKGroupTopicDirs.topic">topic</a>: <span title="String">String</span><span class="delimiter">)</span> extends <a href="#kafka.utils;ZKGroupDirs" title="kafka.utils.ZKGroupDirs">ZKGroupDirs</a><span class="delimiter">(</span><a href="#kafka.utils;ZKGroupTopicDirs.group" title="String">group</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  def <a title="=&gt; String" id="kafka.utils;ZKGroupTopicDirs.consumerOffsetDir">consumerOffsetDir</a> = <a href="#kafka.utils;ZKGroupDirs.consumerGroupDir" title="=&gt; String">consumerGroupDir</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/offsets/&quot;)" class="string">&quot;/offsets/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils;ZKGroupTopicDirs.topic" title="String">topic</a>
  def <a title="=&gt; String" id="kafka.utils;ZKGroupTopicDirs.consumerOwnerDir">consumerOwnerDir</a> = <a href="#kafka.utils;ZKGroupDirs.consumerGroupDir" title="=&gt; String">consumerGroupDir</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/owners/&quot;)" class="string">&quot;/owners/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.utils;ZKGroupTopicDirs.topic" title="String">topic</a>
<span class="delimiter">}</span>


class <a title="class ZKConfig extends AnyRef" id="kafka.utils;ZKConfig">ZKConfig</a><a href="#kafka.utils;ZKConfig" title="kafka.utils.ZKConfig" class="delimiter">(</a><a title="kafka.utils.VerifiableProperties" id="kafka.utils;ZKConfig.props">props</a>: <a href="VerifiableProperties.scala.html#kafka.utils;VerifiableProperties" title="kafka.utils.VerifiableProperties">VerifiableProperties</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="comment">/** ZK host string */</span>
  val <a title="String" id="kafka.utils;ZKConfig.zkConnect">zkConnect</a> = <a href="#kafka.utils;ZKConfig.props" title="kafka.utils.VerifiableProperties">props</a>.<a href="VerifiableProperties.scala.html#kafka.utils;VerifiableProperties.getString(72fa2474e9)" title="(name: String)String">getString</a><span class="delimiter">(</span><span title="String(&quot;zookeeper.connect&quot;)" class="string">&quot;zookeeper.connect&quot;</span><span class="delimiter">)</span>

  <span class="comment">/** zookeeper session timeout */</span>
  val <a title="Int" id="kafka.utils;ZKConfig.zkSessionTimeoutMs">zkSessionTimeoutMs</a> = <a href="#kafka.utils;ZKConfig.props" title="kafka.utils.VerifiableProperties">props</a>.<a href="VerifiableProperties.scala.html#kafka.utils;VerifiableProperties.getInt(6a97fd7c23)" title="(name: String, default: Int)Int">getInt</a><span class="delimiter">(</span><span title="String(&quot;zookeeper.session.timeout.ms&quot;)" class="string">&quot;zookeeper.session.timeout.ms&quot;</span>, <span title="Int(6000)" class="int">6000</span><span class="delimiter">)</span>

  <span class="comment">/** the max time that the client waits to establish a connection to zookeeper */</span>
  val <a title="Int" id="kafka.utils;ZKConfig.zkConnectionTimeoutMs">zkConnectionTimeoutMs</a> = <a href="#kafka.utils;ZKConfig.props" title="kafka.utils.VerifiableProperties">props</a>.<a href="VerifiableProperties.scala.html#kafka.utils;VerifiableProperties.getInt(6a97fd7c23)" title="(name: String, default: Int)Int">getInt</a><span class="delimiter">(</span><span title="String(&quot;zookeeper.connection.timeout.ms&quot;)" class="string">&quot;zookeeper.connection.timeout.ms&quot;</span>,<a href="#kafka.utils;ZKConfig.zkSessionTimeoutMs" title="=&gt; Int">zkSessionTimeoutMs</a><span class="delimiter">)</span>

  <span class="comment">/** how far a ZK follower can be behind a ZK leader */</span>
  val <a title="Int" id="kafka.utils;ZKConfig.zkSyncTimeMs">zkSyncTimeMs</a> = <a href="#kafka.utils;ZKConfig.props" title="kafka.utils.VerifiableProperties">props</a>.<a href="VerifiableProperties.scala.html#kafka.utils;VerifiableProperties.getInt(6a97fd7c23)" title="(name: String, default: Int)Int">getInt</a><span class="delimiter">(</span><span title="String(&quot;zookeeper.sync.time.ms&quot;)" class="string">&quot;zookeeper.sync.time.ms&quot;</span>, <span title="Int(2000)" class="int">2000</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

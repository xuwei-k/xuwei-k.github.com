<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>kafka/kafka/tools/ConsoleConsumer.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

package kafka.tools

import scala.collection.<span title="scala.collection.JavaConversions.type">JavaConversions</span>._
import org.I0Itec.zkclient._
import joptsimple._
import java.util.Properties
import java.util.Random
import java.io.PrintStream
import kafka.message._
import kafka.serializer._
import kafka.utils._
import kafka.metrics.KafkaMetricsReporter
import kafka.consumer.<span class="delimiter">{</span>Blacklist,Whitelist,ConsumerConfig,Consumer<span class="delimiter">}</span>

<span class="comment">/**
 * Consumer that dumps messages out to standard out.
 *
 */</span>
object <a title="kafka.tools.ConsoleConsumer.type" id="kafka.tools.ConsoleConsumer">ConsoleConsumer</a> extends <a href="../utils/Logging.scala.html#kafka.utils;Logging" title="kafka.utils.Logging">Logging</a> <span class="delimiter">{</span>

  def <a title="(args: Array[String])Unit" id="kafka.tools.ConsoleConsumer.main">main</a><span class="delimiter">(</span><a title="Array[String]" id="kafka.tools.ConsoleConsumer.main.args">args</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="joptsimple.OptionParser" id="kafka.tools.ConsoleConsumer.main.parser">parser</a> = new <span title="joptsimple.OptionParser">OptionParser</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.ConsoleConsumer.main.topicIdOpt">topicIdOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;topic&quot;)" class="string">&quot;topic&quot;</span>, <span title="String(&quot;The topic id to consume on.&quot;)" class="string">&quot;The topic id to consume on.&quot;</span><span class="delimiter">)</span>
            .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
            .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;topic&quot;)" class="string">&quot;topic&quot;</span><span class="delimiter">)</span>
            .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.ConsoleConsumer.main.whitelistOpt">whitelistOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;whitelist&quot;)" class="string">&quot;whitelist&quot;</span>, <span title="String(&quot;Whitelist of topics to include for consumption.&quot;)" class="string">&quot;Whitelist of topics to include for consumption.&quot;</span><span class="delimiter">)</span>
            .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
            .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;whitelist&quot;)" class="string">&quot;whitelist&quot;</span><span class="delimiter">)</span>
            .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.ConsoleConsumer.main.blacklistOpt">blacklistOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;blacklist&quot;)" class="string">&quot;blacklist&quot;</span>, <span title="String(&quot;Blacklist of topics to exclude from consumption.&quot;)" class="string">&quot;Blacklist of topics to exclude from consumption.&quot;</span><span class="delimiter">)</span>
            .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
            .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;blacklist&quot;)" class="string">&quot;blacklist&quot;</span><span class="delimiter">)</span>
            .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.ConsoleConsumer.main.zkConnectOpt">zkConnectOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;zookeeper&quot;)" class="string">&quot;zookeeper&quot;</span>, <span class="string">&quot;REQUIRED: The connection string for the zookeeper connection in the form host:port. &quot;</span> <span title="String(&quot;REQUIRED: The connection string for the zookeeper connection in the form host:port. Multiple URLS can be given to allow fail-over.&quot;)">+</span>
            <span class="string">&quot;Multiple URLS can be given to allow fail-over.&quot;</span><span class="delimiter">)</span>
            .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
            .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;urls&quot;)" class="string">&quot;urls&quot;</span><span class="delimiter">)</span>
            .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>

    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.ConsoleConsumer.main.consumerConfigOpt">consumerConfigOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;consumer.config&quot;)" class="string">&quot;consumer.config&quot;</span>, <span title="String(&quot;Consumer config properties file.&quot;)" class="string">&quot;Consumer config properties file.&quot;</span><span class="delimiter">)</span>
            .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
            .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;config file&quot;)" class="string">&quot;config file&quot;</span><span class="delimiter">)</span>
            .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.ConsoleConsumer.main.messageFormatterOpt">messageFormatterOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;formatter&quot;)" class="string">&quot;formatter&quot;</span>, <span title="String(&quot;The name of a class to use for formatting kafka messages for display.&quot;)" class="string">&quot;The name of a class to use for formatting kafka messages for display.&quot;</span><span class="delimiter">)</span>
            .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
            .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;class&quot;)" class="string">&quot;class&quot;</span><span class="delimiter">)</span>
            .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
            .<span title="(x$1: String, x$2: String*)joptsimple.ArgumentAcceptingOptionSpec[String]">defaultsTo</span><span class="delimiter">(</span>classOf<span title="Class[kafka.tools.DefaultMessageFormatter](classOf[kafka.tools.DefaultMessageFormatter])" class="delimiter">[</span>DefaultMessageFormatter<span class="delimiter">]</span>.<span title="()String">getName</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.ConsoleConsumer.main.messageFormatterArgOpt">messageFormatterArgOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;property&quot;)" class="string">&quot;property&quot;</span><span class="delimiter">)</span>
            .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
            .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;prop&quot;)" class="string">&quot;prop&quot;</span><span class="delimiter">)</span>
            .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.OptionSpecBuilder" id="kafka.tools.ConsoleConsumer.main.deleteConsumerOffsetsOpt">deleteConsumerOffsetsOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;delete-consumer-offsets&quot;)" class="string">&quot;delete-consumer-offsets&quot;</span>, <span title="String(&quot;If specified, the consumer path in zookeeper is deleted when starting up&quot;)" class="string">&quot;If specified, the consumer path in zookeeper is deleted when starting up&quot;</span><span class="delimiter">)</span>;
    val <a title="joptsimple.OptionSpecBuilder" id="kafka.tools.ConsoleConsumer.main.resetBeginningOpt">resetBeginningOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;from-beginning&quot;)" class="string">&quot;from-beginning&quot;</span>, <span class="string">&quot;If the consumer does not already have an established offset to consume from, &quot;</span> <span title="String(&quot;If the consumer does not already have an established offset to consume from, start with the earliest message present in the log rather than the latest message.&quot;)">+</span>
            <span class="string">&quot;start with the earliest message present in the log rather than the latest message.&quot;</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[Integer]" id="kafka.tools.ConsoleConsumer.main.maxMessagesOpt">maxMessagesOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;max-messages&quot;)" class="string">&quot;max-messages&quot;</span>, <span title="String(&quot;The maximum number of messages to consume before exiting. If not set, consumption is continual.&quot;)" class="string">&quot;The maximum number of messages to consume before exiting. If not set, consumption is continual.&quot;</span><span class="delimiter">)</span>
            .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
            .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;num_messages&quot;)" class="string">&quot;num_messages&quot;</span><span class="delimiter">)</span>
            .<span title="(x$1: Class[Integer])joptsimple.ArgumentAcceptingOptionSpec[Integer]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[Integer](classOf[java.lang.Integer])" class="delimiter">[</span>java.lang.Integer<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.OptionSpecBuilder" id="kafka.tools.ConsoleConsumer.main.skipMessageOnErrorOpt">skipMessageOnErrorOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;skip-message-on-error&quot;)" class="string">&quot;skip-message-on-error&quot;</span>, <span class="string">&quot;If there is an error when processing a message, &quot;</span> <span title="String(&quot;If there is an error when processing a message, skip it instead of halt.&quot;)">+</span>
            <span class="string">&quot;skip it instead of halt.&quot;</span><span class="delimiter">)</span>
    val <a title="joptsimple.OptionSpecBuilder" id="kafka.tools.ConsoleConsumer.main.csvMetricsReporterEnabledOpt">csvMetricsReporterEnabledOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;csv-reporter-enabled&quot;)" class="string">&quot;csv-reporter-enabled&quot;</span>, <span title="String(&quot;If set, the CSV metrics reporter will be enabled&quot;)" class="string">&quot;If set, the CSV metrics reporter will be enabled&quot;</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.ConsoleConsumer.main.metricsDirectoryOpt">metricsDirectoryOpt</a> = <a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;metrics-dir&quot;)" class="string">&quot;metrics-dir&quot;</span>, <span class="string">&quot;If csv-reporter-enable is set, and this parameter is&quot;</span> <span title="String(&quot;If csv-reporter-enable is set, and this parameter isset, the csv metrics will be outputed here&quot;)">+</span>
            <span class="string">&quot;set, the csv metrics will be outputed here&quot;</span><span class="delimiter">)</span>
      .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
      .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;metrics dictory&quot;)" class="string">&quot;metrics dictory&quot;</span><span class="delimiter">)</span>
      .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>java.lang.String<span class="delimiter">]</span><span class="delimiter">)</span>

    if<span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.args" title="Array[String]">args</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.printUsageAndDie" title="(parser: joptsimple.OptionParser, message: String)Unit">printUsageAndDie</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>, <span title="String(&quot;The console consumer is a tool that reads data from Kafka and outputs it to standard output.&quot;)" class="string">&quot;The console consumer is a tool that reads data from Kafka and outputs it to standard output.&quot;</span><span class="delimiter">)</span>
      
    var <a title="Boolean" id="kafka.tools.ConsoleConsumer.main.groupIdPassed">groupIdPassed</a> = true
    val <a title="joptsimple.OptionSet" id="kafka.tools.ConsoleConsumer.main.options">options</a>: <span title="joptsimple.OptionSet">OptionSet</span> = <a href="#kafka.tools.ConsoleConsumer.tryParse" title="(parser: joptsimple.OptionParser, args: Array[String])joptsimple.OptionSet">tryParse</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>, <a href="#kafka.tools.ConsoleConsumer.main.args" title="Array[String]">args</a><span class="delimiter">)</span>
    <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.checkRequiredArgs" title="(parser: joptsimple.OptionParser, options: joptsimple.OptionSet, required: joptsimple.OptionSpec[_]*)Unit">checkRequiredArgs</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>, <a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>, <a href="#kafka.tools.ConsoleConsumer.main.zkConnectOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">zkConnectOpt</a><span class="delimiter">)</span>
    val <a title="List[joptsimple.ArgumentAcceptingOptionSpec[String]]" id="kafka.tools.ConsoleConsumer.main.topicOrFilterOpt">topicOrFilterOpt</a> = <span title="(xs: joptsimple.ArgumentAcceptingOptionSpec[String]*)List[joptsimple.ArgumentAcceptingOptionSpec[String]]">List</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.topicIdOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">topicIdOpt</a>, <a href="#kafka.tools.ConsoleConsumer.main.whitelistOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">whitelistOpt</a>, <a href="#kafka.tools.ConsoleConsumer.main.blacklistOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">blacklistOpt</a><span class="delimiter">)</span>.<span title="(p: joptsimple.ArgumentAcceptingOptionSpec[String] =&gt; Boolean)List[joptsimple.ArgumentAcceptingOptionSpec[String]]">filter</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<a href="#kafka.tools.ConsoleConsumer.main.topicOrFilterOpt.$anonfun.x$1" title="(x$1: joptsimple.OptionSpec[_])Boolean">has</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.topicOrFilterOpt" title="List[joptsimple.ArgumentAcceptingOptionSpec[String]]">topicOrFilterOpt</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.printUsageAndDie" title="(parser: joptsimple.OptionParser, message: String)Unit">printUsageAndDie</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.parser" title="joptsimple.OptionParser">parser</a>, <span title="String(&quot;Exactly one of whitelist/blacklist/topic is required.&quot;)" class="string">&quot;Exactly one of whitelist/blacklist/topic is required.&quot;</span><span class="delimiter">)</span>
    val <a title="String" id="kafka.tools.ConsoleConsumer.main.topicArg">topicArg</a> = <a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.topicOrFilterOpt" title="List[joptsimple.ArgumentAcceptingOptionSpec[String]]">topicOrFilterOpt</a>.<span title="=&gt; joptsimple.ArgumentAcceptingOptionSpec[String]">head</span><span class="delimiter">)</span>
    val <a title="&lt;refinement of kafka.consumer.TopicFilter with Product&gt; extends kafka.consumer.TopicFilter with Product with Serializable" id="kafka.tools.ConsoleConsumer.main.filterSpec">filterSpec</a> = if <span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.blacklistOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">blacklistOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
      new <a href="../consumer/TopicFilter.scala.html#kafka.consumer;Blacklist" title="kafka.consumer.Blacklist">Blacklist</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.topicArg" title="String">topicArg</a><span class="delimiter">)</span>
    else
      new <a href="../consumer/TopicFilter.scala.html#kafka.consumer;Whitelist" title="kafka.consumer.Whitelist">Whitelist</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.topicArg" title="String">topicArg</a><span class="delimiter">)</span>

    val <a title="Boolean" id="kafka.tools.ConsoleConsumer.main.csvMetricsReporterEnabled">csvMetricsReporterEnabled</a> = <a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.csvMetricsReporterEnabledOpt" title="joptsimple.OptionSpecBuilder">csvMetricsReporterEnabledOpt</a><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.csvMetricsReporterEnabled" title="Boolean">csvMetricsReporterEnabled</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="java.util.Properties" id="kafka.tools.ConsoleConsumer.main.csvReporterProps">csvReporterProps</a> = new <span title="java.util.Properties">Properties</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#kafka.tools.ConsoleConsumer.main.csvReporterProps" title="java.util.Properties">csvReporterProps</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;kafka.metrics.polling.interval.secs&quot;)" class="string">&quot;kafka.metrics.polling.interval.secs&quot;</span>, <span title="String(&quot;5&quot;)" class="string">&quot;5&quot;</span><span class="delimiter">)</span>
      <a href="#kafka.tools.ConsoleConsumer.main.csvReporterProps" title="java.util.Properties">csvReporterProps</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;kafka.metrics.reporters&quot;)" class="string">&quot;kafka.metrics.reporters&quot;</span>, <span title="String(&quot;kafka.metrics.KafkaCSVMetricsReporter&quot;)" class="string">&quot;kafka.metrics.KafkaCSVMetricsReporter&quot;</span><span class="delimiter">)</span>
      if <span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.metricsDirectoryOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">metricsDirectoryOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#kafka.tools.ConsoleConsumer.main.csvReporterProps" title="java.util.Properties">csvReporterProps</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;kafka.csv.metrics.dir&quot;)" class="string">&quot;kafka.csv.metrics.dir&quot;</span>, <a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.metricsDirectoryOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">metricsDirectoryOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
      else
        <a href="#kafka.tools.ConsoleConsumer.main.csvReporterProps" title="java.util.Properties">csvReporterProps</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;kafka.csv.metrics.dir&quot;)" class="string">&quot;kafka.csv.metrics.dir&quot;</span>, <span title="String(&quot;kafka_metrics&quot;)" class="string">&quot;kafka_metrics&quot;</span><span class="delimiter">)</span>
      <a href="#kafka.tools.ConsoleConsumer.main.csvReporterProps" title="java.util.Properties">csvReporterProps</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;kafka.csv.metrics.reporter.enabled&quot;)" class="string">&quot;kafka.csv.metrics.reporter.enabled&quot;</span>, <span title="String(&quot;true&quot;)" class="string">&quot;true&quot;</span><span class="delimiter">)</span>
      val <a title="kafka.utils.VerifiableProperties" id="kafka.tools.ConsoleConsumer.main.verifiableProps">verifiableProps</a> = new <a href="../utils/VerifiableProperties.scala.html#kafka.utils;VerifiableProperties" title="kafka.utils.VerifiableProperties">VerifiableProperties</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.csvReporterProps" title="java.util.Properties">csvReporterProps</a><span class="delimiter">)</span>
      <a href="../metrics/KafkaMetricsReporter.scala.html#kafka.metrics.KafkaMetricsReporter" title="kafka.metrics.KafkaMetricsReporter.type">KafkaMetricsReporter</a>.<a href="../metrics/KafkaMetricsReporter.scala.html#kafka.metrics.KafkaMetricsReporter.startReporters" title="(verifiableProps: kafka.utils.VerifiableProperties)Unit">startReporters</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.verifiableProps" title="kafka.utils.VerifiableProperties">verifiableProps</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>



    val <a title="java.util.Properties" id="kafka.tools.ConsoleConsumer.main.consumerProps">consumerProps</a> = if <span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.consumerConfigOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">consumerConfigOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.loadProps" title="(filename: String)java.util.Properties">loadProps</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.consumerConfigOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">consumerConfigOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
    else
      new <span title="java.util.Properties">Properties</span><span class="delimiter">(</span><span class="delimiter">)</span>

    if<span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.tools.ConsoleConsumer.main.consumerProps" title="java.util.Properties">consumerProps</a>.<span title="(x$1: Any)Boolean">containsKey</span><span class="delimiter">(</span><span title="String(&quot;group.id&quot;)" class="string">&quot;group.id&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#kafka.tools.ConsoleConsumer.main.consumerProps" title="java.util.Properties">consumerProps</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;group.id&quot;)" class="string">&quot;group.id&quot;</span>,<span title="String(&quot;console-consumer-&quot;)" class="string">&quot;console-consumer-&quot;</span> <span title="(x$1: Any)String">+</span> new <span title="java.util.Random">Random</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(100000)" class="int">100000</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#kafka.tools.ConsoleConsumer.main.groupIdPassed" title="Boolean">groupIdPassed</a>=false
    <span class="delimiter">}</span>
    <a href="#kafka.tools.ConsoleConsumer.main.consumerProps" title="java.util.Properties">consumerProps</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;auto.offset.reset&quot;)" class="string">&quot;auto.offset.reset&quot;</span>, if<span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.resetBeginningOpt" title="joptsimple.OptionSpecBuilder">resetBeginningOpt</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="String(&quot;smallest&quot;)" class="string">&quot;smallest&quot;</span> else <span title="String(&quot;largest&quot;)" class="string">&quot;largest&quot;</span><span class="delimiter">)</span>
    <a href="#kafka.tools.ConsoleConsumer.main.consumerProps" title="java.util.Properties">consumerProps</a>.<span title="(x$1: Object, x$2: Object)Object">put</span><span class="delimiter">(</span><span title="String(&quot;zookeeper.connect&quot;)" class="string">&quot;zookeeper.connect&quot;</span>, <a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.zkConnectOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">zkConnectOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>

    if <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.deleteConsumerOffsetsOpt" title="joptsimple.OptionSpecBuilder">deleteConsumerOffsetsOpt</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.resetBeginningOpt" title="joptsimple.OptionSpecBuilder">resetBeginningOpt</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span>
       <a href="#kafka.tools.ConsoleConsumer.checkZkPathExists" title="(zkUrl: String, path: String)Boolean">checkZkPathExists</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.zkConnectOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">zkConnectOpt</a><span class="delimiter">)</span>,<span title="String(&quot;/consumers/&quot;)" class="string">&quot;/consumers/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools.ConsoleConsumer.main.consumerProps" title="java.util.Properties">consumerProps</a>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;group.id&quot;)" class="string">&quot;group.id&quot;</span><span class="delimiter">)</span><span title="(x$1: Any)String">+</span> <span title="String(&quot;/offsets&quot;)" class="string">&quot;/offsets&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;Found previous offset information for this group &quot;)" class="string">&quot;Found previous offset information for this group &quot;</span><span title="(x$1: Any)String">+</span><a href="#kafka.tools.ConsoleConsumer.main.consumerProps" title="java.util.Properties">consumerProps</a>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;group.id&quot;)" class="string">&quot;group.id&quot;</span><span class="delimiter">)</span>
        <span title="(x$1: Any)String">+</span><span title="String(&quot;. Please use --delete-consumer-offsets to delete previous offsets metadata&quot;)" class="string">&quot;. Please use --delete-consumer-offsets to delete previous offsets metadata&quot;</span><span class="delimiter">)</span>
      <span title="System.type">System</span>.<span title="(x$1: Int)Unit">exit</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    if<span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.deleteConsumerOffsetsOpt" title="joptsimple.OptionSpecBuilder">deleteConsumerOffsetsOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.maybeDeletePath" title="(zkUrl: String, dir: String)Unit">maybeDeletePath</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.zkConnectOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">zkConnectOpt</a><span class="delimiter">)</span>, <span title="String(&quot;/consumers/&quot;)" class="string">&quot;/consumers/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools.ConsoleConsumer.main.consumerProps" title="java.util.Properties">consumerProps</a>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;group.id&quot;)" class="string">&quot;group.id&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

    val <a title="kafka.consumer.ConsumerConfig" id="kafka.tools.ConsoleConsumer.main.config">config</a> = new <a href="../consumer/ConsumerConfig.scala.html#kafka.consumer;ConsumerConfig" title="kafka.consumer.ConsumerConfig">ConsumerConfig</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.consumerProps" title="java.util.Properties">consumerProps</a><span class="delimiter">)</span>
    val <a title="Boolean" id="kafka.tools.ConsoleConsumer.main.skipMessageOnError">skipMessageOnError</a> = if <span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.skipMessageOnErrorOpt" title="joptsimple.OptionSpecBuilder">skipMessageOnErrorOpt</a><span class="delimiter">)</span><span class="delimiter">)</span> true else false
    val <a title="Class[_]" id="kafka.tools.ConsoleConsumer.main.messageFormatterClass">messageFormatterClass</a> = <span title="Class.type">Class</span>.<span title="(x$1: String)Class[_]">forName</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.messageFormatterOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">messageFormatterOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
    val <a title="java.util.Properties" id="kafka.tools.ConsoleConsumer.main.formatterArgs">formatterArgs</a> = <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.parseKeyValueArgs" title="(args: Iterable[String])java.util.Properties">parseKeyValueArgs</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])java.util.List[String]">valuesOf</span><span title="(l: java.util.List[String])scala.collection.mutable.Buffer[String]" class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.messageFormatterArgOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">messageFormatterArgOpt</a><span class="delimiter">)</span><span class="delimiter">)</span>
    val <a title="Int" id="kafka.tools.ConsoleConsumer.main.maxMessages">maxMessages</a> = if<span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[_])Boolean">has</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.maxMessagesOpt" title="joptsimple.ArgumentAcceptingOptionSpec[Integer]">maxMessagesOpt</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[Integer])Integer">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.maxMessagesOpt" title="joptsimple.ArgumentAcceptingOptionSpec[Integer]">maxMessagesOpt</a><span class="delimiter">)</span>.<span title="()Int">intValue</span> else -<span title="Int(-1)" class="int">1</span>
    val <a title="kafka.consumer.ConsumerConnector" id="kafka.tools.ConsoleConsumer.main.connector">connector</a> = <a href="../consumer/ConsumerConnector.scala.html#kafka.consumer.Consumer" title="kafka.consumer.Consumer.type">Consumer</a>.<a href="../consumer/ConsumerConnector.scala.html#kafka.consumer.Consumer.create" title="(config: kafka.consumer.ConsumerConfig)kafka.consumer.ConsumerConnector">create</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.config" title="kafka.consumer.ConsumerConfig">config</a><span class="delimiter">)</span>

    <span title="Runtime.type">Runtime</span>.<span title="()Runtime">getRuntime</span>.<span title="(x$1: Thread)Unit">addShutdownHook</span><span class="delimiter">(</span>new <a title="&lt;$anon: Thread&gt; extends Thread" id="kafka.tools.ConsoleConsumer.main;$anon">Thread</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      override def <a title="()Unit" id="kafka.tools.ConsoleConsumer.main;$anon.run">run</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#kafka.tools.ConsoleConsumer.main.connector" title="kafka.consumer.ConsumerConnector">connector</a>.<a href="../consumer/ConsumerConnector.scala.html#kafka.consumer;ConsumerConnector.shutdown" title="()Unit">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="comment">// if there is no group specified then avoid polluting zookeeper with persistent group data, this is a hack</span>
        if<span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#kafka.tools.ConsoleConsumer.main.groupIdPassed" title="Boolean">groupIdPassed</a><span class="delimiter">)</span>
          <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.maybeDeletePath" title="(zkUrl: String, dir: String)Unit">maybeDeletePath</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.zkConnectOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">zkConnectOpt</a><span class="delimiter">)</span>, <span title="String(&quot;/consumers/&quot;)" class="string">&quot;/consumers/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools.ConsoleConsumer.main.consumerProps" title="java.util.Properties">consumerProps</a>.<span title="(x$1: Any)Object">get</span><span class="delimiter">(</span><span title="String(&quot;group.id&quot;)" class="string">&quot;group.id&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

    var <a title="Long" id="kafka.tools.ConsoleConsumer.main.numMessages">numMessages</a> = <span title="Long(0L)" class="long">0L</span>
    val <a title="kafka.tools.MessageFormatter" id="kafka.tools.ConsoleConsumer.main.formatter">formatter</a>: <a href="#kafka.tools;MessageFormatter" title="kafka.tools.MessageFormatter">MessageFormatter</a> = <a href="#kafka.tools.ConsoleConsumer.main.messageFormatterClass" title="Class[_]">messageFormatterClass</a>.<span title="()?0">newInstance</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="kafka.tools.MessageFormatter" class="delimiter">[</span><a href="#kafka.tools;MessageFormatter" title="kafka.tools.MessageFormatter">MessageFormatter</a><span class="delimiter">]</span>
    <a href="#kafka.tools.ConsoleConsumer.main.formatter" title="kafka.tools.MessageFormatter">formatter</a>.<a href="#kafka.tools;MessageFormatter.init" title="(props: java.util.Properties)Unit">init</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.formatterArgs" title="java.util.Properties">formatterArgs</a><span class="delimiter">)</span>
    try <span class="delimiter">{</span>
      val <a title="kafka.consumer.KafkaStream[Array[Byte],Array[Byte]]" id="kafka.tools.ConsoleConsumer.main.stream">stream</a> = <a href="#kafka.tools.ConsoleConsumer.main.connector" title="kafka.consumer.ConsumerConnector">connector</a>.<a href="../consumer/ConsumerConnector.scala.html#kafka.consumer;ConsumerConnector.createMessageStreamsByFilter" title="(topicFilter: kafka.consumer.TopicFilter, numStreams: Int, keyDecoder: kafka.serializer.Decoder[Array[Byte]], valueDecoder: kafka.serializer.Decoder[Array[Byte]])Seq[kafka.consumer.KafkaStream[Array[Byte],Array[Byte]]]">createMessageStreamsByFilter</a><span title="(seq: Seq[kafka.consumer.KafkaStream[Array[Byte],Array[Byte]]])java.util.List[kafka.consumer.KafkaStream[Array[Byte],Array[Byte]]]" class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.filterSpec" title="&lt;refinement of kafka.consumer.TopicFilter with Product&gt; extends kafka.consumer.TopicFilter with Product with Serializable">filterSpec</a>, <span title="Int(1)" class="int">1</span>, new <a href="../serializer/Decoder.scala.html#kafka.serializer;DefaultDecoder" title="kafka.serializer.DefaultDecoder">DefaultDecoder</a><span class="delimiter">(</span><span class="delimiter">)</span>, new <a href="../serializer/Decoder.scala.html#kafka.serializer;DefaultDecoder" title="kafka.serializer.DefaultDecoder">DefaultDecoder</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(x$1: Int)kafka.consumer.KafkaStream[Array[Byte],Array[Byte]]">get</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      val <a title="Iterable[kafka.message.MessageAndMetadata[Array[Byte],Array[Byte]]]" id="kafka.tools.ConsoleConsumer.main.iter">iter</a> = if<span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.maxMessages" title="Int">maxMessages</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        <a href="#kafka.tools.ConsoleConsumer.main.stream" title="kafka.consumer.KafkaStream[Array[Byte],Array[Byte]]">stream</a>.<span title="(from: Int, until: Int)Iterable[kafka.message.MessageAndMetadata[Array[Byte],Array[Byte]]]">slice</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#kafka.tools.ConsoleConsumer.main.maxMessages" title="Int">maxMessages</a><span class="delimiter">)</span>
      else
        <a href="#kafka.tools.ConsoleConsumer.main.stream" title="kafka.consumer.KafkaStream[Array[Byte],Array[Byte]]">stream</a>

      for<span class="delimiter">(</span><a title="kafka.message.MessageAndMetadata[Array[Byte],Array[Byte]]" id="kafka.tools.ConsoleConsumer.main.$anonfun.messageAndTopic">messageAndTopic</a> &lt;- <a href="#kafka.tools.ConsoleConsumer.main.iter" title="(f: kafka.message.MessageAndMetadata[Array[Byte],Array[Byte]] =&gt; Unit)Unit">iter</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        try <span class="delimiter">{</span>
          <a href="#kafka.tools.ConsoleConsumer.main.formatter" title="kafka.tools.MessageFormatter">formatter</a>.<a href="#kafka.tools;MessageFormatter.writeTo" title="(key: Array[Byte], value: Array[Byte], output: java.io.PrintStream)Unit">writeTo</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.$anonfun.messageAndTopic" title="kafka.message.MessageAndMetadata[Array[Byte],Array[Byte]]">messageAndTopic</a>.<a href="../message/MessageAndMetadata.scala.html#kafka.message;MessageAndMetadata.key" title="()Array[Byte]">key</a>, <a href="#kafka.tools.ConsoleConsumer.main.$anonfun.messageAndTopic" title="kafka.message.MessageAndMetadata[Array[Byte],Array[Byte]]">messageAndTopic</a>.<a href="../message/MessageAndMetadata.scala.html#kafka.message;MessageAndMetadata.message" title="()Array[Byte]">message</a>, <span title="System.type">System</span>.<span title="java.io.PrintStream">out</span><span class="delimiter">)</span>
          <a href="#kafka.tools.ConsoleConsumer.main.numMessages" title="Long">numMessages</a> <span title="(x: Int)Long">+=</span> <span title="Int(1)" class="int">1</span>
        <span class="delimiter">}</span> catch <span class="delimiter">{</span>
          case <a title="Throwable" id="kafka.tools.ConsoleConsumer.main.$anonfun.e">e</a>: <span title="Throwable">Throwable</span> =&gt;
            if <span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.skipMessageOnError" title="Boolean">skipMessageOnError</a><span class="delimiter">)</span>
              <a href="../utils/Logging.scala.html#kafka.utils;Logging.error(cfd112d89b)" title="(msg: =&gt; String, e: =&gt; Throwable)Unit">error</a><span class="delimiter">(</span><span title="String(&quot;Error processing message, skipping this message: &quot;)" class="string">&quot;Error processing message, skipping this message: &quot;</span>, <a href="#kafka.tools.ConsoleConsumer.main.$anonfun.e" title="Throwable">e</a><span class="delimiter">)</span>
            else
              throw <a href="#kafka.tools.ConsoleConsumer.main.$anonfun.e" title="Throwable">e</a>
        <span class="delimiter">}</span>
        if<span class="delimiter">(</span><span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="()Boolean">checkError</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="comment">// This means no one is listening to our output stream any more, time to shutdown</span>
          <span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;Unable to write to standard out, closing consumer.&quot;)" class="string">&quot;Unable to write to standard out, closing consumer.&quot;</span><span class="delimiter">)</span>
          <span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Consumed %d messages&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.numMessages" title="Long">numMessages</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#kafka.tools.ConsoleConsumer.main.formatter" title="kafka.tools.MessageFormatter">formatter</a>.<a href="#kafka.tools;MessageFormatter.close" title="()Unit">close</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#kafka.tools.ConsoleConsumer.main.connector" title="kafka.consumer.ConsumerConnector">connector</a>.<a href="../consumer/ConsumerConnector.scala.html#kafka.consumer;ConsumerConnector.shutdown" title="()Unit">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="System.type">System</span>.<span title="(x$1: Int)Unit">exit</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="Throwable" id="kafka.tools.ConsoleConsumer.main.e">e</a>: <span title="Throwable">Throwable</span> =&gt; <a href="../utils/Logging.scala.html#kafka.utils;Logging.error(cfd112d89b)" title="(msg: =&gt; String, e: =&gt; Throwable)Unit">error</a><span class="delimiter">(</span><span title="String(&quot;Error processing message, stopping consumer: &quot;)" class="string">&quot;Error processing message, stopping consumer: &quot;</span>, <a href="#kafka.tools.ConsoleConsumer.main.e" title="Throwable">e</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Consumed %d messages&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.main.numMessages" title="Long">numMessages</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="()Unit">flush</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#kafka.tools.ConsoleConsumer.main.formatter" title="kafka.tools.MessageFormatter">formatter</a>.<a href="#kafka.tools;MessageFormatter.close" title="()Unit">close</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#kafka.tools.ConsoleConsumer.main.connector" title="kafka.consumer.ConsumerConnector">connector</a>.<a href="../consumer/ConsumerConnector.scala.html#kafka.consumer;ConsumerConnector.shutdown" title="()Unit">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  def <a title="(parser: joptsimple.OptionParser, args: Array[String])joptsimple.OptionSet" id="kafka.tools.ConsoleConsumer.tryParse">tryParse</a><span class="delimiter">(</span><a title="joptsimple.OptionParser" id="kafka.tools.ConsoleConsumer.tryParse.parser">parser</a>: <span title="joptsimple.OptionParser">OptionParser</span>, <a title="Array[String]" id="kafka.tools.ConsoleConsumer.tryParse.args">args</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      <a href="#kafka.tools.ConsoleConsumer.tryParse.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String*)joptsimple.OptionSet">parse</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.tryParse.args" title="Array[String]">args</a> : _*<span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case <a title="joptsimple.OptionException" id="kafka.tools.ConsoleConsumer.tryParse.e">e</a>: <span title="joptsimple.OptionException">OptionException</span> =&gt; <span class="delimiter">{</span>
        <a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.croak" title="(message: String)Unit">croak</a><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.tryParse.e" title="joptsimple.OptionException">e</a>.<span title="()String">getMessage</span><span class="delimiter">)</span>
        null
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  def <a title="(zkUrl: String, path: String)Boolean" id="kafka.tools.ConsoleConsumer.checkZkPathExists">checkZkPathExists</a><span class="delimiter">(</span><a title="String" id="kafka.tools.ConsoleConsumer.checkZkPathExists.zkUrl">zkUrl</a>: <span title="String">String</span>, <a title="String" id="kafka.tools.ConsoleConsumer.checkZkPathExists.path">path</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    try <span class="delimiter">{</span>
      val <a title="org.I0Itec.zkclient.ZkClient" id="kafka.tools.ConsoleConsumer.checkZkPathExists.zk">zk</a> = new <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.checkZkPathExists.zkUrl" title="String">zkUrl</a>, <span class="int">30</span><span title="Int(30000)">*</span><span class="int">1000</span>,<span class="int">30</span><span title="Int(30000)">*</span><span class="int">1000</span>, <a href="../utils/ZkUtils.scala.html#kafka.utils.ZKStringSerializer" title="kafka.utils.ZKStringSerializer.type">ZKStringSerializer</a><span class="delimiter">)</span>;
      <a href="#kafka.tools.ConsoleConsumer.checkZkPathExists.zk" title="org.I0Itec.zkclient.ZkClient">zk</a>.<span title="(x$1: String)Boolean">exists</span><span class="delimiter">(</span><a href="#kafka.tools.ConsoleConsumer.checkZkPathExists.path" title="String">path</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> catch <span class="delimiter">{</span>
      case _: <span title="Throwable">Throwable</span> =&gt; false
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

trait <a title="trait MessageFormatter extends AnyRef" id="kafka.tools;MessageFormatter">MessageFormatter</a> <span title="Unit" class="delimiter">{</span>
  def <a title="(key: Array[Byte], value: Array[Byte], output: java.io.PrintStream)Unit" id="kafka.tools;MessageFormatter.writeTo">writeTo</a><span class="delimiter">(</span><a title="Array[Byte]" id="kafka.tools;MessageFormatter.writeTo.key">key</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Array[Byte]" id="kafka.tools;MessageFormatter.writeTo.value">value</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="java.io.PrintStream" id="kafka.tools;MessageFormatter.writeTo.output">output</a>: <span title="java.io.PrintStream">PrintStream</span><span class="delimiter">)</span>
  def <a title="(props: java.util.Properties)Unit" id="kafka.tools;MessageFormatter.init">init</a><span class="delimiter">(</span><a title="java.util.Properties" id="kafka.tools;MessageFormatter.init.props">props</a>: <span title="java.util.Properties">Properties</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
  def <a title="()Unit" id="kafka.tools;MessageFormatter.close">close</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
<span class="delimiter">}</span>

class <a title="class DefaultMessageFormatter extends AnyRef with kafka.tools.MessageFormatter" id="kafka.tools;DefaultMessageFormatter">DefaultMessageFormatter</a> extends <a href="#kafka.tools;MessageFormatter" title="kafka.tools.MessageFormatter">MessageFormatter</a> <span class="delimiter">{</span>
  var <a title="Boolean" id="kafka.tools;DefaultMessageFormatter.printKey_=">printKey</a> = false
  var <a title="Array[Byte]" id="kafka.tools;DefaultMessageFormatter.keySeparator_=">keySeparator</a> = <span title="String(&quot;\t&quot;)" class="string">&quot;\t&quot;</span>.<span title="()Array[Byte]">getBytes</span>
  var <a title="Array[Byte]" id="kafka.tools;DefaultMessageFormatter.lineSeparator_=">lineSeparator</a> = <span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span>.<span title="()Array[Byte]">getBytes</span>

  override def <a title="(props: java.util.Properties)Unit" id="kafka.tools;DefaultMessageFormatter.init">init</a><span class="delimiter">(</span><a title="java.util.Properties" id="kafka.tools;DefaultMessageFormatter.init.props">props</a>: <span title="java.util.Properties">Properties</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    if<span class="delimiter">(</span><a href="#kafka.tools;DefaultMessageFormatter.init.props" title="java.util.Properties">props</a>.<span title="(x$1: Any)Boolean">containsKey</span><span class="delimiter">(</span><span title="String(&quot;print.key&quot;)" class="string">&quot;print.key&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#kafka.tools;DefaultMessageFormatter.printKey_=" title="(x$1: Boolean)Unit">printKey</a> = <a href="#kafka.tools;DefaultMessageFormatter.init.props" title="java.util.Properties">props</a>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;print.key&quot;)" class="string">&quot;print.key&quot;</span><span class="delimiter">)</span>.<span title="()String">trim</span>.<span title="()String">toLowerCase</span>.<span title="(x$1: Any)Boolean">equals</span><span class="delimiter">(</span><span title="String(&quot;true&quot;)" class="string">&quot;true&quot;</span><span class="delimiter">)</span>
    if<span class="delimiter">(</span><a href="#kafka.tools;DefaultMessageFormatter.init.props" title="java.util.Properties">props</a>.<span title="(x$1: Any)Boolean">containsKey</span><span class="delimiter">(</span><span title="String(&quot;key.separator&quot;)" class="string">&quot;key.separator&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#kafka.tools;DefaultMessageFormatter.keySeparator_=" title="(x$1: Array[Byte])Unit">keySeparator</a> = <a href="#kafka.tools;DefaultMessageFormatter.init.props" title="java.util.Properties">props</a>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;key.separator&quot;)" class="string">&quot;key.separator&quot;</span><span class="delimiter">)</span>.<span title="()Array[Byte]">getBytes</span>
    if<span class="delimiter">(</span><a href="#kafka.tools;DefaultMessageFormatter.init.props" title="java.util.Properties">props</a>.<span title="(x$1: Any)Boolean">containsKey</span><span class="delimiter">(</span><span title="String(&quot;line.separator&quot;)" class="string">&quot;line.separator&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#kafka.tools;DefaultMessageFormatter.lineSeparator_=" title="(x$1: Array[Byte])Unit">lineSeparator</a> = <a href="#kafka.tools;DefaultMessageFormatter.init.props" title="java.util.Properties">props</a>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;line.separator&quot;)" class="string">&quot;line.separator&quot;</span><span class="delimiter">)</span>.<span title="()Array[Byte]">getBytes</span>
  <span class="delimiter">}</span>

  def <a title="(key: Array[Byte], value: Array[Byte], output: java.io.PrintStream)Unit" id="kafka.tools;DefaultMessageFormatter.writeTo">writeTo</a><span class="delimiter">(</span><a title="Array[Byte]" id="kafka.tools;DefaultMessageFormatter.writeTo.key">key</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Array[Byte]" id="kafka.tools;DefaultMessageFormatter.writeTo.value">value</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="java.io.PrintStream" id="kafka.tools;DefaultMessageFormatter.writeTo.output">output</a>: <span title="java.io.PrintStream">PrintStream</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    if<span class="delimiter">(</span><a href="#kafka.tools;DefaultMessageFormatter.printKey_=" title="=&gt; Boolean">printKey</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#kafka.tools;DefaultMessageFormatter.writeTo.output" title="java.io.PrintStream">output</a>.<span title="(x$1: Array[Byte])Unit">write</span><span class="delimiter">(</span>if <span class="delimiter">(</span><a href="#kafka.tools;DefaultMessageFormatter.writeTo.key" title="Array[Byte]">key</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span> <span title="String(&quot;null&quot;)" class="string">&quot;null&quot;</span>.<span title="()Array[Byte]">getBytes</span><span class="delimiter">(</span><span class="delimiter">)</span> else <a href="#kafka.tools;DefaultMessageFormatter.writeTo.key" title="Array[Byte]">key</a><span class="delimiter">)</span>
      <a href="#kafka.tools;DefaultMessageFormatter.writeTo.output" title="java.io.PrintStream">output</a>.<span title="(x$1: Array[Byte])Unit">write</span><span class="delimiter">(</span><a href="#kafka.tools;DefaultMessageFormatter.keySeparator_=" title="=&gt; Array[Byte]">keySeparator</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#kafka.tools;DefaultMessageFormatter.writeTo.output" title="java.io.PrintStream">output</a>.<span title="(x$1: Array[Byte])Unit">write</span><span class="delimiter">(</span>if <span class="delimiter">(</span><a href="#kafka.tools;DefaultMessageFormatter.writeTo.value" title="Array[Byte]">value</a> <span title="(x$1: Any)Boolean">==</span> null<span class="delimiter">)</span> <span title="String(&quot;null&quot;)" class="string">&quot;null&quot;</span>.<span title="()Array[Byte]">getBytes</span><span class="delimiter">(</span><span class="delimiter">)</span> else <a href="#kafka.tools;DefaultMessageFormatter.writeTo.value" title="Array[Byte]">value</a><span class="delimiter">)</span>
    <a href="#kafka.tools;DefaultMessageFormatter.writeTo.output" title="java.io.PrintStream">output</a>.<span title="(x$1: Array[Byte])Unit">write</span><span class="delimiter">(</span><a href="#kafka.tools;DefaultMessageFormatter.lineSeparator_=" title="=&gt; Array[Byte]">lineSeparator</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

class <a title="class NoOpMessageFormatter extends AnyRef with kafka.tools.MessageFormatter" id="kafka.tools;NoOpMessageFormatter">NoOpMessageFormatter</a> extends <a href="#kafka.tools;MessageFormatter" title="kafka.tools.MessageFormatter">MessageFormatter</a> <span class="delimiter">{</span>
  override def <a title="(props: java.util.Properties)Unit" id="kafka.tools;NoOpMessageFormatter.init">init</a><span class="delimiter">(</span><a title="java.util.Properties" id="kafka.tools;NoOpMessageFormatter.init.props">props</a>: <span title="java.util.Properties">Properties</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
  def <a title="(key: Array[Byte], value: Array[Byte], output: java.io.PrintStream)Unit" id="kafka.tools;NoOpMessageFormatter.writeTo">writeTo</a><span class="delimiter">(</span><a title="Array[Byte]" id="kafka.tools;NoOpMessageFormatter.writeTo.key">key</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Array[Byte]" id="kafka.tools;NoOpMessageFormatter.writeTo.value">value</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="java.io.PrintStream" id="kafka.tools;NoOpMessageFormatter.writeTo.output">output</a>: <span title="java.io.PrintStream">PrintStream</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
<span class="delimiter">}</span>

class <a title="class ChecksumMessageFormatter extends AnyRef with kafka.tools.MessageFormatter" id="kafka.tools;ChecksumMessageFormatter">ChecksumMessageFormatter</a> extends <a href="#kafka.tools;MessageFormatter" title="kafka.tools.MessageFormatter">MessageFormatter</a> <span class="delimiter">{</span>
  private var <a title="String" id="kafka.tools;ChecksumMessageFormatter.topicStr_=">topicStr</a>: <span title="String">String</span> = _

  override def <a title="(props: java.util.Properties)Unit" id="kafka.tools;ChecksumMessageFormatter.init">init</a><span class="delimiter">(</span><a title="java.util.Properties" id="kafka.tools;ChecksumMessageFormatter.init.props">props</a>: <span title="java.util.Properties">Properties</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#kafka.tools;ChecksumMessageFormatter.topicStr_=" title="(x$1: String)Unit">topicStr</a> = <a href="#kafka.tools;ChecksumMessageFormatter.init.props" title="java.util.Properties">props</a>.<span title="(x$1: String)String">getProperty</span><span class="delimiter">(</span><span title="String(&quot;topic&quot;)" class="string">&quot;topic&quot;</span><span class="delimiter">)</span>
    if <span class="delimiter">(</span><a href="#kafka.tools;ChecksumMessageFormatter.topicStr_=" title="=&gt; String">topicStr</a> <span title="(x$1: Any)Boolean">!=</span> null<span class="delimiter">)</span>
      <a href="#kafka.tools;ChecksumMessageFormatter.topicStr_=" title="(x$1: String)Unit">topicStr</a> = <a href="#kafka.tools;ChecksumMessageFormatter.topicStr_=" title="=&gt; String">topicStr</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;:&quot;)" class="string">&quot;:&quot;</span>
    else
      <a href="#kafka.tools;ChecksumMessageFormatter.topicStr_=" title="(x$1: String)Unit">topicStr</a> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
  <span class="delimiter">}</span>

  def <a title="(key: Array[Byte], value: Array[Byte], output: java.io.PrintStream)Unit" id="kafka.tools;ChecksumMessageFormatter.writeTo">writeTo</a><span class="delimiter">(</span><a title="Array[Byte]" id="kafka.tools;ChecksumMessageFormatter.writeTo.key">key</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Array[Byte]" id="kafka.tools;ChecksumMessageFormatter.writeTo.value">value</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="java.io.PrintStream" id="kafka.tools;ChecksumMessageFormatter.writeTo.output">output</a>: <span title="java.io.PrintStream">PrintStream</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    val <a title="Long" id="kafka.tools;ChecksumMessageFormatter.writeTo.chksum">chksum</a> = new <a href="../message/Message.scala.html#kafka.message;Message" title="kafka.message.Message">Message</a><span class="delimiter">(</span><a href="#kafka.tools;ChecksumMessageFormatter.writeTo.value" title="Array[Byte]">value</a>, <a href="#kafka.tools;ChecksumMessageFormatter.writeTo.key" title="Array[Byte]">key</a><span class="delimiter">)</span>.<a href="../message/Message.scala.html#kafka.message;Message.checksum" title="=&gt; Long">checksum</a>
    <a href="#kafka.tools;ChecksumMessageFormatter.writeTo.output" title="java.io.PrintStream">output</a>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><a href="#kafka.tools;ChecksumMessageFormatter.topicStr_=" title="=&gt; String">topicStr</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;checksum:&quot;)" class="string">&quot;checksum:&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools;ChecksumMessageFormatter.writeTo.chksum" title="Long">chksum</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

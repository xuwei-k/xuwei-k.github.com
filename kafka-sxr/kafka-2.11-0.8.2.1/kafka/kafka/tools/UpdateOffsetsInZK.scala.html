<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>kafka/kafka/tools/UpdateOffsetsInZK.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 * 
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

package kafka.tools

import org.I0Itec.zkclient.ZkClient
import kafka.consumer.<span class="delimiter">{</span>SimpleConsumer, ConsumerConfig<span class="delimiter">}</span>
import kafka.api.<span class="delimiter">{</span>PartitionOffsetRequestInfo, OffsetRequest<span class="delimiter">}</span>
import kafka.common.<span class="delimiter">{</span>TopicAndPartition, KafkaException<span class="delimiter">}</span>
import kafka.utils.<span class="delimiter">{</span>ZKGroupTopicDirs, ZkUtils, ZKStringSerializer, Utils<span class="delimiter">}</span>


<span class="comment">/**
 *  A utility that updates the offset of every broker partition to the offset of earliest or latest log segment file, in ZK.
 */</span>
object <a title="kafka.tools.UpdateOffsetsInZK.type" id="kafka.tools.UpdateOffsetsInZK">UpdateOffsetsInZK</a> <a href="#kafka.tools.UpdateOffsetsInZK" title="kafka.tools.UpdateOffsetsInZK.type" class="delimiter">{</a>
  val <a title="String" id="kafka.tools.UpdateOffsetsInZK.Earliest">Earliest</a> = <span title="String(&quot;earliest&quot;)" class="string">&quot;earliest&quot;</span>
  val <a title="String" id="kafka.tools.UpdateOffsetsInZK.Latest">Latest</a> = <span title="String(&quot;latest&quot;)" class="string">&quot;latest&quot;</span>

  def <a title="(args: Array[String])Unit" id="kafka.tools.UpdateOffsetsInZK.main">main</a><span class="delimiter">(</span><a title="Array[String]" id="kafka.tools.UpdateOffsetsInZK.main.args">args</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    if<span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.main.args" title="Array[String]">args</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(3)" class="int">3</span><span class="delimiter">)</span>
      <a href="#kafka.tools.UpdateOffsetsInZK.usage" title="()Unit">usage</a>
    val <a title="kafka.consumer.ConsumerConfig" id="kafka.tools.UpdateOffsetsInZK.main.config">config</a> = new <a href="../consumer/ConsumerConfig.scala.html#kafka.consumer;ConsumerConfig" title="kafka.consumer.ConsumerConfig">ConsumerConfig</a><span class="delimiter">(</span><a href="../utils/Utils.scala.html#kafka.utils.Utils" title="kafka.utils.Utils.type">Utils</a>.<a href="../utils/Utils.scala.html#kafka.utils.Utils.loadProps" title="(filename: String)java.util.Properties">loadProps</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.main.args" title="(i: Int)String">args</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    val <a title="org.I0Itec.zkclient.ZkClient" id="kafka.tools.UpdateOffsetsInZK.main.zkClient">zkClient</a> = new <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.main.config" title="kafka.consumer.ConsumerConfig">config</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils;ZKConfig.zkConnect" title="=&gt; String">zkConnect</a>, <a href="#kafka.tools.UpdateOffsetsInZK.main.config" title="kafka.consumer.ConsumerConfig">config</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils;ZKConfig.zkSessionTimeoutMs" title="=&gt; Int">zkSessionTimeoutMs</a>,
        <a href="#kafka.tools.UpdateOffsetsInZK.main.config" title="kafka.consumer.ConsumerConfig">config</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils;ZKConfig.zkConnectionTimeoutMs" title="=&gt; Int">zkConnectionTimeoutMs</a>, <a href="../utils/ZkUtils.scala.html#kafka.utils.ZKStringSerializer" title="kafka.utils.ZKStringSerializer.type">ZKStringSerializer</a><span class="delimiter">)</span>
    <a href="#kafka.tools.UpdateOffsetsInZK.main.args" title="(i: Int)String">args</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> match <span class="delimiter">{</span>
      case <a href="#kafka.tools.UpdateOffsetsInZK.Earliest" title="=&gt; String">Earliest</a> =&gt; <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets" title="(zkClient: org.I0Itec.zkclient.ZkClient, offsetOption: Long, config: kafka.consumer.ConsumerConfig, topic: String)Unit">getAndSetOffsets</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.main.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="../api/OffsetRequest.scala.html#kafka.api.OffsetRequest" title="kafka.api.OffsetRequest.type">OffsetRequest</a>.<a href="../api/OffsetRequest.scala.html#kafka.api.OffsetRequest.EarliestTime" title="=&gt; Long">EarliestTime</a>, <a href="#kafka.tools.UpdateOffsetsInZK.main.config" title="kafka.consumer.ConsumerConfig">config</a>, <a href="#kafka.tools.UpdateOffsetsInZK.main.args" title="(i: Int)String">args</a><span class="delimiter">(</span><span title="Int(2)" class="int">2</span><span class="delimiter">)</span><span class="delimiter">)</span>
      case <a href="#kafka.tools.UpdateOffsetsInZK.Latest" title="=&gt; String">Latest</a> =&gt; <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets" title="(zkClient: org.I0Itec.zkclient.ZkClient, offsetOption: Long, config: kafka.consumer.ConsumerConfig, topic: String)Unit">getAndSetOffsets</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.main.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="../api/OffsetRequest.scala.html#kafka.api.OffsetRequest" title="kafka.api.OffsetRequest.type">OffsetRequest</a>.<a href="../api/OffsetRequest.scala.html#kafka.api.OffsetRequest.LatestTime" title="=&gt; Long">LatestTime</a>, <a href="#kafka.tools.UpdateOffsetsInZK.main.config" title="kafka.consumer.ConsumerConfig">config</a>, <a href="#kafka.tools.UpdateOffsetsInZK.main.args" title="(i: Int)String">args</a><span class="delimiter">(</span><span title="Int(2)" class="int">2</span><span class="delimiter">)</span><span class="delimiter">)</span>
      case _ =&gt; <a href="#kafka.tools.UpdateOffsetsInZK.usage" title="()Unit">usage</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  private def <a title="(zkClient: org.I0Itec.zkclient.ZkClient, offsetOption: Long, config: kafka.consumer.ConsumerConfig, topic: String)Unit" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets">getAndSetOffsets</a><span class="delimiter">(</span><a title="org.I0Itec.zkclient.ZkClient" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.zkClient">zkClient</a>: <span title="org.I0Itec.zkclient.ZkClient">ZkClient</span>, <a title="Long" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.offsetOption">offsetOption</a>: <span title="Long">Long</span>, <a title="kafka.consumer.ConsumerConfig" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.config">config</a>: <a href="../consumer/ConsumerConfig.scala.html#kafka.consumer;ConsumerConfig" title="kafka.consumer.ConsumerConfig">ConsumerConfig</a>, <a title="String" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.topic">topic</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    val <a title="scala.collection.mutable.Map[String,Seq[Int]]" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.partitionsPerTopicMap">partitionsPerTopicMap</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getPartitionsForTopics" title="(zkClient: org.I0Itec.zkclient.ZkClient, topics: Seq[String])scala.collection.mutable.Map[String,Seq[Int]]">getPartitionsForTopics</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <span title="(xs: String*)List[String]">List</span><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span>
    var <a title="Seq[Int]" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.partitions">partitions</a>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span title="scala.collection.immutable.Nil.type">Nil</span>

    <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.partitionsPerTopicMap" title="scala.collection.mutable.Map[String,Seq[Int]]">partitionsPerTopicMap</a>.<span title="(key: String)Option[Seq[Int]]">get</span><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.topic" title="String">topic</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
      case Some<span class="delimiter">(</span><a title="Seq[Int]" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.l">l</a><span class="delimiter">)</span> =&gt;  <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.partitions" title="Seq[Int]">partitions</a> = <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.l" title="Seq[Int]">l</a>.<span title="(lt: (Int, Int) =&gt; Boolean)Seq[Int]">sortWith</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="Int" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.s">s</a>,<a title="Int" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.t">t</a><span class="delimiter">)</span> =&gt; <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.s" title="Int">s</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.t" title="Int">t</a><span class="delimiter">)</span>
      case _ =&gt; throw new <span title="RuntimeException">RuntimeException</span><span class="delimiter">(</span><span title="String(&quot;Can\'t find topic &quot;)" class="string">&quot;Can't find topic &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.topic" title="String">topic</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    var <a title="Int" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.numParts">numParts</a> = <span title="Int(0)" class="int">0</span>
    for <span class="delimiter">(</span><a title="Int" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.partition">partition</a> &lt;- <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.partitions" title="(f: Int =&gt; Unit)Unit">partitions</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      val <a title="Option[Int]" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.brokerHostingPartition">brokerHostingPartition</a> = <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getLeaderForPartition" title="(zkClient: org.I0Itec.zkclient.ZkClient, topic: String, partition: Int)Option[Int]">getLeaderForPartition</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.topic" title="String">topic</a>, <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.partition" title="Int">partition</a><span class="delimiter">)</span>

      val <a title="Int" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.broker">broker</a> = <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.brokerHostingPartition" title="Option[Int]">brokerHostingPartition</a> match <span class="delimiter">{</span>
        case Some<span class="delimiter">(</span><a title="Int" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.broker.b">b</a><span class="delimiter">)</span> =&gt; <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.broker.b" title="Int">b</a>
        case <span title="None.type">None</span> =&gt; throw new <a href="../common/KafkaException.scala.html#kafka.common;KafkaException" title="kafka.common.KafkaException">KafkaException</a><span class="delimiter">(</span><span title="String(&quot;Broker &quot;)" class="string">&quot;Broker &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.brokerHostingPartition" title="Option[Int]">brokerHostingPartition</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; is unavailable. Cannot issue &quot;)" class="string">&quot; is unavailable. Cannot issue &quot;</span> <span title="(x$1: Any)String">+</span>
          <span title="String(&quot;getOffsetsBefore request&quot;)" class="string">&quot;getOffsetsBefore request&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.getBrokerInfo" title="(zkClient: org.I0Itec.zkclient.ZkClient, brokerId: Int)Option[kafka.cluster.Broker]">getBrokerInfo</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.broker" title="Int">broker</a><span class="delimiter">)</span> match <span class="delimiter">{</span>
        case Some<span class="delimiter">(</span><a title="kafka.cluster.Broker" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.brokerInfo">brokerInfo</a><span class="delimiter">)</span> =&gt;
          val <a title="kafka.consumer.SimpleConsumer" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.consumer">consumer</a> = new <a href="../consumer/SimpleConsumer.scala.html#kafka.consumer;SimpleConsumer" title="kafka.consumer.SimpleConsumer">SimpleConsumer</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.brokerInfo" title="kafka.cluster.Broker">brokerInfo</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.host" title="=&gt; String">host</a>, <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.brokerInfo" title="kafka.cluster.Broker">brokerInfo</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.port" title="=&gt; Int">port</a>, <span title="Int(10000)" class="int">10000</span>, <span class="int">100</span> <span title="Int(102400)">*</span> <span class="int">1024</span>, <span title="String(&quot;UpdateOffsetsInZk&quot;)" class="string">&quot;UpdateOffsetsInZk&quot;</span><span class="delimiter">)</span>
          val <a title="kafka.common.TopicAndPartition" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.topicAndPartition">topicAndPartition</a> = <a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition" title="(topic: String, partition: Int)kafka.common.TopicAndPartition">TopicAndPartition</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.topic" title="String">topic</a>, <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.partition" title="Int">partition</a><span class="delimiter">)</span>
          val <a title="kafka.api.OffsetRequest" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.request">request</a> = <a href="../api/OffsetRequest.scala.html#kafka.api;OffsetRequest" title="(requestInfo: Map[kafka.common.TopicAndPartition,kafka.api.PartitionOffsetRequestInfo], versionId: Short, correlationId: Int, clientId: String, replicaId: Int)kafka.api.OffsetRequest">OffsetRequest</a><span class="delimiter">(</span><span title="(elems: (kafka.common.TopicAndPartition, kafka.api.PartitionOffsetRequestInfo)*)scala.collection.immutable.Map[kafka.common.TopicAndPartition,kafka.api.PartitionOffsetRequestInfo]">Map</span><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.topicAndPartition" title="(self: kafka.common.TopicAndPartition)ArrowAssoc[kafka.common.TopicAndPartition]">topicAndPartition</a> <span title="(y: kafka.api.PartitionOffsetRequestInfo)(kafka.common.TopicAndPartition, kafka.api.PartitionOffsetRequestInfo)">-&gt;</span> <a href="../api/OffsetRequest.scala.html#kafka.api;PartitionOffsetRequestInfo" title="(time: Long, maxNumOffsets: Int)kafka.api.PartitionOffsetRequestInfo">PartitionOffsetRequestInfo</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.offsetOption" title="Long">offsetOption</a>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          val <a title="Long" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.offset">offset</a> = <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.consumer" title="kafka.consumer.SimpleConsumer">consumer</a>.<a href="../consumer/SimpleConsumer.scala.html#kafka.consumer;SimpleConsumer.getOffsetsBefore" title="(request: kafka.api.OffsetRequest)kafka.api.OffsetResponse">getOffsetsBefore</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.request" title="kafka.api.OffsetRequest">request</a><span class="delimiter">)</span>.<a href="../api/OffsetResponse.scala.html#kafka.api;OffsetResponse.partitionErrorAndOffsets" title="(key: kafka.common.TopicAndPartition)kafka.api.PartitionOffsetsResponse">partitionErrorAndOffsets</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.topicAndPartition" title="kafka.common.TopicAndPartition">topicAndPartition</a><span class="delimiter">)</span>.<a href="../api/OffsetResponse.scala.html#kafka.api;PartitionOffsetsResponse.offsets" title="=&gt; Seq[Long]">offsets</a>.<span title="=&gt; Long">head</span>
          val <a title="kafka.utils.ZKGroupTopicDirs" id="kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.topicDirs">topicDirs</a> = new <a href="../utils/ZkUtils.scala.html#kafka.utils;ZKGroupTopicDirs" title="kafka.utils.ZKGroupTopicDirs">ZKGroupTopicDirs</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.config" title="kafka.consumer.ConsumerConfig">config</a>.<a href="../consumer/ConsumerConfig.scala.html#kafka.consumer;ConsumerConfig.groupId" title="=&gt; String">groupId</a>, <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.topic" title="String">topic</a><span class="delimiter">)</span>

          <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;updating partition &quot;)" class="string">&quot;updating partition &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.partition" title="Int">partition</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; with new offset: &quot;)" class="string">&quot; with new offset: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.offset" title="Long">offset</a><span class="delimiter">)</span>
          <a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils" title="kafka.utils.ZkUtils.type">ZkUtils</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils.ZkUtils.updatePersistentPath" title="(client: org.I0Itec.zkclient.ZkClient, path: String, data: String)Unit">updatePersistentPath</a><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.zkClient" title="org.I0Itec.zkclient.ZkClient">zkClient</a>, <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.topicDirs" title="kafka.utils.ZKGroupTopicDirs">topicDirs</a>.<a href="../utils/ZkUtils.scala.html#kafka.utils;ZKGroupTopicDirs.consumerOffsetDir" title="=&gt; String">consumerOffsetDir</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.partition" title="Int">partition</a>, <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.offset" title="Long">offset</a>.<span title="()String">toString</span><span class="delimiter">)</span>
          <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.numParts" title="Int">numParts</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
        case <span title="None.type">None</span> =&gt; throw new <a href="../common/KafkaException.scala.html#kafka.common;KafkaException" title="kafka.common.KafkaException">KafkaException</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Broker information for broker id %d does not exist in ZK&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.$anonfun.broker" title="Int">broker</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;updated the offset for &quot;)" class="string">&quot;updated the offset for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools.UpdateOffsetsInZK.getAndSetOffsets.numParts" title="Int">numParts</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; partitions&quot;)" class="string">&quot; partitions&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  private def <a title="()Unit" id="kafka.tools.UpdateOffsetsInZK.usage">usage</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;USAGE: &quot;)" class="string">&quot;USAGE: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#kafka.tools.UpdateOffsetsInZK" title="kafka.tools.UpdateOffsetsInZK.type">UpdateOffsetsInZK</a>.<span title="()Class[_]">getClass</span>.<span title="()String">getName</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; [earliest | latest] consumer.properties topic&quot;)" class="string">&quot; [earliest | latest] consumer.properties topic&quot;</span><span class="delimiter">)</span>
    <span title="System.type">System</span>.<span title="(x$1: Int)Unit">exit</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>

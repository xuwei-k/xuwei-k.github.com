<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>kafka/kafka/tools/GetOffsetShell.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * &quot;License&quot;); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */</span>
package kafka.tools

import kafka.consumer._
import joptsimple._
import kafka.api.<span class="delimiter">{</span>PartitionOffsetRequestInfo, OffsetRequest<span class="delimiter">}</span>
import kafka.common.TopicAndPartition
import kafka.client.ClientUtils
import kafka.utils.<span class="delimiter">{</span>ToolsUtils, CommandLineUtils<span class="delimiter">}</span>


object <a title="kafka.tools.GetOffsetShell.type" id="kafka.tools.GetOffsetShell">GetOffsetShell</a> <a href="#kafka.tools.GetOffsetShell" title="kafka.tools.GetOffsetShell.type" class="delimiter">{</a>

  def <a title="(args: Array[String])Unit" id="kafka.tools.GetOffsetShell.main">main</a><span class="delimiter">(</span><a title="Array[String]" id="kafka.tools.GetOffsetShell.main.args">args</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    val <a title="joptsimple.OptionParser" id="kafka.tools.GetOffsetShell.main.parser">parser</a> = new <span title="joptsimple.OptionParser">OptionParser</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.GetOffsetShell.main.brokerListOpt">brokerListOpt</a> = <a href="#kafka.tools.GetOffsetShell.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;broker-list&quot;)" class="string">&quot;broker-list&quot;</span>, <span title="String(&quot;REQUIRED: The list of hostname and port of the server to connect to.&quot;)" class="string">&quot;REQUIRED: The list of hostname and port of the server to connect to.&quot;</span><span class="delimiter">)</span>
                           .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
                           .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;hostname:port,...,hostname:port&quot;)" class="string">&quot;hostname:port,...,hostname:port&quot;</span><span class="delimiter">)</span>
                           .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.GetOffsetShell.main.topicOpt">topicOpt</a> = <a href="#kafka.tools.GetOffsetShell.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;topic&quot;)" class="string">&quot;topic&quot;</span>, <span title="String(&quot;REQUIRED: The topic to get offset from.&quot;)" class="string">&quot;REQUIRED: The topic to get offset from.&quot;</span><span class="delimiter">)</span>
                           .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
                           .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;topic&quot;)" class="string">&quot;topic&quot;</span><span class="delimiter">)</span>
                           .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[String]" id="kafka.tools.GetOffsetShell.main.partitionOpt">partitionOpt</a> = <a href="#kafka.tools.GetOffsetShell.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;partitions&quot;)" class="string">&quot;partitions&quot;</span>, <span title="String(&quot;comma separated list of partition ids. If not specified, it will find offsets for all partitions&quot;)" class="string">&quot;comma separated list of partition ids. If not specified, it will find offsets for all partitions&quot;</span><span class="delimiter">)</span>
                           .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
                           .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;partition ids&quot;)" class="string">&quot;partition ids&quot;</span><span class="delimiter">)</span>
                           .<span title="(x$1: Class[String])joptsimple.ArgumentAcceptingOptionSpec[String]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
                           .<span title="(x$1: String, x$2: String*)joptsimple.ArgumentAcceptingOptionSpec[String]">defaultsTo</span><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[Long]" id="kafka.tools.GetOffsetShell.main.timeOpt">timeOpt</a> = <a href="#kafka.tools.GetOffsetShell.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;time&quot;)" class="string">&quot;time&quot;</span>, <span title="String(&quot;timestamp of the offsets before that&quot;)" class="string">&quot;timestamp of the offsets before that&quot;</span><span class="delimiter">)</span>
                           .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
                           .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;timestamp/-1(latest)/-2(earliest)&quot;)" class="string">&quot;timestamp/-1(latest)/-2(earliest)&quot;</span><span class="delimiter">)</span>
                           .<span title="(x$1: Class[Long])joptsimple.ArgumentAcceptingOptionSpec[Long]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[Long](classOf[java.lang.Long])" class="delimiter">[</span>java.lang.Long<span class="delimiter">]</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[Integer]" id="kafka.tools.GetOffsetShell.main.nOffsetsOpt">nOffsetsOpt</a> = <a href="#kafka.tools.GetOffsetShell.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;offsets&quot;)" class="string">&quot;offsets&quot;</span>, <span title="String(&quot;number of offsets returned&quot;)" class="string">&quot;number of offsets returned&quot;</span><span class="delimiter">)</span>
                           .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
                           .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;count&quot;)" class="string">&quot;count&quot;</span><span class="delimiter">)</span>
                           .<span title="(x$1: Class[Integer])joptsimple.ArgumentAcceptingOptionSpec[Integer]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[Integer](classOf[java.lang.Integer])" class="delimiter">[</span>java.lang.Integer<span class="delimiter">]</span><span class="delimiter">)</span>
                           .<span title="(x$1: Integer, x$2: Integer*)joptsimple.ArgumentAcceptingOptionSpec[Integer]">defaultsTo</span><span class="delimiter">(</span><span title="implicit scala.Predef.int2Integer : (x: Int)Integer" class="int">1</span><span class="delimiter">)</span>
    val <a title="joptsimple.ArgumentAcceptingOptionSpec[Integer]" id="kafka.tools.GetOffsetShell.main.maxWaitMsOpt">maxWaitMsOpt</a> = <a href="#kafka.tools.GetOffsetShell.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String, x$2: String)joptsimple.OptionSpecBuilder">accepts</span><span class="delimiter">(</span><span title="String(&quot;max-wait-ms&quot;)" class="string">&quot;max-wait-ms&quot;</span>, <span title="String(&quot;The max amount of time each fetch request waits.&quot;)" class="string">&quot;The max amount of time each fetch request waits.&quot;</span><span class="delimiter">)</span>
                           .<span title="()joptsimple.ArgumentAcceptingOptionSpec[String]">withRequiredArg</span>
                           .<span title="(x$1: String)joptsimple.ArgumentAcceptingOptionSpec[String]">describedAs</span><span class="delimiter">(</span><span title="String(&quot;ms&quot;)" class="string">&quot;ms&quot;</span><span class="delimiter">)</span>
                           .<span title="(x$1: Class[Integer])joptsimple.ArgumentAcceptingOptionSpec[Integer]">ofType</span><span class="delimiter">(</span>classOf<span title="Class[Integer](classOf[java.lang.Integer])" class="delimiter">[</span>java.lang.Integer<span class="delimiter">]</span><span class="delimiter">)</span>
                           .<span title="(x$1: Integer, x$2: Integer*)joptsimple.ArgumentAcceptingOptionSpec[Integer]">defaultsTo</span><span class="delimiter">(</span><span title="implicit scala.Predef.int2Integer : (x: Int)Integer" class="int">1000</span><span class="delimiter">)</span>
                           
   if<span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.args" title="Array[String]">args</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.printUsageAndDie" title="(parser: joptsimple.OptionParser, message: String)Unit">printUsageAndDie</a><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.parser" title="joptsimple.OptionParser">parser</a>, <span title="String(&quot;An interactive shell for getting consumer offsets.&quot;)" class="string">&quot;An interactive shell for getting consumer offsets.&quot;</span><span class="delimiter">)</span>

    val <a title="joptsimple.OptionSet" id="kafka.tools.GetOffsetShell.main.options">options</a> = <a href="#kafka.tools.GetOffsetShell.main.parser" title="joptsimple.OptionParser">parser</a>.<span title="(x$1: String*)joptsimple.OptionSet">parse</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.args" title="Array[String]">args</a> : _*<span class="delimiter">)</span>

    <a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils" title="kafka.utils.CommandLineUtils.type">CommandLineUtils</a>.<a href="../utils/CommandLineUtils.scala.html#kafka.utils.CommandLineUtils.checkRequiredArgs" title="(parser: joptsimple.OptionParser, options: joptsimple.OptionSet, required: joptsimple.OptionSpec[_]*)Unit">checkRequiredArgs</a><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.parser" title="joptsimple.OptionParser">parser</a>, <a href="#kafka.tools.GetOffsetShell.main.options" title="joptsimple.OptionSet">options</a>, <a href="#kafka.tools.GetOffsetShell.main.brokerListOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">brokerListOpt</a>, <a href="#kafka.tools.GetOffsetShell.main.topicOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">topicOpt</a>, <a href="#kafka.tools.GetOffsetShell.main.timeOpt" title="joptsimple.ArgumentAcceptingOptionSpec[Long]">timeOpt</a><span class="delimiter">)</span>

    val <a title="String" id="kafka.tools.GetOffsetShell.main.clientId">clientId</a> = <span title="String(&quot;GetOffsetShell&quot;)" class="string">&quot;GetOffsetShell&quot;</span>
    val <a title="String" id="kafka.tools.GetOffsetShell.main.brokerList">brokerList</a> = <a href="#kafka.tools.GetOffsetShell.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.brokerListOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">brokerListOpt</a><span class="delimiter">)</span>
    <a href="../utils/ToolsUtils.scala.html#kafka.utils.ToolsUtils" title="kafka.utils.ToolsUtils.type">ToolsUtils</a>.<a href="../utils/ToolsUtils.scala.html#kafka.utils.ToolsUtils.validatePortOrDie" title="(parser: joptsimple.OptionParser, hostPort: String)Unit">validatePortOrDie</a><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.parser" title="joptsimple.OptionParser">parser</a>, <a href="#kafka.tools.GetOffsetShell.main.brokerList" title="String">brokerList</a><span class="delimiter">)</span>
    val <a title="Seq[kafka.cluster.Broker]" id="kafka.tools.GetOffsetShell.main.metadataTargetBrokers">metadataTargetBrokers</a> = <a href="../client/ClientUtils.scala.html#kafka.client.ClientUtils" title="kafka.client.ClientUtils.type">ClientUtils</a>.<a href="../client/ClientUtils.scala.html#kafka.client.ClientUtils.parseBrokerList" title="(brokerListStr: String)Seq[kafka.cluster.Broker]">parseBrokerList</a><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.brokerList" title="String">brokerList</a><span class="delimiter">)</span>
    val <a title="String" id="kafka.tools.GetOffsetShell.main.topic">topic</a> = <a href="#kafka.tools.GetOffsetShell.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.topicOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">topicOpt</a><span class="delimiter">)</span>
    var <a title="String" id="kafka.tools.GetOffsetShell.main.partitionList">partitionList</a> = <a href="#kafka.tools.GetOffsetShell.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[String])String">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.partitionOpt" title="joptsimple.ArgumentAcceptingOptionSpec[String]">partitionOpt</a><span class="delimiter">)</span>
    var <a title="Long" id="kafka.tools.GetOffsetShell.main.time">time</a> = <a href="#kafka.tools.GetOffsetShell.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[Long])Long">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.timeOpt" title="joptsimple.ArgumentAcceptingOptionSpec[Long]">timeOpt</a><span class="delimiter">)</span>.<span title="()Long">longValue</span>
    val <a title="Int" id="kafka.tools.GetOffsetShell.main.nOffsets">nOffsets</a> = <a href="#kafka.tools.GetOffsetShell.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[Integer])Integer">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.nOffsetsOpt" title="joptsimple.ArgumentAcceptingOptionSpec[Integer]">nOffsetsOpt</a><span class="delimiter">)</span>.<span title="()Int">intValue</span>
    val <a title="Int" id="kafka.tools.GetOffsetShell.main.maxWaitMs">maxWaitMs</a> = <a href="#kafka.tools.GetOffsetShell.main.options" title="joptsimple.OptionSet">options</a>.<span title="(x$1: joptsimple.OptionSpec[Integer])Integer">valueOf</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.maxWaitMsOpt" title="joptsimple.ArgumentAcceptingOptionSpec[Integer]">maxWaitMsOpt</a><span class="delimiter">)</span>.<span title="()Int">intValue</span><span class="delimiter">(</span><span class="delimiter">)</span>

    val <a title="Seq[kafka.api.TopicMetadata]" id="kafka.tools.GetOffsetShell.main.topicsMetadata">topicsMetadata</a> = <a href="../client/ClientUtils.scala.html#kafka.client.ClientUtils" title="kafka.client.ClientUtils.type">ClientUtils</a>.<a href="../client/ClientUtils.scala.html#kafka.client.ClientUtils.fetchTopicMetadata(6cf2a5b0cb)" title="(topics: scala.collection.Set[String], brokers: Seq[kafka.cluster.Broker], clientId: String, timeoutMs: Int, correlationId: Int)kafka.api.TopicMetadataResponse">fetchTopicMetadata</a><span class="delimiter">(</span><span title="(elems: String*)scala.collection.immutable.Set[String]">Set</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.topic" title="String">topic</a><span class="delimiter">)</span>, <a href="#kafka.tools.GetOffsetShell.main.metadataTargetBrokers" title="Seq[kafka.cluster.Broker]">metadataTargetBrokers</a>, <a href="#kafka.tools.GetOffsetShell.main.clientId" title="String">clientId</a>, <a href="#kafka.tools.GetOffsetShell.main.maxWaitMs" title="Int">maxWaitMs</a><span class="delimiter">)</span>.<a href="../api/TopicMetadataResponse.scala.html#kafka.api;TopicMetadataResponse.topicsMetadata" title="=&gt; Seq[kafka.api.TopicMetadata]">topicsMetadata</a>
    if<span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.topicsMetadata" title="Seq[kafka.api.TopicMetadata]">topicsMetadata</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(1)" class="int">1</span> <span title="(x: Boolean)Boolean">||</span> <span title="=&gt; Boolean">!</span><a href="#kafka.tools.GetOffsetShell.main.topicsMetadata" title="(idx: Int)kafka.api.TopicMetadata">topicsMetadata</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="../api/TopicMetadata.scala.html#kafka.api;TopicMetadata.topic" title="=&gt; String">topic</a>.<span title="(x$1: Any)Boolean">equals</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.topic" title="String">topic</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span class="delimiter">(</span><span class="string">&quot;Error: no valid topic metadata for topic: %s, &quot;</span> <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">+</span> <span class="string">&quot; probably the topic does not exist, run &quot;</span><span class="delimiter">)</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.topic" title="String">topic</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span>
        <span title="String(&quot;kafka-list-topic.sh to verify&quot;)" class="string">&quot;kafka-list-topic.sh to verify&quot;</span><span class="delimiter">)</span>
      <span title="System.type">System</span>.<span title="(x$1: Int)Unit">exit</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    val <a title="Seq[Int]" id="kafka.tools.GetOffsetShell.main.partitions">partitions</a> =
      if<span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.partitionList" title="String">partitionList</a> <span title="(x$1: Any)Boolean">==</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#kafka.tools.GetOffsetShell.main.topicsMetadata" title="Seq[kafka.api.TopicMetadata]">topicsMetadata</a>.<span title="=&gt; kafka.api.TopicMetadata">head</span>.<a href="../api/TopicMetadata.scala.html#kafka.api;TopicMetadata.partitionsMetadata" title="=&gt; Seq[kafka.api.PartitionMetadata]">partitionsMetadata</a>.<span title="(f: kafka.api.PartitionMetadata =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[kafka.api.PartitionMetadata],Int,Seq[Int]])Seq[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Int,Seq[Int]]" class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.partitions.$anonfun.x$1" title="kafka.api.PartitionMetadata">_</a>.<a href="../api/TopicMetadata.scala.html#kafka.api;PartitionMetadata.partitionId" title="=&gt; Int">partitionId</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> else <span class="delimiter">{</span>
        <a href="#kafka.tools.GetOffsetShell.main.partitionList" title="String">partitionList</a>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span>.<span title="(f: String =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],Int,Array[Int]])Array[Int]">map</span><span title="implicit scala.Predef.intArrayOps : (xs: Array[Int])scala.collection.mutable.ArrayOps[Int]" class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.partitions.$anonfun.x$2" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>.<span title="=&gt; Seq[Int]">toSeq</span>
      <span class="delimiter">}</span>
    <a href="#kafka.tools.GetOffsetShell.main.partitions" title="Seq[Int]">partitions</a>.<span title="(f: Int =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="Int" id="kafka.tools.GetOffsetShell.main.$anonfun.partitionId">partitionId</a> =&gt;
      val <a title="Option[kafka.api.PartitionMetadata]" id="kafka.tools.GetOffsetShell.main.$anonfun.partitionMetadataOpt">partitionMetadataOpt</a> = <a href="#kafka.tools.GetOffsetShell.main.topicsMetadata" title="Seq[kafka.api.TopicMetadata]">topicsMetadata</a>.<span title="=&gt; kafka.api.TopicMetadata">head</span>.<a href="../api/TopicMetadata.scala.html#kafka.api;TopicMetadata.partitionsMetadata" title="=&gt; Seq[kafka.api.PartitionMetadata]">partitionsMetadata</a>.<span title="(p: kafka.api.PartitionMetadata =&gt; Boolean)Option[kafka.api.PartitionMetadata]">find</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.$anonfun.partitionMetadataOpt.$anonfun.x$3" title="kafka.api.PartitionMetadata">_</a>.<a href="../api/TopicMetadata.scala.html#kafka.api;PartitionMetadata.partitionId" title="=&gt; Int">partitionId</a> <span title="(x: Int)Boolean">==</span> <a href="#kafka.tools.GetOffsetShell.main.$anonfun.partitionId" title="Int">partitionId</a><span class="delimiter">)</span>
      <a href="#kafka.tools.GetOffsetShell.main.$anonfun.partitionMetadataOpt" title="Option[kafka.api.PartitionMetadata]">partitionMetadataOpt</a> match <span class="delimiter">{</span>
        case Some<span class="delimiter">(</span><a title="kafka.api.PartitionMetadata" id="kafka.tools.GetOffsetShell.main.$anonfun.metadata">metadata</a><span class="delimiter">)</span> =&gt;
          <a href="#kafka.tools.GetOffsetShell.main.$anonfun.metadata" title="kafka.api.PartitionMetadata">metadata</a>.<a href="../api/TopicMetadata.scala.html#kafka.api;PartitionMetadata.leader" title="=&gt; Option[kafka.cluster.Broker]">leader</a> match <span class="delimiter">{</span>
            case Some<span class="delimiter">(</span><a title="kafka.cluster.Broker" id="kafka.tools.GetOffsetShell.main.$anonfun.leader">leader</a><span class="delimiter">)</span> =&gt;
              val <a title="kafka.consumer.SimpleConsumer" id="kafka.tools.GetOffsetShell.main.$anonfun.consumer">consumer</a> = new <a href="../consumer/SimpleConsumer.scala.html#kafka.consumer;SimpleConsumer" title="kafka.consumer.SimpleConsumer">SimpleConsumer</a><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.$anonfun.leader" title="kafka.cluster.Broker">leader</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.host" title="=&gt; String">host</a>, <a href="#kafka.tools.GetOffsetShell.main.$anonfun.leader" title="kafka.cluster.Broker">leader</a>.<a href="../cluster/Broker.scala.html#kafka.cluster;Broker.port" title="=&gt; Int">port</a>, <span title="Int(10000)" class="int">10000</span>, <span title="Int(100000)" class="int">100000</span>, <a href="#kafka.tools.GetOffsetShell.main.clientId" title="String">clientId</a><span class="delimiter">)</span>
              val <a title="kafka.common.TopicAndPartition" id="kafka.tools.GetOffsetShell.main.$anonfun.topicAndPartition">topicAndPartition</a> = <a href="../common/TopicAndPartition.scala.html#kafka.common;TopicAndPartition" title="(topic: String, partition: Int)kafka.common.TopicAndPartition">TopicAndPartition</a><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.topic" title="String">topic</a>, <a href="#kafka.tools.GetOffsetShell.main.$anonfun.partitionId" title="Int">partitionId</a><span class="delimiter">)</span>
              val <a title="kafka.api.OffsetRequest" id="kafka.tools.GetOffsetShell.main.$anonfun.request">request</a> = <a href="../api/OffsetRequest.scala.html#kafka.api;OffsetRequest" title="(requestInfo: Map[kafka.common.TopicAndPartition,kafka.api.PartitionOffsetRequestInfo], versionId: Short, correlationId: Int, clientId: String, replicaId: Int)kafka.api.OffsetRequest">OffsetRequest</a><span class="delimiter">(</span><span title="(elems: (kafka.common.TopicAndPartition, kafka.api.PartitionOffsetRequestInfo)*)scala.collection.immutable.Map[kafka.common.TopicAndPartition,kafka.api.PartitionOffsetRequestInfo]">Map</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.$anonfun.topicAndPartition" title="(self: kafka.common.TopicAndPartition)ArrowAssoc[kafka.common.TopicAndPartition]">topicAndPartition</a> <span title="(y: kafka.api.PartitionOffsetRequestInfo)(kafka.common.TopicAndPartition, kafka.api.PartitionOffsetRequestInfo)">-&gt;</span> <a href="../api/OffsetRequest.scala.html#kafka.api;PartitionOffsetRequestInfo" title="(time: Long, maxNumOffsets: Int)kafka.api.PartitionOffsetRequestInfo">PartitionOffsetRequestInfo</a><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.time" title="Long">time</a>, <a href="#kafka.tools.GetOffsetShell.main.nOffsets" title="Int">nOffsets</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              val <a title="Seq[Long]" id="kafka.tools.GetOffsetShell.main.$anonfun.offsets">offsets</a> = <a href="#kafka.tools.GetOffsetShell.main.$anonfun.consumer" title="kafka.consumer.SimpleConsumer">consumer</a>.<a href="../consumer/SimpleConsumer.scala.html#kafka.consumer;SimpleConsumer.getOffsetsBefore" title="(request: kafka.api.OffsetRequest)kafka.api.OffsetResponse">getOffsetsBefore</a><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.$anonfun.request" title="kafka.api.OffsetRequest">request</a><span class="delimiter">)</span>.<a href="../api/OffsetResponse.scala.html#kafka.api;OffsetResponse.partitionErrorAndOffsets" title="(key: kafka.common.TopicAndPartition)kafka.api.PartitionOffsetsResponse">partitionErrorAndOffsets</a><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.$anonfun.topicAndPartition" title="kafka.common.TopicAndPartition">topicAndPartition</a><span class="delimiter">)</span>.<a href="../api/OffsetResponse.scala.html#kafka.api;PartitionOffsetsResponse.offsets" title="=&gt; Seq[Long]">offsets</a>

              <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s:%d:%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.topic" title="String">topic</a>, <a href="#kafka.tools.GetOffsetShell.main.$anonfun.partitionId" title="Int">partitionId</a>, <a href="#kafka.tools.GetOffsetShell.main.$anonfun.offsets" title="Seq[Long]">offsets</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            case <span title="None.type">None</span> =&gt; <span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Error: partition %d does not have a leader. Skip getting offsets&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.$anonfun.partitionId" title="Int">partitionId</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        case <span title="None.type">None</span> =&gt; <span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Error: partition %d does not exist&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#kafka.tools.GetOffsetShell.main.$anonfun.partitionId" title="Int">partitionId</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
